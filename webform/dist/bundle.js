(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
$.noConflict();


	var app = angular.module('LCP', [
        'ui.bootstrap',
        'ngAnimate',
        'ajoslin.promise-tracker',
        'navigation.navigationBlocker',
        'translate.languageChanger',
        'ui.multiselect',
        'tabs.formTabs',
        'ui.errorMapper',
        'monospaced.elastic',
        'ngOrderObjectBy',
        'notifications']);

    app.run(function($rootScope, promiseTracker, $location, tabService) {
        $rootScope.loadingTracker = promiseTracker({});
        tabService.setTabs([
            {"id":"BasicData",            "active" : true},
            {"id":"ListOfPlants",         "active" : false},
            {"id":"PlantDetails",         "active" : false},
            {"id":"EnergyInput",          "active" : false},
            {"id":"TotalEmissionsToAir",  "active" : false},
            {"id":"Desulphurisation",     "active" : false},
            {"id":"UsefulHeat",             "active" : false},
            {"id":"Notes",                "active" : false}]);
    });

    app.config(function (languageChangerProvider) {
        languageChangerProvider.setDefaultLanguage('en');
        languageChangerProvider.setLanguageFilePrefix('lcp-labels-');
        languageChangerProvider.setAvailableLanguages({ "item" :[{
            "code": "bg",
            "label": "Български (bg)"}, {
            "code": "es",
                "label": "Español (es)"}, {
            "code": "cs",
                "label": "Čeština (cs)"}, {
            "code": "da",
                "label": "Dansk (da)"}, {
            "code": "de",
                "label": "Deutsch (de)"}, {
            "code": "et",
                "label": "Eesti (et)"}, {
            "code": "el",
                "label": "ελληνικά (el)"}, {
            "code": "en",
                "label": "English (en)"}, {
            "code": "fr",
                "label": "Français (fr)"}, {
            "code": "hr",
                "label": "Hrvatski (hr)"}, {
            "code": "it",
                "label": "Italiano (it)"}, {
            "code": "lv",
                "label": "Latviešu valoda (lv)"}, {
            "code": "lt",
                "label": "Lietuvių kalba (lt)"}, {
            "code": "hu",
                "label": "Magyar (hu)"}, {
            "code": "hr",
                "label": "Hrvatski (hr)"}, {
            "code": "mt",
                "label": "Malti (mt)"}, {
            "code": "nl",
                "label": "Nederlands (nl)"}, {
            "code": "pl",
                "label": "Polski (pl)"}, {
            "code": "pt",
                "label": "Português (pt)"}, {
            "code": "ro",
                "label": "Română (ro)"}, {
            "code": "sk",
                "label": "Slovenčina (sk)"}, {
            "code": "sl",
                "label": "Slovenščina (sl)"}, {
            "code": "fi",
                "label": "Suomi (fi)"}, {
            "code": "sv",
                "label": "Svenska (sv)"}] })
    });

    // request parameters
    var baseUri = getParameterByName('base_uri');
    var fileId = getParameterByName('fileId');
    var envelope = getParameterByName('envelope');
    var sessionId = getParameterByName('sessionid');
    var countryCode = getParameterByName('countrycode');
    countryCode = countryCode === "GB" ? "UK" : countryCode;
    var DD_VOCABULARY_BASE_URI = "http://dd.eionet.europa.eu/vocabulary/";

    app.controller("questionnaire", function ($scope, $rootScope, dataRepository, languageChanger, $sce, $location, $timeout, $anchorScroll, $notification, $http, $filter ,$q) {

     
        $scope.codeList = {};
        $scope.regionsCodelist = {};

		$scope.base = $location.host()+ $location.port() + getParameterByName('base_uri');
        //$scope.availableLanguages = languageChanger.getAvailableLanguages();

        dataRepository.getEmptyInstance().error(function(){alert("Failed to read empty instance XML file.");}).success(function(instance) {
            $scope.emptyInstance = instance;
        });

        dataRepository.getInstance().error(function(){alert("Failed to read instance XML file.");}).success(function(instance) {
            if (!angular.isDefined(instance.LCPQuestionnaire)){
                // add labelLanguage attribute to correct location
                $scope.instance = {};
                $scope.instance.LCPQuestionnaire = {};
                $scope.instance.LCPQuestionnaire['@xmlns:xsi'] = instance.LCPQuestionnaire['@xmlns:xsi'];
                $scope.instance.LCPQuestionnaire['@xsi:noNamespaceSchemaLocation'] = instance.LCPQuestionnaire['@xsi:noNamespaceSchemaLocation'];
                $scope.instance.LCPQuestionnaire['@xml:lang'] = instance.LCPQuestionnaire['@xml:lang'];
                $scope.instance.LCPQuestionnaire.BasicData = instance.LCPQuestionnaire.BasicData;
                $scope.instance.LCPQuestionnaire.ListOfPlants = instance.LCPQuestionnaire.ListOfPlants;

            }
            else {
                $scope.instance = instance;
            }

            if ($scope.instance.LCPQuestionnaire.ListOfPlants && $scope.instance.LCPQuestionnaire.ListOfPlants.Plant) {

                // if therσυσe is only 1 plant, then convert it to array
                if (!angular.isArray($scope.instance.LCPQuestionnaire.ListOfPlants.Plant)) {
                    $scope.instance.LCPQuestionnaire.ListOfPlants.Plant = [$scope.instance.LCPQuestionnaire.ListOfPlants.Plant];
                }
                // remove the first empty row, if exists
                if ($scope.instance.LCPQuestionnaire.ListOfPlants.Plant.length == 1 &&
                        (!$scope.instance.LCPQuestionnaire.ListOfPlants.Plant[0] ||
                                (!$scope.instance.LCPQuestionnaire.ListOfPlants.Plant[0]['PlantName'] && !$scope.instance.LCPQuestionnaire.ListOfPlants.Plant[0]['PlantId']))){
                    $scope.instance.LCPQuestionnaire.ListOfPlants.Plant = [];

                    // Load predefined country specific plants
                    if( countryCode != null) {
                        var eprtrCountryCode = countryCode === "GB" ? "UK" : countryCode === "GR" ? "EL" : countryCode;
                        // var url = "lcp_plants-" + countryCode + ".json";
                        var url = "http://semantic.eea.europa.eu/sparql?format=application/json&query=";
                        var sparql = " PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>" +
                                    " PREFIX cr: <http://cr.eionet.europa.eu/ontologies/contreg.rdf#> " +
                                    " PREFIX prtr: <http://prtr.ec.europa.eu/rdf/schema.rdf#> " +
                                    " PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>" +
                                    " PREFIX lcpType: <http://semantic.eea.europa.eu/project/lcp_data/lcp_plants.csv/> " +
                                    " PREFIX lcp: <http://semantic.eea.europa.eu/project/lcp_data/lcp_plants.csv#> " +
                                    " SELECT *" +
                                    " WHERE {" +
                                    " {" +
                                        " [] a lcpType:lcpPlant ;" +
                                        " lcp:PlantName ?PlantName;" +
                                        " lcp:MemberState ?MemberState;" +
                                        " lcp:EPRTRNationalId ?EPRTRNationalId;" +
                                        " lcp:Unique_Plant_ID ?PlantId." +

                                        " ?facility a prtr:Facility ;" +
                                        " prtr:facilityName ?facilityName;" +
                                        " prtr:streetName ?streetName;" +
                                        " prtr:postalCode  ?postalCode;" +
                                        " geo:lat ?lat;" +
                                        " geo:long ?long;" +
                                        " prtr:inCountry ?inCountry ;" +
                                        " prtr:latestReport ?latestReport." +
                                        " ?inCountry prtr:code ?EPRTRCountryCode." +
                                        " ?latestReport prtr:nationalID ?EPRTRNationalId;" +
                                        " prtr:forNUTS ?forNUTS;" +
                                        " prtr:reportingYear ?reportingYear." +
                                        " ?forNUTS prtr:code ?regionCode." +
                                        " OPTIONAL { ?facility prtr:buildingNumber ?buildingNumber. }" +
                                        " OPTIONAL { ?facility prtr:city ?city. }" +
                                        " FILTER( ?EPRTRCountryCode= '" + eprtrCountryCode + "' and ?MemberState = '" + countryCode + "' and ?MemberState != 'SK' )" +
                                    " } " +
                                    " UNION" +
                                    " {" +
                                        " ?plant a lcpType:lcpPlant ;" +
                                        " lcp:PlantName ?PlantName;" +
                                        " lcp:MemberState ?MemberState;" +
                                        " lcp:EPRTRNationalId ?EPRTRNationalId;" +
                                        " lcp:Unique_Plant_ID ?PlantId." +
                                        " OPTIONAL {  ?plant lcp:FacilityName ?facilityName. }" +
                                        " OPTIONAL {  ?plant lcp:Longitude ?long. }" +
                                        " OPTIONAL {  ?plant lcp:Latitude ?lat. }" +
                                        " OPTIONAL {  ?plant lcp:Address1 ?streetName. }" +
                                        " OPTIONAL {  ?plant lcp:City ?city. }" +
                                        " OPTIONAL {  ?plant lcp:PostalCode ?postalCode.}" +
                                        " OPTIONAL {  ?plant lcp:Region ?regionCode. }" +
                                        " OPTIONAL {" +
                                            " ?facility a prtr:Facility ;" +
                                            " prtr:inCountry ?inCountry ;" +
                                            " prtr:latestReport ?latestReport." +
                                            " ?latestReport prtr:nationalID ?EPRTRNationalId." +
                                            " ?inCountry prtr:code ?EPRTRCountryCode." +
                                            " FILTER( ?EPRTRCountryCode= '"+ eprtrCountryCode + "'  )" +
                                        " }" +
                                        " FILTER( ?MemberState = '" + countryCode +"' and (!bound(?facility) or  ?MemberState = 'SK' ) ) " +
                                    " }" +
                                 " } ORDER BY ?PlantId ";

                        url = baseUri + '/restProxy?uri=' + encodeURIComponent(url + encodeURIComponent(sparql));
        //                console.log('plants url is:'+url);
                        $http.get(url, {tracker : $rootScope.loadingTracker})
                                .error(function(){alert("Failed to pre-load plants data from E-PRTR database.");})
                                .success(function(eprtrData) {
                                    if (eprtrData.results.bindings.length > 0) {
                                        var plantsDict = {} ;
                                        for (var i= 0; i < eprtrData.results.bindings.length; i++) {
                                            var responsePlant = eprtrData.results.bindings[i];
                                            var plant = null ;
                                            if (   plantsDict[ responsePlant.PlantId.value] && plantsDict [ responsePlant.PlantId.value] > responsePlant.reportingYear.value  ) {
                                                // some plants have reports under different facilities. we keep the for most new reportingYear
                                                continue ;
                                            }
                                            else if ( ! plantsDict[ responsePlant.PlantId.value] ){
                                                $scope.addItem('LCPQuestionnaire.ListOfPlants.Plant');
                                            }

                                            plant = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant[ $scope.instance.LCPQuestionnaire.ListOfPlants.Plant.length - 1 ];
                                            if (!plant.PlantLocation) plant.PlantLocation = {};
                                            if (!plant.GeographicalCoordinate) plant.GeographicalCoordinate = {};

                                            plant.PlantId = responsePlant.PlantId.value ;
                                            plant.PlantName = responsePlant.PlantName.value;
                                            plant.EPRTRNationalId = responsePlant.EPRTRNationalId.value;
                                            plant.PlantLocation.Address1 = responsePlant.streetName.value;
                                            if (!isEmpty(responsePlant.buildingNumber.value)) {
                                                plant.PlantLocation.Address1 += " " + responsePlant.buildingNumber.value;
                                            }
                                            plant.PlantLocation.City = responsePlant.city.value;
                                            plant.PlantLocation.Region = responsePlant.regionCode.value;
                                            plant.PlantLocation.PostalCode = responsePlant.postalCode.value;
                                            plant.GeographicalCoordinate.Longitude = responsePlant.long.value;
                                            plant.GeographicalCoordinate.Latitude = responsePlant.lat.value;
                                            plant.FacilityName = responsePlant.facilityName.value;

                                            plantsDict [plant.PlantId ] = responsePlant.reportingYear.value || 2013;
                                        }
                                        $rootScope.$broadcast('updateFilter');
                                        $notification.info("Info", "Previous EPRTR plants have been pre-loaded.");

                                    }
                                    else {
                                        alert("The system could not find any plant for country " + countryCode);
                                    }
                                });
                    }
                }
            }
            else {
                $scope.instance.LCPQuestionnaire.ListOfPlants = {"Plant" : []};
            }
            if( countryCode != null){

                $scope.countryCodeBoolean =true;
                $scope.instance.LCPQuestionnaire.BasicData.MemberState = countryCode.toUpperCase();
                $scope.memberStateValue = countryCode;
            }

            if( $scope.instance.LCPQuestionnaire.BasicData.MemberState != null ){
                $scope.countryCodeBoolean =true;
                $scope.memberStateValue = $scope.instance.LCPQuestionnaire.BasicData.MemberState;
                $scope.stateValue = $scope.instance.LCPQuestionnaire.BasicData.MemberState;
                $scope.instance.LCPQuestionnaire.BasicData.State = $scope.stateValue;
                $scope.regionsCodelist = dataRepository.loadRegionsCodelist($scope.memberStateValue);
            }

            $scope.$broadcast('instanceReady');
        });

   
        
        $scope.reportingYears = [];
        $scope.reportingYears.push ('2016');
        $scope.plantDetailsOtherSectorFieldsView = {iron_steel:"Iron and Steel",esi:"Electricity production",district_heating:"District heating",chp:"Combined heat and power generation",other:"Other"};

        // new
        $scope.currentListOfPlantsTable = null;
        $scope.selectedListOfPlantsTable = null;
        $scope.translationData = {};
        $rootScope.bulkEditListOfPlants=false;
        //$scope.status = submissionService.getStatus();
        $scope.profileFilled = true;
        $scope.editReference = false;
        $scope.changedReference = "";
        $scope.editUserIdentity = false;
        $scope.changedUserIdentity = "";
        $scope.editCountry = false;
        $scope.changedCountry = "";
        $scope.regionsCodelist = {};
        $scope.regionsCountry = null;
        $scope.isIE9 = $rootScope.isIE9;

        $scope.checkBoxDeleteCommit = false;
        // new end
        //determine ie version, code snippet is taken from: http://msdn.microsoft.com/en-us/library/ms537509%28v=vs.85%29.aspx
        var rv = -1; // Return value assumes failure.
        if (navigator.appName == 'Microsoft Internet Explorer')
        {
            var ua = navigator.userAgent;
            var re  = new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");
            if (re.exec(ua) != null)
                rv = parseFloat( RegExp.$1 );
        }
        //see: http://stackoverflow.com/questions/17907445/how-to-detect-ie11
        else if (navigator.appName == 'Netscape')
        {
            var ua = navigator.userAgent;
            var re  = new RegExp("Trident/.*rv:([0-9]{1,}[\.0-9]{0,})");
            if (re.exec(ua) != null)
                rv = parseFloat( RegExp.$1 );
        }

        $rootScope.ieVersionNumberOutOfCuriosityVariable = rv;
        if (rv > 0 && rv <= 9.0){
            $rootScope.isIE9 = true;
        }else{
            $rootScope.isIE9 = false;
        }
        $rootScope.$watch('isIE9', function(newValue, oldValue) {
            if (!newValue) {
                return;
            } else {
                $scope.isIE9 = $rootScope.isIE9;
            }
        })


        //$scope.countryCodeBoolean =  countryCode != null  ;
        $scope.countryCodeVal =  countryCode;


        dataRepository.loadCodeList();
        dataRepository.loadOldLCPCodeList();
        dataRepository.loadCombustionPlantCodeList();
        dataRepository.loadDerogationValueCodeList();
        dataRepository.loadOtherSolidFuelCodeList();
        dataRepository.loadOtherGasesousFuelCodeList();
        dataRepository.loadMonthValueCodeList();
        $scope.codeList = dataRepository.getCodeList();

       
    
        $scope.conversionLink = "";
        $scope.instanceInfo = {};
        dataRepository.loadInstanceInfo().error(function(){console.log("Failed to readfile info from server.");}).success(function(info) {
            angular.copy(info, $scope.instanceInfo);
            if ($scope.instanceInfo.conversions) {
                var htmlConversionId = $filter('filter')($scope.instanceInfo.conversions, {resultType: 'HTML'})[0].id;
                $scope.conversionLink = $scope.instanceInfo.conversionLink + htmlConversionId;
            }
        })


        // Remove row from ng-repeat.
        $scope.remove = function(array,  rowElement, showMsg){

            ////console.log(rowElement);
            ////console.log(countNonEmptyProperties(rowElement));
            if(showMsg == true){
                if (countNonEmptyProperties(rowElement) > 0) {
                    if (!confirm('Are you sure you want to delete the data in this row?')){
                        return;
                    }
                }
            }
            var index = array.indexOf(rowElement);
            array.splice(index, 1);
            $rootScope.$broadcast('updateFilter');
        };


        // get code list label by code
        $scope.getCodeListLabel = function(codelist, code) {
            //Do not try to get codeList before it actually exists.
            if (!$scope.codeList) {
                return;
            }

            //Escape codelists that are not arrays by default (has only one element)
            // This code can be removed when changes are made to codeList file.
            if (!($scope.codeList.LCPCodelists[codelist].item.length > 0)
                    && $scope.codeList.LCPCodelists[codelist].item.code == code) {
                return $scope.codeList.LCPCodelists[codelist].item.label;
            }

            var retValue;
            for (var i=0 ; i<=$scope.codeList.LCPCodelists[codelist].item.length - 1; i++) {
                if ($scope.codeList.LCPCodelists[codelist].item[i].code == code) {
                    retValue = $scope.codeList.LCPCodelists[codelist].item[i].label;
                    break;
                }
            }
            return retValue;
        };


        $scope.addItem = function(path) {

            var tokens = path.split(".");
            var result = $scope.instance;
            while(tokens.length) {
                result = result[tokens.shift()];
            }
            if (!(result instanceof Array)) {
                result = [];
            }
            // Need to make copy of object otherwise it gets same $$hashkey and it cannot be used in ng-repeat.
            // Other solution would be to get empty instance every time that would be slower.
            var copyOfEmptyInstance = clone($scope.getInstanceByPath('emptyInstance', path));
            result.push(copyOfEmptyInstance);
            return copyOfEmptyInstance;
        };

        $scope.getNextPlantId = function ( plantId_candidate ) {
            //
            var q = $q.defer ();

            var formNextPlantId = 1;
            var newPlantId = null;

            function pad(num, size) {
                var s = num+"";
                while (s.length < size) s = "0" + s;
                return s;
            }

            function checkSDS ( newPlantId ) {
                var url = "http://semantic.eea.europa.eu/sparql?format=application/json&query=";

                var sparql =
                    " PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>" +
                    " PREFIX lcpType: <http://semantic.eea.europa.eu/project/lcp_data/lcp_plants.csv/>" +
                    " PREFIX lcp: <http://semantic.eea.europa.eu/project/lcp_data/lcp_plants.csv#>" +
                    " SELECT *" +
                    " WHERE {" +
                    " ?plant a lcpType:lcpPlant ;" +
                    " lcp:Unique_Plant_ID ?PlantId." +
                    " FILTER ( ?PlantId = '" + newPlantId +"' )" +
                    " }" ;

                url = baseUri + '/restProxy?uri=' + encodeURIComponent(url + encodeURIComponent(sparql));
                $http.get(url, {tracker : $rootScope.loadingTracker})
                            .error(function(){alert("Failed to read data from remote database. Please check your connection."); q.reject();})
                            .success(function(eprtrData) {
                                if (eprtrData.results.bindings.length > 0) { // plandId exists in db
                                    // check against the next increment of plantid
                                    newPlantId =   ($scope.memberStateValue || $scope.instance.LCPQuestionnaire.BasicData.MemberState) + pad( parseInt( newPlantId.slice(2) ) + 1 , 4 ) ;
                                    $scope.getNextPlantId ( newPlantId ) . then ( function ( value ) {
                                        q.resolve ( value ) ;
                                    } ) ;
                                }
                                else { // plantid not reserved. resolve the promise
                                    q.resolve ( newPlantId ) ;
                                }
                });
            }

            if ( plantId_candidate == null )
            { // plantId_candidate == null on the first call of the function
                // we get the max plant id of the current plants on th form
                // and the max plant id from sds
                // then we will check for id collisions and increment by one the id and recheck, until a 'free' plant id is found

                var orderBy = $filter('orderBy');
                var orderedItems = orderBy( $scope.instance.LCPQuestionnaire.ListOfPlants.Plant, "PlantId", true);

                for (var i=0; i < orderedItems.length; i++) {
                            if (!isEmpty(orderedItems[i].PlantId ) && orderedItems[i].PlantId !== "" ) {
                                formNextPlantId = parseInt(orderedItems[i].PlantId.substring(orderedItems[i].PlantId.length - 4 )) + 1;
                                break;
                            }
                }


                // ---- query the sds for the max id
                var url = "http://semantic.eea.europa.eu/sparql?format=application/json&query=";

                var sparql =
                    " PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>" +
                    " PREFIX lcpType: <http://semantic.eea.europa.eu/project/lcp_data/plant_IDs.csv/>" +
                    " PREFIX lcp: <http://semantic.eea.europa.eu/project/lcp_data/plant_IDs.csv#> " +
                    " SELECT *" +
                    " WHERE {" +
                    " [] a lcpType:lcpPlantIds ;" +
                    " lcp:Unique_Plant_ID ?PlantId." +
                    " FILTER ( regex(?PlantId,'" +  ($scope.memberStateValue || $scope.instance.LCPQuestionnaire.BasicData.MemberState) +"') )" +
                    " }  ORDER BY DESC(?PlantId) LIMIT 1 " ;

                url = baseUri + '/restProxy?uri=' + encodeURIComponent(url + encodeURIComponent(sparql));
                $http.get(url, {tracker : $rootScope.loadingTracker})
                            .error(function(){alert("Failed to read data from remote databse. Please check your connection"); q.reject();})
                            .success(function(eprtrData) {
                                var nextId;
                                if ( eprtrData.results.bindings.length > 0 ) {
                                nextId = parseInt( eprtrData.results.bindings[0].PlantId.value.slice(2) ) + 1 ;
                                if ( formNextPlantId > nextId ) nextId = formNextPlantId ;
                            }
                                else nextId = formNextPlantId;

                                    newPlantId =   ($scope.memberStateValue || $scope.instance.LCPQuestionnaire.BasicData.MemberState) +
                                                    pad(  nextId , 4 ) ;
                                    checkSDS ( newPlantId ) ;

                });

            }
            else {
                checkSDS ( plantId_candidate ) ;
            }

            return q.promise ;

        }

        $scope.getMaxPlantId = function() {
            var orderBy = $filter('orderBy');
            var orderedItems = orderBy( $scope.instance.LCPQuestionnaire.ListOfPlants.Plant, "PlantId", true);
            var nextPlantId = 1;
            var newPlantId = null;
            var exists = null;

            for (var i=0; i < orderedItems.length; i++) {
                if (!isEmpty(orderedItems[i].PlantId ) && orderedItems[i].PlantId !== "" ) {
                    nextPlantId = parseInt(orderedItems[i].PlantId.substring(orderedItems[i].PlantId.length - 4 )) + 1;
                    break;
                }
            }
            // format the id : XXNNNN, where XX is the memberstate code and NNNN is a unique integer
            function pad(num, size) {
                var s = num+"";
                while (s.length < size) s = "0" + s;
                return s;
            }

            newPlantId =  ($scope.memberStateValue || $scope.instance.LCPQuestionnaire.BasicData.MemberState) + pad( nextPlantId, 4);

            return newPlantId;
        }

        $rootScope.getInstanceByPath = function(root, identifier) {
            //console.log(root);
            if (!$scope.instance) {
                return null;
            }

            var tokens = root.split(".");
            //console.log(tokens);
            var result = $scope;

            while(tokens.length) {
                result = result[tokens.shift()];
                if (!result) {
                    return null;
                }
            }

            tokens = identifier.split(".");

            while(tokens.length) {
                result = result[tokens.shift()];
            }

            return result;
        };

        $rootScope.getPlantByPath = function(plant, identifier) {
            //console.log(root);
            if (!$scope.instance) {
                return null;
            }

            var result;
            //console.log(tokens);
            if(plant != null){
             result = plant;
            }


            var tokens = identifier.split(".");

            while(tokens.length) {
                result = result[tokens.shift()];
            }

            return result;
        };

        // save instance data.
        $scope.saveInstance = function(){

            //$scope.submitted = true;
            var passedTheQas = $scope.runQAtests();
            var formComplete = $scope.isFormComplete();

			dataRepository.saveInstance($scope.instance).error(function(){

                $notification.error("Save", "Data was not saved !");})

            .success(function(response){
                if ( response.code === 0 ) {
                  alert("There was an error during the save operation. Data is not saved.")
                  return;
                }

                if ($scope.appForm.$invalid || ( !formComplete) ) {
                    $notification.info("Save", "Data was saved, but the questionnaire is incomplete.");
                }
                else if (!passedTheQas) {
                    $notification.info("Save", "Data was saved, but the questionnaire did not pass some QAs.");
                }
                else {
                    $notification.success("Save", "Data is saved successfully.");
                }

                $scope.appForm.$setPristine(true);

            });

        };

         $scope.hasArticle31DerogationValue = function(item){
             // check against this value: http://dd.eionet.europa.eu/vocabularyconcept/euregistryonindustrialsites/DerogationValue/Article31/
             if(item.PlantDetails!=null && item.PlantDetails.Derogation!= null){
                 if(item.PlantDetails.Derogation.indexOf("Article31") !== -1) {
                    return true;
                }
                else {
                    return false;
                }
             }
             return false;
         }

         $scope.hasArticle35DerogationValue = function(item){
             // check against this value: http://dd.eionet.europa.eu/vocabularyconcept/euregistryonindustrialsites/DerogationValue/Article35/
             if(item.PlantDetails!=null && item.PlantDetails.Derogation!= null){
                 if(item.PlantDetails.Derogation.indexOf("Article35") !== -1) {
                    return true;
                }
                else {
                    return false;
                }
             }
             return false;
         }


         $scope.addDesulphurizationValuesForEachMonth=function(i,plant){
                 plant.Desulphurisation.push({
                    "MonthValue":$scope.codeList.MonthlyDesulphurisation[i].MonthValue,
                    "DesulphurisationRate": $scope.codeList.MonthlyDesulphurisation[i].DesulphurisationRate,
                    "SulphurContent": $scope.codeList.MonthlyDesulphurisation[i].SulphurContent,
                    "TechnicalJustification": $scope.codeList.MonthlyDesulphurisation[i].TechnicalJustification,
                 })
         }
        $scope.isFormComplete = function () {
            // returns true if the required fields for all plant are filled; false if not ~

            var res = true;
            var plants = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant;
            var plant = null;
            var j = null;

            for ( i=0 ; i < plants.length; i++) {
                plant = plants[i];
                // list of plants
                if ( isEmpty (plant.PlantId) || isEmpty( plant.GeographicalCoordinate.Latitude) || isEmpty ( plant.GeographicalCoordinate.Longitude)   )
                    res = false;

                // plant details
                if ( isEmpty ( plant.PlantDetails.MWth) )
                    res = false;

                // energy input
               
                for  ( j in ( ( plant.EnergyInputAndTotalEmissionsToAir.EnergyInput)) ) {
                    if  ( isEmpty (plant.EnergyInputAndTotalEmissionsToAir.EnergyInput[ j]) )
                        plant.EnergyInputAndTotalEmissionsToAir.EnergyInput[ j] = 0;
                }

                for ( j in ( ( plant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir)) ) {
                    if (isEmpty (plant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir[ j]))
                        plant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir[ j] = 0;
                }

                for ( j in ( ( plant.Desulphurisation)) ) {
                    if (isEmpty (plant.Desulphurisation[ j]))
                        plant.Desulphurisation[ j] = 0;
                }
                for ( j in ( ( plant.UsefulHeat)) ) {
                    if (isEmpty (plant.UsefulHeat[ j]))
                        plant.UsefulHeat[ j] = 0;
                }


                if (res === false) break;
            }

            return res;


        }


        $scope.runQAtests = function () {

            // conform the instance if needed

            var res = true;
            var plants = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant;

            if (plants.length != $scope.instance.LCPQuestionnaire.BasicData.NumberOfPlants)
                res = false;

            var sectors = {};
            var status  = {};

   //         for (i in $scope.codeList.LCPCodelists.sectors.concepts) {  sectors[ $scope.codeList.LCPCodelists.sectors.concepts[ i ] ['@id'] ] = 1 ; }
            // sectors is a dictionary of valid other sector values

        //    for (i in $scope.codeList.LCPCodelists.status.concepts) {  status[ $scope.codeList.LCPCodelists.status.concepts[ i ] ['@id'] ] = 1 ; }

            var names = {};
            var dublicates = {};
            var refDay = new Date("2003-11-27");

            for ( i=0 ; i < plants.length; i++) {

                // LCP 1.1
                // not refinery

                if ( !plants[i].PlantDetails) continue; // some times a null plant was present at the end of the array

                // coordinates
                if ( plants[i].GeographicalCoordinate.Longitude > 180 || plants[i].GeographicalCoordinate.Longitude < -180)
                    res = false;

                if ( plants[i].GeographicalCoordinate.Latitude > 90 || plants[i].GeographicalCoordinate.Latitude < -90)
                    res = false;
                //
           //     if ( !( plants[i].PlantDetails.Refineries) && ( !( plants[i].PlantDetails.OtherSector  )  || ! (sectors[plants[i].PlantDetails.OtherSector ] )) ){
                    // ^^ checks that if not Refineries, that OtherSector is filled with one of the permitted values(fetched from DD)
            //        res = false;
             //   }

                if ( ! ( ( plants[i].PlantDetails.StatusOfThePlant === null ) || ( plants[i].PlantDetails.StatusOfThePlant === "" ) || status [ plants[i].PlantDetails.StatusOfThePlant] ) )
                    res = false;

                // LCP 2.1 Unequivocal naming of plants
                if ( names[ plants[i].PlantName ] != undefined ) {
                    // dublicate found
                    dublicates[i] = 1;
                    dublicates[ names[ plants [i].PlantName ] ] = 1;
                    //names[$scope.instance.LCPQuestionnaire.ListOfPlants.Plant[i].PlantName ].push(i);
                }
                else
                    names[ plants [i].PlantName] = i;

                // LCP 3.2

                if ( plants[i].PlantDetails.MWth < 50 ){
                    // error
                    res = false;
                }
                else if ( plants[i].PlantDetails.MWth > 10000){
                    // warning
                    console.log(i);
                }

                // LCP 3.4
                if ( plants[i].PlantDetails.ExtensionBy50MWOrMore && !( plants[i].PlantDetails.CapacityAddedMW >= 50 ) ){
                    // error
                    res = false;

                }
                // LCP 3.5
                if ( plants[i].PlantDetails.SubstantialChange && !( plants[i].PlantDetails.CapacityAffectedMW >= 0 ) ){
                        // error
                        res = false;

                    }
                // LCP 3.6
                // valid dates(if date submitted)
                if ( !$scope.validDateFormat(plants[i].PlantDetails.DateOfStartOfOperation)) {
                        res = false;
                    }
                if ( plants[i].PlantDetails.DateOfStartOfOperation ) {

                    if ( ( plants[i].PlantDetails.StatusOfThePlant === "art_4_1" || plants[i].PlantDetails.StatusOfThePlant === "art_4_3" ) &&
                     ( new Date (plants[i].PlantDetails.DateOfStartOfOperation) > refDay ) ){
                        // error
                        res = false;

                    }
                    else if ( ( plants[i].PlantDetails.StatusOfThePlant === "art_4_2" ) &&
                     ( new Date (plants[i].PlantDetails.DateOfStartOfOperation) <= refDay ) ){
                        // error
                        res = false;

                    }
                }
           

            }// end for
            if ( JSON.stringify(dublicates) !== "{}") {
                // duplicates holds the plants with same names
                console.log(dublicates);
                res = false;
            }
            if ( res === true )  $scope.conformTheInstance();
            return res;
        }

        $scope.conformTheInstance = function () {

            var plants = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant;
            for (j in plants){

                plant = plants[j];

                delete plant.Delete;

                
                if ( plant.plantDetails!=null && plant.PlantDetails.Refineries !== true ){
                    plant.PlantDetails.Refineries = false;
                }
                if (plant.plantDetails!=null && plant.PlantDetails.Refineries === true ){
                    plant.PlantDetails.OtherSector = null;
                }
               

            }

        }

        $scope.ifFormIsValidSaveInstance = function(form){
            if (!form.$invalid) {
                $scope.saveInstance();
            }

        }

        $scope.validationOnOff = function() {
            $scope.submitted = !$scope.submitted;
        };

        // save instance data.
        $scope.close = function(){
            if (baseUri == ''){baseUri = "/"};
            var windowLocation = (envelope && envelope.length > 0) ? envelope : baseUri;
            if ($scope.appForm.$dirty){
                if (confirm('You have made changes in the questionnaire! \n\n Do you want to leave without saving the data?')){
                    window.location = windowLocation;
                }
            }
            else {
                ////console.log("Failed to confirm");
                window.location = windowLocation;
            }
        };
        // convert XML to HTML in new window.
        $scope.printPreview = function(){
            dataRepository.saveInstance($scope.instance).success(function(){
				var win = window.open($scope.conversionLink, '_blank');
				win.focus;
			});
        };
        $scope.closeBulkEditListOfPlants = function(form){
            //if (form && form == 'ListOfPlants'){
                //remove empty rows
                for(var i = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant.length - 1; i >= 0; i--){

                    var plant = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant[i];

                    if ( plant.PlantLocation!=null && isEmpty(plant.PlantName)  && isEmpty(plant.EPRTRNationalId) &&
                           isEmpty(plant.PlantLocation.Address1) && isEmpty(plant.PlantLocation.Address2) &&
                           isEmpty(plant.PlantLocation.City) && isEmpty(plant.PlantLocation.Region) && isEmpty(plant.PlantLocation.PostalCode) &&
                           isEmpty(plant.GeographicalCoordinate.Longitude) && isEmpty(plant.GeographicalCoordinate.Latitude) && isEmpty(plant.FacilityName))

                    {
                        $scope.instance.LCPQuestionnaire.ListOfPlants.Plant.splice(i, 1);
                        continue;
                    }
                    // fill in plant IDs

                    if ( isEmpty(plant.PlantId) ) {
                        var promise = $scope.getNextPlantId () ;
                        var newPlant = plant;
                        // using $q promise API, to ask the server first for id collisions.
                        promise.then ( function ( plantid ) {
                            newPlant.PlantId = plantid ;
                        });

                    }
                }
            //}
            $scope.conformTheInstance();
            //
            $rootScope.bulkEditListOfPlants = false;
            $rootScope.$broadcast('updateFilter');
        };
        $scope.openBulkEditListOfPlants = function(form) {
            if (form && form === 'ListOfPlants') {
                $scope.addItem('LCPQuestionnaire.ListOfPlants.Plant');
            }
            if ($scope.instance.LCPQuestionnaire.ListOfPlants.Plant.length === 0) {

                $notification.info("Edit", "Add some plants from List of Plants first.");

            }
            else
            $rootScope.bulkEditListOfPlants = true;
        };

        $scope.windowSearch = window.location.search;

        $scope.getHelpInfo = function(divId) {
            //console.log(divId);
            var infoDiv = document.getElementById(divId);
            //console.log(infoDiv);
            return $sce.trustAsHtml(infoDiv.innerHTML);
        };

        $scope.changeInfoToggle = function(overInfoToggle) {
            $scope.showInfo = overInfoToggle;
        };

        $scope.phoneNumberPattern = /^[ 0-9\(\)\+\-]{7,25}$/;
        $scope.positiveIntegerPattern = /^\d+$/;
        $scope.positiveDecimalNumberPattern = /^\d*\.?\d*$/;
        $scope.binaryNumberPattern=/^[0-1]/;
        $scope.decimalNumberPattern =/^[+-]?(\d*\.?\d*)$/;
        $scope.dateFormat = /^(19|20)\d\d([-])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$/;

        $scope.websiteAddressPattern = /^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/;
        $scope.percentagePattern = /^100$|^[0-9]{1,2}$|^[0-9]{1,2}\,[0-9]{1,3}$/;
        $scope.longitudeNumberPattern = /^[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)$/;

        $scope.latitudeNumberPattern = /^[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?)$/;

        $scope.isFixedQuestion = function(dataPath) {
            var tokens = dataPath.split('.');
            var lastToken = tokens.pop();
            ////console.log(lastToken);
            ////console.log(lastToken == 'FixedQuestion');
            return (lastToken == 'FixedQuestion');
        }

        $scope.clearSubFormData = function(dataPaths, identifierPath, changeValueTo) {

            var elementCount = 0;
            for (var i = 0; i < dataPaths.length; i++) {
                var formElementInstance = $scope.getInstanceByPath('instance.LCPQuestionnaire', dataPaths[i]);
                elementCount += countNonEmptyProperties(formElementInstance, $scope.isFixedQuestion(dataPaths[i]));
            }

            // Need to get parent path of yes/no question otherwise assigning new value
            // to property does not work.
            var tokens = identifierPath.split('.');

            // Parent property of actual yes/no question
            var subFormInstanceIdentifier = tokens.shift();

            // Parent instance object that contains actual yes/no question property
            var parentInstance = $scope.getInstanceByPath('instance.LCPQuestionnaire', subFormInstanceIdentifier);
            var objectName = tokens.shift();

            var needsToClearData = true;

            if (needsToClearData) {
                // When element count is more than 0 then we have to ask confirmation from user whether to delete the data.
                if (elementCount > 0 && !confirm('When changing answer all data under this sub-form will be lost?')){
                    // toke.shift() extracts yes/no question name.
                    // Assing yes value to question
                    parentInstance[objectName] =  changeValueTo;
                    return;
                } else {
                    for (var i = 0; i < dataPaths.length; i++) {
                        var formElementInstance = $scope.getInstanceByPath('instance.LCPQuestionnaire', dataPaths[i]);

                        // For fields where there is only one field and it can be null. Just ignore it.
                        if (!formElementInstance) {
                            continue;
                        }

                        // This if-else is to differentiate just a string field from array or object.
                        if (formElementInstance instanceof Array || !formElementInstance.length) {
                            clearObject(formElementInstance, $scope.isFixedQuestion(dataPaths[i]));
                        } else {
                            var tokens = dataPaths[i].split('.');
                            var objectIdentifier = tokens.shift();
                            var parentObject = $scope.getInstanceByPath('instance.LCPQuestionnaire', objectIdentifier);
                            parentObject[tokens.shift()] = null;
                        }
                    }
                }
            } else {
                // Do nothing.
            }
        };

        $rootScope.otherTypeOfCombustionPlant = false;

        $scope.isTypeOfCombustionPlantOther = function (plant) {
            if (plant.PlantDetails.TypeOfCombustionPlant === 'Others') {
                $rootScope.otherTypeOfCombustionPlant = true;
            } else {
                $rootScope.otherTypeOfCombustionPlant = false;
            }
        };

        //TODO format error message to handle different limits better
        $scope.errorMessages = {
            "required_field" : "This is a required field",
            "unique_abbreviation" : "Please provide a unique abbreviation ",
            "valid_telephone" : "Please enter a valid telephone number (at least 7 digits) ",
            "valid_email" : "Please enter a valid email address ",
            "valid_url" : "Please enter a valid URL ",
            "yes_or_no" : "Please choose yes or no ",
            "number_greater_than_zero" : "Please provide a number greater than 0 ",
            "data_entry_must_be_unique" : "Data entry must be unique ID code ",
            "must_be_less_than" : "Please provide a number less than ",
            "must_be_greater_than" : "Please provide a number greater or equal to ",
            "must_be_percentage" : "Please provide a percentage between 0 and 100 ",
            "whole_number_greater_than_zero" : "Please provide a whole number greater than 0 ",
            "unique_identification_code" : "Please enter a unique identification code ",
            "valid_longitude" : "Please provide a number between -180 and 180",
            "valid_latitude" : "Please provide a number between -90 and 90",
            "positive_decimal" : "Please provide a positive decimal number  ",
            "positive_decimal01" : "Please provide a positive decimal number between 0 and 1",
            "positive_integer" : "Please provide a positive integer ",
            "article_format" : "Please use the edit menu to correct the article format"

        };


        $scope.getErrorMessage = function(errorCode) {
            return $scope.errorMessages[errorCode];
        };

        $scope.showError = function(modelController, errorCode) {
            return modelController.$error[errorCode] && modelController.$invalid
                    && !(errorCode === 'required' && modelController.$error['pattern'] && modelController.$error['pattern'] ==true);// && modelController.$dirty;
        };
        $scope.showErrorIfSubmitted = function(modelController, errorCode, submitted) {
            return submitted && $scope.showError(modelController, errorCode);
        };


        $scope.isGreaterThanZero = function(inputValue) {
            return $scope.submitted == false && ( Number(inputValue) > 0);
        };

        $scope.isPositiveNumber = function(inputValue) {
            var boolean = true ;

            if ( isEmpty (inputValue) ) return false;

            if(!isEmpty(inputValue)  ){
                boolean = $scope.positiveIntegerPattern.test(inputValue);
            }
            return boolean;
        };

        $scope.isPositiveDecimal = function(inputValue) {

            // returns false if empty, or if not decimal(by regex comparison)
            if ( isEmpty (inputValue) ) return false;

            return $scope.positiveDecimalNumberPattern.test(inputValue);

        };
        

        $scope.validDateFormat = function( inputDate){
            // allows empty values for simplicity sake
            if ( isEmpty(inputDate)) return true;
            return $scope.dateFormat.test( inputDate );

        }

        $scope.isDegree = function(inputValue, degrees, submitted) {

            return ($scope.submitted == true && !isEmpty(inputValue) && !(Number(degrees) >= Number(inputValue) && Number(inputValue) >= -Number(degrees)));
        };

        $scope.isRequired = function(inputValue) {
            return  $scope.submitted == true && isEmpty(inputValue);
        };

        $scope.isModalRequired = function(inputValue) {
            var boolean = false;

            if(isEmpty(inputValue)){
                boolean=  true;
            }
            if(inputValue == undefined){
                boolean=  true;

            }
            else{
                if(inputValue.length == 0){
                    boolean=  true;
                }
            }

           /* if(inputValue == null){
                boolean=  true;
            }*/
            return   boolean;


        };


        $scope.checkboxClearInputs = function(plant, checkboxPath, dependingInputs) {
            var tokens1 = checkboxPath.split('.');
            var objectIdentifier1 = tokens1.shift();
            var checkboxObject = $scope.getPlantByPath(plant, objectIdentifier1);
            var property1 = tokens1[tokens1.length-1];
            var checkboxValue = checkboxObject[property1];

            if(checkboxValue == false){
                var inputPathArray = [];
                var isNotEmpty= false;
                var paths = dependingInputs.split(':');

                //Adding checkbox depending inputs to array
                for (var i = 0; i < paths.length; i++) {
                    var tokens2 = paths[i].split('.');
                    var objectIdentifier2 = tokens2.shift();
                    var parentObject = $scope.getPlantByPath(plant, objectIdentifier2);
                    var property = tokens2[tokens2.length-1];
                    var object = parentObject[property];
                    if($scope.positiveDecimalNumberPattern.test(object)){
                        object = object.toString();
                    }
                    //Error handling:  String in numeric field
                    if(object == null){
                        object = "";
                        isNotEmpty = false;
                    }
                    if(object == undefined){
                        object = "";
                        isNotEmpty = true;
                    }
                    inputPathArray.push(object)
                }

                //Is inputs empty
                for (var j = 0; j < inputPathArray.length; j++) {
                    if(inputPathArray[j].length > 0){
                        isNotEmpty = true;
                    }
                }


                if(checkboxValue == false && isNotEmpty){
                    if(confirm("Do you wish to clear data from depending input(s)?")){
                        for (var k = 0; k < paths.length; k++) {
                            var tokens3 = paths[k].split('.');
                            var objectIdentifier3 = tokens3.shift();
                            var parentObject2 = $scope.getPlantByPath(plant, objectIdentifier3);
                            var property2 = tokens3[tokens3.length-1];
                            parentObject2[property2] = "";

                        }
                    }else{
                    //checkbox rollback
                        checkboxObject[property1] = true;
                    }
                    return;
                }
            }
            else{
                var inputPathArray = [];
                var isNotEmpty= false;
                var paths = dependingInputs.split(':');

                //Adding checkbox depending inputs to array
                for (var i = 0; i < paths.length; i++) {
                    var tokens2 = paths[i].split('.');
                    var objectIdentifier2 = tokens2.shift();
                    var parentObject = $scope.getPlantByPath(plant, objectIdentifier2);
                    var property = tokens2[tokens2.length-1];
                    var object = parentObject[property];
                    if($scope.positiveDecimalNumberPattern.test(object)){
                        object = object.toString();
                    }
                    //Error handling:  String in numeric field
                    if(object == undefined){
                        object = "";
                        isNotEmpty = true;
                    }
                    inputPathArray.push(object)
                }

                //Is inputs empty
                for (var j = 0; j < inputPathArray.length; j++) {
                    if(inputPathArray[j].length > 0){
                        isNotEmpty = true;
                    }
                }

                if (tokens1 == 'Refineries' && checkboxValue == true && isNotEmpty){

                    if(confirm("Do you wish to clear data from depending input(s)?")){
                        for (var k = 0; k < paths.length; k++) {
                            var tokens3 = paths[k].split('.');
                            var objectIdentifier3 = tokens3.shift();
                            var parentObject2 = $scope.getPlantByPath(plant, objectIdentifier3);
                            var property2 = tokens3[tokens3.length-1];
                            parentObject2[property2] = "";

                        }
                    }else{
                        //checkbox rollback
                        checkboxObject[property1] = true;
                    }
                    return;
                }
            }
        }    ;

        $scope.isDesulphurizationRateEmpty = function (desulphurisation) {
            if (desulphurisation == null || desulphurisation.Months==null || desulphurisation.Months.Month==null  || desulphurisation.Months.Month.length==1) {
                return true;
            }
            if(desulphurisation.Months.Month.isArray){
            desulphurisation.Months.Month.forEach(function (element) {
                if (element.DesulphurisationRate == null) {
                    return true;
                }
            }, this);
        }
            return false;
        };

        $scope.isSulphurContentEmpty = function (desulphurisation) {
            if (desulphurisation == null || desulphurisation.Months==null || desulphurisation.Months.Month==null  || desulphurisation.Months.Month.length==1) {
                return true;
            }

            if(desulphurisation.Months.Month.isArray){                
            desulphurisation.Months.Month.forEach(function (element) {
                if (element.SulphurContent == null) {
                    return true;
                }

            }, this);
        }
            return false;
        };
        $scope.isTechnicalJustificationEmpty = function (desulphurisation) {
            if (desulphurisation == null || desulphurisation.Months==null || desulphurisation.Months.Month==null  || desulphurisation.Months.Month.length==1) {
                return true;
            }
            if(desulphurisation.Months.Month.isArray){
                
            desulphurisation.Months.Month.forEach(function (element) {

                if (element.TechnicalJustification == null || element.TechnicalJustification == '') {
                    return true;
                }

            }, this);
        }
            return false;
        };
        
    });
    function isEmpty(value){
        // returns true on undefined, empty array, empty string
        if(value === 0){
            return false;
        }
        else{
            return (!value || value === undefined || value.length === 0 || value === "" );
        }
    }



    // get instance data and save instance data
    app.factory('dataRepository', function($rootScope, $http) {
        var codeLists = {};
        //var lcpVocabularySetBaseUri = 'http://test.tripledev.ee/datadict/vocabulary/lcp/';
        //var lcpVocabularySetBaseUri = DD_VOCABULARY_BASE_URI + 'habides/';
     
     
        var EPRTRandlLCPVocabularySetBaseUri = DD_VOCABULARY_BASE_URI + 'EPRTRandLCP/';
        var EPRTRandLCPvocabularies =['CombustionPlantCategoryValue', 'CountryCodeValue', 'EPRTRPollutantCodeValue', 'FuelInputValue',
         'LCPPollutantCodeValue', 'MediumCodeValue', 'MethodClassificationValue', 'MethodCodeValue', 'MonthValue', 
         'OtherGaseousFuelValue', 'OtherSolidFuelValue', 'ReasonValue', 'UnitCodeValue', 'WasteClassificationValue',
          'WasteTreatmentValue'];
        var EPRTRandLCPvocabularyIdentifiersInCode = ['CombustionPlantCategoryValue', 'CountryCodeValue', 'EPRTRPollutantCodeValue', 'FuelInputValue',
         'LCPPollutantCodeValue', 'MediumCodeValue', 'MethodClassificationValue', 'MethodCodeValue', 'MonthValue', 
         'OtherGaseousFuelValue', 'OtherSolidFuelValue', 'ReasonValue', 'UnitCodeValue', 'WasteClassificationValue',
          'WasteTreatmentValue'];
        
      
  var lcpVocabularySetBaseUri = DD_VOCABULARY_BASE_URI + 'lcp/';
        var lcpVocabularies = ['lcpcountries','plantstatus','sectors'];
        var lcpVocabularyIdentifiersInCode = ['countries', 'status', 'sectors'];

        var commonVocabularySetBaseUri = DD_VOCABULARY_BASE_URI + 'common/';

        //define undefined members, i dont know if this is really necessary!!!
        codeLists.LCPCodelists = {};
        codeLists.OldLCPCodelists={};
        codeLists.CombustionPlantCodeLists={};
        codeLists.DerogationValueCodeLists={};
        codeLists.OtherSolidFuelCodeLists={};
        codeLists.OtherGasesousFuelCodeLists={};
        codeLists.MonthValueCodeLists={};
        codeLists.MonthlyDesulphurisation={};

        var regionCodeLists = {};
        for (var i = 0; i < EPRTRandLCPvocabularies.length; i++){
            codeLists.LCPCodelists[EPRTRandLCPvocabularyIdentifiersInCode[i]] = {};
        }
        for (var i = 0; i < lcpVocabularies.length; i++){
            codeLists.OldLCPCodelists[lcpVocabularyIdentifiersInCode[i]] = {};
        }
        return {
            getInstance: function() {
                var url = null;
                if (fileId){
                    url = getWebQUrl("/download/converted_user_file");
                }
				else {
                    url = "lcp-instance-test.json";
				}
                return $http.get(url, {tracker : $rootScope.loadingTracker});
            },
            saveInstance: function (data) {
                var url = getWebQUrl("/saveXml");
                fixUndefined(data);
                return $http.post(url, data, {tracker : $rootScope.loadingTracker});
            },
            getCodeList: function() {
                return codeLists;
            },
            loadCodeList: function(language) {
                //finds file in project folder
                var defaultlanguage = 'en';
                var currentLanguage = !language? defaultlanguage : language;

                for (var i = 0; i < EPRTRandLCPvocabularies.length; i++) {
                    var url = EPRTRandlLCPVocabularySetBaseUri + EPRTRandLCPvocabularies[i] + '/json?lang=' + currentLanguage;

                    if ($rootScope.isIE9 || window.isIE9){
                        url = baseUri + '/restProxy?uri=' + encodeURIComponent(url);
                    }

                    $http.get(url, {tracker: $rootScope.loadingTracker})
                            .error(function(data, status, headers, config){
                                alert("Failed to read code lists. Data = " +  data + ", status = " + status);})
                            .success((function(i){return function (newCodeList) {
                        angular.copy(newCodeList, codeLists.LCPCodelists[EPRTRandLCPvocabularyIdentifiersInCode[i]]);
                        ////console.log("received " + vocabularyIdentifiersInCode[i]);
                    }})(i));
                } 
            }, 
            loadOldLCPCodeList: function(language) {
                //finds file in project folder
                var defaultlanguage = 'en';
                var currentLanguage = !language? defaultlanguage : language;

                for (var i = 0; i < lcpVocabularies.length; i++) {
                    var url = lcpVocabularySetBaseUri + lcpVocabularies[i] + '/json?lang=' + currentLanguage;

                    if ($rootScope.isIE9 || window.isIE9){
                        url = baseUri + '/restProxy?uri=' + encodeURIComponent(url);
                    }

                    $http.get(url, {tracker: $rootScope.loadingTracker})
                            .error(function(data, status, headers, config){
                                alert("Failed to read code lists. Data = " +  data + ", status = " + status);})
                            .success((function(i){return function (newCodeList) {
                                console.log("newCodeList "+newCodeList);
                        angular.copy(newCodeList, codeLists.OldLCPCodelists[lcpVocabularyIdentifiersInCode[i]]);
                        ////console.log("received " + vocabularyIdentifiersInCode[i]);
                    }})(i));
                } 
            }, 
             loadCombustionPlantCodeList: function(language){
                // we do not need the for each of the above loadCodeList method, since in the above , it has to make seperate calls
                // for each vocabulary, whereas we do not have to.
                var defaultlanguage = 'en';
                var currentLanguage = !language? defaultlanguage : language;
                var url = 'http://dd.eionet.europa.eu/vocabulary/EPRTRandLCP/CombustionPlantCategoryValue/json';
                $http.get(url, {tracker: $rootScope.loadingTracker})
                .error(function(data, status, headers, config){
                    alert("Failed to read code lists. Data = " +  data + ", status = " + status);})
                .success( function (newCodeList) {
            angular.copy(newCodeList, codeLists.CombustionPlantCodeLists);
            ////console.log("received " + vocabularyIdentifiersInCode[i]);
                  });
            },
            loadDerogationValueCodeList: function(language){
                // we do not need the for each of the above loadCodeList method, since in the above , it has to make seperate calls
                // for each vocabulary, whereas we do not have to.
                var defaultlanguage = 'en';
                var currentLanguage = !language? defaultlanguage : language;
                var url = 'http://dd.eionet.europa.eu/vocabulary/euregistryonindustrialsites/DerogationValue/json';
                $http.get(url, {tracker: $rootScope.loadingTracker})
                .error(function(data, status, headers, config){
                    alert("Failed to read code lists. Data = " +  data + ", status = " + status);})
                .success( function (newCodeList) {
            angular.copy(newCodeList, codeLists.DerogationValueCodeLists);
            ////console.log("received " + vocabularyIdentifiersInCode[i]);
                  });
            },
            loadOtherSolidFuelCodeList: function(language){
                // we do not need the for each of the above loadCodeList method, since in the above , it has to make seperate calls
                // for each vocabulary, whereas we do not have to.
                var defaultlanguage = 'en';
                var currentLanguage = !language? defaultlanguage : language;
                var url = 'http://dd.eionet.europa.eu/vocabulary/EPRTRandLCP/OtherSolidFuelValue/json';
                $http.get(url, {tracker: $rootScope.loadingTracker})
                .error(function(data, status, headers, config){
                    alert("Failed to read code lists. Data = " +  data + ", status = " + status);})
                .success( function (newCodeList) {
                    //Push "Other" value to the end of the Array
                    var otherElement ={};
                    newCodeList.concepts.forEach(function(element) {
                        if(element['@id']=='Other'){
                            var OtherElementIndex = newCodeList.concepts.indexOf(element);
                            newCodeList.concepts.splice(OtherElementIndex,1);
                             Object.assign(otherElement,element);
                        }
                    }, this);
                    newCodeList.concepts.push(otherElement);
            angular.copy(newCodeList, codeLists.OtherSolidFuelCodeLists);
                  });
            },
            loadOtherGasesousFuelCodeList: function(language){
                // we do not need the for each of the above loadCodeList method, since in the above , it has to make seperate calls
                // for each vocabulary, whereas we do not have to.
                var defaultlanguage = 'en';
                var currentLanguage = !language? defaultlanguage : language;
                var url = 'http://dd.eionet.europa.eu/vocabulary/EPRTRandLCP/OtherGaseousFuelValue/json';
                $http.get(url, {tracker: $rootScope.loadingTracker})
                .error(function(data, status, headers, config){
                    alert("Failed to read code lists. Data = " +  data + ", status = " + status);})
                .success( function (newCodeList) {
                        //Push "Other" value to the end of the Array
                        var otherElement ={};
                        newCodeList.concepts.forEach(function(element) {
                            if(element['@id']=='Other'){
                                var OtherElementIndex = newCodeList.concepts.indexOf(element);
                                newCodeList.concepts.splice(OtherElementIndex,1);
                                 Object.assign(otherElement,element);
                            }
                        }, this);
                        newCodeList.concepts.push(otherElement);
            angular.copy(newCodeList, codeLists.OtherGasesousFuelCodeLists);
            ////console.log("received " + vocabularyIdentifiersInCode[i]);
                  });
            },
            loadMonthValueCodeList: function(language){
                // we do not need the for each of the above loadCodeList method, since in the above , it has to make seperate calls
                // for each vocabulary, whereas we do not have to.
                var defaultlanguage = 'en';
                var currentLanguage = !language? defaultlanguage : language;
                var url = 'http://dd.eionet.europa.eu/vocabulary/EPRTRandLCP/MonthValue/json';
                $http.get(url, {tracker: $rootScope.loadingTracker})
                .error(function(data, status, headers, config){
                    alert("Failed to read code lists. Data = " +  data + ", status = " + status);})
                .success( function (newCodeList) {
            angular.copy(newCodeList, codeLists.MonthValueCodeLists);
            ////console.log("received " + vocabularyIdentifiersInCode[i]);
            angular.forEach(codeLists.MonthValueCodeLists.concepts, function(value, key){
                          codeLists.MonthlyDesulphurisation[key]={
                    "DesulphurisationRate": '',
                    "MonthValue":value.prefLabel[0]['@value'],
                    "SulphurContent": '',
                    "TechnicalJustification": ''
                    };
                });
            });
        },
       
            loadRegionsCodelist: function(country) {
                var url = DD_VOCABULARY_BASE_URI + "common/nuts/json?id=" + country;
                if ($rootScope.isIE9 || window.isIE9){
                    url = baseUri + '/restProxy?uri=' + encodeURIComponent(url);
                }
                //console.log(url);
                $http.get(url, {tracker: $rootScope.loadingTracker})
                        .error(function(data, status, headers, config){alert("Failed to read regions code lists.");})
                        .success(function (newCodeList) {
                            angular.copy(newCodeList, regionCodeLists);
                            if(regionCodeLists.concepts.length == 0){
                                var url = DD_VOCABULARY_BASE_URI + "lcp/lcpcountries/json?id=" + country;
                                if ($rootScope.isIE9 || window.isIE9){
                                    url = baseUri + '/restProxy?uri=' + encodeURIComponent(url);
                                }
                                $http.get(url, {tracker: $rootScope.loadingTracker})
                                    .error(function(data, status, headers, config){alert("Failed to read regions code lists.");})
                                    .success(function (plantDetailsOtherSectorFieldsViewnewCodeList) {
                                    angular.copy(newCodeList, regionCodeLists);
                                });
                            }
                        });
                return regionCodeLists;
            },
            getEmptyInstance: function() {
                var url = 'lcp-instance-empty.xml?format=json';
                return $http.get(url, {tracker : $rootScope.loadingTracker});
            },
            loadInstanceInfo: function (data) {
                var url = getWebQUrl("/file/info");
                return $http.get(url, data, {tracker : $rootScope.loadingTracker});
            }
        }
    });

    // new
    app.filter('offset', function() {
        return function(input, start) {
            if (!input || !(input instanceof Array)) {
                return;
            }
            start = parseInt(start, 10);
            return input.slice(start);
        };
    });

    app.filter('formatDerogation', function () {
        return function (x) {
            var result = "";
            if (x != null) {
                x.forEach(function (entry) {
                    result += entry;
                    result += '\n';
                });
            }
            return result;
        };
    });

    app.controller('ModalCtrl', function ($scope, $rootScope, $modal, $http) {
        //saves Main form validation stage
        $scope.mainFormSubmitted = $scope.submitted;
        $scope.plant;
        $scope.originalPlant;

        $scope.submitted = false;
        $scope.editBoolean = false;
        /*$scope.edit = function (plant){
            $scope.editBoolean = true;
            $scope.plant= plant;
            $scope.open('lg');
        }*/
        $scope.add = function (){
            $scope.submitted = false;
            $scope.editBoolean = false;
            $scope.plant = null;
            $scope.open('lg');
        }
        $rootScope.$watch('selectedPlant', function(newValue, oldValue) {
            if (newValue && newValue != null ){
                $scope.submitted = true;
                $scope.editBoolean = true;
                $scope.originalPlant =  newValue;
                $scope.plant = angular.copy(newValue);
                $rootScope.selectedPlant = null;
                $scope.open('lg', $rootScope.modalPageCaseId);
            }
        });
        $scope.openAdd = function(){
            $rootScope.modalPageCaseId = "ListOfPlants";
            $rootScope.selectedPlant = null;
            $scope.open('lg','ListOfPlants');
        }
        $scope.loadDataFromEPRTR = function(plant) {
            console.log('loadDataFromEPRTR function invoked');
            var countryCode = $scope.instance.LCPQuestionnaire.BasicData.MemberState;
            if (countryCode && countryCode.length == 2 && plant ) {

                var eprtrCountryCode = countryCode === "GB" ? "UK" : countryCode === "GR" ? "EL" : countryCode;

                var url = "http://semantic.eea.europa.eu/sparql?format=application/json&query=";
                var sparql = "PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> " +
                        " PREFIX cr: <http://cr.eionet.europa.eu/ontologies/contreg.rdf#> " +
                        " PREFIX prtr: <http://prtr.ec.europa.eu/rdf/schema.rdf#> " +
                        " PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> " +
                        " SELECT ?countryCode ?NationalID ?facilityID ?facilityName ?streetName ?buildingNumber ?postalCode ?city ?lat ?long ?reportingYear" +
                        " WHERE { ?facility a prtr:Facility ; " +
                        " prtr:facilityID ?facilityID ; " +
                        " prtr:facilityName ?facilityName ; " +
                        " prtr:streetName ?streetName; " +
                        "prtr:buildingNumber  ?buildingNumber ; "+
                        " prtr:postalCode  ?postalCode ; " +
                        " prtr:city ?city ; " +
                        " geo:lat ?lat ; " +
                        " geo:long ?long ; " +
                        " prtr:latestReport ?latestreport ;" +
                        " prtr:inCountry ?inCountry . " +
                        " ?inCountry prtr:code ?countryCode . " +
                        " ?latestreport prtr:nationalID ?NationalID ;" +
                        " prtr:reportingYear ?reportingYear." +
                        " FILTER (?countryCode = '" + eprtrCountryCode + "' and UCASE(?NationalID) = UCASE('" + plant.EPRTRNationalId + "' ) ) } ORDER BY DESC(?reportingYear) LIMIT 1";
                url = baseUri + '/restProxy?uri=' + encodeURIComponent(url + encodeURIComponent(sparql));
                console.log('url for sparql eprtr data is:'+url);
                $http.get(url, {tracker : $rootScope.loadingTracker})
                        .error(function(){alert("Failed to read data from E-PRTR.");})
                        .success(function(eprtrData) {
                            if (eprtrData.results.bindings.length > 0) {
                            var facility = eprtrData.results.bindings[0];
                            if (confirm("The system found the following facility: " + facility.facilityName.value + ", " + facility.streetName.value + ", " + facility.postalCode.value +
                                    ", "  + facility.city.value + ". \n\n Do you want to use the data on plant level?" )) {
                                    if (!plant.PlantLocation) plant.PlantLocation = {};
                                    if (!plant.GeographicalCoordinate) plant.GeographicalCoordinate = {};
                                    plant.PlantLocation.Address1 = facility.streetName.value;
                                    if (!isEmpty(facility.buildingNumber.value)) {
                                        plant.PlantLocation.Address1 += " " + facility.buildingNumber.value;
                                    }
                                    plant.PlantLocation.City =facility.city.value;
                                    plant.PlantLocation.PostalCode = facility.postalCode.value;
                                    plant.PlantLocation.BuildingNumber = facility.buildingNumber.value;
                                    plant.GeographicalCoordinate.Longitude = facility.long.value;
                                    plant.GeographicalCoordinate.Latitude = facility.lat.value;
                                    plant.FacilityName = facility.facilityName.value;
                               }
                            }
                            else {
                                alert("The system could not find any facility with NationalID=" + plant.EPRTRNationalId);
                            }
                        });
            }
            else {
                alert("Member state is not selected on Basic Data form!");
            }
        };
        //edit(
        $scope.open = function (size,modalPageId) {
            //console.log(modalPageId);
            //console.log($rootScope.modalPageCaseId== undefined);
            //console.log($rootScope.modalPageCaseId=="ListOfPlants");
            //console.log($rootScope.modalPageCaseId=="PlantDetails");
            var modalInstance;
            //For adding new plant
            if(modalPageId == undefined){
                modalInstance = $modal.open({

                    templateUrl: 'ListOfPlantModalContent.html',
                    controller: 'ListOfPlantsModalInstanceCtrl',
                    size: size,
                    scope: $scope,
                    windowClass: 'app-modal-window',
                    resolve: {
                        plant: function () {
                            return  $scope.plant;
                        }
                    }

                });
            }
            //For editing plant
            if(modalPageId == "ListOfPlants"){
                modalInstance = $modal.open({

                    templateUrl: 'ListOfPlantModalContent.html',
                    controller: 'ListOfPlantsModalInstanceCtrl',
                    size: size,
                    scope: $scope,
                    windowClass: 'app-modal-window',
                    resolve: {
                        plant: function () {
                            return  $scope.plant;
                        }
                    }

                });
            }
            if(modalPageId == "PlantDetails"){
                 modalInstance = $modal.open({

                    templateUrl: 'PlantDetailsModalContent.html',
                    controller: 'PlantDetailsModalInstanceCtrl',
                    size: size,
                    scope: $scope,
                    windowClass: 'app-modal-window',
                    resolve: {
                        plant: function () {
                            return  $scope.plant;
                        }
                    }

                });
            }
            if(modalPageId=="TotalEmissionsToAir"){
                modalInstance = $modal.open({

                    templateUrl: 'TotalEmissionsToAirModalContent.html',
                    controller: 'TotalEmissionsToAirModalInstanceCtrl',
                    size: size,
                    scope: $scope,
                    windowClass: 'app-modal-window',
                    resolve: {
                        plant: function () {
                            return  $scope.plant;
                        }
                    }

                });
            }
            if(modalPageId=="EnergyInput"){
                modalInstance = $modal.open({

                    templateUrl: 'EnergyInputModalContent.html',
                    controller: 'EnergyInputModalInstanceCtrl',
                    size: size,
                    scope: $scope,
                    windowClass: 'app-modal-window',
                    resolve: {
                        plant: function () {
                            return  $scope.plant;
                        }
                    }

                });
            }
            if(modalPageId=="Desulphurisation"){
                modalInstance = $modal.open({

                    templateUrl: 'DesulphurisationModalContent.html',
                    controller: 'DesulphurisationModalInstanceCtrl',
                    size: size,
                    scope: $scope,
                    windowClass: 'app-modal-window',
                    resolve: {
                        plant: function () {
                            return  $scope.plant;
                        }
                    }

                });
            }
            if(modalPageId=="UsefulHeat"){
                modalInstance = $modal.open({

                    templateUrl: 'UsefulHeatModalContent.html',
                    controller: 'UsefulHeatModalInstanceCtrl',
                    size: size,
                    scope: $scope,
                    windowClass: 'app-modal-window',
                    resolve: {
                        plant: function () {
                            return  $scope.plant;
                        }
                    }

                });
            }

            modalInstance.result.then(function (selectedItem) {
                $scope.selected = selectedItem;
            }, function () {
                //$log.info('Modal dismissed at: ' + new Date());
            });
        };
    });

    app.controller('ListOfPlantsModalInstanceCtrl', function ($rootScope, $scope, $modalInstance, plant,dataRepository) {
        var edit = false;

        if(plant != undefined){
            edit = true;
        }

        if (JSON.stringify( $scope.regionsCodelist ) === "{}")  {

            if ( $scope.instance.LCPQuestionnaire.BasicData.MemberState )
                $scope.regionsCodelist = dataRepository.loadRegionsCodelist($scope.instance.LCPQuestionnaire.BasicData.MemberState);
            else {
                alert("Please fill in the Member State from Basic Info first.");
                $scope.submitted = $scope.mainFormSubmitted;
                $modalInstance.dismiss('cancel');
            }
        }

        $scope.ok = function (plant) {

            $scope.submitted = true;
            if(plant != undefined){
                if(plant.PlantName != null && plant.GeographicalCoordinate.Longitude != null &&
                        (180 >= plant.GeographicalCoordinate.Longitude && plant.GeographicalCoordinate.Longitude >= -180)  &&
                        plant.GeographicalCoordinate.Latitude != null && (90 >= plant.GeographicalCoordinate.Latitude && plant.GeographicalCoordinate.Latitude >= -90)){
                    if(!edit){

                        if ( plant.PlantLocation == null ) plant.PlantLocation = {} ;

                        var lastPlant = $scope.addItem('LCPQuestionnaire.ListOfPlants.Plant');
                        var promise = $scope.getNextPlantId () ;
                        // using $q promise API, to ask the server first for id collisions.
                        promise.then ( function ( plantid ) {

                            lastPlant.PlantId = plantid ;
                            lastPlant.PlantName =  plant.PlantName;
                            lastPlant.EPRTRNationalId =  plant.EPRTRNationalId;
                            lastPlant.PlantLocation.StreetName =  plant.PlantLocation.StreetName;
                         //   lastPlant.PlantLocation.Address2 =  plant.PlantLocation.Address2;
                            lastPlant.PlantLocation.City =  plant.PlantLocation.City;
                            lastPlant.PlantLocation.Region =  plant.PlantLocation.Region;
                            lastPlant.PlantLocation.PostalCode =  plant.PlantLocation.PostalCode;
                            lastPlant.PlantLocation.BuildingNumber =  plant.PlantLocation.BuildingNumber;
                            lastPlant.PlantLocation.CountryCode =  $scope.memberStateValue;
                            lastPlant.GeographicalCoordinate.Longitude =  plant.GeographicalCoordinate.Longitude;
                            lastPlant.GeographicalCoordinate.Latitude =  plant.GeographicalCoordinate.Latitude;
                            lastPlant.FacilityName =  plant.FacilityName;
                            lastPlant.Comments =  plant.Comments;

                            $rootScope.$broadcast('updateFilter');

                            //load Main form validation stage
                            $scope.submitted = $scope.mainFormSubmitted;
                            $scope.saveInstance();
                             $modalInstance.close(plant);

                        })

                    }
                    else{
                        var lastPlant = $scope.originalPlant;
                        lastPlant.PlantName =  plant.PlantName;
                        lastPlant.EPRTRNationalId =  plant.EPRTRNationalId;
                        lastPlant.PlantLocation.StreetName =  plant.PlantLocation.StreetName;
                        //lastPlant.PlantLocation.Address2 =  plant.PlantLocation.Address2;
                        lastPlant.PlantLocation.City =  plant.PlantLocation.City;
                        lastPlant.PlantLocation.Region =  plant.PlantLocation.Region;
                        lastPlant.PlantLocation.BuildingNumber =  plant.PlantLocation.BuildingNumber;
                        lastPlant.PlantLocation.PostalCode =  plant.PlantLocation.PostalCode;
                        lastPlant.PlantLocation.CountryCode =  plant.PlantLocation.CountryCode;
                        lastPlant.GeographicalCoordinate.Longitude =  plant.GeographicalCoordinate.Longitude;
                        lastPlant.GeographicalCoordinate.Latitude =  plant.GeographicalCoordinate.Latitude;
                        lastPlant.FacilityName =  plant.FacilityName;
                        lastPlant.Comments =  plant.Comments;

                        $rootScope.$broadcast('updateFilter');

                        //load Main form validation stage
                        $scope.submitted = $scope.mainFormSubmitted;
                            $scope.saveInstance();
                                             $modalInstance.close(plant);


                     }

                } else{
                     $scope.submitted = true;
                     alert("Please fill in all mandatory fields!");
                 }
            } else{
                 $scope.submitted = true;
                 alert("Please fill in all mandatory fields!");
             }

        };
        $scope.saveAndAdd =  function(plant){
            $scope.ok(plant);
            saveInstance();
        }
        $scope.cancel = function () {
            //load Main form validation stage
            $scope.submitted = $scope.mainFormSubmitted;
            $modalInstance.dismiss('cancel');
        };
    });
    app.controller('PlantDetailsModalInstanceCtrl', function ($rootScope, $filter, $scope, $modalInstance, plant) {
        $scope.ok = function (plant) {
            if (!$scope.modalPlantDetails.$invalid) {
                var lastPlant = $scope.originalPlant;

                lastPlant.PlantDetails.TypeOfCombustionPlant = plant.PlantDetails.TypeOfCombustionPlant;
                lastPlant.PlantDetails.MWth =  plant.PlantDetails.MWth;
                lastPlant.PlantDetails.DateOfStartOfOperation =  plant.PlantDetails.DateOfStartOfOperation;
                lastPlant.PlantDetails.Derogation = plant.PlantDetails.Derogation;
                lastPlant.PlantDetails.Refineries =  $filter('lowercase')(plant.PlantDetails.Refineries);
                lastPlant.PlantDetails.OtherSector =  plant.PlantDetails.OtherSector;
               
                lastPlant.PlantDetails.OperatingHours =  plant.PlantDetails.OperatingHours;
                lastPlant.PlantDetails.Comments =  plant.PlantDetails.Comments;

                $rootScope.$broadcast('updateFilter');

                //load Main form validation stage
                $scope.submitted = $scope.mainFormSubmitted;
                $scope.modalPlantDetails.$setPristine(true);
                $modalInstance.close(plant);
            }
            else{
                $scope.submitted = true;
                alert("Please fill in all mandatory fields! ");
            }


        }

        $scope.cancel = function () {
            //load Main form validation stage
            $scope.submitted = $scope.mainFormSubmitted;
            $modalInstance.dismiss('cancel');
        };
    });

    app.controller('TotalEmissionsToAirModalInstanceCtrl', function ($rootScope, $scope, $modalInstance, plant) {

        $scope.ok = function (plant) {
            if (!$scope.modalTotalEmissionsToAir.$invalid) {
                var lastPlant = $scope.originalPlant;

                lastPlant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.SO2 =  plant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.SO2;
                lastPlant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.NOx =  plant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.NOx;
                lastPlant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.TSP =  plant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.TSP;

                $rootScope.$broadcast('updateFilter');

                //load Main form validation stage
                $scope.submitted = $scope.mainFormSubmitted;
                $scope.modalTotalEmissionsToAir.$setPristine(true);
                $modalInstance.close(plant);
            }
            else{
                $scope.submitted = true;
                alert("Please fill in all mandatory fields! ");
            }


        }

        $scope.cancel = function () {
            //load Main form validation stage
            $scope.submitted = $scope.mainFormSubmitted;
            $modalInstance.dismiss('cancel');
        };
    });
app.controller('EnergyInputModalInstanceCtrl', function ($rootScope, $scope, $modalInstance, plant) {

        $scope.ok = function (plant) {
            if (!$scope.modalEnergyInput.$invalid) {
                var lastPlant = $scope.originalPlant;

                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Biomass =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Biomass;
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Biomass =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Biomass;  
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Coal =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Coal;      
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Lignite =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Lignite;      
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Peat =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Peat;      
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.Category =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.Category;
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.Value =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.Value;
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.LiquidFuels =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.LiquidFuels;
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.NaturalGas =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.NaturalGas;
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.Category =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.Category;
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.Value =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.Value;

                $rootScope.$broadcast('updateFilter');

                //load Main form validation stage
                $scope.submitted = $scope.mainFormSubmitted;
                $scope.modalEnergyInput.$setPristine(true);
                $modalInstance.close(plant);
            }
            else{
                $scope.submitted = true;
                alert("Please fill in all mandatory fields! ");
            }


        }

        $scope.cancel = function () {
            //load Main form validation stage
            $scope.submitted = $scope.mainFormSubmitted;
            $modalInstance.dismiss('cancel');
        };
    });

    
            app.controller('DesulphurisationModalInstanceCtrl', function ($rootScope, $scope, $modalInstance, plant) {

                //We check if Month is an array and if not initialize it as an array in order to then fill it below.
                if(plant.Desulphurisation.Months==null || plant.Desulphurisation.Months.Month==null  || plant.Desulphurisation.Months.Month.constructor === Object || plant.Desulphurisation.Months.Month.length==1) {
                    plant.Desulphurisation.Months.Month=[];
                //If Months Empty , initialize them before the modal
                angular.forEach($scope.codeList.MonthlyDesulphurisation, function (value, key) {
                    if (plant.Desulphurisation.Months.Month[key]==null){
                         plant.Desulphurisation.Months.Month.push({
                                "MonthValue": value.MonthValue,
                                "DesulphurisationRate": null,
                                "SulphurContent": null,
                                "TechnicalJustification": null
                            });
                    }

                })
                }
               

                $scope.ok = function (plant) {
                    if (!$scope.modalDesulphurisation.$invalid) {
                        var lastPlant = $scope.originalPlant;
                        angular.forEach($scope.codeList.MonthlyDesulphurisation, function (value, key) {
                     /**       plant.Desulphurisation.Months.Month.push({
                                "MonthValue": value.MonthValue,
                                "DesulphurisationRate": value.DesulphurisationRate,
                                "SulphurContent": value.SulphurContent,
                                "TechnicalJustification": value.TechnicalJustification
                            });
                        **/
                        })

                        lastPlant.Desulphurisation = plant.Desulphurisation;
                        $rootScope.$broadcast('updateFilter');
                        //load Main form validation stage
                        $scope.submitted = $scope.mainFormSubmitted;
                        $scope.modalDesulphurisation.$setPristine(true);
                        $modalInstance.close(plant);

                    }
                    else {
                        $scope.submitted = true;
                        alert("Please fill in all mandatory fields! ");
                    }


                }

                $scope.cancel = function () {
                    //load Main form validation stage
                    $scope.submitted = $scope.mainFormSubmitted;
                    $modalInstance.dismiss('cancel');
                };
            });

            app.controller('UsefulHeatModalInstanceCtrl', function ($rootScope, $scope, $modalInstance, plant) {
                
                        $scope.ok = function (plant) {
                            if (!$scope.modalUsefulHeat.$invalid) {
                                var lastPlant = $scope.originalPlant;
                
                                lastPlant.UsefulHeat.UsefulHeatProportion =  plant.UsefulHeat.UsefulHeatProportion;
                              
                                $rootScope.$broadcast('updateFilter');
                
                                //load Main form validation stage
                                $scope.submitted = $scope.mainFormSubmitted;
                                $scope.modalUsefulHeat.$setPristine(true);
                                $modalInstance.close(plant);
                            }
                            else{
                                $scope.submitted = true;
                                alert("Please fill in all mandatory fields! ");
                            }
                
                
                        }
                
                        $scope.cancel = function () {
                            //load Main form validation stage
                            $scope.submitted = $scope.mainFormSubmitted;
                            $modalInstance.dismiss('cancel');
                        };
                    });

  
    app.filter('true_false', function() {
        return function(text, length, end) {
            if (text && (text === true || text === 'TRUE')) {
                return 'Yes';
            }
            return 'No';
        }
    });

    app.controller("PaginationCtrl", function($scope, $filter, $rootScope, $modal) {



        var orderBy = $filter('orderBy');
        /*
            if (!angular.isArray($scope.instance.LCPQuestionnaire.ListOfPlants)){
                $scope.instance.LCPQuestionnaire.ListOfPlants = [$scope.instance.LCPQuestionnaire.ListOfPlants];
            }
        */


        $scope.itemsPerPage = 50;
        $scope.currentPage = 0;
        $scope.maxPages = 15;
        $scope.searchText = "";
        $scope.filteredItems = [];
        $scope.predicateAttribute = 'PlantId';
        $scope.showMessage = false;
        $scope.predicate = function(item) {
            return item[$scope.predicateAttribute];
        }
        $scope.reverse = false;



        $scope.order = function(attribute, order) {
            $scope.predicateAttribute = attribute;
            $scope.reverse = order;
            $scope.filteredItems = orderBy($scope.filteredItems, $scope.predicate, $scope.reverse);
        };

        $scope.$on('instanceReady', function(event, data) {

            $scope.filteredItems = $scope.getFilteredItems();
        });

        $scope.$on('updateFilter', function(event, data) {

            $scope.filteredItems = $scope.getFilteredItems();
            $scope.order($scope.predicateAttribute, $scope.reverse);
        });

        $scope.range = function() {
            if (!$scope.instance) {
                return;
            }

            var rangeSize = ($scope.pageCount() >= $scope.MaxPages)? $scope.MaxPages : $scope.pageCount()+1;
            var ret = [];
            var start;

            start = $scope.currentPage;
            if ( start > $scope.pageCount()-rangeSize ) {
                start = $scope.pageCount()-rangeSize+1;
            }

            for (var i=start; i<start+rangeSize; i++) {
                ret.push(i);
            }
            return ret;
        };

        $scope.prevPage = function() {
            if ($scope.currentPage > 0) {
                $scope.currentPage--;
            }
        };

        $scope.prevPageDisabled = function() {
            return $scope.currentPage === 0 ? "disabled" : "";
        };

        $scope.getFilteredItems = function() {
            if (!$scope.instance) {
                return;
            }
            return $filter('filter')($scope.instance.LCPQuestionnaire.ListOfPlants.Plant, $scope.searchText);
        }

        $scope.refreshItems = function() {
            ////console.log("Filter changed. Getting new items...");
            $scope.filteredItems = $scope.getFilteredItems();
        };

        $scope.$watch('searchText', function(newValue, oldValue) {
            ////console.log("Filter changed. Getting new items...");
            $scope.filteredItems = $scope.getFilteredItems();
            if(newValue != oldValue){
                $scope.setPage(0);
            }
        });

        $scope.pageCount = function() {
            if (!$scope.instance || !$scope.filteredItems) {
                return;
            }

            var items = $scope.filteredItems;
            var count = Math.ceil(items.length/$scope.itemsPerPage)-1;
            return count;
        };

        $scope.nextPage = function() {
            if ($scope.currentPage < $scope.pageCount()) {
                $scope.currentPage++;
            }
        };

        $scope.nextPageDisabled = function() {
            return $scope.currentPage === $scope.pageCount() ? "disabled" : "";
        };

        $scope.setPage = function(n) {
            $scope.currentPage = n;
        };
        $scope.deleteSelected = function(selectedItems){
            var i;
            for (i = 0; i < selectedItems.length; ++i) {
                if(selectedItems[i].Delete != undefined){
                    if(selectedItems[i].Delete == true){
                        if ((countNonEmptyProperties(selectedItems[i]) > 0) && $scope.showMessage == false) {
                            if (!confirm('Are you sure you want to delete the selected rows?')){
                                $scope.showMessage = false;
                                return;
                                                                                        }
                            else{
                                $scope.showMessage = true;
                                }
                        }
                        $scope.remove($scope.instance.LCPQuestionnaire.ListOfPlants.Plant, selectedItems[i], false);
                    }
                }

            }

            $scope.showMessage = false;
            $rootScope.$broadcast('updateFilter');
        }
        $scope.edit = function (plant, modalPageId) {
            //$rootScope.$broadcast('editPlant', plant);
            $rootScope.selectedPlant = plant;
            $rootScope.modalPageCaseId = modalPageId;
/*
            var modalInstance = $modal.open({
                templateUrl: 'ListOfPlantModalContent.html',
                controller: 'ListOfPlantsModalInstanceCtrl',
                size: 'lg',
                scope: $scope,
                windowClass: 'app-modal-window',
                resolve: {
                    plant: function () {
                        return  plant;
                    }
                }
            });
            */
        };

        //orderObjectBy pagination
        //$scope.plantObjects = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant;
        $scope.criteria = 'PlantName';
        $scope.direction = false;
        $scope.setCriteria = function(criteria) {
            if ($scope.criteria === criteria) {
                $scope.direction = !$scope.direction;
            } else {
                $scope.criteria = criteria;
                $scope.direction  = false;
            }
        }
    });


    // new end

    function getWebQUrl(path){
        var url = baseUri + path;
        url += "?fileId=" + fileId;
        if (sessionId && sessionId != null) {
            url += "&sessionid=" + sessionId;
        }
        return url;
    }
    // helper function for getting query string parameter values. AngularJS solution $location.search() doesn't work in IE8.
    function getParameterByName(name) {
        var searchArr = window.location.search.split('?');
        var search = '?' + searchArr[searchArr.length - 1];
        var match = new RegExp('[?&]' + name + '=([^&]*)').exec(search);
        return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
    };

    function getHandsontableColHeaders(form) {
        if (form == 'ListOfPlants'){
            return ["Plant Name", "Plant Id", "E-PRTR national ID", "Street Name ", "City", "Region", "Postal code","Country Code","Building Number", "Longitude", "Latitude", "Facility name", "Comments"]
        }
        else if (form == 'PlantDetails'){
            return ["Plant name", "Plant ID", "MWth","Type of Combustion Plant", "Date of start of operation", "Refineries",  "Gas turbine", "MWth - gas turbine", "Boiler", "MWth - boiler","Other","Other type of combustion", "MWth - other", "Operating hours","Derogation", "Comments"]
        }
        else if (form == 'EnergyInput'){
            return ["Plant name", "Plant ID", "Biomass (TJ)","Coal","Lignite","Peat", "Other solid fuels (TJ) Category","Other solid fuels (TJ) Value" , "Liquid fuels (TJ)", "Natural gas (TJ)", "Other gases (TJ) Category","Other gases (TJ) Value", "SO2 (t)", "NOx (t)", "Dust (t)"]
        }
        else if (form == 'TotalEmissionsToAir'){
            return ["Plant name", "Plant ID", "SO2 (t)", "NOx (t)", "TSP (t)"]
        }
        else if (form == 'Desulphurisation'){
            return ["Desulphurisation Rate", "Sulphur Content", "Technical Justification", "Month"]
        }
        else if (form == 'UsefulHeat'){
            return ["UsefulHeat Proportion"]
        }
        else {
            //default is the first table
            return ["Plant Name", "Plant Id", "E-PRTR national ID", "Address 1", "Address 2", "City", "Region", "Postal code", "Longitude", "Latitude", "Facility name"]
        }
    }
	app.directive('uiHandsontable', function () {
	return {
		restrict: 'A',
		scope: {
			data: '=',
            status: '=',
            formname: '='
		},
		replace: true,
		link: function (scope, elem, attrs) {
            scope.$watch('status', function(newValue, oldValue) {
                // console.log('watch:' + newValue + '; form=' + scope.formname);
                if(newValue == true && angular.isArray(scope.data)){
                    elem.handsontable('loadData', scope.data);
                }
            });
            //console.log(scope.formname);
            var data = scope.data;
            var formname = scope.formname;
            var container = elem;

			elem.handsontable({
			    data: data,
                    contextMenu:false,// ['row_above', 'row_below', 'remove_row'],
				rowHeaders: false,
                columnSorting: false,
                stretchH: 'all',
                fixedColumnsLeft: 2,
                minSpareRows: 1, // formname === 'ListOfPlants' ? 1 : 0,
                minSpareCols: 0,
                //maxRows: formname === 'ListOfPlants' ? 200 : data.length,
                //maxCols: data.numberOfColumns,
                colHeaders: getHandsontableColHeaders(formname),
                columns:
                        (formname === 'ListOfPlants' ?
                            [
                                {data: "PlantName"}, {data: "PlantId", readOnly: true},
                                {data: "EPRTRNationalId"},
                                {data: "PlantLocation.StreetName"},
                                  {data: "PlantLocation.City"}, {data: "PlantLocation.Region"}, {data: "PlantLocation.PostalCode"},{data: "PlantLocation.CountryCode"},{data: "PlantLocation.BuildingNumber"},
                                {data: "GeographicalCoordinate.Longitude", type: 'numeric', format: '0.[00000]'},
                                 {data: "GeographicalCoordinate.Latitude", type: 'numeric', format: '0.[00000]'},
                                {data: "FacilityName"},{data: "Comments"}
                            ]
                    : formname == 'PlantDetails' ?
                            [
                                {data: "PlantName", readOnly: true}, {data: "PlantId", readOnly: true},
                                {data: "PlantDetails.DateOfStartOfOperation"},
                                {data: "PlantDetails.Refineries", type: 'checkbox'}, {data: "PlantDetails.OtherSector", type: 'dropdown', source: [{iron_steel:"iron_steel"}, "esi", "district_heating", "chp", "other"]},
                                {data: "PlantDetails.OperatingHours", type: 'numeric'}, {data: "PlantDetails.Comments"}
                            ]
                   : formname == 'EnergyInput' ?
                            [
                                {data: "PlantName", readOnly: true}, {data: "PlantId", readOnly: true},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.Biomass", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.Coal", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.Lignite", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.Peat", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.Category"},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.Value", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.LiquidFuels", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.NaturalGas", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.Category"},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.Value", type: 'numeric', format: '0.[00000]'},

                            ]         
                    : formname == 'TotalEmissionsToAir' ?
                            [
                                {data: "PlantName", readOnly: true}, {data: "PlantId", readOnly: true},
                                {data: "EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.SO2", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.NOx", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.TSP", type: 'numeric', format: '0.[00000]'}
                            ]
                    : formname == 'Desulphurisation' ?
                           [
                                {data: "PlantName", readOnly: true}, {data: "PlantId", readOnly: true},
                                {data: "Desulphurisation.DesulphurisationRate", type: 'numeric', format: '0.[00000]'},
                                {data: "Desulphurisation.SulphurContent", type: 'numeric', format: '0.[00000]'},
                                {data: "Desulphurisation.TechnicalJustification" }
                            ]
                    : formname == 'UsefulHeat' ?
                            [
                                {data: "PlantName", readOnly: true}, {data: "PlantId", readOnly: true},
                                {data: "UsefulHeat.UsefulHeatProportion", type: 'numeric', format: '0.[00000]'},
                            ]
                   
                    :[]),
                    onSelection: function (row, col, row2, col2) {
                        var meta = container.handsontable('getCellMeta', row2, col2);
                        if (meta.readOnly) {
                            container.handsontable('updateSettings', {fillHandle: false});
                        }
                        else {
                            container.handsontable('updateSettings', {fillHandle: true});
                        }
                    },
                cells: function (row, col, prop) {
                    var cellProperties = {};
                    if (conditionalReadonlyFields.indexOf(prop) >= 0) {
                        this.renderer = numericConditionalreadOnlyRenderer;
                    }
                    return cellProperties;
                }
        });
    }
	}
});
    var conditionalReadonlyFields = ["PlantDetails.CapacityAddedMW", "PlantDetails.CapacityAffectedMW", "PlantDetails.OtherSector", "PlantDetails.GasTurbineThermalInput",
        "PlantDetails.BoilerThermalInput", "PlantDetails.GasEngineThermalInput", "PlantDetails.DieselEngineTurbineThermalInput", "PlantDetails.DieselEngineTurbineThermalInput",
        "PlantDetails.OtherTypeOfCombustion", "PlantDetails.OtherThermalInput",
        "OptOutsAndNERP.CapacityOptedOutMW", "OptOutsAndNERP.HoursOperated",
        "LcpArt15.OperatingHours", "LcpArt15.ElvSO2",
        "LcpArt15.NotaBeneElvSO2", "LcpArt15.DesulphurisationRate", "LcpArt15.SInput",
        "LcpArt15.AnnexVI_A_Footnote2_OperatingHours", "LcpArt15.ElvNOx",
        "LcpArt15.VolatileContents", "LcpArt15.AnnexVI_A_Footnote3_ElvNOx"]
    function numericConditionalreadOnlyRenderer(instance, td, row, col, prop, value, cellProperties) {

        if (prop === "PlantDetails.OtherTypeOfCombustion") {
            Handsontable.renderers.TextRenderer.apply(this, arguments);
        }
        else if (prop === "PlantDetails.OtherSector") {
            Handsontable.renderers.AutocompleteRenderer.apply(this, arguments);
        }
        else {
            Handsontable.renderers.NumericRenderer.apply(this, arguments);
        }
        var colIndex = (
                (prop === "PlantDetails.OtherThermalInput" || prop ===  "OptOutsAndNERP.HoursOperated"
                                || prop === "LcpArt15.ElvSO2" || prop ===  "LcpArt15.DesulphurisationRate"
                                || prop === "LcpArt15.ElvNOx" || prop ===  "LcpArt15.AnnexVI_A_Footnote3_ElvNOx")
                                ? col - 2 : (prop === "LcpArt15.SInput") ? col - 3 : col - 1);
        var booleanValue = prop === "PlantDetails.OtherSector" ? false : true;
        var checkboxValue = instance.getDataAtCell(row, colIndex) === null || instance.getDataAtCell(row, colIndex) === '' ? false : instance.getDataAtCell(row, colIndex);
        if (checkboxValue != booleanValue ) {
            cellProperties.readOnly = true;
            td.style.background = '#EEE';
        }
    }

},{}],2:[function(require,module,exports){
/*
 * angular-elastic v2.3.3
 * (c) 2014 Monospaced http://monospaced.com
 * License: MIT
 */

angular.module('monospaced.elastic', [])

  .constant('msdElasticConfig', {
    append: ''
  })

  .directive('msdElastic', ['$timeout', '$window', 'msdElasticConfig', function($timeout, $window, config) {
    'use strict';

    return {
      require: 'ngModel',
      restrict: 'A, C',
      link: function(scope, element, attrs, ngModel) {

        // cache a reference to the DOM element
        var ta = element[0],
            $ta = element;

        // ensure the element is a textarea, and browser is capable
        if (ta.nodeName !== 'TEXTAREA' || !$window.getComputedStyle) {
          return;
        }

        // set these properties before measuring dimensions
        $ta.css({
          'overflow': 'hidden',
          'overflow-y': 'hidden',
          'word-wrap': 'break-word'
        });

        // force text reflow
        var text = ta.value;
        ta.value = '';
        ta.value = text;

        var appendText = attrs.msdElastic || config.append,
            append = appendText === '\\n' ? '\n' : appendText,
            $win = angular.element($window),
            mirrorStyle = 'position: absolute; top: -999px; right: auto; bottom: auto; left: 0 ;' +
                          'overflow: hidden; -webkit-box-sizing: content-box;' +
                          '-moz-box-sizing: content-box; box-sizing: content-box;' +
                          'min-height: 0 !important; height: 0 !important; padding: 0;' +
                          'word-wrap: break-word; border: 0;',
            $mirror = angular.element('<textarea tabindex="-1" ' +
                                      'style="' + mirrorStyle + '"/>').data('elastic', true),
            mirror = $mirror[0],
            taStyle = getComputedStyle(ta),
            resize = taStyle.getPropertyValue('resize'),
            borderBox = taStyle.getPropertyValue('box-sizing') === 'border-box' ||
                        taStyle.getPropertyValue('-moz-box-sizing') === 'border-box' ||
                        taStyle.getPropertyValue('-webkit-box-sizing') === 'border-box',
            boxOuter = !borderBox ? {width: 0, height: 0} : {
                          width:  parseInt(taStyle.getPropertyValue('border-right-width'), 10) +
                                  parseInt(taStyle.getPropertyValue('padding-right'), 10) +
                                  parseInt(taStyle.getPropertyValue('padding-left'), 10) +
                                  parseInt(taStyle.getPropertyValue('border-left-width'), 10),
                          height: parseInt(taStyle.getPropertyValue('border-top-width'), 10) +
                                  parseInt(taStyle.getPropertyValue('padding-top'), 10) +
                                  parseInt(taStyle.getPropertyValue('padding-bottom'), 10) +
                                  parseInt(taStyle.getPropertyValue('border-bottom-width'), 10)
                        },
            minHeightValue = parseInt(taStyle.getPropertyValue('min-height'), 10),
            heightValue = parseInt(taStyle.getPropertyValue('height'), 10),
            minHeight = Math.max(minHeightValue, heightValue) - boxOuter.height,
            maxHeight = parseInt(taStyle.getPropertyValue('max-height'), 10),
            mirrored,
            active,
            copyStyle = ['font-family',
                         'font-size',
                         'font-weight',
                         'font-style',
                         'letter-spacing',
                         'line-height',
                         'text-transform',
                         'word-spacing',
                         'text-indent'];

        // exit if elastic already applied (or is the mirror element)
        if ($ta.data('elastic')) {
          return;
        }

        // Opera returns max-height of -1 if not set
        maxHeight = maxHeight && maxHeight > 0 ? maxHeight : 9e4;

        // append mirror to the DOM
        if (mirror.parentNode !== document.body) {
          angular.element(document.body).append(mirror);
        }

        // set resize and apply elastic
        $ta.css({
          'resize': (resize === 'none' || resize === 'vertical') ? 'none' : 'horizontal'
        }).data('elastic', true);

        /*
         * methods
         */

        function initMirror() {
          mirrored = ta;
          // copy the essential styles from the textarea to the mirror
          taStyle = getComputedStyle(ta);
          angular.forEach(copyStyle, function(val) {
            mirrorStyle += val + ':' + taStyle.getPropertyValue(val) + ';';
          });
          mirror.setAttribute('style', mirrorStyle);
        }

        function adjust() {
          var taHeight,
              mirrorHeight,
              width,
              overflow;

          if (mirrored !== ta) {
            initMirror();
          }

          // active flag prevents actions in function from calling adjust again
          if (!active) {
            active = true;

            mirror.value = ta.value + append; // optional whitespace to improve animation
            mirror.style.overflowY = ta.style.overflowY;

            taHeight = ta.style.height === '' ? 'auto' : parseInt(ta.style.height, 10);

            // update mirror width in case the textarea width has changed
            width = parseInt(getComputedStyle(ta).getPropertyValue('width'), 10) - boxOuter.width;
            mirror.style.width = width + 'px';

            mirrorHeight = mirror.scrollHeight;

            if (mirrorHeight > maxHeight) {
              mirrorHeight = maxHeight;
              overflow = 'scroll';
            } else if (mirrorHeight < minHeight) {
              mirrorHeight = minHeight;
            }
            mirrorHeight += boxOuter.height;

            ta.style.overflowY = overflow || 'hidden';

            if (taHeight !== mirrorHeight) {
              ta.style.height = mirrorHeight + 'px';
              scope.$emit('elastic:resize', $ta);
            }

            // small delay to prevent an infinite loop
            $timeout(function() {
              active = false;
            }, 1);

          }
        }

        function forceAdjust() {
          active = false;
          adjust();
        }

        /*
         * initialise
         */

        // listen
        if ('onpropertychange' in ta && 'oninput' in ta) {
          // IE9
          ta['oninput'] = ta.onkeyup = adjust;
        } else {
          ta['oninput'] = adjust;
        }

        $win.bind('resize', forceAdjust);

        scope.$watch(function() {
          return ngModel.$modelValue;
        }, function(newValue) {
          forceAdjust();
        });

        scope.$on('elastic:adjust', function() {
          forceAdjust();
        });

        $timeout(adjust);

        /*
         * destroy
         */

        scope.$on('$destroy', function() {
          $mirror.remove();
          $win.unbind('resize', forceAdjust);
        });
      }
    };

  }]);

},{}],3:[function(require,module,exports){
/*
 AngularJS v1.2.16
 (c) 2010-2014 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(O,U,s){'use strict';function t(b){return function(){var a=arguments[0],c,a="["+(b?b+":":"")+a+"] http://errors.angularjs.org/1.2.16/"+(b?b+"/":"")+a;for(c=1;c<arguments.length;c++)a=a+(1==c?"?":"&")+"p"+(c-1)+"="+encodeURIComponent("function"==typeof arguments[c]?arguments[c].toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof arguments[c]?"undefined":"string"!=typeof arguments[c]?JSON.stringify(arguments[c]):arguments[c]);return Error(a)}}function ab(b){if(null==b||Ca(b))return!1;
var a=b.length;return 1===b.nodeType&&a?!0:w(b)||M(b)||0===a||"number"===typeof a&&0<a&&a-1 in b}function q(b,a,c){var d;if(b)if(P(b))for(d in b)"prototype"==d||("length"==d||"name"==d||b.hasOwnProperty&&!b.hasOwnProperty(d))||a.call(c,b[d],d);else if(b.forEach&&b.forEach!==q)b.forEach(a,c);else if(ab(b))for(d=0;d<b.length;d++)a.call(c,b[d],d);else for(d in b)b.hasOwnProperty(d)&&a.call(c,b[d],d);return b}function Qb(b){var a=[],c;for(c in b)b.hasOwnProperty(c)&&a.push(c);return a.sort()}function Sc(b,
a,c){for(var d=Qb(b),e=0;e<d.length;e++)a.call(c,b[d[e]],d[e]);return d}function Rb(b){return function(a,c){b(c,a)}}function bb(){for(var b=ka.length,a;b;){b--;a=ka[b].charCodeAt(0);if(57==a)return ka[b]="A",ka.join("");if(90==a)ka[b]="0";else return ka[b]=String.fromCharCode(a+1),ka.join("")}ka.unshift("0");return ka.join("")}function Sb(b,a){a?b.$$hashKey=a:delete b.$$hashKey}function D(b){var a=b.$$hashKey;q(arguments,function(a){a!==b&&q(a,function(a,c){b[c]=a})});Sb(b,a);return b}function Y(b){return parseInt(b,
10)}function Tb(b,a){return D(new (D(function(){},{prototype:b})),a)}function C(){}function Da(b){return b}function aa(b){return function(){return b}}function E(b){return"undefined"===typeof b}function B(b){return"undefined"!==typeof b}function X(b){return null!=b&&"object"===typeof b}function w(b){return"string"===typeof b}function vb(b){return"number"===typeof b}function Na(b){return"[object Date]"===wa.call(b)}function M(b){return"[object Array]"===wa.call(b)}function P(b){return"function"===typeof b}
function cb(b){return"[object RegExp]"===wa.call(b)}function Ca(b){return b&&b.document&&b.location&&b.alert&&b.setInterval}function Tc(b){return!(!b||!(b.nodeName||b.prop&&b.attr&&b.find))}function Uc(b,a,c){var d=[];q(b,function(b,g,f){d.push(a.call(c,b,g,f))});return d}function db(b,a){if(b.indexOf)return b.indexOf(a);for(var c=0;c<b.length;c++)if(a===b[c])return c;return-1}function Oa(b,a){var c=db(b,a);0<=c&&b.splice(c,1);return a}function ba(b,a){if(Ca(b)||b&&b.$evalAsync&&b.$watch)throw Pa("cpws");
if(a){if(b===a)throw Pa("cpi");if(M(b))for(var c=a.length=0;c<b.length;c++)a.push(ba(b[c]));else{c=a.$$hashKey;q(a,function(b,c){delete a[c]});for(var d in b)a[d]=ba(b[d]);Sb(a,c)}}else(a=b)&&(M(b)?a=ba(b,[]):Na(b)?a=new Date(b.getTime()):cb(b)?a=RegExp(b.source):X(b)&&(a=ba(b,{})));return a}function Ub(b,a){a=a||{};for(var c in b)!b.hasOwnProperty(c)||"$"===c.charAt(0)&&"$"===c.charAt(1)||(a[c]=b[c]);return a}function xa(b,a){if(b===a)return!0;if(null===b||null===a)return!1;if(b!==b&&a!==a)return!0;
var c=typeof b,d;if(c==typeof a&&"object"==c)if(M(b)){if(!M(a))return!1;if((c=b.length)==a.length){for(d=0;d<c;d++)if(!xa(b[d],a[d]))return!1;return!0}}else{if(Na(b))return Na(a)&&b.getTime()==a.getTime();if(cb(b)&&cb(a))return b.toString()==a.toString();if(b&&b.$evalAsync&&b.$watch||a&&a.$evalAsync&&a.$watch||Ca(b)||Ca(a)||M(a))return!1;c={};for(d in b)if("$"!==d.charAt(0)&&!P(b[d])){if(!xa(b[d],a[d]))return!1;c[d]=!0}for(d in a)if(!c.hasOwnProperty(d)&&"$"!==d.charAt(0)&&a[d]!==s&&!P(a[d]))return!1;
return!0}return!1}function Vb(){return U.securityPolicy&&U.securityPolicy.isActive||U.querySelector&&!(!U.querySelector("[ng-csp]")&&!U.querySelector("[data-ng-csp]"))}function eb(b,a){var c=2<arguments.length?ya.call(arguments,2):[];return!P(a)||a instanceof RegExp?a:c.length?function(){return arguments.length?a.apply(b,c.concat(ya.call(arguments,0))):a.apply(b,c)}:function(){return arguments.length?a.apply(b,arguments):a.call(b)}}function Vc(b,a){var c=a;"string"===typeof b&&"$"===b.charAt(0)?c=
s:Ca(a)?c="$WINDOW":a&&U===a?c="$DOCUMENT":a&&(a.$evalAsync&&a.$watch)&&(c="$SCOPE");return c}function qa(b,a){return"undefined"===typeof b?s:JSON.stringify(b,Vc,a?"  ":null)}function Wb(b){return w(b)?JSON.parse(b):b}function Qa(b){"function"===typeof b?b=!0:b&&0!==b.length?(b=K(""+b),b=!("f"==b||"0"==b||"false"==b||"no"==b||"n"==b||"[]"==b)):b=!1;return b}function ha(b){b=y(b).clone();try{b.empty()}catch(a){}var c=y("<div>").append(b).html();try{return 3===b[0].nodeType?K(c):c.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,
function(a,b){return"<"+K(b)})}catch(d){return K(c)}}function Xb(b){try{return decodeURIComponent(b)}catch(a){}}function Yb(b){var a={},c,d;q((b||"").split("&"),function(b){b&&(c=b.split("="),d=Xb(c[0]),B(d)&&(b=B(c[1])?Xb(c[1]):!0,a[d]?M(a[d])?a[d].push(b):a[d]=[a[d],b]:a[d]=b))});return a}function Zb(b){var a=[];q(b,function(b,d){M(b)?q(b,function(b){a.push(za(d,!0)+(!0===b?"":"="+za(b,!0)))}):a.push(za(d,!0)+(!0===b?"":"="+za(b,!0)))});return a.length?a.join("&"):""}function wb(b){return za(b,
!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function za(b,a){return encodeURIComponent(b).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,a?"%20":"+")}function Wc(b,a){function c(a){a&&d.push(a)}var d=[b],e,g,f=["ng:app","ng-app","x-ng-app","data-ng-app"],h=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;q(f,function(a){f[a]=!0;c(U.getElementById(a));a=a.replace(":","\\:");b.querySelectorAll&&(q(b.querySelectorAll("."+a),c),q(b.querySelectorAll("."+
a+"\\:"),c),q(b.querySelectorAll("["+a+"]"),c))});q(d,function(a){if(!e){var b=h.exec(" "+a.className+" ");b?(e=a,g=(b[2]||"").replace(/\s+/g,",")):q(a.attributes,function(b){!e&&f[b.name]&&(e=a,g=b.value)})}});e&&a(e,g?[g]:[])}function $b(b,a){var c=function(){b=y(b);if(b.injector()){var c=b[0]===U?"document":ha(b);throw Pa("btstrpd",c);}a=a||[];a.unshift(["$provide",function(a){a.value("$rootElement",b)}]);a.unshift("ng");c=ac(a);c.invoke(["$rootScope","$rootElement","$compile","$injector","$animate",
function(a,b,c,d,e){a.$apply(function(){b.data("$injector",d);c(b)(a)})}]);return c},d=/^NG_DEFER_BOOTSTRAP!/;if(O&&!d.test(O.name))return c();O.name=O.name.replace(d,"");Ea.resumeBootstrap=function(b){q(b,function(b){a.push(b)});c()}}function fb(b,a){a=a||"_";return b.replace(Xc,function(b,d){return(d?a:"")+b.toLowerCase()})}function xb(b,a,c){if(!b)throw Pa("areq",a||"?",c||"required");return b}function Ra(b,a,c){c&&M(b)&&(b=b[b.length-1]);xb(P(b),a,"not a function, got "+(b&&"object"==typeof b?
b.constructor.name||"Object":typeof b));return b}function Aa(b,a){if("hasOwnProperty"===b)throw Pa("badname",a);}function bc(b,a,c){if(!a)return b;a=a.split(".");for(var d,e=b,g=a.length,f=0;f<g;f++)d=a[f],b&&(b=(e=b)[d]);return!c&&P(b)?eb(e,b):b}function yb(b){var a=b[0];b=b[b.length-1];if(a===b)return y(a);var c=[a];do{a=a.nextSibling;if(!a)break;c.push(a)}while(a!==b);return y(c)}function Yc(b){var a=t("$injector"),c=t("ng");b=b.angular||(b.angular={});b.$$minErr=b.$$minErr||t;return b.module||
(b.module=function(){var b={};return function(e,g,f){if("hasOwnProperty"===e)throw c("badname","module");g&&b.hasOwnProperty(e)&&(b[e]=null);return b[e]||(b[e]=function(){function b(a,d,e){return function(){c[e||"push"]([a,d,arguments]);return n}}if(!g)throw a("nomod",e);var c=[],d=[],m=b("$injector","invoke"),n={_invokeQueue:c,_runBlocks:d,requires:g,name:e,provider:b("$provide","provider"),factory:b("$provide","factory"),service:b("$provide","service"),value:b("$provide","value"),constant:b("$provide",
"constant","unshift"),animation:b("$animateProvider","register"),filter:b("$filterProvider","register"),controller:b("$controllerProvider","register"),directive:b("$compileProvider","directive"),config:m,run:function(a){d.push(a);return this}};f&&m(f);return n}())}}())}function Zc(b){D(b,{bootstrap:$b,copy:ba,extend:D,equals:xa,element:y,forEach:q,injector:ac,noop:C,bind:eb,toJson:qa,fromJson:Wb,identity:Da,isUndefined:E,isDefined:B,isString:w,isFunction:P,isObject:X,isNumber:vb,isElement:Tc,isArray:M,
version:$c,isDate:Na,lowercase:K,uppercase:Fa,callbacks:{counter:0},$$minErr:t,$$csp:Vb});Sa=Yc(O);try{Sa("ngLocale")}catch(a){Sa("ngLocale",[]).provider("$locale",ad)}Sa("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:bd});a.provider("$compile",cc).directive({a:cd,input:dc,textarea:dc,form:dd,script:ed,select:fd,style:gd,option:hd,ngBind:id,ngBindHtml:jd,ngBindTemplate:kd,ngClass:ld,ngClassEven:md,ngClassOdd:nd,ngCloak:od,ngController:pd,ngForm:qd,ngHide:rd,ngIf:sd,ngInclude:td,
ngInit:ud,ngNonBindable:vd,ngPluralize:wd,ngRepeat:xd,ngShow:yd,ngStyle:zd,ngSwitch:Ad,ngSwitchWhen:Bd,ngSwitchDefault:Cd,ngOptions:Dd,ngTransclude:Ed,ngModel:Fd,ngList:Gd,ngChange:Hd,required:ec,ngRequired:ec,ngValue:Id}).directive({ngInclude:Jd}).directive(zb).directive(fc);a.provider({$anchorScroll:Kd,$animate:Ld,$browser:Md,$cacheFactory:Nd,$controller:Od,$document:Pd,$exceptionHandler:Qd,$filter:gc,$interpolate:Rd,$interval:Sd,$http:Td,$httpBackend:Ud,$location:Vd,$log:Wd,$parse:Xd,$rootScope:Yd,
$q:Zd,$sce:$d,$sceDelegate:ae,$sniffer:be,$templateCache:ce,$timeout:de,$window:ee,$$rAF:fe,$$asyncCallback:ge})}])}function Ta(b){return b.replace(he,function(a,b,d,e){return e?d.toUpperCase():d}).replace(ie,"Moz$1")}function Ab(b,a,c,d){function e(b){var e=c&&b?[this.filter(b)]:[this],l=a,k,m,n,p,r,z;if(!d||null!=b)for(;e.length;)for(k=e.shift(),m=0,n=k.length;m<n;m++)for(p=y(k[m]),l?p.triggerHandler("$destroy"):l=!l,r=0,p=(z=p.children()).length;r<p;r++)e.push(Ga(z[r]));return g.apply(this,arguments)}
var g=Ga.fn[b],g=g.$original||g;e.$original=g;Ga.fn[b]=e}function N(b){if(b instanceof N)return b;w(b)&&(b=ca(b));if(!(this instanceof N)){if(w(b)&&"<"!=b.charAt(0))throw Bb("nosel");return new N(b)}if(w(b)){var a=b;b=U;var c;if(c=je.exec(a))b=[b.createElement(c[1])];else{var d=b,e;b=d.createDocumentFragment();c=[];if(Cb.test(a)){d=b.appendChild(d.createElement("div"));e=(ke.exec(a)||["",""])[1].toLowerCase();e=ea[e]||ea._default;d.innerHTML="<div>&#160;</div>"+e[1]+a.replace(le,"<$1></$2>")+e[2];
d.removeChild(d.firstChild);for(a=e[0];a--;)d=d.lastChild;a=0;for(e=d.childNodes.length;a<e;++a)c.push(d.childNodes[a]);d=b.firstChild;d.textContent=""}else c.push(d.createTextNode(a));b.textContent="";b.innerHTML="";b=c}Db(this,b);y(U.createDocumentFragment()).append(this)}else Db(this,b)}function Eb(b){return b.cloneNode(!0)}function Ha(b){hc(b);var a=0;for(b=b.childNodes||[];a<b.length;a++)Ha(b[a])}function ic(b,a,c,d){if(B(d))throw Bb("offargs");var e=la(b,"events");la(b,"handle")&&(E(a)?q(e,
function(a,c){Fb(b,c,a);delete e[c]}):q(a.split(" "),function(a){E(c)?(Fb(b,a,e[a]),delete e[a]):Oa(e[a]||[],c)}))}function hc(b,a){var c=b[gb],d=Ua[c];d&&(a?delete Ua[c].data[a]:(d.handle&&(d.events.$destroy&&d.handle({},"$destroy"),ic(b)),delete Ua[c],b[gb]=s))}function la(b,a,c){var d=b[gb],d=Ua[d||-1];if(B(c))d||(b[gb]=d=++me,d=Ua[d]={}),d[a]=c;else return d&&d[a]}function jc(b,a,c){var d=la(b,"data"),e=B(c),g=!e&&B(a),f=g&&!X(a);d||f||la(b,"data",d={});if(e)d[a]=c;else if(g){if(f)return d&&d[a];
D(d,a)}else return d}function Gb(b,a){return b.getAttribute?-1<(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+a+" "):!1}function hb(b,a){a&&b.setAttribute&&q(a.split(" "),function(a){b.setAttribute("class",ca((" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+ca(a)+" "," ")))})}function ib(b,a){if(a&&b.setAttribute){var c=(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");q(a.split(" "),function(a){a=ca(a);-1===c.indexOf(" "+a+" ")&&
(c+=a+" ")});b.setAttribute("class",ca(c))}}function Db(b,a){if(a){a=a.nodeName||!B(a.length)||Ca(a)?[a]:a;for(var c=0;c<a.length;c++)b.push(a[c])}}function kc(b,a){return jb(b,"$"+(a||"ngController")+"Controller")}function jb(b,a,c){b=y(b);9==b[0].nodeType&&(b=b.find("html"));for(a=M(a)?a:[a];b.length;){for(var d=b[0],e=0,g=a.length;e<g;e++)if((c=b.data(a[e]))!==s)return c;b=y(d.parentNode||11===d.nodeType&&d.host)}}function lc(b){for(var a=0,c=b.childNodes;a<c.length;a++)Ha(c[a]);for(;b.firstChild;)b.removeChild(b.firstChild)}
function mc(b,a){var c=kb[a.toLowerCase()];return c&&nc[b.nodeName]&&c}function ne(b,a){var c=function(c,e){c.preventDefault||(c.preventDefault=function(){c.returnValue=!1});c.stopPropagation||(c.stopPropagation=function(){c.cancelBubble=!0});c.target||(c.target=c.srcElement||U);if(E(c.defaultPrevented)){var g=c.preventDefault;c.preventDefault=function(){c.defaultPrevented=!0;g.call(c)};c.defaultPrevented=!1}c.isDefaultPrevented=function(){return c.defaultPrevented||!1===c.returnValue};var f=Ub(a[e||
c.type]||[]);q(f,function(a){a.call(b,c)});8>=S?(c.preventDefault=null,c.stopPropagation=null,c.isDefaultPrevented=null):(delete c.preventDefault,delete c.stopPropagation,delete c.isDefaultPrevented)};c.elem=b;return c}function Ia(b){var a=typeof b,c;"object"==a&&null!==b?"function"==typeof(c=b.$$hashKey)?c=b.$$hashKey():c===s&&(c=b.$$hashKey=bb()):c=b;return a+":"+c}function Va(b){q(b,this.put,this)}function oc(b){var a,c;"function"==typeof b?(a=b.$inject)||(a=[],b.length&&(c=b.toString().replace(oe,
""),c=c.match(pe),q(c[1].split(qe),function(b){b.replace(re,function(b,c,d){a.push(d)})})),b.$inject=a):M(b)?(c=b.length-1,Ra(b[c],"fn"),a=b.slice(0,c)):Ra(b,"fn",!0);return a}function ac(b){function a(a){return function(b,c){if(X(b))q(b,Rb(a));else return a(b,c)}}function c(a,b){Aa(a,"service");if(P(b)||M(b))b=n.instantiate(b);if(!b.$get)throw Wa("pget",a);return m[a+h]=b}function d(a,b){return c(a,{$get:b})}function e(a){var b=[],c,d,g,h;q(a,function(a){if(!k.get(a)){k.put(a,!0);try{if(w(a))for(c=
Sa(a),b=b.concat(e(c.requires)).concat(c._runBlocks),d=c._invokeQueue,g=0,h=d.length;g<h;g++){var f=d[g],l=n.get(f[0]);l[f[1]].apply(l,f[2])}else P(a)?b.push(n.invoke(a)):M(a)?b.push(n.invoke(a)):Ra(a,"module")}catch(m){throw M(a)&&(a=a[a.length-1]),m.message&&(m.stack&&-1==m.stack.indexOf(m.message))&&(m=m.message+"\n"+m.stack),Wa("modulerr",a,m.stack||m.message||m);}}});return b}function g(a,b){function c(d){if(a.hasOwnProperty(d)){if(a[d]===f)throw Wa("cdep",l.join(" <- "));return a[d]}try{return l.unshift(d),
a[d]=f,a[d]=b(d)}catch(e){throw a[d]===f&&delete a[d],e;}finally{l.shift()}}function d(a,b,e){var g=[],h=oc(a),f,l,k;l=0;for(f=h.length;l<f;l++){k=h[l];if("string"!==typeof k)throw Wa("itkn",k);g.push(e&&e.hasOwnProperty(k)?e[k]:c(k))}a.$inject||(a=a[f]);return a.apply(b,g)}return{invoke:d,instantiate:function(a,b){var c=function(){},e;c.prototype=(M(a)?a[a.length-1]:a).prototype;c=new c;e=d(a,c,b);return X(e)||P(e)?e:c},get:c,annotate:oc,has:function(b){return m.hasOwnProperty(b+h)||a.hasOwnProperty(b)}}}
var f={},h="Provider",l=[],k=new Va,m={$provide:{provider:a(c),factory:a(d),service:a(function(a,b){return d(a,["$injector",function(a){return a.instantiate(b)}])}),value:a(function(a,b){return d(a,aa(b))}),constant:a(function(a,b){Aa(a,"constant");m[a]=b;p[a]=b}),decorator:function(a,b){var c=n.get(a+h),d=c.$get;c.$get=function(){var a=r.invoke(d,c);return r.invoke(b,null,{$delegate:a})}}}},n=m.$injector=g(m,function(){throw Wa("unpr",l.join(" <- "));}),p={},r=p.$injector=g(p,function(a){a=n.get(a+
h);return r.invoke(a.$get,a)});q(e(b),function(a){r.invoke(a||C)});return r}function Kd(){var b=!0;this.disableAutoScrolling=function(){b=!1};this.$get=["$window","$location","$rootScope",function(a,c,d){function e(a){var b=null;q(a,function(a){b||"a"!==K(a.nodeName)||(b=a)});return b}function g(){var b=c.hash(),d;b?(d=f.getElementById(b))?d.scrollIntoView():(d=e(f.getElementsByName(b)))?d.scrollIntoView():"top"===b&&a.scrollTo(0,0):a.scrollTo(0,0)}var f=a.document;b&&d.$watch(function(){return c.hash()},
function(){d.$evalAsync(g)});return g}]}function ge(){this.$get=["$$rAF","$timeout",function(b,a){return b.supported?function(a){return b(a)}:function(b){return a(b,0,!1)}}]}function se(b,a,c,d){function e(a){try{a.apply(null,ya.call(arguments,1))}finally{if(z--,0===z)for(;u.length;)try{u.pop()()}catch(b){c.error(b)}}}function g(a,b){(function T(){q(F,function(a){a()});v=b(T,a)})()}function f(){x=null;J!=h.url()&&(J=h.url(),q(ma,function(a){a(h.url())}))}var h=this,l=a[0],k=b.location,m=b.history,
n=b.setTimeout,p=b.clearTimeout,r={};h.isMock=!1;var z=0,u=[];h.$$completeOutstandingRequest=e;h.$$incOutstandingRequestCount=function(){z++};h.notifyWhenNoOutstandingRequests=function(a){q(F,function(a){a()});0===z?a():u.push(a)};var F=[],v;h.addPollFn=function(a){E(v)&&g(100,n);F.push(a);return a};var J=k.href,A=a.find("base"),x=null;h.url=function(a,c){k!==b.location&&(k=b.location);m!==b.history&&(m=b.history);if(a){if(J!=a)return J=a,d.history?c?m.replaceState(null,"",a):(m.pushState(null,"",
a),A.attr("href",A.attr("href"))):(x=a,c?k.replace(a):k.href=a),h}else return x||k.href.replace(/%27/g,"'")};var ma=[],L=!1;h.onUrlChange=function(a){if(!L){if(d.history)y(b).on("popstate",f);if(d.hashchange)y(b).on("hashchange",f);else h.addPollFn(f);L=!0}ma.push(a);return a};h.baseHref=function(){var a=A.attr("href");return a?a.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var Q={},da="",H=h.baseHref();h.cookies=function(a,b){var d,e,g,h;if(a)b===s?l.cookie=escape(a)+"=;path="+H+";expires=Thu, 01 Jan 1970 00:00:00 GMT":
w(b)&&(d=(l.cookie=escape(a)+"="+escape(b)+";path="+H).length+1,4096<d&&c.warn("Cookie '"+a+"' possibly not set or overflowed because it was too large ("+d+" > 4096 bytes)!"));else{if(l.cookie!==da)for(da=l.cookie,d=da.split("; "),Q={},g=0;g<d.length;g++)e=d[g],h=e.indexOf("="),0<h&&(a=unescape(e.substring(0,h)),Q[a]===s&&(Q[a]=unescape(e.substring(h+1))));return Q}};h.defer=function(a,b){var c;z++;c=n(function(){delete r[c];e(a)},b||0);r[c]=!0;return c};h.defer.cancel=function(a){return r[a]?(delete r[a],
p(a),e(C),!0):!1}}function Md(){this.$get=["$window","$log","$sniffer","$document",function(b,a,c,d){return new se(b,d,a,c)}]}function Nd(){this.$get=function(){function b(b,d){function e(a){a!=n&&(p?p==a&&(p=a.n):p=a,g(a.n,a.p),g(a,n),n=a,n.n=null)}function g(a,b){a!=b&&(a&&(a.p=b),b&&(b.n=a))}if(b in a)throw t("$cacheFactory")("iid",b);var f=0,h=D({},d,{id:b}),l={},k=d&&d.capacity||Number.MAX_VALUE,m={},n=null,p=null;return a[b]={put:function(a,b){if(k<Number.MAX_VALUE){var c=m[a]||(m[a]={key:a});
e(c)}if(!E(b))return a in l||f++,l[a]=b,f>k&&this.remove(p.key),b},get:function(a){if(k<Number.MAX_VALUE){var b=m[a];if(!b)return;e(b)}return l[a]},remove:function(a){if(k<Number.MAX_VALUE){var b=m[a];if(!b)return;b==n&&(n=b.p);b==p&&(p=b.n);g(b.n,b.p);delete m[a]}delete l[a];f--},removeAll:function(){l={};f=0;m={};n=p=null},destroy:function(){m=h=l=null;delete a[b]},info:function(){return D({},h,{size:f})}}}var a={};b.info=function(){var b={};q(a,function(a,e){b[e]=a.info()});return b};b.get=function(b){return a[b]};
return b}}function ce(){this.$get=["$cacheFactory",function(b){return b("templates")}]}function cc(b,a){var c={},d="Directive",e=/^\s*directive\:\s*([\d\w\-_]+)\s+(.*)$/,g=/(([\d\w\-_]+)(?:\:([^;]+))?;?)/,f=/^(on[a-z]+|formaction)$/;this.directive=function l(a,e){Aa(a,"directive");w(a)?(xb(e,"directiveFactory"),c.hasOwnProperty(a)||(c[a]=[],b.factory(a+d,["$injector","$exceptionHandler",function(b,d){var e=[];q(c[a],function(c,g){try{var f=b.invoke(c);P(f)?f={compile:aa(f)}:!f.compile&&f.link&&(f.compile=
aa(f.link));f.priority=f.priority||0;f.index=g;f.name=f.name||a;f.require=f.require||f.controller&&f.name;f.restrict=f.restrict||"A";e.push(f)}catch(l){d(l)}});return e}])),c[a].push(e)):q(a,Rb(l));return this};this.aHrefSanitizationWhitelist=function(b){return B(b)?(a.aHrefSanitizationWhitelist(b),this):a.aHrefSanitizationWhitelist()};this.imgSrcSanitizationWhitelist=function(b){return B(b)?(a.imgSrcSanitizationWhitelist(b),this):a.imgSrcSanitizationWhitelist()};this.$get=["$injector","$interpolate",
"$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(a,b,m,n,p,r,z,u,F,v,J,A){function x(a,b,c,d,e){a instanceof y||(a=y(a));q(a,function(b,c){3==b.nodeType&&b.nodeValue.match(/\S+/)&&(a[c]=y(b).wrap("<span></span>").parent()[0])});var g=L(a,b,a,c,d,e);ma(a,"ng-scope");return function(b,c,d){xb(b,"scope");var e=c?Ja.clone.call(a):a;q(d,function(a,b){e.data("$"+b+"Controller",a)});d=0;for(var f=e.length;d<f;d++){var l=
e[d].nodeType;1!==l&&9!==l||e.eq(d).data("$scope",b)}c&&c(e,b);g&&g(b,e,e);return e}}function ma(a,b){try{a.addClass(b)}catch(c){}}function L(a,b,c,d,e,g){function f(a,c,d,e){var g,k,m,r,n,p,z;g=c.length;var I=Array(g);for(n=0;n<g;n++)I[n]=c[n];z=n=0;for(p=l.length;n<p;z++)k=I[z],c=l[n++],g=l[n++],m=y(k),c?(c.scope?(r=a.$new(),m.data("$scope",r)):r=a,(m=c.transclude)||!e&&b?c(g,r,k,d,Q(a,m||b)):c(g,r,k,d,e)):g&&g(a,k.childNodes,s,e)}for(var l=[],k,m,r,n,p=0;p<a.length;p++)k=new Hb,m=da(a[p],[],k,
0===p?d:s,e),(g=m.length?ia(m,a[p],k,b,c,null,[],[],g):null)&&g.scope&&ma(y(a[p]),"ng-scope"),k=g&&g.terminal||!(r=a[p].childNodes)||!r.length?null:L(r,g?g.transclude:b),l.push(g,k),n=n||g||k,g=null;return n?f:null}function Q(a,b){return function(c,d,e){var g=!1;c||(c=a.$new(),g=c.$$transcluded=!0);d=b(c,d,e);if(g)d.on("$destroy",eb(c,c.$destroy));return d}}function da(a,b,c,d,f){var k=c.$attr,l;switch(a.nodeType){case 1:T(b,na(Ka(a).toLowerCase()),"E",d,f);var m,r,n;l=a.attributes;for(var p=0,z=
l&&l.length;p<z;p++){var u=!1,F=!1;m=l[p];if(!S||8<=S||m.specified){r=m.name;n=na(r);W.test(n)&&(r=fb(n.substr(6),"-"));var J=n.replace(/(Start|End)$/,"");n===J+"Start"&&(u=r,F=r.substr(0,r.length-5)+"end",r=r.substr(0,r.length-6));n=na(r.toLowerCase());k[n]=r;c[n]=m=ca(m.value);mc(a,n)&&(c[n]=!0);N(a,b,m,n);T(b,n,"A",d,f,u,F)}}a=a.className;if(w(a)&&""!==a)for(;l=g.exec(a);)n=na(l[2]),T(b,n,"C",d,f)&&(c[n]=ca(l[3])),a=a.substr(l.index+l[0].length);break;case 3:t(b,a.nodeValue);break;case 8:try{if(l=
e.exec(a.nodeValue))n=na(l[1]),T(b,n,"M",d,f)&&(c[n]=ca(l[2]))}catch(x){}}b.sort(E);return b}function H(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b)){do{if(!a)throw ja("uterdir",b,c);1==a.nodeType&&(a.hasAttribute(b)&&e++,a.hasAttribute(c)&&e--);d.push(a);a=a.nextSibling}while(0<e)}else d.push(a);return y(d)}function R(a,b,c){return function(d,e,g,f,l){e=H(e[0],b,c);return a(d,e,g,f,l)}}function ia(a,c,d,e,g,f,l,n,p){function u(a,b,c,d){if(a){c&&(a=R(a,c,d));a.require=G.require;if(Q===
G||G.$$isolateScope)a=qc(a,{isolateScope:!0});l.push(a)}if(b){c&&(b=R(b,c,d));b.require=G.require;if(Q===G||G.$$isolateScope)b=qc(b,{isolateScope:!0});n.push(b)}}function F(a,b,c){var d,e="data",g=!1;if(w(a)){for(;"^"==(d=a.charAt(0))||"?"==d;)a=a.substr(1),"^"==d&&(e="inheritedData"),g=g||"?"==d;d=null;c&&"data"===e&&(d=c[a]);d=d||b[e]("$"+a+"Controller");if(!d&&!g)throw ja("ctreq",a,t);}else M(a)&&(d=[],q(a,function(a){d.push(F(a,b,c))}));return d}function J(a,e,g,f,p){function u(a,b){var c;2>arguments.length&&
(b=a,a=s);D&&(c=lb);return p(a,b,c)}var I,x,v,A,R,H,lb={},da;I=c===g?d:Ub(d,new Hb(y(g),d.$attr));x=I.$$element;if(Q){var T=/^\s*([@=&])(\??)\s*(\w*)\s*$/;f=y(g);H=e.$new(!0);ia&&ia===Q.$$originalDirective?f.data("$isolateScope",H):f.data("$isolateScopeNoTemplate",H);ma(f,"ng-isolate-scope");q(Q.scope,function(a,c){var d=a.match(T)||[],g=d[3]||c,f="?"==d[2],d=d[1],l,m,n,p;H.$$isolateBindings[c]=d+g;switch(d){case "@":I.$observe(g,function(a){H[c]=a});I.$$observers[g].$$scope=e;I[g]&&(H[c]=b(I[g])(e));
break;case "=":if(f&&!I[g])break;m=r(I[g]);p=m.literal?xa:function(a,b){return a===b};n=m.assign||function(){l=H[c]=m(e);throw ja("nonassign",I[g],Q.name);};l=H[c]=m(e);H.$watch(function(){var a=m(e);p(a,H[c])||(p(a,l)?n(e,a=H[c]):H[c]=a);return l=a},null,m.literal);break;case "&":m=r(I[g]);H[c]=function(a){return m(e,a)};break;default:throw ja("iscp",Q.name,c,a);}})}da=p&&u;L&&q(L,function(a){var b={$scope:a===Q||a.$$isolateScope?H:e,$element:x,$attrs:I,$transclude:da},c;R=a.controller;"@"==R&&(R=
I[a.name]);c=z(R,b);lb[a.name]=c;D||x.data("$"+a.name+"Controller",c);a.controllerAs&&(b.$scope[a.controllerAs]=c)});f=0;for(v=l.length;f<v;f++)try{A=l[f],A(A.isolateScope?H:e,x,I,A.require&&F(A.require,x,lb),da)}catch(G){m(G,ha(x))}f=e;Q&&(Q.template||null===Q.templateUrl)&&(f=H);a&&a(f,g.childNodes,s,p);for(f=n.length-1;0<=f;f--)try{A=n[f],A(A.isolateScope?H:e,x,I,A.require&&F(A.require,x,lb),da)}catch(B){m(B,ha(x))}}p=p||{};for(var v=-Number.MAX_VALUE,A,L=p.controllerDirectives,Q=p.newIsolateScopeDirective,
ia=p.templateDirective,T=p.nonTlbTranscludeDirective,E=!1,D=p.hasElementTranscludeDirective,Z=d.$$element=y(c),G,t,V,Xa=e,O,N=0,S=a.length;N<S;N++){G=a[N];var ra=G.$$start,W=G.$$end;ra&&(Z=H(c,ra,W));V=s;if(v>G.priority)break;if(V=G.scope)A=A||G,G.templateUrl||(K("new/isolated scope",Q,G,Z),X(V)&&(Q=G));t=G.name;!G.templateUrl&&G.controller&&(V=G.controller,L=L||{},K("'"+t+"' controller",L[t],G,Z),L[t]=G);if(V=G.transclude)E=!0,G.$$tlb||(K("transclusion",T,G,Z),T=G),"element"==V?(D=!0,v=G.priority,
V=H(c,ra,W),Z=d.$$element=y(U.createComment(" "+t+": "+d[t]+" ")),c=Z[0],mb(g,y(ya.call(V,0)),c),Xa=x(V,e,v,f&&f.name,{nonTlbTranscludeDirective:T})):(V=y(Eb(c)).contents(),Z.empty(),Xa=x(V,e));if(G.template)if(K("template",ia,G,Z),ia=G,V=P(G.template)?G.template(Z,d):G.template,V=Y(V),G.replace){f=G;V=Cb.test(V)?y(V):[];c=V[0];if(1!=V.length||1!==c.nodeType)throw ja("tplrt",t,"");mb(g,Z,c);S={$attr:{}};V=da(c,[],S);var $=a.splice(N+1,a.length-(N+1));Q&&pc(V);a=a.concat(V).concat($);B(d,S);S=a.length}else Z.html(V);
if(G.templateUrl)K("template",ia,G,Z),ia=G,G.replace&&(f=G),J=C(a.splice(N,a.length-N),Z,d,g,Xa,l,n,{controllerDirectives:L,newIsolateScopeDirective:Q,templateDirective:ia,nonTlbTranscludeDirective:T}),S=a.length;else if(G.compile)try{O=G.compile(Z,d,Xa),P(O)?u(null,O,ra,W):O&&u(O.pre,O.post,ra,W)}catch(aa){m(aa,ha(Z))}G.terminal&&(J.terminal=!0,v=Math.max(v,G.priority))}J.scope=A&&!0===A.scope;J.transclude=E&&Xa;p.hasElementTranscludeDirective=D;return J}function pc(a){for(var b=0,c=a.length;b<c;b++)a[b]=
Tb(a[b],{$$isolateScope:!0})}function T(b,e,g,f,k,n,r){if(e===k)return null;k=null;if(c.hasOwnProperty(e)){var p;e=a.get(e+d);for(var z=0,u=e.length;z<u;z++)try{p=e[z],(f===s||f>p.priority)&&-1!=p.restrict.indexOf(g)&&(n&&(p=Tb(p,{$$start:n,$$end:r})),b.push(p),k=p)}catch(F){m(F)}}return k}function B(a,b){var c=b.$attr,d=a.$attr,e=a.$$element;q(a,function(d,e){"$"!=e.charAt(0)&&(b[e]&&(d+=("style"===e?";":" ")+b[e]),a.$set(e,d,!0,c[e]))});q(b,function(b,g){"class"==g?(ma(e,b),a["class"]=(a["class"]?
a["class"]+" ":"")+b):"style"==g?(e.attr("style",e.attr("style")+";"+b),a.style=(a.style?a.style+";":"")+b):"$"==g.charAt(0)||a.hasOwnProperty(g)||(a[g]=b,d[g]=c[g])})}function C(a,b,c,d,e,g,f,l){var k=[],m,r,z=b[0],u=a.shift(),F=D({},u,{templateUrl:null,transclude:null,replace:null,$$originalDirective:u}),x=P(u.templateUrl)?u.templateUrl(b,c):u.templateUrl;b.empty();n.get(v.getTrustedResourceUrl(x),{cache:p}).success(function(n){var p,J;n=Y(n);if(u.replace){n=Cb.test(n)?y(n):[];p=n[0];if(1!=n.length||
1!==p.nodeType)throw ja("tplrt",u.name,x);n={$attr:{}};mb(d,b,p);var v=da(p,[],n);X(u.scope)&&pc(v);a=v.concat(a);B(c,n)}else p=z,b.html(n);a.unshift(F);m=ia(a,p,c,e,b,u,g,f,l);q(d,function(a,c){a==p&&(d[c]=b[0])});for(r=L(b[0].childNodes,e);k.length;){n=k.shift();J=k.shift();var A=k.shift(),R=k.shift(),v=b[0];if(J!==z){var H=J.className;l.hasElementTranscludeDirective&&u.replace||(v=Eb(p));mb(A,y(J),v);ma(y(v),H)}J=m.transclude?Q(n,m.transclude):R;m(r,n,v,d,J)}k=null}).error(function(a,b,c,d){throw ja("tpload",
d.url);});return function(a,b,c,d,e){k?(k.push(b),k.push(c),k.push(d),k.push(e)):m(r,b,c,d,e)}}function E(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function K(a,b,c,d){if(b)throw ja("multidir",b.name,c.name,a,ha(d));}function t(a,c){var d=b(c,!0);d&&a.push({priority:0,compile:aa(function(a,b){var c=b.parent(),e=c.data("$binding")||[];e.push(d);ma(c.data("$binding",e),"ng-binding");a.$watch(d,function(a){b[0].nodeValue=a})})})}function O(a,b){if("srcdoc"==
b)return v.HTML;var c=Ka(a);if("xlinkHref"==b||"FORM"==c&&"action"==b||"IMG"!=c&&("src"==b||"ngSrc"==b))return v.RESOURCE_URL}function N(a,c,d,e){var g=b(d,!0);if(g){if("multiple"===e&&"SELECT"===Ka(a))throw ja("selmulti",ha(a));c.push({priority:100,compile:function(){return{pre:function(c,d,l){d=l.$$observers||(l.$$observers={});if(f.test(e))throw ja("nodomevents");if(g=b(l[e],!0,O(a,e)))l[e]=g(c),(d[e]||(d[e]=[])).$$inter=!0,(l.$$observers&&l.$$observers[e].$$scope||c).$watch(g,function(a,b){"class"===
e&&a!=b?l.$updateClass(a,b):l.$set(e,a)})}}}})}}function mb(a,b,c){var d=b[0],e=b.length,g=d.parentNode,f,l;if(a)for(f=0,l=a.length;f<l;f++)if(a[f]==d){a[f++]=c;l=f+e-1;for(var k=a.length;f<k;f++,l++)l<k?a[f]=a[l]:delete a[f];a.length-=e-1;break}g&&g.replaceChild(c,d);a=U.createDocumentFragment();a.appendChild(d);c[y.expando]=d[y.expando];d=1;for(e=b.length;d<e;d++)g=b[d],y(g).remove(),a.appendChild(g),delete b[d];b[0]=c;b.length=1}function qc(a,b){return D(function(){return a.apply(null,arguments)},
a,b)}var Hb=function(a,b){this.$$element=a;this.$attr=b||{}};Hb.prototype={$normalize:na,$addClass:function(a){a&&0<a.length&&J.addClass(this.$$element,a)},$removeClass:function(a){a&&0<a.length&&J.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=rc(a,b),d=rc(b,a);0===c.length?J.removeClass(this.$$element,d):0===d.length?J.addClass(this.$$element,c):J.setClass(this.$$element,c,d)},$set:function(a,b,c,d){var e=mc(this.$$element[0],a);e&&(this.$$element.prop(a,b),d=e);this[a]=b;d?this.$attr[a]=
d:(d=this.$attr[a])||(this.$attr[a]=d=fb(a,"-"));e=Ka(this.$$element);if("A"===e&&"href"===a||"IMG"===e&&"src"===a)this[a]=b=A(b,"src"===a);!1!==c&&(null===b||b===s?this.$$element.removeAttr(d):this.$$element.attr(d,b));(c=this.$$observers)&&q(c[a],function(a){try{a(b)}catch(c){m(c)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers={}),e=d[a]||(d[a]=[]);e.push(b);u.$evalAsync(function(){e.$$inter||b(c[a])});return b}};var Z=b.startSymbol(),ra=b.endSymbol(),Y="{{"==Z||"}}"==ra?
Da:function(a){return a.replace(/\{\{/g,Z).replace(/}}/g,ra)},W=/^ngAttr[A-Z]/;return x}]}function na(b){return Ta(b.replace(te,""))}function rc(b,a){var c="",d=b.split(/\s+/),e=a.split(/\s+/),g=0;a:for(;g<d.length;g++){for(var f=d[g],h=0;h<e.length;h++)if(f==e[h])continue a;c+=(0<c.length?" ":"")+f}return c}function Od(){var b={},a=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(a,d){Aa(a,"controller");X(a)?D(b,a):b[a]=d};this.$get=["$injector","$window",function(c,d){return function(e,g){var f,
h,l;w(e)&&(f=e.match(a),h=f[1],l=f[3],e=b.hasOwnProperty(h)?b[h]:bc(g.$scope,h,!0)||bc(d,h,!0),Ra(e,h,!0));f=c.instantiate(e,g);if(l){if(!g||"object"!=typeof g.$scope)throw t("$controller")("noscp",h||e.name,l);g.$scope[l]=f}return f}}]}function Pd(){this.$get=["$window",function(b){return y(b.document)}]}function Qd(){this.$get=["$log",function(b){return function(a,c){b.error.apply(b,arguments)}}]}function sc(b){var a={},c,d,e;if(!b)return a;q(b.split("\n"),function(b){e=b.indexOf(":");c=K(ca(b.substr(0,
e)));d=ca(b.substr(e+1));c&&(a[c]=a[c]?a[c]+(", "+d):d)});return a}function tc(b){var a=X(b)?b:s;return function(c){a||(a=sc(b));return c?a[K(c)]||null:a}}function uc(b,a,c){if(P(c))return c(b,a);q(c,function(c){b=c(b,a)});return b}function Td(){var b=/^\s*(\[|\{[^\{])/,a=/[\}\]]\s*$/,c=/^\)\]\}',?\n/,d={"Content-Type":"application/json;charset=utf-8"},e=this.defaults={transformResponse:[function(d){w(d)&&(d=d.replace(c,""),b.test(d)&&a.test(d)&&(d=Wb(d)));return d}],transformRequest:[function(a){return X(a)&&
"[object File]"!==wa.call(a)&&"[object Blob]"!==wa.call(a)?qa(a):a}],headers:{common:{Accept:"application/json, text/plain, */*"},post:ba(d),put:ba(d),patch:ba(d)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},g=this.interceptors=[],f=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function(a,b,c,d,n,p){function r(a){function c(a){var b=D({},a,{data:uc(a.data,a.headers,d.transformResponse)});return 200<=a.status&&300>a.status?
b:n.reject(b)}var d={method:"get",transformRequest:e.transformRequest,transformResponse:e.transformResponse},g=function(a){function b(a){var c;q(a,function(b,d){P(b)&&(c=b(),null!=c?a[d]=c:delete a[d])})}var c=e.headers,d=D({},a.headers),g,f,c=D({},c.common,c[K(a.method)]);b(c);b(d);a:for(g in c){a=K(g);for(f in d)if(K(f)===a)continue a;d[g]=c[g]}return d}(a);D(d,a);d.headers=g;d.method=Fa(d.method);(a=Ib(d.url)?b.cookies()[d.xsrfCookieName||e.xsrfCookieName]:s)&&(g[d.xsrfHeaderName||e.xsrfHeaderName]=
a);var f=[function(a){g=a.headers;var b=uc(a.data,tc(g),a.transformRequest);E(a.data)&&q(g,function(a,b){"content-type"===K(b)&&delete g[b]});E(a.withCredentials)&&!E(e.withCredentials)&&(a.withCredentials=e.withCredentials);return z(a,b,g).then(c,c)},s],h=n.when(d);for(q(v,function(a){(a.request||a.requestError)&&f.unshift(a.request,a.requestError);(a.response||a.responseError)&&f.push(a.response,a.responseError)});f.length;){a=f.shift();var k=f.shift(),h=h.then(a,k)}h.success=function(a){h.then(function(b){a(b.data,
b.status,b.headers,d)});return h};h.error=function(a){h.then(null,function(b){a(b.data,b.status,b.headers,d)});return h};return h}function z(b,c,g){function f(a,b,c,e){v&&(200<=a&&300>a?v.put(s,[a,b,sc(c),e]):v.remove(s));l(b,a,c,e);d.$$phase||d.$apply()}function l(a,c,d,e){c=Math.max(c,0);(200<=c&&300>c?p.resolve:p.reject)({data:a,status:c,headers:tc(d),config:b,statusText:e})}function k(){var a=db(r.pendingRequests,b);-1!==a&&r.pendingRequests.splice(a,1)}var p=n.defer(),z=p.promise,v,q,s=u(b.url,
b.params);r.pendingRequests.push(b);z.then(k,k);(b.cache||e.cache)&&(!1!==b.cache&&"GET"==b.method)&&(v=X(b.cache)?b.cache:X(e.cache)?e.cache:F);if(v)if(q=v.get(s),B(q)){if(q.then)return q.then(k,k),q;M(q)?l(q[1],q[0],ba(q[2]),q[3]):l(q,200,{},"OK")}else v.put(s,z);E(q)&&a(b.method,s,c,f,g,b.timeout,b.withCredentials,b.responseType);return z}function u(a,b){if(!b)return a;var c=[];Sc(b,function(a,b){null===a||E(a)||(M(a)||(a=[a]),q(a,function(a){X(a)&&(a=qa(a));c.push(za(b)+"="+za(a))}))});0<c.length&&
(a+=(-1==a.indexOf("?")?"?":"&")+c.join("&"));return a}var F=c("$http"),v=[];q(g,function(a){v.unshift(w(a)?p.get(a):p.invoke(a))});q(f,function(a,b){var c=w(a)?p.get(a):p.invoke(a);v.splice(b,0,{response:function(a){return c(n.when(a))},responseError:function(a){return c(n.reject(a))}})});r.pendingRequests=[];(function(a){q(arguments,function(a){r[a]=function(b,c){return r(D(c||{},{method:a,url:b}))}})})("get","delete","head","jsonp");(function(a){q(arguments,function(a){r[a]=function(b,c,d){return r(D(d||
{},{method:a,url:b,data:c}))}})})("post","put");r.defaults=e;return r}]}function ue(b){if(8>=S&&(!b.match(/^(get|post|head|put|delete|options)$/i)||!O.XMLHttpRequest))return new O.ActiveXObject("Microsoft.XMLHTTP");if(O.XMLHttpRequest)return new O.XMLHttpRequest;throw t("$httpBackend")("noxhr");}function Ud(){this.$get=["$browser","$window","$document",function(b,a,c){return ve(b,ue,b.defer,a.angular.callbacks,c[0])}]}function ve(b,a,c,d,e){function g(a,b){var c=e.createElement("script"),d=function(){c.onreadystatechange=
c.onload=c.onerror=null;e.body.removeChild(c);b&&b()};c.type="text/javascript";c.src=a;S&&8>=S?c.onreadystatechange=function(){/loaded|complete/.test(c.readyState)&&d()}:c.onload=c.onerror=function(){d()};e.body.appendChild(c);return d}var f=-1;return function(e,l,k,m,n,p,r,z){function u(){v=f;A&&A();x&&x.abort()}function F(a,d,e,g,f){L&&c.cancel(L);A=x=null;0===d&&(d=e?200:"file"==sa(l).protocol?404:0);a(1223===d?204:d,e,g,f||"");b.$$completeOutstandingRequest(C)}var v;b.$$incOutstandingRequestCount();
l=l||b.url();if("jsonp"==K(e)){var J="_"+(d.counter++).toString(36);d[J]=function(a){d[J].data=a};var A=g(l.replace("JSON_CALLBACK","angular.callbacks."+J),function(){d[J].data?F(m,200,d[J].data):F(m,v||-2);d[J]=Ea.noop})}else{var x=a(e);x.open(e,l,!0);q(n,function(a,b){B(a)&&x.setRequestHeader(b,a)});x.onreadystatechange=function(){if(x&&4==x.readyState){var a=null,b=null;v!==f&&(a=x.getAllResponseHeaders(),b="response"in x?x.response:x.responseText);F(m,v||x.status,b,a,x.statusText||"")}};r&&(x.withCredentials=
!0);if(z)try{x.responseType=z}catch(s){if("json"!==z)throw s;}x.send(k||null)}if(0<p)var L=c(u,p);else p&&p.then&&p.then(u)}}function Rd(){var b="{{",a="}}";this.startSymbol=function(a){return a?(b=a,this):b};this.endSymbol=function(b){return b?(a=b,this):a};this.$get=["$parse","$exceptionHandler","$sce",function(c,d,e){function g(g,k,m){for(var n,p,r=0,z=[],u=g.length,F=!1,v=[];r<u;)-1!=(n=g.indexOf(b,r))&&-1!=(p=g.indexOf(a,n+f))?(r!=n&&z.push(g.substring(r,n)),z.push(r=c(F=g.substring(n+f,p))),
r.exp=F,r=p+h,F=!0):(r!=u&&z.push(g.substring(r)),r=u);(u=z.length)||(z.push(""),u=1);if(m&&1<z.length)throw vc("noconcat",g);if(!k||F)return v.length=u,r=function(a){try{for(var b=0,c=u,f;b<c;b++)"function"==typeof(f=z[b])&&(f=f(a),f=m?e.getTrusted(m,f):e.valueOf(f),null===f||E(f)?f="":"string"!=typeof f&&(f=qa(f))),v[b]=f;return v.join("")}catch(h){a=vc("interr",g,h.toString()),d(a)}},r.exp=g,r.parts=z,r}var f=b.length,h=a.length;g.startSymbol=function(){return b};g.endSymbol=function(){return a};
return g}]}function Sd(){this.$get=["$rootScope","$window","$q",function(b,a,c){function d(d,f,h,l){var k=a.setInterval,m=a.clearInterval,n=c.defer(),p=n.promise,r=0,z=B(l)&&!l;h=B(h)?h:0;p.then(null,null,d);p.$$intervalId=k(function(){n.notify(r++);0<h&&r>=h&&(n.resolve(r),m(p.$$intervalId),delete e[p.$$intervalId]);z||b.$apply()},f);e[p.$$intervalId]=n;return p}var e={};d.cancel=function(a){return a&&a.$$intervalId in e?(e[a.$$intervalId].reject("canceled"),clearInterval(a.$$intervalId),delete e[a.$$intervalId],
!0):!1};return d}]}function ad(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"\u00a4",posSuf:"",negPre:"(\u00a4",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January February March April May June July August September October November December".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(b){return 1===b?"one":"other"}}}}function wc(b){b=b.split("/");for(var a=b.length;a--;)b[a]=wb(b[a]);return b.join("/")}function xc(b,a,c){b=sa(b,c);a.$$protocol=
b.protocol;a.$$host=b.hostname;a.$$port=Y(b.port)||we[b.protocol]||null}function yc(b,a,c){var d="/"!==b.charAt(0);d&&(b="/"+b);b=sa(b,c);a.$$path=decodeURIComponent(d&&"/"===b.pathname.charAt(0)?b.pathname.substring(1):b.pathname);a.$$search=Yb(b.search);a.$$hash=decodeURIComponent(b.hash);a.$$path&&"/"!=a.$$path.charAt(0)&&(a.$$path="/"+a.$$path)}function oa(b,a){if(0===a.indexOf(b))return a.substr(b.length)}function Ya(b){var a=b.indexOf("#");return-1==a?b:b.substr(0,a)}function Jb(b){return b.substr(0,
Ya(b).lastIndexOf("/")+1)}function zc(b,a){this.$$html5=!0;a=a||"";var c=Jb(b);xc(b,this,b);this.$$parse=function(a){var e=oa(c,a);if(!w(e))throw Kb("ipthprfx",a,c);yc(e,this,b);this.$$path||(this.$$path="/");this.$$compose()};this.$$compose=function(){var a=Zb(this.$$search),b=this.$$hash?"#"+wb(this.$$hash):"";this.$$url=wc(this.$$path)+(a?"?"+a:"")+b;this.$$absUrl=c+this.$$url.substr(1)};this.$$rewrite=function(d){var e;if((e=oa(b,d))!==s)return d=e,(e=oa(a,e))!==s?c+(oa("/",e)||e):b+d;if((e=oa(c,
d))!==s)return c+e;if(c==d+"/")return c}}function Lb(b,a){var c=Jb(b);xc(b,this,b);this.$$parse=function(d){var e=oa(b,d)||oa(c,d),e="#"==e.charAt(0)?oa(a,e):this.$$html5?e:"";if(!w(e))throw Kb("ihshprfx",d,a);yc(e,this,b);d=this.$$path;var g=/^\/?.*?:(\/.*)/;0===e.indexOf(b)&&(e=e.replace(b,""));g.exec(e)||(d=(e=g.exec(d))?e[1]:d);this.$$path=d;this.$$compose()};this.$$compose=function(){var c=Zb(this.$$search),e=this.$$hash?"#"+wb(this.$$hash):"";this.$$url=wc(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=
b+(this.$$url?a+this.$$url:"")};this.$$rewrite=function(a){if(Ya(b)==Ya(a))return a}}function Ac(b,a){this.$$html5=!0;Lb.apply(this,arguments);var c=Jb(b);this.$$rewrite=function(d){var e;if(b==Ya(d))return d;if(e=oa(c,d))return b+a+e;if(c===d+"/")return c}}function nb(b){return function(){return this[b]}}function Bc(b,a){return function(c){if(E(c))return this[b];this[b]=a(c);this.$$compose();return this}}function Vd(){var b="",a=!1;this.hashPrefix=function(a){return B(a)?(b=a,this):b};this.html5Mode=
function(b){return B(b)?(a=b,this):a};this.$get=["$rootScope","$browser","$sniffer","$rootElement",function(c,d,e,g){function f(a){c.$broadcast("$locationChangeSuccess",h.absUrl(),a)}var h,l=d.baseHref(),k=d.url();a?(l=k.substring(0,k.indexOf("/",k.indexOf("//")+2))+(l||"/"),e=e.history?zc:Ac):(l=Ya(k),e=Lb);h=new e(l,"#"+b);h.$$parse(h.$$rewrite(k));g.on("click",function(a){if(!a.ctrlKey&&!a.metaKey&&2!=a.which){for(var b=y(a.target);"a"!==K(b[0].nodeName);)if(b[0]===g[0]||!(b=b.parent())[0])return;
var e=b.prop("href");X(e)&&"[object SVGAnimatedString]"===e.toString()&&(e=sa(e.animVal).href);var f=h.$$rewrite(e);e&&(!b.attr("target")&&f&&!a.isDefaultPrevented())&&(a.preventDefault(),f!=d.url()&&(h.$$parse(f),c.$apply(),O.angular["ff-684208-preventDefault"]=!0))}});h.absUrl()!=k&&d.url(h.absUrl(),!0);d.onUrlChange(function(a){h.absUrl()!=a&&(c.$evalAsync(function(){var b=h.absUrl();h.$$parse(a);c.$broadcast("$locationChangeStart",a,b).defaultPrevented?(h.$$parse(b),d.url(b)):f(b)}),c.$$phase||
c.$digest())});var m=0;c.$watch(function(){var a=d.url(),b=h.$$replace;m&&a==h.absUrl()||(m++,c.$evalAsync(function(){c.$broadcast("$locationChangeStart",h.absUrl(),a).defaultPrevented?h.$$parse(a):(d.url(h.absUrl(),b),f(a))}));h.$$replace=!1;return m});return h}]}function Wd(){var b=!0,a=this;this.debugEnabled=function(a){return B(a)?(b=a,this):b};this.$get=["$window",function(c){function d(a){a instanceof Error&&(a.stack?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:
a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line));return a}function e(a){var b=c.console||{},e=b[a]||b.log||C;a=!1;try{a=!!e.apply}catch(l){}return a?function(){var a=[];q(arguments,function(b){a.push(d(b))});return e.apply(b,a)}:function(a,b){e(a,null==b?"":b)}}return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){b&&c.apply(a,arguments)}}()}}]}function fa(b,a){if("constructor"===b)throw Ba("isecfld",a);return b}function Za(b,
a){if(b){if(b.constructor===b)throw Ba("isecfn",a);if(b.document&&b.location&&b.alert&&b.setInterval)throw Ba("isecwindow",a);if(b.children&&(b.nodeName||b.prop&&b.attr&&b.find))throw Ba("isecdom",a);}return b}function ob(b,a,c,d,e){e=e||{};a=a.split(".");for(var g,f=0;1<a.length;f++){g=fa(a.shift(),d);var h=b[g];h||(h={},b[g]=h);b=h;b.then&&e.unwrapPromises&&(ta(d),"$$v"in b||function(a){a.then(function(b){a.$$v=b})}(b),b.$$v===s&&(b.$$v={}),b=b.$$v)}g=fa(a.shift(),d);return b[g]=c}function Cc(b,
a,c,d,e,g,f){fa(b,g);fa(a,g);fa(c,g);fa(d,g);fa(e,g);return f.unwrapPromises?function(f,l){var k=l&&l.hasOwnProperty(b)?l:f,m;if(null==k)return k;(k=k[b])&&k.then&&(ta(g),"$$v"in k||(m=k,m.$$v=s,m.then(function(a){m.$$v=a})),k=k.$$v);if(!a)return k;if(null==k)return s;(k=k[a])&&k.then&&(ta(g),"$$v"in k||(m=k,m.$$v=s,m.then(function(a){m.$$v=a})),k=k.$$v);if(!c)return k;if(null==k)return s;(k=k[c])&&k.then&&(ta(g),"$$v"in k||(m=k,m.$$v=s,m.then(function(a){m.$$v=a})),k=k.$$v);if(!d)return k;if(null==
k)return s;(k=k[d])&&k.then&&(ta(g),"$$v"in k||(m=k,m.$$v=s,m.then(function(a){m.$$v=a})),k=k.$$v);if(!e)return k;if(null==k)return s;(k=k[e])&&k.then&&(ta(g),"$$v"in k||(m=k,m.$$v=s,m.then(function(a){m.$$v=a})),k=k.$$v);return k}:function(g,f){var k=f&&f.hasOwnProperty(b)?f:g;if(null==k)return k;k=k[b];if(!a)return k;if(null==k)return s;k=k[a];if(!c)return k;if(null==k)return s;k=k[c];if(!d)return k;if(null==k)return s;k=k[d];return e?null==k?s:k=k[e]:k}}function xe(b,a){fa(b,a);return function(a,
d){return null==a?s:(d&&d.hasOwnProperty(b)?d:a)[b]}}function ye(b,a,c){fa(b,c);fa(a,c);return function(c,e){if(null==c)return s;c=(e&&e.hasOwnProperty(b)?e:c)[b];return null==c?s:c[a]}}function Dc(b,a,c){if(Mb.hasOwnProperty(b))return Mb[b];var d=b.split("."),e=d.length,g;if(a.unwrapPromises||1!==e)if(a.unwrapPromises||2!==e)if(a.csp)g=6>e?Cc(d[0],d[1],d[2],d[3],d[4],c,a):function(b,g){var f=0,h;do h=Cc(d[f++],d[f++],d[f++],d[f++],d[f++],c,a)(b,g),g=s,b=h;while(f<e);return h};else{var f="var p;\n";
q(d,function(b,d){fa(b,c);f+="if(s == null) return undefined;\ns="+(d?"s":'((k&&k.hasOwnProperty("'+b+'"))?k:s)')+'["'+b+'"];\n'+(a.unwrapPromises?'if (s && s.then) {\n pw("'+c.replace(/(["\r\n])/g,"\\$1")+'");\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v=v;});\n}\n s=s.$$v\n}\n':"")});var f=f+"return s;",h=new Function("s","k","pw",f);h.toString=aa(f);g=a.unwrapPromises?function(a,b){return h(a,b,ta)}:h}else g=ye(d[0],d[1],c);else g=xe(d[0],c);"hasOwnProperty"!==
b&&(Mb[b]=g);return g}function Xd(){var b={},a={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0};this.unwrapPromises=function(b){return B(b)?(a.unwrapPromises=!!b,this):a.unwrapPromises};this.logPromiseWarnings=function(b){return B(b)?(a.logPromiseWarnings=b,this):a.logPromiseWarnings};this.$get=["$filter","$sniffer","$log",function(c,d,e){a.csp=d.csp;ta=function(b){a.logPromiseWarnings&&!Ec.hasOwnProperty(b)&&(Ec[b]=!0,e.warn("[$parse] Promise found in the expression `"+b+"`. Automatic unwrapping of promises in Angular expressions is deprecated."))};
return function(d){var e;switch(typeof d){case "string":if(b.hasOwnProperty(d))return b[d];e=new Nb(a);e=(new $a(e,c,a)).parse(d,!1);"hasOwnProperty"!==d&&(b[d]=e);return e;case "function":return d;default:return C}}}]}function Zd(){this.$get=["$rootScope","$exceptionHandler",function(b,a){return ze(function(a){b.$evalAsync(a)},a)}]}function ze(b,a){function c(a){return a}function d(a){return f(a)}var e=function(){var f=[],k,m;return m={resolve:function(a){if(f){var c=f;f=s;k=g(a);c.length&&b(function(){for(var a,
b=0,d=c.length;b<d;b++)a=c[b],k.then(a[0],a[1],a[2])})}},reject:function(a){m.resolve(h(a))},notify:function(a){if(f){var c=f;f.length&&b(function(){for(var b,d=0,e=c.length;d<e;d++)b=c[d],b[2](a)})}},promise:{then:function(b,g,h){var m=e(),u=function(d){try{m.resolve((P(b)?b:c)(d))}catch(e){m.reject(e),a(e)}},F=function(b){try{m.resolve((P(g)?g:d)(b))}catch(c){m.reject(c),a(c)}},v=function(b){try{m.notify((P(h)?h:c)(b))}catch(d){a(d)}};f?f.push([u,F,v]):k.then(u,F,v);return m.promise},"catch":function(a){return this.then(null,
a)},"finally":function(a){function b(a,c){var d=e();c?d.resolve(a):d.reject(a);return d.promise}function d(e,g){var f=null;try{f=(a||c)()}catch(h){return b(h,!1)}return f&&P(f.then)?f.then(function(){return b(e,g)},function(a){return b(a,!1)}):b(e,g)}return this.then(function(a){return d(a,!0)},function(a){return d(a,!1)})}}}},g=function(a){return a&&P(a.then)?a:{then:function(c){var d=e();b(function(){d.resolve(c(a))});return d.promise}}},f=function(a){var b=e();b.reject(a);return b.promise},h=function(c){return{then:function(g,
f){var h=e();b(function(){try{h.resolve((P(f)?f:d)(c))}catch(b){h.reject(b),a(b)}});return h.promise}}};return{defer:e,reject:f,when:function(h,k,m,n){var p=e(),r,z=function(b){try{return(P(k)?k:c)(b)}catch(d){return a(d),f(d)}},u=function(b){try{return(P(m)?m:d)(b)}catch(c){return a(c),f(c)}},F=function(b){try{return(P(n)?n:c)(b)}catch(d){a(d)}};b(function(){g(h).then(function(a){r||(r=!0,p.resolve(g(a).then(z,u,F)))},function(a){r||(r=!0,p.resolve(u(a)))},function(a){r||p.notify(F(a))})});return p.promise},
all:function(a){var b=e(),c=0,d=M(a)?[]:{};q(a,function(a,e){c++;g(a).then(function(a){d.hasOwnProperty(e)||(d[e]=a,--c||b.resolve(d))},function(a){d.hasOwnProperty(e)||b.reject(a)})});0===c&&b.resolve(d);return b.promise}}}function fe(){this.$get=["$window","$timeout",function(b,a){var c=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame,d=b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.mozCancelAnimationFrame||b.webkitCancelRequestAnimationFrame,e=!!c,g=e?
function(a){var b=c(a);return function(){d(b)}}:function(b){var c=a(b,16.66,!1);return function(){a.cancel(c)}};g.supported=e;return g}]}function Yd(){var b=10,a=t("$rootScope"),c=null;this.digestTtl=function(a){arguments.length&&(b=a);return b};this.$get=["$injector","$exceptionHandler","$parse","$browser",function(d,e,g,f){function h(){this.$id=bb();this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null;this["this"]=this.$root=this;
this.$$destroyed=!1;this.$$asyncQueue=[];this.$$postDigestQueue=[];this.$$listeners={};this.$$listenerCount={};this.$$isolateBindings={}}function l(b){if(p.$$phase)throw a("inprog",p.$$phase);p.$$phase=b}function k(a,b){var c=g(a);Ra(c,b);return c}function m(a,b,c){do a.$$listenerCount[c]-=b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c];while(a=a.$parent)}function n(){}h.prototype={constructor:h,$new:function(a){a?(a=new h,a.$root=this.$root,a.$$asyncQueue=this.$$asyncQueue,a.$$postDigestQueue=
this.$$postDigestQueue):(a=function(){},a.prototype=this,a=new a,a.$id=bb());a["this"]=a;a.$$listeners={};a.$$listenerCount={};a.$parent=this;a.$$watchers=a.$$nextSibling=a.$$childHead=a.$$childTail=null;a.$$prevSibling=this.$$childTail;this.$$childHead?this.$$childTail=this.$$childTail.$$nextSibling=a:this.$$childHead=this.$$childTail=a;return a},$watch:function(a,b,d){var e=k(a,"watch"),g=this.$$watchers,f={fn:b,last:n,get:e,exp:a,eq:!!d};c=null;if(!P(b)){var h=k(b||C,"listener");f.fn=function(a,
b,c){h(c)}}if("string"==typeof a&&e.constant){var l=f.fn;f.fn=function(a,b,c){l.call(this,a,b,c);Oa(g,f)}}g||(g=this.$$watchers=[]);g.unshift(f);return function(){Oa(g,f);c=null}},$watchCollection:function(a,b){var c=this,d,e,f,h=1<b.length,l=0,k=g(a),m=[],n={},p=!0,q=0;return this.$watch(function(){d=k(c);var a,b;if(X(d))if(ab(d))for(e!==m&&(e=m,q=e.length=0,l++),a=d.length,q!==a&&(l++,e.length=q=a),b=0;b<a;b++)e[b]!==e[b]&&d[b]!==d[b]||e[b]===d[b]||(l++,e[b]=d[b]);else{e!==n&&(e=n={},q=0,l++);a=
0;for(b in d)d.hasOwnProperty(b)&&(a++,e.hasOwnProperty(b)?e[b]!==d[b]&&(l++,e[b]=d[b]):(q++,e[b]=d[b],l++));if(q>a)for(b in l++,e)e.hasOwnProperty(b)&&!d.hasOwnProperty(b)&&(q--,delete e[b])}else e!==d&&(e=d,l++);return l},function(){p?(p=!1,b(d,d,c)):b(d,f,c);if(h)if(X(d))if(ab(d)){f=Array(d.length);for(var a=0;a<d.length;a++)f[a]=d[a]}else for(a in f={},d)Fc.call(d,a)&&(f[a]=d[a]);else f=d})},$digest:function(){var d,g,f,h,k=this.$$asyncQueue,m=this.$$postDigestQueue,q,x,s=b,L,Q=[],y,H,R;l("$digest");
c=null;do{x=!1;for(L=this;k.length;){try{R=k.shift(),R.scope.$eval(R.expression)}catch(B){p.$$phase=null,e(B)}c=null}a:do{if(h=L.$$watchers)for(q=h.length;q--;)try{if(d=h[q])if((g=d.get(L))!==(f=d.last)&&!(d.eq?xa(g,f):"number"==typeof g&&"number"==typeof f&&isNaN(g)&&isNaN(f)))x=!0,c=d,d.last=d.eq?ba(g):g,d.fn(g,f===n?g:f,L),5>s&&(y=4-s,Q[y]||(Q[y]=[]),H=P(d.exp)?"fn: "+(d.exp.name||d.exp.toString()):d.exp,H+="; newVal: "+qa(g)+"; oldVal: "+qa(f),Q[y].push(H));else if(d===c){x=!1;break a}}catch(w){p.$$phase=
null,e(w)}if(!(h=L.$$childHead||L!==this&&L.$$nextSibling))for(;L!==this&&!(h=L.$$nextSibling);)L=L.$parent}while(L=h);if((x||k.length)&&!s--)throw p.$$phase=null,a("infdig",b,qa(Q));}while(x||k.length);for(p.$$phase=null;m.length;)try{m.shift()()}catch(T){e(T)}},$destroy:function(){if(!this.$$destroyed){var a=this.$parent;this.$broadcast("$destroy");this.$$destroyed=!0;this!==p&&(q(this.$$listenerCount,eb(null,m,this)),a.$$childHead==this&&(a.$$childHead=this.$$nextSibling),a.$$childTail==this&&
(a.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=null,this.$$listeners={},this.$$watchers=this.$$asyncQueue=this.$$postDigestQueue=[],this.$destroy=this.$digest=this.$apply=C,this.$on=this.$watch=function(){return C})}},$eval:function(a,b){return g(a)(this,b)},$evalAsync:function(a){p.$$phase||
p.$$asyncQueue.length||f.defer(function(){p.$$asyncQueue.length&&p.$digest()});this.$$asyncQueue.push({scope:this,expression:a})},$$postDigest:function(a){this.$$postDigestQueue.push(a)},$apply:function(a){try{return l("$apply"),this.$eval(a)}catch(b){e(b)}finally{p.$$phase=null;try{p.$digest()}catch(c){throw e(c),c;}}},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]);c.push(b);var d=this;do d.$$listenerCount[a]||(d.$$listenerCount[a]=0),d.$$listenerCount[a]++;while(d=d.$parent);
var e=this;return function(){c[db(c,b)]=null;m(e,1,a)}},$emit:function(a,b){var c=[],d,g=this,f=!1,h={name:a,targetScope:g,stopPropagation:function(){f=!0},preventDefault:function(){h.defaultPrevented=!0},defaultPrevented:!1},l=[h].concat(ya.call(arguments,1)),k,m;do{d=g.$$listeners[a]||c;h.currentScope=g;k=0;for(m=d.length;k<m;k++)if(d[k])try{d[k].apply(null,l)}catch(n){e(n)}else d.splice(k,1),k--,m--;if(f)break;g=g.$parent}while(g);return h},$broadcast:function(a,b){for(var c=this,d=this,g={name:a,
targetScope:this,preventDefault:function(){g.defaultPrevented=!0},defaultPrevented:!1},f=[g].concat(ya.call(arguments,1)),h,k;c=d;){g.currentScope=c;d=c.$$listeners[a]||[];h=0;for(k=d.length;h<k;h++)if(d[h])try{d[h].apply(null,f)}catch(l){e(l)}else d.splice(h,1),h--,k--;if(!(d=c.$$listenerCount[a]&&c.$$childHead||c!==this&&c.$$nextSibling))for(;c!==this&&!(d=c.$$nextSibling);)c=c.$parent}return g}};var p=new h;return p}]}function bd(){var b=/^\s*(https?|ftp|mailto|tel|file):/,a=/^\s*(https?|ftp|file):|data:image\//;
this.aHrefSanitizationWhitelist=function(a){return B(a)?(b=a,this):b};this.imgSrcSanitizationWhitelist=function(b){return B(b)?(a=b,this):a};this.$get=function(){return function(c,d){var e=d?a:b,g;if(!S||8<=S)if(g=sa(c).href,""!==g&&!g.match(e))return"unsafe:"+g;return c}}}function Ae(b){if("self"===b)return b;if(w(b)){if(-1<b.indexOf("***"))throw ua("iwcard",b);b=b.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08").replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*");return RegExp("^"+
b+"$")}if(cb(b))return RegExp("^"+b.source+"$");throw ua("imatcher");}function Gc(b){var a=[];B(b)&&q(b,function(b){a.push(Ae(b))});return a}function ae(){this.SCE_CONTEXTS=ga;var b=["self"],a=[];this.resourceUrlWhitelist=function(a){arguments.length&&(b=Gc(a));return b};this.resourceUrlBlacklist=function(b){arguments.length&&(a=Gc(b));return a};this.$get=["$injector",function(c){function d(a){var b=function(a){this.$$unwrapTrustedValue=function(){return a}};a&&(b.prototype=new a);b.prototype.valueOf=
function(){return this.$$unwrapTrustedValue()};b.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()};return b}var e=function(a){throw ua("unsafe");};c.has("$sanitize")&&(e=c.get("$sanitize"));var g=d(),f={};f[ga.HTML]=d(g);f[ga.CSS]=d(g);f[ga.URL]=d(g);f[ga.JS]=d(g);f[ga.RESOURCE_URL]=d(f[ga.URL]);return{trustAs:function(a,b){var c=f.hasOwnProperty(a)?f[a]:null;if(!c)throw ua("icontext",a,b);if(null===b||b===s||""===b)return b;if("string"!==typeof b)throw ua("itype",a);return new c(b)},
getTrusted:function(c,d){if(null===d||d===s||""===d)return d;var g=f.hasOwnProperty(c)?f[c]:null;if(g&&d instanceof g)return d.$$unwrapTrustedValue();if(c===ga.RESOURCE_URL){var g=sa(d.toString()),m,n,p=!1;m=0;for(n=b.length;m<n;m++)if("self"===b[m]?Ib(g):b[m].exec(g.href)){p=!0;break}if(p)for(m=0,n=a.length;m<n;m++)if("self"===a[m]?Ib(g):a[m].exec(g.href)){p=!1;break}if(p)return d;throw ua("insecurl",d.toString());}if(c===ga.HTML)return e(d);throw ua("unsafe");},valueOf:function(a){return a instanceof
g?a.$$unwrapTrustedValue():a}}}]}function $d(){var b=!0;this.enabled=function(a){arguments.length&&(b=!!a);return b};this.$get=["$parse","$sniffer","$sceDelegate",function(a,c,d){if(b&&c.msie&&8>c.msieDocumentMode)throw ua("iequirks");var e=ba(ga);e.isEnabled=function(){return b};e.trustAs=d.trustAs;e.getTrusted=d.getTrusted;e.valueOf=d.valueOf;b||(e.trustAs=e.getTrusted=function(a,b){return b},e.valueOf=Da);e.parseAs=function(b,c){var d=a(c);return d.literal&&d.constant?d:function(a,c){return e.getTrusted(b,
d(a,c))}};var g=e.parseAs,f=e.getTrusted,h=e.trustAs;q(ga,function(a,b){var c=K(b);e[Ta("parse_as_"+c)]=function(b){return g(a,b)};e[Ta("get_trusted_"+c)]=function(b){return f(a,b)};e[Ta("trust_as_"+c)]=function(b){return h(a,b)}});return e}]}function be(){this.$get=["$window","$document",function(b,a){var c={},d=Y((/android (\d+)/.exec(K((b.navigator||{}).userAgent))||[])[1]),e=/Boxee/i.test((b.navigator||{}).userAgent),g=a[0]||{},f=g.documentMode,h,l=/^(Moz|webkit|O|ms)(?=[A-Z])/,k=g.body&&g.body.style,
m=!1,n=!1;if(k){for(var p in k)if(m=l.exec(p)){h=m[0];h=h.substr(0,1).toUpperCase()+h.substr(1);break}h||(h="WebkitOpacity"in k&&"webkit");m=!!("transition"in k||h+"Transition"in k);n=!!("animation"in k||h+"Animation"in k);!d||m&&n||(m=w(g.body.style.webkitTransition),n=w(g.body.style.webkitAnimation))}return{history:!(!b.history||!b.history.pushState||4>d||e),hashchange:"onhashchange"in b&&(!f||7<f),hasEvent:function(a){if("input"==a&&9==S)return!1;if(E(c[a])){var b=g.createElement("div");c[a]="on"+
a in b}return c[a]},csp:Vb(),vendorPrefix:h,transitions:m,animations:n,android:d,msie:S,msieDocumentMode:f}}]}function de(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function(b,a,c,d){function e(e,h,l){var k=c.defer(),m=k.promise,n=B(l)&&!l;h=a.defer(function(){try{k.resolve(e())}catch(a){k.reject(a),d(a)}finally{delete g[m.$$timeoutId]}n||b.$apply()},h);m.$$timeoutId=h;g[h]=k;return m}var g={};e.cancel=function(b){return b&&b.$$timeoutId in g?(g[b.$$timeoutId].reject("canceled"),
delete g[b.$$timeoutId],a.defer.cancel(b.$$timeoutId)):!1};return e}]}function sa(b,a){var c=b;S&&(W.setAttribute("href",c),c=W.href);W.setAttribute("href",c);return{href:W.href,protocol:W.protocol?W.protocol.replace(/:$/,""):"",host:W.host,search:W.search?W.search.replace(/^\?/,""):"",hash:W.hash?W.hash.replace(/^#/,""):"",hostname:W.hostname,port:W.port,pathname:"/"===W.pathname.charAt(0)?W.pathname:"/"+W.pathname}}function Ib(b){b=w(b)?sa(b):b;return b.protocol===Hc.protocol&&b.host===Hc.host}
function ee(){this.$get=aa(O)}function gc(b){function a(d,e){if(X(d)){var g={};q(d,function(b,c){g[c]=a(c,b)});return g}return b.factory(d+c,e)}var c="Filter";this.register=a;this.$get=["$injector",function(a){return function(b){return a.get(b+c)}}];a("currency",Ic);a("date",Jc);a("filter",Be);a("json",Ce);a("limitTo",De);a("lowercase",Ee);a("number",Kc);a("orderBy",Lc);a("uppercase",Fe)}function Be(){return function(b,a,c){if(!M(b))return b;var d=typeof c,e=[];e.check=function(a){for(var b=0;b<e.length;b++)if(!e[b](a))return!1;
return!0};"function"!==d&&(c="boolean"===d&&c?function(a,b){return Ea.equals(a,b)}:function(a,b){if(a&&b&&"object"===typeof a&&"object"===typeof b){for(var d in a)if("$"!==d.charAt(0)&&Fc.call(a,d)&&c(a[d],b[d]))return!0;return!1}b=(""+b).toLowerCase();return-1<(""+a).toLowerCase().indexOf(b)});var g=function(a,b){if("string"==typeof b&&"!"===b.charAt(0))return!g(a,b.substr(1));switch(typeof a){case "boolean":case "number":case "string":return c(a,b);case "object":switch(typeof b){case "object":return c(a,
b);default:for(var d in a)if("$"!==d.charAt(0)&&g(a[d],b))return!0}return!1;case "array":for(d=0;d<a.length;d++)if(g(a[d],b))return!0;return!1;default:return!1}};switch(typeof a){case "boolean":case "number":case "string":a={$:a};case "object":for(var f in a)(function(b){"undefined"!=typeof a[b]&&e.push(function(c){return g("$"==b?c:c&&c[b],a[b])})})(f);break;case "function":e.push(a);break;default:return b}d=[];for(f=0;f<b.length;f++){var h=b[f];e.check(h)&&d.push(h)}return d}}function Ic(b){var a=
b.NUMBER_FORMATS;return function(b,d){E(d)&&(d=a.CURRENCY_SYM);return Mc(b,a.PATTERNS[1],a.GROUP_SEP,a.DECIMAL_SEP,2).replace(/\u00A4/g,d)}}function Kc(b){var a=b.NUMBER_FORMATS;return function(b,d){return Mc(b,a.PATTERNS[0],a.GROUP_SEP,a.DECIMAL_SEP,d)}}function Mc(b,a,c,d,e){if(null==b||!isFinite(b)||X(b))return"";var g=0>b;b=Math.abs(b);var f=b+"",h="",l=[],k=!1;if(-1!==f.indexOf("e")){var m=f.match(/([\d\.]+)e(-?)(\d+)/);m&&"-"==m[2]&&m[3]>e+1?f="0":(h=f,k=!0)}if(k)0<e&&(-1<b&&1>b)&&(h=b.toFixed(e));
else{f=(f.split(Nc)[1]||"").length;E(e)&&(e=Math.min(Math.max(a.minFrac,f),a.maxFrac));f=Math.pow(10,e);b=Math.round(b*f)/f;b=(""+b).split(Nc);f=b[0];b=b[1]||"";var m=0,n=a.lgSize,p=a.gSize;if(f.length>=n+p)for(m=f.length-n,k=0;k<m;k++)0===(m-k)%p&&0!==k&&(h+=c),h+=f.charAt(k);for(k=m;k<f.length;k++)0===(f.length-k)%n&&0!==k&&(h+=c),h+=f.charAt(k);for(;b.length<e;)b+="0";e&&"0"!==e&&(h+=d+b.substr(0,e))}l.push(g?a.negPre:a.posPre);l.push(h);l.push(g?a.negSuf:a.posSuf);return l.join("")}function Ob(b,
a,c){var d="";0>b&&(d="-",b=-b);for(b=""+b;b.length<a;)b="0"+b;c&&(b=b.substr(b.length-a));return d+b}function $(b,a,c,d){c=c||0;return function(e){e=e["get"+b]();if(0<c||e>-c)e+=c;0===e&&-12==c&&(e=12);return Ob(e,a,d)}}function pb(b,a){return function(c,d){var e=c["get"+b](),g=Fa(a?"SHORT"+b:b);return d[g][e]}}function Jc(b){function a(a){var b;if(b=a.match(c)){a=new Date(0);var g=0,f=0,h=b[8]?a.setUTCFullYear:a.setFullYear,l=b[8]?a.setUTCHours:a.setHours;b[9]&&(g=Y(b[9]+b[10]),f=Y(b[9]+b[11]));
h.call(a,Y(b[1]),Y(b[2])-1,Y(b[3]));g=Y(b[4]||0)-g;f=Y(b[5]||0)-f;h=Y(b[6]||0);b=Math.round(1E3*parseFloat("0."+(b[7]||0)));l.call(a,g,f,h,b)}return a}var c=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(c,e){var g="",f=[],h,l;e=e||"mediumDate";e=b.DATETIME_FORMATS[e]||e;w(c)&&(c=Ge.test(c)?Y(c):a(c));vb(c)&&(c=new Date(c));if(!Na(c))return c;for(;e;)(l=He.exec(e))?(f=f.concat(ya.call(l,1)),e=f.pop()):(f.push(e),e=null);q(f,function(a){h=
Ie[a];g+=h?h(c,b.DATETIME_FORMATS):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return g}}function Ce(){return function(b){return qa(b,!0)}}function De(){return function(b,a){if(!M(b)&&!w(b))return b;a=Y(a);if(w(b))return a?0<=a?b.slice(0,a):b.slice(a,b.length):"";var c=[],d,e;a>b.length?a=b.length:a<-b.length&&(a=-b.length);0<a?(d=0,e=a):(d=b.length+a,e=b.length);for(;d<e;d++)c.push(b[d]);return c}}function Lc(b){return function(a,c,d){function e(a,b){return Qa(b)?function(b,c){return a(c,b)}:a}
function g(a,b){var c=typeof a,d=typeof b;return c==d?("string"==c&&(a=a.toLowerCase(),b=b.toLowerCase()),a===b?0:a<b?-1:1):c<d?-1:1}if(!M(a)||!c)return a;c=M(c)?c:[c];c=Uc(c,function(a){var c=!1,d=a||Da;if(w(a)){if("+"==a.charAt(0)||"-"==a.charAt(0))c="-"==a.charAt(0),a=a.substring(1);d=b(a);if(d.constant){var f=d();return e(function(a,b){return g(a[f],b[f])},c)}}return e(function(a,b){return g(d(a),d(b))},c)});for(var f=[],h=0;h<a.length;h++)f.push(a[h]);return f.sort(e(function(a,b){for(var d=
0;d<c.length;d++){var e=c[d](a,b);if(0!==e)return e}return 0},d))}}function va(b){P(b)&&(b={link:b});b.restrict=b.restrict||"AC";return aa(b)}function Oc(b,a,c,d){function e(a,c){c=c?"-"+fb(c,"-"):"";d.removeClass(b,(a?qb:rb)+c);d.addClass(b,(a?rb:qb)+c)}var g=this,f=b.parent().controller("form")||sb,h=0,l=g.$error={},k=[];g.$name=a.name||a.ngForm;g.$dirty=!1;g.$pristine=!0;g.$valid=!0;g.$invalid=!1;f.$addControl(g);b.addClass(La);e(!0);g.$addControl=function(a){Aa(a.$name,"input");k.push(a);a.$name&&
(g[a.$name]=a)};g.$removeControl=function(a){a.$name&&g[a.$name]===a&&delete g[a.$name];q(l,function(b,c){g.$setValidity(c,!0,a)});Oa(k,a)};g.$setValidity=function(a,b,c){var d=l[a];if(b)d&&(Oa(d,c),d.length||(h--,h||(e(b),g.$valid=!0,g.$invalid=!1),l[a]=!1,e(!0,a),f.$setValidity(a,!0,g)));else{h||e(b);if(d){if(-1!=db(d,c))return}else l[a]=d=[],h++,e(!1,a),f.$setValidity(a,!1,g);d.push(c);g.$valid=!1;g.$invalid=!0}};g.$setDirty=function(){d.removeClass(b,La);d.addClass(b,tb);g.$dirty=!0;g.$pristine=
!1;f.$setDirty()};g.$setPristine=function(){d.removeClass(b,tb);d.addClass(b,La);g.$dirty=!1;g.$pristine=!0;q(k,function(a){a.$setPristine()})}}function pa(b,a,c,d){b.$setValidity(a,c);return c?d:s}function Je(b,a,c){var d=c.prop("validity");X(d)&&b.$parsers.push(function(c){if(b.$error[a]||!(d.badInput||d.customError||d.typeMismatch)||d.valueMissing)return c;b.$setValidity(a,!1)})}function ub(b,a,c,d,e,g){var f=a.prop("validity");if(!e.android){var h=!1;a.on("compositionstart",function(a){h=!0});
a.on("compositionend",function(){h=!1;l()})}var l=function(){if(!h){var e=a.val();Qa(c.ngTrim||"T")&&(e=ca(e));if(d.$viewValue!==e||f&&""===e&&!f.valueMissing)b.$$phase?d.$setViewValue(e):b.$apply(function(){d.$setViewValue(e)})}};if(e.hasEvent("input"))a.on("input",l);else{var k,m=function(){k||(k=g.defer(function(){l();k=null}))};a.on("keydown",function(a){a=a.keyCode;91===a||(15<a&&19>a||37<=a&&40>=a)||m()});if(e.hasEvent("paste"))a.on("paste cut",m)}a.on("change",l);d.$render=function(){a.val(d.$isEmpty(d.$viewValue)?
"":d.$viewValue)};var n=c.ngPattern;n&&((e=n.match(/^\/(.*)\/([gim]*)$/))?(n=RegExp(e[1],e[2]),e=function(a){return pa(d,"pattern",d.$isEmpty(a)||n.test(a),a)}):e=function(c){var e=b.$eval(n);if(!e||!e.test)throw t("ngPattern")("noregexp",n,e,ha(a));return pa(d,"pattern",d.$isEmpty(c)||e.test(c),c)},d.$formatters.push(e),d.$parsers.push(e));if(c.ngMinlength){var p=Y(c.ngMinlength);e=function(a){return pa(d,"minlength",d.$isEmpty(a)||a.length>=p,a)};d.$parsers.push(e);d.$formatters.push(e)}if(c.ngMaxlength){var r=
Y(c.ngMaxlength);e=function(a){return pa(d,"maxlength",d.$isEmpty(a)||a.length<=r,a)};d.$parsers.push(e);d.$formatters.push(e)}}function Pb(b,a){b="ngClass"+b;return["$animate",function(c){function d(a,b){var c=[],d=0;a:for(;d<a.length;d++){for(var e=a[d],m=0;m<b.length;m++)if(e==b[m])continue a;c.push(e)}return c}function e(a){if(!M(a)){if(w(a))return a.split(" ");if(X(a)){var b=[];q(a,function(a,c){a&&b.push(c)});return b}}return a}return{restrict:"AC",link:function(g,f,h){function l(a,b){var c=
f.data("$classCounts")||{},d=[];q(a,function(a){if(0<b||c[a])c[a]=(c[a]||0)+b,c[a]===+(0<b)&&d.push(a)});f.data("$classCounts",c);return d.join(" ")}function k(b){if(!0===a||g.$index%2===a){var k=e(b||[]);if(!m){var r=l(k,1);h.$addClass(r)}else if(!xa(b,m)){var q=e(m),r=d(k,q),k=d(q,k),k=l(k,-1),r=l(r,1);0===r.length?c.removeClass(f,k):0===k.length?c.addClass(f,r):c.setClass(f,r,k)}}m=ba(b)}var m;g.$watch(h[b],k,!0);h.$observe("class",function(a){k(g.$eval(h[b]))});"ngClass"!==b&&g.$watch("$index",
function(c,d){var f=c&1;if(f!==d&1){var k=e(g.$eval(h[b]));f===a?(f=l(k,1),h.$addClass(f)):(f=l(k,-1),h.$removeClass(f))}})}}}]}var K=function(b){return w(b)?b.toLowerCase():b},Fc=Object.prototype.hasOwnProperty,Fa=function(b){return w(b)?b.toUpperCase():b},S,y,Ga,ya=[].slice,Ke=[].push,wa=Object.prototype.toString,Pa=t("ng"),Ea=O.angular||(O.angular={}),Sa,Ka,ka=["0","0","0"];S=Y((/msie (\d+)/.exec(K(navigator.userAgent))||[])[1]);isNaN(S)&&(S=Y((/trident\/.*; rv:(\d+)/.exec(K(navigator.userAgent))||
[])[1]));C.$inject=[];Da.$inject=[];var ca=function(){return String.prototype.trim?function(b){return w(b)?b.trim():b}:function(b){return w(b)?b.replace(/^\s\s*/,"").replace(/\s\s*$/,""):b}}();Ka=9>S?function(b){b=b.nodeName?b:b[0];return b.scopeName&&"HTML"!=b.scopeName?Fa(b.scopeName+":"+b.nodeName):b.nodeName}:function(b){return b.nodeName?b.nodeName:b[0].nodeName};var Xc=/[A-Z]/g,$c={full:"1.2.16",major:1,minor:2,dot:16,codeName:"badger-enumeration"},Ua=N.cache={},gb=N.expando="ng-"+(new Date).getTime(),
me=1,Pc=O.document.addEventListener?function(b,a,c){b.addEventListener(a,c,!1)}:function(b,a,c){b.attachEvent("on"+a,c)},Fb=O.document.removeEventListener?function(b,a,c){b.removeEventListener(a,c,!1)}:function(b,a,c){b.detachEvent("on"+a,c)};N._data=function(b){return this.cache[b[this.expando]]||{}};var he=/([\:\-\_]+(.))/g,ie=/^moz([A-Z])/,Bb=t("jqLite"),je=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Cb=/<|&#?\w+;/,ke=/<([\w:]+)/,le=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ea=
{option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ea.optgroup=ea.option;ea.tbody=ea.tfoot=ea.colgroup=ea.caption=ea.thead;ea.th=ea.td;var Ja=N.prototype={ready:function(b){function a(){c||(c=!0,b())}var c=!1;"complete"===U.readyState?setTimeout(a):(this.on("DOMContentLoaded",a),N(O).on("load",a))},toString:function(){var b=
[];q(this,function(a){b.push(""+a)});return"["+b.join(", ")+"]"},eq:function(b){return 0<=b?y(this[b]):y(this[this.length+b])},length:0,push:Ke,sort:[].sort,splice:[].splice},kb={};q("multiple selected checked disabled readOnly required open".split(" "),function(b){kb[K(b)]=b});var nc={};q("input select option textarea button form details".split(" "),function(b){nc[Fa(b)]=!0});q({data:jc,inheritedData:jb,scope:function(b){return y(b).data("$scope")||jb(b.parentNode||b,["$isolateScope","$scope"])},
isolateScope:function(b){return y(b).data("$isolateScope")||y(b).data("$isolateScopeNoTemplate")},controller:kc,injector:function(b){return jb(b,"$injector")},removeAttr:function(b,a){b.removeAttribute(a)},hasClass:Gb,css:function(b,a,c){a=Ta(a);if(B(c))b.style[a]=c;else{var d;8>=S&&(d=b.currentStyle&&b.currentStyle[a],""===d&&(d="auto"));d=d||b.style[a];8>=S&&(d=""===d?s:d);return d}},attr:function(b,a,c){var d=K(a);if(kb[d])if(B(c))c?(b[a]=!0,b.setAttribute(a,d)):(b[a]=!1,b.removeAttribute(d));
else return b[a]||(b.attributes.getNamedItem(a)||C).specified?d:s;else if(B(c))b.setAttribute(a,c);else if(b.getAttribute)return b=b.getAttribute(a,2),null===b?s:b},prop:function(b,a,c){if(B(c))b[a]=c;else return b[a]},text:function(){function b(b,d){var e=a[b.nodeType];if(E(d))return e?b[e]:"";b[e]=d}var a=[];9>S?(a[1]="innerText",a[3]="nodeValue"):a[1]=a[3]="textContent";b.$dv="";return b}(),val:function(b,a){if(E(a)){if("SELECT"===Ka(b)&&b.multiple){var c=[];q(b.options,function(a){a.selected&&
c.push(a.value||a.text)});return 0===c.length?null:c}return b.value}b.value=a},html:function(b,a){if(E(a))return b.innerHTML;for(var c=0,d=b.childNodes;c<d.length;c++)Ha(d[c]);b.innerHTML=a},empty:lc},function(b,a){N.prototype[a]=function(a,d){var e,g;if(b!==lc&&(2==b.length&&b!==Gb&&b!==kc?a:d)===s){if(X(a)){for(e=0;e<this.length;e++)if(b===jc)b(this[e],a);else for(g in a)b(this[e],g,a[g]);return this}e=b.$dv;g=e===s?Math.min(this.length,1):this.length;for(var f=0;f<g;f++){var h=b(this[f],a,d);e=
e?e+h:h}return e}for(e=0;e<this.length;e++)b(this[e],a,d);return this}});q({removeData:hc,dealoc:Ha,on:function a(c,d,e,g){if(B(g))throw Bb("onargs");var f=la(c,"events"),h=la(c,"handle");f||la(c,"events",f={});h||la(c,"handle",h=ne(c,f));q(d.split(" "),function(d){var g=f[d];if(!g){if("mouseenter"==d||"mouseleave"==d){var m=U.body.contains||U.body.compareDocumentPosition?function(a,c){var d=9===a.nodeType?a.documentElement:a,e=c&&c.parentNode;return a===e||!!(e&&1===e.nodeType&&(d.contains?d.contains(e):
a.compareDocumentPosition&&a.compareDocumentPosition(e)&16))}:function(a,c){if(c)for(;c=c.parentNode;)if(c===a)return!0;return!1};f[d]=[];a(c,{mouseleave:"mouseout",mouseenter:"mouseover"}[d],function(a){var c=a.relatedTarget;c&&(c===this||m(this,c))||h(a,d)})}else Pc(c,d,h),f[d]=[];g=f[d]}g.push(e)})},off:ic,one:function(a,c,d){a=y(a);a.on(c,function g(){a.off(c,d);a.off(c,g)});a.on(c,d)},replaceWith:function(a,c){var d,e=a.parentNode;Ha(a);q(new N(c),function(c){d?e.insertBefore(c,d.nextSibling):
e.replaceChild(c,a);d=c})},children:function(a){var c=[];q(a.childNodes,function(a){1===a.nodeType&&c.push(a)});return c},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,c){q(new N(c),function(c){1!==a.nodeType&&11!==a.nodeType||a.appendChild(c)})},prepend:function(a,c){if(1===a.nodeType){var d=a.firstChild;q(new N(c),function(c){a.insertBefore(c,d)})}},wrap:function(a,c){c=y(c)[0];var d=a.parentNode;d&&d.replaceChild(c,a);c.appendChild(a)},remove:function(a){Ha(a);
var c=a.parentNode;c&&c.removeChild(a)},after:function(a,c){var d=a,e=a.parentNode;q(new N(c),function(a){e.insertBefore(a,d.nextSibling);d=a})},addClass:ib,removeClass:hb,toggleClass:function(a,c,d){c&&q(c.split(" "),function(c){var g=d;E(g)&&(g=!Gb(a,c));(g?ib:hb)(a,c)})},parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},next:function(a){if(a.nextElementSibling)return a.nextElementSibling;for(a=a.nextSibling;null!=a&&1!==a.nodeType;)a=a.nextSibling;return a},find:function(a,c){return a.getElementsByTagName?
a.getElementsByTagName(c):[]},clone:Eb,triggerHandler:function(a,c,d){c=(la(a,"events")||{})[c];d=d||[];var e=[{preventDefault:C,stopPropagation:C}];q(c,function(c){c.apply(a,e.concat(d))})}},function(a,c){N.prototype[c]=function(c,e,g){for(var f,h=0;h<this.length;h++)E(f)?(f=a(this[h],c,e,g),B(f)&&(f=y(f))):Db(f,a(this[h],c,e,g));return B(f)?f:this};N.prototype.bind=N.prototype.on;N.prototype.unbind=N.prototype.off});Va.prototype={put:function(a,c){this[Ia(a)]=c},get:function(a){return this[Ia(a)]},
remove:function(a){var c=this[a=Ia(a)];delete this[a];return c}};var pe=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,qe=/,/,re=/^\s*(_?)(\S+?)\1\s*$/,oe=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,Wa=t("$injector"),Le=t("$animate"),Ld=["$provide",function(a){this.$$selectors={};this.register=function(c,d){var e=c+"-animation";if(c&&"."!=c.charAt(0))throw Le("notcsel",c);this.$$selectors[c.substr(1)]=e;a.factory(e,d)};this.classNameFilter=function(a){1===arguments.length&&(this.$$classNameFilter=a instanceof RegExp?
a:null);return this.$$classNameFilter};this.$get=["$timeout","$$asyncCallback",function(a,d){return{enter:function(a,c,f,h){f?f.after(a):(c&&c[0]||(c=f.parent()),c.append(a));h&&d(h)},leave:function(a,c){a.remove();c&&d(c)},move:function(a,c,d,h){this.enter(a,c,d,h)},addClass:function(a,c,f){c=w(c)?c:M(c)?c.join(" "):"";q(a,function(a){ib(a,c)});f&&d(f)},removeClass:function(a,c,f){c=w(c)?c:M(c)?c.join(" "):"";q(a,function(a){hb(a,c)});f&&d(f)},setClass:function(a,c,f,h){q(a,function(a){ib(a,c);hb(a,
f)});h&&d(h)},enabled:C}}]}],ja=t("$compile");cc.$inject=["$provide","$$sanitizeUriProvider"];var te=/^(x[\:\-_]|data[\:\-_])/i,vc=t("$interpolate"),Me=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,we={http:80,https:443,ftp:21},Kb=t("$location");Ac.prototype=Lb.prototype=zc.prototype={$$html5:!1,$$replace:!1,absUrl:nb("$$absUrl"),url:function(a,c){if(E(a))return this.$$url;var d=Me.exec(a);d[1]&&this.path(decodeURIComponent(d[1]));(d[2]||d[1])&&this.search(d[3]||"");this.hash(d[5]||"",c);return this},protocol:nb("$$protocol"),
host:nb("$$host"),port:nb("$$port"),path:Bc("$$path",function(a){return"/"==a.charAt(0)?a:"/"+a}),search:function(a,c){switch(arguments.length){case 0:return this.$$search;case 1:if(w(a))this.$$search=Yb(a);else if(X(a))this.$$search=a;else throw Kb("isrcharg");break;default:E(c)||null===c?delete this.$$search[a]:this.$$search[a]=c}this.$$compose();return this},hash:Bc("$$hash",Da),replace:function(){this.$$replace=!0;return this}};var Ba=t("$parse"),Ec={},ta,Ma={"null":function(){return null},"true":function(){return!0},
"false":function(){return!1},undefined:C,"+":function(a,c,d,e){d=d(a,c);e=e(a,c);return B(d)?B(e)?d+e:d:B(e)?e:s},"-":function(a,c,d,e){d=d(a,c);e=e(a,c);return(B(d)?d:0)-(B(e)?e:0)},"*":function(a,c,d,e){return d(a,c)*e(a,c)},"/":function(a,c,d,e){return d(a,c)/e(a,c)},"%":function(a,c,d,e){return d(a,c)%e(a,c)},"^":function(a,c,d,e){return d(a,c)^e(a,c)},"=":C,"===":function(a,c,d,e){return d(a,c)===e(a,c)},"!==":function(a,c,d,e){return d(a,c)!==e(a,c)},"==":function(a,c,d,e){return d(a,c)==e(a,
c)},"!=":function(a,c,d,e){return d(a,c)!=e(a,c)},"<":function(a,c,d,e){return d(a,c)<e(a,c)},">":function(a,c,d,e){return d(a,c)>e(a,c)},"<=":function(a,c,d,e){return d(a,c)<=e(a,c)},">=":function(a,c,d,e){return d(a,c)>=e(a,c)},"&&":function(a,c,d,e){return d(a,c)&&e(a,c)},"||":function(a,c,d,e){return d(a,c)||e(a,c)},"&":function(a,c,d,e){return d(a,c)&e(a,c)},"|":function(a,c,d,e){return e(a,c)(a,c,d(a,c))},"!":function(a,c,d){return!d(a,c)}},Ne={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},
Nb=function(a){this.options=a};Nb.prototype={constructor:Nb,lex:function(a){this.text=a;this.index=0;this.ch=s;this.lastCh=":";this.tokens=[];var c;for(a=[];this.index<this.text.length;){this.ch=this.text.charAt(this.index);if(this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent(),this.was("{,")&&("{"===a[0]&&(c=this.tokens[this.tokens.length-1]))&&(c.json=-1===c.text.indexOf("."));
else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch,json:this.was(":[,")&&this.is("{[")||this.is("}]:,")}),this.is("{[")&&a.unshift(this.ch),this.is("}]")&&a.shift(),this.index++;else if(this.isWhitespace(this.ch)){this.index++;continue}else{var d=this.ch+this.peek(),e=d+this.peek(2),g=Ma[this.ch],f=Ma[d],h=Ma[e];h?(this.tokens.push({index:this.index,text:e,fn:h}),this.index+=3):f?(this.tokens.push({index:this.index,text:d,fn:f}),this.index+=2):g?(this.tokens.push({index:this.index,
text:this.ch,fn:g,json:this.was("[,:")&&this.is("+-")}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(a){return-1!==a.indexOf(this.ch)},was:function(a){return-1!==a.indexOf(this.lastCh)},peek:function(a){a=a||1;return this.index+a<this.text.length?this.text.charAt(this.index+a):!1},isNumber:function(a){return"0"<=a&&"9">=a},isWhitespace:function(a){return" "===a||"\r"===a||"\t"===a||"\n"===a||"\v"===a||"\u00a0"===
a},isIdent:function(a){return"a"<=a&&"z">=a||"A"<=a&&"Z">=a||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,c,d){d=d||this.index;c=B(c)?"s "+c+"-"+this.index+" ["+this.text.substring(c,d)+"]":" "+d;throw Ba("lexerr",a,c,this.text);},readNumber:function(){for(var a="",c=this.index;this.index<this.text.length;){var d=K(this.text.charAt(this.index));if("."==d||this.isNumber(d))a+=d;else{var e=this.peek();if("e"==d&&this.isExpOperator(e))a+=
d;else if(this.isExpOperator(d)&&e&&this.isNumber(e)&&"e"==a.charAt(a.length-1))a+=d;else if(!this.isExpOperator(d)||e&&this.isNumber(e)||"e"!=a.charAt(a.length-1))break;else this.throwError("Invalid exponent")}this.index++}a*=1;this.tokens.push({index:c,text:a,json:!0,fn:function(){return a}})},readIdent:function(){for(var a=this,c="",d=this.index,e,g,f,h;this.index<this.text.length;){h=this.text.charAt(this.index);if("."===h||this.isIdent(h)||this.isNumber(h))"."===h&&(e=this.index),c+=h;else break;
this.index++}if(e)for(g=this.index;g<this.text.length;){h=this.text.charAt(g);if("("===h){f=c.substr(e-d+1);c=c.substr(0,e-d);this.index=g;break}if(this.isWhitespace(h))g++;else break}d={index:d,text:c};if(Ma.hasOwnProperty(c))d.fn=Ma[c],d.json=Ma[c];else{var l=Dc(c,this.options,this.text);d.fn=D(function(a,c){return l(a,c)},{assign:function(d,e){return ob(d,c,e,a.text,a.options)}})}this.tokens.push(d);f&&(this.tokens.push({index:e,text:".",json:!1}),this.tokens.push({index:e+1,text:f,json:!1}))},
readString:function(a){var c=this.index;this.index++;for(var d="",e=a,g=!1;this.index<this.text.length;){var f=this.text.charAt(this.index),e=e+f;if(g)"u"===f?(f=this.text.substring(this.index+1,this.index+5),f.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+f+"]"),this.index+=4,d+=String.fromCharCode(parseInt(f,16))):d=(g=Ne[f])?d+g:d+f,g=!1;else if("\\"===f)g=!0;else{if(f===a){this.index++;this.tokens.push({index:c,text:e,string:d,json:!0,fn:function(){return d}});return}d+=
f}this.index++}this.throwError("Unterminated quote",c)}};var $a=function(a,c,d){this.lexer=a;this.$filter=c;this.options=d};$a.ZERO=D(function(){return 0},{constant:!0});$a.prototype={constructor:$a,parse:function(a,c){this.text=a;this.json=c;this.tokens=this.lexer.lex(a);c&&(this.assignment=this.logicalOR,this.functionCall=this.fieldAccess=this.objectIndex=this.filterChain=function(){this.throwError("is not valid json",{text:a,index:0})});var d=c?this.primary():this.statements();0!==this.tokens.length&&
this.throwError("is an unexpected token",this.tokens[0]);d.literal=!!d.literal;d.constant=!!d.constant;return d},primary:function(){var a;if(this.expect("("))a=this.filterChain(),this.consume(")");else if(this.expect("["))a=this.arrayDeclaration();else if(this.expect("{"))a=this.object();else{var c=this.expect();(a=c.fn)||this.throwError("not a primary expression",c);c.json&&(a.constant=!0,a.literal=!0)}for(var d;c=this.expect("(","[",".");)"("===c.text?(a=this.functionCall(a,d),d=null):"["===c.text?
(d=a,a=this.objectIndex(a)):"."===c.text?(d=a,a=this.fieldAccess(a)):this.throwError("IMPOSSIBLE");return a},throwError:function(a,c){throw Ba("syntax",c.text,a,c.index+1,this.text,this.text.substring(c.index));},peekToken:function(){if(0===this.tokens.length)throw Ba("ueoe",this.text);return this.tokens[0]},peek:function(a,c,d,e){if(0<this.tokens.length){var g=this.tokens[0],f=g.text;if(f===a||f===c||f===d||f===e||!(a||c||d||e))return g}return!1},expect:function(a,c,d,e){return(a=this.peek(a,c,d,
e))?(this.json&&!a.json&&this.throwError("is not valid json",a),this.tokens.shift(),a):!1},consume:function(a){this.expect(a)||this.throwError("is unexpected, expecting ["+a+"]",this.peek())},unaryFn:function(a,c){return D(function(d,e){return a(d,e,c)},{constant:c.constant})},ternaryFn:function(a,c,d){return D(function(e,g){return a(e,g)?c(e,g):d(e,g)},{constant:a.constant&&c.constant&&d.constant})},binaryFn:function(a,c,d){return D(function(e,g){return c(e,g,a,d)},{constant:a.constant&&d.constant})},
statements:function(){for(var a=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&a.push(this.filterChain()),!this.expect(";"))return 1===a.length?a[0]:function(c,d){for(var e,g=0;g<a.length;g++){var f=a[g];f&&(e=f(c,d))}return e}},filterChain:function(){for(var a=this.expression(),c;;)if(c=this.expect("|"))a=this.binaryFn(a,c.fn,this.filter());else return a},filter:function(){for(var a=this.expect(),c=this.$filter(a.text),d=[];;)if(a=this.expect(":"))d.push(this.expression());else{var e=
function(a,e,h){h=[h];for(var l=0;l<d.length;l++)h.push(d[l](a,e));return c.apply(a,h)};return function(){return e}}},expression:function(){return this.assignment()},assignment:function(){var a=this.ternary(),c,d;return(d=this.expect("="))?(a.assign||this.throwError("implies assignment but ["+this.text.substring(0,d.index)+"] can not be assigned to",d),c=this.ternary(),function(d,g){return a.assign(d,c(d,g),g)}):a},ternary:function(){var a=this.logicalOR(),c,d;if(this.expect("?")){c=this.ternary();
if(d=this.expect(":"))return this.ternaryFn(a,c,this.ternary());this.throwError("expected :",d)}else return a},logicalOR:function(){for(var a=this.logicalAND(),c;;)if(c=this.expect("||"))a=this.binaryFn(a,c.fn,this.logicalAND());else return a},logicalAND:function(){var a=this.equality(),c;if(c=this.expect("&&"))a=this.binaryFn(a,c.fn,this.logicalAND());return a},equality:function(){var a=this.relational(),c;if(c=this.expect("==","!=","===","!=="))a=this.binaryFn(a,c.fn,this.equality());return a},
relational:function(){var a=this.additive(),c;if(c=this.expect("<",">","<=",">="))a=this.binaryFn(a,c.fn,this.relational());return a},additive:function(){for(var a=this.multiplicative(),c;c=this.expect("+","-");)a=this.binaryFn(a,c.fn,this.multiplicative());return a},multiplicative:function(){for(var a=this.unary(),c;c=this.expect("*","/","%");)a=this.binaryFn(a,c.fn,this.unary());return a},unary:function(){var a;return this.expect("+")?this.primary():(a=this.expect("-"))?this.binaryFn($a.ZERO,a.fn,
this.unary()):(a=this.expect("!"))?this.unaryFn(a.fn,this.unary()):this.primary()},fieldAccess:function(a){var c=this,d=this.expect().text,e=Dc(d,this.options,this.text);return D(function(c,d,h){return e(h||a(c,d))},{assign:function(e,f,h){return ob(a(e,h),d,f,c.text,c.options)}})},objectIndex:function(a){var c=this,d=this.expression();this.consume("]");return D(function(e,g){var f=a(e,g),h=d(e,g),l;if(!f)return s;(f=Za(f[h],c.text))&&(f.then&&c.options.unwrapPromises)&&(l=f,"$$v"in f||(l.$$v=s,l.then(function(a){l.$$v=
a})),f=f.$$v);return f},{assign:function(e,g,f){var h=d(e,f);return Za(a(e,f),c.text)[h]=g}})},functionCall:function(a,c){var d=[];if(")"!==this.peekToken().text){do d.push(this.expression());while(this.expect(","))}this.consume(")");var e=this;return function(g,f){for(var h=[],l=c?c(g,f):g,k=0;k<d.length;k++)h.push(d[k](g,f));k=a(g,f,l)||C;Za(l,e.text);Za(k,e.text);h=k.apply?k.apply(l,h):k(h[0],h[1],h[2],h[3],h[4]);return Za(h,e.text)}},arrayDeclaration:function(){var a=[],c=!0;if("]"!==this.peekToken().text){do{if(this.peek("]"))break;
var d=this.expression();a.push(d);d.constant||(c=!1)}while(this.expect(","))}this.consume("]");return D(function(c,d){for(var f=[],h=0;h<a.length;h++)f.push(a[h](c,d));return f},{literal:!0,constant:c})},object:function(){var a=[],c=!0;if("}"!==this.peekToken().text){do{if(this.peek("}"))break;var d=this.expect(),d=d.string||d.text;this.consume(":");var e=this.expression();a.push({key:d,value:e});e.constant||(c=!1)}while(this.expect(","))}this.consume("}");return D(function(c,d){for(var e={},l=0;l<
a.length;l++){var k=a[l];e[k.key]=k.value(c,d)}return e},{literal:!0,constant:c})}};var Mb={},ua=t("$sce"),ga={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},W=U.createElement("a"),Hc=sa(O.location.href,!0);gc.$inject=["$provide"];Ic.$inject=["$locale"];Kc.$inject=["$locale"];var Nc=".",Ie={yyyy:$("FullYear",4),yy:$("FullYear",2,0,!0),y:$("FullYear",1),MMMM:pb("Month"),MMM:pb("Month",!0),MM:$("Month",2,1),M:$("Month",1,1),dd:$("Date",2),d:$("Date",1),HH:$("Hours",2),H:$("Hours",
1),hh:$("Hours",2,-12),h:$("Hours",1,-12),mm:$("Minutes",2),m:$("Minutes",1),ss:$("Seconds",2),s:$("Seconds",1),sss:$("Milliseconds",3),EEEE:pb("Day"),EEE:pb("Day",!0),a:function(a,c){return 12>a.getHours()?c.AMPMS[0]:c.AMPMS[1]},Z:function(a){a=-1*a.getTimezoneOffset();return a=(0<=a?"+":"")+(Ob(Math[0<a?"floor":"ceil"](a/60),2)+Ob(Math.abs(a%60),2))}},He=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,Ge=/^\-?\d+$/;Jc.$inject=["$locale"];var Ee=aa(K),Fe=aa(Fa);Lc.$inject=
["$parse"];var cd=aa({restrict:"E",compile:function(a,c){8>=S&&(c.href||c.name||c.$set("href",""),a.append(U.createComment("IE fix")));if(!c.href&&!c.xlinkHref&&!c.name)return function(a,c){var g="[object SVGAnimatedString]"===wa.call(c.prop("href"))?"xlink:href":"href";c.on("click",function(a){c.attr(g)||a.preventDefault()})}}}),zb={};q(kb,function(a,c){if("multiple"!=a){var d=na("ng-"+c);zb[d]=function(){return{priority:100,link:function(a,g,f){a.$watch(f[d],function(a){f.$set(c,!!a)})}}}}});q(["src",
"srcset","href"],function(a){var c=na("ng-"+a);zb[c]=function(){return{priority:99,link:function(d,e,g){var f=a,h=a;"href"===a&&"[object SVGAnimatedString]"===wa.call(e.prop("href"))&&(h="xlinkHref",g.$attr[h]="xlink:href",f=null);g.$observe(c,function(a){a&&(g.$set(h,a),S&&f&&e.prop(f,g[h]))})}}}});var sb={$addControl:C,$removeControl:C,$setValidity:C,$setDirty:C,$setPristine:C};Oc.$inject=["$element","$attrs","$scope","$animate"];var Qc=function(a){return["$timeout",function(c){return{name:"form",
restrict:a?"EAC":"E",controller:Oc,compile:function(){return{pre:function(a,e,g,f){if(!g.action){var h=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};Pc(e[0],"submit",h);e.on("$destroy",function(){c(function(){Fb(e[0],"submit",h)},0,!1)})}var l=e.parent().controller("form"),k=g.name||g.ngForm;k&&ob(a,k,f,k);if(l)e.on("$destroy",function(){l.$removeControl(f);k&&ob(a,k,s,k);D(f,sb)})}}}}}]},dd=Qc(),qd=Qc(!0),Oe=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,
Pe=/^[a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9-]+(\.[a-z0-9-]+)*$/i,Qe=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,Rc={text:ub,number:function(a,c,d,e,g,f){ub(a,c,d,e,g,f);e.$parsers.push(function(a){var c=e.$isEmpty(a);if(c||Qe.test(a))return e.$setValidity("number",!0),""===a?null:c?a:parseFloat(a);e.$setValidity("number",!1);return s});Je(e,"number",c);e.$formatters.push(function(a){return e.$isEmpty(a)?"":""+a});d.min&&(a=function(a){var c=parseFloat(d.min);return pa(e,"min",e.$isEmpty(a)||a>=c,a)},e.$parsers.push(a),
e.$formatters.push(a));d.max&&(a=function(a){var c=parseFloat(d.max);return pa(e,"max",e.$isEmpty(a)||a<=c,a)},e.$parsers.push(a),e.$formatters.push(a));e.$formatters.push(function(a){return pa(e,"number",e.$isEmpty(a)||vb(a),a)})},url:function(a,c,d,e,g,f){ub(a,c,d,e,g,f);a=function(a){return pa(e,"url",e.$isEmpty(a)||Oe.test(a),a)};e.$formatters.push(a);e.$parsers.push(a)},email:function(a,c,d,e,g,f){ub(a,c,d,e,g,f);a=function(a){return pa(e,"email",e.$isEmpty(a)||Pe.test(a),a)};e.$formatters.push(a);
e.$parsers.push(a)},radio:function(a,c,d,e){E(d.name)&&c.attr("name",bb());c.on("click",function(){c[0].checked&&a.$apply(function(){e.$setViewValue(d.value)})});e.$render=function(){c[0].checked=d.value==e.$viewValue};d.$observe("value",e.$render)},checkbox:function(a,c,d,e){var g=d.ngTrueValue,f=d.ngFalseValue;w(g)||(g=!0);w(f)||(f=!1);c.on("click",function(){a.$apply(function(){e.$setViewValue(c[0].checked)})});e.$render=function(){c[0].checked=e.$viewValue};e.$isEmpty=function(a){return a!==g};
e.$formatters.push(function(a){return a===g});e.$parsers.push(function(a){return a?g:f})},hidden:C,button:C,submit:C,reset:C,file:C},dc=["$browser","$sniffer",function(a,c){return{restrict:"E",require:"?ngModel",link:function(d,e,g,f){f&&(Rc[K(g.type)]||Rc.text)(d,e,g,f,c,a)}}}],rb="ng-valid",qb="ng-invalid",La="ng-pristine",tb="ng-dirty",Re=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate",function(a,c,d,e,g,f){function h(a,c){c=c?"-"+fb(c,"-"):"";f.removeClass(e,(a?qb:rb)+c);
f.addClass(e,(a?rb:qb)+c)}this.$modelValue=this.$viewValue=Number.NaN;this.$parsers=[];this.$formatters=[];this.$viewChangeListeners=[];this.$pristine=!0;this.$dirty=!1;this.$valid=!0;this.$invalid=!1;this.$name=d.name;var l=g(d.ngModel),k=l.assign;if(!k)throw t("ngModel")("nonassign",d.ngModel,ha(e));this.$render=C;this.$isEmpty=function(a){return E(a)||""===a||null===a||a!==a};var m=e.inheritedData("$formController")||sb,n=0,p=this.$error={};e.addClass(La);h(!0);this.$setValidity=function(a,c){p[a]!==
!c&&(c?(p[a]&&n--,n||(h(!0),this.$valid=!0,this.$invalid=!1)):(h(!1),this.$invalid=!0,this.$valid=!1,n++),p[a]=!c,h(c,a),m.$setValidity(a,c,this))};this.$setPristine=function(){this.$dirty=!1;this.$pristine=!0;f.removeClass(e,tb);f.addClass(e,La)};this.$setViewValue=function(d){this.$viewValue=d;this.$pristine&&(this.$dirty=!0,this.$pristine=!1,f.removeClass(e,La),f.addClass(e,tb),m.$setDirty());q(this.$parsers,function(a){d=a(d)});this.$modelValue!==d&&(this.$modelValue=d,k(a,d),q(this.$viewChangeListeners,
function(a){try{a()}catch(d){c(d)}}))};var r=this;a.$watch(function(){var c=l(a);if(r.$modelValue!==c){var d=r.$formatters,e=d.length;for(r.$modelValue=c;e--;)c=d[e](c);r.$viewValue!==c&&(r.$viewValue=c,r.$render())}return c})}],Fd=function(){return{require:["ngModel","^?form"],controller:Re,link:function(a,c,d,e){var g=e[0],f=e[1]||sb;f.$addControl(g);a.$on("$destroy",function(){f.$removeControl(g)})}}},Hd=aa({require:"ngModel",link:function(a,c,d,e){e.$viewChangeListeners.push(function(){a.$eval(d.ngChange)})}}),
ec=function(){return{require:"?ngModel",link:function(a,c,d,e){if(e){d.required=!0;var g=function(a){if(d.required&&e.$isEmpty(a))e.$setValidity("required",!1);else return e.$setValidity("required",!0),a};e.$formatters.push(g);e.$parsers.unshift(g);d.$observe("required",function(){g(e.$viewValue)})}}}},Gd=function(){return{require:"ngModel",link:function(a,c,d,e){var g=(a=/\/(.*)\//.exec(d.ngList))&&RegExp(a[1])||d.ngList||",";e.$parsers.push(function(a){if(!E(a)){var c=[];a&&q(a.split(g),function(a){a&&
c.push(ca(a))});return c}});e.$formatters.push(function(a){return M(a)?a.join(", "):s});e.$isEmpty=function(a){return!a||!a.length}}}},Se=/^(true|false|\d+)$/,Id=function(){return{priority:100,compile:function(a,c){return Se.test(c.ngValue)?function(a,c,g){g.$set("value",a.$eval(g.ngValue))}:function(a,c,g){a.$watch(g.ngValue,function(a){g.$set("value",a)})}}}},id=va(function(a,c,d){c.addClass("ng-binding").data("$binding",d.ngBind);a.$watch(d.ngBind,function(a){c.text(a==s?"":a)})}),kd=["$interpolate",
function(a){return function(c,d,e){c=a(d.attr(e.$attr.ngBindTemplate));d.addClass("ng-binding").data("$binding",c);e.$observe("ngBindTemplate",function(a){d.text(a)})}}],jd=["$sce","$parse",function(a,c){return function(d,e,g){e.addClass("ng-binding").data("$binding",g.ngBindHtml);var f=c(g.ngBindHtml);d.$watch(function(){return(f(d)||"").toString()},function(c){e.html(a.getTrustedHtml(f(d))||"")})}}],ld=Pb("",!0),nd=Pb("Odd",0),md=Pb("Even",1),od=va({compile:function(a,c){c.$set("ngCloak",s);a.removeClass("ng-cloak")}}),
pd=[function(){return{scope:!0,controller:"@",priority:500}}],fc={};q("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(a){var c=na("ng-"+a);fc[c]=["$parse",function(d){return{compile:function(e,g){var f=d(g[c]);return function(c,d,e){d.on(K(a),function(a){c.$apply(function(){f(c,{$event:a})})})}}}}]});var sd=["$animate",function(a){return{transclude:"element",priority:600,terminal:!0,restrict:"A",
$$tlb:!0,link:function(c,d,e,g,f){var h,l,k;c.$watch(e.ngIf,function(g){Qa(g)?l||(l=c.$new(),f(l,function(c){c[c.length++]=U.createComment(" end ngIf: "+e.ngIf+" ");h={clone:c};a.enter(c,d.parent(),d)})):(k&&(k.remove(),k=null),l&&(l.$destroy(),l=null),h&&(k=yb(h.clone),a.leave(k,function(){k=null}),h=null))})}}}],td=["$http","$templateCache","$anchorScroll","$animate","$sce",function(a,c,d,e,g){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:Ea.noop,compile:function(f,
h){var l=h.ngInclude||h.src,k=h.onload||"",m=h.autoscroll;return function(f,h,q,s,u){var F=0,v,y,A,x=function(){y&&(y.remove(),y=null);v&&(v.$destroy(),v=null);A&&(e.leave(A,function(){y=null}),y=A,A=null)};f.$watch(g.parseAsResourceUrl(l),function(g){var l=function(){!B(m)||m&&!f.$eval(m)||d()},q=++F;g?(a.get(g,{cache:c}).success(function(a){if(q===F){var c=f.$new();s.template=a;a=u(c,function(a){x();e.enter(a,null,h,l)});v=c;A=a;v.$emit("$includeContentLoaded");f.$eval(k)}}).error(function(){q===
F&&x()}),f.$emit("$includeContentRequested")):(x(),s.template=null)})}}}}],Jd=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(c,d,e,g){d.html(g.template);a(d.contents())(c)}}}],ud=va({priority:450,compile:function(){return{pre:function(a,c,d){a.$eval(d.ngInit)}}}}),vd=va({terminal:!0,priority:1E3}),wd=["$locale","$interpolate",function(a,c){var d=/{}/g;return{restrict:"EA",link:function(e,g,f){var h=f.count,l=f.$attr.when&&g.attr(f.$attr.when),k=f.offset||
0,m=e.$eval(l)||{},n={},p=c.startSymbol(),r=c.endSymbol(),s=/^when(Minus)?(.+)$/;q(f,function(a,c){s.test(c)&&(m[K(c.replace("when","").replace("Minus","-"))]=g.attr(f.$attr[c]))});q(m,function(a,e){n[e]=c(a.replace(d,p+h+"-"+k+r))});e.$watch(function(){var c=parseFloat(e.$eval(h));if(isNaN(c))return"";c in m||(c=a.pluralCat(c-k));return n[c](e,g,!0)},function(a){g.text(a)})}}}],xd=["$parse","$animate",function(a,c){var d=t("ngRepeat");return{transclude:"element",priority:1E3,terminal:!0,$$tlb:!0,
link:function(e,g,f,h,l){var k=f.ngRepeat,m=k.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),n,p,r,s,u,F,v={$id:Ia};if(!m)throw d("iexp",k);f=m[1];h=m[2];(m=m[3])?(n=a(m),p=function(a,c,d){F&&(v[F]=a);v[u]=c;v.$index=d;return n(e,v)}):(r=function(a,c){return Ia(c)},s=function(a){return a});m=f.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/);if(!m)throw d("iidexp",f);u=m[3]||m[1];F=m[2];var B={};e.$watchCollection(h,function(a){var f,h,m=g[0],n,v={},H,R,w,C,T,t,
E=[];if(ab(a))T=a,n=p||r;else{n=p||s;T=[];for(w in a)a.hasOwnProperty(w)&&"$"!=w.charAt(0)&&T.push(w);T.sort()}H=T.length;h=E.length=T.length;for(f=0;f<h;f++)if(w=a===T?f:T[f],C=a[w],C=n(w,C,f),Aa(C,"`track by` id"),B.hasOwnProperty(C))t=B[C],delete B[C],v[C]=t,E[f]=t;else{if(v.hasOwnProperty(C))throw q(E,function(a){a&&a.scope&&(B[a.id]=a)}),d("dupes",k,C);E[f]={id:C};v[C]=!1}for(w in B)B.hasOwnProperty(w)&&(t=B[w],f=yb(t.clone),c.leave(f),q(f,function(a){a.$$NG_REMOVED=!0}),t.scope.$destroy());
f=0;for(h=T.length;f<h;f++){w=a===T?f:T[f];C=a[w];t=E[f];E[f-1]&&(m=E[f-1].clone[E[f-1].clone.length-1]);if(t.scope){R=t.scope;n=m;do n=n.nextSibling;while(n&&n.$$NG_REMOVED);t.clone[0]!=n&&c.move(yb(t.clone),null,y(m));m=t.clone[t.clone.length-1]}else R=e.$new();R[u]=C;F&&(R[F]=w);R.$index=f;R.$first=0===f;R.$last=f===H-1;R.$middle=!(R.$first||R.$last);R.$odd=!(R.$even=0===(f&1));t.scope||l(R,function(a){a[a.length++]=U.createComment(" end ngRepeat: "+k+" ");c.enter(a,null,y(m));m=a;t.scope=R;t.clone=
a;v[t.id]=t})}B=v})}}}],yd=["$animate",function(a){return function(c,d,e){c.$watch(e.ngShow,function(c){a[Qa(c)?"removeClass":"addClass"](d,"ng-hide")})}}],rd=["$animate",function(a){return function(c,d,e){c.$watch(e.ngHide,function(c){a[Qa(c)?"addClass":"removeClass"](d,"ng-hide")})}}],zd=va(function(a,c,d){a.$watch(d.ngStyle,function(a,d){d&&a!==d&&q(d,function(a,d){c.css(d,"")});a&&c.css(a)},!0)}),Ad=["$animate",function(a){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases=
{}}],link:function(c,d,e,g){var f,h,l,k=[];c.$watch(e.ngSwitch||e.on,function(d){var n,p=k.length;if(0<p){if(l){for(n=0;n<p;n++)l[n].remove();l=null}l=[];for(n=0;n<p;n++){var r=h[n];k[n].$destroy();l[n]=r;a.leave(r,function(){l.splice(n,1);0===l.length&&(l=null)})}}h=[];k=[];if(f=g.cases["!"+d]||g.cases["?"])c.$eval(e.change),q(f,function(d){var e=c.$new();k.push(e);d.transclude(e,function(c){var e=d.element;h.push(c);a.enter(c,e.parent(),e)})})})}}}],Bd=va({transclude:"element",priority:800,require:"^ngSwitch",
link:function(a,c,d,e,g){e.cases["!"+d.ngSwitchWhen]=e.cases["!"+d.ngSwitchWhen]||[];e.cases["!"+d.ngSwitchWhen].push({transclude:g,element:c})}}),Cd=va({transclude:"element",priority:800,require:"^ngSwitch",link:function(a,c,d,e,g){e.cases["?"]=e.cases["?"]||[];e.cases["?"].push({transclude:g,element:c})}}),Ed=va({link:function(a,c,d,e,g){if(!g)throw t("ngTransclude")("orphan",ha(c));g(function(a){c.empty();c.append(a)})}}),ed=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(c,
d){"text/ng-template"==d.type&&a.put(d.id,c[0].text)}}}],Te=t("ngOptions"),Dd=aa({terminal:!0}),fd=["$compile","$parse",function(a,c){var d=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,e={$setViewValue:C};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(a,c,d){var l=this,k={},m=e,n;l.databound=
d.ngModel;l.init=function(a,c,d){m=a;n=d};l.addOption=function(c){Aa(c,'"option value"');k[c]=!0;m.$viewValue==c&&(a.val(c),n.parent()&&n.remove())};l.removeOption=function(a){this.hasOption(a)&&(delete k[a],m.$viewValue==a&&this.renderUnknownOption(a))};l.renderUnknownOption=function(c){c="? "+Ia(c)+" ?";n.val(c);a.prepend(n);a.val(c);n.prop("selected",!0)};l.hasOption=function(a){return k.hasOwnProperty(a)};c.$on("$destroy",function(){l.renderUnknownOption=C})}],link:function(e,f,h,l){function k(a,
c,d,e){d.$render=function(){var a=d.$viewValue;e.hasOption(a)?(A.parent()&&A.remove(),c.val(a),""===a&&w.prop("selected",!0)):E(a)&&w?c.val(""):e.renderUnknownOption(a)};c.on("change",function(){a.$apply(function(){A.parent()&&A.remove();d.$setViewValue(c.val())})})}function m(a,c,d){var e;d.$render=function(){var a=new Va(d.$viewValue);q(c.find("option"),function(c){c.selected=B(a.get(c.value))})};a.$watch(function(){xa(e,d.$viewValue)||(e=ba(d.$viewValue),d.$render())});c.on("change",function(){a.$apply(function(){var a=
[];q(c.find("option"),function(c){c.selected&&a.push(c.value)});d.$setViewValue(a)})})}function n(e,f,g){function h(){var a={"":[]},c=[""],d,k,s,t,z;t=g.$modelValue;z=y(e)||[];var E=n?Qb(z):z,F,I,A;I={};s=!1;var D,H;if(r)if(w&&M(t))for(s=new Va([]),A=0;A<t.length;A++)I[m]=t[A],s.put(w(e,I),t[A]);else s=new Va(t);for(A=0;F=E.length,A<F;A++){k=A;if(n){k=E[A];if("$"===k.charAt(0))continue;I[n]=k}I[m]=z[k];d=p(e,I)||"";(k=a[d])||(k=a[d]=[],c.push(d));r?d=B(s.remove(w?w(e,I):q(e,I))):(w?(d={},d[m]=t,d=
w(e,d)===w(e,I)):d=t===q(e,I),s=s||d);D=l(e,I);D=B(D)?D:"";k.push({id:w?w(e,I):n?E[A]:A,label:D,selected:d})}r||(u||null===t?a[""].unshift({id:"",label:"",selected:!s}):s||a[""].unshift({id:"?",label:"",selected:!0}));I=0;for(E=c.length;I<E;I++){d=c[I];k=a[d];x.length<=I?(t={element:C.clone().attr("label",d),label:k.label},z=[t],x.push(z),f.append(t.element)):(z=x[I],t=z[0],t.label!=d&&t.element.attr("label",t.label=d));D=null;A=0;for(F=k.length;A<F;A++)s=k[A],(d=z[A+1])?(D=d.element,d.label!==s.label&&
D.text(d.label=s.label),d.id!==s.id&&D.val(d.id=s.id),d.selected!==s.selected&&D.prop("selected",d.selected=s.selected)):(""===s.id&&u?H=u:(H=v.clone()).val(s.id).attr("selected",s.selected).text(s.label),z.push({element:H,label:s.label,id:s.id,selected:s.selected}),D?D.after(H):t.element.append(H),D=H);for(A++;z.length>A;)z.pop().element.remove()}for(;x.length>I;)x.pop()[0].element.remove()}var k;if(!(k=t.match(d)))throw Te("iexp",t,ha(f));var l=c(k[2]||k[1]),m=k[4]||k[6],n=k[5],p=c(k[3]||""),q=
c(k[2]?k[1]:m),y=c(k[7]),w=k[8]?c(k[8]):null,x=[[{element:f,label:""}]];u&&(a(u)(e),u.removeClass("ng-scope"),u.remove());f.empty();f.on("change",function(){e.$apply(function(){var a,c=y(e)||[],d={},h,k,l,p,t,v,u;if(r)for(k=[],p=0,v=x.length;p<v;p++)for(a=x[p],l=1,t=a.length;l<t;l++){if((h=a[l].element)[0].selected){h=h.val();n&&(d[n]=h);if(w)for(u=0;u<c.length&&(d[m]=c[u],w(e,d)!=h);u++);else d[m]=c[h];k.push(q(e,d))}}else{h=f.val();if("?"==h)k=s;else if(""===h)k=null;else if(w)for(u=0;u<c.length;u++){if(d[m]=
c[u],w(e,d)==h){k=q(e,d);break}}else d[m]=c[h],n&&(d[n]=h),k=q(e,d);1<x[0].length&&x[0][1].id!==h&&(x[0][1].selected=!1)}g.$setViewValue(k)})});g.$render=h;e.$watch(h)}if(l[1]){var p=l[0];l=l[1];var r=h.multiple,t=h.ngOptions,u=!1,w,v=y(U.createElement("option")),C=y(U.createElement("optgroup")),A=v.clone();h=0;for(var x=f.children(),D=x.length;h<D;h++)if(""===x[h].value){w=u=x.eq(h);break}p.init(l,u,A);r&&(l.$isEmpty=function(a){return!a||0===a.length});t?n(e,f,l):r?m(e,f,l):k(e,f,l,p)}}}}],hd=["$interpolate",
function(a){var c={addOption:C,removeOption:C};return{restrict:"E",priority:100,compile:function(d,e){if(E(e.value)){var g=a(d.text(),!0);g||e.$set("value",d.text())}return function(a,d,e){var k=d.parent(),m=k.data("$selectController")||k.parent().data("$selectController");m&&m.databound?d.prop("selected",!1):m=c;g?a.$watch(g,function(a,c){e.$set("value",a);a!==c&&m.removeOption(c);m.addOption(a)}):m.addOption(e.value);d.on("$destroy",function(){m.removeOption(e.value)})}}}}],gd=aa({restrict:"E",
terminal:!0});O.angular.bootstrap?console.log("WARNING: Tried to load angular more than once."):((Ga=O.jQuery)?(y=Ga,D(Ga.fn,{scope:Ja.scope,isolateScope:Ja.isolateScope,controller:Ja.controller,injector:Ja.injector,inheritedData:Ja.inheritedData}),Ab("remove",!0,!0,!1),Ab("empty",!1,!1,!1),Ab("html",!1,!1,!0)):y=N,Ea.element=y,Zc(Ea),y(U).ready(function(){Wc(U,$b)}))})(window,document);!angular.$$csp()&&angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}</style>');


},{}],4:[function(require,module,exports){
require("./angular/angular.min.js");
require("angular-animate");
require("./libs/ui-bootstrap-tpls-0.11.2.min.js");
require("./libs/angular-translate.js");
require("./libs/angular-translate-loader-static-files.js");
require("./libs/promise-tracker.js");
require("./libs/promise-tracker-http-interceptor.js");
require("./multiselect/multiselect.js");
require("./navigation-blocker/navigation-blocker.js");
require("./language-changer/language-changer.js");
require("./tabs/form-tabs.js");
require("./utils/utils.js");
require("./error-mapper/error-mapper.js");
require("./angular-elastic/elastic.js");
require("./order-object-by/ng-order-object-by.js");
require("./notification/notification.js");
require("./libs/ui-handsontable.js");
require("./libs/numeral.de-de.js");
require("./angular-app.js");
},{"./angular-app.js":1,"./angular-elastic/elastic.js":2,"./angular/angular.min.js":3,"./error-mapper/error-mapper.js":5,"./language-changer/language-changer.js":6,"./libs/angular-translate-loader-static-files.js":7,"./libs/angular-translate.js":8,"./libs/numeral.de-de.js":9,"./libs/promise-tracker-http-interceptor.js":10,"./libs/promise-tracker.js":11,"./libs/ui-bootstrap-tpls-0.11.2.min.js":12,"./libs/ui-handsontable.js":13,"./multiselect/multiselect.js":14,"./navigation-blocker/navigation-blocker.js":15,"./notification/notification.js":16,"./order-object-by/ng-order-object-by.js":17,"./tabs/form-tabs.js":18,"./utils/utils.js":19,"angular-animate":20}],5:[function(require,module,exports){
/**
 * Created by argoaava on 13.05.14.
 */

angular.module('ui.errorMapper', [])
    .service('errorMapperService', function() {
        this.errorMappings = {
            "required" : "This is a required field",
            "pattern_decimal" : "Please provide a number greater than 0",
            "pattern_integer" : "Please provide a whole number greater than 0",
            "pattern_telephone" : "Please enter a valid telephone number (at least 7 digits)",
            "pattern_email" : "Please enter a valid email address",
            "pattern_url" : "Please enter a valid URL",
            "pattern_longitude" : "Please enter number between -180 and 180 ",
            "pattern_latitude" : "Please enter number between -90 and 90"};

        this.getErrorMappings = function() {
            return this.errorMappings;
        }

        this.addErrorMapping = function(key, message) {
            this.errorMappings[key] = message;
        }

        this.setErrorMappings = function(errorMappings) {
            this.errorMappings = errorMappings;
        }
    })
    .controller("ErrorController", function ($scope, errorMapperService) {

        $scope.errorMappings = errorMapperService.getErrorMappings();
        $scope.showCurrentError = false;

        $scope.getErrorMessage = function(errorCode) {
            return $scope.errorMappings[errorCode];
        };

        $scope.getController = function(attributes) {
            if (!attributes.watchView) {
                return null;
            }
            var tokens = attributes.watchView.split(".");
            var result = $scope;
            while(tokens.length) {
                result = result[tokens.shift()];
                if (!result) {
                    return null;
                }
            }
            return result;
        };

        $scope.parseErrors = function(ctrl, attributes) {
            var fieldNameIdentifier = !attributes.watchView? attributes.errorMapper : attributes.watchView;
            var nameTokens = fieldNameIdentifier.split('.');
            var name = nameTokens[1];

            var fieldController = !ctrl[name]? $scope.getController(attributes) : ctrl[name];
            if (!fieldController) {
                if (!attributes.radioButtonValues) {
                    throw Error("input field controller not found for " + attributes.errorMapper);
                } else {
                    var radioButtonValues = JSON.parse(attributes.radioButtonValues);
                    $scope.showCurrentError = !radioButtonValues.value && $scope.submitted && radioButtonValues.required;
                    $scope.currentErrorCode = 'required';
                    return;
                }
            }

            var controllerErrors = fieldController.$error;
            if ( !attributes.errorsToShow) return;
            var errorsToShowAsArray = JSON.parse(attributes.errorsToShow);

            for (var i = 0; i < errorsToShowAsArray.length; i++) {
                var splitErrorString = errorsToShowAsArray[i].split('_');
                var strippedErrorString = splitErrorString[0];
                if (controllerErrors[strippedErrorString]) {
                    $scope.showCurrentError = $scope.showError(fieldController, strippedErrorString);
                    $scope.currentErrorCode = errorsToShowAsArray[i];
                    break;
                } else {
                    $scope.showCurrentError = false;
                }
            }
        }

        $scope.showError = function(modelController, errorCode) {
            return ($scope.submitted || modelController.$dirty) && modelController.$error[errorCode] && modelController.$invalid;
        };
    })

    // Error mapper directive to simplify showing errors for input fields and get rid of some
    // boilerplate code.
    //
    // Usage:
    //
    // <input name="Money" ng-model="instance.MMRArticle17Questionnaire.Table1.Money" type="text"
    //      ng-pattern="decimalNumberPattern" required/>
    // <div class="invalid-msg" td-error-mapper watch-elements='["Table1.OtherDescription"]'
    //      watch-view="Form.InputName" errors-to-show='["required", "pattern_decimal"]'></div>
    // ...
    // Where <div> with 'td-error-mapper' attribute is used as error div and all functionality is applied.
    //
    // Configuration parameters:
    // td-error-mapper - identifier for error mapper and scope parameter watcher e.g td-error-mapper="userName". Whenever
    //                   $scope.userName changes it is picked up by mapper and correct error is shown when identified.
    // watch-view      - Used to watch view value of the field. Useful for watching number fields etc. when actual scope
    //                   value does not change on invalid field value.
    //                   Should be used as {FormName}.{InputName} so InputName can be extracted to get correct controller.
    // watch-elements  - Array of string that is parsed and registered for watching. Whenever 'Table1.OtherDescription'
    //                   changes then parse function is called and correct errors show for current input.
    // errors-to-show  - Errors to be shown as array. This string is parsed and errors are shown in the same order
    //                   as array. Names can be used for different kind of messages as follows e.g "pattern_decimal"
    //                   means error type is pattern and message type decimal. First part is extracted used together with
    //                   angular ng-pattern directive to get correct result.
    .directive('errorMapper',function () {
        return {
            restrict: 'A',
            require: '?^form',
            scope: true,
            controller: 'ErrorController',
            template: '<span ng-show=\"showCurrentError\">{{getErrorMessage(currentErrorCode)}}</span>',
            link: function(scope, element, attrs, ctrl) {
                if (!attrs.watchView) {
                    scope.$watch(attrs.errorMapper, function() {
                        scope.parseErrors(ctrl, attrs);
                    });
                } else {
                    scope.$watch(attrs.watchView + ".$viewValue", function() {
                        scope.parseErrors(ctrl, attrs);
                    });
                }

                scope.$watch('submitted', function() {
                    scope.parseErrors(ctrl, attrs);
                });

                //For watching other values that this error depends on
                if (attrs.watchElements) {
                    var watchArray = JSON.parse(attrs.watchElements);
                    for (var i = 0; i < watchArray.length; i++) {
                        scope.$watch(watchArray[i] + ".$viewValue", function() {
                            scope.parseErrors(ctrl, attrs);
                        });
                    }
                }

            }
        }
    })
},{}],6:[function(require,module,exports){
/**
 * Created by argoaava on 22.04.14.
 */

// Module that provides language changing functionality to webform.
//
// Module needs configuration and <div td-language-changer></div> or <td-language-changer/> tags.
// td-language-changer component is replaced with language select input that is configured to use
// pre-configured values.
//
// Example configuration of languageChanger
//
// app.config(["languageChangerProvider", function(languageChangerProvider) {
//    languageChangerProvider.setDefaultLanguage('en');
//    languageChangerProvider.setLanguageFilePrefix('en-labels-');
//    languageChangerProvider.setAvailableLanguages({"item" :[{
//        "code": "bg",
//        "label": "Български (bg)"}, {
//        "code": "cs",
//        "label": "čeština (cs)"}, {
//        "code": "hr",
//        "label": "Hrvatski (hr)"}, {
//        "code": "da",
//        "label": "Dansk (da)"}, {
//        "code": "nl",
//        "label": "Nederlands (nl)"}, {
//        "code": "el",
//        "label": "ελληνικά (el)"}, {
//        "code": "en",
//        "label": "English (en)"}, {
//        "code": "et",
//        "label": "Eesti (et)"}, {
//        "code": "fi",
//        "label": "Suomi (fi)"}, {
//        "code": "fr",
//        "label": "Français (fr)"}, {
//        "code": "de",
//        "label": "Deutsch (de)"}, {
//        "code": "hu",
//        "label": "Magyar (hu)"}, {
//        "code": "is",
//        "label": "Íslenska (is)"}, {
//        "code": "it",
//        "label": "Italiano (it)"}, {
//        "code": "lv",
//        "label": "Latviešu (lv)"}, {
//        "code": "lt",
//        "label": "Lietuvių (lt)"}, {
//        "code": "mt",
//        "label": "Malti (mt)"}, {
//        "code": "no",
//        "label": "Norsk (no)"}, {
//        "code": "pl",
//        "label": "Polski (pl)"}, {
//        "code": "pt",
//        "label": "Português (pt)"}, {
//        "code": "ro",
//        "label": "Română (ro)"}, {
//        "code": "sk",
//        "label": "Slovenčina (sk)"}, {
//        "code": "sl",
//        "label": "Slovenščina (sl)"}, {
//        "code": "es",
//        "label": "Español (es)"}, {
//        "code": "sv",
//        "label": "Svenska (sv)"}, {
//        "code": "tr",
//        "label": "Türkçe (tr)"}]})
//}]);


angular.module('translate.languageChanger', ['pascalprecht.translate'])
    .factory('customLoader', function ($rootScope, $http, $q, languageChanger) {
        return function (options) {
            var deferred = $q.defer();

            if (!languageChanger.getLanguageFilePrefix()) {
                throw new Error("Language file prefix must be defined when using languageChanger component.");
            }

            var languageUrl = languageChanger.getLanguageFilePrefix() + options.key + '.xml?format=json';

            $http({
                method:'GET',
                url: languageUrl
            }, {tracker : $rootScope.loadingTracker})
                .success(function (data) {
                    deferred.resolve(data.labels);
                    //alert('label-' + options.key + '.json' +' success');
                }).error(function () {
                    deferred.reject(options.key);
                    //alert('label-' + options.key + '.json' +' error');

                });
            //alert(options.key);
            return deferred.promise;
        }
    })

    .provider('languageChanger', function languageChangerProvider() {

        this.currentLanguage = 'en';
        this.availableLanguages = [];
        this.languageFilePrefix = '';

        this.setDefaultLanguage = function(defaultLanguage) {
            this.currentLanguage = defaultLanguage;
        };

        this.setLanguageFilePrefix = function(prefix) {
            this.languageFilePrefix = prefix;
        };

        this.setAvailableLanguages = function(availableLanguages) {
            this.availableLanguages = availableLanguages;
        };

        this.$get = function() {
            var availableLanguages = this.availableLanguages;
            var currentLanguage = this.currentLanguage;
            var prefix = this.languageFilePrefix;
            return {
                getLanguage : function() {return currentLanguage;},
                setLanguage : function(newLanguage) {currentLanguage = newLanguage;},
                getAvailableLanguages : function() {return availableLanguages;},
                getLanguageFilePrefix : function() {return prefix;}
            }
        };
    })

    .config( function ($translateProvider) {
        $translateProvider.useLoader('customLoader', {});
        // load 'en' table on startup
        $translateProvider.preferredLanguage('en');
    })

    .controller('LanguageCtrl', ['$scope', '$rootScope', '$translate', 'languageChanger', 'dataRepository', function ($scope, $rootScope, $translate, languageChanger, dataRepository) {

        $scope.currentLanguage = languageChanger.getLanguage();
        $scope.availableLanguages = languageChanger.getAvailableLanguages();

        $scope.changeLang = function () {
            languageChanger.setLanguage($scope.currentLanguage)
            $translate.use(languageChanger.getLanguage());
            dataRepository.loadCodeList(languageChanger.getLanguage());
            if (languageChanger.getLanguage() != $rootScope.currentLanguage) {
                $rootScope.currentLanguage = languageChanger.getLanguage()
            }
        };
        $rootScope.$watch('currentLanguage', function(newValue, oldValue) {
            if (!newValue) {
                return;
            } else {
                if (!oldValue || (languageChanger.getLanguage() != $rootScope.currentLanguage)) {
                    $scope.currentLanguage = $rootScope.currentLanguage;
                    $scope.changeLang();
                }
            }
        })
    }])

    .directive("languageChanger", function () {
        return {
            restrict: 'A',
            controller: 'LanguageCtrl',
            template: "<div ng-show=\"availableLanguages.item.length > 0\" class=\"span2\" ng-controller=\"LanguageCtrl\" style=\"float: right;\"><select name=\"FormLanguage\" class=\"input-medium\" ng-model=\"currentLanguage\" ng-options=\"language.code as language.label for language in availableLanguages.item\" ng-change=\"changeLang()\"></select></div>"
        }
    })

},{}],7:[function(require,module,exports){
angular.module('pascalprecht.translate').factory('$translateStaticFilesLoader', [
  '$q',
  '$http',
  function ($q, $http) {
    return function (options) {
      if (!options || (!angular.isString(options.prefix) || !angular.isString(options.suffix))) {
        throw new Error('Couldn\'t load static files, no prefix or suffix specified!');
      }
      var deferred = $q.defer();
      $http({
        url: [
          options.prefix,
          options.key,
          options.suffix
        ].join(''),
        method: 'GET',
        params: ''
      }).success(function (data) {
        deferred.resolve(data);
      }).error(function (data) {
        deferred.reject(options.key);
      });
      return deferred.promise;
    };
  }
]);
},{}],8:[function(require,module,exports){
angular.module('pascalprecht.translate', ['ng']).run([
  '$translate',
  function ($translate) {
    var key = $translate.storageKey(), storage = $translate.storage();
    if (storage) {
      if (!storage.get(key)) {
        if (angular.isString($translate.preferredLanguage())) {
          $translate.use($translate.preferredLanguage());
        } else {
          storage.set(key, $translate.use());
        }
      } else {
        $translate.use(storage.get(key));
      }
    } else if (angular.isString($translate.preferredLanguage())) {
      $translate.use($translate.preferredLanguage());
    }
  }
]);
angular.module('pascalprecht.translate').provider('$translate', [
  '$STORAGE_KEY',
  function ($STORAGE_KEY) {
    var $translationTable = {}, $preferredLanguage, $availableLanguageKeys = [], $languageKeyAliases, $fallbackLanguage, $fallbackWasString, $uses, $nextLang, $storageFactory, $storageKey = $STORAGE_KEY, $storagePrefix, $missingTranslationHandlerFactory, $interpolationFactory, $interpolatorFactories = [], $interpolationSanitizationStrategy = false, $loaderFactory, $cloakClassName = 'translate-cloak', $loaderOptions, $notFoundIndicatorLeft, $notFoundIndicatorRight, $postCompilingEnabled = false, NESTED_OBJECT_DELIMITER = '.';
    var getLocale = function () {
      var nav = window.navigator;
      return (nav.language || nav.browserLanguage || nav.systemLanguage || nav.userLanguage || '').split('-').join('_');
    };
    var negotiateLocale = function (preferred) {
      var avail = [], locale = angular.lowercase(preferred), i = 0, n = $availableLanguageKeys.length;
      for (; i < n; i++) {
        avail.push(angular.lowercase($availableLanguageKeys[i]));
      }
      if (avail.indexOf(locale) > -1) {
        return locale;
      }
      if ($languageKeyAliases) {
        if ($languageKeyAliases[preferred]) {
          var alias = $languageKeyAliases[preferred];
          if (avail.indexOf(angular.lowercase(alias)) > -1) {
            return alias;
          }
        }
      }
      var parts = preferred.split('_');
      if (parts.length > 1 && avail.indexOf(angular.lowercase(parts[0])) > 1) {
        return parts[0];
      }
    };
    var translations = function (langKey, translationTable) {
      if (!langKey && !translationTable) {
        return $translationTable;
      }
      if (langKey && !translationTable) {
        if (angular.isString(langKey)) {
          return $translationTable[langKey];
        }
      } else {
        if (!angular.isObject($translationTable[langKey])) {
          $translationTable[langKey] = {};
        }
        angular.extend($translationTable[langKey], flatObject(translationTable));
      }
      return this;
    };
    this.translations = translations;
    this.cloakClassName = function (name) {
      if (!name) {
        return $cloakClassName;
      }
      $cloakClassName = name;
      return this;
    };
    var flatObject = function (data, path, result, prevKey) {
      var key, keyWithPath, keyWithShortPath, val;
      if (!path) {
        path = [];
      }
      if (!result) {
        result = {};
      }
      for (key in data) {
        if (!data.hasOwnProperty(key)) {
          continue;
        }
        val = data[key];
        if (angular.isObject(val)) {
          flatObject(val, path.concat(key), result, key);
        } else {
          keyWithPath = path.length ? '' + path.join(NESTED_OBJECT_DELIMITER) + NESTED_OBJECT_DELIMITER + key : key;
          if (path.length && key === prevKey) {
            keyWithShortPath = '' + path.join(NESTED_OBJECT_DELIMITER);
            result[keyWithShortPath] = '@:' + keyWithPath;
          }
          result[keyWithPath] = val;
        }
      }
      return result;
    };
    this.addInterpolation = function (factory) {
      $interpolatorFactories.push(factory);
      return this;
    };
    this.useMessageFormatInterpolation = function () {
      return this.useInterpolation('$translateMessageFormatInterpolation');
    };
    this.useInterpolation = function (factory) {
      $interpolationFactory = factory;
      return this;
    };
    this.useSanitizeValueStrategy = function (value) {
      $interpolationSanitizationStrategy = value;
      return this;
    };
    this.preferredLanguage = function (langKey) {
      if (langKey) {
        $preferredLanguage = langKey;
        return this;
      }
      return $preferredLanguage;
    };
    this.translationNotFoundIndicator = function (indicator) {
      this.translationNotFoundIndicatorLeft(indicator);
      this.translationNotFoundIndicatorRight(indicator);
      return this;
    };
    this.translationNotFoundIndicatorLeft = function (indicator) {
      if (!indicator) {
        return $notFoundIndicatorLeft;
      }
      $notFoundIndicatorLeft = indicator;
      return this;
    };
    this.translationNotFoundIndicatorRight = function (indicator) {
      if (!indicator) {
        return $notFoundIndicatorRight;
      }
      $notFoundIndicatorRight = indicator;
      return this;
    };
    this.fallbackLanguage = function (langKey) {
      fallbackStack(langKey);
      return this;
    };
    var fallbackStack = function (langKey) {
      if (langKey) {
        if (angular.isString(langKey)) {
          $fallbackWasString = true;
          $fallbackLanguage = [langKey];
        } else if (angular.isArray(langKey)) {
          $fallbackWasString = false;
          $fallbackLanguage = langKey;
        }
        if (angular.isString($preferredLanguage)) {
          $fallbackLanguage.push($preferredLanguage);
        }
        return this;
      } else {
        if ($fallbackWasString) {
          return $fallbackLanguage[0];
        } else {
          return $fallbackLanguage;
        }
      }
    };
    this.use = function (langKey) {
      if (langKey) {
        if (!$translationTable[langKey] && !$loaderFactory) {
          throw new Error('$translateProvider couldn\'t find translationTable for langKey: \'' + langKey + '\'');
        }
        $uses = langKey;
        return this;
      }
      return $uses;
    };
    var storageKey = function (key) {
      if (!key) {
        if ($storagePrefix) {
          return $storagePrefix + $storageKey;
        }
        return $storageKey;
      }
      $storageKey = key;
    };
    this.storageKey = storageKey;
    this.useUrlLoader = function (url) {
      return this.useLoader('$translateUrlLoader', { url: url });
    };
    this.useStaticFilesLoader = function (options) {
      return this.useLoader('$translateStaticFilesLoader', options);
    };
    this.useLoader = function (loaderFactory, options) {
      $loaderFactory = loaderFactory;
      $loaderOptions = options || {};
      return this;
    };
    this.useLocalStorage = function () {
      return this.useStorage('$translateLocalStorage');
    };
    this.useCookieStorage = function () {
      return this.useStorage('$translateCookieStorage');
    };
    this.useStorage = function (storageFactory) {
      $storageFactory = storageFactory;
      return this;
    };
    this.storagePrefix = function (prefix) {
      if (!prefix) {
        return prefix;
      }
      $storagePrefix = prefix;
      return this;
    };
    this.useMissingTranslationHandlerLog = function () {
      return this.useMissingTranslationHandler('$translateMissingTranslationHandlerLog');
    };
    this.useMissingTranslationHandler = function (factory) {
      $missingTranslationHandlerFactory = factory;
      return this;
    };
    this.usePostCompiling = function (value) {
      $postCompilingEnabled = !!value;
      return this;
    };
    this.determinePreferredLanguage = function (fn) {
      var locale = fn && angular.isFunction(fn) ? fn() : getLocale();
      if (!$availableLanguageKeys.length) {
        $preferredLanguage = locale;
        return this;
      } else {
        $preferredLanguage = negotiateLocale(locale);
      }
    };
    this.registerAvailableLanguageKeys = function (languageKeys, aliases) {
      if (languageKeys) {
        $availableLanguageKeys = languageKeys;
        if (aliases) {
          $languageKeyAliases = aliases;
        }
        return this;
      }
      return $availableLanguageKeys;
    };
    this.$get = [
      '$log',
      '$injector',
      '$rootScope',
      '$q',
      function ($log, $injector, $rootScope, $q) {
        var Storage, defaultInterpolator = $injector.get($interpolationFactory || '$translateDefaultInterpolation'), pendingLoader = false, interpolatorHashMap = {}, langPromises = {}, fallbackIndex, startFallbackIteration;
        var $translate = function (translationId, interpolateParams, interpolationId) {
          var deferred = $q.defer();
          translationId = translationId.trim();
          var promiseToWaitFor = function () {
              var promise = $preferredLanguage ? langPromises[$preferredLanguage] : langPromises[$uses];
              fallbackIndex = 0;
              if ($storageFactory && !promise) {
                var langKey = Storage.get($storageKey);
                promise = langPromises[langKey];
                if ($fallbackLanguage && $fallbackLanguage.length) {
                  var index = indexOf($fallbackLanguage, langKey);
                  fallbackIndex = index > -1 ? index += 1 : 0;
                  $fallbackLanguage.push($preferredLanguage);
                }
              }
              return promise;
            }();
          if (!promiseToWaitFor) {
            determineTranslation(translationId, interpolateParams, interpolationId).then(deferred.resolve, deferred.reject);
          } else {
            promiseToWaitFor.then(function () {
              determineTranslation(translationId, interpolateParams, interpolationId).then(deferred.resolve, deferred.reject);
            }, deferred.reject);
          }
          return deferred.promise;
        };
        var indexOf = function (array, searchElement) {
          for (var i = 0, len = array.length; i < len; i++) {
            if (array[i] === searchElement) {
              return i;
            }
          }
          return -1;
        };
        var applyNotFoundIndicators = function (translationId) {
          if ($notFoundIndicatorLeft) {
            translationId = [
              $notFoundIndicatorLeft,
              translationId
            ].join(' ');
          }
          if ($notFoundIndicatorRight) {
            translationId = [
              translationId,
              $notFoundIndicatorRight
            ].join(' ');
          }
          return translationId;
        };
        var useLanguage = function (key) {
          $uses = key;
          $rootScope.$emit('$translateChangeSuccess');
          if ($storageFactory) {
            Storage.set($translate.storageKey(), $uses);
          }
          defaultInterpolator.setLocale($uses);
          angular.forEach(interpolatorHashMap, function (interpolator, id) {
            interpolatorHashMap[id].setLocale($uses);
          });
          $rootScope.$emit('$translateChangeEnd');
        };
        var loadAsync = function (key) {
          if (!key) {
            throw 'No language key specified for loading.';
          }
          var deferred = $q.defer();
          $rootScope.$emit('$translateLoadingStart');
          pendingLoader = true;
          $injector.get($loaderFactory)(angular.extend($loaderOptions, { key: key })).then(function (data) {
            var translationTable = {};
            $rootScope.$emit('$translateLoadingSuccess');
            if (angular.isArray(data)) {
              angular.forEach(data, function (table) {
                angular.extend(translationTable, flatObject(table));
              });
            } else {
              angular.extend(translationTable, flatObject(data));
            }
            pendingLoader = false;
            deferred.resolve({
              key: key,
              table: translationTable
            });
            $rootScope.$emit('$translateLoadingEnd');
          }, function (key) {
            $rootScope.$emit('$translateLoadingError');
            deferred.reject(key);
            $rootScope.$emit('$translateLoadingEnd');
          });
          return deferred.promise;
        };
        if ($storageFactory) {
          Storage = $injector.get($storageFactory);
          if (!Storage.get || !Storage.set) {
            throw new Error('Couldn\'t use storage \'' + $storageFactory + '\', missing get() or set() method!');
          }
        }
        if (angular.isFunction(defaultInterpolator.useSanitizeValueStrategy)) {
          defaultInterpolator.useSanitizeValueStrategy($interpolationSanitizationStrategy);
        }
        if ($interpolatorFactories.length) {
          angular.forEach($interpolatorFactories, function (interpolatorFactory) {
            var interpolator = $injector.get(interpolatorFactory);
            interpolator.setLocale($preferredLanguage || $uses);
            if (angular.isFunction(interpolator.useSanitizeValueStrategy)) {
              interpolator.useSanitizeValueStrategy($interpolationSanitizationStrategy);
            }
            interpolatorHashMap[interpolator.getInterpolationIdentifier()] = interpolator;
          });
        }
        var getTranslationTable = function (langKey) {
          var deferred = $q.defer();
          if ($translationTable.hasOwnProperty(langKey)) {
            deferred.resolve($translationTable[langKey]);
            return deferred.promise;
          } else {
            langPromises[langKey].then(function (data) {
              translations(data.key, data.table);
              deferred.resolve(data.table);
            }, deferred.reject);
          }
          return deferred.promise;
        };
        var getFallbackTranslation = function (langKey, translationId, interpolateParams, Interpolator) {
          var deferred = $q.defer();
          getTranslationTable(langKey).then(function (translationTable) {
            if (translationTable.hasOwnProperty(translationId)) {
              Interpolator.setLocale(langKey);
              deferred.resolve(Interpolator.interpolate(translationTable[translationId], interpolateParams));
              Interpolator.setLocale($uses);
            } else {
              deferred.reject();
            }
          }, deferred.reject);
          return deferred.promise;
        };
        var getFallbackTranslationInstant = function (langKey, translationId, interpolateParams, Interpolator) {
          var result, translationTable = $translationTable[langKey];
          if (translationTable.hasOwnProperty(translationId)) {
            Interpolator.setLocale(langKey);
            result = Interpolator.interpolate(translationTable[translationId], interpolateParams);
            Interpolator.setLocale($uses);
          }
          return result;
        };
        var resolveForFallbackLanguage = function (fallbackLanguageIndex, translationId, interpolateParams, Interpolator) {
          var deferred = $q.defer();
          if (fallbackLanguageIndex < $fallbackLanguage.length) {
            var langKey = $fallbackLanguage[fallbackLanguageIndex];
            getFallbackTranslation(langKey, translationId, interpolateParams, Interpolator).then(function (translation) {
              deferred.resolve(translation);
            }, function () {
              var nextFallbackLanguagePromise = resolveForFallbackLanguage(fallbackLanguageIndex + 1, translationId, interpolateParams, Interpolator);
              deferred.resolve(nextFallbackLanguagePromise);
            });
          } else {
            deferred.resolve(translationId);
          }
          return deferred.promise;
        };
        var resolveForFallbackLanguageInstant = function (fallbackLanguageIndex, translationId, interpolateParams, Interpolator) {
          var result;
          if (fallbackLanguageIndex < $fallbackLanguage.length) {
            var langKey = $fallbackLanguage[fallbackLanguageIndex];
            result = getFallbackTranslationInstant(langKey, translationId, interpolateParams, Interpolator);
            if (!result) {
              result = resolveForFallbackLanguageInstant(fallbackLanguageIndex + 1, translationId, interpolateParams, Interpolator);
            }
          }
          return result;
        };
        var fallbackTranslation = function (translationId, interpolateParams, Interpolator) {
          return resolveForFallbackLanguage(startFallbackIteration > 0 ? startFallbackIteration : fallbackIndex, translationId, interpolateParams, Interpolator);
        };
        var fallbackTranslationInstant = function (translationId, interpolateParams, Interpolator) {
          return resolveForFallbackLanguageInstant(startFallbackIteration > 0 ? startFallbackIteration : fallbackIndex, translationId, interpolateParams, Interpolator);
        };
        var determineTranslation = function (translationId, interpolateParams, interpolationId) {
          var deferred = $q.defer();
          var table = $uses ? $translationTable[$uses] : $translationTable, Interpolator = interpolationId ? interpolatorHashMap[interpolationId] : defaultInterpolator;
          if (table && table.hasOwnProperty(translationId)) {
            var translation = table[translationId];
            if (translation.substr(0, 2) === '@:') {
              $translate(translation.substr(2), interpolateParams, interpolationId).then(deferred.resolve, deferred.reject);
            } else {
              deferred.resolve(Interpolator.interpolate(translation, interpolateParams));
            }
          } else {
            if ($missingTranslationHandlerFactory && !pendingLoader) {
              $injector.get($missingTranslationHandlerFactory)(translationId, $uses);
            }
            if ($uses && $fallbackLanguage && $fallbackLanguage.length) {
              fallbackTranslation(translationId, interpolateParams, Interpolator).then(function (translation) {
                deferred.resolve(translation);
              }, function (_translationId) {
                deferred.reject(applyNotFoundIndicators(_translationId));
              });
            } else {
              deferred.reject(applyNotFoundIndicators(translationId));
            }
          }
          return deferred.promise;
        };
        var determineTranslationInstant = function (translationId, interpolateParams, interpolationId) {
          var result, table = $uses ? $translationTable[$uses] : $translationTable, Interpolator = interpolationId ? interpolatorHashMap[interpolationId] : defaultInterpolator;
          if (table && table.hasOwnProperty(translationId)) {
            var translation = table[translationId];
            if (translation.substr(0, 2) === '@:') {
              result = determineTranslationInstant(translation.substr(2), interpolateParams, interpolationId);
            } else {
              result = Interpolator.interpolate(translation, interpolateParams);
            }
          } else {
            if ($missingTranslationHandlerFactory && !pendingLoader) {
              $injector.get($missingTranslationHandlerFactory)(translationId, $uses);
            }
            if ($uses && $fallbackLanguage && $fallbackLanguage.length) {
              fallbackIndex = 0;
              result = fallbackTranslationInstant(translationId, interpolateParams, Interpolator);
            } else {
              result = applyNotFoundIndicators(translationId);
            }
          }
          return result;
        };
        $translate.preferredLanguage = function () {
          return $preferredLanguage;
        };
        $translate.cloakClassName = function () {
          return $cloakClassName;
        };
        $translate.fallbackLanguage = function (langKey) {
          if (langKey !== undefined && langKey !== null) {
            fallbackStack(langKey);
            if ($loaderFactory) {
              if ($fallbackLanguage && $fallbackLanguage.length) {
                for (var i = 0, len = $fallbackLanguage.length; i < len; i++) {
                  if (!langPromises[$fallbackLanguage[i]]) {
                    langPromises[$fallbackLanguage[i]] = loadAsync($fallbackLanguage[i]);
                  }
                }
              }
            }
            $translate.use($translate.use());
          }
          if ($fallbackWasString) {
            return $fallbackLanguage[0];
          } else {
            return $fallbackLanguage;
          }
        };
        $translate.useFallbackLanguage = function (langKey) {
          if (langKey !== undefined && langKey !== null) {
            if (!langKey) {
              startFallbackIteration = 0;
            } else {
              var langKeyPosition = indexOf($fallbackLanguage, langKey);
              if (langKeyPosition > -1) {
                startFallbackIteration = langKeyPosition;
              }
            }
          }
        };
        $translate.proposedLanguage = function () {
          return $nextLang;
        };
        $translate.storage = function () {
          return Storage;
        };
        $translate.use = function (key) {
          if (!key) {
            return $uses;
          }
          var deferred = $q.defer();
          $rootScope.$emit('$translateChangeStart');
          if (!$translationTable[key] && $loaderFactory) {
            $nextLang = key;
            langPromises[key] = loadAsync(key).then(function (translation) {
              translations(translation.key, translation.table);
              deferred.resolve(translation.key);
              if ($nextLang === key) {
                useLanguage(translation.key);
                $nextLang = undefined;
              }
            }, function (key) {
              $nextLang = undefined;
              $rootScope.$emit('$translateChangeError');
              deferred.reject(key);
              $rootScope.$emit('$translateChangeEnd');
            });
          } else {
            deferred.resolve(key);
            useLanguage(key);
          }
          return deferred.promise;
        };
        $translate.storageKey = function () {
          return storageKey();
        };
        $translate.isPostCompilingEnabled = function () {
          return $postCompilingEnabled;
        };
        $translate.refresh = function (langKey) {
          if (!$loaderFactory) {
            throw new Error('Couldn\'t refresh translation table, no loader registered!');
          }
          var deferred = $q.defer();
          function resolve() {
            deferred.resolve();
            $rootScope.$emit('$translateRefreshEnd');
          }
          function reject() {
            deferred.reject();
            $rootScope.$emit('$translateRefreshEnd');
          }
          $rootScope.$emit('$translateRefreshStart');
          if (!langKey) {
            var tables = [];
            if ($fallbackLanguage && $fallbackLanguage.length) {
              for (var i = 0, len = $fallbackLanguage.length; i < len; i++) {
                tables.push(loadAsync($fallbackLanguage[i]));
              }
            }
            if ($uses) {
              tables.push(loadAsync($uses));
            }
            $q.all(tables).then(function (tableData) {
              angular.forEach(tableData, function (data) {
                if ($translationTable[data.key]) {
                  delete $translationTable[data.key];
                }
                translations(data.key, data.table);
              });
              if ($uses) {
                useLanguage($uses);
              }
              resolve();
            });
          } else if ($translationTable[langKey]) {
            loadAsync(langKey).then(function (data) {
              translations(data.key, data.table);
              if (langKey === $uses) {
                useLanguage($uses);
              }
              resolve();
            }, reject);
          } else {
            reject();
          }
          return deferred.promise;
        };
        $translate.instant = function (translationId, interpolateParams, interpolationId) {
          if (typeof translationId === 'undefined' || translationId === '') {
            return translationId;
          }
          translationId = translationId.trim();
          var result, possibleLangKeys = [];
          if ($preferredLanguage) {
            possibleLangKeys.push($preferredLanguage);
          }
          if ($uses) {
            possibleLangKeys.push($uses);
          }
          if ($fallbackLanguage && $fallbackLanguage.length) {
            possibleLangKeys = possibleLangKeys.concat($fallbackLanguage);
          }
          for (var i = 0, c = possibleLangKeys.length; i < c; i++) {
            var possibleLangKey = possibleLangKeys[i];
            if ($translationTable[possibleLangKey]) {
              if ($translationTable[possibleLangKey][translationId]) {
                result = determineTranslationInstant(translationId, interpolateParams, interpolationId);
              }
            }
            if (typeof result !== 'undefined') {
              break;
            }
          }
          if (!result) {
            result = translationId;
            if ($missingTranslationHandlerFactory && !pendingLoader) {
              $injector.get($missingTranslationHandlerFactory)(translationId, $uses);
            }
          }
          return result;
        };
        if ($loaderFactory) {
          if (angular.equals($translationTable, {})) {
            $translate.use($translate.use());
          }
          if ($fallbackLanguage && $fallbackLanguage.length) {
            for (var i = 0, len = $fallbackLanguage.length; i < len; i++) {
              langPromises[$fallbackLanguage[i]] = loadAsync($fallbackLanguage[i]);
            }
          }
        }
        return $translate;
      }
    ];
  }
]);
angular.module('pascalprecht.translate').factory('$translateDefaultInterpolation', [
  '$interpolate',
  function ($interpolate) {
    var $translateInterpolator = {}, $locale, $identifier = 'default', $sanitizeValueStrategy = null, sanitizeValueStrategies = {
        escaped: function (params) {
          var result = {};
          for (var key in params) {
            if (params.hasOwnProperty(key)) {
              result[key] = angular.element('<div></div>').text(params[key]).html();
            }
          }
          return result;
        }
      };
    var sanitizeParams = function (params) {
      var result;
      if (angular.isFunction(sanitizeValueStrategies[$sanitizeValueStrategy])) {
        result = sanitizeValueStrategies[$sanitizeValueStrategy](params);
      } else {
        result = params;
      }
      return result;
    };
    $translateInterpolator.setLocale = function (locale) {
      $locale = locale;
    };
    $translateInterpolator.getInterpolationIdentifier = function () {
      return $identifier;
    };
    $translateInterpolator.useSanitizeValueStrategy = function (value) {
      $sanitizeValueStrategy = value;
      return this;
    };
    $translateInterpolator.interpolate = function (string, interpolateParams) {
      if ($sanitizeValueStrategy) {
        interpolateParams = sanitizeParams(interpolateParams);
      }
      return $interpolate(string)(interpolateParams);
    };
    return $translateInterpolator;
  }
]);
angular.module('pascalprecht.translate').constant('$STORAGE_KEY', 'NG_TRANSLATE_LANG_KEY');
angular.module('pascalprecht.translate').directive('translate', [
  '$translate',
  '$q',
  '$interpolate',
  '$compile',
  '$parse',
  '$rootScope',
  function ($translate, $q, $interpolate, $compile, $parse, $rootScope) {
    return {
      restrict: 'AE',
      scope: true,
      compile: function (tElement, tAttr) {
        var translateValuesExist = tAttr.translateValues ? tAttr.translateValues : undefined;
        var translateInterpolation = tAttr.translateInterpolation ? tAttr.translateInterpolation : undefined;
        var translateValueExist = tElement[0].outerHTML.match(/translate-value-+/i);
        return function linkFn(scope, iElement, iAttr) {
          scope.interpolateParams = {};
          iAttr.$observe('translate', function (translationId) {
            if (angular.equals(translationId, '') || !angular.isDefined(translationId)) {
              scope.translationId = $interpolate(iElement.text().replace(/^\s+|\s+$/g, ''))(scope.$parent);
            } else {
              scope.translationId = translationId;
            }
          });
          if (translateValuesExist) {
            iAttr.$observe('translateValues', function (interpolateParams) {
              if (interpolateParams) {
                scope.$parent.$watch(function () {
                  angular.extend(scope.interpolateParams, $parse(interpolateParams)(scope.$parent));
                });
              }
            });
          }
          if (translateValueExist) {
            var fn = function (attrName) {
              iAttr.$observe(attrName, function (value) {
                scope.interpolateParams[angular.lowercase(attrName.substr(14))] = value;
              });
            };
            for (var attr in iAttr) {
              if (iAttr.hasOwnProperty(attr) && attr.substr(0, 14) === 'translateValue' && attr !== 'translateValues') {
                fn(attr);
              }
            }
          }
          var applyElementContent = function (value, scope) {
            iElement.html(value);
            var globallyEnabled = $translate.isPostCompilingEnabled();
            var locallyDefined = typeof tAttr.translateCompile !== 'undefined';
            var locallyEnabled = locallyDefined && tAttr.translateCompile !== 'false';
            if (globallyEnabled && !locallyDefined || locallyEnabled) {
              $compile(iElement.contents())(scope);
            }
          };
          var updateTranslationFn = function () {
              if (!translateValuesExist && !translateValueExist) {
                return function () {
                  var unwatch = scope.$watch('translationId', function (value) {
                      if (scope.translationId && value) {
                        $translate(value, {}, translateInterpolation).then(function (translation) {
                          applyElementContent(translation, scope);
                          unwatch();
                        }, function (translationId) {
                          applyElementContent(translationId, scope);
                          unwatch();
                        });
                      }
                    }, true);
                };
              } else {
                return function () {
                  scope.$watch('interpolateParams', function (value) {
                    if (scope.translationId && value) {
                      $translate(scope.translationId, value, translateInterpolation).then(function (translation) {
                        applyElementContent(translation, scope);
                      }, function (translationId) {
                        applyElementContent(translationId, scope);
                      });
                    }
                  }, true);
                };
              }
            }();
          var unbind = $rootScope.$on('$translateChangeSuccess', updateTranslationFn);
          updateTranslationFn();
          scope.$on('$destroy', unbind);
        };
      }
    };
  }
]);
angular.module('pascalprecht.translate').directive('translateCloak', [
  '$rootScope',
  '$translate',
  function ($rootScope, $translate) {
    return {
      compile: function (tElement) {
        $rootScope.$on('$translateLoadingSuccess', function () {
          tElement.removeClass($translate.cloakClassName());
        });
        tElement.addClass($translate.cloakClassName());
      }
    };
  }
]);
angular.module('pascalprecht.translate').filter('translate', [
  '$parse',
  '$translate',
  function ($parse, $translate) {
    return function (translationId, interpolateParams, interpolation) {
      if (!angular.isObject(interpolateParams)) {
        interpolateParams = $parse(interpolateParams)();
      }
      return $translate.instant(translationId, interpolateParams, interpolation);
    };
  }
]);
},{}],9:[function(require,module,exports){
/*! 
 * numeral.js language configuration
 * language : German (de) – generally useful in Germany, Austria, Luxembourg, Belgium
 * author : Marco Krage : https://github.com/sinky
 */
(function () {
    var language = {
        delimiters: {
            thousands: ' ',
            decimal: ','
        },
        abbreviations: {
            thousand: 'k',
            million: 'm',
            billion: 'b',
            trillion: 't'
        },
        ordinal: function (number) {
            return '.';
        },
        currency: {
            symbol: '€'
        }
    };

    // Node
    if (typeof module !== 'undefined' && module.exports) {
        module.exports = language;
    }
    // Browser
    if (typeof window !== 'undefined' && this.numeral && this.numeral.language) {
        this.numeral.language('de', language);
        this.numeral.language('de-de', language);
    }
}());
},{}],10:[function(require,module,exports){
/*
 * promise-tracker - v2.0.1 - 2014-04-11
 * http://github.com/ajoslin/angular-promise-tracker
 * Created by Andy Joslin; Licensed under Public Domain
 */

(function() {

angular.module('ajoslin.promise-tracker')
.config(['$httpProvider', function($httpProvider) {
  $httpProvider.interceptors.push(['$q', 'promiseTracker', function($q, promiseTracker) {
    return {
      request: function(config) {
        if (config.tracker) {
          if (!angular.isArray(config.tracker)) {
            config.tracker = [config.tracker];
          }
          config.$promiseTrackerDeferred = config.$promiseTrackerDeferred || [];

          angular.forEach(config.tracker, function(tracker) {
            var deferred = tracker.createPromise();
            config.$promiseTrackerDeferred.push(deferred);
          });
        }
        return $q.when(config);
      },
      response: function(response) {
        if (response.config && response.config.$promiseTrackerDeferred) {
          angular.forEach(response.config.$promiseTrackerDeferred, function(deferred) {
            deferred.resolve(response);
          });
        }
        return $q.when(response);
      },
      responseError: function(response) {
        if (response.config && response.config.$promiseTrackerDeferred) {
          angular.forEach(response.config.$promiseTrackerDeferred, function(deferred) {
            deferred.reject(response);
          });
        }
        return $q.reject(response);
      }
    };
  }]);
}]);

}());
},{}],11:[function(require,module,exports){
/*
 * promise-tracker - v2.0.1 - 2014-04-11
 * http://github.com/ajoslin/angular-promise-tracker
 * Created by Andy Joslin; Licensed under Public Domain
 */

(function() {

angular.module('ajoslin.promise-tracker', [])

.provider('promiseTracker', function() {
  var trackers = {};

  this.$get = ['$q', '$timeout', function($q, $timeout) {
    function cancelTimeout(promise) {
      if (promise) {
        $timeout.cancel(promise);
      }
    }

    return function PromiseTracker(options) {
      //do new if user doesn't
      if (!(this instanceof PromiseTracker)) {
        return new PromiseTracker(options);
      }

      options = options || {};

      //Array of promises being tracked
      var tracked = [];
      var self = this;

      //Allow an optional "minimum duration" that the tracker has to stay active for.
      var minDuration = options.minDuration;
      //Allow a delay that will stop the tracker from activating until that time is reached
      var activationDelay = options.activationDelay;

      var minDurationPromise;
      var activationDelayPromise;

      self.active = function() {
        //Even if we have a promise in our tracker, we aren't active until delay is elapsed
        if (activationDelayPromise) {
          return false;
        }
        return tracked.length > 0;
      };

      self.tracking = function() {
        //Even if we aren't active, we could still have a promise in our tracker
        return tracked.length > 0;
      };

      self.destroy = self.cancel = function() {
        minDurationPromise = cancelTimeout(minDurationPromise);
        activationDelayPromise = cancelTimeout(activationDelayPromise);
        for (var i=tracked.length-1; i>=0; i--) {
          tracked[i].resolve();
        }
        tracked.length = 0;
      };

      //Create a promise that will make our tracker active until it is resolved.
      // @return deferred - our deferred object that is being tracked
      self.createPromise = function() {
        var deferred = $q.defer();
        tracked.push(deferred);

        //If the tracker was just inactive and this the first in the list of
        //promises, we reset our delay and minDuration
        //again.
        if (tracked.length === 1) {
          if (activationDelay) {
            activationDelayPromise = $timeout(function() {
              activationDelayPromise = cancelTimeout(activationDelayPromise);
              startMinDuration();
            }, activationDelay);
          } else {
            startMinDuration();
          }
        }

        deferred.promise.then(onDone(false), onDone(true));

        return deferred;

        function startMinDuration() {
          if (minDuration) {
            minDurationPromise = $timeout(angular.noop, minDuration);
          }
        }

        //Create a callback for when this promise is done. It will remove our
        //tracked promise from the array if once minDuration is complete
        function onDone(isError) {
          return function(value) {
            (minDurationPromise || $q.when()).then(function() {
              var index = tracked.indexOf(deferred);
              tracked.splice(index, 1);

              //If this is the last promise, cleanup the timeouts
              //for activationDelay
              if (tracked.length === 0) {
                activationDelayPromise = cancelTimeout(activationDelayPromise);
              }
            });
          };
        }
      };

      self.addPromise = function(promise) {
        var then = promise && (promise.then || promise.$then ||
                               (promise.$promise && promise.$promise.then));
        if (!then) {
          throw new Error("promiseTracker#addPromise expects a promise object!");
        }
        var deferred = self.createPromise();

        //When given promise is done, resolve our created promise
        //Allow $then for angular-resource objects
        then(function success(value) {
          deferred.resolve(value);
          return value;
        }, function error(value) {
          deferred.reject(value);
          return $q.reject(value);
        });

        return deferred;
      };
    };
  }];
});

}());

},{}],12:[function(require,module,exports){
/*
 * angular-ui-bootstrap
 * http://angular-ui.github.io/bootstrap/

 * Version: 0.11.2 - 2014-09-26
 * License: MIT
 */
angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tpls",["template/accordion/accordion-group.html","template/accordion/accordion.html","template/alert/alert.html","template/carousel/carousel.html","template/carousel/slide.html","template/datepicker/datepicker.html","template/datepicker/day.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html","template/modal/backdrop.html","template/modal/window.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/popover/popover.html","template/progressbar/bar.html","template/progressbar/progress.html","template/progressbar/progressbar.html","template/rating/rating.html","template/tabs/tab.html","template/tabs/tabset.html","template/timepicker/timepicker.html","template/typeahead/typeahead-match.html","template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(a,b,c){function d(a){for(var b in a)if(void 0!==f.style[b])return a[b]}var e=function(d,f,g){g=g||{};var h=a.defer(),i=e[g.animation?"animationEndEventName":"transitionEndEventName"],j=function(){c.$apply(function(){d.unbind(i,j),h.resolve(d)})};return i&&d.bind(i,j),b(function(){angular.isString(f)?d.addClass(f):angular.isFunction(f)?f(d):angular.isObject(f)&&d.css(f),i||h.resolve(d)}),h.promise.cancel=function(){i&&d.unbind(i,j),h.reject("Transition cancelled")},h.promise},f=document.createElement("trans"),g={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},h={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return e.transitionEndEventName=d(g),e.animationEndEventName=d(h),e}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function(a){return{link:function(b,c,d){function e(b){function d(){j===e&&(j=void 0)}var e=a(c,b);return j&&j.cancel(),j=e,e.then(d,d),e}function f(){k?(k=!1,g()):(c.removeClass("collapse").addClass("collapsing"),e({height:c[0].scrollHeight+"px"}).then(g))}function g(){c.removeClass("collapsing"),c.addClass("collapse in"),c.css({height:"auto"})}function h(){if(k)k=!1,i(),c.css({height:0});else{c.css({height:c[0].scrollHeight+"px"});{c[0].offsetWidth}c.removeClass("collapse in").addClass("collapsing"),e({height:0}).then(i)}}function i(){c.removeClass("collapsing"),c.addClass("collapse")}var j,k=!0;b.$watch(d.collapse,function(a){a?h():f()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function(a,b,c){this.groups=[],this.closeOthers=function(d){var e=angular.isDefined(b.closeOthers)?a.$eval(b.closeOthers):c.closeOthers;e&&angular.forEach(this.groups,function(a){a!==d&&(a.isOpen=!1)})},this.addGroup=function(a){var b=this;this.groups.push(a),a.$on("$destroy",function(){b.removeGroup(a)})},this.removeGroup=function(a){var b=this.groups.indexOf(a);-1!==b&&this.groups.splice(b,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(a){this.heading=a}},link:function(a,b,c,d){d.addGroup(a),a.$watch("isOpen",function(b){b&&d.closeOthers(a)}),a.toggleOpen=function(){a.isDisabled||(a.isOpen=!a.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(a,b,c,d,e){d.setHeading(e(a,function(){}))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(a,b,c,d){a.$watch(function(){return d[c.accordionTransclude]},function(a){a&&(b.html(""),b.append(a))})}}}),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function(a,b){a.closeable="close"in b}]).directive("alert",function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(a,b,c){b.addClass("ng-binding").data("$binding",c.bindHtmlUnsafe),a.$watch(c.bindHtmlUnsafe,function(a){b.html(a||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(a){this.activeClass=a.activeClass||"active",this.toggleEvent=a.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(a,b,c,d){var e=d[0],f=d[1];f.$render=function(){b.toggleClass(e.activeClass,angular.equals(f.$modelValue,a.$eval(c.btnRadio)))},b.bind(e.toggleEvent,function(){var d=b.hasClass(e.activeClass);(!d||angular.isDefined(c.uncheckable))&&a.$apply(function(){f.$setViewValue(d?null:a.$eval(c.btnRadio)),f.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(a,b,c,d){function e(){return g(c.btnCheckboxTrue,!0)}function f(){return g(c.btnCheckboxFalse,!1)}function g(b,c){var d=a.$eval(b);return angular.isDefined(d)?d:c}var h=d[0],i=d[1];i.$render=function(){b.toggleClass(h.activeClass,angular.equals(i.$modelValue,e()))},b.bind(h.toggleEvent,function(){a.$apply(function(){i.$setViewValue(b.hasClass(h.activeClass)?f():e()),i.$render()})})}}}),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition",function(a,b,c){function d(){e();var c=+a.interval;!isNaN(c)&&c>=0&&(g=b(f,c))}function e(){g&&(b.cancel(g),g=null)}function f(){h?(a.next(),d()):a.pause()}var g,h,i=this,j=i.slides=a.slides=[],k=-1;i.currentSlide=null;var l=!1;i.select=a.select=function(e,f){function g(){if(!l){if(i.currentSlide&&angular.isString(f)&&!a.noTransition&&e.$element){e.$element.addClass(f);{e.$element[0].offsetWidth}angular.forEach(j,function(a){angular.extend(a,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(e,{direction:f,active:!0,entering:!0}),angular.extend(i.currentSlide||{},{direction:f,leaving:!0}),a.$currentTransition=c(e.$element,{}),function(b,c){a.$currentTransition.then(function(){h(b,c)},function(){h(b,c)})}(e,i.currentSlide)}else h(e,i.currentSlide);i.currentSlide=e,k=m,d()}}function h(b,c){angular.extend(b,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(c||{},{direction:"",active:!1,leaving:!1,entering:!1}),a.$currentTransition=null}var m=j.indexOf(e);void 0===f&&(f=m>k?"next":"prev"),e&&e!==i.currentSlide&&(a.$currentTransition?(a.$currentTransition.cancel(),b(g)):g())},a.$on("$destroy",function(){l=!0}),i.indexOfSlide=function(a){return j.indexOf(a)},a.next=function(){var b=(k+1)%j.length;return a.$currentTransition?void 0:i.select(j[b],"next")},a.prev=function(){var b=0>k-1?j.length-1:k-1;return a.$currentTransition?void 0:i.select(j[b],"prev")},a.isActive=function(a){return i.currentSlide===a},a.$watch("interval",d),a.$on("$destroy",e),a.play=function(){h||(h=!0,d())},a.pause=function(){a.noPause||(h=!1,e())},i.addSlide=function(b,c){b.$element=c,j.push(b),1===j.length||b.active?(i.select(j[j.length-1]),1==j.length&&a.play()):b.active=!1},i.removeSlide=function(a){var b=j.indexOf(a);j.splice(b,1),j.length>0&&a.active?i.select(b>=j.length?j[b-1]:j[b]):k>b&&k--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?"},link:function(a,b,c,d){d.addSlide(a,b),a.$on("$destroy",function(){d.removeSlide(a)}),a.$watch("active",function(b){b&&d.select(a)})}}}),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function(a,b){function c(a){var c=[],d=a.split("");return angular.forEach(e,function(b,e){var f=a.indexOf(e);if(f>-1){a=a.split(""),d[f]="("+b.regex+")",a[f]="$";for(var g=f+1,h=f+e.length;h>g;g++)d[g]="",a[g]="$";a=a.join(""),c.push({index:f,apply:b.apply})}}),{regex:new RegExp("^"+d.join("")+"$"),map:b(c,"index")}}function d(a,b,c){return 1===b&&c>28?29===c&&(a%4===0&&a%100!==0||a%400===0):3===b||5===b||8===b||10===b?31>c:!0}this.parsers={};var e={yyyy:{regex:"\\d{4}",apply:function(a){this.year=+a}},yy:{regex:"\\d{2}",apply:function(a){this.year=+a+2e3}},y:{regex:"\\d{1,4}",apply:function(a){this.year=+a}},MMMM:{regex:a.DATETIME_FORMATS.MONTH.join("|"),apply:function(b){this.month=a.DATETIME_FORMATS.MONTH.indexOf(b)}},MMM:{regex:a.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(b){this.month=a.DATETIME_FORMATS.SHORTMONTH.indexOf(b)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(a){this.month=a-1}},M:{regex:"[1-9]|1[0-2]",apply:function(a){this.month=a-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a}},EEEE:{regex:a.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:a.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(b,e){if(!angular.isString(b)||!e)return b;e=a.DATETIME_FORMATS[e]||e,this.parsers[e]||(this.parsers[e]=c(e));var f=this.parsers[e],g=f.regex,h=f.map,i=b.match(g);if(i&&i.length){for(var j,k={year:1900,month:0,date:1,hours:0},l=1,m=i.length;m>l;l++){var n=h[l-1];n.apply&&n.apply.call(k,i[l])}return d(k.year,k.month,k.date)&&(j=new Date(k.year,k.month,k.date,k.hours)),j}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function(a,b){function c(a,c){return a.currentStyle?a.currentStyle[c]:b.getComputedStyle?b.getComputedStyle(a)[c]:a.style[c]}function d(a){return"static"===(c(a,"position")||"static")}var e=function(b){for(var c=a[0],e=b.offsetParent||c;e&&e!==c&&d(e);)e=e.offsetParent;return e||c};return{position:function(b){var c=this.offset(b),d={top:0,left:0},f=e(b[0]);f!=a[0]&&(d=this.offset(angular.element(f)),d.top+=f.clientTop-f.scrollTop,d.left+=f.clientLeft-f.scrollLeft);var g=b[0].getBoundingClientRect();return{width:g.width||b.prop("offsetWidth"),height:g.height||b.prop("offsetHeight"),top:c.top-d.top,left:c.left-d.left}},offset:function(c){var d=c[0].getBoundingClientRect();return{width:d.width||c.prop("offsetWidth"),height:d.height||c.prop("offsetHeight"),top:d.top+(b.pageYOffset||a[0].documentElement.scrollTop),left:d.left+(b.pageXOffset||a[0].documentElement.scrollLeft)}},positionElements:function(a,b,c,d){var e,f,g,h,i=c.split("-"),j=i[0],k=i[1]||"center";e=d?this.offset(a):this.position(a),f=b.prop("offsetWidth"),g=b.prop("offsetHeight");var l={center:function(){return e.left+e.width/2-f/2},left:function(){return e.left},right:function(){return e.left+e.width}},m={center:function(){return e.top+e.height/2-g/2},top:function(){return e.top},bottom:function(){return e.top+e.height}};switch(j){case"right":h={top:m[k](),left:l[j]()};break;case"left":h={top:m[k](),left:e.left-f};break;case"bottom":h={top:m[j](),left:l[k]()};break;default:h={top:e.top-g,left:l[k]()}}return h}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function(a,b,c,d,e,f,g,h){var i=this,j={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange"],function(c,e){i[c]=angular.isDefined(b[c])?8>e?d(b[c])(a.$parent):a.$parent.$eval(b[c]):h[c]}),angular.forEach(["minDate","maxDate"],function(d){b[d]?a.$parent.$watch(c(b[d]),function(a){i[d]=a?new Date(a):null,i.refreshView()}):i[d]=h[d]?new Date(h[d]):null}),a.datepickerMode=a.datepickerMode||h.datepickerMode,a.uniqueId="datepicker-"+a.$id+"-"+Math.floor(1e4*Math.random()),this.activeDate=angular.isDefined(b.initDate)?a.$parent.$eval(b.initDate):new Date,a.isActive=function(b){return 0===i.compare(b.date,i.activeDate)?(a.activeDateId=b.uid,!0):!1},this.init=function(a){j=a,j.$render=function(){i.render()}},this.render=function(){if(j.$modelValue){var a=new Date(j.$modelValue),b=!isNaN(a);b?this.activeDate=a:f.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),j.$setValidity("date",b)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var a=j.$modelValue?new Date(j.$modelValue):null;j.$setValidity("date-disabled",!a||this.element&&!this.isDisabled(a))}},this.createDateObject=function(a,b){var c=j.$modelValue?new Date(j.$modelValue):null;return{date:a,label:g(a,b),selected:c&&0===this.compare(a,c),disabled:this.isDisabled(a),current:0===this.compare(a,new Date)}},this.isDisabled=function(c){return this.minDate&&this.compare(c,this.minDate)<0||this.maxDate&&this.compare(c,this.maxDate)>0||b.dateDisabled&&a.dateDisabled({date:c,mode:a.datepickerMode})},this.split=function(a,b){for(var c=[];a.length>0;)c.push(a.splice(0,b));return c},a.select=function(b){if(a.datepickerMode===i.minMode){var c=j.$modelValue?new Date(j.$modelValue):new Date(0,0,0,0,0,0,0);c.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),j.$setViewValue(c),j.$render()}else i.activeDate=b,a.datepickerMode=i.modes[i.modes.indexOf(a.datepickerMode)-1]},a.move=function(a){var b=i.activeDate.getFullYear()+a*(i.step.years||0),c=i.activeDate.getMonth()+a*(i.step.months||0);i.activeDate.setFullYear(b,c,1),i.refreshView()},a.toggleMode=function(b){b=b||1,a.datepickerMode===i.maxMode&&1===b||a.datepickerMode===i.minMode&&-1===b||(a.datepickerMode=i.modes[i.modes.indexOf(a.datepickerMode)+b])},a.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var k=function(){e(function(){i.element[0].focus()},0,!1)};a.$on("datepicker.focus",k),a.keydown=function(b){var c=a.keys[b.which];if(c&&!b.shiftKey&&!b.altKey)if(b.preventDefault(),b.stopPropagation(),"enter"===c||"space"===c){if(i.isDisabled(i.activeDate))return;a.select(i.activeDate),k()}else!b.ctrlKey||"up"!==c&&"down"!==c?(i.handleKeyDown(c,b),i.refreshView()):(a.toggleMode("up"===c?1:-1),k())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f)}}}).directive("daypicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(b,c,d,e){function f(a,b){return 1!==b||a%4!==0||a%100===0&&a%400!==0?i[b]:29}function g(a,b){var c=new Array(b),d=new Date(a),e=0;for(d.setHours(12);b>e;)c[e++]=new Date(d),d.setDate(d.getDate()+1);return c}function h(a){var b=new Date(a);b.setDate(b.getDate()+4-(b.getDay()||7));var c=b.getTime();return b.setMonth(0),b.setDate(1),Math.floor(Math.round((c-b)/864e5)/7)+1}b.showWeeks=e.showWeeks,e.step={months:1},e.element=c;var i=[31,28,31,30,31,30,31,31,30,31,30,31];e._refreshView=function(){var c=e.activeDate.getFullYear(),d=e.activeDate.getMonth(),f=new Date(c,d,1),i=e.startingDay-f.getDay(),j=i>0?7-i:-i,k=new Date(f);j>0&&k.setDate(-j+1);for(var l=g(k,42),m=0;42>m;m++)l[m]=angular.extend(e.createDateObject(l[m],e.formatDay),{secondary:l[m].getMonth()!==d,uid:b.uniqueId+"-"+m});b.labels=new Array(7);for(var n=0;7>n;n++)b.labels[n]={abbr:a(l[n].date,e.formatDayHeader),full:a(l[n].date,"EEEE")};if(b.title=a(e.activeDate,e.formatDayTitle),b.rows=e.split(l,7),b.showWeeks){b.weekNumbers=[];for(var o=h(b.rows[0][0].date),p=b.rows.length;b.weekNumbers.push(o++)<p;);}},e.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth(),a.getDate())-new Date(b.getFullYear(),b.getMonth(),b.getDate())},e.handleKeyDown=function(a){var b=e.activeDate.getDate();if("left"===a)b-=1;else if("up"===a)b-=7;else if("right"===a)b+=1;else if("down"===a)b+=7;else if("pageup"===a||"pagedown"===a){var c=e.activeDate.getMonth()+("pageup"===a?-1:1);e.activeDate.setMonth(c,1),b=Math.min(f(e.activeDate.getFullYear(),e.activeDate.getMonth()),b)}else"home"===a?b=1:"end"===a&&(b=f(e.activeDate.getFullYear(),e.activeDate.getMonth()));e.activeDate.setDate(b)},e.refreshView()}}}]).directive("monthpicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(b,c,d,e){e.step={years:1},e.element=c,e._refreshView=function(){for(var c=new Array(12),d=e.activeDate.getFullYear(),f=0;12>f;f++)c[f]=angular.extend(e.createDateObject(new Date(d,f,1),e.formatMonth),{uid:b.uniqueId+"-"+f});b.title=a(e.activeDate,e.formatMonthTitle),b.rows=e.split(c,3)},e.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth())-new Date(b.getFullYear(),b.getMonth())},e.handleKeyDown=function(a){var b=e.activeDate.getMonth();if("left"===a)b-=1;else if("up"===a)b-=3;else if("right"===a)b+=1;else if("down"===a)b+=3;else if("pageup"===a||"pagedown"===a){var c=e.activeDate.getFullYear()+("pageup"===a?-1:1);e.activeDate.setFullYear(c)}else"home"===a?b=0:"end"===a&&(b=11);e.activeDate.setMonth(b)},e.refreshView()}}}]).directive("yearpicker",["dateFilter",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(a,b,c,d){function e(a){return parseInt((a-1)/f,10)*f+1}var f=d.yearRange;d.step={years:f},d.element=b,d._refreshView=function(){for(var b=new Array(f),c=0,g=e(d.activeDate.getFullYear());f>c;c++)b[c]=angular.extend(d.createDateObject(new Date(g+c,0,1),d.formatYear),{uid:a.uniqueId+"-"+c});a.title=[b[0].label,b[f-1].label].join(" - "),a.rows=d.split(b,5)},d.compare=function(a,b){return a.getFullYear()-b.getFullYear()},d.handleKeyDown=function(a){var b=d.activeDate.getFullYear();"left"===a?b-=1:"up"===a?b-=5:"right"===a?b+=1:"down"===a?b+=5:"pageup"===a||"pagedown"===a?b+=("pageup"===a?-1:1)*d.step.years:"home"===a?b=e(d.activeDate.getFullYear()):"end"===a&&(b=e(d.activeDate.getFullYear())+f-1),d.activeDate.setFullYear(b)},d.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function(a,b,c,d,e,f,g){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(h,i,j,k){function l(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function m(a){if(a){if(angular.isDate(a)&&!isNaN(a))return k.$setValidity("date",!0),a;if(angular.isString(a)){var b=f.parse(a,n)||new Date(a);return isNaN(b)?void k.$setValidity("date",!1):(k.$setValidity("date",!0),b)}return void k.$setValidity("date",!1)}return k.$setValidity("date",!0),null}var n,o=angular.isDefined(j.closeOnDateSelection)?h.$parent.$eval(j.closeOnDateSelection):g.closeOnDateSelection,p=angular.isDefined(j.datepickerAppendToBody)?h.$parent.$eval(j.datepickerAppendToBody):g.appendToBody;h.showButtonBar=angular.isDefined(j.showButtonBar)?h.$parent.$eval(j.showButtonBar):g.showButtonBar,h.getText=function(a){return h[a+"Text"]||g[a+"Text"]},j.$observe("datepickerPopup",function(a){n=a||g.datepickerPopup,k.$render()});var q=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");q.attr({"ng-model":"date","ng-change":"dateSelection()"});var r=angular.element(q.children()[0]);j.datepickerOptions&&angular.forEach(h.$parent.$eval(j.datepickerOptions),function(a,b){r.attr(l(b),a)}),h.watchData={},angular.forEach(["minDate","maxDate","datepickerMode"],function(a){if(j[a]){var c=b(j[a]);if(h.$parent.$watch(c,function(b){h.watchData[a]=b}),r.attr(l(a),"watchData."+a),"datepickerMode"===a){var d=c.assign;h.$watch("watchData."+a,function(a,b){a!==b&&d(h.$parent,a)})}}}),j.dateDisabled&&r.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),k.$parsers.unshift(m),h.dateSelection=function(a){angular.isDefined(a)&&(h.date=a),k.$setViewValue(h.date),k.$render(),o&&(h.isOpen=!1,i[0].focus())},i.bind("input change keyup",function(){h.$apply(function(){h.date=k.$modelValue})}),k.$render=function(){var a=k.$viewValue?e(k.$viewValue,n):"";i.val(a),h.date=m(k.$modelValue)};var s=function(a){h.isOpen&&a.target!==i[0]&&h.$apply(function(){h.isOpen=!1})},t=function(a){h.keydown(a)};i.bind("keydown",t),h.keydown=function(a){27===a.which?(a.preventDefault(),a.stopPropagation(),h.close()):40!==a.which||h.isOpen||(h.isOpen=!0)},h.$watch("isOpen",function(a){a?(h.$broadcast("datepicker.focus"),h.position=p?d.offset(i):d.position(i),h.position.top=h.position.top+i.prop("offsetHeight"),c.bind("click",s)):c.unbind("click",s)}),h.select=function(a){if("today"===a){var b=new Date;angular.isDate(k.$modelValue)?(a=new Date(k.$modelValue),a.setFullYear(b.getFullYear(),b.getMonth(),b.getDate())):a=new Date(b.setHours(0,0,0,0))}h.dateSelection(a)},h.close=function(){h.isOpen=!1,i[0].focus()};var u=a(q)(h);q.remove(),p?c.find("body").append(u):i.after(u),h.$on("$destroy",function(){u.remove(),i.unbind("keydown",t),c.unbind("click",s)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(a,b){b.bind("click",function(a){a.preventDefault(),a.stopPropagation()})}}}),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function(a){var b=null;this.open=function(e){b||(a.bind("click",c),a.bind("keydown",d)),b&&b!==e&&(b.isOpen=!1),b=e},this.close=function(e){b===e&&(b=null,a.unbind("click",c),a.unbind("keydown",d))};var c=function(a){var c=b.getToggleElement();a&&c&&c[0].contains(a.target)||b.$apply(function(){b.isOpen=!1})},d=function(a){27===a.which&&(b.focusToggleElement(),c())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function(a,b,c,d,e,f){var g,h=this,i=a.$new(),j=d.openClass,k=angular.noop,l=b.onToggle?c(b.onToggle):angular.noop;this.init=function(d){h.$element=d,b.isOpen&&(g=c(b.isOpen),k=g.assign,a.$watch(g,function(a){i.isOpen=!!a}))},this.toggle=function(a){return i.isOpen=arguments.length?!!a:!i.isOpen},this.isOpen=function(){return i.isOpen},i.getToggleElement=function(){return h.toggleElement},i.focusToggleElement=function(){h.toggleElement&&h.toggleElement[0].focus()},i.$watch("isOpen",function(b,c){f[b?"addClass":"removeClass"](h.$element,j),b?(i.focusToggleElement(),e.open(i)):e.close(i),k(a,b),angular.isDefined(b)&&b!==c&&l(a,{open:!!b})}),a.$on("$locationChangeSuccess",function(){i.isOpen=!1}),a.$on("$destroy",function(){i.$destroy()})}]).directive("dropdown",function(){return{restrict:"CA",controller:"DropdownController",link:function(a,b,c,d){d.init(b)}}}).directive("dropdownToggle",function(){return{restrict:"CA",require:"?^dropdown",link:function(a,b,c,d){if(d){d.toggleElement=b;var e=function(e){e.preventDefault(),b.hasClass("disabled")||c.disabled||a.$apply(function(){d.toggle()})};b.bind("click",e),b.attr({"aria-haspopup":!0,"aria-expanded":!1}),a.$watch(d.isOpen,function(a){b.attr("aria-expanded",!!a)}),a.$on("$destroy",function(){b.unbind("click",e)})}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var a=[];return{add:function(b,c){a.push({key:b,value:c})},get:function(b){for(var c=0;c<a.length;c++)if(b==a[c].key)return a[c]},keys:function(){for(var b=[],c=0;c<a.length;c++)b.push(a[c].key);return b},top:function(){return a[a.length-1]},remove:function(b){for(var c=-1,d=0;d<a.length;d++)if(b==a[d].key){c=d;break}return a.splice(c,1)[0]},removeTop:function(){return a.splice(a.length-1,1)[0]},length:function(){return a.length}}}}}).directive("modalBackdrop",["$timeout",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(b,c,d){b.backdropClass=d.backdropClass||"",b.animate=!1,a(function(){b.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function(a,b){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(a,b){return b.templateUrl||"template/modal/window.html"},link:function(c,d,e){d.addClass(e.windowClass||""),c.size=e.size,b(function(){c.animate=!0,d[0].querySelectorAll("[autofocus]").length||d[0].focus()}),c.close=function(b){var c=a.getTop();c&&c.value.backdrop&&"static"!=c.value.backdrop&&b.target===b.currentTarget&&(b.preventDefault(),b.stopPropagation(),a.dismiss(c.key,"backdrop click"))}}}}]).directive("modalTransclude",function(){return{link:function(a,b,c,d,e){e(a.$parent,function(a){b.empty(),b.append(a)})}}}).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function(a,b,c,d,e,f){function g(){for(var a=-1,b=n.keys(),c=0;c<b.length;c++)n.get(b[c]).value.backdrop&&(a=c);return a}function h(a){var b=c.find("body").eq(0),d=n.get(a).value;n.remove(a),j(d.modalDomEl,d.modalScope,300,function(){d.modalScope.$destroy(),b.toggleClass(m,n.length()>0),i()})}function i(){if(k&&-1==g()){var a=l;j(k,l,150,function(){a.$destroy(),a=null}),k=void 0,l=void 0}}function j(c,d,e,f){function g(){g.done||(g.done=!0,c.remove(),f&&f())}d.animate=!1;var h=a.transitionEndEventName;if(h){var i=b(g,e);c.bind(h,function(){b.cancel(i),g(),d.$apply()})}else b(g)}var k,l,m="modal-open",n=f.createNew(),o={};return e.$watch(g,function(a){l&&(l.index=a)}),c.bind("keydown",function(a){var b;27===a.which&&(b=n.top(),b&&b.value.keyboard&&(a.preventDefault(),e.$apply(function(){o.dismiss(b.key,"escape key press")})))}),o.open=function(a,b){n.add(a,{deferred:b.deferred,modalScope:b.scope,backdrop:b.backdrop,keyboard:b.keyboard});var f=c.find("body").eq(0),h=g();if(h>=0&&!k){l=e.$new(!0),l.index=h;var i=angular.element("<div modal-backdrop></div>");i.attr("backdrop-class",b.backdropClass),k=d(i)(l),f.append(k)}var j=angular.element("<div modal-window></div>");j.attr({"template-url":b.windowTemplateUrl,"window-class":b.windowClass,size:b.size,index:n.length()-1,animate:"animate"}).html(b.content);var o=d(j)(b.scope);n.top().value.modalDomEl=o,f.append(o),f.addClass(m)},o.close=function(a,b){var c=n.get(a);c&&(c.value.deferred.resolve(b),h(a))},o.dismiss=function(a,b){var c=n.get(a);c&&(c.value.deferred.reject(b),h(a))},o.dismissAll=function(a){for(var b=this.getTop();b;)this.dismiss(b.key,a),b=this.getTop()},o.getTop=function(){return n.top()},o}]).provider("$modal",function(){var a={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(b,c,d,e,f,g,h){function i(a){return a.template?d.when(a.template):e.get(angular.isFunction(a.templateUrl)?a.templateUrl():a.templateUrl,{cache:f}).then(function(a){return a.data})}function j(a){var c=[];return angular.forEach(a,function(a){(angular.isFunction(a)||angular.isArray(a))&&c.push(d.when(b.invoke(a)))}),c}var k={};return k.open=function(b){var e=d.defer(),f=d.defer(),k={result:e.promise,opened:f.promise,close:function(a){h.close(k,a)},dismiss:function(a){h.dismiss(k,a)}};if(b=angular.extend({},a.options,b),b.resolve=b.resolve||{},!b.template&&!b.templateUrl)throw new Error("One of template or templateUrl options is required.");var l=d.all([i(b)].concat(j(b.resolve)));return l.then(function(a){var d=(b.scope||c).$new();d.$close=k.close,d.$dismiss=k.dismiss;var f,i={},j=1;b.controller&&(i.$scope=d,i.$modalInstance=k,angular.forEach(b.resolve,function(b,c){i[c]=a[j++]}),f=g(b.controller,i),b.controllerAs&&(d[b.controllerAs]=f)),h.open(k,{scope:d,deferred:e,content:a[0],backdrop:b.backdrop,keyboard:b.keyboard,backdropClass:b.backdropClass,windowClass:b.windowClass,windowTemplateUrl:b.windowTemplateUrl,size:b.size})},function(a){e.reject(a)}),l.then(function(){f.resolve(!0)},function(){f.reject(!1)}),k},k}]};return a}),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function(a,b,c){var d=this,e={$setViewValue:angular.noop},f=b.numPages?c(b.numPages).assign:angular.noop;this.init=function(f,g){e=f,this.config=g,e.$render=function(){d.render()},b.itemsPerPage?a.$parent.$watch(c(b.itemsPerPage),function(b){d.itemsPerPage=parseInt(b,10),a.totalPages=d.calculateTotalPages()}):this.itemsPerPage=g.itemsPerPage},this.calculateTotalPages=function(){var b=this.itemsPerPage<1?1:Math.ceil(a.totalItems/this.itemsPerPage);return Math.max(b||0,1)},this.render=function(){a.page=parseInt(e.$viewValue,10)||1},a.selectPage=function(b){a.page!==b&&b>0&&b<=a.totalPages&&(e.$setViewValue(b),e.$render())},a.getText=function(b){return a[b+"Text"]||d.config[b+"Text"]},a.noPrevious=function(){return 1===a.page},a.noNext=function(){return a.page===a.totalPages},a.$watch("totalItems",function(){a.totalPages=d.calculateTotalPages()}),a.$watch("totalPages",function(b){f(a.$parent,b),a.page>b?a.selectPage(b):e.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function(a,b){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(c,d,e,f){function g(a,b,c){return{number:a,text:b,active:c}}function h(a,b){var c=[],d=1,e=b,f=angular.isDefined(k)&&b>k;f&&(l?(d=Math.max(a-Math.floor(k/2),1),e=d+k-1,e>b&&(e=b,d=e-k+1)):(d=(Math.ceil(a/k)-1)*k+1,e=Math.min(d+k-1,b)));for(var h=d;e>=h;h++){var i=g(h,h,h===a);c.push(i)}if(f&&!l){if(d>1){var j=g(d-1,"...",!1);c.unshift(j)}if(b>e){var m=g(e+1,"...",!1);c.push(m)}}return c}var i=f[0],j=f[1];if(j){var k=angular.isDefined(e.maxSize)?c.$parent.$eval(e.maxSize):b.maxSize,l=angular.isDefined(e.rotate)?c.$parent.$eval(e.rotate):b.rotate;c.boundaryLinks=angular.isDefined(e.boundaryLinks)?c.$parent.$eval(e.boundaryLinks):b.boundaryLinks,c.directionLinks=angular.isDefined(e.directionLinks)?c.$parent.$eval(e.directionLinks):b.directionLinks,i.init(j,b),e.maxSize&&c.$parent.$watch(a(e.maxSize),function(a){k=parseInt(a,10),i.render()
});var m=i.render;i.render=function(){m(),c.page>0&&c.page<=c.totalPages&&(c.pages=h(c.page,c.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:"« Previous",nextText:"Next »",align:!0}).directive("pager",["pagerConfig",function(a){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(b,c,d,e){var f=e[0],g=e[1];g&&(b.align=angular.isDefined(d.align)?b.$parent.$eval(d.align):a.align,f.init(g,a))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function a(a){var b=/[A-Z]/g,c="-";return a.replace(b,function(a,b){return(b?c:"")+a.toLowerCase()})}var b={placement:"top",animation:!0,popupDelay:0},c={mouseenter:"mouseleave",click:"click",focus:"blur"},d={};this.options=function(a){angular.extend(d,a)},this.setTriggers=function(a){angular.extend(c,a)},this.$get=["$window","$compile","$timeout","$parse","$document","$position","$interpolate",function(e,f,g,h,i,j,k){return function(e,l,m){function n(a){var b=a||o.trigger||m,d=c[b]||b;return{show:b,hide:d}}var o=angular.extend({},b,d),p=a(e),q=k.startSymbol(),r=k.endSymbol(),s="<div "+p+'-popup title="'+q+"tt_title"+r+'" content="'+q+"tt_content"+r+'" placement="'+q+"tt_placement"+r+'" animation="tt_animation" is-open="tt_isOpen"></div>';return{restrict:"EA",scope:!0,compile:function(){var a=f(s);return function(b,c,d){function f(){b.tt_isOpen?m():k()}function k(){(!y||b.$eval(d[l+"Enable"]))&&(b.tt_popupDelay?v||(v=g(p,b.tt_popupDelay,!1),v.then(function(a){a()})):p()())}function m(){b.$apply(function(){q()})}function p(){return v=null,u&&(g.cancel(u),u=null),b.tt_content?(r(),t.css({top:0,left:0,display:"block"}),w?i.find("body").append(t):c.after(t),z(),b.tt_isOpen=!0,b.$digest(),z):angular.noop}function q(){b.tt_isOpen=!1,g.cancel(v),v=null,b.tt_animation?u||(u=g(s,500)):s()}function r(){t&&s(),t=a(b,function(){}),b.$digest()}function s(){u=null,t&&(t.remove(),t=null)}var t,u,v,w=angular.isDefined(o.appendToBody)?o.appendToBody:!1,x=n(void 0),y=angular.isDefined(d[l+"Enable"]),z=function(){var a=j.positionElements(c,t,b.tt_placement,w);a.top+="px",a.left+="px",t.css(a)};b.tt_isOpen=!1,d.$observe(e,function(a){b.tt_content=a,!a&&b.tt_isOpen&&q()}),d.$observe(l+"Title",function(a){b.tt_title=a}),d.$observe(l+"Placement",function(a){b.tt_placement=angular.isDefined(a)?a:o.placement}),d.$observe(l+"PopupDelay",function(a){var c=parseInt(a,10);b.tt_popupDelay=isNaN(c)?o.popupDelay:c});var A=function(){c.unbind(x.show,k),c.unbind(x.hide,m)};d.$observe(l+"Trigger",function(a){A(),x=n(a),x.show===x.hide?c.bind(x.show,f):(c.bind(x.show,k),c.bind(x.hide,m))});var B=b.$eval(d[l+"Animation"]);b.tt_animation=angular.isDefined(B)?!!B:o.animation,d.$observe(l+"AppendToBody",function(a){w=angular.isDefined(a)?h(a)(b):w}),w&&b.$on("$locationChangeSuccess",function(){b.tt_isOpen&&q()}),b.$on("$destroy",function(){g.cancel(u),g.cancel(v),A(),s()})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function(a){return a("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function(a){return a("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function(a){return a("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function(a,b,c){var d=this,e=angular.isDefined(b.animate)?a.$parent.$eval(b.animate):c.animate;this.bars=[],a.max=angular.isDefined(b.max)?a.$parent.$eval(b.max):c.max,this.addBar=function(b,c){e||c.css({transition:"none"}),this.bars.push(b),b.$watch("value",function(c){b.percent=+(100*c/a.max).toFixed(2)}),b.$on("$destroy",function(){c=null,d.removeBar(b)})},this.removeBar=function(a){this.bars.splice(this.bars.indexOf(a),1)}}]).directive("progress",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}}).directive("bar",function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(a,b,c,d){d.addBar(a,b)}}}).directive("progressbar",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(a,b,c,d){d.addBar(a,angular.element(b.children()[0]))}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function(a,b,c){var d={$setViewValue:angular.noop};this.init=function(e){d=e,d.$render=this.render,this.stateOn=angular.isDefined(b.stateOn)?a.$parent.$eval(b.stateOn):c.stateOn,this.stateOff=angular.isDefined(b.stateOff)?a.$parent.$eval(b.stateOff):c.stateOff;var f=angular.isDefined(b.ratingStates)?a.$parent.$eval(b.ratingStates):new Array(angular.isDefined(b.max)?a.$parent.$eval(b.max):c.max);a.range=this.buildTemplateObjects(f)},this.buildTemplateObjects=function(a){for(var b=0,c=a.length;c>b;b++)a[b]=angular.extend({index:b},{stateOn:this.stateOn,stateOff:this.stateOff},a[b]);return a},a.rate=function(b){!a.readonly&&b>=0&&b<=a.range.length&&(d.$setViewValue(b),d.$render())},a.enter=function(b){a.readonly||(a.value=b),a.onHover({value:b})},a.reset=function(){a.value=d.$viewValue,a.onLeave()},a.onKeydown=function(b){/(37|38|39|40)/.test(b.which)&&(b.preventDefault(),b.stopPropagation(),a.rate(a.value+(38===b.which||39===b.which?1:-1)))},this.render=function(){a.value=d.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f)}}}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function(a){var b=this,c=b.tabs=a.tabs=[];b.select=function(a){angular.forEach(c,function(b){b.active&&b!==a&&(b.active=!1,b.onDeselect())}),a.active=!0,a.onSelect()},b.addTab=function(a){c.push(a),1===c.length?a.active=!0:a.active&&b.select(a)},b.removeTab=function(a){var d=c.indexOf(a);if(a.active&&c.length>1){var e=d==c.length-1?d-1:d+1;b.select(c[e])}c.splice(d,1)}}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(a,b,c){a.vertical=angular.isDefined(c.vertical)?a.$parent.$eval(c.vertical):!1,a.justified=angular.isDefined(c.justified)?a.$parent.$eval(c.justified):!1}}}).directive("tab",["$parse",function(a){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(b,c,d){return function(b,c,e,f){b.$watch("active",function(a){a&&f.select(b)}),b.disabled=!1,e.disabled&&b.$parent.$watch(a(e.disabled),function(a){b.disabled=!!a}),b.select=function(){b.disabled||(b.active=!0)},f.addTab(b),b.$on("$destroy",function(){f.removeTab(b)}),b.$transcludeFn=d}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(a,b){a.$watch("headingElement",function(a){a&&(b.html(""),b.append(a))})}}}]).directive("tabContentTransclude",function(){function a(a){return a.tagName&&(a.hasAttribute("tab-heading")||a.hasAttribute("data-tab-heading")||"tab-heading"===a.tagName.toLowerCase()||"data-tab-heading"===a.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(b,c,d){var e=b.$eval(d.tabContentTransclude);e.$transcludeFn(e.$parent,function(b){angular.forEach(b,function(b){a(b)?e.headingElement=b:c.append(b)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function(a,b,c,d,e,f){function g(){var b=parseInt(a.hours,10),c=a.showMeridian?b>0&&13>b:b>=0&&24>b;return c?(a.showMeridian&&(12===b&&(b=0),a.meridian===p[1]&&(b+=12)),b):void 0}function h(){var b=parseInt(a.minutes,10);return b>=0&&60>b?b:void 0}function i(a){return angular.isDefined(a)&&a.toString().length<2?"0"+a:a}function j(a){k(),o.$setViewValue(new Date(n)),l(a)}function k(){o.$setValidity("time",!0),a.invalidHours=!1,a.invalidMinutes=!1}function l(b){var c=n.getHours(),d=n.getMinutes();a.showMeridian&&(c=0===c||12===c?12:c%12),a.hours="h"===b?c:i(c),a.minutes="m"===b?d:i(d),a.meridian=n.getHours()<12?p[0]:p[1]}function m(a){var b=new Date(n.getTime()+6e4*a);n.setHours(b.getHours(),b.getMinutes()),j()}var n=new Date,o={$setViewValue:angular.noop},p=angular.isDefined(b.meridians)?a.$parent.$eval(b.meridians):f.meridians||e.DATETIME_FORMATS.AMPMS;this.init=function(c,d){o=c,o.$render=this.render;var e=d.eq(0),g=d.eq(1),h=angular.isDefined(b.mousewheel)?a.$parent.$eval(b.mousewheel):f.mousewheel;h&&this.setupMousewheelEvents(e,g),a.readonlyInput=angular.isDefined(b.readonlyInput)?a.$parent.$eval(b.readonlyInput):f.readonlyInput,this.setupInputEvents(e,g)};var q=f.hourStep;b.hourStep&&a.$parent.$watch(c(b.hourStep),function(a){q=parseInt(a,10)});var r=f.minuteStep;b.minuteStep&&a.$parent.$watch(c(b.minuteStep),function(a){r=parseInt(a,10)}),a.showMeridian=f.showMeridian,b.showMeridian&&a.$parent.$watch(c(b.showMeridian),function(b){if(a.showMeridian=!!b,o.$error.time){var c=g(),d=h();angular.isDefined(c)&&angular.isDefined(d)&&(n.setHours(c),j())}else l()}),this.setupMousewheelEvents=function(b,c){var d=function(a){a.originalEvent&&(a=a.originalEvent);var b=a.wheelDelta?a.wheelDelta:-a.deltaY;return a.detail||b>0};b.bind("mousewheel wheel",function(b){a.$apply(d(b)?a.incrementHours():a.decrementHours()),b.preventDefault()}),c.bind("mousewheel wheel",function(b){a.$apply(d(b)?a.incrementMinutes():a.decrementMinutes()),b.preventDefault()})},this.setupInputEvents=function(b,c){if(a.readonlyInput)return a.updateHours=angular.noop,void(a.updateMinutes=angular.noop);var d=function(b,c){o.$setViewValue(null),o.$setValidity("time",!1),angular.isDefined(b)&&(a.invalidHours=b),angular.isDefined(c)&&(a.invalidMinutes=c)};a.updateHours=function(){var a=g();angular.isDefined(a)?(n.setHours(a),j("h")):d(!0)},b.bind("blur",function(){!a.invalidHours&&a.hours<10&&a.$apply(function(){a.hours=i(a.hours)})}),a.updateMinutes=function(){var a=h();angular.isDefined(a)?(n.setMinutes(a),j("m")):d(void 0,!0)},c.bind("blur",function(){!a.invalidMinutes&&a.minutes<10&&a.$apply(function(){a.minutes=i(a.minutes)})})},this.render=function(){var a=o.$modelValue?new Date(o.$modelValue):null;isNaN(a)?(o.$setValidity("time",!1),d.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(a&&(n=a),k(),l())},a.incrementHours=function(){m(60*q)},a.decrementHours=function(){m(60*-q)},a.incrementMinutes=function(){m(r)},a.decrementMinutes=function(){m(-r)},a.toggleMeridian=function(){m(720*(n.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f,b.find("input"))}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function(a){var b=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(c){var d=c.match(b);if(!d)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+c+'".');return{itemName:d[3],source:a(d[4]),viewMapper:a(d[2]||d[1]),modelMapper:a(d[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function(a,b,c,d,e,f,g){var h=[9,13,27,38,40];return{require:"ngModel",link:function(i,j,k,l){var m,n=i.$eval(k.typeaheadMinLength)||1,o=i.$eval(k.typeaheadWaitMs)||0,p=i.$eval(k.typeaheadEditable)!==!1,q=b(k.typeaheadLoading).assign||angular.noop,r=b(k.typeaheadOnSelect),s=k.typeaheadInputFormatter?b(k.typeaheadInputFormatter):void 0,t=k.typeaheadAppendToBody?i.$eval(k.typeaheadAppendToBody):!1,u=b(k.ngModel).assign,v=g.parse(k.typeahead),w=i.$new();i.$on("$destroy",function(){w.$destroy()});var x="typeahead-"+w.$id+"-"+Math.floor(1e4*Math.random());j.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":x});var y=angular.element("<div typeahead-popup></div>");y.attr({id:x,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(k.typeaheadTemplateUrl)&&y.attr("template-url",k.typeaheadTemplateUrl);var z=function(){w.matches=[],w.activeIdx=-1,j.attr("aria-expanded",!1)},A=function(a){return x+"-option-"+a};w.$watch("activeIdx",function(a){0>a?j.removeAttr("aria-activedescendant"):j.attr("aria-activedescendant",A(a))});var B=function(a){var b={$viewValue:a};q(i,!0),c.when(v.source(i,b)).then(function(c){var d=a===l.$viewValue;if(d&&m)if(c.length>0){w.activeIdx=0,w.matches.length=0;for(var e=0;e<c.length;e++)b[v.itemName]=c[e],w.matches.push({id:A(e),label:v.viewMapper(w,b),model:c[e]});w.query=a,w.position=t?f.offset(j):f.position(j),w.position.top=w.position.top+j.prop("offsetHeight"),j.attr("aria-expanded",!0)}else z();d&&q(i,!1)},function(){z(),q(i,!1)})};z(),w.query=void 0;var C,D=function(a){C=d(function(){B(a)},o)},E=function(){C&&d.cancel(C)};l.$parsers.unshift(function(a){return m=!0,a&&a.length>=n?o>0?(E(),D(a)):B(a):(q(i,!1),E(),z()),p?a:a?void l.$setValidity("editable",!1):(l.$setValidity("editable",!0),a)}),l.$formatters.push(function(a){var b,c,d={};return s?(d.$model=a,s(i,d)):(d[v.itemName]=a,b=v.viewMapper(i,d),d[v.itemName]=void 0,c=v.viewMapper(i,d),b!==c?b:a)}),w.select=function(a){var b,c,e={};e[v.itemName]=c=w.matches[a].model,b=v.modelMapper(i,e),u(i,b),l.$setValidity("editable",!0),r(i,{$item:c,$model:b,$label:v.viewMapper(i,e)}),z(),d(function(){j[0].focus()},0,!1)},j.bind("keydown",function(a){0!==w.matches.length&&-1!==h.indexOf(a.which)&&(a.preventDefault(),40===a.which?(w.activeIdx=(w.activeIdx+1)%w.matches.length,w.$digest()):38===a.which?(w.activeIdx=(w.activeIdx?w.activeIdx:w.matches.length)-1,w.$digest()):13===a.which||9===a.which?w.$apply(function(){w.select(w.activeIdx)}):27===a.which&&(a.stopPropagation(),z(),w.$digest()))}),j.bind("blur",function(){m=!1});var F=function(a){j[0]!==a.target&&(z(),w.$digest())};e.bind("click",F),i.$on("$destroy",function(){e.unbind("click",F)});var G=a(y)(w);t?e.find("body").append(G):j.after(G)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(a,b,c){a.templateUrl=c.templateUrl,a.isOpen=function(){return a.matches.length>0},a.isActive=function(b){return a.active==b},a.selectActive=function(b){a.active=b},a.selectMatch=function(b){a.select({activeIdx:b})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function(a,b,c,d){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(e,f,g){var h=d(g.templateUrl)(e.$parent)||"template/typeahead/typeahead-match.html";a.get(h,{cache:b}).success(function(a){f.replaceWith(c(a.trim())(e))})}}}]).filter("typeaheadHighlight",function(){function a(a){return a.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(b,c){return c?(""+b).replace(new RegExp(a(c),"gi"),"<strong>$&</strong>"):b}}),angular.module("template/accordion/accordion-group.html",[]).run(["$templateCache",function(a){a.put("template/accordion/accordion-group.html",'<div class="panel panel-default">\n  <div class="panel-heading">\n    <h4 class="panel-title">\n      <a class="accordion-toggle" ng-click="toggleOpen()" accordion-transclude="heading"><span ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></a>\n    </h4>\n  </div>\n  <div class="panel-collapse" collapse="!isOpen">\n	  <div class="panel-body" ng-transclude></div>\n  </div>\n</div>')}]),angular.module("template/accordion/accordion.html",[]).run(["$templateCache",function(a){a.put("template/accordion/accordion.html",'<div class="panel-group" ng-transclude></div>')}]),angular.module("template/alert/alert.html",[]).run(["$templateCache",function(a){a.put("template/alert/alert.html",'<div class="alert" ng-class="[\'alert-\' + (type || \'warning\'), closeable ? \'alert-dismissable\' : null]" role="alert">\n    <button ng-show="closeable" type="button" class="close" ng-click="close()">\n        <span aria-hidden="true">&times;</span>\n        <span class="sr-only">Close</span>\n    </button>\n    <div ng-transclude></div>\n</div>\n')}]),angular.module("template/carousel/carousel.html",[]).run(["$templateCache",function(a){a.put("template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel" ng-swipe-right="prev()" ng-swipe-left="next()">\n    <ol class="carousel-indicators" ng-show="slides.length > 1">\n        <li ng-repeat="slide in slides track by $index" ng-class="{active: isActive(slide)}" ng-click="select(slide)"></li>\n    </ol>\n    <div class="carousel-inner" ng-transclude></div>\n    <a class="left carousel-control" ng-click="prev()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-left"></span></a>\n    <a class="right carousel-control" ng-click="next()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-right"></span></a>\n</div>\n')}]),angular.module("template/carousel/slide.html",[]).run(["$templateCache",function(a){a.put("template/carousel/slide.html","<div ng-class=\"{\n    'active': leaving || (active && !entering),\n    'prev': (next || active) && direction=='prev',\n    'next': (next || active) && direction=='next',\n    'right': direction=='prev',\n    'left': direction=='next'\n  }\" class=\"item text-center\" ng-transclude></div>\n")}]),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <daypicker ng-switch-when="day" tabindex="0"></daypicker>\n  <monthpicker ng-switch-when="month" tabindex="0"></monthpicker>\n  <yearpicker ng-switch-when="year" tabindex="0"></yearpicker>\n</div>')}]),angular.module("template/datepicker/day.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/day.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{5 + showWeeks}}"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-show="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-show="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/month.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/month.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/popup.html",'<ul class="dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)">\n	<li ng-transclude></li>\n	<li ng-if="showButtonBar" style="padding:10px 9px 2px">\n		<span class="btn-group">\n			<button type="button" class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'current\') }}</button>\n			<button type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n		</span>\n		<button type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText(\'close\') }}</button>\n	</li>\n</ul>\n')}]),angular.module("template/datepicker/year.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/year.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="3"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/modal/backdrop.html",[]).run(["$templateCache",function(a){a.put("template/modal/backdrop.html",'<div class="modal-backdrop fade {{ backdropClass }}"\n     ng-class="{in: animate}"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("template/modal/window.html",[]).run(["$templateCache",function(a){a.put("template/modal/window.html",'<div tabindex="-1" role="dialog" class="modal fade" ng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)">\n    <div class="modal-dialog" ng-class="{\'modal-sm\': size == \'sm\', \'modal-lg\': size == \'lg\'}"><div class="modal-content" modal-transclude></div></div>\n</div>')}]),angular.module("template/pagination/pager.html",[]).run(["$templateCache",function(a){a.put("template/pagination/pager.html",'<ul class="pager">\n  <li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n</ul>')}]),angular.module("template/pagination/pagination.html",[]).run(["$templateCache",function(a){a.put("template/pagination/pagination.html",'<ul class="pagination">\n  <li ng-if="boundaryLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(1)">{{getText(\'first\')}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-repeat="page in pages track by $index" ng-class="{active: page.active}"><a href ng-click="selectPage(page.number)">{{page.text}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n  <li ng-if="boundaryLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(totalPages)">{{getText(\'last\')}}</a></li>\n</ul>')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function(a){a.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function(a){a.put("template/tooltip/tooltip-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/popover/popover.html",[]).run(["$templateCache",function(a){a.put("template/popover/popover.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>\n      <div class="popover-content" ng-bind="content"></div>\n  </div>\n</div>\n')}]),angular.module("template/progressbar/bar.html",[]).run(["$templateCache",function(a){a.put("template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>')}]),angular.module("template/progressbar/progress.html",[]).run(["$templateCache",function(a){a.put("template/progressbar/progress.html",'<div class="progress" ng-transclude></div>')}]),angular.module("template/progressbar/progressbar.html",[]).run(["$templateCache",function(a){a.put("template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>\n</div>')}]),angular.module("template/rating/rating.html",[]).run(["$templateCache",function(a){a.put("template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}">\n    <i ng-repeat="r in range track by $index" ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')">\n        <span class="sr-only">({{ $index < value ? \'*\' : \' \' }})</span>\n    </i>\n</span>')}]),angular.module("template/tabs/tab.html",[]).run(["$templateCache",function(a){a.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}">\n  <a ng-click="select()" tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("template/tabs/tabset.html",[]).run(["$templateCache",function(a){a.put("template/tabs/tabset.html",'<div>\n  <ul class="nav nav-{{type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n  <div class="tab-content">\n    <div class="tab-pane" \n         ng-repeat="tab in tabs" \n         ng-class="{active: tab.active}"\n         tab-content-transclude="tab">\n    </div>\n  </div>\n</div>\n')}]),angular.module("template/timepicker/timepicker.html",[]).run(["$templateCache",function(a){a.put("template/timepicker/timepicker.html",'<table>\n	<tbody>\n		<tr class="text-center">\n			<td><a ng-click="incrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="incrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n		<tr>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidHours}">\n				<input type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-mousewheel="incrementHours()" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td>:</td>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidMinutes}">\n				<input type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td>\n		</tr>\n		<tr class="text-center">\n			<td><a ng-click="decrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="decrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n	</tbody>\n</table>\n')}]),angular.module("template/typeahead/typeahead-match.html",[]).run(["$templateCache",function(a){a.put("template/typeahead/typeahead-match.html",'<a tabindex="-1" bind-html-unsafe="match.label | typeaheadHighlight:query"></a>')
}]),angular.module("template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function(a){a.put("template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-show="isOpen()" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index)" role="option" id="{{match.id}}">\n        <div typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>\n    </li>\n</ul>\n')}]);
},{}],13:[function(require,module,exports){
/**
 * Created by kasperen on 18.09.14.
 */
angular.module('ui.handsontable', [])
    .service('handsontableSrvc', function() {
    })
    .controller("HandsonController", function ($scope) {
		/*
		$scope.data = instance.LCPQuestionnaire.listOfPlants;
		$scope.data = [
			{
				"delete": false,
				"plantName": "1",
				"plantId": "",
				"eprtrNationalId": "",
				"address1": "",
				"address2": "",
				"city": "",
				"region": "",
				"postalCode": "",
				"longitude": "",
				"latitude": ""
			},
			{
				"delete": false,
				"plantName": "2",
				"plantId": null,
				"eprtrNationalId": null,
				"address1": null,
				"address2": null,
				"city": null,
				"region": null,
				"postalCode": null,
				"longitude": null,
				"latitude": null
			}
		];
		*/
	})
	.directive('uiHandsontable', function () {
		return {
			restrict: 'A',
			scope: {
				data: '='
			},
			replace: true,
			link: function (scope, elem, attrs) {
				elem.handsontable({
				data: scope.data,
                contextMenu: true,
				rowHeaders: true,
				minSpareRows: 1,
                colHeaders: ["Delete", "Plant Name", "Plant Id", "E-PRTR national ID", "Address 1", "Address 2", "City", "Region", "Postal code", "Longitude", "Latitude"],
                columns: [
                    {
                        data: "delete",
                        type: "checkbox"
                    },
                    {
                        data: "plantName"
                    },
                    {
                        data: "plantId",
                        type: 'numeric'
                    },
                    {
                        data: "eprtrNationalId",
                        type: 'numeric'
                    },
                    {
                        data: "address1"
                    },
                    {
                        data: "address2"
                    },
                    {
                        data: "city"
                    },
                    {
                        data: "region"
                    },
                    {
                        data: "postalCode",
                        type: 'numeric'
                    },
                    {
                        data: "longitude",
                        type: 'numeric',
                        format: '000.000'
                    },
                    {
                        data: "latitude",
                        type: 'numeric',
                        format: '000.000'
                    }
                ]
            })
        }
    }
	})
},{}],14:[function(require,module,exports){
// Module that provides multiselect box to webform from json-ld format.
//
// Usage Example:
// <div multiselect class="multiselect" name="TypeOfUse" multiple="true"
//      ng-model="row.TypeOfUse"
//      options="annex1Concept['@id'] as annex1Concept.prefLabel[0]['@value'] for annex1Concept in codeList.LCPCodelists.Annex1Activities.concepts"
//      change="selected()" required></div>
//
// Note! options instead of ng-options is used.
angular.module('ui.multiselect', [
        'multiselect.tpl.html'
    ])

    //from bootstrap-ui typeahead parser
    .factory('optionParser', ['$parse', function ($parse) {

        //                      00000111000000000000022200000000000000003333333333333330000000000044000
        var TYPEAHEAD_REGEXP = /^\s*(.*?)(?:\s+as\s+(.*?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+(.*)$/;

        return {
            parse: function (input) {

                var match = input.match(TYPEAHEAD_REGEXP), modelMapper, viewMapper, source;
                if (!match) {
                    throw new Error(
                        "Expected typeahead specification in form of '_modelValue_ (as _label_)? for _item_ in _collection_'" +
                            " but got '" + input + "'.");
                }

                return {
                    itemName: match[3],
                    source: $parse(match[4]),
                    viewMapper: $parse(match[2] || match[1]),
                    modelMapper: $parse(match[1])
                };
            }
        };
    }])

    .directive('multiselect', ['$parse', '$document', '$compile', '$interpolate', 'optionParser',

        function ($parse, $document, $compile, $interpolate, optionParser) {
            return {
                restrict: 'AE',
                require: 'ngModel',
                link: function (originalScope, element, attrs, modelCtrl) {

                    var exp = attrs.options,
                        parsedResult = optionParser.parse(exp),
                        isMultiple = (attrs.multiple === "true") ? true : false,
                        showCheckAll = (attrs.showcheckall === "true") ? true : false,
                        showFilter = (attrs.showfilter === "true") ? true : false,
                        required = false,
                        scope = originalScope.$new(),
                        changeHandler = attrs.change || angular.noop;

                    scope.groups = [];
                    scope.header = 'Select';
                    scope.multiple = isMultiple;
                    scope.disabled = false;
                    scope.showCheckAll = showCheckAll;
                    scope.showFilter = showFilter;

                    originalScope.$on('$destroy', function () {
                        scope.$destroy();
                    });

                    var popUpEl = angular.element('<multiselect-popup></multiselect-popup>');

                    //required validator
                    if (attrs.required || attrs.ngRequired) {
                        required = true;
                    }
                    attrs.$observe('required', function(newVal) {
                        required = newVal;
                    });

                    //watch disabled state
                    scope.$watch(function () {
                        return $parse(attrs.disabled)(originalScope);
                    }, function (newVal) {
                        scope.disabled = newVal;
                    });

                    //watch single/multiple state for dynamically change single to multiple
                    scope.$watch(function () {
                        return $parse(attrs.multiple)(originalScope);
                    }, function (newVal) {
                        isMultiple = newVal || false;
                    });

                    //watch option changes for options that are populated dynamically
                    scope.$watch(function () {
                        return parsedResult.source(originalScope);
                    }, function (newVal) {
                        if (angular.isDefined(newVal))
                            parseModel();
                    }, true);

                    //watch model change
                    scope.$watch(function () {
                        return modelCtrl.$modelValue;
                    }, function (newVal, oldVal) {
                        //when directive initialize, newVal usually undefined. Also, if model value already set in the controller
                        //for preselected list then we need to mark checked in our scope item. But we don't want to do this every time
                        //model changes. We need to do this only if it is done outside directive scope, from controller, for example.
                        if (angular.isDefined(newVal)) {
                            markChecked(newVal);
                            scope.$eval(changeHandler);
                        }
                        getHeaderText();
                        modelCtrl.$setValidity('required', scope.valid());
                    }, true);

                    function parseModel() {
                        scope.groups.length = 0;
                        var model = parsedResult.source(originalScope);
                        var groupIndex = 0;
                        var groupIdIndexMap = {};
                        var defaultGroup = [];
                        defaultGroup.items = [];
                        if(!angular.isDefined(model)) return;

                        for (var i = 0; i < model.length; i++) {
                            if (angular.isDefined(model[i].narrower) && model[i].narrower.length > 0){
                                //now we have groups
                                scope.groups[groupIndex] = { "name" : model[i].prefLabel[0]['@value'], "items" : []};
                                groupIdIndexMap[model[i]['@id']] = groupIndex;
                                groupIndex++;
                                continue;
                            }

                            var group = defaultGroup; //if there is no group or group cannot be found, then add it to default group
                            if (angular.isDefined(model[i].broader) && model[i].broader.length == 1 && angular.isDefined(groupIdIndexMap[model[i].broader[0]['@id']])) {
                                //now we have a sub element
                                group = scope.groups[groupIdIndexMap[model[i].broader[0]['@id']]];
                            }

                            var local = {};
                            local[parsedResult.itemName] = model[i];
                            var checked = false;
                            if (modelCtrl.$modelValue) {
                                //TODO what is this modelCtrl and modelValue
                                if(!(modelCtrl.$modelValue instanceof Array) && model[i]['@id'] === modelCtrl.$modelValue) {
                                    checked = true;
                                } else if((modelCtrl.$modelValue instanceof Array) && contains(modelCtrl.$modelValue, model[i]['@id'])) {
                                    checked = true;
                                }
                            }

                            group.items.push({
                                label: parsedResult.viewMapper(local),
                                model: model[i]['@id'],
                                checked: checked
                            });
                        }

                        // now add default group
                        scope.groups[groupIndex] = defaultGroup;
                    } //end of function parseModel

                    function contains(array, needle) {
                        for (var i = 0; i < array.length; i++){
                            if (array[i] == needle) {
                                return true;
                            }
                        }
                        return false;
                    }

                    parseModel();

                    element.append($compile(popUpEl)(scope));

                    function getHeaderText() {
                        var defaultHeader = 'Select';

                        if (!modelCtrl.$modelValue) return scope.header = attrs.msHeader || defaultHeader;

                        if (modelCtrl.$modelValue && modelCtrl.$modelValue instanceof Array) {
                            if (attrs.msSelected) {
                                scope.header = $interpolate(attrs.msSelected)(scope);
                            } else {
                                scope.header = modelCtrl.$modelValue[0] != ''? modelCtrl.$modelValue.length + ' ' + 'selected' : defaultHeader;
                            }

                        } else if(modelCtrl.$modelValue && typeof 0){
                            scope.header = '1 selected';
                        } else {
                            var local = {};
                            local[parsedResult.itemName] = modelCtrl.$modelValue;
                            scope.header = parsedResult.viewMapper(local);
                        }
                    }

                    function is_empty(obj) {
                        if (!obj) return true;
                        if (obj.length && obj.length > 0) return false;
                        for (var prop in obj) if (obj[prop]) return false;
                        return true;
                    };

                    scope.valid = function validModel() {
                        if(!required) return true;
                        var value = modelCtrl.$modelValue;
                        return (angular.isArray(value) && value.length > 0) || (!angular.isArray(value) && value != null);
                    };

                    function selectSingle(item) {
                        if (item.checked) {
                            scope.uncheckAll();
                        } else {
                            scope.uncheckAll();
                            item.checked = !item.checked;
                        }
                        setModelValue(false);
                    }

                    function selectMultiple(item) {
                        item.checked = !item.checked;
                        setModelValue(true);
                    }

                    function setModelValue(isMultiple) {
                        var value;

                        if (isMultiple) {
                            value = [];
                            angular.forEach(scope.groups, function (group) {
                                angular.forEach(group.items, function (item) {
                                    if (item.checked){
                                        value.push(item.model);
                                    }
                                })
                            })
                        } else {
                            angular.forEach(scope.groups, function (group) {
                                angular.forEach(group.items, function (item) {
                                    if (item.checked) {
                                        value = item.model;
                                        return false;
                                    }
                                })
                            })
                        }
                        modelCtrl.$setViewValue(value);
                    }

                    function markChecked(newVal) {
                        if (!angular.isArray(newVal)) {
                            if (!!newVal && typeof newVal !== "string") {
                                newVal = newVal.toString();
                            }
                            angular.forEach(scope.groups, function (group) {
                                angular.forEach(group.items, function (item) {
                                    if (angular.equals(item.model, newVal)) {
                                        item.checked = true;
                                        return false;
                                    }
                                })
                            });
                        } else {
                            angular.forEach(scope.groups, function (group) {
                                angular.forEach(group.items, function (item) {
                                    item.checked = false;
                                    angular.forEach(newVal, function (i) {
                                        if (!!i && typeof i !== "string") {
                                            i = i.toString();
                                        }
                                        if (angular.equals(item.model, i)) {
                                            item.checked = true;
                                        }
                                    });
                                })
                            });
                        }
                    }

                    scope.checkAll = function () {
                        if (!isMultiple) return;
                        angular.forEach(scope.groups, function (group) {
                            angular.forEach(group.items, function (item) {
                                item.checked = true;
                            })
                        });
                        setModelValue(true);
                    };

                    scope.uncheckAll = function () {
                        angular.forEach(scope.groups, function (group) {
                            angular.forEach(group.items, function (item) {
                                item.checked = false;
                            })
                        });
                        setModelValue(true);
                    };

                    scope.select = function (item) {
                        if (isMultiple === false) {
                            selectSingle(item);
                            scope.toggleSelect();
                        } else {
                            selectMultiple(item);
                        }
                    }
                }
            };
        }])

    .directive('multiselectPopup', ['$document', function ($document) {
        return {
            restrict: 'AE',
            scope: false,
            replace: true,
            templateUrl: 'multiselect.tpl.html',
            link: function (scope, element, attrs) {

                scope.isVisible = false;

                scope.toggleSelect = function () {
                    if (element.hasClass('open')) {
                        element.removeClass('open');
                        $document.unbind('click', clickHandler);
                    } else {
                        element.addClass('open');
                        $document.bind('click', clickHandler);
                        //scope.focus();
                    }
                };

                function clickHandler(event) {
                    if (elementMatchesAnyInArray(event.target, element.find(event.target.tagName)))
                        return;
                    element.removeClass('open');
                    $document.unbind('click', clickHandler);
                    scope.$apply();
                }

//                scope.focus = function focus(){
//                    var searchBox = element.find('input')[0];
//                    searchBox.focus();
//                }

                var elementMatchesAnyInArray = function (element, elementArray) {
                    for (var i = 0; i < elementArray.length; i++)
                        if (element == elementArray[i])
                            return true;
                    return false;
                }
            }
        }
    }]);

angular.module('multiselect.tpl.html', [])

    .run(['$templateCache', function($templateCache) {
        $templateCache.put('multiselect.tpl.html',

            "<div class=\"dropdown\">\n" +
                "  <button type=\"button\" class=\"btn btn-default\" ng-click=\"toggleSelect()\" ng-disabled=\"disabled\" ng-class=\"{'error': !valid()}\">\n" +
                "    {{header}} <span class=\"caret\"></span>\n" +
                "  </button>\n" +
                "  <ul class=\"dropdown-menu\">\n" +
                "    <li ng-show=\"showFilter\">\n" +
                "      <input class=\"form-control input-sm\" type=\"text\" ng-model=\"searchText.label\" autofocus=\"autofocus\" placeholder=\"Filter\" />\n" +
                "    </li>\n" +
                "    <li ng-show=\"multiple && showCheckAll\" role=\"presentation\" class=\"\">\n" +
                "      <button class=\"btn btn-link btn-xs\" ng-click=\"checkAll()\" type=\"button\"><i class=\"icon-ok\"></i> Check all</button>\n" +
                "      <button class=\"btn btn-link btn-xs\" ng-click=\"uncheckAll()\" type=\"button\"><i class=\"icon-remove\"></i> Uncheck all</button>\n" +
                "    </li>\n" +
                "    <div ng-repeat=\"i in groups\">\n" +
                "       <div>\n" +
                "           <h5>{{i.name}}</h5>"+
                "       </div>\n" +
                "       <div class=\"dropdown-container\" ng-repeat=\"j in i.items | filter:searchText\">\n" +
                "           <a ng-click=\"select(j); focus()\">\n" +
                "               <i ng-class=\"{'icon-ok': j.checked, 'icon-empty': !j.checked}\"></i> {{j.label}}</a>\n" +
                "       </div>\n" +
                "    </div>\n" +
                "  </ul>\n" +
                "</div>");
    }]);

},{}],15:[function(require,module,exports){
/**
 * Created by argoaava on 22.04.14.
 */

// Module that provides functionality to ask confirmation from user when
// form has changed and user tries to leave page without saving.
//
// Usage example:
//
// <div ng-form="appForm" novalidate class="css-form" ng-class="{ 'submitted' : submitted }" td-navigation-blocker-form>
//
// 'td-navigation-blocker-form' must be specified as attribute for the form that confirmation functionality
// must apply to.

//FIXME should be able to make it so that rootScope is not used.
angular.module('navigation.navigationBlocker', [])
    .run(['$rootScope', '$location', function ($rootScope, $location) {
        var _preventNavigation = false;
        var _preventNavigationUrl = null;

        $rootScope.allowNavigation = function() {
            _preventNavigation = false;
        };

        $rootScope.preventNavigation = function() {
            _preventNavigation = true;
            _preventNavigationUrl = $location.absUrl();
        }

        $rootScope.$on('$locationChangeStart', function (event, newUrl, oldUrl) {
            // Allow navigation if our old url wasn't where we prevented navigation from
            if (_preventNavigationUrl != oldUrl || _preventNavigationUrl == null) {
                $rootScope.allowNavigation();
                return;
            }

            if (_preventNavigation && !confirm("You have unsaved changes, do you want to continue?")) {
                event.preventDefault();
            }
            else {
                $rootScope.allowNavigation();
            }
        });

        // Take care of preventing navigation out of our angular app
        window.onbeforeunload = function() {
            // Use the same data that we've set in our angular app
            if (_preventNavigation && $location.absUrl() == _preventNavigationUrl) {
                return "You have unsaved changes, do you want to continue?";
            }
        }
    }])

    .directive("blockFormNavigation", function () {
        return {
            restrict: 'A',
            require: ['^form'],
            link: function (scope, element, attrs, formController) {
                scope.$watch(attrs.ngForm + '.$dirty', function (dirty) {
                    if (dirty) {
                        scope.$root.preventNavigation();
                    } else {
                        scope.$root.allowNavigation();
                    }
                });
            }
        }
    })



},{}],16:[function(require,module,exports){
'use strict';
//  Service for creating notifications.
//  Origin: https://github.com/DerekRies/Angular-Notifications
//
//  Dependencies:
//      It use Bootstrab component:  http://getbootstrap.com/components/

//  Installation:
//      1. Add script file:
//          <script src="notification.js"></script>
//
//      2. Add css to your webform:
//          <link rel="stylesheet" href="notification.css"/>
//
//      3. Add notifications module as a dependency of your app module:
//          e.g angular.module('ngcomponentsApp', ['notifications'])
//
//      4. Add a div to your body tag somewhere and give it a
//          notifications directive specifying its position like so:
//              <div notifications="bottom right"></div>
//
// Usage Example:
//      You can use these methods with the following
//      line of code (userData parameter is optional, currently title is not used):
//
//    $notification.info(title, content, userData);
//    $notification.warning(title, content, userData);
//    $notification.error("Save", "Data is not saved !");
//    $notification.success("Save", "Data is saved successfully.");
//
angular.module('notifications', []).
    factory('$notification', ['$timeout',function($timeout){

        //console.log('notification service online');
        var notifications = JSON.parse(localStorage.getItem('$notifications')) || [],
            queue = [];

        var settings = {
            info: { duration: 5000, enabled: true },
            warning: { duration: 5000, enabled: true },
            error: { duration: 5000, enabled: true },
            success: { duration: 5000, enabled: true },
            progress: { duration: 0, enabled: true },
            custom: { duration: 35000, enabled: true },
            details: true,
            localStorage: false,
            html5Mode: false,
            html5DefaultIcon: 'icon.png'
        };

        function html5Notify(icon, title, content, ondisplay, onclose){
            if(window.webkitNotifications.checkPermission() === 0){
                if(!icon){
                    icon = 'favicon.ico';
                }
                var noti = window.webkitNotifications.createNotification(icon, title, content);
                if(typeof ondisplay === 'function'){
                    noti.ondisplay = ondisplay;
                }
                if(typeof onclose === 'function'){
                    noti.onclose = onclose;
                }
                noti.show();
            }
            else {
                settings.html5Mode = false;
            }
        }


        return {

            /* ========== SETTINGS RELATED METHODS =============*/

            disableHtml5Mode: function(){
                settings.html5Mode = false;
            },

            disableType: function(notificationType){
                settings[notificationType].enabled = false;
            },

            enableHtml5Mode: function(){
                // settings.html5Mode = true;
                settings.html5Mode = this.requestHtml5ModePermissions();
            },

            enableType: function(notificationType){
                settings[notificationType].enabled = true;
            },

            getSettings: function(){
                return settings;
            },

            toggleType: function(notificationType){
                settings[notificationType].enabled = !settings[notificationType].enabled;
            },

            toggleHtml5Mode: function(){
                settings.html5Mode = !settings.html5Mode;
            },

            requestHtml5ModePermissions: function(){
                if (window.webkitNotifications){
                    //console.log('notifications are available');
                    if (window.webkitNotifications.checkPermission() === 0) {
                        return true;
                    }
                    else{
                        window.webkitNotifications.requestPermission(function(){
                            if(window.webkitNotifications.checkPermission() === 0){
                                settings.html5Mode = true;
                            }
                            else{
                                settings.html5Mode = false;
                            }
                        });
                        return false;
                    }
                }
                else{
                    //console.log('notifications are not supported');
                    return false;
                }
            },


            /* ============ QUERYING RELATED METHODS ============*/

            getAll: function(){
                // Returns all notifications that are currently stored
                return notifications;
            },

            getQueue: function(){
                return queue;
            },

            /* ============== NOTIFICATION METHODS ==============*/

            info: function(title, content, userData){
                //console.log(title, content);
                return this.awesomeNotify('info','info-sign', title, content, userData);
            },

            error: function(title, content, userData){
                return this.awesomeNotify('error', 'remove-sign', title, content, userData);
            },

            success: function(title, content, userData){
                return this.awesomeNotify('success', 'ok-sign', title, content, userData);
            },

            warning: function(title, content, userData){
                return this.awesomeNotify('warning', 'exclamation-sign', title, content, userData);
            },

            awesomeNotify: function(type, icon, title, content, userData){
                /**
                 * Supposed to wrap the makeNotification method for drawing icons using font-awesome
                 * rather than an image.
                 *
                 * Need to find out how I'm going to make the API take either an image
                 * resource, or a font-awesome icon and then display either of them.
                 * Also should probably provide some bits of color, could do the coloring
                 * through classes.
                 */
                // image = '<i class="icon-' + image + '"></i>';
                return this.makeNotification(type, false, icon, title, content, userData);
            },

            notify: function(image, title, content, userData){
                // Wraps the makeNotification method for displaying notifications with images
                // rather than icons
                return this.makeNotification('custom', image, true, title, content, userData);
            },

            makeNotification: function(type, image, icon, title, content, userData){
                var notification = {
                    'type': type,
                    'image': image,
                    'icon': icon,
                    'title': title,
                    'content': content,
                    'timestamp': +new Date(),
                    'userData': userData
                };
                notifications.push(notification);

                if(settings.html5Mode){
                    html5Notify(image, title, content, function(){
                        //console.log("inner on display function");
                    }, function(){
                        //console.log("inner on close function");
                    });
                }
                else{
                    queue.push(notification);
                    $timeout(function removeFromQueueTimeout(){
                        queue.splice(queue.indexOf(notification), 1);
                    }, settings[type].duration);

                }

                this.save();
                return notification;
            },


            /* ============ PERSISTENCE METHODS ============ */

            save: function(){
                // Save all the notifications into localStorage
                // console.log(JSON);
                if(settings.localStorage){
                    localStorage.setItem('$notifications', JSON.stringify(notifications));
                }
                // console.log(localStorage.getItem('$notifications'));
            },

            restore: function(){
                // Load all notifications from localStorage
            },

            clear: function(){
                notifications = [];
                this.save();
            }

        };
    }]).
    directive('notifications', ['$notification', '$compile', function($notification, $compile){
        /**
         *
         * It should also parse the arguments passed to it that specify
         * its position on the screen like "bottom right" and apply those
         * positions as a class to the container element
         *
         * Finally, the directive should have its own controller for
         * handling all of the notifications from the notification service
         */
        //console.log('this is a new directive');
        var html =
            '<div class="dr-notification-wrapper" ng-repeat="noti in queue">' +
                '<div class="dr-notification-close-btn" ng-click="removeNotification(noti)">' +
                    '<i class="glyphicon glyphicon-remove"></i>' +
                '</div>' +
                '<div class="dr-notification noti-back-ground-{{noti.type}}">' +
                    '<div class="dr-notification-image dr-notification-type-{{noti.type}}" ng-switch on="noti.image">' +
                        '<i class="glyphicon glyphicon-{{noti.icon}}" ng-switch-when="false"></i>' +
                        '<img ng-src="{{noti.image}}" ng-switch-default />' +
                    '</div>' +
                    '<div class="dr-notification-content">' +
                        /*'<h3 class="dr-notification-title">{{noti.title}}</h3>' + */
                        '<p class="dr-notification-text">{{noti.content}}</p>' +
                    '</div>' +
                '</div>' +
            '</div>';


        function link(scope, element, attrs){
            var position = attrs.notifications;
            position = position.split(' ');
            element.addClass('dr-notification-container');
            for(var i = 0; i < position.length ; i++){
                element.addClass(position[i]);
            }
        }


        return {
            restrict: 'A',
            scope: {},
            template: html,
            link: link,
            controller: ['$scope', function NotificationsCtrl( $scope ){
                $scope.queue = $notification.getQueue();

                $scope.removeNotification = function(noti){
                    $scope.queue.splice($scope.queue.indexOf(noti), 1);
                };
            }
            ]

        };
    }]);
},{}],17:[function(require,module,exports){
'use strict';

(
    function(angular) {
        return angular
            .module('ngOrderObjectBy', [])
            .filter('orderObjectBy', function() {
                return function (items, field, reverse) {
                    var filtered = [];
                    angular.forEach(items, function(item) {
                        filtered.push(item);
                    });
                    function index(obj, i) {
                        return obj[i];
                    }
                    filtered.sort(function (a, b) {
                        var comparator;
                        var reducedA = field.split('.').reduce(index, a);
                        var reducedB = field.split('.').reduce(index, b);
                        if (reducedA === reducedB) {
                            comparator = 0;
                        } else {
                            comparator = (reducedA > reducedB ? 1 : -1);
                        }
                        return comparator;
                    });
                    if (reverse) {
                        filtered.reverse();
                    }
                    return filtered;
                };
            });
    }
    )(angular);
},{}],18:[function(require,module,exports){
/**
 * Created by argoaava on 13.05.14.
 */


// Module that contains functionality for tab navigation. User must fill 'tabService' with
// available tabs as follows:
//
// app.run(function($rootScope, promiseTracker, $location, tabService) {
//      tabService.setTabs([
//          {"id":"Table1","active" : true},
//          {"id":"Table2","active" : false},
//          {"id":"Table3","active" : false},
//          {"id":"Table4","active" : false},
//          {"id":"Table5","active" : false}]);
// });
//
// then 'TabController' must be set to elements that want to interact with
// tabService.
//
// <ul tabset ng-cloak ng-controller="TabController">
//      <div ng-class="{'invalidTab' : isInvalidTab('Table1')}">
//          <li tab heading="Table 1" active="tabs[getTabIndex('Table1')].active">
//          </li>
//      </div>
// </ul>
//
// or
//
// <div class="animate-show" ng-show="showMenu" style="float:right" ng-controller="TabController">
//      <input type="button" ng-click="previousTab()" value="Prev" class="btn btn-default btn-primary" ng-disabled="getActiveTabIndex() == 0">
//      <input type="button" ng-click="nextTab()" value="Next" class="btn btn-default btn-primary" ng-disabled="getActiveTabIndex() == (tabs.length - 1)"/>
// </div>
//
angular.module('tabs.formTabs', [])
    .service('tabService', function() {
        this.tabs = [];

        this.getTabs = function() {
            return this.tabs;
        }

        this.setTabs = function(tabs) {
            this.tabs = tabs;
        }
    })
    .controller("TabController", function ($scope, $rootScope, $location, $timeout, $anchorScroll, tabService) {
        

        if (tabService.getTabs().length == 0) {
            throw Error("You must configure tabService");
        }

        $scope.tabs = tabService.tabs;

        $scope.goto = function (tab, id){
            for (var i = 0; i < $scope.tabs.length; i++) {
                if ($scope.tabs[i].id == tab) {
                    $scope.tabs[i].active = true;
                } else {
                    $scope.tabs[i].active = false;
                }
            }

            var old = $location.hash();
            $timeout(function() {
                $location.hash(id);
                $anchorScroll();
                $location.hash(old);
            }, 200);
        };

        $scope.getActiveTabIndex = function() {
            for (var i = 0; i < $scope.tabs.length; i++) {
                if ($scope.tabs[i].active == true) {
                    return i;
                }
            }
            return 0;
        };

        $scope.getTabIndex = function(tabId) {
            for (var i = 0; i < $scope.tabs.length; i++) {
                if ($scope.tabs[i].id == tabId) {
                    return i;
                }
            }
            return -1;
        };

        $scope.nextTab = function(){
            var activeTabIndex = $scope.getActiveTabIndex();
            var nextTab = (activeTabIndex + 1 <= $scope.tabs.length)? activeTabIndex+1 : activeTabIndex;
            $scope.goto($scope.tabs[nextTab].id, 'beginning');
        };

        $scope.previousTab = function(){
            var activeTabIndex = $scope.getActiveTabIndex();
            var previousTab = (activeTabIndex - 1 >= 0)? activeTabIndex - 1 : activeTabIndex;
            $scope.goto($scope.tabs[previousTab].id, 'beginning');
        };

        $scope.isInvalidTab = function(tabId) {
            return $scope.submitted && $scope.appForm[tabId].$invalid;
        };
    })
},{}],19:[function(require,module,exports){
/**
 * Created by argoaava on 13.05.14.
 */

//Checks if array is empty.
window.isEmptyArray = function(array) {
    if (!(array instanceof Array)) {
        throw Error("Element not array");
    }

    for (var i = 0; i < array.length; i++) {
        if (!array[i]) {
            continue;
        } else {
            return false;
        }
    }
    return true;
}

// Counts all properties of an object or array.
// Reduces the count by one when object is considered fixed question
// in this case first element of object is prefilled and must not be counted.
window.countNonEmptyProperties = function(objectOrArray, isFixedQuestion) {
    var count = 0;

    if (!(objectOrArray instanceof Array)) {
        count = countObjectProperties(objectOrArray);
    } else {
        for (var i = 0; i < objectOrArray.length; i++) {
            var objectCount = countObjectProperties(objectOrArray[i]);

            if (isFixedQuestion) {
                objectCount -= 1;
            }

            count += objectCount;
        }
    }
    return count;
};

// Counts only
window.countObjectProperties = function(object) {
    var count = 0;

    //For primitives
    if (!(typeof object === 'object') &&
        !(typeof object === 'array')) {
            return 1;
    }

    for (var i in object) {
        if (object.hasOwnProperty(i)
            && !!object[i]
            && (i != '$$hashKey')) {

            if (typeof object[i] === 'object') {
                var objectElementCount = countNonEmptyProperties(object[i]);
                count += objectElementCount;
            } else {
                count++;
            }
        }
    }
    return count;
};

// Clears object or array data. When object is array all other elements except
// first are deleted.
window.clearObject = function(object, keepFirst) {
    if (!(object instanceof Array)) {

        var indexCounter = 0;
        for (var i in object) {
            if (object.hasOwnProperty(i)) {
                if (indexCounter == 0 && keepFirst) {
                } else {
                    object[i] = null;
                }
            }
            indexCounter++;
        }
    } else {
        clearArray(object, keepFirst);
    }

}

// Deletes all other array elements expect first one and
// clears all data from first element.
window.clearArray =function(array, keepRow) {
    for (var i = array.length; i > 0; i--) {
        if (keepRow) {
            clearObject(array[i], keepRow);
        } else {
            array.splice(i, 1);
        }
    }
    clearObject(array[0], keepRow);

    // For arrays that contain primitives. Last element must be
    // left but has to be empty so element is still present after
    // conversion to xml.
    if (!(array[0] instanceof Object)) {
        array[0] = "";
        return;
    }
}

//Clone object.
window.clone = function(obj) {
    // Handle the 3 simple types, and null or undefined
    if (null == obj || "object" != typeof obj) return obj;

    // Handle Date
    if (obj instanceof Date) {
        var copy = new Date();
        copy.setTime(obj.getTime());
        return copy;
    }

    // Handle Array
    if (obj instanceof Array) {
        var copy = [];
        for (var i = 0, len = obj.length; i < len; i++) {
            copy[i] = clone(obj[i]);
        }
        return copy;
    }

    // Handle Object
    if (obj instanceof Object) {
        var copy = {};
        for (var attr in obj) {
            if (obj.hasOwnProperty(attr)) copy[attr] = clone(obj[attr]);
        }
        return copy;
    }

    throw new Error("Unable to copy obj! Its type isn't supported.");
}

// Function is used before saving JSON object back to XML file. When deleting field on the form
// angular sets it to undefined which breaks the order of elements if converted to XML.
window.fixUndefined = function(obj) {
    var isArray = obj instanceof Array;
    for (var j in obj) {
        if (obj.hasOwnProperty(j)) {
            if (typeof(obj[j]) == "object") {
                fixUndefined(obj[j]);
            } else if(!isArray && j != '$$hashkey') {
                if (typeof obj[j] == 'undefined') {
                    obj[j] = null;
                }
            }
        }
    }
}

// helper function for getting query string parameter values. AngularJS solution $location.search() doesn't work in IE8.
window.getParameterByName = function(name) {
    // FIXME - WebQ instance param is not escaped
    var searchArr = window.location.search.split('?');
    var search = '?' + searchArr[searchArr.length - 1];
    var match = new RegExp('[?&]' + name + '=([^&]*)').exec(search);
    return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
};
},{}],20:[function(require,module,exports){
/**
 * @license AngularJS v1.2.16
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
(function(window, angular, undefined) {'use strict';

/* jshint maxlen: false */

/**
 * @ngdoc module
 * @name ngAnimate
 * @description
 *
 * # ngAnimate
 *
 * The `ngAnimate` module provides support for JavaScript, CSS3 transition and CSS3 keyframe animation hooks within existing core and custom directives.
 *
 *
 * <div doc-module-components="ngAnimate"></div>
 *
 * # Usage
 *
 * To see animations in action, all that is required is to define the appropriate CSS classes
 * or to register a JavaScript animation via the myModule.animation() function. The directives that support animation automatically are:
 * `ngRepeat`, `ngInclude`, `ngIf`, `ngSwitch`, `ngShow`, `ngHide`, `ngView` and `ngClass`. Custom directives can take advantage of animation
 * by using the `$animate` service.
 *
 * Below is a more detailed breakdown of the supported animation events provided by pre-existing ng directives:
 *
 * | Directive                                                 | Supported Animations                               |
 * |---------------------------------------------------------- |----------------------------------------------------|
 * | {@link ng.directive:ngRepeat#usage_animations ngRepeat}         | enter, leave and move                              |
 * | {@link ngRoute.directive:ngView#usage_animations ngView}        | enter and leave                                    |
 * | {@link ng.directive:ngInclude#usage_animations ngInclude}       | enter and leave                                    |
 * | {@link ng.directive:ngSwitch#usage_animations ngSwitch}         | enter and leave                                    |
 * | {@link ng.directive:ngIf#usage_animations ngIf}                 | enter and leave                                    |
 * | {@link ng.directive:ngClass#usage_animations ngClass}           | add and remove                                     |
 * | {@link ng.directive:ngShow#usage_animations ngShow & ngHide}    | add and remove (the ng-hide class value)           |
 * | {@link ng.directive:form#usage_animations form}                 | add and remove (dirty, pristine, valid, invalid & all other validations)                |
 * | {@link ng.directive:ngModel#usage_animations ngModel}           | add and remove (dirty, pristine, valid, invalid & all other validations)                |
 *
 * You can find out more information about animations upon visiting each directive page.
 *
 * Below is an example of how to apply animations to a directive that supports animation hooks:
 *
 * ```html
 * <style type="text/css">
 * .slide.ng-enter, .slide.ng-leave {
 *   -webkit-transition:0.5s linear all;
 *   transition:0.5s linear all;
 * }
 *
 * .slide.ng-enter { }        /&#42; starting animations for enter &#42;/
 * .slide.ng-enter-active { } /&#42; terminal animations for enter &#42;/
 * .slide.ng-leave { }        /&#42; starting animations for leave &#42;/
 * .slide.ng-leave-active { } /&#42; terminal animations for leave &#42;/
 * </style>
 *
 * <!--
 * the animate service will automatically add .ng-enter and .ng-leave to the element
 * to trigger the CSS transition/animations
 * -->
 * <ANY class="slide" ng-include="..."></ANY>
 * ```
 *
 * Keep in mind that if an animation is running, any child elements cannot be animated until the parent element's
 * animation has completed.
 *
 * <h2>CSS-defined Animations</h2>
 * The animate service will automatically apply two CSS classes to the animated element and these two CSS classes
 * are designed to contain the start and end CSS styling. Both CSS transitions and keyframe animations are supported
 * and can be used to play along with this naming structure.
 *
 * The following code below demonstrates how to perform animations using **CSS transitions** with Angular:
 *
 * ```html
 * <style type="text/css">
 * /&#42;
 *  The animate class is apart of the element and the ng-enter class
 *  is attached to the element once the enter animation event is triggered
 * &#42;/
 * .reveal-animation.ng-enter {
 *  -webkit-transition: 1s linear all; /&#42; Safari/Chrome &#42;/
 *  transition: 1s linear all; /&#42; All other modern browsers and IE10+ &#42;/
 *
 *  /&#42; The animation preparation code &#42;/
 *  opacity: 0;
 * }
 *
 * /&#42;
 *  Keep in mind that you want to combine both CSS
 *  classes together to avoid any CSS-specificity
 *  conflicts
 * &#42;/
 * .reveal-animation.ng-enter.ng-enter-active {
 *  /&#42; The animation code itself &#42;/
 *  opacity: 1;
 * }
 * </style>
 *
 * <div class="view-container">
 *   <div ng-view class="reveal-animation"></div>
 * </div>
 * ```
 *
 * The following code below demonstrates how to perform animations using **CSS animations** with Angular:
 *
 * ```html
 * <style type="text/css">
 * .reveal-animation.ng-enter {
 *   -webkit-animation: enter_sequence 1s linear; /&#42; Safari/Chrome &#42;/
 *   animation: enter_sequence 1s linear; /&#42; IE10+ and Future Browsers &#42;/
 * }
 * @-webkit-keyframes enter_sequence {
 *   from { opacity:0; }
 *   to { opacity:1; }
 * }
 * @keyframes enter_sequence {
 *   from { opacity:0; }
 *   to { opacity:1; }
 * }
 * </style>
 *
 * <div class="view-container">
 *   <div ng-view class="reveal-animation"></div>
 * </div>
 * ```
 *
 * Both CSS3 animations and transitions can be used together and the animate service will figure out the correct duration and delay timing.
 *
 * Upon DOM mutation, the event class is added first (something like `ng-enter`), then the browser prepares itself to add
 * the active class (in this case `ng-enter-active`) which then triggers the animation. The animation module will automatically
 * detect the CSS code to determine when the animation ends. Once the animation is over then both CSS classes will be
 * removed from the DOM. If a browser does not support CSS transitions or CSS animations then the animation will start and end
 * immediately resulting in a DOM element that is at its final state. This final state is when the DOM element
 * has no CSS transition/animation classes applied to it.
 *
 * <h3>CSS Staggering Animations</h3>
 * A Staggering animation is a collection of animations that are issued with a slight delay in between each successive operation resulting in a
 * curtain-like effect. The ngAnimate module, as of 1.2.0, supports staggering animations and the stagger effect can be
 * performed by creating a **ng-EVENT-stagger** CSS class and attaching that class to the base CSS class used for
 * the animation. The style property expected within the stagger class can either be a **transition-delay** or an
 * **animation-delay** property (or both if your animation contains both transitions and keyframe animations).
 *
 * ```css
 * .my-animation.ng-enter {
 *   /&#42; standard transition code &#42;/
 *   -webkit-transition: 1s linear all;
 *   transition: 1s linear all;
 *   opacity:0;
 * }
 * .my-animation.ng-enter-stagger {
 *   /&#42; this will have a 100ms delay between each successive leave animation &#42;/
 *   -webkit-transition-delay: 0.1s;
 *   transition-delay: 0.1s;
 *
 *   /&#42; in case the stagger doesn't work then these two values
 *    must be set to 0 to avoid an accidental CSS inheritance &#42;/
 *   -webkit-transition-duration: 0s;
 *   transition-duration: 0s;
 * }
 * .my-animation.ng-enter.ng-enter-active {
 *   /&#42; standard transition styles &#42;/
 *   opacity:1;
 * }
 * ```
 *
 * Staggering animations work by default in ngRepeat (so long as the CSS class is defined). Outside of ngRepeat, to use staggering animations
 * on your own, they can be triggered by firing multiple calls to the same event on $animate. However, the restrictions surrounding this
 * are that each of the elements must have the same CSS className value as well as the same parent element. A stagger operation
 * will also be reset if more than 10ms has passed after the last animation has been fired.
 *
 * The following code will issue the **ng-leave-stagger** event on the element provided:
 *
 * ```js
 * var kids = parent.children();
 *
 * $animate.leave(kids[0]); //stagger index=0
 * $animate.leave(kids[1]); //stagger index=1
 * $animate.leave(kids[2]); //stagger index=2
 * $animate.leave(kids[3]); //stagger index=3
 * $animate.leave(kids[4]); //stagger index=4
 *
 * $timeout(function() {
 *   //stagger has reset itself
 *   $animate.leave(kids[5]); //stagger index=0
 *   $animate.leave(kids[6]); //stagger index=1
 * }, 100, false);
 * ```
 *
 * Stagger animations are currently only supported within CSS-defined animations.
 *
 * <h2>JavaScript-defined Animations</h2>
 * In the event that you do not want to use CSS3 transitions or CSS3 animations or if you wish to offer animations on browsers that do not
 * yet support CSS transitions/animations, then you can make use of JavaScript animations defined inside of your AngularJS module.
 *
 * ```js
 * //!annotate="YourApp" Your AngularJS Module|Replace this or ngModule with the module that you used to define your application.
 * var ngModule = angular.module('YourApp', ['ngAnimate']);
 * ngModule.animation('.my-crazy-animation', function() {
 *   return {
 *     enter: function(element, done) {
 *       //run the animation here and call done when the animation is complete
 *       return function(cancelled) {
 *         //this (optional) function will be called when the animation
 *         //completes or when the animation is cancelled (the cancelled
 *         //flag will be set to true if cancelled).
 *       };
 *     },
 *     leave: function(element, done) { },
 *     move: function(element, done) { },
 *
 *     //animation that can be triggered before the class is added
 *     beforeAddClass: function(element, className, done) { },
 *
 *     //animation that can be triggered after the class is added
 *     addClass: function(element, className, done) { },
 *
 *     //animation that can be triggered before the class is removed
 *     beforeRemoveClass: function(element, className, done) { },
 *
 *     //animation that can be triggered after the class is removed
 *     removeClass: function(element, className, done) { }
 *   };
 * });
 * ```
 *
 * JavaScript-defined animations are created with a CSS-like class selector and a collection of events which are set to run
 * a javascript callback function. When an animation is triggered, $animate will look for a matching animation which fits
 * the element's CSS class attribute value and then run the matching animation event function (if found).
 * In other words, if the CSS classes present on the animated element match any of the JavaScript animations then the callback function will
 * be executed. It should be also noted that only simple, single class selectors are allowed (compound class selectors are not supported).
 *
 * Within a JavaScript animation, an object containing various event callback animation functions is expected to be returned.
 * As explained above, these callbacks are triggered based on the animation event. Therefore if an enter animation is run,
 * and the JavaScript animation is found, then the enter callback will handle that animation (in addition to the CSS keyframe animation
 * or transition code that is defined via a stylesheet).
 *
 */

angular.module('ngAnimate', ['ng'])

  /**
   * @ngdoc provider
   * @name $animateProvider
   * @description
   *
   * The `$animateProvider` allows developers to register JavaScript animation event handlers directly inside of a module.
   * When an animation is triggered, the $animate service will query the $animate service to find any animations that match
   * the provided name value.
   *
   * Requires the {@link ngAnimate `ngAnimate`} module to be installed.
   *
   * Please visit the {@link ngAnimate `ngAnimate`} module overview page learn more about how to use animations in your application.
   *
   */

  //this private service is only used within CSS-enabled animations
  //IE8 + IE9 do not support rAF natively, but that is fine since they
  //also don't support transitions and keyframes which means that the code
  //below will never be used by the two browsers.
  .factory('$$animateReflow', ['$$rAF', '$document', function($$rAF, $document) {
    var bod = $document[0].body;
    return function(fn) {
      //the returned function acts as the cancellation function
      return $$rAF(function() {
        //the line below will force the browser to perform a repaint
        //so that all the animated elements within the animation frame
        //will be properly updated and drawn on screen. This is
        //required to perform multi-class CSS based animations with
        //Firefox. DO NOT REMOVE THIS LINE.
        var a = bod.offsetWidth + 1;
        fn();
      });
    };
  }])

  .config(['$provide', '$animateProvider', function($provide, $animateProvider) {
    var noop = angular.noop;
    var forEach = angular.forEach;
    var selectors = $animateProvider.$$selectors;

    var ELEMENT_NODE = 1;
    var NG_ANIMATE_STATE = '$$ngAnimateState';
    var NG_ANIMATE_CLASS_NAME = 'ng-animate';
    var rootAnimateState = {running: true};

    function extractElementNode(element) {
      for(var i = 0; i < element.length; i++) {
        var elm = element[i];
        if(elm.nodeType == ELEMENT_NODE) {
          return elm;
        }
      }
    }

    function stripCommentsFromElement(element) {
      return angular.element(extractElementNode(element));
    }

    function isMatchingElement(elm1, elm2) {
      return extractElementNode(elm1) == extractElementNode(elm2);
    }

    $provide.decorator('$animate', ['$delegate', '$injector', '$sniffer', '$rootElement', '$$asyncCallback', '$rootScope', '$document',
                            function($delegate,   $injector,   $sniffer,   $rootElement,   $$asyncCallback,    $rootScope,   $document) {

      var globalAnimationCounter = 0;
      $rootElement.data(NG_ANIMATE_STATE, rootAnimateState);

      // disable animations during bootstrap, but once we bootstrapped, wait again
      // for another digest until enabling animations. The reason why we digest twice
      // is because all structural animations (enter, leave and move) all perform a
      // post digest operation before animating. If we only wait for a single digest
      // to pass then the structural animation would render its animation on page load.
      // (which is what we're trying to avoid when the application first boots up.)
      $rootScope.$$postDigest(function() {
        $rootScope.$$postDigest(function() {
          rootAnimateState.running = false;
        });
      });

      var classNameFilter = $animateProvider.classNameFilter();
      var isAnimatableClassName = !classNameFilter
              ? function() { return true; }
              : function(className) {
                return classNameFilter.test(className);
              };

      function lookup(name) {
        if (name) {
          var matches = [],
              flagMap = {},
              classes = name.substr(1).split('.');

          //the empty string value is the default animation
          //operation which performs CSS transition and keyframe
          //animations sniffing. This is always included for each
          //element animation procedure if the browser supports
          //transitions and/or keyframe animations. The default
          //animation is added to the top of the list to prevent
          //any previous animations from affecting the element styling
          //prior to the element being animated.
          if ($sniffer.transitions || $sniffer.animations) {
            matches.push($injector.get(selectors['']));
          }

          for(var i=0; i < classes.length; i++) {
            var klass = classes[i],
                selectorFactoryName = selectors[klass];
            if(selectorFactoryName && !flagMap[klass]) {
              matches.push($injector.get(selectorFactoryName));
              flagMap[klass] = true;
            }
          }
          return matches;
        }
      }

      function animationRunner(element, animationEvent, className) {
        //transcluded directives may sometimes fire an animation using only comment nodes
        //best to catch this early on to prevent any animation operations from occurring
        var node = element[0];
        if(!node) {
          return;
        }

        var isSetClassOperation = animationEvent == 'setClass';
        var isClassBased = isSetClassOperation ||
                           animationEvent == 'addClass' ||
                           animationEvent == 'removeClass';

        var classNameAdd, classNameRemove;
        if(angular.isArray(className)) {
          classNameAdd = className[0];
          classNameRemove = className[1];
          className = classNameAdd + ' ' + classNameRemove;
        }

        var currentClassName = element.attr('class');
        var classes = currentClassName + ' ' + className;
        if(!isAnimatableClassName(classes)) {
          return;
        }

        var beforeComplete = noop,
            beforeCancel = [],
            before = [],
            afterComplete = noop,
            afterCancel = [],
            after = [];

        var animationLookup = (' ' + classes).replace(/\s+/g,'.');
        forEach(lookup(animationLookup), function(animationFactory) {
          var created = registerAnimation(animationFactory, animationEvent);
          if(!created && isSetClassOperation) {
            registerAnimation(animationFactory, 'addClass');
            registerAnimation(animationFactory, 'removeClass');
          }
        });

        function registerAnimation(animationFactory, event) {
          var afterFn = animationFactory[event];
          var beforeFn = animationFactory['before' + event.charAt(0).toUpperCase() + event.substr(1)];
          if(afterFn || beforeFn) {
            if(event == 'leave') {
              beforeFn = afterFn;
              //when set as null then animation knows to skip this phase
              afterFn = null;
            }
            after.push({
              event : event, fn : afterFn
            });
            before.push({
              event : event, fn : beforeFn
            });
            return true;
          }
        }

        function run(fns, cancellations, allCompleteFn) {
          var animations = [];
          forEach(fns, function(animation) {
            animation.fn && animations.push(animation);
          });

          var count = 0;
          function afterAnimationComplete(index) {
            if(cancellations) {
              (cancellations[index] || noop)();
              if(++count < animations.length) return;
              cancellations = null;
            }
            allCompleteFn();
          }

          //The code below adds directly to the array in order to work with
          //both sync and async animations. Sync animations are when the done()
          //operation is called right away. DO NOT REFACTOR!
          forEach(animations, function(animation, index) {
            var progress = function() {
              afterAnimationComplete(index);
            };
            switch(animation.event) {
              case 'setClass':
                cancellations.push(animation.fn(element, classNameAdd, classNameRemove, progress));
                break;
              case 'addClass':
                cancellations.push(animation.fn(element, classNameAdd || className,     progress));
                break;
              case 'removeClass':
                cancellations.push(animation.fn(element, classNameRemove || className,  progress));
                break;
              default:
                cancellations.push(animation.fn(element, progress));
                break;
            }
          });

          if(cancellations && cancellations.length === 0) {
            allCompleteFn();
          }
        }

        return {
          node : node,
          event : animationEvent,
          className : className,
          isClassBased : isClassBased,
          isSetClassOperation : isSetClassOperation,
          before : function(allCompleteFn) {
            beforeComplete = allCompleteFn;
            run(before, beforeCancel, function() {
              beforeComplete = noop;
              allCompleteFn();
            });
          },
          after : function(allCompleteFn) {
            afterComplete = allCompleteFn;
            run(after, afterCancel, function() {
              afterComplete = noop;
              allCompleteFn();
            });
          },
          cancel : function() {
            if(beforeCancel) {
              forEach(beforeCancel, function(cancelFn) {
                (cancelFn || noop)(true);
              });
              beforeComplete(true);
            }
            if(afterCancel) {
              forEach(afterCancel, function(cancelFn) {
                (cancelFn || noop)(true);
              });
              afterComplete(true);
            }
          }
        };
      }

      /**
       * @ngdoc service
       * @name $animate
       * @function
       *
       * @description
       * The `$animate` service provides animation detection support while performing DOM operations (enter, leave and move) as well as during addClass and removeClass operations.
       * When any of these operations are run, the $animate service
       * will examine any JavaScript-defined animations (which are defined by using the $animateProvider provider object)
       * as well as any CSS-defined animations against the CSS classes present on the element once the DOM operation is run.
       *
       * The `$animate` service is used behind the scenes with pre-existing directives and animation with these directives
       * will work out of the box without any extra configuration.
       *
       * Requires the {@link ngAnimate `ngAnimate`} module to be installed.
       *
       * Please visit the {@link ngAnimate `ngAnimate`} module overview page learn more about how to use animations in your application.
       *
       */
      return {
        /**
         * @ngdoc method
         * @name $animate#enter
         * @function
         *
         * @description
         * Appends the element to the parentElement element that resides in the document and then runs the enter animation. Once
         * the animation is started, the following CSS classes will be present on the element for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during enter animation:
         *
         * | Animation Step                                                                               | What the element class attribute looks like |
         * |----------------------------------------------------------------------------------------------|---------------------------------------------|
         * | 1. $animate.enter(...) is called                                                             | class="my-animation"                        |
         * | 2. element is inserted into the parentElement element or beside the afterElement element     | class="my-animation"                        |
         * | 3. $animate runs any JavaScript-defined animations on the element                            | class="my-animation ng-animate"             |
         * | 4. the .ng-enter class is added to the element                                               | class="my-animation ng-animate ng-enter"    |
         * | 5. $animate scans the element styles to get the CSS transition/animation duration and delay  | class="my-animation ng-animate ng-enter"    |
         * | 6. $animate waits for 10ms (this performs a reflow)                                          | class="my-animation ng-animate ng-enter"    |
         * | 7. the .ng-enter-active and .ng-animate-active classes are added (this triggers the CSS transition/animation) | class="my-animation ng-animate ng-animate-active ng-enter ng-enter-active" |
         * | 8. $animate waits for X milliseconds for the animation to complete                           | class="my-animation ng-animate ng-animate-active ng-enter ng-enter-active" |
         * | 9. The animation ends and all generated CSS classes are removed from the element             | class="my-animation"                        |
         * | 10. The doneCallback() callback is fired (if provided)                                       | class="my-animation"                        |
         *
         * @param {DOMElement} element the element that will be the focus of the enter animation
         * @param {DOMElement} parentElement the parent element of the element that will be the focus of the enter animation
         * @param {DOMElement} afterElement the sibling element (which is the previous element) of the element that will be the focus of the enter animation
         * @param {function()=} doneCallback the callback function that will be called once the animation is complete
        */
        enter : function(element, parentElement, afterElement, doneCallback) {
          this.enabled(false, element);
          $delegate.enter(element, parentElement, afterElement);
          $rootScope.$$postDigest(function() {
            element = stripCommentsFromElement(element);
            performAnimation('enter', 'ng-enter', element, parentElement, afterElement, noop, doneCallback);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#leave
         * @function
         *
         * @description
         * Runs the leave animation operation and, upon completion, removes the element from the DOM. Once
         * the animation is started, the following CSS classes will be added for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during leave animation:
         *
         * | Animation Step                                                                               | What the element class attribute looks like |
         * |----------------------------------------------------------------------------------------------|---------------------------------------------|
         * | 1. $animate.leave(...) is called                                                             | class="my-animation"                        |
         * | 2. $animate runs any JavaScript-defined animations on the element                            | class="my-animation ng-animate"             |
         * | 3. the .ng-leave class is added to the element                                               | class="my-animation ng-animate ng-leave"    |
         * | 4. $animate scans the element styles to get the CSS transition/animation duration and delay  | class="my-animation ng-animate ng-leave"    |
         * | 5. $animate waits for 10ms (this performs a reflow)                                          | class="my-animation ng-animate ng-leave"    |
         * | 6. the .ng-leave-active and .ng-animate-active classes is added (this triggers the CSS transition/animation) | class="my-animation ng-animate ng-animate-active ng-leave ng-leave-active" |
         * | 7. $animate waits for X milliseconds for the animation to complete                           | class="my-animation ng-animate ng-animate-active ng-leave ng-leave-active" |
         * | 8. The animation ends and all generated CSS classes are removed from the element             | class="my-animation"                        |
         * | 9. The element is removed from the DOM                                                       | ...                                         |
         * | 10. The doneCallback() callback is fired (if provided)                                       | ...                                         |
         *
         * @param {DOMElement} element the element that will be the focus of the leave animation
         * @param {function()=} doneCallback the callback function that will be called once the animation is complete
        */
        leave : function(element, doneCallback) {
          cancelChildAnimations(element);
          this.enabled(false, element);
          $rootScope.$$postDigest(function() {
            performAnimation('leave', 'ng-leave', stripCommentsFromElement(element), null, null, function() {
              $delegate.leave(element);
            }, doneCallback);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#move
         * @function
         *
         * @description
         * Fires the move DOM operation. Just before the animation starts, the animate service will either append it into the parentElement container or
         * add the element directly after the afterElement element if present. Then the move animation will be run. Once
         * the animation is started, the following CSS classes will be added for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during move animation:
         *
         * | Animation Step                                                                               | What the element class attribute looks like |
         * |----------------------------------------------------------------------------------------------|---------------------------------------------|
         * | 1. $animate.move(...) is called                                                              | class="my-animation"                        |
         * | 2. element is moved into the parentElement element or beside the afterElement element        | class="my-animation"                        |
         * | 3. $animate runs any JavaScript-defined animations on the element                            | class="my-animation ng-animate"             |
         * | 4. the .ng-move class is added to the element                                                | class="my-animation ng-animate ng-move"     |
         * | 5. $animate scans the element styles to get the CSS transition/animation duration and delay  | class="my-animation ng-animate ng-move"     |
         * | 6. $animate waits for 10ms (this performs a reflow)                                          | class="my-animation ng-animate ng-move"     |
         * | 7. the .ng-move-active and .ng-animate-active classes is added (this triggers the CSS transition/animation) | class="my-animation ng-animate ng-animate-active ng-move ng-move-active" |
         * | 8. $animate waits for X milliseconds for the animation to complete                           | class="my-animation ng-animate ng-animate-active ng-move ng-move-active" |
         * | 9. The animation ends and all generated CSS classes are removed from the element             | class="my-animation"                        |
         * | 10. The doneCallback() callback is fired (if provided)                                       | class="my-animation"                        |
         *
         * @param {DOMElement} element the element that will be the focus of the move animation
         * @param {DOMElement} parentElement the parentElement element of the element that will be the focus of the move animation
         * @param {DOMElement} afterElement the sibling element (which is the previous element) of the element that will be the focus of the move animation
         * @param {function()=} doneCallback the callback function that will be called once the animation is complete
        */
        move : function(element, parentElement, afterElement, doneCallback) {
          cancelChildAnimations(element);
          this.enabled(false, element);
          $delegate.move(element, parentElement, afterElement);
          $rootScope.$$postDigest(function() {
            element = stripCommentsFromElement(element);
            performAnimation('move', 'ng-move', element, parentElement, afterElement, noop, doneCallback);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#addClass
         *
         * @description
         * Triggers a custom animation event based off the className variable and then attaches the className value to the element as a CSS class.
         * Unlike the other animation methods, the animate service will suffix the className value with {@type -add} in order to provide
         * the animate service the setup and active CSS classes in order to trigger the animation (this will be skipped if no CSS transitions
         * or keyframes are defined on the -add or base CSS class).
         *
         * Below is a breakdown of each step that occurs during addClass animation:
         *
         * | Animation Step                                                                                 | What the element class attribute looks like |
         * |------------------------------------------------------------------------------------------------|---------------------------------------------|
         * | 1. $animate.addClass(element, 'super') is called                                               | class="my-animation"                        |
         * | 2. $animate runs any JavaScript-defined animations on the element                              | class="my-animation ng-animate"             |
         * | 3. the .super-add class are added to the element                                               | class="my-animation ng-animate super-add"   |
         * | 4. $animate scans the element styles to get the CSS transition/animation duration and delay    | class="my-animation ng-animate super-add"   |
         * | 5. $animate waits for 10ms (this performs a reflow)                                            | class="my-animation ng-animate super-add"   |
         * | 6. the .super, .super-add-active and .ng-animate-active classes are added (this triggers the CSS transition/animation) | class="my-animation ng-animate ng-animate-active super super-add super-add-active"          |
         * | 7. $animate waits for X milliseconds for the animation to complete                             | class="my-animation super super-add super-add-active"  |
         * | 8. The animation ends and all generated CSS classes are removed from the element               | class="my-animation super"                  |
         * | 9. The super class is kept on the element                                                      | class="my-animation super"                  |
         * | 10. The doneCallback() callback is fired (if provided)                                         | class="my-animation super"                  |
         *
         * @param {DOMElement} element the element that will be animated
         * @param {string} className the CSS class that will be added to the element and then animated
         * @param {function()=} doneCallback the callback function that will be called once the animation is complete
        */
        addClass : function(element, className, doneCallback) {
          element = stripCommentsFromElement(element);
          performAnimation('addClass', className, element, null, null, function() {
            $delegate.addClass(element, className);
          }, doneCallback);
        },

        /**
         * @ngdoc method
         * @name $animate#removeClass
         *
         * @description
         * Triggers a custom animation event based off the className variable and then removes the CSS class provided by the className value
         * from the element. Unlike the other animation methods, the animate service will suffix the className value with {@type -remove} in
         * order to provide the animate service the setup and active CSS classes in order to trigger the animation (this will be skipped if
         * no CSS transitions or keyframes are defined on the -remove or base CSS classes).
         *
         * Below is a breakdown of each step that occurs during removeClass animation:
         *
         * | Animation Step                                                                                | What the element class attribute looks like     |
         * |-----------------------------------------------------------------------------------------------|---------------------------------------------|
         * | 1. $animate.removeClass(element, 'super') is called                                           | class="my-animation super"                  |
         * | 2. $animate runs any JavaScript-defined animations on the element                             | class="my-animation super ng-animate"       |
         * | 3. the .super-remove class are added to the element                                           | class="my-animation super ng-animate super-remove"|
         * | 4. $animate scans the element styles to get the CSS transition/animation duration and delay   | class="my-animation super ng-animate super-remove"   |
         * | 5. $animate waits for 10ms (this performs a reflow)                                           | class="my-animation super ng-animate super-remove"   |
         * | 6. the .super-remove-active and .ng-animate-active classes are added and .super is removed (this triggers the CSS transition/animation) | class="my-animation ng-animate ng-animate-active super-remove super-remove-active"          |
         * | 7. $animate waits for X milliseconds for the animation to complete                            | class="my-animation ng-animate ng-animate-active super-remove super-remove-active"   |
         * | 8. The animation ends and all generated CSS classes are removed from the element              | class="my-animation"                        |
         * | 9. The doneCallback() callback is fired (if provided)                                         | class="my-animation"                        |
         *
         *
         * @param {DOMElement} element the element that will be animated
         * @param {string} className the CSS class that will be animated and then removed from the element
         * @param {function()=} doneCallback the callback function that will be called once the animation is complete
        */
        removeClass : function(element, className, doneCallback) {
          element = stripCommentsFromElement(element);
          performAnimation('removeClass', className, element, null, null, function() {
            $delegate.removeClass(element, className);
          }, doneCallback);
        },

          /**
           *
           * @ngdoc function
           * @name $animate#setClass
           * @function
           * @description Adds and/or removes the given CSS classes to and from the element.
           * Once complete, the done() callback will be fired (if provided).
           * @param {DOMElement} element the element which will it's CSS classes changed
           *   removed from it
           * @param {string} add the CSS classes which will be added to the element
           * @param {string} remove the CSS class which will be removed from the element
           * @param {Function=} done the callback function (if provided) that will be fired after the
           *   CSS classes have been set on the element
           */
        setClass : function(element, add, remove, doneCallback) {
          element = stripCommentsFromElement(element);
          performAnimation('setClass', [add, remove], element, null, null, function() {
            $delegate.setClass(element, add, remove);
          }, doneCallback);
        },

        /**
         * @ngdoc method
         * @name $animate#enabled
         * @function
         *
         * @param {boolean=} value If provided then set the animation on or off.
         * @param {DOMElement=} element If provided then the element will be used to represent the enable/disable operation
         * @return {boolean} Current animation state.
         *
         * @description
         * Globally enables/disables animations.
         *
        */
        enabled : function(value, element) {
          switch(arguments.length) {
            case 2:
              if(value) {
                cleanup(element);
              } else {
                var data = element.data(NG_ANIMATE_STATE) || {};
                data.disabled = true;
                element.data(NG_ANIMATE_STATE, data);
              }
            break;

            case 1:
              rootAnimateState.disabled = !value;
            break;

            default:
              value = !rootAnimateState.disabled;
            break;
          }
          return !!value;
         }
      };

      /*
        all animations call this shared animation triggering function internally.
        The animationEvent variable refers to the JavaScript animation event that will be triggered
        and the className value is the name of the animation that will be applied within the
        CSS code. Element, parentElement and afterElement are provided DOM elements for the animation
        and the onComplete callback will be fired once the animation is fully complete.
      */
      function performAnimation(animationEvent, className, element, parentElement, afterElement, domOperation, doneCallback) {

        var runner = animationRunner(element, animationEvent, className);
        if(!runner) {
          fireDOMOperation();
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          closeAnimation();
          return;
        }

        className = runner.className;
        var elementEvents = angular.element._data(runner.node);
        elementEvents = elementEvents && elementEvents.events;

        if (!parentElement) {
          parentElement = afterElement ? afterElement.parent() : element.parent();
        }

        var ngAnimateState  = element.data(NG_ANIMATE_STATE) || {};
        var runningAnimations     = ngAnimateState.active || {};
        var totalActiveAnimations = ngAnimateState.totalActive || 0;
        var lastAnimation         = ngAnimateState.last;

        //only allow animations if the currently running animation is not structural
        //or if there is no animation running at all
        var skipAnimations = runner.isClassBased ?
          ngAnimateState.disabled || (lastAnimation && !lastAnimation.isClassBased) :
          false;

        //skip the animation if animations are disabled, a parent is already being animated,
        //the element is not currently attached to the document body or then completely close
        //the animation if any matching animations are not found at all.
        //NOTE: IE8 + IE9 should close properly (run closeAnimation()) in case an animation was found.
        if (skipAnimations || animationsDisabled(element, parentElement)) {
          fireDOMOperation();
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          closeAnimation();
          return;
        }

        var skipAnimation = false;
        if(totalActiveAnimations > 0) {
          var animationsToCancel = [];
          if(!runner.isClassBased) {
            if(animationEvent == 'leave' && runningAnimations['ng-leave']) {
              skipAnimation = true;
            } else {
              //cancel all animations when a structural animation takes place
              for(var klass in runningAnimations) {
                animationsToCancel.push(runningAnimations[klass]);
                cleanup(element, klass);
              }
              runningAnimations = {};
              totalActiveAnimations = 0;
            }
          } else if(lastAnimation.event == 'setClass') {
            animationsToCancel.push(lastAnimation);
            cleanup(element, className);
          }
          else if(runningAnimations[className]) {
            var current = runningAnimations[className];
            if(current.event == animationEvent) {
              skipAnimation = true;
            } else {
              animationsToCancel.push(current);
              cleanup(element, className);
            }
          }

          if(animationsToCancel.length > 0) {
            forEach(animationsToCancel, function(operation) {
              operation.cancel();
            });
          }
        }

        if(runner.isClassBased && !runner.isSetClassOperation && !skipAnimation) {
          skipAnimation = (animationEvent == 'addClass') == element.hasClass(className); //opposite of XOR
        }

        if(skipAnimation) {
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          fireDoneCallbackAsync();
          return;
        }

        if(animationEvent == 'leave') {
          //there's no need to ever remove the listener since the element
          //will be removed (destroyed) after the leave animation ends or
          //is cancelled midway
          element.one('$destroy', function(e) {
            var element = angular.element(this);
            var state = element.data(NG_ANIMATE_STATE);
            if(state) {
              var activeLeaveAnimation = state.active['ng-leave'];
              if(activeLeaveAnimation) {
                activeLeaveAnimation.cancel();
                cleanup(element, 'ng-leave');
              }
            }
          });
        }

        //the ng-animate class does nothing, but it's here to allow for
        //parent animations to find and cancel child animations when needed
        element.addClass(NG_ANIMATE_CLASS_NAME);

        var localAnimationCount = globalAnimationCounter++;
        totalActiveAnimations++;
        runningAnimations[className] = runner;

        element.data(NG_ANIMATE_STATE, {
          last : runner,
          active : runningAnimations,
          index : localAnimationCount,
          totalActive : totalActiveAnimations
        });

        //first we run the before animations and when all of those are complete
        //then we perform the DOM operation and run the next set of animations
        fireBeforeCallbackAsync();
        runner.before(function(cancelled) {
          var data = element.data(NG_ANIMATE_STATE);
          cancelled = cancelled ||
                        !data || !data.active[className] ||
                        (runner.isClassBased && data.active[className].event != animationEvent);

          fireDOMOperation();
          if(cancelled === true) {
            closeAnimation();
          } else {
            fireAfterCallbackAsync();
            runner.after(closeAnimation);
          }
        });

        function fireDOMCallback(animationPhase) {
          var eventName = '$animate:' + animationPhase;
          if(elementEvents && elementEvents[eventName] && elementEvents[eventName].length > 0) {
            $$asyncCallback(function() {
              element.triggerHandler(eventName, {
                event : animationEvent,
                className : className
              });
            });
          }
        }

        function fireBeforeCallbackAsync() {
          fireDOMCallback('before');
        }

        function fireAfterCallbackAsync() {
          fireDOMCallback('after');
        }

        function fireDoneCallbackAsync() {
          fireDOMCallback('close');
          if(doneCallback) {
            $$asyncCallback(function() {
              doneCallback();
            });
          }
        }

        //it is less complicated to use a flag than managing and canceling
        //timeouts containing multiple callbacks.
        function fireDOMOperation() {
          if(!fireDOMOperation.hasBeenRun) {
            fireDOMOperation.hasBeenRun = true;
            domOperation();
          }
        }

        function closeAnimation() {
          if(!closeAnimation.hasBeenRun) {
            closeAnimation.hasBeenRun = true;
            var data = element.data(NG_ANIMATE_STATE);
            if(data) {
              /* only structural animations wait for reflow before removing an
                 animation, but class-based animations don't. An example of this
                 failing would be when a parent HTML tag has a ng-class attribute
                 causing ALL directives below to skip animations during the digest */
              if(runner && runner.isClassBased) {
                cleanup(element, className);
              } else {
                $$asyncCallback(function() {
                  var data = element.data(NG_ANIMATE_STATE) || {};
                  if(localAnimationCount == data.index) {
                    cleanup(element, className, animationEvent);
                  }
                });
                element.data(NG_ANIMATE_STATE, data);
              }
            }
            fireDoneCallbackAsync();
          }
        }
      }

      function cancelChildAnimations(element) {
        var node = extractElementNode(element);
        if (node) {
          var nodes = angular.isFunction(node.getElementsByClassName) ?
            node.getElementsByClassName(NG_ANIMATE_CLASS_NAME) :
            node.querySelectorAll('.' + NG_ANIMATE_CLASS_NAME);
          forEach(nodes, function(element) {
            element = angular.element(element);
            var data = element.data(NG_ANIMATE_STATE);
            if(data && data.active) {
              forEach(data.active, function(runner) {
                runner.cancel();
              });
            }
          });
        }
      }

      function cleanup(element, className) {
        if(isMatchingElement(element, $rootElement)) {
          if(!rootAnimateState.disabled) {
            rootAnimateState.running = false;
            rootAnimateState.structural = false;
          }
        } else if(className) {
          var data = element.data(NG_ANIMATE_STATE) || {};

          var removeAnimations = className === true;
          if(!removeAnimations && data.active && data.active[className]) {
            data.totalActive--;
            delete data.active[className];
          }

          if(removeAnimations || !data.totalActive) {
            element.removeClass(NG_ANIMATE_CLASS_NAME);
            element.removeData(NG_ANIMATE_STATE);
          }
        }
      }

      function animationsDisabled(element, parentElement) {
        if (rootAnimateState.disabled) return true;

        if(isMatchingElement(element, $rootElement)) {
          return rootAnimateState.disabled || rootAnimateState.running;
        }

        do {
          //the element did not reach the root element which means that it
          //is not apart of the DOM. Therefore there is no reason to do
          //any animations on it
          if(parentElement.length === 0) break;

          var isRoot = isMatchingElement(parentElement, $rootElement);
          var state = isRoot ? rootAnimateState : parentElement.data(NG_ANIMATE_STATE);
          var result = state && (!!state.disabled || state.running || state.totalActive > 0);
          if(isRoot || result) {
            return result;
          }

          if(isRoot) return true;
        }
        while(parentElement = parentElement.parent());

        return true;
      }
    }]);

    $animateProvider.register('', ['$window', '$sniffer', '$timeout', '$$animateReflow',
                           function($window,   $sniffer,   $timeout,   $$animateReflow) {
      // Detect proper transitionend/animationend event names.
      var CSS_PREFIX = '', TRANSITION_PROP, TRANSITIONEND_EVENT, ANIMATION_PROP, ANIMATIONEND_EVENT;

      // If unprefixed events are not supported but webkit-prefixed are, use the latter.
      // Otherwise, just use W3C names, browsers not supporting them at all will just ignore them.
      // Note: Chrome implements `window.onwebkitanimationend` and doesn't implement `window.onanimationend`
      // but at the same time dispatches the `animationend` event and not `webkitAnimationEnd`.
      // Register both events in case `window.onanimationend` is not supported because of that,
      // do the same for `transitionend` as Safari is likely to exhibit similar behavior.
      // Also, the only modern browser that uses vendor prefixes for transitions/keyframes is webkit
      // therefore there is no reason to test anymore for other vendor prefixes: http://caniuse.com/#search=transition
      if (window.ontransitionend === undefined && window.onwebkittransitionend !== undefined) {
        CSS_PREFIX = '-webkit-';
        TRANSITION_PROP = 'WebkitTransition';
        TRANSITIONEND_EVENT = 'webkitTransitionEnd transitionend';
      } else {
        TRANSITION_PROP = 'transition';
        TRANSITIONEND_EVENT = 'transitionend';
      }

      if (window.onanimationend === undefined && window.onwebkitanimationend !== undefined) {
        CSS_PREFIX = '-webkit-';
        ANIMATION_PROP = 'WebkitAnimation';
        ANIMATIONEND_EVENT = 'webkitAnimationEnd animationend';
      } else {
        ANIMATION_PROP = 'animation';
        ANIMATIONEND_EVENT = 'animationend';
      }

      var DURATION_KEY = 'Duration';
      var PROPERTY_KEY = 'Property';
      var DELAY_KEY = 'Delay';
      var ANIMATION_ITERATION_COUNT_KEY = 'IterationCount';
      var NG_ANIMATE_PARENT_KEY = '$$ngAnimateKey';
      var NG_ANIMATE_CSS_DATA_KEY = '$$ngAnimateCSS3Data';
      var NG_ANIMATE_BLOCK_CLASS_NAME = 'ng-animate-block-transitions';
      var ELAPSED_TIME_MAX_DECIMAL_PLACES = 3;
      var CLOSING_TIME_BUFFER = 1.5;
      var ONE_SECOND = 1000;

      var lookupCache = {};
      var parentCounter = 0;
      var animationReflowQueue = [];
      var cancelAnimationReflow;
      function afterReflow(element, callback) {
        if(cancelAnimationReflow) {
          cancelAnimationReflow();
        }
        animationReflowQueue.push(callback);
        cancelAnimationReflow = $$animateReflow(function() {
          forEach(animationReflowQueue, function(fn) {
            fn();
          });

          animationReflowQueue = [];
          cancelAnimationReflow = null;
          lookupCache = {};
        });
      }

      var closingTimer = null;
      var closingTimestamp = 0;
      var animationElementQueue = [];
      function animationCloseHandler(element, totalTime) {
        var node = extractElementNode(element);
        element = angular.element(node);

        //this item will be garbage collected by the closing
        //animation timeout
        animationElementQueue.push(element);

        //but it may not need to cancel out the existing timeout
        //if the timestamp is less than the previous one
        var futureTimestamp = Date.now() + totalTime;
        if(futureTimestamp <= closingTimestamp) {
          return;
        }

        $timeout.cancel(closingTimer);

        closingTimestamp = futureTimestamp;
        closingTimer = $timeout(function() {
          closeAllAnimations(animationElementQueue);
          animationElementQueue = [];
        }, totalTime, false);
      }

      function closeAllAnimations(elements) {
        forEach(elements, function(element) {
          var elementData = element.data(NG_ANIMATE_CSS_DATA_KEY);
          if(elementData) {
            (elementData.closeAnimationFn || noop)();
          }
        });
      }

      function getElementAnimationDetails(element, cacheKey) {
        var data = cacheKey ? lookupCache[cacheKey] : null;
        if(!data) {
          var transitionDuration = 0;
          var transitionDelay = 0;
          var animationDuration = 0;
          var animationDelay = 0;
          var transitionDelayStyle;
          var animationDelayStyle;
          var transitionDurationStyle;
          var transitionPropertyStyle;

          //we want all the styles defined before and after
          forEach(element, function(element) {
            if (element.nodeType == ELEMENT_NODE) {
              var elementStyles = $window.getComputedStyle(element) || {};

              transitionDurationStyle = elementStyles[TRANSITION_PROP + DURATION_KEY];

              transitionDuration = Math.max(parseMaxTime(transitionDurationStyle), transitionDuration);

              transitionPropertyStyle = elementStyles[TRANSITION_PROP + PROPERTY_KEY];

              transitionDelayStyle = elementStyles[TRANSITION_PROP + DELAY_KEY];

              transitionDelay  = Math.max(parseMaxTime(transitionDelayStyle), transitionDelay);

              animationDelayStyle = elementStyles[ANIMATION_PROP + DELAY_KEY];

              animationDelay   = Math.max(parseMaxTime(animationDelayStyle), animationDelay);

              var aDuration  = parseMaxTime(elementStyles[ANIMATION_PROP + DURATION_KEY]);

              if(aDuration > 0) {
                aDuration *= parseInt(elementStyles[ANIMATION_PROP + ANIMATION_ITERATION_COUNT_KEY], 10) || 1;
              }

              animationDuration = Math.max(aDuration, animationDuration);
            }
          });
          data = {
            total : 0,
            transitionPropertyStyle: transitionPropertyStyle,
            transitionDurationStyle: transitionDurationStyle,
            transitionDelayStyle: transitionDelayStyle,
            transitionDelay: transitionDelay,
            transitionDuration: transitionDuration,
            animationDelayStyle: animationDelayStyle,
            animationDelay: animationDelay,
            animationDuration: animationDuration
          };
          if(cacheKey) {
            lookupCache[cacheKey] = data;
          }
        }
        return data;
      }

      function parseMaxTime(str) {
        var maxValue = 0;
        var values = angular.isString(str) ?
          str.split(/\s*,\s*/) :
          [];
        forEach(values, function(value) {
          maxValue = Math.max(parseFloat(value) || 0, maxValue);
        });
        return maxValue;
      }

      function getCacheKey(element) {
        var parentElement = element.parent();
        var parentID = parentElement.data(NG_ANIMATE_PARENT_KEY);
        if(!parentID) {
          parentElement.data(NG_ANIMATE_PARENT_KEY, ++parentCounter);
          parentID = parentCounter;
        }
        return parentID + '-' + extractElementNode(element).getAttribute('class');
      }

      function animateSetup(animationEvent, element, className, calculationDecorator) {
        var cacheKey = getCacheKey(element);
        var eventCacheKey = cacheKey + ' ' + className;
        var itemIndex = lookupCache[eventCacheKey] ? ++lookupCache[eventCacheKey].total : 0;

        var stagger = {};
        if(itemIndex > 0) {
          var staggerClassName = className + '-stagger';
          var staggerCacheKey = cacheKey + ' ' + staggerClassName;
          var applyClasses = !lookupCache[staggerCacheKey];

          applyClasses && element.addClass(staggerClassName);

          stagger = getElementAnimationDetails(element, staggerCacheKey);

          applyClasses && element.removeClass(staggerClassName);
        }

        /* the animation itself may need to add/remove special CSS classes
         * before calculating the anmation styles */
        calculationDecorator = calculationDecorator ||
                               function(fn) { return fn(); };

        element.addClass(className);

        var formerData = element.data(NG_ANIMATE_CSS_DATA_KEY) || {};

        var timings = calculationDecorator(function() {
          return getElementAnimationDetails(element, eventCacheKey);
        });

        var transitionDuration = timings.transitionDuration;
        var animationDuration = timings.animationDuration;
        if(transitionDuration === 0 && animationDuration === 0) {
          element.removeClass(className);
          return false;
        }

        element.data(NG_ANIMATE_CSS_DATA_KEY, {
          running : formerData.running || 0,
          itemIndex : itemIndex,
          stagger : stagger,
          timings : timings,
          closeAnimationFn : noop
        });

        //temporarily disable the transition so that the enter styles
        //don't animate twice (this is here to avoid a bug in Chrome/FF).
        var isCurrentlyAnimating = formerData.running > 0 || animationEvent == 'setClass';
        if(transitionDuration > 0) {
          blockTransitions(element, className, isCurrentlyAnimating);
        }

        //staggering keyframe animations work by adjusting the `animation-delay` CSS property
        //on the given element, however, the delay value can only calculated after the reflow
        //since by that time $animate knows how many elements are being animated. Therefore,
        //until the reflow occurs the element needs to be blocked (where the keyframe animation
        //is set to `none 0s`). This blocking mechanism should only be set for when a stagger
        //animation is detected and when the element item index is greater than 0.
        if(animationDuration > 0 && stagger.animationDelay > 0 && stagger.animationDuration === 0) {
          blockKeyframeAnimations(element);
        }

        return true;
      }

      function isStructuralAnimation(className) {
        return className == 'ng-enter' || className == 'ng-move' || className == 'ng-leave';
      }

      function blockTransitions(element, className, isAnimating) {
        if(isStructuralAnimation(className) || !isAnimating) {
          extractElementNode(element).style[TRANSITION_PROP + PROPERTY_KEY] = 'none';
        } else {
          element.addClass(NG_ANIMATE_BLOCK_CLASS_NAME);
        }
      }

      function blockKeyframeAnimations(element) {
        extractElementNode(element).style[ANIMATION_PROP] = 'none 0s';
      }

      function unblockTransitions(element, className) {
        var prop = TRANSITION_PROP + PROPERTY_KEY;
        var node = extractElementNode(element);
        if(node.style[prop] && node.style[prop].length > 0) {
          node.style[prop] = '';
        }
        element.removeClass(NG_ANIMATE_BLOCK_CLASS_NAME);
      }

      function unblockKeyframeAnimations(element) {
        var prop = ANIMATION_PROP;
        var node = extractElementNode(element);
        if(node.style[prop] && node.style[prop].length > 0) {
          node.style[prop] = '';
        }
      }

      function animateRun(animationEvent, element, className, activeAnimationComplete) {
        var node = extractElementNode(element);
        var elementData = element.data(NG_ANIMATE_CSS_DATA_KEY);
        if(node.getAttribute('class').indexOf(className) == -1 || !elementData) {
          activeAnimationComplete();
          return;
        }

        var activeClassName = '';
        forEach(className.split(' '), function(klass, i) {
          activeClassName += (i > 0 ? ' ' : '') + klass + '-active';
        });

        var stagger = elementData.stagger;
        var timings = elementData.timings;
        var itemIndex = elementData.itemIndex;
        var maxDuration = Math.max(timings.transitionDuration, timings.animationDuration);
        var maxDelay = Math.max(timings.transitionDelay, timings.animationDelay);
        var maxDelayTime = maxDelay * ONE_SECOND;

        var startTime = Date.now();
        var css3AnimationEvents = ANIMATIONEND_EVENT + ' ' + TRANSITIONEND_EVENT;

        var style = '', appliedStyles = [];
        if(timings.transitionDuration > 0) {
          var propertyStyle = timings.transitionPropertyStyle;
          if(propertyStyle.indexOf('all') == -1) {
            style += CSS_PREFIX + 'transition-property: ' + propertyStyle + ';';
            style += CSS_PREFIX + 'transition-duration: ' + timings.transitionDurationStyle + ';';
            appliedStyles.push(CSS_PREFIX + 'transition-property');
            appliedStyles.push(CSS_PREFIX + 'transition-duration');
          }
        }

        if(itemIndex > 0) {
          if(stagger.transitionDelay > 0 && stagger.transitionDuration === 0) {
            var delayStyle = timings.transitionDelayStyle;
            style += CSS_PREFIX + 'transition-delay: ' +
                     prepareStaggerDelay(delayStyle, stagger.transitionDelay, itemIndex) + '; ';
            appliedStyles.push(CSS_PREFIX + 'transition-delay');
          }

          if(stagger.animationDelay > 0 && stagger.animationDuration === 0) {
            style += CSS_PREFIX + 'animation-delay: ' +
                     prepareStaggerDelay(timings.animationDelayStyle, stagger.animationDelay, itemIndex) + '; ';
            appliedStyles.push(CSS_PREFIX + 'animation-delay');
          }
        }

        if(appliedStyles.length > 0) {
          //the element being animated may sometimes contain comment nodes in
          //the jqLite object, so we're safe to use a single variable to house
          //the styles since there is always only one element being animated
          var oldStyle = node.getAttribute('style') || '';
          node.setAttribute('style', oldStyle + ' ' + style);
        }

        element.on(css3AnimationEvents, onAnimationProgress);
        element.addClass(activeClassName);
        elementData.closeAnimationFn = function() {
          onEnd();
          activeAnimationComplete();
        };

        var staggerTime       = itemIndex * (Math.max(stagger.animationDelay, stagger.transitionDelay) || 0);
        var animationTime     = (maxDelay + maxDuration) * CLOSING_TIME_BUFFER;
        var totalTime         = (staggerTime + animationTime) * ONE_SECOND;

        elementData.running++;
        animationCloseHandler(element, totalTime);
        return onEnd;

        // This will automatically be called by $animate so
        // there is no need to attach this internally to the
        // timeout done method.
        function onEnd(cancelled) {
          element.off(css3AnimationEvents, onAnimationProgress);
          element.removeClass(activeClassName);
          animateClose(element, className);
          var node = extractElementNode(element);
          for (var i in appliedStyles) {
            node.style.removeProperty(appliedStyles[i]);
          }
        }

        function onAnimationProgress(event) {
          event.stopPropagation();
          var ev = event.originalEvent || event;
          var timeStamp = ev.$manualTimeStamp || ev.timeStamp || Date.now();

          /* Firefox (or possibly just Gecko) likes to not round values up
           * when a ms measurement is used for the animation */
          var elapsedTime = parseFloat(ev.elapsedTime.toFixed(ELAPSED_TIME_MAX_DECIMAL_PLACES));

          /* $manualTimeStamp is a mocked timeStamp value which is set
           * within browserTrigger(). This is only here so that tests can
           * mock animations properly. Real events fallback to event.timeStamp,
           * or, if they don't, then a timeStamp is automatically created for them.
           * We're checking to see if the timeStamp surpasses the expected delay,
           * but we're using elapsedTime instead of the timeStamp on the 2nd
           * pre-condition since animations sometimes close off early */
          if(Math.max(timeStamp - startTime, 0) >= maxDelayTime && elapsedTime >= maxDuration) {
            activeAnimationComplete();
          }
        }
      }

      function prepareStaggerDelay(delayStyle, staggerDelay, index) {
        var style = '';
        forEach(delayStyle.split(','), function(val, i) {
          style += (i > 0 ? ',' : '') +
                   (index * staggerDelay + parseInt(val, 10)) + 's';
        });
        return style;
      }

      function animateBefore(animationEvent, element, className, calculationDecorator) {
        if(animateSetup(animationEvent, element, className, calculationDecorator)) {
          return function(cancelled) {
            cancelled && animateClose(element, className);
          };
        }
      }

      function animateAfter(animationEvent, element, className, afterAnimationComplete) {
        if(element.data(NG_ANIMATE_CSS_DATA_KEY)) {
          return animateRun(animationEvent, element, className, afterAnimationComplete);
        } else {
          animateClose(element, className);
          afterAnimationComplete();
        }
      }

      function animate(animationEvent, element, className, animationComplete) {
        //If the animateSetup function doesn't bother returning a
        //cancellation function then it means that there is no animation
        //to perform at all
        var preReflowCancellation = animateBefore(animationEvent, element, className);
        if(!preReflowCancellation) {
          animationComplete();
          return;
        }

        //There are two cancellation functions: one is before the first
        //reflow animation and the second is during the active state
        //animation. The first function will take care of removing the
        //data from the element which will not make the 2nd animation
        //happen in the first place
        var cancel = preReflowCancellation;
        afterReflow(element, function() {
          unblockTransitions(element, className);
          unblockKeyframeAnimations(element);
          //once the reflow is complete then we point cancel to
          //the new cancellation function which will remove all of the
          //animation properties from the active animation
          cancel = animateAfter(animationEvent, element, className, animationComplete);
        });

        return function(cancelled) {
          (cancel || noop)(cancelled);
        };
      }

      function animateClose(element, className) {
        element.removeClass(className);
        var data = element.data(NG_ANIMATE_CSS_DATA_KEY);
        if(data) {
          if(data.running) {
            data.running--;
          }
          if(!data.running || data.running === 0) {
            element.removeData(NG_ANIMATE_CSS_DATA_KEY);
          }
        }
      }

      return {
        enter : function(element, animationCompleted) {
          return animate('enter', element, 'ng-enter', animationCompleted);
        },

        leave : function(element, animationCompleted) {
          return animate('leave', element, 'ng-leave', animationCompleted);
        },

        move : function(element, animationCompleted) {
          return animate('move', element, 'ng-move', animationCompleted);
        },

        beforeSetClass : function(element, add, remove, animationCompleted) {
          var className = suffixClasses(remove, '-remove') + ' ' +
                          suffixClasses(add, '-add');
          var cancellationMethod = animateBefore('setClass', element, className, function(fn) {
            /* when classes are removed from an element then the transition style
             * that is applied is the transition defined on the element without the
             * CSS class being there. This is how CSS3 functions outside of ngAnimate.
             * http://plnkr.co/edit/j8OzgTNxHTb4n3zLyjGW?p=preview */
            var klass = element.attr('class');
            element.removeClass(remove);
            element.addClass(add);
            var timings = fn();
            element.attr('class', klass);
            return timings;
          });

          if(cancellationMethod) {
            afterReflow(element, function() {
              unblockTransitions(element, className);
              unblockKeyframeAnimations(element);
              animationCompleted();
            });
            return cancellationMethod;
          }
          animationCompleted();
        },

        beforeAddClass : function(element, className, animationCompleted) {
          var cancellationMethod = animateBefore('addClass', element, suffixClasses(className, '-add'), function(fn) {

            /* when a CSS class is added to an element then the transition style that
             * is applied is the transition defined on the element when the CSS class
             * is added at the time of the animation. This is how CSS3 functions
             * outside of ngAnimate. */
            element.addClass(className);
            var timings = fn();
            element.removeClass(className);
            return timings;
          });

          if(cancellationMethod) {
            afterReflow(element, function() {
              unblockTransitions(element, className);
              unblockKeyframeAnimations(element);
              animationCompleted();
            });
            return cancellationMethod;
          }
          animationCompleted();
        },

        setClass : function(element, add, remove, animationCompleted) {
          remove = suffixClasses(remove, '-remove');
          add = suffixClasses(add, '-add');
          var className = remove + ' ' + add;
          return animateAfter('setClass', element, className, animationCompleted);
        },

        addClass : function(element, className, animationCompleted) {
          return animateAfter('addClass', element, suffixClasses(className, '-add'), animationCompleted);
        },

        beforeRemoveClass : function(element, className, animationCompleted) {
          var cancellationMethod = animateBefore('removeClass', element, suffixClasses(className, '-remove'), function(fn) {
            /* when classes are removed from an element then the transition style
             * that is applied is the transition defined on the element without the
             * CSS class being there. This is how CSS3 functions outside of ngAnimate.
             * http://plnkr.co/edit/j8OzgTNxHTb4n3zLyjGW?p=preview */
            var klass = element.attr('class');
            element.removeClass(className);
            var timings = fn();
            element.attr('class', klass);
            return timings;
          });

          if(cancellationMethod) {
            afterReflow(element, function() {
              unblockTransitions(element, className);
              unblockKeyframeAnimations(element);
              animationCompleted();
            });
            return cancellationMethod;
          }
          animationCompleted();
        },

        removeClass : function(element, className, animationCompleted) {
          return animateAfter('removeClass', element, suffixClasses(className, '-remove'), animationCompleted);
        }
      };

      function suffixClasses(classes, suffix) {
        var className = '';
        classes = angular.isArray(classes) ? classes : classes.split(/\s+/);
        forEach(classes, function(klass, i) {
          if(klass && klass.length > 0) {
            className += (i > 0 ? ' ' : '') + klass + suffix;
          }
        });
        return className;
      }
    }]);
  }]);


})(window, window.angular);

},{}]},{},[4])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9hbmd1bGFyLWFwcC5qcyIsImpzL2FuZ3VsYXItZWxhc3RpYy9lbGFzdGljLmpzIiwianMvYW5ndWxhci9hbmd1bGFyLm1pbi5qcyIsImpzL2Jyb3dzZXJpZnktYXBwLmpzIiwianMvZXJyb3ItbWFwcGVyL2Vycm9yLW1hcHBlci5qcyIsImpzL2xhbmd1YWdlLWNoYW5nZXIvbGFuZ3VhZ2UtY2hhbmdlci5qcyIsImpzL2xpYnMvYW5ndWxhci10cmFuc2xhdGUtbG9hZGVyLXN0YXRpYy1maWxlcy5qcyIsImpzL2xpYnMvYW5ndWxhci10cmFuc2xhdGUuanMiLCJqcy9saWJzL251bWVyYWwuZGUtZGUuanMiLCJqcy9saWJzL3Byb21pc2UtdHJhY2tlci1odHRwLWludGVyY2VwdG9yLmpzIiwianMvbGlicy9wcm9taXNlLXRyYWNrZXIuanMiLCJqcy9saWJzL3VpLWJvb3RzdHJhcC10cGxzLTAuMTEuMi5taW4uanMiLCJqcy9saWJzL3VpLWhhbmRzb250YWJsZS5qcyIsImpzL211bHRpc2VsZWN0L211bHRpc2VsZWN0LmpzIiwianMvbmF2aWdhdGlvbi1ibG9ja2VyL25hdmlnYXRpb24tYmxvY2tlci5qcyIsImpzL25vdGlmaWNhdGlvbi9ub3RpZmljYXRpb24uanMiLCJqcy9vcmRlci1vYmplY3QtYnkvbmctb3JkZXItb2JqZWN0LWJ5LmpzIiwianMvdGFicy9mb3JtLXRhYnMuanMiLCJqcy91dGlscy91dGlscy5qcyIsIm5vZGVfbW9kdWxlcy9hbmd1bGFyLWFuaW1hdGUvYW5ndWxhci1hbmltYXRlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1M0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbE5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3h5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25HQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIiQubm9Db25mbGljdCgpO1xuXG5cblx0dmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdMQ1AnLCBbXG4gICAgICAgICd1aS5ib290c3RyYXAnLFxuICAgICAgICAnbmdBbmltYXRlJyxcbiAgICAgICAgJ2Fqb3NsaW4ucHJvbWlzZS10cmFja2VyJyxcbiAgICAgICAgJ25hdmlnYXRpb24ubmF2aWdhdGlvbkJsb2NrZXInLFxuICAgICAgICAndHJhbnNsYXRlLmxhbmd1YWdlQ2hhbmdlcicsXG4gICAgICAgICd1aS5tdWx0aXNlbGVjdCcsXG4gICAgICAgICd0YWJzLmZvcm1UYWJzJyxcbiAgICAgICAgJ3VpLmVycm9yTWFwcGVyJyxcbiAgICAgICAgJ21vbm9zcGFjZWQuZWxhc3RpYycsXG4gICAgICAgICduZ09yZGVyT2JqZWN0QnknLFxuICAgICAgICAnbm90aWZpY2F0aW9ucyddKTtcblxuICAgIGFwcC5ydW4oZnVuY3Rpb24oJHJvb3RTY29wZSwgcHJvbWlzZVRyYWNrZXIsICRsb2NhdGlvbiwgdGFiU2VydmljZSkge1xuICAgICAgICAkcm9vdFNjb3BlLmxvYWRpbmdUcmFja2VyID0gcHJvbWlzZVRyYWNrZXIoe30pO1xuICAgICAgICB0YWJTZXJ2aWNlLnNldFRhYnMoW1xuICAgICAgICAgICAge1wiaWRcIjpcIkJhc2ljRGF0YVwiLCAgICAgICAgICAgIFwiYWN0aXZlXCIgOiB0cnVlfSxcbiAgICAgICAgICAgIHtcImlkXCI6XCJMaXN0T2ZQbGFudHNcIiwgICAgICAgICBcImFjdGl2ZVwiIDogZmFsc2V9LFxuICAgICAgICAgICAge1wiaWRcIjpcIlBsYW50RGV0YWlsc1wiLCAgICAgICAgIFwiYWN0aXZlXCIgOiBmYWxzZX0sXG4gICAgICAgICAgICB7XCJpZFwiOlwiRW5lcmd5SW5wdXRcIiwgICAgICAgICAgXCJhY3RpdmVcIiA6IGZhbHNlfSxcbiAgICAgICAgICAgIHtcImlkXCI6XCJUb3RhbEVtaXNzaW9uc1RvQWlyXCIsICBcImFjdGl2ZVwiIDogZmFsc2V9LFxuICAgICAgICAgICAge1wiaWRcIjpcIkRlc3VscGh1cmlzYXRpb25cIiwgICAgIFwiYWN0aXZlXCIgOiBmYWxzZX0sXG4gICAgICAgICAgICB7XCJpZFwiOlwiVXNlZnVsSGVhdFwiLCAgICAgICAgICAgICBcImFjdGl2ZVwiIDogZmFsc2V9LFxuICAgICAgICAgICAge1wiaWRcIjpcIk5vdGVzXCIsICAgICAgICAgICAgICAgIFwiYWN0aXZlXCIgOiBmYWxzZX1dKTtcbiAgICB9KTtcblxuICAgIGFwcC5jb25maWcoZnVuY3Rpb24gKGxhbmd1YWdlQ2hhbmdlclByb3ZpZGVyKSB7XG4gICAgICAgIGxhbmd1YWdlQ2hhbmdlclByb3ZpZGVyLnNldERlZmF1bHRMYW5ndWFnZSgnZW4nKTtcbiAgICAgICAgbGFuZ3VhZ2VDaGFuZ2VyUHJvdmlkZXIuc2V0TGFuZ3VhZ2VGaWxlUHJlZml4KCdsY3AtbGFiZWxzLScpO1xuICAgICAgICBsYW5ndWFnZUNoYW5nZXJQcm92aWRlci5zZXRBdmFpbGFibGVMYW5ndWFnZXMoeyBcIml0ZW1cIiA6W3tcbiAgICAgICAgICAgIFwiY29kZVwiOiBcImJnXCIsXG4gICAgICAgICAgICBcImxhYmVsXCI6IFwi0JHRitC70LPQsNGA0YHQutC4IChiZylcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcImVzXCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIkVzcGHDsW9sIChlcylcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcImNzXCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIsSMZcWhdGluYSAoY3MpXCJ9LCB7XG4gICAgICAgICAgICBcImNvZGVcIjogXCJkYVwiLFxuICAgICAgICAgICAgICAgIFwibGFiZWxcIjogXCJEYW5zayAoZGEpXCJ9LCB7XG4gICAgICAgICAgICBcImNvZGVcIjogXCJkZVwiLFxuICAgICAgICAgICAgICAgIFwibGFiZWxcIjogXCJEZXV0c2NoIChkZSlcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcImV0XCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIkVlc3RpIChldClcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcImVsXCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIs61zrvOu863zr3Ouc66zqwgKGVsKVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwiZW5cIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiRW5nbGlzaCAoZW4pXCJ9LCB7XG4gICAgICAgICAgICBcImNvZGVcIjogXCJmclwiLFxuICAgICAgICAgICAgICAgIFwibGFiZWxcIjogXCJGcmFuw6dhaXMgKGZyKVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwiaHJcIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiSHJ2YXRza2kgKGhyKVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwiaXRcIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiSXRhbGlhbm8gKGl0KVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwibHZcIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiTGF0dmllxaF1IHZhbG9kYSAobHYpXCJ9LCB7XG4gICAgICAgICAgICBcImNvZGVcIjogXCJsdFwiLFxuICAgICAgICAgICAgICAgIFwibGFiZWxcIjogXCJMaWV0dXZpxbMga2FsYmEgKGx0KVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwiaHVcIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiTWFneWFyIChodSlcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcImhyXCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIkhydmF0c2tpIChocilcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcIm10XCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIk1hbHRpIChtdClcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcIm5sXCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIk5lZGVybGFuZHMgKG5sKVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwicGxcIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiUG9sc2tpIChwbClcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcInB0XCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIlBvcnR1Z3XDqnMgKHB0KVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwicm9cIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiUm9tw6JuxIMgKHJvKVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwic2tcIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiU2xvdmVuxI1pbmEgKHNrKVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwic2xcIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiU2xvdmVuxaHEjWluYSAoc2wpXCJ9LCB7XG4gICAgICAgICAgICBcImNvZGVcIjogXCJmaVwiLFxuICAgICAgICAgICAgICAgIFwibGFiZWxcIjogXCJTdW9taSAoZmkpXCJ9LCB7XG4gICAgICAgICAgICBcImNvZGVcIjogXCJzdlwiLFxuICAgICAgICAgICAgICAgIFwibGFiZWxcIjogXCJTdmVuc2thIChzdilcIn1dIH0pXG4gICAgfSk7XG5cbiAgICAvLyByZXF1ZXN0IHBhcmFtZXRlcnNcbiAgICB2YXIgYmFzZVVyaSA9IGdldFBhcmFtZXRlckJ5TmFtZSgnYmFzZV91cmknKTtcbiAgICB2YXIgZmlsZUlkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdmaWxlSWQnKTtcbiAgICB2YXIgZW52ZWxvcGUgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2VudmVsb3BlJyk7XG4gICAgdmFyIHNlc3Npb25JZCA9IGdldFBhcmFtZXRlckJ5TmFtZSgnc2Vzc2lvbmlkJyk7XG4gICAgdmFyIGNvdW50cnlDb2RlID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdjb3VudHJ5Y29kZScpO1xuICAgIGNvdW50cnlDb2RlID0gY291bnRyeUNvZGUgPT09IFwiR0JcIiA/IFwiVUtcIiA6IGNvdW50cnlDb2RlO1xuICAgIHZhciBERF9WT0NBQlVMQVJZX0JBU0VfVVJJID0gXCJodHRwOi8vZGQuZWlvbmV0LmV1cm9wYS5ldS92b2NhYnVsYXJ5L1wiO1xuXG4gICAgYXBwLmNvbnRyb2xsZXIoXCJxdWVzdGlvbm5haXJlXCIsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsIGRhdGFSZXBvc2l0b3J5LCBsYW5ndWFnZUNoYW5nZXIsICRzY2UsICRsb2NhdGlvbiwgJHRpbWVvdXQsICRhbmNob3JTY3JvbGwsICRub3RpZmljYXRpb24sICRodHRwLCAkZmlsdGVyICwkcSkge1xuXG4gICAgIFxuICAgICAgICAkc2NvcGUuY29kZUxpc3QgPSB7fTtcbiAgICAgICAgJHNjb3BlLnJlZ2lvbnNDb2RlbGlzdCA9IHt9O1xuXG5cdFx0JHNjb3BlLmJhc2UgPSAkbG9jYXRpb24uaG9zdCgpKyAkbG9jYXRpb24ucG9ydCgpICsgZ2V0UGFyYW1ldGVyQnlOYW1lKCdiYXNlX3VyaScpO1xuICAgICAgICAvLyRzY29wZS5hdmFpbGFibGVMYW5ndWFnZXMgPSBsYW5ndWFnZUNoYW5nZXIuZ2V0QXZhaWxhYmxlTGFuZ3VhZ2VzKCk7XG5cbiAgICAgICAgZGF0YVJlcG9zaXRvcnkuZ2V0RW1wdHlJbnN0YW5jZSgpLmVycm9yKGZ1bmN0aW9uKCl7YWxlcnQoXCJGYWlsZWQgdG8gcmVhZCBlbXB0eSBpbnN0YW5jZSBYTUwgZmlsZS5cIik7fSkuc3VjY2VzcyhmdW5jdGlvbihpbnN0YW5jZSkge1xuICAgICAgICAgICAgJHNjb3BlLmVtcHR5SW5zdGFuY2UgPSBpbnN0YW5jZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGF0YVJlcG9zaXRvcnkuZ2V0SW5zdGFuY2UoKS5lcnJvcihmdW5jdGlvbigpe2FsZXJ0KFwiRmFpbGVkIHRvIHJlYWQgaW5zdGFuY2UgWE1MIGZpbGUuXCIpO30pLnN1Y2Nlc3MoZnVuY3Rpb24oaW5zdGFuY2UpIHtcbiAgICAgICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQoaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZSkpe1xuICAgICAgICAgICAgICAgIC8vIGFkZCBsYWJlbExhbmd1YWdlIGF0dHJpYnV0ZSB0byBjb3JyZWN0IGxvY2F0aW9uXG4gICAgICAgICAgICAgICAgJHNjb3BlLmluc3RhbmNlID0ge307XG4gICAgICAgICAgICAgICAgJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUgPSB7fTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZVsnQHhtbG5zOnhzaSddID0gaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZVsnQHhtbG5zOnhzaSddO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlWydAeHNpOm5vTmFtZXNwYWNlU2NoZW1hTG9jYXRpb24nXSA9IGluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmVbJ0B4c2k6bm9OYW1lc3BhY2VTY2hlbWFMb2NhdGlvbiddO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlWydAeG1sOmxhbmcnXSA9IGluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmVbJ0B4bWw6bGFuZyddO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkJhc2ljRGF0YSA9IGluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuQmFzaWNEYXRhO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cyA9IGluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW5zdGFuY2UgPSBpbnN0YW5jZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cyAmJiAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQpIHtcblxuICAgICAgICAgICAgICAgIC8vIGlmIHRoZXLPg8+Fz4NlIGlzIG9ubHkgMSBwbGFudCwgdGhlbiBjb252ZXJ0IGl0IHRvIGFycmF5XG4gICAgICAgICAgICAgICAgaWYgKCFhbmd1bGFyLmlzQXJyYXkoJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50KSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQgPSBbJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHRoZSBmaXJzdCBlbXB0eSByb3csIGlmIGV4aXN0c1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQubGVuZ3RoID09IDEgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICghJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50WzBdIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICghJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50WzBdWydQbGFudE5hbWUnXSAmJiAhJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50WzBdWydQbGFudElkJ10pKSl7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudCA9IFtdO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIExvYWQgcHJlZGVmaW5lZCBjb3VudHJ5IHNwZWNpZmljIHBsYW50c1xuICAgICAgICAgICAgICAgICAgICBpZiggY291bnRyeUNvZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVwcnRyQ291bnRyeUNvZGUgPSBjb3VudHJ5Q29kZSA9PT0gXCJHQlwiID8gXCJVS1wiIDogY291bnRyeUNvZGUgPT09IFwiR1JcIiA/IFwiRUxcIiA6IGNvdW50cnlDb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmFyIHVybCA9IFwibGNwX3BsYW50cy1cIiArIGNvdW50cnlDb2RlICsgXCIuanNvblwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IFwiaHR0cDovL3NlbWFudGljLmVlYS5ldXJvcGEuZXUvc3BhcnFsP2Zvcm1hdD1hcHBsaWNhdGlvbi9qc29uJnF1ZXJ5PVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNwYXJxbCA9IFwiIFBSRUZJWCByZGZzOiA8aHR0cDovL3d3dy53My5vcmcvMjAwMC8wMS9yZGYtc2NoZW1hIz5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBQUkVGSVggY3I6IDxodHRwOi8vY3IuZWlvbmV0LmV1cm9wYS5ldS9vbnRvbG9naWVzL2NvbnRyZWcucmRmIz4gXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIHBydHI6IDxodHRwOi8vcHJ0ci5lYy5ldXJvcGEuZXUvcmRmL3NjaGVtYS5yZGYjPiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBQUkVGSVggZ2VvOiA8aHR0cDovL3d3dy53My5vcmcvMjAwMy8wMS9nZW8vd2dzODRfcG9zIz5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBQUkVGSVggbGNwVHlwZTogPGh0dHA6Ly9zZW1hbnRpYy5lZWEuZXVyb3BhLmV1L3Byb2plY3QvbGNwX2RhdGEvbGNwX3BsYW50cy5jc3YvPiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBQUkVGSVggbGNwOiA8aHR0cDovL3NlbWFudGljLmVlYS5ldXJvcGEuZXUvcHJvamVjdC9sY3BfZGF0YS9sY3BfcGxhbnRzLmNzdiM+IFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIFNFTEVDVCAqXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgV0hFUkUge1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIHtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgW10gYSBsY3BUeXBlOmxjcFBsYW50IDtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgbGNwOlBsYW50TmFtZSA/UGxhbnROYW1lO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBsY3A6TWVtYmVyU3RhdGUgP01lbWJlclN0YXRlO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBsY3A6RVBSVFJOYXRpb25hbElkID9FUFJUUk5hdGlvbmFsSWQ7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIGxjcDpVbmlxdWVfUGxhbnRfSUQgP1BsYW50SWQuXCIgK1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgP2ZhY2lsaXR5IGEgcHJ0cjpGYWNpbGl0eSA7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIHBydHI6ZmFjaWxpdHlOYW1lID9mYWNpbGl0eU5hbWU7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIHBydHI6c3RyZWV0TmFtZSA/c3RyZWV0TmFtZTtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgcHJ0cjpwb3N0YWxDb2RlICA/cG9zdGFsQ29kZTtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgZ2VvOmxhdCA/bGF0O1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBnZW86bG9uZyA/bG9uZztcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgcHJ0cjppbkNvdW50cnkgP2luQ291bnRyeSA7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIHBydHI6bGF0ZXN0UmVwb3J0ID9sYXRlc3RSZXBvcnQuXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiID9pbkNvdW50cnkgcHJ0cjpjb2RlID9FUFJUUkNvdW50cnlDb2RlLlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiA/bGF0ZXN0UmVwb3J0IHBydHI6bmF0aW9uYWxJRCA/RVBSVFJOYXRpb25hbElkO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBwcnRyOmZvck5VVFMgP2Zvck5VVFM7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIHBydHI6cmVwb3J0aW5nWWVhciA/cmVwb3J0aW5nWWVhci5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgP2Zvck5VVFMgcHJ0cjpjb2RlID9yZWdpb25Db2RlLlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBPUFRJT05BTCB7ID9mYWNpbGl0eSBwcnRyOmJ1aWxkaW5nTnVtYmVyID9idWlsZGluZ051bWJlci4gfVwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBPUFRJT05BTCB7ID9mYWNpbGl0eSBwcnRyOmNpdHkgP2NpdHkuIH1cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgRklMVEVSKCA/RVBSVFJDb3VudHJ5Q29kZT0gJ1wiICsgZXBydHJDb3VudHJ5Q29kZSArIFwiJyBhbmQgP01lbWJlclN0YXRlID0gJ1wiICsgY291bnRyeUNvZGUgKyBcIicgYW5kID9NZW1iZXJTdGF0ZSAhPSAnU0snIClcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiB9IFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIFVOSU9OXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIge1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiA/cGxhbnQgYSBsY3BUeXBlOmxjcFBsYW50IDtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgbGNwOlBsYW50TmFtZSA/UGxhbnROYW1lO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBsY3A6TWVtYmVyU3RhdGUgP01lbWJlclN0YXRlO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBsY3A6RVBSVFJOYXRpb25hbElkID9FUFJUUk5hdGlvbmFsSWQ7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIGxjcDpVbmlxdWVfUGxhbnRfSUQgP1BsYW50SWQuXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIE9QVElPTkFMIHsgID9wbGFudCBsY3A6RmFjaWxpdHlOYW1lID9mYWNpbGl0eU5hbWUuIH1cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgT1BUSU9OQUwgeyAgP3BsYW50IGxjcDpMb25naXR1ZGUgP2xvbmcuIH1cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgT1BUSU9OQUwgeyAgP3BsYW50IGxjcDpMYXRpdHVkZSA/bGF0LiB9XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIE9QVElPTkFMIHsgID9wbGFudCBsY3A6QWRkcmVzczEgP3N0cmVldE5hbWUuIH1cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgT1BUSU9OQUwgeyAgP3BsYW50IGxjcDpDaXR5ID9jaXR5LiB9XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIE9QVElPTkFMIHsgID9wbGFudCBsY3A6UG9zdGFsQ29kZSA/cG9zdGFsQ29kZS59XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIE9QVElPTkFMIHsgID9wbGFudCBsY3A6UmVnaW9uID9yZWdpb25Db2RlLiB9XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIE9QVElPTkFMIHtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiID9mYWNpbGl0eSBhIHBydHI6RmFjaWxpdHkgO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgcHJ0cjppbkNvdW50cnkgP2luQ291bnRyeSA7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBwcnRyOmxhdGVzdFJlcG9ydCA/bGF0ZXN0UmVwb3J0LlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgP2xhdGVzdFJlcG9ydCBwcnRyOm5hdGlvbmFsSUQgP0VQUlRSTmF0aW9uYWxJZC5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiID9pbkNvdW50cnkgcHJ0cjpjb2RlID9FUFJUUkNvdW50cnlDb2RlLlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgRklMVEVSKCA/RVBSVFJDb3VudHJ5Q29kZT0gJ1wiKyBlcHJ0ckNvdW50cnlDb2RlICsgXCInICApXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIH1cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgRklMVEVSKCA/TWVtYmVyU3RhdGUgPSAnXCIgKyBjb3VudHJ5Q29kZSArXCInIGFuZCAoIWJvdW5kKD9mYWNpbGl0eSkgb3IgID9NZW1iZXJTdGF0ZSA9ICdTSycgKSApIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIH1cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiB9IE9SREVSIEJZID9QbGFudElkIFwiO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBiYXNlVXJpICsgJy9yZXN0UHJveHk/dXJpPScgKyBlbmNvZGVVUklDb21wb25lbnQodXJsICsgZW5jb2RlVVJJQ29tcG9uZW50KHNwYXJxbCkpO1xuICAgICAgICAvLyAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncGxhbnRzIHVybCBpczonK3VybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsLCB7dHJhY2tlciA6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oKXthbGVydChcIkZhaWxlZCB0byBwcmUtbG9hZCBwbGFudHMgZGF0YSBmcm9tIEUtUFJUUiBkYXRhYmFzZS5cIik7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZXBydHJEYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXBydHJEYXRhLnJlc3VsdHMuYmluZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbGFudHNEaWN0ID0ge30gO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGk9IDA7IGkgPCBlcHJ0ckRhdGEucmVzdWx0cy5iaW5kaW5ncy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2VQbGFudCA9IGVwcnRyRGF0YS5yZXN1bHRzLmJpbmRpbmdzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGxhbnQgPSBudWxsIDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAgIHBsYW50c0RpY3RbIHJlc3BvbnNlUGxhbnQuUGxhbnRJZC52YWx1ZV0gJiYgcGxhbnRzRGljdCBbIHJlc3BvbnNlUGxhbnQuUGxhbnRJZC52YWx1ZV0gPiByZXNwb25zZVBsYW50LnJlcG9ydGluZ1llYXIudmFsdWUgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc29tZSBwbGFudHMgaGF2ZSByZXBvcnRzIHVuZGVyIGRpZmZlcmVudCBmYWNpbGl0aWVzLiB3ZSBrZWVwIHRoZSBmb3IgbW9zdCBuZXcgcmVwb3J0aW5nWWVhclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCAhIHBsYW50c0RpY3RbIHJlc3BvbnNlUGxhbnQuUGxhbnRJZC52YWx1ZV0gKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hZGRJdGVtKCdMQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQgPSAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnRbICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudC5sZW5ndGggLSAxIF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcGxhbnQuUGxhbnRMb2NhdGlvbikgcGxhbnQuUGxhbnRMb2NhdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUpIHBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUgPSB7fTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFudC5QbGFudElkID0gcmVzcG9uc2VQbGFudC5QbGFudElkLnZhbHVlIDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuUGxhbnROYW1lID0gcmVzcG9uc2VQbGFudC5QbGFudE5hbWUudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LkVQUlRSTmF0aW9uYWxJZCA9IHJlc3BvbnNlUGxhbnQuRVBSVFJOYXRpb25hbElkLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFudC5QbGFudExvY2F0aW9uLkFkZHJlc3MxID0gcmVzcG9uc2VQbGFudC5zdHJlZXROYW1lLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRW1wdHkocmVzcG9uc2VQbGFudC5idWlsZGluZ051bWJlci52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50TG9jYXRpb24uQWRkcmVzczEgKz0gXCIgXCIgKyByZXNwb25zZVBsYW50LmJ1aWxkaW5nTnVtYmVyLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50TG9jYXRpb24uQ2l0eSA9IHJlc3BvbnNlUGxhbnQuY2l0eS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuUGxhbnRMb2NhdGlvbi5SZWdpb24gPSByZXNwb25zZVBsYW50LnJlZ2lvbkNvZGUudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50TG9jYXRpb24uUG9zdGFsQ29kZSA9IHJlc3BvbnNlUGxhbnQucG9zdGFsQ29kZS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5Mb25naXR1ZGUgPSByZXNwb25zZVBsYW50LmxvbmcudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTGF0aXR1ZGUgPSByZXNwb25zZVBsYW50LmxhdC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuRmFjaWxpdHlOYW1lID0gcmVzcG9uc2VQbGFudC5mYWNpbGl0eU5hbWUudmFsdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnRzRGljdCBbcGxhbnQuUGxhbnRJZCBdID0gcmVzcG9uc2VQbGFudC5yZXBvcnRpbmdZZWFyLnZhbHVlIHx8IDIwMTM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgndXBkYXRlRmlsdGVyJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG5vdGlmaWNhdGlvbi5pbmZvKFwiSW5mb1wiLCBcIlByZXZpb3VzIEVQUlRSIHBsYW50cyBoYXZlIGJlZW4gcHJlLWxvYWRlZC5cIik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiVGhlIHN5c3RlbSBjb3VsZCBub3QgZmluZCBhbnkgcGxhbnQgZm9yIGNvdW50cnkgXCIgKyBjb3VudHJ5Q29kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzID0ge1wiUGxhbnRcIiA6IFtdfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKCBjb3VudHJ5Q29kZSAhPSBudWxsKXtcblxuICAgICAgICAgICAgICAgICRzY29wZS5jb3VudHJ5Q29kZUJvb2xlYW4gPXRydWU7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuQmFzaWNEYXRhLk1lbWJlclN0YXRlID0gY291bnRyeUNvZGUudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubWVtYmVyU3RhdGVWYWx1ZSA9IGNvdW50cnlDb2RlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiggJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuQmFzaWNEYXRhLk1lbWJlclN0YXRlICE9IG51bGwgKXtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY291bnRyeUNvZGVCb29sZWFuID10cnVlO1xuICAgICAgICAgICAgICAgICRzY29wZS5tZW1iZXJTdGF0ZVZhbHVlID0gJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuQmFzaWNEYXRhLk1lbWJlclN0YXRlO1xuICAgICAgICAgICAgICAgICRzY29wZS5zdGF0ZVZhbHVlID0gJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuQmFzaWNEYXRhLk1lbWJlclN0YXRlO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkJhc2ljRGF0YS5TdGF0ZSA9ICRzY29wZS5zdGF0ZVZhbHVlO1xuICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25zQ29kZWxpc3QgPSBkYXRhUmVwb3NpdG9yeS5sb2FkUmVnaW9uc0NvZGVsaXN0KCRzY29wZS5tZW1iZXJTdGF0ZVZhbHVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ2luc3RhbmNlUmVhZHknKTtcbiAgICAgICAgfSk7XG5cbiAgIFxuICAgICAgICBcbiAgICAgICAgJHNjb3BlLnJlcG9ydGluZ1llYXJzID0gW107XG4gICAgICAgICRzY29wZS5yZXBvcnRpbmdZZWFycy5wdXNoICgnMjAxNicpO1xuICAgICAgICAkc2NvcGUucGxhbnREZXRhaWxzT3RoZXJTZWN0b3JGaWVsZHNWaWV3ID0ge2lyb25fc3RlZWw6XCJJcm9uIGFuZCBTdGVlbFwiLGVzaTpcIkVsZWN0cmljaXR5IHByb2R1Y3Rpb25cIixkaXN0cmljdF9oZWF0aW5nOlwiRGlzdHJpY3QgaGVhdGluZ1wiLGNocDpcIkNvbWJpbmVkIGhlYXQgYW5kIHBvd2VyIGdlbmVyYXRpb25cIixvdGhlcjpcIk90aGVyXCJ9O1xuXG4gICAgICAgIC8vIG5ld1xuICAgICAgICAkc2NvcGUuY3VycmVudExpc3RPZlBsYW50c1RhYmxlID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLnNlbGVjdGVkTGlzdE9mUGxhbnRzVGFibGUgPSBudWxsO1xuICAgICAgICAkc2NvcGUudHJhbnNsYXRpb25EYXRhID0ge307XG4gICAgICAgICRyb290U2NvcGUuYnVsa0VkaXRMaXN0T2ZQbGFudHM9ZmFsc2U7XG4gICAgICAgIC8vJHNjb3BlLnN0YXR1cyA9IHN1Ym1pc3Npb25TZXJ2aWNlLmdldFN0YXR1cygpO1xuICAgICAgICAkc2NvcGUucHJvZmlsZUZpbGxlZCA9IHRydWU7XG4gICAgICAgICRzY29wZS5lZGl0UmVmZXJlbmNlID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5jaGFuZ2VkUmVmZXJlbmNlID0gXCJcIjtcbiAgICAgICAgJHNjb3BlLmVkaXRVc2VySWRlbnRpdHkgPSBmYWxzZTtcbiAgICAgICAgJHNjb3BlLmNoYW5nZWRVc2VySWRlbnRpdHkgPSBcIlwiO1xuICAgICAgICAkc2NvcGUuZWRpdENvdW50cnkgPSBmYWxzZTtcbiAgICAgICAgJHNjb3BlLmNoYW5nZWRDb3VudHJ5ID0gXCJcIjtcbiAgICAgICAgJHNjb3BlLnJlZ2lvbnNDb2RlbGlzdCA9IHt9O1xuICAgICAgICAkc2NvcGUucmVnaW9uc0NvdW50cnkgPSBudWxsO1xuICAgICAgICAkc2NvcGUuaXNJRTkgPSAkcm9vdFNjb3BlLmlzSUU5O1xuXG4gICAgICAgICRzY29wZS5jaGVja0JveERlbGV0ZUNvbW1pdCA9IGZhbHNlO1xuICAgICAgICAvLyBuZXcgZW5kXG4gICAgICAgIC8vZGV0ZXJtaW5lIGllIHZlcnNpb24sIGNvZGUgc25pcHBldCBpcyB0YWtlbiBmcm9tOiBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvbXM1Mzc1MDklMjh2PXZzLjg1JTI5LmFzcHhcbiAgICAgICAgdmFyIHJ2ID0gLTE7IC8vIFJldHVybiB2YWx1ZSBhc3N1bWVzIGZhaWx1cmUuXG4gICAgICAgIGlmIChuYXZpZ2F0b3IuYXBwTmFtZSA9PSAnTWljcm9zb2Z0IEludGVybmV0IEV4cGxvcmVyJylcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIHVhID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcbiAgICAgICAgICAgIHZhciByZSAgPSBuZXcgUmVnRXhwKFwiTVNJRSAoWzAtOV17MSx9W1xcLjAtOV17MCx9KVwiKTtcbiAgICAgICAgICAgIGlmIChyZS5leGVjKHVhKSAhPSBudWxsKVxuICAgICAgICAgICAgICAgIHJ2ID0gcGFyc2VGbG9hdCggUmVnRXhwLiQxICk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zZWU6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTc5MDc0NDUvaG93LXRvLWRldGVjdC1pZTExXG4gICAgICAgIGVsc2UgaWYgKG5hdmlnYXRvci5hcHBOYW1lID09ICdOZXRzY2FwZScpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciB1YSA9IG5hdmlnYXRvci51c2VyQWdlbnQ7XG4gICAgICAgICAgICB2YXIgcmUgID0gbmV3IFJlZ0V4cChcIlRyaWRlbnQvLipydjooWzAtOV17MSx9W1xcLjAtOV17MCx9KVwiKTtcbiAgICAgICAgICAgIGlmIChyZS5leGVjKHVhKSAhPSBudWxsKVxuICAgICAgICAgICAgICAgIHJ2ID0gcGFyc2VGbG9hdCggUmVnRXhwLiQxICk7XG4gICAgICAgIH1cblxuICAgICAgICAkcm9vdFNjb3BlLmllVmVyc2lvbk51bWJlck91dE9mQ3VyaW9zaXR5VmFyaWFibGUgPSBydjtcbiAgICAgICAgaWYgKHJ2ID4gMCAmJiBydiA8PSA5LjApe1xuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0lFOSA9IHRydWU7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0lFOSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgICRyb290U2NvcGUuJHdhdGNoKCdpc0lFOScsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICAgICAgaWYgKCFuZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmlzSUU5ID0gJHJvb3RTY29wZS5pc0lFOTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuXG4gICAgICAgIC8vJHNjb3BlLmNvdW50cnlDb2RlQm9vbGVhbiA9ICBjb3VudHJ5Q29kZSAhPSBudWxsICA7XG4gICAgICAgICRzY29wZS5jb3VudHJ5Q29kZVZhbCA9ICBjb3VudHJ5Q29kZTtcblxuXG4gICAgICAgIGRhdGFSZXBvc2l0b3J5LmxvYWRDb2RlTGlzdCgpO1xuICAgICAgICBkYXRhUmVwb3NpdG9yeS5sb2FkT2xkTENQQ29kZUxpc3QoKTtcbiAgICAgICAgZGF0YVJlcG9zaXRvcnkubG9hZENvbWJ1c3Rpb25QbGFudENvZGVMaXN0KCk7XG4gICAgICAgIGRhdGFSZXBvc2l0b3J5LmxvYWREZXJvZ2F0aW9uVmFsdWVDb2RlTGlzdCgpO1xuICAgICAgICBkYXRhUmVwb3NpdG9yeS5sb2FkT3RoZXJTb2xpZEZ1ZWxDb2RlTGlzdCgpO1xuICAgICAgICBkYXRhUmVwb3NpdG9yeS5sb2FkT3RoZXJHYXNlc291c0Z1ZWxDb2RlTGlzdCgpO1xuICAgICAgICBkYXRhUmVwb3NpdG9yeS5sb2FkTW9udGhWYWx1ZUNvZGVMaXN0KCk7XG4gICAgICAgICRzY29wZS5jb2RlTGlzdCA9IGRhdGFSZXBvc2l0b3J5LmdldENvZGVMaXN0KCk7XG5cbiAgICAgICBcbiAgICBcbiAgICAgICAgJHNjb3BlLmNvbnZlcnNpb25MaW5rID0gXCJcIjtcbiAgICAgICAgJHNjb3BlLmluc3RhbmNlSW5mbyA9IHt9O1xuICAgICAgICBkYXRhUmVwb3NpdG9yeS5sb2FkSW5zdGFuY2VJbmZvKCkuZXJyb3IoZnVuY3Rpb24oKXtjb25zb2xlLmxvZyhcIkZhaWxlZCB0byByZWFkZmlsZSBpbmZvIGZyb20gc2VydmVyLlwiKTt9KS5zdWNjZXNzKGZ1bmN0aW9uKGluZm8pIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuY29weShpbmZvLCAkc2NvcGUuaW5zdGFuY2VJbmZvKTtcbiAgICAgICAgICAgIGlmICgkc2NvcGUuaW5zdGFuY2VJbmZvLmNvbnZlcnNpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGh0bWxDb252ZXJzaW9uSWQgPSAkZmlsdGVyKCdmaWx0ZXInKSgkc2NvcGUuaW5zdGFuY2VJbmZvLmNvbnZlcnNpb25zLCB7cmVzdWx0VHlwZTogJ0hUTUwnfSlbMF0uaWQ7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbnZlcnNpb25MaW5rID0gJHNjb3BlLmluc3RhbmNlSW5mby5jb252ZXJzaW9uTGluayArIGh0bWxDb252ZXJzaW9uSWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cblxuICAgICAgICAvLyBSZW1vdmUgcm93IGZyb20gbmctcmVwZWF0LlxuICAgICAgICAkc2NvcGUucmVtb3ZlID0gZnVuY3Rpb24oYXJyYXksICByb3dFbGVtZW50LCBzaG93TXNnKXtcblxuICAgICAgICAgICAgLy8vL2NvbnNvbGUubG9nKHJvd0VsZW1lbnQpO1xuICAgICAgICAgICAgLy8vL2NvbnNvbGUubG9nKGNvdW50Tm9uRW1wdHlQcm9wZXJ0aWVzKHJvd0VsZW1lbnQpKTtcbiAgICAgICAgICAgIGlmKHNob3dNc2cgPT0gdHJ1ZSl7XG4gICAgICAgICAgICAgICAgaWYgKGNvdW50Tm9uRW1wdHlQcm9wZXJ0aWVzKHJvd0VsZW1lbnQpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhlIGRhdGEgaW4gdGhpcyByb3c/Jykpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGluZGV4ID0gYXJyYXkuaW5kZXhPZihyb3dFbGVtZW50KTtcbiAgICAgICAgICAgIGFycmF5LnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZUZpbHRlcicpO1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgLy8gZ2V0IGNvZGUgbGlzdCBsYWJlbCBieSBjb2RlXG4gICAgICAgICRzY29wZS5nZXRDb2RlTGlzdExhYmVsID0gZnVuY3Rpb24oY29kZWxpc3QsIGNvZGUpIHtcbiAgICAgICAgICAgIC8vRG8gbm90IHRyeSB0byBnZXQgY29kZUxpc3QgYmVmb3JlIGl0IGFjdHVhbGx5IGV4aXN0cy5cbiAgICAgICAgICAgIGlmICghJHNjb3BlLmNvZGVMaXN0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL0VzY2FwZSBjb2RlbGlzdHMgdGhhdCBhcmUgbm90IGFycmF5cyBieSBkZWZhdWx0IChoYXMgb25seSBvbmUgZWxlbWVudClcbiAgICAgICAgICAgIC8vIFRoaXMgY29kZSBjYW4gYmUgcmVtb3ZlZCB3aGVuIGNoYW5nZXMgYXJlIG1hZGUgdG8gY29kZUxpc3QgZmlsZS5cbiAgICAgICAgICAgIGlmICghKCRzY29wZS5jb2RlTGlzdC5MQ1BDb2RlbGlzdHNbY29kZWxpc3RdLml0ZW0ubGVuZ3RoID4gMClcbiAgICAgICAgICAgICAgICAgICAgJiYgJHNjb3BlLmNvZGVMaXN0LkxDUENvZGVsaXN0c1tjb2RlbGlzdF0uaXRlbS5jb2RlID09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLmNvZGVMaXN0LkxDUENvZGVsaXN0c1tjb2RlbGlzdF0uaXRlbS5sYWJlbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHJldFZhbHVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaT0wIDsgaTw9JHNjb3BlLmNvZGVMaXN0LkxDUENvZGVsaXN0c1tjb2RlbGlzdF0uaXRlbS5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNvZGVMaXN0LkxDUENvZGVsaXN0c1tjb2RlbGlzdF0uaXRlbVtpXS5jb2RlID09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0VmFsdWUgPSAkc2NvcGUuY29kZUxpc3QuTENQQ29kZWxpc3RzW2NvZGVsaXN0XS5pdGVtW2ldLmxhYmVsO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0VmFsdWU7XG4gICAgICAgIH07XG5cblxuICAgICAgICAkc2NvcGUuYWRkSXRlbSA9IGZ1bmN0aW9uKHBhdGgpIHtcblxuICAgICAgICAgICAgdmFyIHRva2VucyA9IHBhdGguc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9ICRzY29wZS5pbnN0YW5jZTtcbiAgICAgICAgICAgIHdoaWxlKHRva2Vucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHRbdG9rZW5zLnNoaWZ0KCldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEocmVzdWx0IGluc3RhbmNlb2YgQXJyYXkpKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBOZWVkIHRvIG1ha2UgY29weSBvZiBvYmplY3Qgb3RoZXJ3aXNlIGl0IGdldHMgc2FtZSAkJGhhc2hrZXkgYW5kIGl0IGNhbm5vdCBiZSB1c2VkIGluIG5nLXJlcGVhdC5cbiAgICAgICAgICAgIC8vIE90aGVyIHNvbHV0aW9uIHdvdWxkIGJlIHRvIGdldCBlbXB0eSBpbnN0YW5jZSBldmVyeSB0aW1lIHRoYXQgd291bGQgYmUgc2xvd2VyLlxuICAgICAgICAgICAgdmFyIGNvcHlPZkVtcHR5SW5zdGFuY2UgPSBjbG9uZSgkc2NvcGUuZ2V0SW5zdGFuY2VCeVBhdGgoJ2VtcHR5SW5zdGFuY2UnLCBwYXRoKSk7XG4gICAgICAgICAgICByZXN1bHQucHVzaChjb3B5T2ZFbXB0eUluc3RhbmNlKTtcbiAgICAgICAgICAgIHJldHVybiBjb3B5T2ZFbXB0eUluc3RhbmNlO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5nZXROZXh0UGxhbnRJZCA9IGZ1bmN0aW9uICggcGxhbnRJZF9jYW5kaWRhdGUgKSB7XG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgdmFyIHEgPSAkcS5kZWZlciAoKTtcblxuICAgICAgICAgICAgdmFyIGZvcm1OZXh0UGxhbnRJZCA9IDE7XG4gICAgICAgICAgICB2YXIgbmV3UGxhbnRJZCA9IG51bGw7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHBhZChudW0sIHNpemUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcyA9IG51bStcIlwiO1xuICAgICAgICAgICAgICAgIHdoaWxlIChzLmxlbmd0aCA8IHNpemUpIHMgPSBcIjBcIiArIHM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrU0RTICggbmV3UGxhbnRJZCApIHtcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gXCJodHRwOi8vc2VtYW50aWMuZWVhLmV1cm9wYS5ldS9zcGFycWw/Zm9ybWF0PWFwcGxpY2F0aW9uL2pzb24mcXVlcnk9XCI7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3BhcnFsID1cbiAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIHJkZnM6IDxodHRwOi8vd3d3LnczLm9yZy8yMDAwLzAxL3JkZi1zY2hlbWEjPlwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIGxjcFR5cGU6IDxodHRwOi8vc2VtYW50aWMuZWVhLmV1cm9wYS5ldS9wcm9qZWN0L2xjcF9kYXRhL2xjcF9wbGFudHMuY3N2Lz5cIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIFBSRUZJWCBsY3A6IDxodHRwOi8vc2VtYW50aWMuZWVhLmV1cm9wYS5ldS9wcm9qZWN0L2xjcF9kYXRhL2xjcF9wbGFudHMuY3N2Iz5cIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIFNFTEVDVCAqXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiBXSEVSRSB7XCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiA/cGxhbnQgYSBsY3BUeXBlOmxjcFBsYW50IDtcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIGxjcDpVbmlxdWVfUGxhbnRfSUQgP1BsYW50SWQuXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiBGSUxURVIgKCA/UGxhbnRJZCA9ICdcIiArIG5ld1BsYW50SWQgK1wiJyApXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiB9XCIgO1xuXG4gICAgICAgICAgICAgICAgdXJsID0gYmFzZVVyaSArICcvcmVzdFByb3h5P3VyaT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCArIGVuY29kZVVSSUNvbXBvbmVudChzcGFycWwpKTtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsLCB7dHJhY2tlciA6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbigpe2FsZXJ0KFwiRmFpbGVkIHRvIHJlYWQgZGF0YSBmcm9tIHJlbW90ZSBkYXRhYmFzZS4gUGxlYXNlIGNoZWNrIHlvdXIgY29ubmVjdGlvbi5cIik7IHEucmVqZWN0KCk7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihlcHJ0ckRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVwcnRyRGF0YS5yZXN1bHRzLmJpbmRpbmdzLmxlbmd0aCA+IDApIHsgLy8gcGxhbmRJZCBleGlzdHMgaW4gZGJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGFnYWluc3QgdGhlIG5leHQgaW5jcmVtZW50IG9mIHBsYW50aWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1BsYW50SWQgPSAgICgkc2NvcGUubWVtYmVyU3RhdGVWYWx1ZSB8fCAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5CYXNpY0RhdGEuTWVtYmVyU3RhdGUpICsgcGFkKCBwYXJzZUludCggbmV3UGxhbnRJZC5zbGljZSgyKSApICsgMSAsIDQgKSA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0TmV4dFBsYW50SWQgKCBuZXdQbGFudElkICkgLiB0aGVuICggZnVuY3Rpb24gKCB2YWx1ZSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxLnJlc29sdmUgKCB2YWx1ZSApIDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKSA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7IC8vIHBsYW50aWQgbm90IHJlc2VydmVkLiByZXNvbHZlIHRoZSBwcm9taXNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxLnJlc29sdmUgKCBuZXdQbGFudElkICkgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICggcGxhbnRJZF9jYW5kaWRhdGUgPT0gbnVsbCApXG4gICAgICAgICAgICB7IC8vIHBsYW50SWRfY2FuZGlkYXRlID09IG51bGwgb24gdGhlIGZpcnN0IGNhbGwgb2YgdGhlIGZ1bmN0aW9uXG4gICAgICAgICAgICAgICAgLy8gd2UgZ2V0IHRoZSBtYXggcGxhbnQgaWQgb2YgdGhlIGN1cnJlbnQgcGxhbnRzIG9uIHRoIGZvcm1cbiAgICAgICAgICAgICAgICAvLyBhbmQgdGhlIG1heCBwbGFudCBpZCBmcm9tIHNkc1xuICAgICAgICAgICAgICAgIC8vIHRoZW4gd2Ugd2lsbCBjaGVjayBmb3IgaWQgY29sbGlzaW9ucyBhbmQgaW5jcmVtZW50IGJ5IG9uZSB0aGUgaWQgYW5kIHJlY2hlY2ssIHVudGlsIGEgJ2ZyZWUnIHBsYW50IGlkIGlzIGZvdW5kXG5cbiAgICAgICAgICAgICAgICB2YXIgb3JkZXJCeSA9ICRmaWx0ZXIoJ29yZGVyQnknKTtcbiAgICAgICAgICAgICAgICB2YXIgb3JkZXJlZEl0ZW1zID0gb3JkZXJCeSggJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50LCBcIlBsYW50SWRcIiwgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTA7IGkgPCBvcmRlcmVkSXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRW1wdHkob3JkZXJlZEl0ZW1zW2ldLlBsYW50SWQgKSAmJiBvcmRlcmVkSXRlbXNbaV0uUGxhbnRJZCAhPT0gXCJcIiApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybU5leHRQbGFudElkID0gcGFyc2VJbnQob3JkZXJlZEl0ZW1zW2ldLlBsYW50SWQuc3Vic3RyaW5nKG9yZGVyZWRJdGVtc1tpXS5QbGFudElkLmxlbmd0aCAtIDQgKSkgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAvLyAtLS0tIHF1ZXJ5IHRoZSBzZHMgZm9yIHRoZSBtYXggaWRcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gXCJodHRwOi8vc2VtYW50aWMuZWVhLmV1cm9wYS5ldS9zcGFycWw/Zm9ybWF0PWFwcGxpY2F0aW9uL2pzb24mcXVlcnk9XCI7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3BhcnFsID1cbiAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIHJkZnM6IDxodHRwOi8vd3d3LnczLm9yZy8yMDAwLzAxL3JkZi1zY2hlbWEjPlwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIGxjcFR5cGU6IDxodHRwOi8vc2VtYW50aWMuZWVhLmV1cm9wYS5ldS9wcm9qZWN0L2xjcF9kYXRhL3BsYW50X0lEcy5jc3YvPlwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIGxjcDogPGh0dHA6Ly9zZW1hbnRpYy5lZWEuZXVyb3BhLmV1L3Byb2plY3QvbGNwX2RhdGEvcGxhbnRfSURzLmNzdiM+IFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIgU0VMRUNUICpcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIFdIRVJFIHtcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIFtdIGEgbGNwVHlwZTpsY3BQbGFudElkcyA7XCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiBsY3A6VW5pcXVlX1BsYW50X0lEID9QbGFudElkLlwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIgRklMVEVSICggcmVnZXgoP1BsYW50SWQsJ1wiICsgICgkc2NvcGUubWVtYmVyU3RhdGVWYWx1ZSB8fCAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5CYXNpY0RhdGEuTWVtYmVyU3RhdGUpICtcIicpIClcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIH0gIE9SREVSIEJZIERFU0MoP1BsYW50SWQpIExJTUlUIDEgXCIgO1xuXG4gICAgICAgICAgICAgICAgdXJsID0gYmFzZVVyaSArICcvcmVzdFByb3h5P3VyaT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCArIGVuY29kZVVSSUNvbXBvbmVudChzcGFycWwpKTtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsLCB7dHJhY2tlciA6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbigpe2FsZXJ0KFwiRmFpbGVkIHRvIHJlYWQgZGF0YSBmcm9tIHJlbW90ZSBkYXRhYnNlLiBQbGVhc2UgY2hlY2sgeW91ciBjb25uZWN0aW9uXCIpOyBxLnJlamVjdCgpO30pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZXBydHJEYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXh0SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggZXBydHJEYXRhLnJlc3VsdHMuYmluZGluZ3MubGVuZ3RoID4gMCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dElkID0gcGFyc2VJbnQoIGVwcnRyRGF0YS5yZXN1bHRzLmJpbmRpbmdzWzBdLlBsYW50SWQudmFsdWUuc2xpY2UoMikgKSArIDEgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGZvcm1OZXh0UGxhbnRJZCA+IG5leHRJZCApIG5leHRJZCA9IGZvcm1OZXh0UGxhbnRJZCA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIG5leHRJZCA9IGZvcm1OZXh0UGxhbnRJZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3UGxhbnRJZCA9ICAgKCRzY29wZS5tZW1iZXJTdGF0ZVZhbHVlIHx8ICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkJhc2ljRGF0YS5NZW1iZXJTdGF0ZSkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZCggIG5leHRJZCAsIDQgKSA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja1NEUyAoIG5ld1BsYW50SWQgKSA7XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY2hlY2tTRFMgKCBwbGFudElkX2NhbmRpZGF0ZSApIDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHEucHJvbWlzZSA7XG5cbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5nZXRNYXhQbGFudElkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgb3JkZXJCeSA9ICRmaWx0ZXIoJ29yZGVyQnknKTtcbiAgICAgICAgICAgIHZhciBvcmRlcmVkSXRlbXMgPSBvcmRlckJ5KCAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQsIFwiUGxhbnRJZFwiLCB0cnVlKTtcbiAgICAgICAgICAgIHZhciBuZXh0UGxhbnRJZCA9IDE7XG4gICAgICAgICAgICB2YXIgbmV3UGxhbnRJZCA9IG51bGw7XG4gICAgICAgICAgICB2YXIgZXhpc3RzID0gbnVsbDtcblxuICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpIDwgb3JkZXJlZEl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc0VtcHR5KG9yZGVyZWRJdGVtc1tpXS5QbGFudElkICkgJiYgb3JkZXJlZEl0ZW1zW2ldLlBsYW50SWQgIT09IFwiXCIgKSB7XG4gICAgICAgICAgICAgICAgICAgIG5leHRQbGFudElkID0gcGFyc2VJbnQob3JkZXJlZEl0ZW1zW2ldLlBsYW50SWQuc3Vic3RyaW5nKG9yZGVyZWRJdGVtc1tpXS5QbGFudElkLmxlbmd0aCAtIDQgKSkgKyAxO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBmb3JtYXQgdGhlIGlkIDogWFhOTk5OLCB3aGVyZSBYWCBpcyB0aGUgbWVtYmVyc3RhdGUgY29kZSBhbmQgTk5OTiBpcyBhIHVuaXF1ZSBpbnRlZ2VyXG4gICAgICAgICAgICBmdW5jdGlvbiBwYWQobnVtLCBzaXplKSB7XG4gICAgICAgICAgICAgICAgdmFyIHMgPSBudW0rXCJcIjtcbiAgICAgICAgICAgICAgICB3aGlsZSAocy5sZW5ndGggPCBzaXplKSBzID0gXCIwXCIgKyBzO1xuICAgICAgICAgICAgICAgIHJldHVybiBzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBuZXdQbGFudElkID0gICgkc2NvcGUubWVtYmVyU3RhdGVWYWx1ZSB8fCAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5CYXNpY0RhdGEuTWVtYmVyU3RhdGUpICsgcGFkKCBuZXh0UGxhbnRJZCwgNCk7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXdQbGFudElkO1xuICAgICAgICB9XG5cbiAgICAgICAgJHJvb3RTY29wZS5nZXRJbnN0YW5jZUJ5UGF0aCA9IGZ1bmN0aW9uKHJvb3QsIGlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2cocm9vdCk7XG4gICAgICAgICAgICBpZiAoISRzY29wZS5pbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdG9rZW5zID0gcm9vdC5zcGxpdChcIi5cIik7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRva2Vucyk7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gJHNjb3BlO1xuXG4gICAgICAgICAgICB3aGlsZSh0b2tlbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0W3Rva2Vucy5zaGlmdCgpXTtcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRva2VucyA9IGlkZW50aWZpZXIuc3BsaXQoXCIuXCIpO1xuXG4gICAgICAgICAgICB3aGlsZSh0b2tlbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0W3Rva2Vucy5zaGlmdCgpXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcblxuICAgICAgICAkcm9vdFNjb3BlLmdldFBsYW50QnlQYXRoID0gZnVuY3Rpb24ocGxhbnQsIGlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2cocm9vdCk7XG4gICAgICAgICAgICBpZiAoISRzY29wZS5pbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh0b2tlbnMpO1xuICAgICAgICAgICAgaWYocGxhbnQgIT0gbnVsbCl7XG4gICAgICAgICAgICAgcmVzdWx0ID0gcGxhbnQ7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgdmFyIHRva2VucyA9IGlkZW50aWZpZXIuc3BsaXQoXCIuXCIpO1xuXG4gICAgICAgICAgICB3aGlsZSh0b2tlbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0W3Rva2Vucy5zaGlmdCgpXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzYXZlIGluc3RhbmNlIGRhdGEuXG4gICAgICAgICRzY29wZS5zYXZlSW5zdGFuY2UgPSBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAvLyRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHBhc3NlZFRoZVFhcyA9ICRzY29wZS5ydW5RQXRlc3RzKCk7XG4gICAgICAgICAgICB2YXIgZm9ybUNvbXBsZXRlID0gJHNjb3BlLmlzRm9ybUNvbXBsZXRlKCk7XG5cblx0XHRcdGRhdGFSZXBvc2l0b3J5LnNhdmVJbnN0YW5jZSgkc2NvcGUuaW5zdGFuY2UpLmVycm9yKGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICAkbm90aWZpY2F0aW9uLmVycm9yKFwiU2F2ZVwiLCBcIkRhdGEgd2FzIG5vdCBzYXZlZCAhXCIpO30pXG5cbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgICAgICBpZiAoIHJlc3BvbnNlLmNvZGUgPT09IDAgKSB7XG4gICAgICAgICAgICAgICAgICBhbGVydChcIlRoZXJlIHdhcyBhbiBlcnJvciBkdXJpbmcgdGhlIHNhdmUgb3BlcmF0aW9uLiBEYXRhIGlzIG5vdCBzYXZlZC5cIilcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmFwcEZvcm0uJGludmFsaWQgfHwgKCAhZm9ybUNvbXBsZXRlKSApIHtcbiAgICAgICAgICAgICAgICAgICAgJG5vdGlmaWNhdGlvbi5pbmZvKFwiU2F2ZVwiLCBcIkRhdGEgd2FzIHNhdmVkLCBidXQgdGhlIHF1ZXN0aW9ubmFpcmUgaXMgaW5jb21wbGV0ZS5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFwYXNzZWRUaGVRYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgJG5vdGlmaWNhdGlvbi5pbmZvKFwiU2F2ZVwiLCBcIkRhdGEgd2FzIHNhdmVkLCBidXQgdGhlIHF1ZXN0aW9ubmFpcmUgZGlkIG5vdCBwYXNzIHNvbWUgUUFzLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRub3RpZmljYXRpb24uc3VjY2VzcyhcIlNhdmVcIiwgXCJEYXRhIGlzIHNhdmVkIHN1Y2Nlc3NmdWxseS5cIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFwcEZvcm0uJHNldFByaXN0aW5lKHRydWUpO1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9O1xuXG4gICAgICAgICAkc2NvcGUuaGFzQXJ0aWNsZTMxRGVyb2dhdGlvblZhbHVlID0gZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgICAgICAgLy8gY2hlY2sgYWdhaW5zdCB0aGlzIHZhbHVlOiBodHRwOi8vZGQuZWlvbmV0LmV1cm9wYS5ldS92b2NhYnVsYXJ5Y29uY2VwdC9ldXJlZ2lzdHJ5b25pbmR1c3RyaWFsc2l0ZXMvRGVyb2dhdGlvblZhbHVlL0FydGljbGUzMS9cbiAgICAgICAgICAgICBpZihpdGVtLlBsYW50RGV0YWlscyE9bnVsbCAmJiBpdGVtLlBsYW50RGV0YWlscy5EZXJvZ2F0aW9uIT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgIGlmKGl0ZW0uUGxhbnREZXRhaWxzLkRlcm9nYXRpb24uaW5kZXhPZihcIkFydGljbGUzMVwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICB9XG5cbiAgICAgICAgICRzY29wZS5oYXNBcnRpY2xlMzVEZXJvZ2F0aW9uVmFsdWUgPSBmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgICAgICAvLyBjaGVjayBhZ2FpbnN0IHRoaXMgdmFsdWU6IGh0dHA6Ly9kZC5laW9uZXQuZXVyb3BhLmV1L3ZvY2FidWxhcnljb25jZXB0L2V1cmVnaXN0cnlvbmluZHVzdHJpYWxzaXRlcy9EZXJvZ2F0aW9uVmFsdWUvQXJ0aWNsZTM1L1xuICAgICAgICAgICAgIGlmKGl0ZW0uUGxhbnREZXRhaWxzIT1udWxsICYmIGl0ZW0uUGxhbnREZXRhaWxzLkRlcm9nYXRpb24hPSBudWxsKXtcbiAgICAgICAgICAgICAgICAgaWYoaXRlbS5QbGFudERldGFpbHMuRGVyb2dhdGlvbi5pbmRleE9mKFwiQXJ0aWNsZTM1XCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgfVxuICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgIH1cblxuXG4gICAgICAgICAkc2NvcGUuYWRkRGVzdWxwaHVyaXphdGlvblZhbHVlc0ZvckVhY2hNb250aD1mdW5jdGlvbihpLHBsYW50KXtcbiAgICAgICAgICAgICAgICAgcGxhbnQuRGVzdWxwaHVyaXNhdGlvbi5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgXCJNb250aFZhbHVlXCI6JHNjb3BlLmNvZGVMaXN0Lk1vbnRobHlEZXN1bHBodXJpc2F0aW9uW2ldLk1vbnRoVmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIFwiRGVzdWxwaHVyaXNhdGlvblJhdGVcIjogJHNjb3BlLmNvZGVMaXN0Lk1vbnRobHlEZXN1bHBodXJpc2F0aW9uW2ldLkRlc3VscGh1cmlzYXRpb25SYXRlLFxuICAgICAgICAgICAgICAgICAgICBcIlN1bHBodXJDb250ZW50XCI6ICRzY29wZS5jb2RlTGlzdC5Nb250aGx5RGVzdWxwaHVyaXNhdGlvbltpXS5TdWxwaHVyQ29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgXCJUZWNobmljYWxKdXN0aWZpY2F0aW9uXCI6ICRzY29wZS5jb2RlTGlzdC5Nb250aGx5RGVzdWxwaHVyaXNhdGlvbltpXS5UZWNobmljYWxKdXN0aWZpY2F0aW9uLFxuICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgfVxuICAgICAgICAkc2NvcGUuaXNGb3JtQ29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyByZXR1cm5zIHRydWUgaWYgdGhlIHJlcXVpcmVkIGZpZWxkcyBmb3IgYWxsIHBsYW50IGFyZSBmaWxsZWQ7IGZhbHNlIGlmIG5vdCB+XG5cbiAgICAgICAgICAgIHZhciByZXMgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHBsYW50cyA9ICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudDtcbiAgICAgICAgICAgIHZhciBwbGFudCA9IG51bGw7XG4gICAgICAgICAgICB2YXIgaiA9IG51bGw7XG5cbiAgICAgICAgICAgIGZvciAoIGk9MCA7IGkgPCBwbGFudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBwbGFudCA9IHBsYW50c1tpXTtcbiAgICAgICAgICAgICAgICAvLyBsaXN0IG9mIHBsYW50c1xuICAgICAgICAgICAgICAgIGlmICggaXNFbXB0eSAocGxhbnQuUGxhbnRJZCkgfHwgaXNFbXB0eSggcGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5MYXRpdHVkZSkgfHwgaXNFbXB0eSAoIHBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTG9uZ2l0dWRlKSAgIClcbiAgICAgICAgICAgICAgICAgICAgcmVzID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAvLyBwbGFudCBkZXRhaWxzXG4gICAgICAgICAgICAgICAgaWYgKCBpc0VtcHR5ICggcGxhbnQuUGxhbnREZXRhaWxzLk1XdGgpIClcbiAgICAgICAgICAgICAgICAgICAgcmVzID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAvLyBlbmVyZ3kgaW5wdXRcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGZvciAgKCBqIGluICggKCBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQpKSApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgICggaXNFbXB0eSAocGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0WyBqXSkgKVxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0WyBqXSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZm9yICggaiBpbiAoICggcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLlRvdGFsRW1pc3Npb25zVG9BaXIpKSApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzRW1wdHkgKHBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5Ub3RhbEVtaXNzaW9uc1RvQWlyWyBqXSkpXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuVG90YWxFbWlzc2lvbnNUb0Fpclsgal0gPSAwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvciAoIGogaW4gKCAoIHBsYW50LkRlc3VscGh1cmlzYXRpb24pKSApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzRW1wdHkgKHBsYW50LkRlc3VscGh1cmlzYXRpb25bIGpdKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LkRlc3VscGh1cmlzYXRpb25bIGpdID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICggaiBpbiAoICggcGxhbnQuVXNlZnVsSGVhdCkpICkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNFbXB0eSAocGxhbnQuVXNlZnVsSGVhdFsgal0pKVxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuVXNlZnVsSGVhdFsgal0gPSAwO1xuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgaWYgKHJlcyA9PT0gZmFsc2UpIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuXG5cbiAgICAgICAgfVxuXG5cbiAgICAgICAgJHNjb3BlLnJ1blFBdGVzdHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIC8vIGNvbmZvcm0gdGhlIGluc3RhbmNlIGlmIG5lZWRlZFxuXG4gICAgICAgICAgICB2YXIgcmVzID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBwbGFudHMgPSAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQ7XG5cbiAgICAgICAgICAgIGlmIChwbGFudHMubGVuZ3RoICE9ICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkJhc2ljRGF0YS5OdW1iZXJPZlBsYW50cylcbiAgICAgICAgICAgICAgICByZXMgPSBmYWxzZTtcblxuICAgICAgICAgICAgdmFyIHNlY3RvcnMgPSB7fTtcbiAgICAgICAgICAgIHZhciBzdGF0dXMgID0ge307XG5cbiAgIC8vICAgICAgICAgZm9yIChpIGluICRzY29wZS5jb2RlTGlzdC5MQ1BDb2RlbGlzdHMuc2VjdG9ycy5jb25jZXB0cykgeyAgc2VjdG9yc1sgJHNjb3BlLmNvZGVMaXN0LkxDUENvZGVsaXN0cy5zZWN0b3JzLmNvbmNlcHRzWyBpIF0gWydAaWQnXSBdID0gMSA7IH1cbiAgICAgICAgICAgIC8vIHNlY3RvcnMgaXMgYSBkaWN0aW9uYXJ5IG9mIHZhbGlkIG90aGVyIHNlY3RvciB2YWx1ZXNcblxuICAgICAgICAvLyAgICBmb3IgKGkgaW4gJHNjb3BlLmNvZGVMaXN0LkxDUENvZGVsaXN0cy5zdGF0dXMuY29uY2VwdHMpIHsgIHN0YXR1c1sgJHNjb3BlLmNvZGVMaXN0LkxDUENvZGVsaXN0cy5zdGF0dXMuY29uY2VwdHNbIGkgXSBbJ0BpZCddIF0gPSAxIDsgfVxuXG4gICAgICAgICAgICB2YXIgbmFtZXMgPSB7fTtcbiAgICAgICAgICAgIHZhciBkdWJsaWNhdGVzID0ge307XG4gICAgICAgICAgICB2YXIgcmVmRGF5ID0gbmV3IERhdGUoXCIyMDAzLTExLTI3XCIpO1xuXG4gICAgICAgICAgICBmb3IgKCBpPTAgOyBpIDwgcGxhbnRzLmxlbmd0aDsgaSsrKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBMQ1AgMS4xXG4gICAgICAgICAgICAgICAgLy8gbm90IHJlZmluZXJ5XG5cbiAgICAgICAgICAgICAgICBpZiAoICFwbGFudHNbaV0uUGxhbnREZXRhaWxzKSBjb250aW51ZTsgLy8gc29tZSB0aW1lcyBhIG51bGwgcGxhbnQgd2FzIHByZXNlbnQgYXQgdGhlIGVuZCBvZiB0aGUgYXJyYXlcblxuICAgICAgICAgICAgICAgIC8vIGNvb3JkaW5hdGVzXG4gICAgICAgICAgICAgICAgaWYgKCBwbGFudHNbaV0uR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5Mb25naXR1ZGUgPiAxODAgfHwgcGxhbnRzW2ldLkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTG9uZ2l0dWRlIDwgLTE4MClcbiAgICAgICAgICAgICAgICAgICAgcmVzID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBpZiAoIHBsYW50c1tpXS5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxhdGl0dWRlID4gOTAgfHwgcGxhbnRzW2ldLkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTGF0aXR1ZGUgPCAtOTApXG4gICAgICAgICAgICAgICAgICAgIHJlcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgIC8vICAgICBpZiAoICEoIHBsYW50c1tpXS5QbGFudERldGFpbHMuUmVmaW5lcmllcykgJiYgKCAhKCBwbGFudHNbaV0uUGxhbnREZXRhaWxzLk90aGVyU2VjdG9yICApICB8fCAhIChzZWN0b3JzW3BsYW50c1tpXS5QbGFudERldGFpbHMuT3RoZXJTZWN0b3IgXSApKSApe1xuICAgICAgICAgICAgICAgICAgICAvLyBeXiBjaGVja3MgdGhhdCBpZiBub3QgUmVmaW5lcmllcywgdGhhdCBPdGhlclNlY3RvciBpcyBmaWxsZWQgd2l0aCBvbmUgb2YgdGhlIHBlcm1pdHRlZCB2YWx1ZXMoZmV0Y2hlZCBmcm9tIEREKVxuICAgICAgICAgICAgLy8gICAgICAgIHJlcyA9IGZhbHNlO1xuICAgICAgICAgICAgIC8vICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCAhICggKCBwbGFudHNbaV0uUGxhbnREZXRhaWxzLlN0YXR1c09mVGhlUGxhbnQgPT09IG51bGwgKSB8fCAoIHBsYW50c1tpXS5QbGFudERldGFpbHMuU3RhdHVzT2ZUaGVQbGFudCA9PT0gXCJcIiApIHx8IHN0YXR1cyBbIHBsYW50c1tpXS5QbGFudERldGFpbHMuU3RhdHVzT2ZUaGVQbGFudF0gKSApXG4gICAgICAgICAgICAgICAgICAgIHJlcyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgLy8gTENQIDIuMSBVbmVxdWl2b2NhbCBuYW1pbmcgb2YgcGxhbnRzXG4gICAgICAgICAgICAgICAgaWYgKCBuYW1lc1sgcGxhbnRzW2ldLlBsYW50TmFtZSBdICE9IHVuZGVmaW5lZCApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZHVibGljYXRlIGZvdW5kXG4gICAgICAgICAgICAgICAgICAgIGR1YmxpY2F0ZXNbaV0gPSAxO1xuICAgICAgICAgICAgICAgICAgICBkdWJsaWNhdGVzWyBuYW1lc1sgcGxhbnRzIFtpXS5QbGFudE5hbWUgXSBdID0gMTtcbiAgICAgICAgICAgICAgICAgICAgLy9uYW1lc1skc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnRbaV0uUGxhbnROYW1lIF0ucHVzaChpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBuYW1lc1sgcGxhbnRzIFtpXS5QbGFudE5hbWVdID0gaTtcblxuICAgICAgICAgICAgICAgIC8vIExDUCAzLjJcblxuICAgICAgICAgICAgICAgIGlmICggcGxhbnRzW2ldLlBsYW50RGV0YWlscy5NV3RoIDwgNTAgKXtcbiAgICAgICAgICAgICAgICAgICAgLy8gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgcmVzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCBwbGFudHNbaV0uUGxhbnREZXRhaWxzLk1XdGggPiAxMDAwMCl7XG4gICAgICAgICAgICAgICAgICAgIC8vIHdhcm5pbmdcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coaSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gTENQIDMuNFxuICAgICAgICAgICAgICAgIGlmICggcGxhbnRzW2ldLlBsYW50RGV0YWlscy5FeHRlbnNpb25CeTUwTVdPck1vcmUgJiYgISggcGxhbnRzW2ldLlBsYW50RGV0YWlscy5DYXBhY2l0eUFkZGVkTVcgPj0gNTAgKSApe1xuICAgICAgICAgICAgICAgICAgICAvLyBlcnJvclxuICAgICAgICAgICAgICAgICAgICByZXMgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBMQ1AgMy41XG4gICAgICAgICAgICAgICAgaWYgKCBwbGFudHNbaV0uUGxhbnREZXRhaWxzLlN1YnN0YW50aWFsQ2hhbmdlICYmICEoIHBsYW50c1tpXS5QbGFudERldGFpbHMuQ2FwYWNpdHlBZmZlY3RlZE1XID49IDAgKSApe1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBMQ1AgMy42XG4gICAgICAgICAgICAgICAgLy8gdmFsaWQgZGF0ZXMoaWYgZGF0ZSBzdWJtaXR0ZWQpXG4gICAgICAgICAgICAgICAgaWYgKCAhJHNjb3BlLnZhbGlkRGF0ZUZvcm1hdChwbGFudHNbaV0uUGxhbnREZXRhaWxzLkRhdGVPZlN0YXJ0T2ZPcGVyYXRpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICggcGxhbnRzW2ldLlBsYW50RGV0YWlscy5EYXRlT2ZTdGFydE9mT3BlcmF0aW9uICkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICggKCBwbGFudHNbaV0uUGxhbnREZXRhaWxzLlN0YXR1c09mVGhlUGxhbnQgPT09IFwiYXJ0XzRfMVwiIHx8IHBsYW50c1tpXS5QbGFudERldGFpbHMuU3RhdHVzT2ZUaGVQbGFudCA9PT0gXCJhcnRfNF8zXCIgKSAmJlxuICAgICAgICAgICAgICAgICAgICAgKCBuZXcgRGF0ZSAocGxhbnRzW2ldLlBsYW50RGV0YWlscy5EYXRlT2ZTdGFydE9mT3BlcmF0aW9uKSA+IHJlZkRheSApICl7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlcnJvclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICggKCBwbGFudHNbaV0uUGxhbnREZXRhaWxzLlN0YXR1c09mVGhlUGxhbnQgPT09IFwiYXJ0XzRfMlwiICkgJiZcbiAgICAgICAgICAgICAgICAgICAgICggbmV3IERhdGUgKHBsYW50c1tpXS5QbGFudERldGFpbHMuRGF0ZU9mU3RhcnRPZk9wZXJhdGlvbikgPD0gcmVmRGF5ICkgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICBcblxuICAgICAgICAgICAgfS8vIGVuZCBmb3JcbiAgICAgICAgICAgIGlmICggSlNPTi5zdHJpbmdpZnkoZHVibGljYXRlcykgIT09IFwie31cIikge1xuICAgICAgICAgICAgICAgIC8vIGR1cGxpY2F0ZXMgaG9sZHMgdGhlIHBsYW50cyB3aXRoIHNhbWUgbmFtZXNcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkdWJsaWNhdGVzKTtcbiAgICAgICAgICAgICAgICByZXMgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICggcmVzID09PSB0cnVlICkgICRzY29wZS5jb25mb3JtVGhlSW5zdGFuY2UoKTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuY29uZm9ybVRoZUluc3RhbmNlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICB2YXIgcGxhbnRzID0gJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50O1xuICAgICAgICAgICAgZm9yIChqIGluIHBsYW50cyl7XG5cbiAgICAgICAgICAgICAgICBwbGFudCA9IHBsYW50c1tqXTtcblxuICAgICAgICAgICAgICAgIGRlbGV0ZSBwbGFudC5EZWxldGU7XG5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoIHBsYW50LnBsYW50RGV0YWlscyE9bnVsbCAmJiBwbGFudC5QbGFudERldGFpbHMuUmVmaW5lcmllcyAhPT0gdHJ1ZSApe1xuICAgICAgICAgICAgICAgICAgICBwbGFudC5QbGFudERldGFpbHMuUmVmaW5lcmllcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocGxhbnQucGxhbnREZXRhaWxzIT1udWxsICYmIHBsYW50LlBsYW50RGV0YWlscy5SZWZpbmVyaWVzID09PSB0cnVlICl7XG4gICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50RGV0YWlscy5PdGhlclNlY3RvciA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLmlmRm9ybUlzVmFsaWRTYXZlSW5zdGFuY2UgPSBmdW5jdGlvbihmb3JtKXtcbiAgICAgICAgICAgIGlmICghZm9ybS4kaW52YWxpZCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zYXZlSW5zdGFuY2UoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLnZhbGlkYXRpb25Pbk9mZiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9ICEkc2NvcGUuc3VibWl0dGVkO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHNhdmUgaW5zdGFuY2UgZGF0YS5cbiAgICAgICAgJHNjb3BlLmNsb3NlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlmIChiYXNlVXJpID09ICcnKXtiYXNlVXJpID0gXCIvXCJ9O1xuICAgICAgICAgICAgdmFyIHdpbmRvd0xvY2F0aW9uID0gKGVudmVsb3BlICYmIGVudmVsb3BlLmxlbmd0aCA+IDApID8gZW52ZWxvcGUgOiBiYXNlVXJpO1xuICAgICAgICAgICAgaWYgKCRzY29wZS5hcHBGb3JtLiRkaXJ0eSl7XG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpcm0oJ1lvdSBoYXZlIG1hZGUgY2hhbmdlcyBpbiB0aGUgcXVlc3Rpb25uYWlyZSEgXFxuXFxuIERvIHlvdSB3YW50IHRvIGxlYXZlIHdpdGhvdXQgc2F2aW5nIHRoZSBkYXRhPycpKXtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gd2luZG93TG9jYXRpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8vL2NvbnNvbGUubG9nKFwiRmFpbGVkIHRvIGNvbmZpcm1cIik7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gd2luZG93TG9jYXRpb247XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8vIGNvbnZlcnQgWE1MIHRvIEhUTUwgaW4gbmV3IHdpbmRvdy5cbiAgICAgICAgJHNjb3BlLnByaW50UHJldmlldyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBkYXRhUmVwb3NpdG9yeS5zYXZlSW5zdGFuY2UoJHNjb3BlLmluc3RhbmNlKS5zdWNjZXNzKGZ1bmN0aW9uKCl7XG5cdFx0XHRcdHZhciB3aW4gPSB3aW5kb3cub3Blbigkc2NvcGUuY29udmVyc2lvbkxpbmssICdfYmxhbmsnKTtcblx0XHRcdFx0d2luLmZvY3VzO1xuXHRcdFx0fSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5jbG9zZUJ1bGtFZGl0TGlzdE9mUGxhbnRzID0gZnVuY3Rpb24oZm9ybSl7XG4gICAgICAgICAgICAvL2lmIChmb3JtICYmIGZvcm0gPT0gJ0xpc3RPZlBsYW50cycpe1xuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGVtcHR5IHJvd3NcbiAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pe1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBwbGFudCA9ICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudFtpXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIHBsYW50LlBsYW50TG9jYXRpb24hPW51bGwgJiYgaXNFbXB0eShwbGFudC5QbGFudE5hbWUpICAmJiBpc0VtcHR5KHBsYW50LkVQUlRSTmF0aW9uYWxJZCkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzRW1wdHkocGxhbnQuUGxhbnRMb2NhdGlvbi5BZGRyZXNzMSkgJiYgaXNFbXB0eShwbGFudC5QbGFudExvY2F0aW9uLkFkZHJlc3MyKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNFbXB0eShwbGFudC5QbGFudExvY2F0aW9uLkNpdHkpICYmIGlzRW1wdHkocGxhbnQuUGxhbnRMb2NhdGlvbi5SZWdpb24pICYmIGlzRW1wdHkocGxhbnQuUGxhbnRMb2NhdGlvbi5Qb3N0YWxDb2RlKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNFbXB0eShwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxvbmdpdHVkZSkgJiYgaXNFbXB0eShwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxhdGl0dWRlKSAmJiBpc0VtcHR5KHBsYW50LkZhY2lsaXR5TmFtZSkpXG5cbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50LnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGZpbGwgaW4gcGxhbnQgSURzXG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCBpc0VtcHR5KHBsYW50LlBsYW50SWQpICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb21pc2UgPSAkc2NvcGUuZ2V0TmV4dFBsYW50SWQgKCkgO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld1BsYW50ID0gcGxhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB1c2luZyAkcSBwcm9taXNlIEFQSSwgdG8gYXNrIHRoZSBzZXJ2ZXIgZmlyc3QgZm9yIGlkIGNvbGxpc2lvbnMuXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlLnRoZW4gKCBmdW5jdGlvbiAoIHBsYW50aWQgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3UGxhbnQuUGxhbnRJZCA9IHBsYW50aWQgO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgJHNjb3BlLmNvbmZvcm1UaGVJbnN0YW5jZSgpO1xuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICRyb290U2NvcGUuYnVsa0VkaXRMaXN0T2ZQbGFudHMgPSBmYWxzZTtcbiAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgndXBkYXRlRmlsdGVyJyk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5vcGVuQnVsa0VkaXRMaXN0T2ZQbGFudHMgPSBmdW5jdGlvbihmb3JtKSB7XG4gICAgICAgICAgICBpZiAoZm9ybSAmJiBmb3JtID09PSAnTGlzdE9mUGxhbnRzJykge1xuICAgICAgICAgICAgICAgICRzY29wZS5hZGRJdGVtKCdMQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudC5sZW5ndGggPT09IDApIHtcblxuICAgICAgICAgICAgICAgICRub3RpZmljYXRpb24uaW5mbyhcIkVkaXRcIiwgXCJBZGQgc29tZSBwbGFudHMgZnJvbSBMaXN0IG9mIFBsYW50cyBmaXJzdC5cIik7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICRyb290U2NvcGUuYnVsa0VkaXRMaXN0T2ZQbGFudHMgPSB0cnVlO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS53aW5kb3dTZWFyY2ggPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoO1xuXG4gICAgICAgICRzY29wZS5nZXRIZWxwSW5mbyA9IGZ1bmN0aW9uKGRpdklkKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRpdklkKTtcbiAgICAgICAgICAgIHZhciBpbmZvRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGl2SWQpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhpbmZvRGl2KTtcbiAgICAgICAgICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKGluZm9EaXYuaW5uZXJIVE1MKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuY2hhbmdlSW5mb1RvZ2dsZSA9IGZ1bmN0aW9uKG92ZXJJbmZvVG9nZ2xlKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2hvd0luZm8gPSBvdmVySW5mb1RvZ2dsZTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUucGhvbmVOdW1iZXJQYXR0ZXJuID0gL15bIDAtOVxcKFxcKVxcK1xcLV17NywyNX0kLztcbiAgICAgICAgJHNjb3BlLnBvc2l0aXZlSW50ZWdlclBhdHRlcm4gPSAvXlxcZCskLztcbiAgICAgICAgJHNjb3BlLnBvc2l0aXZlRGVjaW1hbE51bWJlclBhdHRlcm4gPSAvXlxcZCpcXC4/XFxkKiQvO1xuICAgICAgICAkc2NvcGUuYmluYXJ5TnVtYmVyUGF0dGVybj0vXlswLTFdLztcbiAgICAgICAgJHNjb3BlLmRlY2ltYWxOdW1iZXJQYXR0ZXJuID0vXlsrLV0/KFxcZCpcXC4/XFxkKikkLztcbiAgICAgICAgJHNjb3BlLmRhdGVGb3JtYXQgPSAvXigxOXwyMClcXGRcXGQoWy1dKSgwWzEtOV18MVswMTJdKVxcMigwWzEtOV18WzEyXVswLTldfDNbMDFdKSQvO1xuXG4gICAgICAgICRzY29wZS53ZWJzaXRlQWRkcmVzc1BhdHRlcm4gPSAvXihodHRwcz86XFwvXFwvKT8oW1xcZGEtelxcLi1dKylcXC4oW2EtelxcLl17Miw2fSkoW1xcL1xcdyBcXC4tXSopKlxcLz8kLztcbiAgICAgICAgJHNjb3BlLnBlcmNlbnRhZ2VQYXR0ZXJuID0gL14xMDAkfF5bMC05XXsxLDJ9JHxeWzAtOV17MSwyfVxcLFswLTldezEsM30kLztcbiAgICAgICAgJHNjb3BlLmxvbmdpdHVkZU51bWJlclBhdHRlcm4gPSAvXlstK10/KDE4MChcXC4wKyk/fCgoMVswLTddXFxkKXwoWzEtOV0/XFxkKSkoXFwuXFxkKyk/KSQvO1xuXG4gICAgICAgICRzY29wZS5sYXRpdHVkZU51bWJlclBhdHRlcm4gPSAvXlstK10/KFsxLThdP1xcZChcXC5cXGQrKT98OTAoXFwuMCspPykkLztcblxuICAgICAgICAkc2NvcGUuaXNGaXhlZFF1ZXN0aW9uID0gZnVuY3Rpb24oZGF0YVBhdGgpIHtcbiAgICAgICAgICAgIHZhciB0b2tlbnMgPSBkYXRhUGF0aC5zcGxpdCgnLicpO1xuICAgICAgICAgICAgdmFyIGxhc3RUb2tlbiA9IHRva2Vucy5wb3AoKTtcbiAgICAgICAgICAgIC8vLy9jb25zb2xlLmxvZyhsYXN0VG9rZW4pO1xuICAgICAgICAgICAgLy8vL2NvbnNvbGUubG9nKGxhc3RUb2tlbiA9PSAnRml4ZWRRdWVzdGlvbicpO1xuICAgICAgICAgICAgcmV0dXJuIChsYXN0VG9rZW4gPT0gJ0ZpeGVkUXVlc3Rpb24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5jbGVhclN1YkZvcm1EYXRhID0gZnVuY3Rpb24oZGF0YVBhdGhzLCBpZGVudGlmaWVyUGF0aCwgY2hhbmdlVmFsdWVUbykge1xuXG4gICAgICAgICAgICB2YXIgZWxlbWVudENvdW50ID0gMDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YVBhdGhzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZvcm1FbGVtZW50SW5zdGFuY2UgPSAkc2NvcGUuZ2V0SW5zdGFuY2VCeVBhdGgoJ2luc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUnLCBkYXRhUGF0aHNbaV0pO1xuICAgICAgICAgICAgICAgIGVsZW1lbnRDb3VudCArPSBjb3VudE5vbkVtcHR5UHJvcGVydGllcyhmb3JtRWxlbWVudEluc3RhbmNlLCAkc2NvcGUuaXNGaXhlZFF1ZXN0aW9uKGRhdGFQYXRoc1tpXSkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBOZWVkIHRvIGdldCBwYXJlbnQgcGF0aCBvZiB5ZXMvbm8gcXVlc3Rpb24gb3RoZXJ3aXNlIGFzc2lnbmluZyBuZXcgdmFsdWVcbiAgICAgICAgICAgIC8vIHRvIHByb3BlcnR5IGRvZXMgbm90IHdvcmsuXG4gICAgICAgICAgICB2YXIgdG9rZW5zID0gaWRlbnRpZmllclBhdGguc3BsaXQoJy4nKTtcblxuICAgICAgICAgICAgLy8gUGFyZW50IHByb3BlcnR5IG9mIGFjdHVhbCB5ZXMvbm8gcXVlc3Rpb25cbiAgICAgICAgICAgIHZhciBzdWJGb3JtSW5zdGFuY2VJZGVudGlmaWVyID0gdG9rZW5zLnNoaWZ0KCk7XG5cbiAgICAgICAgICAgIC8vIFBhcmVudCBpbnN0YW5jZSBvYmplY3QgdGhhdCBjb250YWlucyBhY3R1YWwgeWVzL25vIHF1ZXN0aW9uIHByb3BlcnR5XG4gICAgICAgICAgICB2YXIgcGFyZW50SW5zdGFuY2UgPSAkc2NvcGUuZ2V0SW5zdGFuY2VCeVBhdGgoJ2luc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUnLCBzdWJGb3JtSW5zdGFuY2VJZGVudGlmaWVyKTtcbiAgICAgICAgICAgIHZhciBvYmplY3ROYW1lID0gdG9rZW5zLnNoaWZ0KCk7XG5cbiAgICAgICAgICAgIHZhciBuZWVkc1RvQ2xlYXJEYXRhID0gdHJ1ZTtcblxuICAgICAgICAgICAgaWYgKG5lZWRzVG9DbGVhckRhdGEpIHtcbiAgICAgICAgICAgICAgICAvLyBXaGVuIGVsZW1lbnQgY291bnQgaXMgbW9yZSB0aGFuIDAgdGhlbiB3ZSBoYXZlIHRvIGFzayBjb25maXJtYXRpb24gZnJvbSB1c2VyIHdoZXRoZXIgdG8gZGVsZXRlIHRoZSBkYXRhLlxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Q291bnQgPiAwICYmICFjb25maXJtKCdXaGVuIGNoYW5naW5nIGFuc3dlciBhbGwgZGF0YSB1bmRlciB0aGlzIHN1Yi1mb3JtIHdpbGwgYmUgbG9zdD8nKSl7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRva2Uuc2hpZnQoKSBleHRyYWN0cyB5ZXMvbm8gcXVlc3Rpb24gbmFtZS5cbiAgICAgICAgICAgICAgICAgICAgLy8gQXNzaW5nIHllcyB2YWx1ZSB0byBxdWVzdGlvblxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRJbnN0YW5jZVtvYmplY3ROYW1lXSA9ICBjaGFuZ2VWYWx1ZVRvO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhUGF0aHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmb3JtRWxlbWVudEluc3RhbmNlID0gJHNjb3BlLmdldEluc3RhbmNlQnlQYXRoKCdpbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlJywgZGF0YVBhdGhzW2ldKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRm9yIGZpZWxkcyB3aGVyZSB0aGVyZSBpcyBvbmx5IG9uZSBmaWVsZCBhbmQgaXQgY2FuIGJlIG51bGwuIEp1c3QgaWdub3JlIGl0LlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmb3JtRWxlbWVudEluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaWYtZWxzZSBpcyB0byBkaWZmZXJlbnRpYXRlIGp1c3QgYSBzdHJpbmcgZmllbGQgZnJvbSBhcnJheSBvciBvYmplY3QuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9ybUVsZW1lbnRJbnN0YW5jZSBpbnN0YW5jZW9mIEFycmF5IHx8ICFmb3JtRWxlbWVudEluc3RhbmNlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyT2JqZWN0KGZvcm1FbGVtZW50SW5zdGFuY2UsICRzY29wZS5pc0ZpeGVkUXVlc3Rpb24oZGF0YVBhdGhzW2ldKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b2tlbnMgPSBkYXRhUGF0aHNbaV0uc3BsaXQoJy4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0SWRlbnRpZmllciA9IHRva2Vucy5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnRPYmplY3QgPSAkc2NvcGUuZ2V0SW5zdGFuY2VCeVBhdGgoJ2luc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUnLCBvYmplY3RJZGVudGlmaWVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRPYmplY3RbdG9rZW5zLnNoaWZ0KCldID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gRG8gbm90aGluZy5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAkcm9vdFNjb3BlLm90aGVyVHlwZU9mQ29tYnVzdGlvblBsYW50ID0gZmFsc2U7XG5cbiAgICAgICAgJHNjb3BlLmlzVHlwZU9mQ29tYnVzdGlvblBsYW50T3RoZXIgPSBmdW5jdGlvbiAocGxhbnQpIHtcbiAgICAgICAgICAgIGlmIChwbGFudC5QbGFudERldGFpbHMuVHlwZU9mQ29tYnVzdGlvblBsYW50ID09PSAnT3RoZXJzJykge1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUub3RoZXJUeXBlT2ZDb21idXN0aW9uUGxhbnQgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLm90aGVyVHlwZU9mQ29tYnVzdGlvblBsYW50ID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9UT0RPIGZvcm1hdCBlcnJvciBtZXNzYWdlIHRvIGhhbmRsZSBkaWZmZXJlbnQgbGltaXRzIGJldHRlclxuICAgICAgICAkc2NvcGUuZXJyb3JNZXNzYWdlcyA9IHtcbiAgICAgICAgICAgIFwicmVxdWlyZWRfZmllbGRcIiA6IFwiVGhpcyBpcyBhIHJlcXVpcmVkIGZpZWxkXCIsXG4gICAgICAgICAgICBcInVuaXF1ZV9hYmJyZXZpYXRpb25cIiA6IFwiUGxlYXNlIHByb3ZpZGUgYSB1bmlxdWUgYWJicmV2aWF0aW9uIFwiLFxuICAgICAgICAgICAgXCJ2YWxpZF90ZWxlcGhvbmVcIiA6IFwiUGxlYXNlIGVudGVyIGEgdmFsaWQgdGVsZXBob25lIG51bWJlciAoYXQgbGVhc3QgNyBkaWdpdHMpIFwiLFxuICAgICAgICAgICAgXCJ2YWxpZF9lbWFpbFwiIDogXCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzIFwiLFxuICAgICAgICAgICAgXCJ2YWxpZF91cmxcIiA6IFwiUGxlYXNlIGVudGVyIGEgdmFsaWQgVVJMIFwiLFxuICAgICAgICAgICAgXCJ5ZXNfb3Jfbm9cIiA6IFwiUGxlYXNlIGNob29zZSB5ZXMgb3Igbm8gXCIsXG4gICAgICAgICAgICBcIm51bWJlcl9ncmVhdGVyX3RoYW5femVyb1wiIDogXCJQbGVhc2UgcHJvdmlkZSBhIG51bWJlciBncmVhdGVyIHRoYW4gMCBcIixcbiAgICAgICAgICAgIFwiZGF0YV9lbnRyeV9tdXN0X2JlX3VuaXF1ZVwiIDogXCJEYXRhIGVudHJ5IG11c3QgYmUgdW5pcXVlIElEIGNvZGUgXCIsXG4gICAgICAgICAgICBcIm11c3RfYmVfbGVzc190aGFuXCIgOiBcIlBsZWFzZSBwcm92aWRlIGEgbnVtYmVyIGxlc3MgdGhhbiBcIixcbiAgICAgICAgICAgIFwibXVzdF9iZV9ncmVhdGVyX3RoYW5cIiA6IFwiUGxlYXNlIHByb3ZpZGUgYSBudW1iZXIgZ3JlYXRlciBvciBlcXVhbCB0byBcIixcbiAgICAgICAgICAgIFwibXVzdF9iZV9wZXJjZW50YWdlXCIgOiBcIlBsZWFzZSBwcm92aWRlIGEgcGVyY2VudGFnZSBiZXR3ZWVuIDAgYW5kIDEwMCBcIixcbiAgICAgICAgICAgIFwid2hvbGVfbnVtYmVyX2dyZWF0ZXJfdGhhbl96ZXJvXCIgOiBcIlBsZWFzZSBwcm92aWRlIGEgd2hvbGUgbnVtYmVyIGdyZWF0ZXIgdGhhbiAwIFwiLFxuICAgICAgICAgICAgXCJ1bmlxdWVfaWRlbnRpZmljYXRpb25fY29kZVwiIDogXCJQbGVhc2UgZW50ZXIgYSB1bmlxdWUgaWRlbnRpZmljYXRpb24gY29kZSBcIixcbiAgICAgICAgICAgIFwidmFsaWRfbG9uZ2l0dWRlXCIgOiBcIlBsZWFzZSBwcm92aWRlIGEgbnVtYmVyIGJldHdlZW4gLTE4MCBhbmQgMTgwXCIsXG4gICAgICAgICAgICBcInZhbGlkX2xhdGl0dWRlXCIgOiBcIlBsZWFzZSBwcm92aWRlIGEgbnVtYmVyIGJldHdlZW4gLTkwIGFuZCA5MFwiLFxuICAgICAgICAgICAgXCJwb3NpdGl2ZV9kZWNpbWFsXCIgOiBcIlBsZWFzZSBwcm92aWRlIGEgcG9zaXRpdmUgZGVjaW1hbCBudW1iZXIgIFwiLFxuICAgICAgICAgICAgXCJwb3NpdGl2ZV9kZWNpbWFsMDFcIiA6IFwiUGxlYXNlIHByb3ZpZGUgYSBwb3NpdGl2ZSBkZWNpbWFsIG51bWJlciBiZXR3ZWVuIDAgYW5kIDFcIixcbiAgICAgICAgICAgIFwicG9zaXRpdmVfaW50ZWdlclwiIDogXCJQbGVhc2UgcHJvdmlkZSBhIHBvc2l0aXZlIGludGVnZXIgXCIsXG4gICAgICAgICAgICBcImFydGljbGVfZm9ybWF0XCIgOiBcIlBsZWFzZSB1c2UgdGhlIGVkaXQgbWVudSB0byBjb3JyZWN0IHRoZSBhcnRpY2xlIGZvcm1hdFwiXG5cbiAgICAgICAgfTtcblxuXG4gICAgICAgICRzY29wZS5nZXRFcnJvck1lc3NhZ2UgPSBmdW5jdGlvbihlcnJvckNvZGUpIHtcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUuZXJyb3JNZXNzYWdlc1tlcnJvckNvZGVdO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5zaG93RXJyb3IgPSBmdW5jdGlvbihtb2RlbENvbnRyb2xsZXIsIGVycm9yQ29kZSkge1xuICAgICAgICAgICAgcmV0dXJuIG1vZGVsQ29udHJvbGxlci4kZXJyb3JbZXJyb3JDb2RlXSAmJiBtb2RlbENvbnRyb2xsZXIuJGludmFsaWRcbiAgICAgICAgICAgICAgICAgICAgJiYgIShlcnJvckNvZGUgPT09ICdyZXF1aXJlZCcgJiYgbW9kZWxDb250cm9sbGVyLiRlcnJvclsncGF0dGVybiddICYmIG1vZGVsQ29udHJvbGxlci4kZXJyb3JbJ3BhdHRlcm4nXSA9PXRydWUpOy8vICYmIG1vZGVsQ29udHJvbGxlci4kZGlydHk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5zaG93RXJyb3JJZlN1Ym1pdHRlZCA9IGZ1bmN0aW9uKG1vZGVsQ29udHJvbGxlciwgZXJyb3JDb2RlLCBzdWJtaXR0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBzdWJtaXR0ZWQgJiYgJHNjb3BlLnNob3dFcnJvcihtb2RlbENvbnRyb2xsZXIsIGVycm9yQ29kZSk7XG4gICAgICAgIH07XG5cblxuICAgICAgICAkc2NvcGUuaXNHcmVhdGVyVGhhblplcm8gPSBmdW5jdGlvbihpbnB1dFZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLnN1Ym1pdHRlZCA9PSBmYWxzZSAmJiAoIE51bWJlcihpbnB1dFZhbHVlKSA+IDApO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5pc1Bvc2l0aXZlTnVtYmVyID0gZnVuY3Rpb24oaW5wdXRWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIGJvb2xlYW4gPSB0cnVlIDtcblxuICAgICAgICAgICAgaWYgKCBpc0VtcHR5IChpbnB1dFZhbHVlKSApIHJldHVybiBmYWxzZTtcblxuICAgICAgICAgICAgaWYoIWlzRW1wdHkoaW5wdXRWYWx1ZSkgICl7XG4gICAgICAgICAgICAgICAgYm9vbGVhbiA9ICRzY29wZS5wb3NpdGl2ZUludGVnZXJQYXR0ZXJuLnRlc3QoaW5wdXRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYm9vbGVhbjtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuaXNQb3NpdGl2ZURlY2ltYWwgPSBmdW5jdGlvbihpbnB1dFZhbHVlKSB7XG5cbiAgICAgICAgICAgIC8vIHJldHVybnMgZmFsc2UgaWYgZW1wdHksIG9yIGlmIG5vdCBkZWNpbWFsKGJ5IHJlZ2V4IGNvbXBhcmlzb24pXG4gICAgICAgICAgICBpZiAoIGlzRW1wdHkgKGlucHV0VmFsdWUpICkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLnBvc2l0aXZlRGVjaW1hbE51bWJlclBhdHRlcm4udGVzdChpbnB1dFZhbHVlKTtcblxuICAgICAgICB9O1xuICAgICAgICBcblxuICAgICAgICAkc2NvcGUudmFsaWREYXRlRm9ybWF0ID0gZnVuY3Rpb24oIGlucHV0RGF0ZSl7XG4gICAgICAgICAgICAvLyBhbGxvd3MgZW1wdHkgdmFsdWVzIGZvciBzaW1wbGljaXR5IHNha2VcbiAgICAgICAgICAgIGlmICggaXNFbXB0eShpbnB1dERhdGUpKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUuZGF0ZUZvcm1hdC50ZXN0KCBpbnB1dERhdGUgKTtcblxuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLmlzRGVncmVlID0gZnVuY3Rpb24oaW5wdXRWYWx1ZSwgZGVncmVlcywgc3VibWl0dGVkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiAoJHNjb3BlLnN1Ym1pdHRlZCA9PSB0cnVlICYmICFpc0VtcHR5KGlucHV0VmFsdWUpICYmICEoTnVtYmVyKGRlZ3JlZXMpID49IE51bWJlcihpbnB1dFZhbHVlKSAmJiBOdW1iZXIoaW5wdXRWYWx1ZSkgPj0gLU51bWJlcihkZWdyZWVzKSkpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5pc1JlcXVpcmVkID0gZnVuY3Rpb24oaW5wdXRWYWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuICAkc2NvcGUuc3VibWl0dGVkID09IHRydWUgJiYgaXNFbXB0eShpbnB1dFZhbHVlKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuaXNNb2RhbFJlcXVpcmVkID0gZnVuY3Rpb24oaW5wdXRWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIGJvb2xlYW4gPSBmYWxzZTtcblxuICAgICAgICAgICAgaWYoaXNFbXB0eShpbnB1dFZhbHVlKSl7XG4gICAgICAgICAgICAgICAgYm9vbGVhbj0gIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihpbnB1dFZhbHVlID09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgYm9vbGVhbj0gIHRydWU7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgaWYoaW5wdXRWYWx1ZS5sZW5ndGggPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgIGJvb2xlYW49ICB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAvKiBpZihpbnB1dFZhbHVlID09IG51bGwpe1xuICAgICAgICAgICAgICAgIGJvb2xlYW49ICB0cnVlO1xuICAgICAgICAgICAgfSovXG4gICAgICAgICAgICByZXR1cm4gICBib29sZWFuO1xuXG5cbiAgICAgICAgfTtcblxuXG4gICAgICAgICRzY29wZS5jaGVja2JveENsZWFySW5wdXRzID0gZnVuY3Rpb24ocGxhbnQsIGNoZWNrYm94UGF0aCwgZGVwZW5kaW5nSW5wdXRzKSB7XG4gICAgICAgICAgICB2YXIgdG9rZW5zMSA9IGNoZWNrYm94UGF0aC5zcGxpdCgnLicpO1xuICAgICAgICAgICAgdmFyIG9iamVjdElkZW50aWZpZXIxID0gdG9rZW5zMS5zaGlmdCgpO1xuICAgICAgICAgICAgdmFyIGNoZWNrYm94T2JqZWN0ID0gJHNjb3BlLmdldFBsYW50QnlQYXRoKHBsYW50LCBvYmplY3RJZGVudGlmaWVyMSk7XG4gICAgICAgICAgICB2YXIgcHJvcGVydHkxID0gdG9rZW5zMVt0b2tlbnMxLmxlbmd0aC0xXTtcbiAgICAgICAgICAgIHZhciBjaGVja2JveFZhbHVlID0gY2hlY2tib3hPYmplY3RbcHJvcGVydHkxXTtcblxuICAgICAgICAgICAgaWYoY2hlY2tib3hWYWx1ZSA9PSBmYWxzZSl7XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0UGF0aEFycmF5ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGlzTm90RW1wdHk9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IGRlcGVuZGluZ0lucHV0cy5zcGxpdCgnOicpO1xuXG4gICAgICAgICAgICAgICAgLy9BZGRpbmcgY2hlY2tib3ggZGVwZW5kaW5nIGlucHV0cyB0byBhcnJheVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGF0aHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRva2VuczIgPSBwYXRoc1tpXS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0SWRlbnRpZmllcjIgPSB0b2tlbnMyLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnRPYmplY3QgPSAkc2NvcGUuZ2V0UGxhbnRCeVBhdGgocGxhbnQsIG9iamVjdElkZW50aWZpZXIyKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BlcnR5ID0gdG9rZW5zMlt0b2tlbnMyLmxlbmd0aC0xXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9iamVjdCA9IHBhcmVudE9iamVjdFtwcm9wZXJ0eV07XG4gICAgICAgICAgICAgICAgICAgIGlmKCRzY29wZS5wb3NpdGl2ZURlY2ltYWxOdW1iZXJQYXR0ZXJuLnRlc3Qob2JqZWN0KSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QgPSBvYmplY3QudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL0Vycm9yIGhhbmRsaW5nOiAgU3RyaW5nIGluIG51bWVyaWMgZmllbGRcbiAgICAgICAgICAgICAgICAgICAgaWYob2JqZWN0ID09IG51bGwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzTm90RW1wdHkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZihvYmplY3QgPT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc05vdEVtcHR5ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpbnB1dFBhdGhBcnJheS5wdXNoKG9iamVjdClcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL0lzIGlucHV0cyBlbXB0eVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaW5wdXRQYXRoQXJyYXkubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYoaW5wdXRQYXRoQXJyYXlbal0ubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc05vdEVtcHR5ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgaWYoY2hlY2tib3hWYWx1ZSA9PSBmYWxzZSAmJiBpc05vdEVtcHR5KXtcbiAgICAgICAgICAgICAgICAgICAgaWYoY29uZmlybShcIkRvIHlvdSB3aXNoIHRvIGNsZWFyIGRhdGEgZnJvbSBkZXBlbmRpbmcgaW5wdXQocyk/XCIpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcGF0aHMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9rZW5zMyA9IHBhdGhzW2tdLnNwbGl0KCcuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iamVjdElkZW50aWZpZXIzID0gdG9rZW5zMy5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnRPYmplY3QyID0gJHNjb3BlLmdldFBsYW50QnlQYXRoKHBsYW50LCBvYmplY3RJZGVudGlmaWVyMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BlcnR5MiA9IHRva2VuczNbdG9rZW5zMy5sZW5ndGgtMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50T2JqZWN0Mltwcm9wZXJ0eTJdID0gXCJcIjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgLy9jaGVja2JveCByb2xsYmFja1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tib3hPYmplY3RbcHJvcGVydHkxXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0UGF0aEFycmF5ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGlzTm90RW1wdHk9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IGRlcGVuZGluZ0lucHV0cy5zcGxpdCgnOicpO1xuXG4gICAgICAgICAgICAgICAgLy9BZGRpbmcgY2hlY2tib3ggZGVwZW5kaW5nIGlucHV0cyB0byBhcnJheVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGF0aHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRva2VuczIgPSBwYXRoc1tpXS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0SWRlbnRpZmllcjIgPSB0b2tlbnMyLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnRPYmplY3QgPSAkc2NvcGUuZ2V0UGxhbnRCeVBhdGgocGxhbnQsIG9iamVjdElkZW50aWZpZXIyKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BlcnR5ID0gdG9rZW5zMlt0b2tlbnMyLmxlbmd0aC0xXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9iamVjdCA9IHBhcmVudE9iamVjdFtwcm9wZXJ0eV07XG4gICAgICAgICAgICAgICAgICAgIGlmKCRzY29wZS5wb3NpdGl2ZURlY2ltYWxOdW1iZXJQYXR0ZXJuLnRlc3Qob2JqZWN0KSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QgPSBvYmplY3QudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL0Vycm9yIGhhbmRsaW5nOiAgU3RyaW5nIGluIG51bWVyaWMgZmllbGRcbiAgICAgICAgICAgICAgICAgICAgaWYob2JqZWN0ID09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNOb3RFbXB0eSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaW5wdXRQYXRoQXJyYXkucHVzaChvYmplY3QpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9JcyBpbnB1dHMgZW1wdHlcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGlucHV0UGF0aEFycmF5Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKGlucHV0UGF0aEFycmF5W2pdLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNOb3RFbXB0eSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodG9rZW5zMSA9PSAnUmVmaW5lcmllcycgJiYgY2hlY2tib3hWYWx1ZSA9PSB0cnVlICYmIGlzTm90RW1wdHkpe1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKGNvbmZpcm0oXCJEbyB5b3Ugd2lzaCB0byBjbGVhciBkYXRhIGZyb20gZGVwZW5kaW5nIGlucHV0KHMpP1wiKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBhdGhzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRva2VuczMgPSBwYXRoc1trXS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmplY3RJZGVudGlmaWVyMyA9IHRva2VuczMuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50T2JqZWN0MiA9ICRzY29wZS5nZXRQbGFudEJ5UGF0aChwbGFudCwgb2JqZWN0SWRlbnRpZmllcjMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9wZXJ0eTIgPSB0b2tlbnMzW3Rva2VuczMubGVuZ3RoLTFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudE9iamVjdDJbcHJvcGVydHkyXSA9IFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NoZWNrYm94IHJvbGxiYWNrXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja2JveE9iamVjdFtwcm9wZXJ0eTFdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9ICAgIDtcblxuICAgICAgICAkc2NvcGUuaXNEZXN1bHBodXJpemF0aW9uUmF0ZUVtcHR5ID0gZnVuY3Rpb24gKGRlc3VscGh1cmlzYXRpb24pIHtcbiAgICAgICAgICAgIGlmIChkZXN1bHBodXJpc2F0aW9uID09IG51bGwgfHwgZGVzdWxwaHVyaXNhdGlvbi5Nb250aHM9PW51bGwgfHwgZGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGg9PW51bGwgIHx8IGRlc3VscGh1cmlzYXRpb24uTW9udGhzLk1vbnRoLmxlbmd0aD09MSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoZGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGguaXNBcnJheSl7XG4gICAgICAgICAgICBkZXN1bHBodXJpc2F0aW9uLk1vbnRocy5Nb250aC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuRGVzdWxwaHVyaXNhdGlvblJhdGUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5pc1N1bHBodXJDb250ZW50RW1wdHkgPSBmdW5jdGlvbiAoZGVzdWxwaHVyaXNhdGlvbikge1xuICAgICAgICAgICAgaWYgKGRlc3VscGh1cmlzYXRpb24gPT0gbnVsbCB8fCBkZXN1bHBodXJpc2F0aW9uLk1vbnRocz09bnVsbCB8fCBkZXN1bHBodXJpc2F0aW9uLk1vbnRocy5Nb250aD09bnVsbCAgfHwgZGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGgubGVuZ3RoPT0xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKGRlc3VscGh1cmlzYXRpb24uTW9udGhzLk1vbnRoLmlzQXJyYXkpeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGRlc3VscGh1cmlzYXRpb24uTW9udGhzLk1vbnRoLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5TdWxwaHVyQ29udGVudCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmlzVGVjaG5pY2FsSnVzdGlmaWNhdGlvbkVtcHR5ID0gZnVuY3Rpb24gKGRlc3VscGh1cmlzYXRpb24pIHtcbiAgICAgICAgICAgIGlmIChkZXN1bHBodXJpc2F0aW9uID09IG51bGwgfHwgZGVzdWxwaHVyaXNhdGlvbi5Nb250aHM9PW51bGwgfHwgZGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGg9PW51bGwgIHx8IGRlc3VscGh1cmlzYXRpb24uTW9udGhzLk1vbnRoLmxlbmd0aD09MSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoZGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGguaXNBcnJheSl7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBkZXN1bHBodXJpc2F0aW9uLk1vbnRocy5Nb250aC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5UZWNobmljYWxKdXN0aWZpY2F0aW9uID09IG51bGwgfHwgZWxlbWVudC5UZWNobmljYWxKdXN0aWZpY2F0aW9uID09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgfSk7XG4gICAgZnVuY3Rpb24gaXNFbXB0eSh2YWx1ZSl7XG4gICAgICAgIC8vIHJldHVybnMgdHJ1ZSBvbiB1bmRlZmluZWQsIGVtcHR5IGFycmF5LCBlbXB0eSBzdHJpbmdcbiAgICAgICAgaWYodmFsdWUgPT09IDApe1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICByZXR1cm4gKCF2YWx1ZSB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlLmxlbmd0aCA9PT0gMCB8fCB2YWx1ZSA9PT0gXCJcIiApO1xuICAgICAgICB9XG4gICAgfVxuXG5cblxuICAgIC8vIGdldCBpbnN0YW5jZSBkYXRhIGFuZCBzYXZlIGluc3RhbmNlIGRhdGFcbiAgICBhcHAuZmFjdG9yeSgnZGF0YVJlcG9zaXRvcnknLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkaHR0cCkge1xuICAgICAgICB2YXIgY29kZUxpc3RzID0ge307XG4gICAgICAgIC8vdmFyIGxjcFZvY2FidWxhcnlTZXRCYXNlVXJpID0gJ2h0dHA6Ly90ZXN0LnRyaXBsZWRldi5lZS9kYXRhZGljdC92b2NhYnVsYXJ5L2xjcC8nO1xuICAgICAgICAvL3ZhciBsY3BWb2NhYnVsYXJ5U2V0QmFzZVVyaSA9IEREX1ZPQ0FCVUxBUllfQkFTRV9VUkkgKyAnaGFiaWRlcy8nO1xuICAgICBcbiAgICAgXG4gICAgICAgIHZhciBFUFJUUmFuZGxMQ1BWb2NhYnVsYXJ5U2V0QmFzZVVyaSA9IEREX1ZPQ0FCVUxBUllfQkFTRV9VUkkgKyAnRVBSVFJhbmRMQ1AvJztcbiAgICAgICAgdmFyIEVQUlRSYW5kTENQdm9jYWJ1bGFyaWVzID1bJ0NvbWJ1c3Rpb25QbGFudENhdGVnb3J5VmFsdWUnLCAnQ291bnRyeUNvZGVWYWx1ZScsICdFUFJUUlBvbGx1dGFudENvZGVWYWx1ZScsICdGdWVsSW5wdXRWYWx1ZScsXG4gICAgICAgICAnTENQUG9sbHV0YW50Q29kZVZhbHVlJywgJ01lZGl1bUNvZGVWYWx1ZScsICdNZXRob2RDbGFzc2lmaWNhdGlvblZhbHVlJywgJ01ldGhvZENvZGVWYWx1ZScsICdNb250aFZhbHVlJywgXG4gICAgICAgICAnT3RoZXJHYXNlb3VzRnVlbFZhbHVlJywgJ090aGVyU29saWRGdWVsVmFsdWUnLCAnUmVhc29uVmFsdWUnLCAnVW5pdENvZGVWYWx1ZScsICdXYXN0ZUNsYXNzaWZpY2F0aW9uVmFsdWUnLFxuICAgICAgICAgICdXYXN0ZVRyZWF0bWVudFZhbHVlJ107XG4gICAgICAgIHZhciBFUFJUUmFuZExDUHZvY2FidWxhcnlJZGVudGlmaWVyc0luQ29kZSA9IFsnQ29tYnVzdGlvblBsYW50Q2F0ZWdvcnlWYWx1ZScsICdDb3VudHJ5Q29kZVZhbHVlJywgJ0VQUlRSUG9sbHV0YW50Q29kZVZhbHVlJywgJ0Z1ZWxJbnB1dFZhbHVlJyxcbiAgICAgICAgICdMQ1BQb2xsdXRhbnRDb2RlVmFsdWUnLCAnTWVkaXVtQ29kZVZhbHVlJywgJ01ldGhvZENsYXNzaWZpY2F0aW9uVmFsdWUnLCAnTWV0aG9kQ29kZVZhbHVlJywgJ01vbnRoVmFsdWUnLCBcbiAgICAgICAgICdPdGhlckdhc2VvdXNGdWVsVmFsdWUnLCAnT3RoZXJTb2xpZEZ1ZWxWYWx1ZScsICdSZWFzb25WYWx1ZScsICdVbml0Q29kZVZhbHVlJywgJ1dhc3RlQ2xhc3NpZmljYXRpb25WYWx1ZScsXG4gICAgICAgICAgJ1dhc3RlVHJlYXRtZW50VmFsdWUnXTtcbiAgICAgICAgXG4gICAgICBcbiAgdmFyIGxjcFZvY2FidWxhcnlTZXRCYXNlVXJpID0gRERfVk9DQUJVTEFSWV9CQVNFX1VSSSArICdsY3AvJztcbiAgICAgICAgdmFyIGxjcFZvY2FidWxhcmllcyA9IFsnbGNwY291bnRyaWVzJywncGxhbnRzdGF0dXMnLCdzZWN0b3JzJ107XG4gICAgICAgIHZhciBsY3BWb2NhYnVsYXJ5SWRlbnRpZmllcnNJbkNvZGUgPSBbJ2NvdW50cmllcycsICdzdGF0dXMnLCAnc2VjdG9ycyddO1xuXG4gICAgICAgIHZhciBjb21tb25Wb2NhYnVsYXJ5U2V0QmFzZVVyaSA9IEREX1ZPQ0FCVUxBUllfQkFTRV9VUkkgKyAnY29tbW9uLyc7XG5cbiAgICAgICAgLy9kZWZpbmUgdW5kZWZpbmVkIG1lbWJlcnMsIGkgZG9udCBrbm93IGlmIHRoaXMgaXMgcmVhbGx5IG5lY2Vzc2FyeSEhIVxuICAgICAgICBjb2RlTGlzdHMuTENQQ29kZWxpc3RzID0ge307XG4gICAgICAgIGNvZGVMaXN0cy5PbGRMQ1BDb2RlbGlzdHM9e307XG4gICAgICAgIGNvZGVMaXN0cy5Db21idXN0aW9uUGxhbnRDb2RlTGlzdHM9e307XG4gICAgICAgIGNvZGVMaXN0cy5EZXJvZ2F0aW9uVmFsdWVDb2RlTGlzdHM9e307XG4gICAgICAgIGNvZGVMaXN0cy5PdGhlclNvbGlkRnVlbENvZGVMaXN0cz17fTtcbiAgICAgICAgY29kZUxpc3RzLk90aGVyR2FzZXNvdXNGdWVsQ29kZUxpc3RzPXt9O1xuICAgICAgICBjb2RlTGlzdHMuTW9udGhWYWx1ZUNvZGVMaXN0cz17fTtcbiAgICAgICAgY29kZUxpc3RzLk1vbnRobHlEZXN1bHBodXJpc2F0aW9uPXt9O1xuXG4gICAgICAgIHZhciByZWdpb25Db2RlTGlzdHMgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBFUFJUUmFuZExDUHZvY2FidWxhcmllcy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICBjb2RlTGlzdHMuTENQQ29kZWxpc3RzW0VQUlRSYW5kTENQdm9jYWJ1bGFyeUlkZW50aWZpZXJzSW5Db2RlW2ldXSA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGNwVm9jYWJ1bGFyaWVzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGNvZGVMaXN0cy5PbGRMQ1BDb2RlbGlzdHNbbGNwVm9jYWJ1bGFyeUlkZW50aWZpZXJzSW5Db2RlW2ldXSA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRJbnN0YW5jZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGVJZCl7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IGdldFdlYlFVcmwoXCIvZG93bmxvYWQvY29udmVydGVkX3VzZXJfZmlsZVwiKTtcbiAgICAgICAgICAgICAgICB9XG5cdFx0XHRcdGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB1cmwgPSBcImxjcC1pbnN0YW5jZS10ZXN0Lmpzb25cIjtcblx0XHRcdFx0fVxuICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQodXJsLCB7dHJhY2tlciA6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzYXZlSW5zdGFuY2U6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IGdldFdlYlFVcmwoXCIvc2F2ZVhtbFwiKTtcbiAgICAgICAgICAgICAgICBmaXhVbmRlZmluZWQoZGF0YSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QodXJsLCBkYXRhLCB7dHJhY2tlciA6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRDb2RlTGlzdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvZGVMaXN0cztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsb2FkQ29kZUxpc3Q6IGZ1bmN0aW9uKGxhbmd1YWdlKSB7XG4gICAgICAgICAgICAgICAgLy9maW5kcyBmaWxlIGluIHByb2plY3QgZm9sZGVyXG4gICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRsYW5ndWFnZSA9ICdlbic7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRMYW5ndWFnZSA9ICFsYW5ndWFnZT8gZGVmYXVsdGxhbmd1YWdlIDogbGFuZ3VhZ2U7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEVQUlRSYW5kTENQdm9jYWJ1bGFyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBFUFJUUmFuZGxMQ1BWb2NhYnVsYXJ5U2V0QmFzZVVyaSArIEVQUlRSYW5kTENQdm9jYWJ1bGFyaWVzW2ldICsgJy9qc29uP2xhbmc9JyArIGN1cnJlbnRMYW5ndWFnZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5pc0lFOSB8fCB3aW5kb3cuaXNJRTkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gYmFzZVVyaSArICcvcmVzdFByb3h5P3VyaT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsLCB7dHJhY2tlcjogJHJvb3RTY29wZS5sb2FkaW5nVHJhY2tlcn0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJGYWlsZWQgdG8gcmVhZCBjb2RlIGxpc3RzLiBEYXRhID0gXCIgKyAgZGF0YSArIFwiLCBzdGF0dXMgPSBcIiArIHN0YXR1cyk7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcygoZnVuY3Rpb24oaSl7cmV0dXJuIGZ1bmN0aW9uIChuZXdDb2RlTGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5jb3B5KG5ld0NvZGVMaXN0LCBjb2RlTGlzdHMuTENQQ29kZWxpc3RzW0VQUlRSYW5kTENQdm9jYWJ1bGFyeUlkZW50aWZpZXJzSW5Db2RlW2ldXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLy8vY29uc29sZS5sb2coXCJyZWNlaXZlZCBcIiArIHZvY2FidWxhcnlJZGVudGlmaWVyc0luQ29kZVtpXSk7XG4gICAgICAgICAgICAgICAgICAgIH19KShpKSk7XG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIH0sIFxuICAgICAgICAgICAgbG9hZE9sZExDUENvZGVMaXN0OiBmdW5jdGlvbihsYW5ndWFnZSkge1xuICAgICAgICAgICAgICAgIC8vZmluZHMgZmlsZSBpbiBwcm9qZWN0IGZvbGRlclxuICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0bGFuZ3VhZ2UgPSAnZW4nO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TGFuZ3VhZ2UgPSAhbGFuZ3VhZ2U/IGRlZmF1bHRsYW5ndWFnZSA6IGxhbmd1YWdlO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsY3BWb2NhYnVsYXJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IGxjcFZvY2FidWxhcnlTZXRCYXNlVXJpICsgbGNwVm9jYWJ1bGFyaWVzW2ldICsgJy9qc29uP2xhbmc9JyArIGN1cnJlbnRMYW5ndWFnZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5pc0lFOSB8fCB3aW5kb3cuaXNJRTkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gYmFzZVVyaSArICcvcmVzdFByb3h5P3VyaT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsLCB7dHJhY2tlcjogJHJvb3RTY29wZS5sb2FkaW5nVHJhY2tlcn0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJGYWlsZWQgdG8gcmVhZCBjb2RlIGxpc3RzLiBEYXRhID0gXCIgKyAgZGF0YSArIFwiLCBzdGF0dXMgPSBcIiArIHN0YXR1cyk7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcygoZnVuY3Rpb24oaSl7cmV0dXJuIGZ1bmN0aW9uIChuZXdDb2RlTGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5ld0NvZGVMaXN0IFwiK25ld0NvZGVMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuY29weShuZXdDb2RlTGlzdCwgY29kZUxpc3RzLk9sZExDUENvZGVsaXN0c1tsY3BWb2NhYnVsYXJ5SWRlbnRpZmllcnNJbkNvZGVbaV1dKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vLy9jb25zb2xlLmxvZyhcInJlY2VpdmVkIFwiICsgdm9jYWJ1bGFyeUlkZW50aWZpZXJzSW5Db2RlW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfX0pKGkpKTtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgfSwgXG4gICAgICAgICAgICAgbG9hZENvbWJ1c3Rpb25QbGFudENvZGVMaXN0OiBmdW5jdGlvbihsYW5ndWFnZSl7XG4gICAgICAgICAgICAgICAgLy8gd2UgZG8gbm90IG5lZWQgdGhlIGZvciBlYWNoIG9mIHRoZSBhYm92ZSBsb2FkQ29kZUxpc3QgbWV0aG9kLCBzaW5jZSBpbiB0aGUgYWJvdmUgLCBpdCBoYXMgdG8gbWFrZSBzZXBlcmF0ZSBjYWxsc1xuICAgICAgICAgICAgICAgIC8vIGZvciBlYWNoIHZvY2FidWxhcnksIHdoZXJlYXMgd2UgZG8gbm90IGhhdmUgdG8uXG4gICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRsYW5ndWFnZSA9ICdlbic7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRMYW5ndWFnZSA9ICFsYW5ndWFnZT8gZGVmYXVsdGxhbmd1YWdlIDogbGFuZ3VhZ2U7XG4gICAgICAgICAgICAgICAgdmFyIHVybCA9ICdodHRwOi8vZGQuZWlvbmV0LmV1cm9wYS5ldS92b2NhYnVsYXJ5L0VQUlRSYW5kTENQL0NvbWJ1c3Rpb25QbGFudENhdGVnb3J5VmFsdWUvanNvbic7XG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCwge3RyYWNrZXI6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyl7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiRmFpbGVkIHRvIHJlYWQgY29kZSBsaXN0cy4gRGF0YSA9IFwiICsgIGRhdGEgKyBcIiwgc3RhdHVzID0gXCIgKyBzdGF0dXMpO30pXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoIGZ1bmN0aW9uIChuZXdDb2RlTGlzdCkge1xuICAgICAgICAgICAgYW5ndWxhci5jb3B5KG5ld0NvZGVMaXN0LCBjb2RlTGlzdHMuQ29tYnVzdGlvblBsYW50Q29kZUxpc3RzKTtcbiAgICAgICAgICAgIC8vLy9jb25zb2xlLmxvZyhcInJlY2VpdmVkIFwiICsgdm9jYWJ1bGFyeUlkZW50aWZpZXJzSW5Db2RlW2ldKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxvYWREZXJvZ2F0aW9uVmFsdWVDb2RlTGlzdDogZnVuY3Rpb24obGFuZ3VhZ2Upe1xuICAgICAgICAgICAgICAgIC8vIHdlIGRvIG5vdCBuZWVkIHRoZSBmb3IgZWFjaCBvZiB0aGUgYWJvdmUgbG9hZENvZGVMaXN0IG1ldGhvZCwgc2luY2UgaW4gdGhlIGFib3ZlICwgaXQgaGFzIHRvIG1ha2Ugc2VwZXJhdGUgY2FsbHNcbiAgICAgICAgICAgICAgICAvLyBmb3IgZWFjaCB2b2NhYnVsYXJ5LCB3aGVyZWFzIHdlIGRvIG5vdCBoYXZlIHRvLlxuICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0bGFuZ3VhZ2UgPSAnZW4nO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TGFuZ3VhZ2UgPSAhbGFuZ3VhZ2U/IGRlZmF1bHRsYW5ndWFnZSA6IGxhbmd1YWdlO1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPSAnaHR0cDovL2RkLmVpb25ldC5ldXJvcGEuZXUvdm9jYWJ1bGFyeS9ldXJlZ2lzdHJ5b25pbmR1c3RyaWFsc2l0ZXMvRGVyb2dhdGlvblZhbHVlL2pzb24nO1xuICAgICAgICAgICAgICAgICRodHRwLmdldCh1cmwsIHt0cmFja2VyOiAkcm9vdFNjb3BlLmxvYWRpbmdUcmFja2VyfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe1xuICAgICAgICAgICAgICAgICAgICBhbGVydChcIkZhaWxlZCB0byByZWFkIGNvZGUgbGlzdHMuIERhdGEgPSBcIiArICBkYXRhICsgXCIsIHN0YXR1cyA9IFwiICsgc3RhdHVzKTt9KVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKCBmdW5jdGlvbiAobmV3Q29kZUxpc3QpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuY29weShuZXdDb2RlTGlzdCwgY29kZUxpc3RzLkRlcm9nYXRpb25WYWx1ZUNvZGVMaXN0cyk7XG4gICAgICAgICAgICAvLy8vY29uc29sZS5sb2coXCJyZWNlaXZlZCBcIiArIHZvY2FidWxhcnlJZGVudGlmaWVyc0luQ29kZVtpXSk7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsb2FkT3RoZXJTb2xpZEZ1ZWxDb2RlTGlzdDogZnVuY3Rpb24obGFuZ3VhZ2Upe1xuICAgICAgICAgICAgICAgIC8vIHdlIGRvIG5vdCBuZWVkIHRoZSBmb3IgZWFjaCBvZiB0aGUgYWJvdmUgbG9hZENvZGVMaXN0IG1ldGhvZCwgc2luY2UgaW4gdGhlIGFib3ZlICwgaXQgaGFzIHRvIG1ha2Ugc2VwZXJhdGUgY2FsbHNcbiAgICAgICAgICAgICAgICAvLyBmb3IgZWFjaCB2b2NhYnVsYXJ5LCB3aGVyZWFzIHdlIGRvIG5vdCBoYXZlIHRvLlxuICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0bGFuZ3VhZ2UgPSAnZW4nO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TGFuZ3VhZ2UgPSAhbGFuZ3VhZ2U/IGRlZmF1bHRsYW5ndWFnZSA6IGxhbmd1YWdlO1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPSAnaHR0cDovL2RkLmVpb25ldC5ldXJvcGEuZXUvdm9jYWJ1bGFyeS9FUFJUUmFuZExDUC9PdGhlclNvbGlkRnVlbFZhbHVlL2pzb24nO1xuICAgICAgICAgICAgICAgICRodHRwLmdldCh1cmwsIHt0cmFja2VyOiAkcm9vdFNjb3BlLmxvYWRpbmdUcmFja2VyfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe1xuICAgICAgICAgICAgICAgICAgICBhbGVydChcIkZhaWxlZCB0byByZWFkIGNvZGUgbGlzdHMuIERhdGEgPSBcIiArICBkYXRhICsgXCIsIHN0YXR1cyA9IFwiICsgc3RhdHVzKTt9KVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKCBmdW5jdGlvbiAobmV3Q29kZUxpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9QdXNoIFwiT3RoZXJcIiB2YWx1ZSB0byB0aGUgZW5kIG9mIHRoZSBBcnJheVxuICAgICAgICAgICAgICAgICAgICB2YXIgb3RoZXJFbGVtZW50ID17fTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q29kZUxpc3QuY29uY2VwdHMuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihlbGVtZW50WydAaWQnXT09J090aGVyJyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIE90aGVyRWxlbWVudEluZGV4ID0gbmV3Q29kZUxpc3QuY29uY2VwdHMuaW5kZXhPZihlbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDb2RlTGlzdC5jb25jZXB0cy5zcGxpY2UoT3RoZXJFbGVtZW50SW5kZXgsMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ob3RoZXJFbGVtZW50LGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q29kZUxpc3QuY29uY2VwdHMucHVzaChvdGhlckVsZW1lbnQpO1xuICAgICAgICAgICAgYW5ndWxhci5jb3B5KG5ld0NvZGVMaXN0LCBjb2RlTGlzdHMuT3RoZXJTb2xpZEZ1ZWxDb2RlTGlzdHMpO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbG9hZE90aGVyR2FzZXNvdXNGdWVsQ29kZUxpc3Q6IGZ1bmN0aW9uKGxhbmd1YWdlKXtcbiAgICAgICAgICAgICAgICAvLyB3ZSBkbyBub3QgbmVlZCB0aGUgZm9yIGVhY2ggb2YgdGhlIGFib3ZlIGxvYWRDb2RlTGlzdCBtZXRob2QsIHNpbmNlIGluIHRoZSBhYm92ZSAsIGl0IGhhcyB0byBtYWtlIHNlcGVyYXRlIGNhbGxzXG4gICAgICAgICAgICAgICAgLy8gZm9yIGVhY2ggdm9jYWJ1bGFyeSwgd2hlcmVhcyB3ZSBkbyBub3QgaGF2ZSB0by5cbiAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdGxhbmd1YWdlID0gJ2VuJztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudExhbmd1YWdlID0gIWxhbmd1YWdlPyBkZWZhdWx0bGFuZ3VhZ2UgOiBsYW5ndWFnZTtcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gJ2h0dHA6Ly9kZC5laW9uZXQuZXVyb3BhLmV1L3ZvY2FidWxhcnkvRVBSVFJhbmRMQ1AvT3RoZXJHYXNlb3VzRnVlbFZhbHVlL2pzb24nO1xuICAgICAgICAgICAgICAgICRodHRwLmdldCh1cmwsIHt0cmFja2VyOiAkcm9vdFNjb3BlLmxvYWRpbmdUcmFja2VyfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe1xuICAgICAgICAgICAgICAgICAgICBhbGVydChcIkZhaWxlZCB0byByZWFkIGNvZGUgbGlzdHMuIERhdGEgPSBcIiArICBkYXRhICsgXCIsIHN0YXR1cyA9IFwiICsgc3RhdHVzKTt9KVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKCBmdW5jdGlvbiAobmV3Q29kZUxpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vUHVzaCBcIk90aGVyXCIgdmFsdWUgdG8gdGhlIGVuZCBvZiB0aGUgQXJyYXlcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdGhlckVsZW1lbnQgPXt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q29kZUxpc3QuY29uY2VwdHMuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZWxlbWVudFsnQGlkJ109PSdPdGhlcicpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgT3RoZXJFbGVtZW50SW5kZXggPSBuZXdDb2RlTGlzdC5jb25jZXB0cy5pbmRleE9mKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDb2RlTGlzdC5jb25jZXB0cy5zcGxpY2UoT3RoZXJFbGVtZW50SW5kZXgsMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKG90aGVyRWxlbWVudCxlbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvZGVMaXN0LmNvbmNlcHRzLnB1c2gob3RoZXJFbGVtZW50KTtcbiAgICAgICAgICAgIGFuZ3VsYXIuY29weShuZXdDb2RlTGlzdCwgY29kZUxpc3RzLk90aGVyR2FzZXNvdXNGdWVsQ29kZUxpc3RzKTtcbiAgICAgICAgICAgIC8vLy9jb25zb2xlLmxvZyhcInJlY2VpdmVkIFwiICsgdm9jYWJ1bGFyeUlkZW50aWZpZXJzSW5Db2RlW2ldKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxvYWRNb250aFZhbHVlQ29kZUxpc3Q6IGZ1bmN0aW9uKGxhbmd1YWdlKXtcbiAgICAgICAgICAgICAgICAvLyB3ZSBkbyBub3QgbmVlZCB0aGUgZm9yIGVhY2ggb2YgdGhlIGFib3ZlIGxvYWRDb2RlTGlzdCBtZXRob2QsIHNpbmNlIGluIHRoZSBhYm92ZSAsIGl0IGhhcyB0byBtYWtlIHNlcGVyYXRlIGNhbGxzXG4gICAgICAgICAgICAgICAgLy8gZm9yIGVhY2ggdm9jYWJ1bGFyeSwgd2hlcmVhcyB3ZSBkbyBub3QgaGF2ZSB0by5cbiAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdGxhbmd1YWdlID0gJ2VuJztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudExhbmd1YWdlID0gIWxhbmd1YWdlPyBkZWZhdWx0bGFuZ3VhZ2UgOiBsYW5ndWFnZTtcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gJ2h0dHA6Ly9kZC5laW9uZXQuZXVyb3BhLmV1L3ZvY2FidWxhcnkvRVBSVFJhbmRMQ1AvTW9udGhWYWx1ZS9qc29uJztcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsLCB7dHJhY2tlcjogJHJvb3RTY29wZS5sb2FkaW5nVHJhY2tlcn0pXG4gICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJGYWlsZWQgdG8gcmVhZCBjb2RlIGxpc3RzLiBEYXRhID0gXCIgKyAgZGF0YSArIFwiLCBzdGF0dXMgPSBcIiArIHN0YXR1cyk7fSlcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyggZnVuY3Rpb24gKG5ld0NvZGVMaXN0KSB7XG4gICAgICAgICAgICBhbmd1bGFyLmNvcHkobmV3Q29kZUxpc3QsIGNvZGVMaXN0cy5Nb250aFZhbHVlQ29kZUxpc3RzKTtcbiAgICAgICAgICAgIC8vLy9jb25zb2xlLmxvZyhcInJlY2VpdmVkIFwiICsgdm9jYWJ1bGFyeUlkZW50aWZpZXJzSW5Db2RlW2ldKTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChjb2RlTGlzdHMuTW9udGhWYWx1ZUNvZGVMaXN0cy5jb25jZXB0cywgZnVuY3Rpb24odmFsdWUsIGtleSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGVMaXN0cy5Nb250aGx5RGVzdWxwaHVyaXNhdGlvbltrZXldPXtcbiAgICAgICAgICAgICAgICAgICAgXCJEZXN1bHBodXJpc2F0aW9uUmF0ZVwiOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgXCJNb250aFZhbHVlXCI6dmFsdWUucHJlZkxhYmVsWzBdWydAdmFsdWUnXSxcbiAgICAgICAgICAgICAgICAgICAgXCJTdWxwaHVyQ29udGVudFwiOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgXCJUZWNobmljYWxKdXN0aWZpY2F0aW9uXCI6ICcnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICBcbiAgICAgICAgICAgIGxvYWRSZWdpb25zQ29kZWxpc3Q6IGZ1bmN0aW9uKGNvdW50cnkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gRERfVk9DQUJVTEFSWV9CQVNFX1VSSSArIFwiY29tbW9uL251dHMvanNvbj9pZD1cIiArIGNvdW50cnk7XG4gICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuaXNJRTkgfHwgd2luZG93LmlzSUU5KXtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gYmFzZVVyaSArICcvcmVzdFByb3h5P3VyaT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2codXJsKTtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsLCB7dHJhY2tlcjogJHJvb3RTY29wZS5sb2FkaW5nVHJhY2tlcn0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe2FsZXJ0KFwiRmFpbGVkIHRvIHJlYWQgcmVnaW9ucyBjb2RlIGxpc3RzLlwiKTt9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKG5ld0NvZGVMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5jb3B5KG5ld0NvZGVMaXN0LCByZWdpb25Db2RlTGlzdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlZ2lvbkNvZGVMaXN0cy5jb25jZXB0cy5sZW5ndGggPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBERF9WT0NBQlVMQVJZX0JBU0VfVVJJICsgXCJsY3AvbGNwY291bnRyaWVzL2pzb24/aWQ9XCIgKyBjb3VudHJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5pc0lFOSB8fCB3aW5kb3cuaXNJRTkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gYmFzZVVyaSArICcvcmVzdFByb3h5P3VyaT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCwge3RyYWNrZXI6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXthbGVydChcIkZhaWxlZCB0byByZWFkIHJlZ2lvbnMgY29kZSBsaXN0cy5cIik7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChwbGFudERldGFpbHNPdGhlclNlY3RvckZpZWxkc1ZpZXduZXdDb2RlTGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5jb3B5KG5ld0NvZGVMaXN0LCByZWdpb25Db2RlTGlzdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVnaW9uQ29kZUxpc3RzO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldEVtcHR5SW5zdGFuY2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPSAnbGNwLWluc3RhbmNlLWVtcHR5LnhtbD9mb3JtYXQ9anNvbic7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCh1cmwsIHt0cmFja2VyIDogJHJvb3RTY29wZS5sb2FkaW5nVHJhY2tlcn0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxvYWRJbnN0YW5jZUluZm86IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IGdldFdlYlFVcmwoXCIvZmlsZS9pbmZvXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQodXJsLCBkYXRhLCB7dHJhY2tlciA6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gbmV3XG4gICAgYXBwLmZpbHRlcignb2Zmc2V0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCwgc3RhcnQpIHtcbiAgICAgICAgICAgIGlmICghaW5wdXQgfHwgIShpbnB1dCBpbnN0YW5jZW9mIEFycmF5KSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN0YXJ0ID0gcGFyc2VJbnQoc3RhcnQsIDEwKTtcbiAgICAgICAgICAgIHJldHVybiBpbnB1dC5zbGljZShzdGFydCk7XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICBhcHAuZmlsdGVyKCdmb3JtYXREZXJvZ2F0aW9uJywgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBcIlwiO1xuICAgICAgICAgICAgaWYgKHggIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHguZm9yRWFjaChmdW5jdGlvbiAoZW50cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGVudHJ5O1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ1xcbic7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgIH0pO1xuXG4gICAgYXBwLmNvbnRyb2xsZXIoJ01vZGFsQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsICRtb2RhbCwgJGh0dHApIHtcbiAgICAgICAgLy9zYXZlcyBNYWluIGZvcm0gdmFsaWRhdGlvbiBzdGFnZVxuICAgICAgICAkc2NvcGUubWFpbkZvcm1TdWJtaXR0ZWQgPSAkc2NvcGUuc3VibWl0dGVkO1xuICAgICAgICAkc2NvcGUucGxhbnQ7XG4gICAgICAgICRzY29wZS5vcmlnaW5hbFBsYW50O1xuXG4gICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSBmYWxzZTtcbiAgICAgICAgJHNjb3BlLmVkaXRCb29sZWFuID0gZmFsc2U7XG4gICAgICAgIC8qJHNjb3BlLmVkaXQgPSBmdW5jdGlvbiAocGxhbnQpe1xuICAgICAgICAgICAgJHNjb3BlLmVkaXRCb29sZWFuID0gdHJ1ZTtcbiAgICAgICAgICAgICRzY29wZS5wbGFudD0gcGxhbnQ7XG4gICAgICAgICAgICAkc2NvcGUub3BlbignbGcnKTtcbiAgICAgICAgfSovXG4gICAgICAgICRzY29wZS5hZGQgPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5lZGl0Qm9vbGVhbiA9IGZhbHNlO1xuICAgICAgICAgICAgJHNjb3BlLnBsYW50ID0gbnVsbDtcbiAgICAgICAgICAgICRzY29wZS5vcGVuKCdsZycpO1xuICAgICAgICB9XG4gICAgICAgICRyb290U2NvcGUuJHdhdGNoKCdzZWxlY3RlZFBsYW50JywgZnVuY3Rpb24obmV3VmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgICAgICBpZiAobmV3VmFsdWUgJiYgbmV3VmFsdWUgIT0gbnVsbCApe1xuICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICRzY29wZS5lZGl0Qm9vbGVhbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm9yaWdpbmFsUGxhbnQgPSAgbmV3VmFsdWU7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBsYW50ID0gYW5ndWxhci5jb3B5KG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnNlbGVjdGVkUGxhbnQgPSBudWxsO1xuICAgICAgICAgICAgICAgICRzY29wZS5vcGVuKCdsZycsICRyb290U2NvcGUubW9kYWxQYWdlQ2FzZUlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgICRzY29wZS5vcGVuQWRkID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICRyb290U2NvcGUubW9kYWxQYWdlQ2FzZUlkID0gXCJMaXN0T2ZQbGFudHNcIjtcbiAgICAgICAgICAgICRyb290U2NvcGUuc2VsZWN0ZWRQbGFudCA9IG51bGw7XG4gICAgICAgICAgICAkc2NvcGUub3BlbignbGcnLCdMaXN0T2ZQbGFudHMnKTtcbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUubG9hZERhdGFGcm9tRVBSVFIgPSBmdW5jdGlvbihwbGFudCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2xvYWREYXRhRnJvbUVQUlRSIGZ1bmN0aW9uIGludm9rZWQnKTtcbiAgICAgICAgICAgIHZhciBjb3VudHJ5Q29kZSA9ICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkJhc2ljRGF0YS5NZW1iZXJTdGF0ZTtcbiAgICAgICAgICAgIGlmIChjb3VudHJ5Q29kZSAmJiBjb3VudHJ5Q29kZS5sZW5ndGggPT0gMiAmJiBwbGFudCApIHtcblxuICAgICAgICAgICAgICAgIHZhciBlcHJ0ckNvdW50cnlDb2RlID0gY291bnRyeUNvZGUgPT09IFwiR0JcIiA/IFwiVUtcIiA6IGNvdW50cnlDb2RlID09PSBcIkdSXCIgPyBcIkVMXCIgOiBjb3VudHJ5Q29kZTtcblxuICAgICAgICAgICAgICAgIHZhciB1cmwgPSBcImh0dHA6Ly9zZW1hbnRpYy5lZWEuZXVyb3BhLmV1L3NwYXJxbD9mb3JtYXQ9YXBwbGljYXRpb24vanNvbiZxdWVyeT1cIjtcbiAgICAgICAgICAgICAgICB2YXIgc3BhcnFsID0gXCJQUkVGSVggcmRmczogPGh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDEvcmRmLXNjaGVtYSM+IFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiIFBSRUZJWCBjcjogPGh0dHA6Ly9jci5laW9uZXQuZXVyb3BhLmV1L29udG9sb2dpZXMvY29udHJlZy5yZGYjPiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiBQUkVGSVggcHJ0cjogPGh0dHA6Ly9wcnRyLmVjLmV1cm9wYS5ldS9yZGYvc2NoZW1hLnJkZiM+IFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiIFBSRUZJWCBnZW86IDxodHRwOi8vd3d3LnczLm9yZy8yMDAzLzAxL2dlby93Z3M4NF9wb3MjPiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiBTRUxFQ1QgP2NvdW50cnlDb2RlID9OYXRpb25hbElEID9mYWNpbGl0eUlEID9mYWNpbGl0eU5hbWUgP3N0cmVldE5hbWUgP2J1aWxkaW5nTnVtYmVyID9wb3N0YWxDb2RlID9jaXR5ID9sYXQgP2xvbmcgP3JlcG9ydGluZ1llYXJcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiBXSEVSRSB7ID9mYWNpbGl0eSBhIHBydHI6RmFjaWxpdHkgOyBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiBwcnRyOmZhY2lsaXR5SUQgP2ZhY2lsaXR5SUQgOyBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiBwcnRyOmZhY2lsaXR5TmFtZSA/ZmFjaWxpdHlOYW1lIDsgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIgcHJ0cjpzdHJlZXROYW1lID9zdHJlZXROYW1lOyBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcInBydHI6YnVpbGRpbmdOdW1iZXIgID9idWlsZGluZ051bWJlciA7IFwiK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIgcHJ0cjpwb3N0YWxDb2RlICA/cG9zdGFsQ29kZSA7IFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiIHBydHI6Y2l0eSA/Y2l0eSA7IFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiIGdlbzpsYXQgP2xhdCA7IFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiIGdlbzpsb25nID9sb25nIDsgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIgcHJ0cjpsYXRlc3RSZXBvcnQgP2xhdGVzdHJlcG9ydCA7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIgcHJ0cjppbkNvdW50cnkgP2luQ291bnRyeSAuIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiID9pbkNvdW50cnkgcHJ0cjpjb2RlID9jb3VudHJ5Q29kZSAuIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiID9sYXRlc3RyZXBvcnQgcHJ0cjpuYXRpb25hbElEID9OYXRpb25hbElEIDtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiBwcnRyOnJlcG9ydGluZ1llYXIgP3JlcG9ydGluZ1llYXIuXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIgRklMVEVSICg/Y291bnRyeUNvZGUgPSAnXCIgKyBlcHJ0ckNvdW50cnlDb2RlICsgXCInIGFuZCBVQ0FTRSg/TmF0aW9uYWxJRCkgPSBVQ0FTRSgnXCIgKyBwbGFudC5FUFJUUk5hdGlvbmFsSWQgKyBcIicgKSApIH0gT1JERVIgQlkgREVTQyg/cmVwb3J0aW5nWWVhcikgTElNSVQgMVwiO1xuICAgICAgICAgICAgICAgIHVybCA9IGJhc2VVcmkgKyAnL3Jlc3RQcm94eT91cmk9JyArIGVuY29kZVVSSUNvbXBvbmVudCh1cmwgKyBlbmNvZGVVUklDb21wb25lbnQoc3BhcnFsKSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3VybCBmb3Igc3BhcnFsIGVwcnRyIGRhdGEgaXM6Jyt1cmwpO1xuICAgICAgICAgICAgICAgICRodHRwLmdldCh1cmwsIHt0cmFja2VyIDogJHJvb3RTY29wZS5sb2FkaW5nVHJhY2tlcn0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oKXthbGVydChcIkZhaWxlZCB0byByZWFkIGRhdGEgZnJvbSBFLVBSVFIuXCIpO30pXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihlcHJ0ckRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXBydHJEYXRhLnJlc3VsdHMuYmluZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWNpbGl0eSA9IGVwcnRyRGF0YS5yZXN1bHRzLmJpbmRpbmdzWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25maXJtKFwiVGhlIHN5c3RlbSBmb3VuZCB0aGUgZm9sbG93aW5nIGZhY2lsaXR5OiBcIiArIGZhY2lsaXR5LmZhY2lsaXR5TmFtZS52YWx1ZSArIFwiLCBcIiArIGZhY2lsaXR5LnN0cmVldE5hbWUudmFsdWUgKyBcIiwgXCIgKyBmYWNpbGl0eS5wb3N0YWxDb2RlLnZhbHVlICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiLCBcIiAgKyBmYWNpbGl0eS5jaXR5LnZhbHVlICsgXCIuIFxcblxcbiBEbyB5b3Ugd2FudCB0byB1c2UgdGhlIGRhdGEgb24gcGxhbnQgbGV2ZWw/XCIgKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwbGFudC5QbGFudExvY2F0aW9uKSBwbGFudC5QbGFudExvY2F0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUpIHBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50TG9jYXRpb24uQWRkcmVzczEgPSBmYWNpbGl0eS5zdHJlZXROYW1lLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0VtcHR5KGZhY2lsaXR5LmJ1aWxkaW5nTnVtYmVyLnZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50TG9jYXRpb24uQWRkcmVzczEgKz0gXCIgXCIgKyBmYWNpbGl0eS5idWlsZGluZ051bWJlci52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50TG9jYXRpb24uQ2l0eSA9ZmFjaWxpdHkuY2l0eS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50TG9jYXRpb24uUG9zdGFsQ29kZSA9IGZhY2lsaXR5LnBvc3RhbENvZGUudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFudC5QbGFudExvY2F0aW9uLkJ1aWxkaW5nTnVtYmVyID0gZmFjaWxpdHkuYnVpbGRpbmdOdW1iZXIudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxvbmdpdHVkZSA9IGZhY2lsaXR5LmxvbmcudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxhdGl0dWRlID0gZmFjaWxpdHkubGF0LnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuRmFjaWxpdHlOYW1lID0gZmFjaWxpdHkuZmFjaWxpdHlOYW1lLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiVGhlIHN5c3RlbSBjb3VsZCBub3QgZmluZCBhbnkgZmFjaWxpdHkgd2l0aCBOYXRpb25hbElEPVwiICsgcGxhbnQuRVBSVFJOYXRpb25hbElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGFsZXJ0KFwiTWVtYmVyIHN0YXRlIGlzIG5vdCBzZWxlY3RlZCBvbiBCYXNpYyBEYXRhIGZvcm0hXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvL2VkaXQoXG4gICAgICAgICRzY29wZS5vcGVuID0gZnVuY3Rpb24gKHNpemUsbW9kYWxQYWdlSWQpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2cobW9kYWxQYWdlSWQpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygkcm9vdFNjb3BlLm1vZGFsUGFnZUNhc2VJZD09IHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCRyb290U2NvcGUubW9kYWxQYWdlQ2FzZUlkPT1cIkxpc3RPZlBsYW50c1wiKTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJHJvb3RTY29wZS5tb2RhbFBhZ2VDYXNlSWQ9PVwiUGxhbnREZXRhaWxzXCIpO1xuICAgICAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2U7XG4gICAgICAgICAgICAvL0ZvciBhZGRpbmcgbmV3IHBsYW50XG4gICAgICAgICAgICBpZihtb2RhbFBhZ2VJZCA9PSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2UgPSAkbW9kYWwub3Blbih7XG5cbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdMaXN0T2ZQbGFudE1vZGFsQ29udGVudC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0xpc3RPZlBsYW50c01vZGFsSW5zdGFuY2VDdHJsJyxcbiAgICAgICAgICAgICAgICAgICAgc2l6ZTogc2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Q2xhc3M6ICdhcHAtbW9kYWwtd2luZG93JyxcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gICRzY29wZS5wbGFudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL0ZvciBlZGl0aW5nIHBsYW50XG4gICAgICAgICAgICBpZihtb2RhbFBhZ2VJZCA9PSBcIkxpc3RPZlBsYW50c1wiKXtcbiAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlID0gJG1vZGFsLm9wZW4oe1xuXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnTGlzdE9mUGxhbnRNb2RhbENvbnRlbnQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMaXN0T2ZQbGFudHNNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd0NsYXNzOiAnYXBwLW1vZGFsLXdpbmRvdycsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAkc2NvcGUucGxhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobW9kYWxQYWdlSWQgPT0gXCJQbGFudERldGFpbHNcIil7XG4gICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2UgPSAkbW9kYWwub3Blbih7XG5cbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdQbGFudERldGFpbHNNb2RhbENvbnRlbnQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQbGFudERldGFpbHNNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd0NsYXNzOiAnYXBwLW1vZGFsLXdpbmRvdycsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAkc2NvcGUucGxhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobW9kYWxQYWdlSWQ9PVwiVG90YWxFbWlzc2lvbnNUb0FpclwiKXtcbiAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlID0gJG1vZGFsLm9wZW4oe1xuXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnVG90YWxFbWlzc2lvbnNUb0Fpck1vZGFsQ29udGVudC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1RvdGFsRW1pc3Npb25zVG9BaXJNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd0NsYXNzOiAnYXBwLW1vZGFsLXdpbmRvdycsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAkc2NvcGUucGxhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobW9kYWxQYWdlSWQ9PVwiRW5lcmd5SW5wdXRcIil7XG4gICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZSA9ICRtb2RhbC5vcGVuKHtcblxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ0VuZXJneUlucHV0TW9kYWxDb250ZW50Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRW5lcmd5SW5wdXRNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd0NsYXNzOiAnYXBwLW1vZGFsLXdpbmRvdycsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAkc2NvcGUucGxhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobW9kYWxQYWdlSWQ9PVwiRGVzdWxwaHVyaXNhdGlvblwiKXtcbiAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlID0gJG1vZGFsLm9wZW4oe1xuXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnRGVzdWxwaHVyaXNhdGlvbk1vZGFsQ29udGVudC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rlc3VscGh1cmlzYXRpb25Nb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd0NsYXNzOiAnYXBwLW1vZGFsLXdpbmRvdycsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAkc2NvcGUucGxhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobW9kYWxQYWdlSWQ9PVwiVXNlZnVsSGVhdFwiKXtcbiAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlID0gJG1vZGFsLm9wZW4oe1xuXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnVXNlZnVsSGVhdE1vZGFsQ29udGVudC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1VzZWZ1bEhlYXRNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd0NsYXNzOiAnYXBwLW1vZGFsLXdpbmRvdycsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAkc2NvcGUucGxhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtb2RhbEluc3RhbmNlLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChzZWxlY3RlZEl0ZW0pIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSBzZWxlY3RlZEl0ZW07XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8kbG9nLmluZm8oJ01vZGFsIGRpc21pc3NlZCBhdDogJyArIG5ldyBEYXRlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICBhcHAuY29udHJvbGxlcignTGlzdE9mUGxhbnRzTW9kYWxJbnN0YW5jZUN0cmwnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHNjb3BlLCAkbW9kYWxJbnN0YW5jZSwgcGxhbnQsZGF0YVJlcG9zaXRvcnkpIHtcbiAgICAgICAgdmFyIGVkaXQgPSBmYWxzZTtcblxuICAgICAgICBpZihwbGFudCAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgZWRpdCA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoSlNPTi5zdHJpbmdpZnkoICRzY29wZS5yZWdpb25zQ29kZWxpc3QgKSA9PT0gXCJ7fVwiKSAge1xuXG4gICAgICAgICAgICBpZiAoICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkJhc2ljRGF0YS5NZW1iZXJTdGF0ZSApXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlZ2lvbnNDb2RlbGlzdCA9IGRhdGFSZXBvc2l0b3J5LmxvYWRSZWdpb25zQ29kZWxpc3QoJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuQmFzaWNEYXRhLk1lbWJlclN0YXRlKTtcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGFsZXJ0KFwiUGxlYXNlIGZpbGwgaW4gdGhlIE1lbWJlciBTdGF0ZSBmcm9tIEJhc2ljIEluZm8gZmlyc3QuXCIpO1xuICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSAkc2NvcGUubWFpbkZvcm1TdWJtaXR0ZWQ7XG4gICAgICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuZGlzbWlzcygnY2FuY2VsJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUub2sgPSBmdW5jdGlvbiAocGxhbnQpIHtcblxuICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICBpZihwbGFudCAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgIGlmKHBsYW50LlBsYW50TmFtZSAhPSBudWxsICYmIHBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTG9uZ2l0dWRlICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICgxODAgPj0gcGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5Mb25naXR1ZGUgJiYgcGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5Mb25naXR1ZGUgPj0gLTE4MCkgICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxhdGl0dWRlICE9IG51bGwgJiYgKDkwID49IHBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTGF0aXR1ZGUgJiYgcGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5MYXRpdHVkZSA+PSAtOTApKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoIWVkaXQpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHBsYW50LlBsYW50TG9jYXRpb24gPT0gbnVsbCApIHBsYW50LlBsYW50TG9jYXRpb24gPSB7fSA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYXN0UGxhbnQgPSAkc2NvcGUuYWRkSXRlbSgnTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gJHNjb3BlLmdldE5leHRQbGFudElkICgpIDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVzaW5nICRxIHByb21pc2UgQVBJLCB0byBhc2sgdGhlIHNlcnZlciBmaXJzdCBmb3IgaWQgY29sbGlzaW9ucy5cbiAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2UudGhlbiAoIGZ1bmN0aW9uICggcGxhbnRpZCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudElkID0gcGxhbnRpZCA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50LlBsYW50TmFtZSA9ICBwbGFudC5QbGFudE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50LkVQUlRSTmF0aW9uYWxJZCA9ICBwbGFudC5FUFJUUk5hdGlvbmFsSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50LlBsYW50TG9jYXRpb24uU3RyZWV0TmFtZSA9ICBwbGFudC5QbGFudExvY2F0aW9uLlN0cmVldE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBsYXN0UGxhbnQuUGxhbnRMb2NhdGlvbi5BZGRyZXNzMiA9ICBwbGFudC5QbGFudExvY2F0aW9uLkFkZHJlc3MyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudExvY2F0aW9uLkNpdHkgPSAgcGxhbnQuUGxhbnRMb2NhdGlvbi5DaXR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudExvY2F0aW9uLlJlZ2lvbiA9ICBwbGFudC5QbGFudExvY2F0aW9uLlJlZ2lvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuUGxhbnRMb2NhdGlvbi5Qb3N0YWxDb2RlID0gIHBsYW50LlBsYW50TG9jYXRpb24uUG9zdGFsQ29kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuUGxhbnRMb2NhdGlvbi5CdWlsZGluZ051bWJlciA9ICBwbGFudC5QbGFudExvY2F0aW9uLkJ1aWxkaW5nTnVtYmVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudExvY2F0aW9uLkNvdW50cnlDb2RlID0gICRzY29wZS5tZW1iZXJTdGF0ZVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxvbmdpdHVkZSA9ICBwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxvbmdpdHVkZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5MYXRpdHVkZSA9ICBwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxhdGl0dWRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5GYWNpbGl0eU5hbWUgPSAgcGxhbnQuRmFjaWxpdHlOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5Db21tZW50cyA9ICBwbGFudC5Db21tZW50cztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgndXBkYXRlRmlsdGVyJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2xvYWQgTWFpbiBmb3JtIHZhbGlkYXRpb24gc3RhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gJHNjb3BlLm1haW5Gb3JtU3VibWl0dGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zYXZlSW5zdGFuY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UocGxhbnQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYXN0UGxhbnQgPSAkc2NvcGUub3JpZ2luYWxQbGFudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudE5hbWUgPSAgcGxhbnQuUGxhbnROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50LkVQUlRSTmF0aW9uYWxJZCA9ICBwbGFudC5FUFJUUk5hdGlvbmFsSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuUGxhbnRMb2NhdGlvbi5TdHJlZXROYW1lID0gIHBsYW50LlBsYW50TG9jYXRpb24uU3RyZWV0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vbGFzdFBsYW50LlBsYW50TG9jYXRpb24uQWRkcmVzczIgPSAgcGxhbnQuUGxhbnRMb2NhdGlvbi5BZGRyZXNzMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudExvY2F0aW9uLkNpdHkgPSAgcGxhbnQuUGxhbnRMb2NhdGlvbi5DaXR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50LlBsYW50TG9jYXRpb24uUmVnaW9uID0gIHBsYW50LlBsYW50TG9jYXRpb24uUmVnaW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50LlBsYW50TG9jYXRpb24uQnVpbGRpbmdOdW1iZXIgPSAgcGxhbnQuUGxhbnRMb2NhdGlvbi5CdWlsZGluZ051bWJlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudExvY2F0aW9uLlBvc3RhbENvZGUgPSAgcGxhbnQuUGxhbnRMb2NhdGlvbi5Qb3N0YWxDb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50LlBsYW50TG9jYXRpb24uQ291bnRyeUNvZGUgPSAgcGxhbnQuUGxhbnRMb2NhdGlvbi5Db3VudHJ5Q29kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxvbmdpdHVkZSA9ICBwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxvbmdpdHVkZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxhdGl0dWRlID0gIHBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTGF0aXR1ZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuRmFjaWxpdHlOYW1lID0gIHBsYW50LkZhY2lsaXR5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5Db21tZW50cyA9ICBwbGFudC5Db21tZW50cztcblxuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVGaWx0ZXInKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9sb2FkIE1haW4gZm9ybSB2YWxpZGF0aW9uIHN0YWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gJHNjb3BlLm1haW5Gb3JtU3VibWl0dGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zYXZlSW5zdGFuY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKHBsYW50KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiUGxlYXNlIGZpbGwgaW4gYWxsIG1hbmRhdG9yeSBmaWVsZHMhXCIpO1xuICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICBhbGVydChcIlBsZWFzZSBmaWxsIGluIGFsbCBtYW5kYXRvcnkgZmllbGRzIVwiKTtcbiAgICAgICAgICAgICB9XG5cbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnNhdmVBbmRBZGQgPSAgZnVuY3Rpb24ocGxhbnQpe1xuICAgICAgICAgICAgJHNjb3BlLm9rKHBsYW50KTtcbiAgICAgICAgICAgIHNhdmVJbnN0YW5jZSgpO1xuICAgICAgICB9XG4gICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvL2xvYWQgTWFpbiBmb3JtIHZhbGlkYXRpb24gc3RhZ2VcbiAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSAkc2NvcGUubWFpbkZvcm1TdWJtaXR0ZWQ7XG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbiAgICAgICAgfTtcbiAgICB9KTtcbiAgICBhcHAuY29udHJvbGxlcignUGxhbnREZXRhaWxzTW9kYWxJbnN0YW5jZUN0cmwnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJGZpbHRlciwgJHNjb3BlLCAkbW9kYWxJbnN0YW5jZSwgcGxhbnQpIHtcbiAgICAgICAgJHNjb3BlLm9rID0gZnVuY3Rpb24gKHBsYW50KSB7XG4gICAgICAgICAgICBpZiAoISRzY29wZS5tb2RhbFBsYW50RGV0YWlscy4kaW52YWxpZCkge1xuICAgICAgICAgICAgICAgIHZhciBsYXN0UGxhbnQgPSAkc2NvcGUub3JpZ2luYWxQbGFudDtcblxuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudERldGFpbHMuVHlwZU9mQ29tYnVzdGlvblBsYW50ID0gcGxhbnQuUGxhbnREZXRhaWxzLlR5cGVPZkNvbWJ1c3Rpb25QbGFudDtcbiAgICAgICAgICAgICAgICBsYXN0UGxhbnQuUGxhbnREZXRhaWxzLk1XdGggPSAgcGxhbnQuUGxhbnREZXRhaWxzLk1XdGg7XG4gICAgICAgICAgICAgICAgbGFzdFBsYW50LlBsYW50RGV0YWlscy5EYXRlT2ZTdGFydE9mT3BlcmF0aW9uID0gIHBsYW50LlBsYW50RGV0YWlscy5EYXRlT2ZTdGFydE9mT3BlcmF0aW9uO1xuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudERldGFpbHMuRGVyb2dhdGlvbiA9IHBsYW50LlBsYW50RGV0YWlscy5EZXJvZ2F0aW9uO1xuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudERldGFpbHMuUmVmaW5lcmllcyA9ICAkZmlsdGVyKCdsb3dlcmNhc2UnKShwbGFudC5QbGFudERldGFpbHMuUmVmaW5lcmllcyk7XG4gICAgICAgICAgICAgICAgbGFzdFBsYW50LlBsYW50RGV0YWlscy5PdGhlclNlY3RvciA9ICBwbGFudC5QbGFudERldGFpbHMuT3RoZXJTZWN0b3I7XG4gICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBsYXN0UGxhbnQuUGxhbnREZXRhaWxzLk9wZXJhdGluZ0hvdXJzID0gIHBsYW50LlBsYW50RGV0YWlscy5PcGVyYXRpbmdIb3VycztcbiAgICAgICAgICAgICAgICBsYXN0UGxhbnQuUGxhbnREZXRhaWxzLkNvbW1lbnRzID0gIHBsYW50LlBsYW50RGV0YWlscy5Db21tZW50cztcblxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgndXBkYXRlRmlsdGVyJyk7XG5cbiAgICAgICAgICAgICAgICAvL2xvYWQgTWFpbiBmb3JtIHZhbGlkYXRpb24gc3RhZ2VcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gJHNjb3BlLm1haW5Gb3JtU3VibWl0dGVkO1xuICAgICAgICAgICAgICAgICRzY29wZS5tb2RhbFBsYW50RGV0YWlscy4kc2V0UHJpc3RpbmUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UocGxhbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBhbGVydChcIlBsZWFzZSBmaWxsIGluIGFsbCBtYW5kYXRvcnkgZmllbGRzISBcIik7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vbG9hZCBNYWluIGZvcm0gdmFsaWRhdGlvbiBzdGFnZVxuICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9ICRzY29wZS5tYWluRm9ybVN1Ym1pdHRlZDtcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xuICAgICAgICB9O1xuICAgIH0pO1xuXG4gICAgYXBwLmNvbnRyb2xsZXIoJ1RvdGFsRW1pc3Npb25zVG9BaXJNb2RhbEluc3RhbmNlQ3RybCcsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkc2NvcGUsICRtb2RhbEluc3RhbmNlLCBwbGFudCkge1xuXG4gICAgICAgICRzY29wZS5vayA9IGZ1bmN0aW9uIChwbGFudCkge1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUubW9kYWxUb3RhbEVtaXNzaW9uc1RvQWlyLiRpbnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxhc3RQbGFudCA9ICRzY29wZS5vcmlnaW5hbFBsYW50O1xuXG4gICAgICAgICAgICAgICAgbGFzdFBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5Ub3RhbEVtaXNzaW9uc1RvQWlyLlNPMiA9ICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuVG90YWxFbWlzc2lvbnNUb0Fpci5TTzI7XG4gICAgICAgICAgICAgICAgbGFzdFBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5Ub3RhbEVtaXNzaW9uc1RvQWlyLk5PeCA9ICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuVG90YWxFbWlzc2lvbnNUb0Fpci5OT3g7XG4gICAgICAgICAgICAgICAgbGFzdFBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5Ub3RhbEVtaXNzaW9uc1RvQWlyLlRTUCA9ICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuVG90YWxFbWlzc2lvbnNUb0Fpci5UU1A7XG5cbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZUZpbHRlcicpO1xuXG4gICAgICAgICAgICAgICAgLy9sb2FkIE1haW4gZm9ybSB2YWxpZGF0aW9uIHN0YWdlXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9ICRzY29wZS5tYWluRm9ybVN1Ym1pdHRlZDtcbiAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWxUb3RhbEVtaXNzaW9uc1RvQWlyLiRzZXRQcmlzdGluZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZShwbGFudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGFsZXJ0KFwiUGxlYXNlIGZpbGwgaW4gYWxsIG1hbmRhdG9yeSBmaWVsZHMhIFwiKTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy9sb2FkIE1haW4gZm9ybSB2YWxpZGF0aW9uIHN0YWdlXG4gICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gJHNjb3BlLm1haW5Gb3JtU3VibWl0dGVkO1xuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuZGlzbWlzcygnY2FuY2VsJyk7XG4gICAgICAgIH07XG4gICAgfSk7XG5hcHAuY29udHJvbGxlcignRW5lcmd5SW5wdXRNb2RhbEluc3RhbmNlQ3RybCcsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkc2NvcGUsICRtb2RhbEluc3RhbmNlLCBwbGFudCkge1xuXG4gICAgICAgICRzY29wZS5vayA9IGZ1bmN0aW9uIChwbGFudCkge1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUubW9kYWxFbmVyZ3lJbnB1dC4kaW52YWxpZCkge1xuICAgICAgICAgICAgICAgIHZhciBsYXN0UGxhbnQgPSAkc2NvcGUub3JpZ2luYWxQbGFudDtcblxuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuQmlvbWFzcyA9ICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuQmlvbWFzcztcbiAgICAgICAgICAgICAgICBsYXN0UGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0LkJpb21hc3MgPSAgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0LkJpb21hc3M7ICBcbiAgICAgICAgICAgICAgICBsYXN0UGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0LkNvYWwgPSAgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0LkNvYWw7ICAgICAgXG4gICAgICAgICAgICAgICAgbGFzdFBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5MaWduaXRlID0gIHBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5MaWduaXRlOyAgICAgIFxuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuUGVhdCA9ICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuUGVhdDsgICAgICBcbiAgICAgICAgICAgICAgICBsYXN0UGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk90aGVyU29saWRGdWVscy5DYXRlZ29yeSA9ICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuT3RoZXJTb2xpZEZ1ZWxzLkNhdGVnb3J5O1xuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuT3RoZXJTb2xpZEZ1ZWxzLlZhbHVlID0gIHBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5PdGhlclNvbGlkRnVlbHMuVmFsdWU7XG4gICAgICAgICAgICAgICAgbGFzdFBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5MaXF1aWRGdWVscyA9ICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuTGlxdWlkRnVlbHM7XG4gICAgICAgICAgICAgICAgbGFzdFBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5OYXR1cmFsR2FzID0gIHBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5OYXR1cmFsR2FzO1xuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuT3RoZXJHYXNlcy5DYXRlZ29yeSA9ICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuT3RoZXJHYXNlcy5DYXRlZ29yeTtcbiAgICAgICAgICAgICAgICBsYXN0UGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk90aGVyR2FzZXMuVmFsdWUgPSAgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk90aGVyR2FzZXMuVmFsdWU7XG5cbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZUZpbHRlcicpO1xuXG4gICAgICAgICAgICAgICAgLy9sb2FkIE1haW4gZm9ybSB2YWxpZGF0aW9uIHN0YWdlXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9ICRzY29wZS5tYWluRm9ybVN1Ym1pdHRlZDtcbiAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWxFbmVyZ3lJbnB1dC4kc2V0UHJpc3RpbmUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UocGxhbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBhbGVydChcIlBsZWFzZSBmaWxsIGluIGFsbCBtYW5kYXRvcnkgZmllbGRzISBcIik7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vbG9hZCBNYWluIGZvcm0gdmFsaWRhdGlvbiBzdGFnZVxuICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9ICRzY29wZS5tYWluRm9ybVN1Ym1pdHRlZDtcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xuICAgICAgICB9O1xuICAgIH0pO1xuXG4gICAgXG4gICAgICAgICAgICBhcHAuY29udHJvbGxlcignRGVzdWxwaHVyaXNhdGlvbk1vZGFsSW5zdGFuY2VDdHJsJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRzY29wZSwgJG1vZGFsSW5zdGFuY2UsIHBsYW50KSB7XG5cbiAgICAgICAgICAgICAgICAvL1dlIGNoZWNrIGlmIE1vbnRoIGlzIGFuIGFycmF5IGFuZCBpZiBub3QgaW5pdGlhbGl6ZSBpdCBhcyBhbiBhcnJheSBpbiBvcmRlciB0byB0aGVuIGZpbGwgaXQgYmVsb3cuXG4gICAgICAgICAgICAgICAgaWYocGxhbnQuRGVzdWxwaHVyaXNhdGlvbi5Nb250aHM9PW51bGwgfHwgcGxhbnQuRGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGg9PW51bGwgIHx8IHBsYW50LkRlc3VscGh1cmlzYXRpb24uTW9udGhzLk1vbnRoLmNvbnN0cnVjdG9yID09PSBPYmplY3QgfHwgcGxhbnQuRGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGgubGVuZ3RoPT0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHBsYW50LkRlc3VscGh1cmlzYXRpb24uTW9udGhzLk1vbnRoPVtdO1xuICAgICAgICAgICAgICAgIC8vSWYgTW9udGhzIEVtcHR5ICwgaW5pdGlhbGl6ZSB0aGVtIGJlZm9yZSB0aGUgbW9kYWxcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLmNvZGVMaXN0Lk1vbnRobHlEZXN1bHBodXJpc2F0aW9uLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocGxhbnQuRGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGhba2V5XT09bnVsbCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuRGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGgucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTW9udGhWYWx1ZVwiOiB2YWx1ZS5Nb250aFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkRlc3VscGh1cmlzYXRpb25SYXRlXCI6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiU3VscGh1ckNvbnRlbnRcIjogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJUZWNobmljYWxKdXN0aWZpY2F0aW9uXCI6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICRzY29wZS5vayA9IGZ1bmN0aW9uIChwbGFudCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoISRzY29wZS5tb2RhbERlc3VscGh1cmlzYXRpb24uJGludmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYXN0UGxhbnQgPSAkc2NvcGUub3JpZ2luYWxQbGFudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuY29kZUxpc3QuTW9udGhseURlc3VscGh1cmlzYXRpb24sIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAvKiogICAgICAgcGxhbnQuRGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGgucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTW9udGhWYWx1ZVwiOiB2YWx1ZS5Nb250aFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkRlc3VscGh1cmlzYXRpb25SYXRlXCI6IHZhbHVlLkRlc3VscGh1cmlzYXRpb25SYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlN1bHBodXJDb250ZW50XCI6IHZhbHVlLlN1bHBodXJDb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRlY2huaWNhbEp1c3RpZmljYXRpb25cIjogdmFsdWUuVGVjaG5pY2FsSnVzdGlmaWNhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgKiovXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuRGVzdWxwaHVyaXNhdGlvbiA9IHBsYW50LkRlc3VscGh1cmlzYXRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZUZpbHRlcicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9sb2FkIE1haW4gZm9ybSB2YWxpZGF0aW9uIHN0YWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gJHNjb3BlLm1haW5Gb3JtU3VibWl0dGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vZGFsRGVzdWxwaHVyaXNhdGlvbi4kc2V0UHJpc3RpbmUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZShwbGFudCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJQbGVhc2UgZmlsbCBpbiBhbGwgbWFuZGF0b3J5IGZpZWxkcyEgXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vbG9hZCBNYWluIGZvcm0gdmFsaWRhdGlvbiBzdGFnZVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gJHNjb3BlLm1haW5Gb3JtU3VibWl0dGVkO1xuICAgICAgICAgICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGFwcC5jb250cm9sbGVyKCdVc2VmdWxIZWF0TW9kYWxJbnN0YW5jZUN0cmwnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHNjb3BlLCAkbW9kYWxJbnN0YW5jZSwgcGxhbnQpIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5vayA9IGZ1bmN0aW9uIChwbGFudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHNjb3BlLm1vZGFsVXNlZnVsSGVhdC4kaW52YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFzdFBsYW50ID0gJHNjb3BlLm9yaWdpbmFsUGxhbnQ7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5Vc2VmdWxIZWF0LlVzZWZ1bEhlYXRQcm9wb3J0aW9uID0gIHBsYW50LlVzZWZ1bEhlYXQuVXNlZnVsSGVhdFByb3BvcnRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVGaWx0ZXInKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9sb2FkIE1haW4gZm9ybSB2YWxpZGF0aW9uIHN0YWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSAkc2NvcGUubWFpbkZvcm1TdWJtaXR0ZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tb2RhbFVzZWZ1bEhlYXQuJHNldFByaXN0aW5lKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZShwbGFudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydChcIlBsZWFzZSBmaWxsIGluIGFsbCBtYW5kYXRvcnkgZmllbGRzISBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2xvYWQgTWFpbiBmb3JtIHZhbGlkYXRpb24gc3RhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gJHNjb3BlLm1haW5Gb3JtU3VibWl0dGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgXG4gICAgYXBwLmZpbHRlcigndHJ1ZV9mYWxzZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odGV4dCwgbGVuZ3RoLCBlbmQpIHtcbiAgICAgICAgICAgIGlmICh0ZXh0ICYmICh0ZXh0ID09PSB0cnVlIHx8IHRleHQgPT09ICdUUlVFJykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1llcyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJ05vJztcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgYXBwLmNvbnRyb2xsZXIoXCJQYWdpbmF0aW9uQ3RybFwiLCBmdW5jdGlvbigkc2NvcGUsICRmaWx0ZXIsICRyb290U2NvcGUsICRtb2RhbCkge1xuXG5cblxuICAgICAgICB2YXIgb3JkZXJCeSA9ICRmaWx0ZXIoJ29yZGVyQnknKTtcbiAgICAgICAgLypcbiAgICAgICAgICAgIGlmICghYW5ndWxhci5pc0FycmF5KCRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cykpe1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cyA9IFskc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHNdO1xuICAgICAgICAgICAgfVxuICAgICAgICAqL1xuXG5cbiAgICAgICAgJHNjb3BlLml0ZW1zUGVyUGFnZSA9IDUwO1xuICAgICAgICAkc2NvcGUuY3VycmVudFBhZ2UgPSAwO1xuICAgICAgICAkc2NvcGUubWF4UGFnZXMgPSAxNTtcbiAgICAgICAgJHNjb3BlLnNlYXJjaFRleHQgPSBcIlwiO1xuICAgICAgICAkc2NvcGUuZmlsdGVyZWRJdGVtcyA9IFtdO1xuICAgICAgICAkc2NvcGUucHJlZGljYXRlQXR0cmlidXRlID0gJ1BsYW50SWQnO1xuICAgICAgICAkc2NvcGUuc2hvd01lc3NhZ2UgPSBmYWxzZTtcbiAgICAgICAgJHNjb3BlLnByZWRpY2F0ZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgIHJldHVybiBpdGVtWyRzY29wZS5wcmVkaWNhdGVBdHRyaWJ1dGVdO1xuICAgICAgICB9XG4gICAgICAgICRzY29wZS5yZXZlcnNlID0gZmFsc2U7XG5cblxuXG4gICAgICAgICRzY29wZS5vcmRlciA9IGZ1bmN0aW9uKGF0dHJpYnV0ZSwgb3JkZXIpIHtcbiAgICAgICAgICAgICRzY29wZS5wcmVkaWNhdGVBdHRyaWJ1dGUgPSBhdHRyaWJ1dGU7XG4gICAgICAgICAgICAkc2NvcGUucmV2ZXJzZSA9IG9yZGVyO1xuICAgICAgICAgICAgJHNjb3BlLmZpbHRlcmVkSXRlbXMgPSBvcmRlckJ5KCRzY29wZS5maWx0ZXJlZEl0ZW1zLCAkc2NvcGUucHJlZGljYXRlLCAkc2NvcGUucmV2ZXJzZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLiRvbignaW5zdGFuY2VSZWFkeScsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XG5cbiAgICAgICAgICAgICRzY29wZS5maWx0ZXJlZEl0ZW1zID0gJHNjb3BlLmdldEZpbHRlcmVkSXRlbXMoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiRvbigndXBkYXRlRmlsdGVyJywgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcblxuICAgICAgICAgICAgJHNjb3BlLmZpbHRlcmVkSXRlbXMgPSAkc2NvcGUuZ2V0RmlsdGVyZWRJdGVtcygpO1xuICAgICAgICAgICAgJHNjb3BlLm9yZGVyKCRzY29wZS5wcmVkaWNhdGVBdHRyaWJ1dGUsICRzY29wZS5yZXZlcnNlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLnJhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoISRzY29wZS5pbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHJhbmdlU2l6ZSA9ICgkc2NvcGUucGFnZUNvdW50KCkgPj0gJHNjb3BlLk1heFBhZ2VzKT8gJHNjb3BlLk1heFBhZ2VzIDogJHNjb3BlLnBhZ2VDb3VudCgpKzE7XG4gICAgICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgICAgICB2YXIgc3RhcnQ7XG5cbiAgICAgICAgICAgIHN0YXJ0ID0gJHNjb3BlLmN1cnJlbnRQYWdlO1xuICAgICAgICAgICAgaWYgKCBzdGFydCA+ICRzY29wZS5wYWdlQ291bnQoKS1yYW5nZVNpemUgKSB7XG4gICAgICAgICAgICAgICAgc3RhcnQgPSAkc2NvcGUucGFnZUNvdW50KCktcmFuZ2VTaXplKzE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAodmFyIGk9c3RhcnQ7IGk8c3RhcnQrcmFuZ2VTaXplOyBpKyspIHtcbiAgICAgICAgICAgICAgICByZXQucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnByZXZQYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmN1cnJlbnRQYWdlID4gMCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50UGFnZS0tO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5wcmV2UGFnZURpc2FibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLmN1cnJlbnRQYWdlID09PSAwID8gXCJkaXNhYmxlZFwiIDogXCJcIjtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuZ2V0RmlsdGVyZWRJdGVtcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUuaW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJGZpbHRlcignZmlsdGVyJykoJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50LCAkc2NvcGUuc2VhcmNoVGV4dCk7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUucmVmcmVzaEl0ZW1zID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLy8vY29uc29sZS5sb2coXCJGaWx0ZXIgY2hhbmdlZC4gR2V0dGluZyBuZXcgaXRlbXMuLi5cIik7XG4gICAgICAgICAgICAkc2NvcGUuZmlsdGVyZWRJdGVtcyA9ICRzY29wZS5nZXRGaWx0ZXJlZEl0ZW1zKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCgnc2VhcmNoVGV4dCcsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICAgICAgLy8vL2NvbnNvbGUubG9nKFwiRmlsdGVyIGNoYW5nZWQuIEdldHRpbmcgbmV3IGl0ZW1zLi4uXCIpO1xuICAgICAgICAgICAgJHNjb3BlLmZpbHRlcmVkSXRlbXMgPSAkc2NvcGUuZ2V0RmlsdGVyZWRJdGVtcygpO1xuICAgICAgICAgICAgaWYobmV3VmFsdWUgIT0gb2xkVmFsdWUpe1xuICAgICAgICAgICAgICAgICRzY29wZS5zZXRQYWdlKDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUucGFnZUNvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoISRzY29wZS5pbnN0YW5jZSB8fCAhJHNjb3BlLmZpbHRlcmVkSXRlbXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBpdGVtcyA9ICRzY29wZS5maWx0ZXJlZEl0ZW1zO1xuICAgICAgICAgICAgdmFyIGNvdW50ID0gTWF0aC5jZWlsKGl0ZW1zLmxlbmd0aC8kc2NvcGUuaXRlbXNQZXJQYWdlKS0xO1xuICAgICAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5uZXh0UGFnZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5jdXJyZW50UGFnZSA8ICRzY29wZS5wYWdlQ291bnQoKSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50UGFnZSsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5uZXh0UGFnZURpc2FibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLmN1cnJlbnRQYWdlID09PSAkc2NvcGUucGFnZUNvdW50KCkgPyBcImRpc2FibGVkXCIgOiBcIlwiO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5zZXRQYWdlID0gZnVuY3Rpb24obikge1xuICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRQYWdlID0gbjtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmRlbGV0ZVNlbGVjdGVkID0gZnVuY3Rpb24oc2VsZWN0ZWRJdGVtcyl7XG4gICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzZWxlY3RlZEl0ZW1zLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgaWYoc2VsZWN0ZWRJdGVtc1tpXS5EZWxldGUgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoc2VsZWN0ZWRJdGVtc1tpXS5EZWxldGUgPT0gdHJ1ZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGNvdW50Tm9uRW1wdHlQcm9wZXJ0aWVzKHNlbGVjdGVkSXRlbXNbaV0pID4gMCkgJiYgJHNjb3BlLnNob3dNZXNzYWdlID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoZSBzZWxlY3RlZCByb3dzPycpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dNZXNzYWdlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dNZXNzYWdlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlbW92ZSgkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQsIHNlbGVjdGVkSXRlbXNbaV0sIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuc2hvd01lc3NhZ2UgPSBmYWxzZTtcbiAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgndXBkYXRlRmlsdGVyJyk7XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLmVkaXQgPSBmdW5jdGlvbiAocGxhbnQsIG1vZGFsUGFnZUlkKSB7XG4gICAgICAgICAgICAvLyRyb290U2NvcGUuJGJyb2FkY2FzdCgnZWRpdFBsYW50JywgcGxhbnQpO1xuICAgICAgICAgICAgJHJvb3RTY29wZS5zZWxlY3RlZFBsYW50ID0gcGxhbnQ7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLm1vZGFsUGFnZUNhc2VJZCA9IG1vZGFsUGFnZUlkO1xuLypcbiAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJG1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnTGlzdE9mUGxhbnRNb2RhbENvbnRlbnQuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0xpc3RPZlBsYW50c01vZGFsSW5zdGFuY2VDdHJsJyxcbiAgICAgICAgICAgICAgICBzaXplOiAnbGcnLFxuICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgd2luZG93Q2xhc3M6ICdhcHAtbW9kYWwtd2luZG93JyxcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgIHBsYW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIHBsYW50O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAqL1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vb3JkZXJPYmplY3RCeSBwYWdpbmF0aW9uXG4gICAgICAgIC8vJHNjb3BlLnBsYW50T2JqZWN0cyA9ICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudDtcbiAgICAgICAgJHNjb3BlLmNyaXRlcmlhID0gJ1BsYW50TmFtZSc7XG4gICAgICAgICRzY29wZS5kaXJlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgJHNjb3BlLnNldENyaXRlcmlhID0gZnVuY3Rpb24oY3JpdGVyaWEpIHtcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY3JpdGVyaWEgPT09IGNyaXRlcmlhKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRpcmVjdGlvbiA9ICEkc2NvcGUuZGlyZWN0aW9uO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3JpdGVyaWEgPSBjcml0ZXJpYTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGlyZWN0aW9uICA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cblxuICAgIC8vIG5ldyBlbmRcblxuICAgIGZ1bmN0aW9uIGdldFdlYlFVcmwocGF0aCl7XG4gICAgICAgIHZhciB1cmwgPSBiYXNlVXJpICsgcGF0aDtcbiAgICAgICAgdXJsICs9IFwiP2ZpbGVJZD1cIiArIGZpbGVJZDtcbiAgICAgICAgaWYgKHNlc3Npb25JZCAmJiBzZXNzaW9uSWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgdXJsICs9IFwiJnNlc3Npb25pZD1cIiArIHNlc3Npb25JZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdXJsO1xuICAgIH1cbiAgICAvLyBoZWxwZXIgZnVuY3Rpb24gZm9yIGdldHRpbmcgcXVlcnkgc3RyaW5nIHBhcmFtZXRlciB2YWx1ZXMuIEFuZ3VsYXJKUyBzb2x1dGlvbiAkbG9jYXRpb24uc2VhcmNoKCkgZG9lc24ndCB3b3JrIGluIElFOC5cbiAgICBmdW5jdGlvbiBnZXRQYXJhbWV0ZXJCeU5hbWUobmFtZSkge1xuICAgICAgICB2YXIgc2VhcmNoQXJyID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zcGxpdCgnPycpO1xuICAgICAgICB2YXIgc2VhcmNoID0gJz8nICsgc2VhcmNoQXJyW3NlYXJjaEFyci5sZW5ndGggLSAxXTtcbiAgICAgICAgdmFyIG1hdGNoID0gbmV3IFJlZ0V4cCgnWz8mXScgKyBuYW1lICsgJz0oW14mXSopJykuZXhlYyhzZWFyY2gpO1xuICAgICAgICByZXR1cm4gbWF0Y2ggJiYgZGVjb2RlVVJJQ29tcG9uZW50KG1hdGNoWzFdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gZ2V0SGFuZHNvbnRhYmxlQ29sSGVhZGVycyhmb3JtKSB7XG4gICAgICAgIGlmIChmb3JtID09ICdMaXN0T2ZQbGFudHMnKXtcbiAgICAgICAgICAgIHJldHVybiBbXCJQbGFudCBOYW1lXCIsIFwiUGxhbnQgSWRcIiwgXCJFLVBSVFIgbmF0aW9uYWwgSURcIiwgXCJTdHJlZXQgTmFtZSBcIiwgXCJDaXR5XCIsIFwiUmVnaW9uXCIsIFwiUG9zdGFsIGNvZGVcIixcIkNvdW50cnkgQ29kZVwiLFwiQnVpbGRpbmcgTnVtYmVyXCIsIFwiTG9uZ2l0dWRlXCIsIFwiTGF0aXR1ZGVcIiwgXCJGYWNpbGl0eSBuYW1lXCIsIFwiQ29tbWVudHNcIl1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChmb3JtID09ICdQbGFudERldGFpbHMnKXtcbiAgICAgICAgICAgIHJldHVybiBbXCJQbGFudCBuYW1lXCIsIFwiUGxhbnQgSURcIiwgXCJNV3RoXCIsXCJUeXBlIG9mIENvbWJ1c3Rpb24gUGxhbnRcIiwgXCJEYXRlIG9mIHN0YXJ0IG9mIG9wZXJhdGlvblwiLCBcIlJlZmluZXJpZXNcIiwgIFwiR2FzIHR1cmJpbmVcIiwgXCJNV3RoIC0gZ2FzIHR1cmJpbmVcIiwgXCJCb2lsZXJcIiwgXCJNV3RoIC0gYm9pbGVyXCIsXCJPdGhlclwiLFwiT3RoZXIgdHlwZSBvZiBjb21idXN0aW9uXCIsIFwiTVd0aCAtIG90aGVyXCIsIFwiT3BlcmF0aW5nIGhvdXJzXCIsXCJEZXJvZ2F0aW9uXCIsIFwiQ29tbWVudHNcIl1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChmb3JtID09ICdFbmVyZ3lJbnB1dCcpe1xuICAgICAgICAgICAgcmV0dXJuIFtcIlBsYW50IG5hbWVcIiwgXCJQbGFudCBJRFwiLCBcIkJpb21hc3MgKFRKKVwiLFwiQ29hbFwiLFwiTGlnbml0ZVwiLFwiUGVhdFwiLCBcIk90aGVyIHNvbGlkIGZ1ZWxzIChUSikgQ2F0ZWdvcnlcIixcIk90aGVyIHNvbGlkIGZ1ZWxzIChUSikgVmFsdWVcIiAsIFwiTGlxdWlkIGZ1ZWxzIChUSilcIiwgXCJOYXR1cmFsIGdhcyAoVEopXCIsIFwiT3RoZXIgZ2FzZXMgKFRKKSBDYXRlZ29yeVwiLFwiT3RoZXIgZ2FzZXMgKFRKKSBWYWx1ZVwiLCBcIlNPMiAodClcIiwgXCJOT3ggKHQpXCIsIFwiRHVzdCAodClcIl1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChmb3JtID09ICdUb3RhbEVtaXNzaW9uc1RvQWlyJyl7XG4gICAgICAgICAgICByZXR1cm4gW1wiUGxhbnQgbmFtZVwiLCBcIlBsYW50IElEXCIsIFwiU08yICh0KVwiLCBcIk5PeCAodClcIiwgXCJUU1AgKHQpXCJdXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZm9ybSA9PSAnRGVzdWxwaHVyaXNhdGlvbicpe1xuICAgICAgICAgICAgcmV0dXJuIFtcIkRlc3VscGh1cmlzYXRpb24gUmF0ZVwiLCBcIlN1bHBodXIgQ29udGVudFwiLCBcIlRlY2huaWNhbCBKdXN0aWZpY2F0aW9uXCIsIFwiTW9udGhcIl1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChmb3JtID09ICdVc2VmdWxIZWF0Jyl7XG4gICAgICAgICAgICByZXR1cm4gW1wiVXNlZnVsSGVhdCBQcm9wb3J0aW9uXCJdXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL2RlZmF1bHQgaXMgdGhlIGZpcnN0IHRhYmxlXG4gICAgICAgICAgICByZXR1cm4gW1wiUGxhbnQgTmFtZVwiLCBcIlBsYW50IElkXCIsIFwiRS1QUlRSIG5hdGlvbmFsIElEXCIsIFwiQWRkcmVzcyAxXCIsIFwiQWRkcmVzcyAyXCIsIFwiQ2l0eVwiLCBcIlJlZ2lvblwiLCBcIlBvc3RhbCBjb2RlXCIsIFwiTG9uZ2l0dWRlXCIsIFwiTGF0aXR1ZGVcIiwgXCJGYWNpbGl0eSBuYW1lXCJdXG4gICAgICAgIH1cbiAgICB9XG5cdGFwcC5kaXJlY3RpdmUoJ3VpSGFuZHNvbnRhYmxlJywgZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4ge1xuXHRcdHJlc3RyaWN0OiAnQScsXG5cdFx0c2NvcGU6IHtcblx0XHRcdGRhdGE6ICc9JyxcbiAgICAgICAgICAgIHN0YXR1czogJz0nLFxuICAgICAgICAgICAgZm9ybW5hbWU6ICc9J1xuXHRcdH0sXG5cdFx0cmVwbGFjZTogdHJ1ZSxcblx0XHRsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHJzKSB7XG4gICAgICAgICAgICBzY29wZS4kd2F0Y2goJ3N0YXR1cycsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCd3YXRjaDonICsgbmV3VmFsdWUgKyAnOyBmb3JtPScgKyBzY29wZS5mb3JtbmFtZSk7XG4gICAgICAgICAgICAgICAgaWYobmV3VmFsdWUgPT0gdHJ1ZSAmJiBhbmd1bGFyLmlzQXJyYXkoc2NvcGUuZGF0YSkpe1xuICAgICAgICAgICAgICAgICAgICBlbGVtLmhhbmRzb250YWJsZSgnbG9hZERhdGEnLCBzY29wZS5kYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coc2NvcGUuZm9ybW5hbWUpO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBzY29wZS5kYXRhO1xuICAgICAgICAgICAgdmFyIGZvcm1uYW1lID0gc2NvcGUuZm9ybW5hbWU7XG4gICAgICAgICAgICB2YXIgY29udGFpbmVyID0gZWxlbTtcblxuXHRcdFx0ZWxlbS5oYW5kc29udGFibGUoe1xuXHRcdFx0ICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRNZW51OmZhbHNlLC8vIFsncm93X2Fib3ZlJywgJ3Jvd19iZWxvdycsICdyZW1vdmVfcm93J10sXG5cdFx0XHRcdHJvd0hlYWRlcnM6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNvbHVtblNvcnRpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHN0cmV0Y2hIOiAnYWxsJyxcbiAgICAgICAgICAgICAgICBmaXhlZENvbHVtbnNMZWZ0OiAyLFxuICAgICAgICAgICAgICAgIG1pblNwYXJlUm93czogMSwgLy8gZm9ybW5hbWUgPT09ICdMaXN0T2ZQbGFudHMnID8gMSA6IDAsXG4gICAgICAgICAgICAgICAgbWluU3BhcmVDb2xzOiAwLFxuICAgICAgICAgICAgICAgIC8vbWF4Um93czogZm9ybW5hbWUgPT09ICdMaXN0T2ZQbGFudHMnID8gMjAwIDogZGF0YS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgLy9tYXhDb2xzOiBkYXRhLm51bWJlck9mQ29sdW1ucyxcbiAgICAgICAgICAgICAgICBjb2xIZWFkZXJzOiBnZXRIYW5kc29udGFibGVDb2xIZWFkZXJzKGZvcm1uYW1lKSxcbiAgICAgICAgICAgICAgICBjb2x1bW5zOlxuICAgICAgICAgICAgICAgICAgICAgICAgKGZvcm1uYW1lID09PSAnTGlzdE9mUGxhbnRzJyA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJQbGFudE5hbWVcIn0sIHtkYXRhOiBcIlBsYW50SWRcIiwgcmVhZE9ubHk6IHRydWV9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJFUFJUUk5hdGlvbmFsSWRcIn0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIlBsYW50TG9jYXRpb24uU3RyZWV0TmFtZVwifSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJQbGFudExvY2F0aW9uLkNpdHlcIn0sIHtkYXRhOiBcIlBsYW50TG9jYXRpb24uUmVnaW9uXCJ9LCB7ZGF0YTogXCJQbGFudExvY2F0aW9uLlBvc3RhbENvZGVcIn0se2RhdGE6IFwiUGxhbnRMb2NhdGlvbi5Db3VudHJ5Q29kZVwifSx7ZGF0YTogXCJQbGFudExvY2F0aW9uLkJ1aWxkaW5nTnVtYmVyXCJ9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJHZW9ncmFwaGljYWxDb29yZGluYXRlLkxvbmdpdHVkZVwiLCB0eXBlOiAnbnVtZXJpYycsIGZvcm1hdDogJzAuWzAwMDAwXSd9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5MYXRpdHVkZVwiLCB0eXBlOiAnbnVtZXJpYycsIGZvcm1hdDogJzAuWzAwMDAwXSd9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJGYWNpbGl0eU5hbWVcIn0se2RhdGE6IFwiQ29tbWVudHNcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIDogZm9ybW5hbWUgPT0gJ1BsYW50RGV0YWlscycgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiUGxhbnROYW1lXCIsIHJlYWRPbmx5OiB0cnVlfSwge2RhdGE6IFwiUGxhbnRJZFwiLCByZWFkT25seTogdHJ1ZX0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIlBsYW50RGV0YWlscy5EYXRlT2ZTdGFydE9mT3BlcmF0aW9uXCJ9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJQbGFudERldGFpbHMuUmVmaW5lcmllc1wiLCB0eXBlOiAnY2hlY2tib3gnfSwge2RhdGE6IFwiUGxhbnREZXRhaWxzLk90aGVyU2VjdG9yXCIsIHR5cGU6ICdkcm9wZG93bicsIHNvdXJjZTogW3tpcm9uX3N0ZWVsOlwiaXJvbl9zdGVlbFwifSwgXCJlc2lcIiwgXCJkaXN0cmljdF9oZWF0aW5nXCIsIFwiY2hwXCIsIFwib3RoZXJcIl19LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJQbGFudERldGFpbHMuT3BlcmF0aW5nSG91cnNcIiwgdHlwZTogJ251bWVyaWMnfSwge2RhdGE6IFwiUGxhbnREZXRhaWxzLkNvbW1lbnRzXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgIDogZm9ybW5hbWUgPT0gJ0VuZXJneUlucHV0JyA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJQbGFudE5hbWVcIiwgcmVhZE9ubHk6IHRydWV9LCB7ZGF0YTogXCJQbGFudElkXCIsIHJlYWRPbmx5OiB0cnVlfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0LkJpb21hc3NcIiwgdHlwZTogJ251bWVyaWMnLCBmb3JtYXQ6ICcwLlswMDAwMF0nfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0LkNvYWxcIiwgdHlwZTogJ251bWVyaWMnLCBmb3JtYXQ6ICcwLlswMDAwMF0nfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0LkxpZ25pdGVcIiwgdHlwZTogJ251bWVyaWMnLCBmb3JtYXQ6ICcwLlswMDAwMF0nfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0LlBlYXRcIiwgdHlwZTogJ251bWVyaWMnLCBmb3JtYXQ6ICcwLlswMDAwMF0nfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk90aGVyU29saWRGdWVscy5DYXRlZ29yeVwifSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk90aGVyU29saWRGdWVscy5WYWx1ZVwiLCB0eXBlOiAnbnVtZXJpYycsIGZvcm1hdDogJzAuWzAwMDAwXSd9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJFbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuTGlxdWlkRnVlbHNcIiwgdHlwZTogJ251bWVyaWMnLCBmb3JtYXQ6ICcwLlswMDAwMF0nfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk5hdHVyYWxHYXNcIiwgdHlwZTogJ251bWVyaWMnLCBmb3JtYXQ6ICcwLlswMDAwMF0nfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk90aGVyR2FzZXMuQ2F0ZWdvcnlcIn0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5PdGhlckdhc2VzLlZhbHVlXCIsIHR5cGU6ICdudW1lcmljJywgZm9ybWF0OiAnMC5bMDAwMDBdJ30sXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIDogZm9ybW5hbWUgPT0gJ1RvdGFsRW1pc3Npb25zVG9BaXInID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIlBsYW50TmFtZVwiLCByZWFkT25seTogdHJ1ZX0sIHtkYXRhOiBcIlBsYW50SWRcIiwgcmVhZE9ubHk6IHRydWV9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJFbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuVG90YWxFbWlzc2lvbnNUb0Fpci5TTzJcIiwgdHlwZTogJ251bWVyaWMnLCBmb3JtYXQ6ICcwLlswMDAwMF0nfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLlRvdGFsRW1pc3Npb25zVG9BaXIuTk94XCIsIHR5cGU6ICdudW1lcmljJywgZm9ybWF0OiAnMC5bMDAwMDBdJ30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5Ub3RhbEVtaXNzaW9uc1RvQWlyLlRTUFwiLCB0eXBlOiAnbnVtZXJpYycsIGZvcm1hdDogJzAuWzAwMDAwXSd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICA6IGZvcm1uYW1lID09ICdEZXN1bHBodXJpc2F0aW9uJyA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIlBsYW50TmFtZVwiLCByZWFkT25seTogdHJ1ZX0sIHtkYXRhOiBcIlBsYW50SWRcIiwgcmVhZE9ubHk6IHRydWV9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJEZXN1bHBodXJpc2F0aW9uLkRlc3VscGh1cmlzYXRpb25SYXRlXCIsIHR5cGU6ICdudW1lcmljJywgZm9ybWF0OiAnMC5bMDAwMDBdJ30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIkRlc3VscGh1cmlzYXRpb24uU3VscGh1ckNvbnRlbnRcIiwgdHlwZTogJ251bWVyaWMnLCBmb3JtYXQ6ICcwLlswMDAwMF0nfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRGVzdWxwaHVyaXNhdGlvbi5UZWNobmljYWxKdXN0aWZpY2F0aW9uXCIgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgOiBmb3JtbmFtZSA9PSAnVXNlZnVsSGVhdCcgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiUGxhbnROYW1lXCIsIHJlYWRPbmx5OiB0cnVlfSwge2RhdGE6IFwiUGxhbnRJZFwiLCByZWFkT25seTogdHJ1ZX0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIlVzZWZ1bEhlYXQuVXNlZnVsSGVhdFByb3BvcnRpb25cIiwgdHlwZTogJ251bWVyaWMnLCBmb3JtYXQ6ICcwLlswMDAwMF0nfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIDpbXSksXG4gICAgICAgICAgICAgICAgICAgIG9uU2VsZWN0aW9uOiBmdW5jdGlvbiAocm93LCBjb2wsIHJvdzIsIGNvbDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXRhID0gY29udGFpbmVyLmhhbmRzb250YWJsZSgnZ2V0Q2VsbE1ldGEnLCByb3cyLCBjb2wyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZXRhLnJlYWRPbmx5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmhhbmRzb250YWJsZSgndXBkYXRlU2V0dGluZ3MnLCB7ZmlsbEhhbmRsZTogZmFsc2V9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5oYW5kc29udGFibGUoJ3VwZGF0ZVNldHRpbmdzJywge2ZpbGxIYW5kbGU6IHRydWV9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjZWxsczogZnVuY3Rpb24gKHJvdywgY29sLCBwcm9wKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjZWxsUHJvcGVydGllcyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZGl0aW9uYWxSZWFkb25seUZpZWxkcy5pbmRleE9mKHByb3ApID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIgPSBudW1lcmljQ29uZGl0aW9uYWxyZWFkT25seVJlbmRlcmVyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjZWxsUHJvcGVydGllcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblx0fVxufSk7XG4gICAgdmFyIGNvbmRpdGlvbmFsUmVhZG9ubHlGaWVsZHMgPSBbXCJQbGFudERldGFpbHMuQ2FwYWNpdHlBZGRlZE1XXCIsIFwiUGxhbnREZXRhaWxzLkNhcGFjaXR5QWZmZWN0ZWRNV1wiLCBcIlBsYW50RGV0YWlscy5PdGhlclNlY3RvclwiLCBcIlBsYW50RGV0YWlscy5HYXNUdXJiaW5lVGhlcm1hbElucHV0XCIsXG4gICAgICAgIFwiUGxhbnREZXRhaWxzLkJvaWxlclRoZXJtYWxJbnB1dFwiLCBcIlBsYW50RGV0YWlscy5HYXNFbmdpbmVUaGVybWFsSW5wdXRcIiwgXCJQbGFudERldGFpbHMuRGllc2VsRW5naW5lVHVyYmluZVRoZXJtYWxJbnB1dFwiLCBcIlBsYW50RGV0YWlscy5EaWVzZWxFbmdpbmVUdXJiaW5lVGhlcm1hbElucHV0XCIsXG4gICAgICAgIFwiUGxhbnREZXRhaWxzLk90aGVyVHlwZU9mQ29tYnVzdGlvblwiLCBcIlBsYW50RGV0YWlscy5PdGhlclRoZXJtYWxJbnB1dFwiLFxuICAgICAgICBcIk9wdE91dHNBbmRORVJQLkNhcGFjaXR5T3B0ZWRPdXRNV1wiLCBcIk9wdE91dHNBbmRORVJQLkhvdXJzT3BlcmF0ZWRcIixcbiAgICAgICAgXCJMY3BBcnQxNS5PcGVyYXRpbmdIb3Vyc1wiLCBcIkxjcEFydDE1LkVsdlNPMlwiLFxuICAgICAgICBcIkxjcEFydDE1Lk5vdGFCZW5lRWx2U08yXCIsIFwiTGNwQXJ0MTUuRGVzdWxwaHVyaXNhdGlvblJhdGVcIiwgXCJMY3BBcnQxNS5TSW5wdXRcIixcbiAgICAgICAgXCJMY3BBcnQxNS5Bbm5leFZJX0FfRm9vdG5vdGUyX09wZXJhdGluZ0hvdXJzXCIsIFwiTGNwQXJ0MTUuRWx2Tk94XCIsXG4gICAgICAgIFwiTGNwQXJ0MTUuVm9sYXRpbGVDb250ZW50c1wiLCBcIkxjcEFydDE1LkFubmV4VklfQV9Gb290bm90ZTNfRWx2Tk94XCJdXG4gICAgZnVuY3Rpb24gbnVtZXJpY0NvbmRpdGlvbmFscmVhZE9ubHlSZW5kZXJlcihpbnN0YW5jZSwgdGQsIHJvdywgY29sLCBwcm9wLCB2YWx1ZSwgY2VsbFByb3BlcnRpZXMpIHtcblxuICAgICAgICBpZiAocHJvcCA9PT0gXCJQbGFudERldGFpbHMuT3RoZXJUeXBlT2ZDb21idXN0aW9uXCIpIHtcbiAgICAgICAgICAgIEhhbmRzb250YWJsZS5yZW5kZXJlcnMuVGV4dFJlbmRlcmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocHJvcCA9PT0gXCJQbGFudERldGFpbHMuT3RoZXJTZWN0b3JcIikge1xuICAgICAgICAgICAgSGFuZHNvbnRhYmxlLnJlbmRlcmVycy5BdXRvY29tcGxldGVSZW5kZXJlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgSGFuZHNvbnRhYmxlLnJlbmRlcmVycy5OdW1lcmljUmVuZGVyZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29sSW5kZXggPSAoXG4gICAgICAgICAgICAgICAgKHByb3AgPT09IFwiUGxhbnREZXRhaWxzLk90aGVyVGhlcm1hbElucHV0XCIgfHwgcHJvcCA9PT0gIFwiT3B0T3V0c0FuZE5FUlAuSG91cnNPcGVyYXRlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IHByb3AgPT09IFwiTGNwQXJ0MTUuRWx2U08yXCIgfHwgcHJvcCA9PT0gIFwiTGNwQXJ0MTUuRGVzdWxwaHVyaXNhdGlvblJhdGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBwcm9wID09PSBcIkxjcEFydDE1LkVsdk5PeFwiIHx8IHByb3AgPT09ICBcIkxjcEFydDE1LkFubmV4VklfQV9Gb290bm90ZTNfRWx2Tk94XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gY29sIC0gMiA6IChwcm9wID09PSBcIkxjcEFydDE1LlNJbnB1dFwiKSA/IGNvbCAtIDMgOiBjb2wgLSAxKTtcbiAgICAgICAgdmFyIGJvb2xlYW5WYWx1ZSA9IHByb3AgPT09IFwiUGxhbnREZXRhaWxzLk90aGVyU2VjdG9yXCIgPyBmYWxzZSA6IHRydWU7XG4gICAgICAgIHZhciBjaGVja2JveFZhbHVlID0gaW5zdGFuY2UuZ2V0RGF0YUF0Q2VsbChyb3csIGNvbEluZGV4KSA9PT0gbnVsbCB8fCBpbnN0YW5jZS5nZXREYXRhQXRDZWxsKHJvdywgY29sSW5kZXgpID09PSAnJyA/IGZhbHNlIDogaW5zdGFuY2UuZ2V0RGF0YUF0Q2VsbChyb3csIGNvbEluZGV4KTtcbiAgICAgICAgaWYgKGNoZWNrYm94VmFsdWUgIT0gYm9vbGVhblZhbHVlICkge1xuICAgICAgICAgICAgY2VsbFByb3BlcnRpZXMucmVhZE9ubHkgPSB0cnVlO1xuICAgICAgICAgICAgdGQuc3R5bGUuYmFja2dyb3VuZCA9ICcjRUVFJztcbiAgICAgICAgfVxuICAgIH1cbiIsIi8qXG4gKiBhbmd1bGFyLWVsYXN0aWMgdjIuMy4zXG4gKiAoYykgMjAxNCBNb25vc3BhY2VkIGh0dHA6Ly9tb25vc3BhY2VkLmNvbVxuICogTGljZW5zZTogTUlUXG4gKi9cblxuYW5ndWxhci5tb2R1bGUoJ21vbm9zcGFjZWQuZWxhc3RpYycsIFtdKVxuXG4gIC5jb25zdGFudCgnbXNkRWxhc3RpY0NvbmZpZycsIHtcbiAgICBhcHBlbmQ6ICcnXG4gIH0pXG5cbiAgLmRpcmVjdGl2ZSgnbXNkRWxhc3RpYycsIFsnJHRpbWVvdXQnLCAnJHdpbmRvdycsICdtc2RFbGFzdGljQ29uZmlnJywgZnVuY3Rpb24oJHRpbWVvdXQsICR3aW5kb3csIGNvbmZpZykge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHJldHVybiB7XG4gICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgICByZXN0cmljdDogJ0EsIEMnLFxuICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBuZ01vZGVsKSB7XG5cbiAgICAgICAgLy8gY2FjaGUgYSByZWZlcmVuY2UgdG8gdGhlIERPTSBlbGVtZW50XG4gICAgICAgIHZhciB0YSA9IGVsZW1lbnRbMF0sXG4gICAgICAgICAgICAkdGEgPSBlbGVtZW50O1xuXG4gICAgICAgIC8vIGVuc3VyZSB0aGUgZWxlbWVudCBpcyBhIHRleHRhcmVhLCBhbmQgYnJvd3NlciBpcyBjYXBhYmxlXG4gICAgICAgIGlmICh0YS5ub2RlTmFtZSAhPT0gJ1RFWFRBUkVBJyB8fCAhJHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gc2V0IHRoZXNlIHByb3BlcnRpZXMgYmVmb3JlIG1lYXN1cmluZyBkaW1lbnNpb25zXG4gICAgICAgICR0YS5jc3Moe1xuICAgICAgICAgICdvdmVyZmxvdyc6ICdoaWRkZW4nLFxuICAgICAgICAgICdvdmVyZmxvdy15JzogJ2hpZGRlbicsXG4gICAgICAgICAgJ3dvcmQtd3JhcCc6ICdicmVhay13b3JkJ1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBmb3JjZSB0ZXh0IHJlZmxvd1xuICAgICAgICB2YXIgdGV4dCA9IHRhLnZhbHVlO1xuICAgICAgICB0YS52YWx1ZSA9ICcnO1xuICAgICAgICB0YS52YWx1ZSA9IHRleHQ7XG5cbiAgICAgICAgdmFyIGFwcGVuZFRleHQgPSBhdHRycy5tc2RFbGFzdGljIHx8IGNvbmZpZy5hcHBlbmQsXG4gICAgICAgICAgICBhcHBlbmQgPSBhcHBlbmRUZXh0ID09PSAnXFxcXG4nID8gJ1xcbicgOiBhcHBlbmRUZXh0LFxuICAgICAgICAgICAgJHdpbiA9IGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KSxcbiAgICAgICAgICAgIG1pcnJvclN0eWxlID0gJ3Bvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAtOTk5cHg7IHJpZ2h0OiBhdXRvOyBib3R0b206IGF1dG87IGxlZnQ6IDAgOycgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnb3ZlcmZsb3c6IGhpZGRlbjsgLXdlYmtpdC1ib3gtc2l6aW5nOiBjb250ZW50LWJveDsnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJy1tb3otYm94LXNpemluZzogY29udGVudC1ib3g7IGJveC1zaXppbmc6IGNvbnRlbnQtYm94OycgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnbWluLWhlaWdodDogMCAhaW1wb3J0YW50OyBoZWlnaHQ6IDAgIWltcG9ydGFudDsgcGFkZGluZzogMDsnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ3dvcmQtd3JhcDogYnJlYWstd29yZDsgYm9yZGVyOiAwOycsXG4gICAgICAgICAgICAkbWlycm9yID0gYW5ndWxhci5lbGVtZW50KCc8dGV4dGFyZWEgdGFiaW5kZXg9XCItMVwiICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc3R5bGU9XCInICsgbWlycm9yU3R5bGUgKyAnXCIvPicpLmRhdGEoJ2VsYXN0aWMnLCB0cnVlKSxcbiAgICAgICAgICAgIG1pcnJvciA9ICRtaXJyb3JbMF0sXG4gICAgICAgICAgICB0YVN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZSh0YSksXG4gICAgICAgICAgICByZXNpemUgPSB0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3Jlc2l6ZScpLFxuICAgICAgICAgICAgYm9yZGVyQm94ID0gdGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdib3gtc2l6aW5nJykgPT09ICdib3JkZXItYm94JyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctbW96LWJveC1zaXppbmcnKSA9PT0gJ2JvcmRlci1ib3gnIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICB0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy13ZWJraXQtYm94LXNpemluZycpID09PSAnYm9yZGVyLWJveCcsXG4gICAgICAgICAgICBib3hPdXRlciA9ICFib3JkZXJCb3ggPyB7d2lkdGg6IDAsIGhlaWdodDogMH0gOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAgcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdib3JkZXItcmlnaHQtd2lkdGgnKSwgMTApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctcmlnaHQnKSwgMTApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctbGVmdCcpLCAxMCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnYm9yZGVyLWxlZnQtd2lkdGgnKSwgMTApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnYm9yZGVyLXRvcC13aWR0aCcpLCAxMCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy10b3AnKSwgMTApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctYm90dG9tJyksIDEwKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdib3JkZXItYm90dG9tLXdpZHRoJyksIDEwKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG1pbkhlaWdodFZhbHVlID0gcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdtaW4taGVpZ2h0JyksIDEwKSxcbiAgICAgICAgICAgIGhlaWdodFZhbHVlID0gcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdoZWlnaHQnKSwgMTApLFxuICAgICAgICAgICAgbWluSGVpZ2h0ID0gTWF0aC5tYXgobWluSGVpZ2h0VmFsdWUsIGhlaWdodFZhbHVlKSAtIGJveE91dGVyLmhlaWdodCxcbiAgICAgICAgICAgIG1heEhlaWdodCA9IHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnbWF4LWhlaWdodCcpLCAxMCksXG4gICAgICAgICAgICBtaXJyb3JlZCxcbiAgICAgICAgICAgIGFjdGl2ZSxcbiAgICAgICAgICAgIGNvcHlTdHlsZSA9IFsnZm9udC1mYW1pbHknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICdmb250LXNpemUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICdmb250LXdlaWdodCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgJ2ZvbnQtc3R5bGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICdsZXR0ZXItc3BhY2luZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgJ2xpbmUtaGVpZ2h0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAndGV4dC10cmFuc2Zvcm0nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICd3b3JkLXNwYWNpbmcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICd0ZXh0LWluZGVudCddO1xuXG4gICAgICAgIC8vIGV4aXQgaWYgZWxhc3RpYyBhbHJlYWR5IGFwcGxpZWQgKG9yIGlzIHRoZSBtaXJyb3IgZWxlbWVudClcbiAgICAgICAgaWYgKCR0YS5kYXRhKCdlbGFzdGljJykpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBPcGVyYSByZXR1cm5zIG1heC1oZWlnaHQgb2YgLTEgaWYgbm90IHNldFxuICAgICAgICBtYXhIZWlnaHQgPSBtYXhIZWlnaHQgJiYgbWF4SGVpZ2h0ID4gMCA/IG1heEhlaWdodCA6IDllNDtcblxuICAgICAgICAvLyBhcHBlbmQgbWlycm9yIHRvIHRoZSBET01cbiAgICAgICAgaWYgKG1pcnJvci5wYXJlbnROb2RlICE9PSBkb2N1bWVudC5ib2R5KSB7XG4gICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLmFwcGVuZChtaXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gc2V0IHJlc2l6ZSBhbmQgYXBwbHkgZWxhc3RpY1xuICAgICAgICAkdGEuY3NzKHtcbiAgICAgICAgICAncmVzaXplJzogKHJlc2l6ZSA9PT0gJ25vbmUnIHx8IHJlc2l6ZSA9PT0gJ3ZlcnRpY2FsJykgPyAnbm9uZScgOiAnaG9yaXpvbnRhbCdcbiAgICAgICAgfSkuZGF0YSgnZWxhc3RpYycsIHRydWUpO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIG1ldGhvZHNcbiAgICAgICAgICovXG5cbiAgICAgICAgZnVuY3Rpb24gaW5pdE1pcnJvcigpIHtcbiAgICAgICAgICBtaXJyb3JlZCA9IHRhO1xuICAgICAgICAgIC8vIGNvcHkgdGhlIGVzc2VudGlhbCBzdHlsZXMgZnJvbSB0aGUgdGV4dGFyZWEgdG8gdGhlIG1pcnJvclxuICAgICAgICAgIHRhU3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKHRhKTtcbiAgICAgICAgICBhbmd1bGFyLmZvckVhY2goY29weVN0eWxlLCBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICAgIG1pcnJvclN0eWxlICs9IHZhbCArICc6JyArIHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSh2YWwpICsgJzsnO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIG1pcnJvci5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgbWlycm9yU3R5bGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYWRqdXN0KCkge1xuICAgICAgICAgIHZhciB0YUhlaWdodCxcbiAgICAgICAgICAgICAgbWlycm9ySGVpZ2h0LFxuICAgICAgICAgICAgICB3aWR0aCxcbiAgICAgICAgICAgICAgb3ZlcmZsb3c7XG5cbiAgICAgICAgICBpZiAobWlycm9yZWQgIT09IHRhKSB7XG4gICAgICAgICAgICBpbml0TWlycm9yKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gYWN0aXZlIGZsYWcgcHJldmVudHMgYWN0aW9ucyBpbiBmdW5jdGlvbiBmcm9tIGNhbGxpbmcgYWRqdXN0IGFnYWluXG4gICAgICAgICAgaWYgKCFhY3RpdmUpIHtcbiAgICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgICAgIG1pcnJvci52YWx1ZSA9IHRhLnZhbHVlICsgYXBwZW5kOyAvLyBvcHRpb25hbCB3aGl0ZXNwYWNlIHRvIGltcHJvdmUgYW5pbWF0aW9uXG4gICAgICAgICAgICBtaXJyb3Iuc3R5bGUub3ZlcmZsb3dZID0gdGEuc3R5bGUub3ZlcmZsb3dZO1xuXG4gICAgICAgICAgICB0YUhlaWdodCA9IHRhLnN0eWxlLmhlaWdodCA9PT0gJycgPyAnYXV0bycgOiBwYXJzZUludCh0YS5zdHlsZS5oZWlnaHQsIDEwKTtcblxuICAgICAgICAgICAgLy8gdXBkYXRlIG1pcnJvciB3aWR0aCBpbiBjYXNlIHRoZSB0ZXh0YXJlYSB3aWR0aCBoYXMgY2hhbmdlZFxuICAgICAgICAgICAgd2lkdGggPSBwYXJzZUludChnZXRDb21wdXRlZFN0eWxlKHRhKS5nZXRQcm9wZXJ0eVZhbHVlKCd3aWR0aCcpLCAxMCkgLSBib3hPdXRlci53aWR0aDtcbiAgICAgICAgICAgIG1pcnJvci5zdHlsZS53aWR0aCA9IHdpZHRoICsgJ3B4JztcblxuICAgICAgICAgICAgbWlycm9ySGVpZ2h0ID0gbWlycm9yLnNjcm9sbEhlaWdodDtcblxuICAgICAgICAgICAgaWYgKG1pcnJvckhlaWdodCA+IG1heEhlaWdodCkge1xuICAgICAgICAgICAgICBtaXJyb3JIZWlnaHQgPSBtYXhIZWlnaHQ7XG4gICAgICAgICAgICAgIG92ZXJmbG93ID0gJ3Njcm9sbCc7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1pcnJvckhlaWdodCA8IG1pbkhlaWdodCkge1xuICAgICAgICAgICAgICBtaXJyb3JIZWlnaHQgPSBtaW5IZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtaXJyb3JIZWlnaHQgKz0gYm94T3V0ZXIuaGVpZ2h0O1xuXG4gICAgICAgICAgICB0YS5zdHlsZS5vdmVyZmxvd1kgPSBvdmVyZmxvdyB8fCAnaGlkZGVuJztcblxuICAgICAgICAgICAgaWYgKHRhSGVpZ2h0ICE9PSBtaXJyb3JIZWlnaHQpIHtcbiAgICAgICAgICAgICAgdGEuc3R5bGUuaGVpZ2h0ID0gbWlycm9ySGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ2VsYXN0aWM6cmVzaXplJywgJHRhKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gc21hbGwgZGVsYXkgdG8gcHJldmVudCBhbiBpbmZpbml0ZSBsb29wXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9LCAxKTtcblxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGZvcmNlQWRqdXN0KCkge1xuICAgICAgICAgIGFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgIGFkanVzdCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICogaW5pdGlhbGlzZVxuICAgICAgICAgKi9cblxuICAgICAgICAvLyBsaXN0ZW5cbiAgICAgICAgaWYgKCdvbnByb3BlcnR5Y2hhbmdlJyBpbiB0YSAmJiAnb25pbnB1dCcgaW4gdGEpIHtcbiAgICAgICAgICAvLyBJRTlcbiAgICAgICAgICB0YVsnb25pbnB1dCddID0gdGEub25rZXl1cCA9IGFkanVzdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0YVsnb25pbnB1dCddID0gYWRqdXN0O1xuICAgICAgICB9XG5cbiAgICAgICAgJHdpbi5iaW5kKCdyZXNpemUnLCBmb3JjZUFkanVzdCk7XG5cbiAgICAgICAgc2NvcGUuJHdhdGNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBuZ01vZGVsLiRtb2RlbFZhbHVlO1xuICAgICAgICB9LCBmdW5jdGlvbihuZXdWYWx1ZSkge1xuICAgICAgICAgIGZvcmNlQWRqdXN0KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNjb3BlLiRvbignZWxhc3RpYzphZGp1c3QnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBmb3JjZUFkanVzdCgpO1xuICAgICAgICB9KTtcblxuICAgICAgICAkdGltZW91dChhZGp1c3QpO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGRlc3Ryb3lcbiAgICAgICAgICovXG5cbiAgICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRtaXJyb3IucmVtb3ZlKCk7XG4gICAgICAgICAgJHdpbi51bmJpbmQoJ3Jlc2l6ZScsIGZvcmNlQWRqdXN0KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcblxuICB9XSk7XG4iLCIvKlxuIEFuZ3VsYXJKUyB2MS4yLjE2XG4gKGMpIDIwMTAtMjAxNCBHb29nbGUsIEluYy4gaHR0cDovL2FuZ3VsYXJqcy5vcmdcbiBMaWNlbnNlOiBNSVRcbiovXG4oZnVuY3Rpb24oTyxVLHMpeyd1c2Ugc3RyaWN0JztmdW5jdGlvbiB0KGIpe3JldHVybiBmdW5jdGlvbigpe3ZhciBhPWFyZ3VtZW50c1swXSxjLGE9XCJbXCIrKGI/YitcIjpcIjpcIlwiKSthK1wiXSBodHRwOi8vZXJyb3JzLmFuZ3VsYXJqcy5vcmcvMS4yLjE2L1wiKyhiP2IrXCIvXCI6XCJcIikrYTtmb3IoYz0xO2M8YXJndW1lbnRzLmxlbmd0aDtjKyspYT1hKygxPT1jP1wiP1wiOlwiJlwiKStcInBcIisoYy0xKStcIj1cIitlbmNvZGVVUklDb21wb25lbnQoXCJmdW5jdGlvblwiPT10eXBlb2YgYXJndW1lbnRzW2NdP2FyZ3VtZW50c1tjXS50b1N0cmluZygpLnJlcGxhY2UoLyBcXHtbXFxzXFxTXSokLyxcIlwiKTpcInVuZGVmaW5lZFwiPT10eXBlb2YgYXJndW1lbnRzW2NdP1widW5kZWZpbmVkXCI6XCJzdHJpbmdcIiE9dHlwZW9mIGFyZ3VtZW50c1tjXT9KU09OLnN0cmluZ2lmeShhcmd1bWVudHNbY10pOmFyZ3VtZW50c1tjXSk7cmV0dXJuIEVycm9yKGEpfX1mdW5jdGlvbiBhYihiKXtpZihudWxsPT1ifHxDYShiKSlyZXR1cm4hMTtcbnZhciBhPWIubGVuZ3RoO3JldHVybiAxPT09Yi5ub2RlVHlwZSYmYT8hMDp3KGIpfHxNKGIpfHwwPT09YXx8XCJudW1iZXJcIj09PXR5cGVvZiBhJiYwPGEmJmEtMSBpbiBifWZ1bmN0aW9uIHEoYixhLGMpe3ZhciBkO2lmKGIpaWYoUChiKSlmb3IoZCBpbiBiKVwicHJvdG90eXBlXCI9PWR8fChcImxlbmd0aFwiPT1kfHxcIm5hbWVcIj09ZHx8Yi5oYXNPd25Qcm9wZXJ0eSYmIWIuaGFzT3duUHJvcGVydHkoZCkpfHxhLmNhbGwoYyxiW2RdLGQpO2Vsc2UgaWYoYi5mb3JFYWNoJiZiLmZvckVhY2ghPT1xKWIuZm9yRWFjaChhLGMpO2Vsc2UgaWYoYWIoYikpZm9yKGQ9MDtkPGIubGVuZ3RoO2QrKylhLmNhbGwoYyxiW2RdLGQpO2Vsc2UgZm9yKGQgaW4gYiliLmhhc093blByb3BlcnR5KGQpJiZhLmNhbGwoYyxiW2RdLGQpO3JldHVybiBifWZ1bmN0aW9uIFFiKGIpe3ZhciBhPVtdLGM7Zm9yKGMgaW4gYiliLmhhc093blByb3BlcnR5KGMpJiZhLnB1c2goYyk7cmV0dXJuIGEuc29ydCgpfWZ1bmN0aW9uIFNjKGIsXG5hLGMpe2Zvcih2YXIgZD1RYihiKSxlPTA7ZTxkLmxlbmd0aDtlKyspYS5jYWxsKGMsYltkW2VdXSxkW2VdKTtyZXR1cm4gZH1mdW5jdGlvbiBSYihiKXtyZXR1cm4gZnVuY3Rpb24oYSxjKXtiKGMsYSl9fWZ1bmN0aW9uIGJiKCl7Zm9yKHZhciBiPWthLmxlbmd0aCxhO2I7KXtiLS07YT1rYVtiXS5jaGFyQ29kZUF0KDApO2lmKDU3PT1hKXJldHVybiBrYVtiXT1cIkFcIixrYS5qb2luKFwiXCIpO2lmKDkwPT1hKWthW2JdPVwiMFwiO2Vsc2UgcmV0dXJuIGthW2JdPVN0cmluZy5mcm9tQ2hhckNvZGUoYSsxKSxrYS5qb2luKFwiXCIpfWthLnVuc2hpZnQoXCIwXCIpO3JldHVybiBrYS5qb2luKFwiXCIpfWZ1bmN0aW9uIFNiKGIsYSl7YT9iLiQkaGFzaEtleT1hOmRlbGV0ZSBiLiQkaGFzaEtleX1mdW5jdGlvbiBEKGIpe3ZhciBhPWIuJCRoYXNoS2V5O3EoYXJndW1lbnRzLGZ1bmN0aW9uKGEpe2EhPT1iJiZxKGEsZnVuY3Rpb24oYSxjKXtiW2NdPWF9KX0pO1NiKGIsYSk7cmV0dXJuIGJ9ZnVuY3Rpb24gWShiKXtyZXR1cm4gcGFyc2VJbnQoYixcbjEwKX1mdW5jdGlvbiBUYihiLGEpe3JldHVybiBEKG5ldyAoRChmdW5jdGlvbigpe30se3Byb3RvdHlwZTpifSkpLGEpfWZ1bmN0aW9uIEMoKXt9ZnVuY3Rpb24gRGEoYil7cmV0dXJuIGJ9ZnVuY3Rpb24gYWEoYil7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGJ9fWZ1bmN0aW9uIEUoYil7cmV0dXJuXCJ1bmRlZmluZWRcIj09PXR5cGVvZiBifWZ1bmN0aW9uIEIoYil7cmV0dXJuXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBifWZ1bmN0aW9uIFgoYil7cmV0dXJuIG51bGwhPWImJlwib2JqZWN0XCI9PT10eXBlb2YgYn1mdW5jdGlvbiB3KGIpe3JldHVyblwic3RyaW5nXCI9PT10eXBlb2YgYn1mdW5jdGlvbiB2YihiKXtyZXR1cm5cIm51bWJlclwiPT09dHlwZW9mIGJ9ZnVuY3Rpb24gTmEoYil7cmV0dXJuXCJbb2JqZWN0IERhdGVdXCI9PT13YS5jYWxsKGIpfWZ1bmN0aW9uIE0oYil7cmV0dXJuXCJbb2JqZWN0IEFycmF5XVwiPT09d2EuY2FsbChiKX1mdW5jdGlvbiBQKGIpe3JldHVyblwiZnVuY3Rpb25cIj09PXR5cGVvZiBifVxuZnVuY3Rpb24gY2IoYil7cmV0dXJuXCJbb2JqZWN0IFJlZ0V4cF1cIj09PXdhLmNhbGwoYil9ZnVuY3Rpb24gQ2EoYil7cmV0dXJuIGImJmIuZG9jdW1lbnQmJmIubG9jYXRpb24mJmIuYWxlcnQmJmIuc2V0SW50ZXJ2YWx9ZnVuY3Rpb24gVGMoYil7cmV0dXJuISghYnx8IShiLm5vZGVOYW1lfHxiLnByb3AmJmIuYXR0ciYmYi5maW5kKSl9ZnVuY3Rpb24gVWMoYixhLGMpe3ZhciBkPVtdO3EoYixmdW5jdGlvbihiLGcsZil7ZC5wdXNoKGEuY2FsbChjLGIsZyxmKSl9KTtyZXR1cm4gZH1mdW5jdGlvbiBkYihiLGEpe2lmKGIuaW5kZXhPZilyZXR1cm4gYi5pbmRleE9mKGEpO2Zvcih2YXIgYz0wO2M8Yi5sZW5ndGg7YysrKWlmKGE9PT1iW2NdKXJldHVybiBjO3JldHVybi0xfWZ1bmN0aW9uIE9hKGIsYSl7dmFyIGM9ZGIoYixhKTswPD1jJiZiLnNwbGljZShjLDEpO3JldHVybiBhfWZ1bmN0aW9uIGJhKGIsYSl7aWYoQ2EoYil8fGImJmIuJGV2YWxBc3luYyYmYi4kd2F0Y2gpdGhyb3cgUGEoXCJjcHdzXCIpO1xuaWYoYSl7aWYoYj09PWEpdGhyb3cgUGEoXCJjcGlcIik7aWYoTShiKSlmb3IodmFyIGM9YS5sZW5ndGg9MDtjPGIubGVuZ3RoO2MrKylhLnB1c2goYmEoYltjXSkpO2Vsc2V7Yz1hLiQkaGFzaEtleTtxKGEsZnVuY3Rpb24oYixjKXtkZWxldGUgYVtjXX0pO2Zvcih2YXIgZCBpbiBiKWFbZF09YmEoYltkXSk7U2IoYSxjKX19ZWxzZShhPWIpJiYoTShiKT9hPWJhKGIsW10pOk5hKGIpP2E9bmV3IERhdGUoYi5nZXRUaW1lKCkpOmNiKGIpP2E9UmVnRXhwKGIuc291cmNlKTpYKGIpJiYoYT1iYShiLHt9KSkpO3JldHVybiBhfWZ1bmN0aW9uIFViKGIsYSl7YT1hfHx7fTtmb3IodmFyIGMgaW4gYikhYi5oYXNPd25Qcm9wZXJ0eShjKXx8XCIkXCI9PT1jLmNoYXJBdCgwKSYmXCIkXCI9PT1jLmNoYXJBdCgxKXx8KGFbY109YltjXSk7cmV0dXJuIGF9ZnVuY3Rpb24geGEoYixhKXtpZihiPT09YSlyZXR1cm4hMDtpZihudWxsPT09Ynx8bnVsbD09PWEpcmV0dXJuITE7aWYoYiE9PWImJmEhPT1hKXJldHVybiEwO1xudmFyIGM9dHlwZW9mIGIsZDtpZihjPT10eXBlb2YgYSYmXCJvYmplY3RcIj09YylpZihNKGIpKXtpZighTShhKSlyZXR1cm4hMTtpZigoYz1iLmxlbmd0aCk9PWEubGVuZ3RoKXtmb3IoZD0wO2Q8YztkKyspaWYoIXhhKGJbZF0sYVtkXSkpcmV0dXJuITE7cmV0dXJuITB9fWVsc2V7aWYoTmEoYikpcmV0dXJuIE5hKGEpJiZiLmdldFRpbWUoKT09YS5nZXRUaW1lKCk7aWYoY2IoYikmJmNiKGEpKXJldHVybiBiLnRvU3RyaW5nKCk9PWEudG9TdHJpbmcoKTtpZihiJiZiLiRldmFsQXN5bmMmJmIuJHdhdGNofHxhJiZhLiRldmFsQXN5bmMmJmEuJHdhdGNofHxDYShiKXx8Q2EoYSl8fE0oYSkpcmV0dXJuITE7Yz17fTtmb3IoZCBpbiBiKWlmKFwiJFwiIT09ZC5jaGFyQXQoMCkmJiFQKGJbZF0pKXtpZigheGEoYltkXSxhW2RdKSlyZXR1cm4hMTtjW2RdPSEwfWZvcihkIGluIGEpaWYoIWMuaGFzT3duUHJvcGVydHkoZCkmJlwiJFwiIT09ZC5jaGFyQXQoMCkmJmFbZF0hPT1zJiYhUChhW2RdKSlyZXR1cm4hMTtcbnJldHVybiEwfXJldHVybiExfWZ1bmN0aW9uIFZiKCl7cmV0dXJuIFUuc2VjdXJpdHlQb2xpY3kmJlUuc2VjdXJpdHlQb2xpY3kuaXNBY3RpdmV8fFUucXVlcnlTZWxlY3RvciYmISghVS5xdWVyeVNlbGVjdG9yKFwiW25nLWNzcF1cIikmJiFVLnF1ZXJ5U2VsZWN0b3IoXCJbZGF0YS1uZy1jc3BdXCIpKX1mdW5jdGlvbiBlYihiLGEpe3ZhciBjPTI8YXJndW1lbnRzLmxlbmd0aD95YS5jYWxsKGFyZ3VtZW50cywyKTpbXTtyZXR1cm4hUChhKXx8YSBpbnN0YW5jZW9mIFJlZ0V4cD9hOmMubGVuZ3RoP2Z1bmN0aW9uKCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/YS5hcHBseShiLGMuY29uY2F0KHlhLmNhbGwoYXJndW1lbnRzLDApKSk6YS5hcHBseShiLGMpfTpmdW5jdGlvbigpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoP2EuYXBwbHkoYixhcmd1bWVudHMpOmEuY2FsbChiKX19ZnVuY3Rpb24gVmMoYixhKXt2YXIgYz1hO1wic3RyaW5nXCI9PT10eXBlb2YgYiYmXCIkXCI9PT1iLmNoYXJBdCgwKT9jPVxuczpDYShhKT9jPVwiJFdJTkRPV1wiOmEmJlU9PT1hP2M9XCIkRE9DVU1FTlRcIjphJiYoYS4kZXZhbEFzeW5jJiZhLiR3YXRjaCkmJihjPVwiJFNDT1BFXCIpO3JldHVybiBjfWZ1bmN0aW9uIHFhKGIsYSl7cmV0dXJuXCJ1bmRlZmluZWRcIj09PXR5cGVvZiBiP3M6SlNPTi5zdHJpbmdpZnkoYixWYyxhP1wiICBcIjpudWxsKX1mdW5jdGlvbiBXYihiKXtyZXR1cm4gdyhiKT9KU09OLnBhcnNlKGIpOmJ9ZnVuY3Rpb24gUWEoYil7XCJmdW5jdGlvblwiPT09dHlwZW9mIGI/Yj0hMDpiJiYwIT09Yi5sZW5ndGg/KGI9SyhcIlwiK2IpLGI9IShcImZcIj09Ynx8XCIwXCI9PWJ8fFwiZmFsc2VcIj09Ynx8XCJub1wiPT1ifHxcIm5cIj09Ynx8XCJbXVwiPT1iKSk6Yj0hMTtyZXR1cm4gYn1mdW5jdGlvbiBoYShiKXtiPXkoYikuY2xvbmUoKTt0cnl7Yi5lbXB0eSgpfWNhdGNoKGEpe312YXIgYz15KFwiPGRpdj5cIikuYXBwZW5kKGIpLmh0bWwoKTt0cnl7cmV0dXJuIDM9PT1iWzBdLm5vZGVUeXBlP0soYyk6Yy5tYXRjaCgvXig8W14+XSs+KS8pWzFdLnJlcGxhY2UoL148KFtcXHdcXC1dKykvLFxuZnVuY3Rpb24oYSxiKXtyZXR1cm5cIjxcIitLKGIpfSl9Y2F0Y2goZCl7cmV0dXJuIEsoYyl9fWZ1bmN0aW9uIFhiKGIpe3RyeXtyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGIpfWNhdGNoKGEpe319ZnVuY3Rpb24gWWIoYil7dmFyIGE9e30sYyxkO3EoKGJ8fFwiXCIpLnNwbGl0KFwiJlwiKSxmdW5jdGlvbihiKXtiJiYoYz1iLnNwbGl0KFwiPVwiKSxkPVhiKGNbMF0pLEIoZCkmJihiPUIoY1sxXSk/WGIoY1sxXSk6ITAsYVtkXT9NKGFbZF0pP2FbZF0ucHVzaChiKTphW2RdPVthW2RdLGJdOmFbZF09YikpfSk7cmV0dXJuIGF9ZnVuY3Rpb24gWmIoYil7dmFyIGE9W107cShiLGZ1bmN0aW9uKGIsZCl7TShiKT9xKGIsZnVuY3Rpb24oYil7YS5wdXNoKHphKGQsITApKyghMD09PWI/XCJcIjpcIj1cIit6YShiLCEwKSkpfSk6YS5wdXNoKHphKGQsITApKyghMD09PWI/XCJcIjpcIj1cIit6YShiLCEwKSkpfSk7cmV0dXJuIGEubGVuZ3RoP2Euam9pbihcIiZcIik6XCJcIn1mdW5jdGlvbiB3YihiKXtyZXR1cm4gemEoYixcbiEwKS5yZXBsYWNlKC8lMjYvZ2ksXCImXCIpLnJlcGxhY2UoLyUzRC9naSxcIj1cIikucmVwbGFjZSgvJTJCL2dpLFwiK1wiKX1mdW5jdGlvbiB6YShiLGEpe3JldHVybiBlbmNvZGVVUklDb21wb25lbnQoYikucmVwbGFjZSgvJTQwL2dpLFwiQFwiKS5yZXBsYWNlKC8lM0EvZ2ksXCI6XCIpLnJlcGxhY2UoLyUyNC9nLFwiJFwiKS5yZXBsYWNlKC8lMkMvZ2ksXCIsXCIpLnJlcGxhY2UoLyUyMC9nLGE/XCIlMjBcIjpcIitcIil9ZnVuY3Rpb24gV2MoYixhKXtmdW5jdGlvbiBjKGEpe2EmJmQucHVzaChhKX12YXIgZD1bYl0sZSxnLGY9W1wibmc6YXBwXCIsXCJuZy1hcHBcIixcIngtbmctYXBwXCIsXCJkYXRhLW5nLWFwcFwiXSxoPS9cXHNuZ1s6XFwtXWFwcCg6XFxzKihbXFx3XFxkX10rKTs/KT9cXHMvO3EoZixmdW5jdGlvbihhKXtmW2FdPSEwO2MoVS5nZXRFbGVtZW50QnlJZChhKSk7YT1hLnJlcGxhY2UoXCI6XCIsXCJcXFxcOlwiKTtiLnF1ZXJ5U2VsZWN0b3JBbGwmJihxKGIucXVlcnlTZWxlY3RvckFsbChcIi5cIithKSxjKSxxKGIucXVlcnlTZWxlY3RvckFsbChcIi5cIitcbmErXCJcXFxcOlwiKSxjKSxxKGIucXVlcnlTZWxlY3RvckFsbChcIltcIithK1wiXVwiKSxjKSl9KTtxKGQsZnVuY3Rpb24oYSl7aWYoIWUpe3ZhciBiPWguZXhlYyhcIiBcIithLmNsYXNzTmFtZStcIiBcIik7Yj8oZT1hLGc9KGJbMl18fFwiXCIpLnJlcGxhY2UoL1xccysvZyxcIixcIikpOnEoYS5hdHRyaWJ1dGVzLGZ1bmN0aW9uKGIpeyFlJiZmW2IubmFtZV0mJihlPWEsZz1iLnZhbHVlKX0pfX0pO2UmJmEoZSxnP1tnXTpbXSl9ZnVuY3Rpb24gJGIoYixhKXt2YXIgYz1mdW5jdGlvbigpe2I9eShiKTtpZihiLmluamVjdG9yKCkpe3ZhciBjPWJbMF09PT1VP1wiZG9jdW1lbnRcIjpoYShiKTt0aHJvdyBQYShcImJ0c3RycGRcIixjKTt9YT1hfHxbXTthLnVuc2hpZnQoW1wiJHByb3ZpZGVcIixmdW5jdGlvbihhKXthLnZhbHVlKFwiJHJvb3RFbGVtZW50XCIsYil9XSk7YS51bnNoaWZ0KFwibmdcIik7Yz1hYyhhKTtjLmludm9rZShbXCIkcm9vdFNjb3BlXCIsXCIkcm9vdEVsZW1lbnRcIixcIiRjb21waWxlXCIsXCIkaW5qZWN0b3JcIixcIiRhbmltYXRlXCIsXG5mdW5jdGlvbihhLGIsYyxkLGUpe2EuJGFwcGx5KGZ1bmN0aW9uKCl7Yi5kYXRhKFwiJGluamVjdG9yXCIsZCk7YyhiKShhKX0pfV0pO3JldHVybiBjfSxkPS9eTkdfREVGRVJfQk9PVFNUUkFQIS87aWYoTyYmIWQudGVzdChPLm5hbWUpKXJldHVybiBjKCk7Ty5uYW1lPU8ubmFtZS5yZXBsYWNlKGQsXCJcIik7RWEucmVzdW1lQm9vdHN0cmFwPWZ1bmN0aW9uKGIpe3EoYixmdW5jdGlvbihiKXthLnB1c2goYil9KTtjKCl9fWZ1bmN0aW9uIGZiKGIsYSl7YT1hfHxcIl9cIjtyZXR1cm4gYi5yZXBsYWNlKFhjLGZ1bmN0aW9uKGIsZCl7cmV0dXJuKGQ/YTpcIlwiKStiLnRvTG93ZXJDYXNlKCl9KX1mdW5jdGlvbiB4YihiLGEsYyl7aWYoIWIpdGhyb3cgUGEoXCJhcmVxXCIsYXx8XCI/XCIsY3x8XCJyZXF1aXJlZFwiKTtyZXR1cm4gYn1mdW5jdGlvbiBSYShiLGEsYyl7YyYmTShiKSYmKGI9YltiLmxlbmd0aC0xXSk7eGIoUChiKSxhLFwibm90IGEgZnVuY3Rpb24sIGdvdCBcIisoYiYmXCJvYmplY3RcIj09dHlwZW9mIGI/XG5iLmNvbnN0cnVjdG9yLm5hbWV8fFwiT2JqZWN0XCI6dHlwZW9mIGIpKTtyZXR1cm4gYn1mdW5jdGlvbiBBYShiLGEpe2lmKFwiaGFzT3duUHJvcGVydHlcIj09PWIpdGhyb3cgUGEoXCJiYWRuYW1lXCIsYSk7fWZ1bmN0aW9uIGJjKGIsYSxjKXtpZighYSlyZXR1cm4gYjthPWEuc3BsaXQoXCIuXCIpO2Zvcih2YXIgZCxlPWIsZz1hLmxlbmd0aCxmPTA7ZjxnO2YrKylkPWFbZl0sYiYmKGI9KGU9YilbZF0pO3JldHVybiFjJiZQKGIpP2ViKGUsYik6Yn1mdW5jdGlvbiB5YihiKXt2YXIgYT1iWzBdO2I9YltiLmxlbmd0aC0xXTtpZihhPT09YilyZXR1cm4geShhKTt2YXIgYz1bYV07ZG97YT1hLm5leHRTaWJsaW5nO2lmKCFhKWJyZWFrO2MucHVzaChhKX13aGlsZShhIT09Yik7cmV0dXJuIHkoYyl9ZnVuY3Rpb24gWWMoYil7dmFyIGE9dChcIiRpbmplY3RvclwiKSxjPXQoXCJuZ1wiKTtiPWIuYW5ndWxhcnx8KGIuYW5ndWxhcj17fSk7Yi4kJG1pbkVycj1iLiQkbWluRXJyfHx0O3JldHVybiBiLm1vZHVsZXx8XG4oYi5tb2R1bGU9ZnVuY3Rpb24oKXt2YXIgYj17fTtyZXR1cm4gZnVuY3Rpb24oZSxnLGYpe2lmKFwiaGFzT3duUHJvcGVydHlcIj09PWUpdGhyb3cgYyhcImJhZG5hbWVcIixcIm1vZHVsZVwiKTtnJiZiLmhhc093blByb3BlcnR5KGUpJiYoYltlXT1udWxsKTtyZXR1cm4gYltlXXx8KGJbZV09ZnVuY3Rpb24oKXtmdW5jdGlvbiBiKGEsZCxlKXtyZXR1cm4gZnVuY3Rpb24oKXtjW2V8fFwicHVzaFwiXShbYSxkLGFyZ3VtZW50c10pO3JldHVybiBufX1pZighZyl0aHJvdyBhKFwibm9tb2RcIixlKTt2YXIgYz1bXSxkPVtdLG09YihcIiRpbmplY3RvclwiLFwiaW52b2tlXCIpLG49e19pbnZva2VRdWV1ZTpjLF9ydW5CbG9ja3M6ZCxyZXF1aXJlczpnLG5hbWU6ZSxwcm92aWRlcjpiKFwiJHByb3ZpZGVcIixcInByb3ZpZGVyXCIpLGZhY3Rvcnk6YihcIiRwcm92aWRlXCIsXCJmYWN0b3J5XCIpLHNlcnZpY2U6YihcIiRwcm92aWRlXCIsXCJzZXJ2aWNlXCIpLHZhbHVlOmIoXCIkcHJvdmlkZVwiLFwidmFsdWVcIiksY29uc3RhbnQ6YihcIiRwcm92aWRlXCIsXG5cImNvbnN0YW50XCIsXCJ1bnNoaWZ0XCIpLGFuaW1hdGlvbjpiKFwiJGFuaW1hdGVQcm92aWRlclwiLFwicmVnaXN0ZXJcIiksZmlsdGVyOmIoXCIkZmlsdGVyUHJvdmlkZXJcIixcInJlZ2lzdGVyXCIpLGNvbnRyb2xsZXI6YihcIiRjb250cm9sbGVyUHJvdmlkZXJcIixcInJlZ2lzdGVyXCIpLGRpcmVjdGl2ZTpiKFwiJGNvbXBpbGVQcm92aWRlclwiLFwiZGlyZWN0aXZlXCIpLGNvbmZpZzptLHJ1bjpmdW5jdGlvbihhKXtkLnB1c2goYSk7cmV0dXJuIHRoaXN9fTtmJiZtKGYpO3JldHVybiBufSgpKX19KCkpfWZ1bmN0aW9uIFpjKGIpe0QoYix7Ym9vdHN0cmFwOiRiLGNvcHk6YmEsZXh0ZW5kOkQsZXF1YWxzOnhhLGVsZW1lbnQ6eSxmb3JFYWNoOnEsaW5qZWN0b3I6YWMsbm9vcDpDLGJpbmQ6ZWIsdG9Kc29uOnFhLGZyb21Kc29uOldiLGlkZW50aXR5OkRhLGlzVW5kZWZpbmVkOkUsaXNEZWZpbmVkOkIsaXNTdHJpbmc6dyxpc0Z1bmN0aW9uOlAsaXNPYmplY3Q6WCxpc051bWJlcjp2Yixpc0VsZW1lbnQ6VGMsaXNBcnJheTpNLFxudmVyc2lvbjokYyxpc0RhdGU6TmEsbG93ZXJjYXNlOkssdXBwZXJjYXNlOkZhLGNhbGxiYWNrczp7Y291bnRlcjowfSwkJG1pbkVycjp0LCQkY3NwOlZifSk7U2E9WWMoTyk7dHJ5e1NhKFwibmdMb2NhbGVcIil9Y2F0Y2goYSl7U2EoXCJuZ0xvY2FsZVwiLFtdKS5wcm92aWRlcihcIiRsb2NhbGVcIixhZCl9U2EoXCJuZ1wiLFtcIm5nTG9jYWxlXCJdLFtcIiRwcm92aWRlXCIsZnVuY3Rpb24oYSl7YS5wcm92aWRlcih7JCRzYW5pdGl6ZVVyaTpiZH0pO2EucHJvdmlkZXIoXCIkY29tcGlsZVwiLGNjKS5kaXJlY3RpdmUoe2E6Y2QsaW5wdXQ6ZGMsdGV4dGFyZWE6ZGMsZm9ybTpkZCxzY3JpcHQ6ZWQsc2VsZWN0OmZkLHN0eWxlOmdkLG9wdGlvbjpoZCxuZ0JpbmQ6aWQsbmdCaW5kSHRtbDpqZCxuZ0JpbmRUZW1wbGF0ZTprZCxuZ0NsYXNzOmxkLG5nQ2xhc3NFdmVuOm1kLG5nQ2xhc3NPZGQ6bmQsbmdDbG9hazpvZCxuZ0NvbnRyb2xsZXI6cGQsbmdGb3JtOnFkLG5nSGlkZTpyZCxuZ0lmOnNkLG5nSW5jbHVkZTp0ZCxcbm5nSW5pdDp1ZCxuZ05vbkJpbmRhYmxlOnZkLG5nUGx1cmFsaXplOndkLG5nUmVwZWF0OnhkLG5nU2hvdzp5ZCxuZ1N0eWxlOnpkLG5nU3dpdGNoOkFkLG5nU3dpdGNoV2hlbjpCZCxuZ1N3aXRjaERlZmF1bHQ6Q2QsbmdPcHRpb25zOkRkLG5nVHJhbnNjbHVkZTpFZCxuZ01vZGVsOkZkLG5nTGlzdDpHZCxuZ0NoYW5nZTpIZCxyZXF1aXJlZDplYyxuZ1JlcXVpcmVkOmVjLG5nVmFsdWU6SWR9KS5kaXJlY3RpdmUoe25nSW5jbHVkZTpKZH0pLmRpcmVjdGl2ZSh6YikuZGlyZWN0aXZlKGZjKTthLnByb3ZpZGVyKHskYW5jaG9yU2Nyb2xsOktkLCRhbmltYXRlOkxkLCRicm93c2VyOk1kLCRjYWNoZUZhY3Rvcnk6TmQsJGNvbnRyb2xsZXI6T2QsJGRvY3VtZW50OlBkLCRleGNlcHRpb25IYW5kbGVyOlFkLCRmaWx0ZXI6Z2MsJGludGVycG9sYXRlOlJkLCRpbnRlcnZhbDpTZCwkaHR0cDpUZCwkaHR0cEJhY2tlbmQ6VWQsJGxvY2F0aW9uOlZkLCRsb2c6V2QsJHBhcnNlOlhkLCRyb290U2NvcGU6WWQsXG4kcTpaZCwkc2NlOiRkLCRzY2VEZWxlZ2F0ZTphZSwkc25pZmZlcjpiZSwkdGVtcGxhdGVDYWNoZTpjZSwkdGltZW91dDpkZSwkd2luZG93OmVlLCQkckFGOmZlLCQkYXN5bmNDYWxsYmFjazpnZX0pfV0pfWZ1bmN0aW9uIFRhKGIpe3JldHVybiBiLnJlcGxhY2UoaGUsZnVuY3Rpb24oYSxiLGQsZSl7cmV0dXJuIGU/ZC50b1VwcGVyQ2FzZSgpOmR9KS5yZXBsYWNlKGllLFwiTW96JDFcIil9ZnVuY3Rpb24gQWIoYixhLGMsZCl7ZnVuY3Rpb24gZShiKXt2YXIgZT1jJiZiP1t0aGlzLmZpbHRlcihiKV06W3RoaXNdLGw9YSxrLG0sbixwLHIsejtpZighZHx8bnVsbCE9Yilmb3IoO2UubGVuZ3RoOylmb3Ioaz1lLnNoaWZ0KCksbT0wLG49ay5sZW5ndGg7bTxuO20rKylmb3IocD15KGtbbV0pLGw/cC50cmlnZ2VySGFuZGxlcihcIiRkZXN0cm95XCIpOmw9IWwscj0wLHA9KHo9cC5jaGlsZHJlbigpKS5sZW5ndGg7cjxwO3IrKyllLnB1c2goR2EoeltyXSkpO3JldHVybiBnLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1cbnZhciBnPUdhLmZuW2JdLGc9Zy4kb3JpZ2luYWx8fGc7ZS4kb3JpZ2luYWw9ZztHYS5mbltiXT1lfWZ1bmN0aW9uIE4oYil7aWYoYiBpbnN0YW5jZW9mIE4pcmV0dXJuIGI7dyhiKSYmKGI9Y2EoYikpO2lmKCEodGhpcyBpbnN0YW5jZW9mIE4pKXtpZih3KGIpJiZcIjxcIiE9Yi5jaGFyQXQoMCkpdGhyb3cgQmIoXCJub3NlbFwiKTtyZXR1cm4gbmV3IE4oYil9aWYodyhiKSl7dmFyIGE9YjtiPVU7dmFyIGM7aWYoYz1qZS5leGVjKGEpKWI9W2IuY3JlYXRlRWxlbWVudChjWzFdKV07ZWxzZXt2YXIgZD1iLGU7Yj1kLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtjPVtdO2lmKENiLnRlc3QoYSkpe2Q9Yi5hcHBlbmRDaGlsZChkLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikpO2U9KGtlLmV4ZWMoYSl8fFtcIlwiLFwiXCJdKVsxXS50b0xvd2VyQ2FzZSgpO2U9ZWFbZV18fGVhLl9kZWZhdWx0O2QuaW5uZXJIVE1MPVwiPGRpdj4mIzE2MDs8L2Rpdj5cIitlWzFdK2EucmVwbGFjZShsZSxcIjwkMT48LyQyPlwiKStlWzJdO1xuZC5yZW1vdmVDaGlsZChkLmZpcnN0Q2hpbGQpO2ZvcihhPWVbMF07YS0tOylkPWQubGFzdENoaWxkO2E9MDtmb3IoZT1kLmNoaWxkTm9kZXMubGVuZ3RoO2E8ZTsrK2EpYy5wdXNoKGQuY2hpbGROb2Rlc1thXSk7ZD1iLmZpcnN0Q2hpbGQ7ZC50ZXh0Q29udGVudD1cIlwifWVsc2UgYy5wdXNoKGQuY3JlYXRlVGV4dE5vZGUoYSkpO2IudGV4dENvbnRlbnQ9XCJcIjtiLmlubmVySFRNTD1cIlwiO2I9Y31EYih0aGlzLGIpO3koVS5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCkpLmFwcGVuZCh0aGlzKX1lbHNlIERiKHRoaXMsYil9ZnVuY3Rpb24gRWIoYil7cmV0dXJuIGIuY2xvbmVOb2RlKCEwKX1mdW5jdGlvbiBIYShiKXtoYyhiKTt2YXIgYT0wO2ZvcihiPWIuY2hpbGROb2Rlc3x8W107YTxiLmxlbmd0aDthKyspSGEoYlthXSl9ZnVuY3Rpb24gaWMoYixhLGMsZCl7aWYoQihkKSl0aHJvdyBCYihcIm9mZmFyZ3NcIik7dmFyIGU9bGEoYixcImV2ZW50c1wiKTtsYShiLFwiaGFuZGxlXCIpJiYoRShhKT9xKGUsXG5mdW5jdGlvbihhLGMpe0ZiKGIsYyxhKTtkZWxldGUgZVtjXX0pOnEoYS5zcGxpdChcIiBcIiksZnVuY3Rpb24oYSl7RShjKT8oRmIoYixhLGVbYV0pLGRlbGV0ZSBlW2FdKTpPYShlW2FdfHxbXSxjKX0pKX1mdW5jdGlvbiBoYyhiLGEpe3ZhciBjPWJbZ2JdLGQ9VWFbY107ZCYmKGE/ZGVsZXRlIFVhW2NdLmRhdGFbYV06KGQuaGFuZGxlJiYoZC5ldmVudHMuJGRlc3Ryb3kmJmQuaGFuZGxlKHt9LFwiJGRlc3Ryb3lcIiksaWMoYikpLGRlbGV0ZSBVYVtjXSxiW2diXT1zKSl9ZnVuY3Rpb24gbGEoYixhLGMpe3ZhciBkPWJbZ2JdLGQ9VWFbZHx8LTFdO2lmKEIoYykpZHx8KGJbZ2JdPWQ9KyttZSxkPVVhW2RdPXt9KSxkW2FdPWM7ZWxzZSByZXR1cm4gZCYmZFthXX1mdW5jdGlvbiBqYyhiLGEsYyl7dmFyIGQ9bGEoYixcImRhdGFcIiksZT1CKGMpLGc9IWUmJkIoYSksZj1nJiYhWChhKTtkfHxmfHxsYShiLFwiZGF0YVwiLGQ9e30pO2lmKGUpZFthXT1jO2Vsc2UgaWYoZyl7aWYoZilyZXR1cm4gZCYmZFthXTtcbkQoZCxhKX1lbHNlIHJldHVybiBkfWZ1bmN0aW9uIEdiKGIsYSl7cmV0dXJuIGIuZ2V0QXR0cmlidXRlPy0xPChcIiBcIisoYi5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKXx8XCJcIikrXCIgXCIpLnJlcGxhY2UoL1tcXG5cXHRdL2csXCIgXCIpLmluZGV4T2YoXCIgXCIrYStcIiBcIik6ITF9ZnVuY3Rpb24gaGIoYixhKXthJiZiLnNldEF0dHJpYnV0ZSYmcShhLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhKXtiLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsY2EoKFwiIFwiKyhiLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpfHxcIlwiKStcIiBcIikucmVwbGFjZSgvW1xcblxcdF0vZyxcIiBcIikucmVwbGFjZShcIiBcIitjYShhKStcIiBcIixcIiBcIikpKX0pfWZ1bmN0aW9uIGliKGIsYSl7aWYoYSYmYi5zZXRBdHRyaWJ1dGUpe3ZhciBjPShcIiBcIisoYi5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKXx8XCJcIikrXCIgXCIpLnJlcGxhY2UoL1tcXG5cXHRdL2csXCIgXCIpO3EoYS5zcGxpdChcIiBcIiksZnVuY3Rpb24oYSl7YT1jYShhKTstMT09PWMuaW5kZXhPZihcIiBcIithK1wiIFwiKSYmXG4oYys9YStcIiBcIil9KTtiLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsY2EoYykpfX1mdW5jdGlvbiBEYihiLGEpe2lmKGEpe2E9YS5ub2RlTmFtZXx8IUIoYS5sZW5ndGgpfHxDYShhKT9bYV06YTtmb3IodmFyIGM9MDtjPGEubGVuZ3RoO2MrKyliLnB1c2goYVtjXSl9fWZ1bmN0aW9uIGtjKGIsYSl7cmV0dXJuIGpiKGIsXCIkXCIrKGF8fFwibmdDb250cm9sbGVyXCIpK1wiQ29udHJvbGxlclwiKX1mdW5jdGlvbiBqYihiLGEsYyl7Yj15KGIpOzk9PWJbMF0ubm9kZVR5cGUmJihiPWIuZmluZChcImh0bWxcIikpO2ZvcihhPU0oYSk/YTpbYV07Yi5sZW5ndGg7KXtmb3IodmFyIGQ9YlswXSxlPTAsZz1hLmxlbmd0aDtlPGc7ZSsrKWlmKChjPWIuZGF0YShhW2VdKSkhPT1zKXJldHVybiBjO2I9eShkLnBhcmVudE5vZGV8fDExPT09ZC5ub2RlVHlwZSYmZC5ob3N0KX19ZnVuY3Rpb24gbGMoYil7Zm9yKHZhciBhPTAsYz1iLmNoaWxkTm9kZXM7YTxjLmxlbmd0aDthKyspSGEoY1thXSk7Zm9yKDtiLmZpcnN0Q2hpbGQ7KWIucmVtb3ZlQ2hpbGQoYi5maXJzdENoaWxkKX1cbmZ1bmN0aW9uIG1jKGIsYSl7dmFyIGM9a2JbYS50b0xvd2VyQ2FzZSgpXTtyZXR1cm4gYyYmbmNbYi5ub2RlTmFtZV0mJmN9ZnVuY3Rpb24gbmUoYixhKXt2YXIgYz1mdW5jdGlvbihjLGUpe2MucHJldmVudERlZmF1bHR8fChjLnByZXZlbnREZWZhdWx0PWZ1bmN0aW9uKCl7Yy5yZXR1cm5WYWx1ZT0hMX0pO2Muc3RvcFByb3BhZ2F0aW9ufHwoYy5zdG9wUHJvcGFnYXRpb249ZnVuY3Rpb24oKXtjLmNhbmNlbEJ1YmJsZT0hMH0pO2MudGFyZ2V0fHwoYy50YXJnZXQ9Yy5zcmNFbGVtZW50fHxVKTtpZihFKGMuZGVmYXVsdFByZXZlbnRlZCkpe3ZhciBnPWMucHJldmVudERlZmF1bHQ7Yy5wcmV2ZW50RGVmYXVsdD1mdW5jdGlvbigpe2MuZGVmYXVsdFByZXZlbnRlZD0hMDtnLmNhbGwoYyl9O2MuZGVmYXVsdFByZXZlbnRlZD0hMX1jLmlzRGVmYXVsdFByZXZlbnRlZD1mdW5jdGlvbigpe3JldHVybiBjLmRlZmF1bHRQcmV2ZW50ZWR8fCExPT09Yy5yZXR1cm5WYWx1ZX07dmFyIGY9VWIoYVtlfHxcbmMudHlwZV18fFtdKTtxKGYsZnVuY3Rpb24oYSl7YS5jYWxsKGIsYyl9KTs4Pj1TPyhjLnByZXZlbnREZWZhdWx0PW51bGwsYy5zdG9wUHJvcGFnYXRpb249bnVsbCxjLmlzRGVmYXVsdFByZXZlbnRlZD1udWxsKTooZGVsZXRlIGMucHJldmVudERlZmF1bHQsZGVsZXRlIGMuc3RvcFByb3BhZ2F0aW9uLGRlbGV0ZSBjLmlzRGVmYXVsdFByZXZlbnRlZCl9O2MuZWxlbT1iO3JldHVybiBjfWZ1bmN0aW9uIElhKGIpe3ZhciBhPXR5cGVvZiBiLGM7XCJvYmplY3RcIj09YSYmbnVsbCE9PWI/XCJmdW5jdGlvblwiPT10eXBlb2YoYz1iLiQkaGFzaEtleSk/Yz1iLiQkaGFzaEtleSgpOmM9PT1zJiYoYz1iLiQkaGFzaEtleT1iYigpKTpjPWI7cmV0dXJuIGErXCI6XCIrY31mdW5jdGlvbiBWYShiKXtxKGIsdGhpcy5wdXQsdGhpcyl9ZnVuY3Rpb24gb2MoYil7dmFyIGEsYztcImZ1bmN0aW9uXCI9PXR5cGVvZiBiPyhhPWIuJGluamVjdCl8fChhPVtdLGIubGVuZ3RoJiYoYz1iLnRvU3RyaW5nKCkucmVwbGFjZShvZSxcblwiXCIpLGM9Yy5tYXRjaChwZSkscShjWzFdLnNwbGl0KHFlKSxmdW5jdGlvbihiKXtiLnJlcGxhY2UocmUsZnVuY3Rpb24oYixjLGQpe2EucHVzaChkKX0pfSkpLGIuJGluamVjdD1hKTpNKGIpPyhjPWIubGVuZ3RoLTEsUmEoYltjXSxcImZuXCIpLGE9Yi5zbGljZSgwLGMpKTpSYShiLFwiZm5cIiwhMCk7cmV0dXJuIGF9ZnVuY3Rpb24gYWMoYil7ZnVuY3Rpb24gYShhKXtyZXR1cm4gZnVuY3Rpb24oYixjKXtpZihYKGIpKXEoYixSYihhKSk7ZWxzZSByZXR1cm4gYShiLGMpfX1mdW5jdGlvbiBjKGEsYil7QWEoYSxcInNlcnZpY2VcIik7aWYoUChiKXx8TShiKSliPW4uaW5zdGFudGlhdGUoYik7aWYoIWIuJGdldCl0aHJvdyBXYShcInBnZXRcIixhKTtyZXR1cm4gbVthK2hdPWJ9ZnVuY3Rpb24gZChhLGIpe3JldHVybiBjKGEseyRnZXQ6Yn0pfWZ1bmN0aW9uIGUoYSl7dmFyIGI9W10sYyxkLGcsaDtxKGEsZnVuY3Rpb24oYSl7aWYoIWsuZ2V0KGEpKXtrLnB1dChhLCEwKTt0cnl7aWYodyhhKSlmb3IoYz1cblNhKGEpLGI9Yi5jb25jYXQoZShjLnJlcXVpcmVzKSkuY29uY2F0KGMuX3J1bkJsb2NrcyksZD1jLl9pbnZva2VRdWV1ZSxnPTAsaD1kLmxlbmd0aDtnPGg7ZysrKXt2YXIgZj1kW2ddLGw9bi5nZXQoZlswXSk7bFtmWzFdXS5hcHBseShsLGZbMl0pfWVsc2UgUChhKT9iLnB1c2gobi5pbnZva2UoYSkpOk0oYSk/Yi5wdXNoKG4uaW52b2tlKGEpKTpSYShhLFwibW9kdWxlXCIpfWNhdGNoKG0pe3Rocm93IE0oYSkmJihhPWFbYS5sZW5ndGgtMV0pLG0ubWVzc2FnZSYmKG0uc3RhY2smJi0xPT1tLnN0YWNrLmluZGV4T2YobS5tZXNzYWdlKSkmJihtPW0ubWVzc2FnZStcIlxcblwiK20uc3RhY2spLFdhKFwibW9kdWxlcnJcIixhLG0uc3RhY2t8fG0ubWVzc2FnZXx8bSk7fX19KTtyZXR1cm4gYn1mdW5jdGlvbiBnKGEsYil7ZnVuY3Rpb24gYyhkKXtpZihhLmhhc093blByb3BlcnR5KGQpKXtpZihhW2RdPT09Zil0aHJvdyBXYShcImNkZXBcIixsLmpvaW4oXCIgPC0gXCIpKTtyZXR1cm4gYVtkXX10cnl7cmV0dXJuIGwudW5zaGlmdChkKSxcbmFbZF09ZixhW2RdPWIoZCl9Y2F0Y2goZSl7dGhyb3cgYVtkXT09PWYmJmRlbGV0ZSBhW2RdLGU7fWZpbmFsbHl7bC5zaGlmdCgpfX1mdW5jdGlvbiBkKGEsYixlKXt2YXIgZz1bXSxoPW9jKGEpLGYsbCxrO2w9MDtmb3IoZj1oLmxlbmd0aDtsPGY7bCsrKXtrPWhbbF07aWYoXCJzdHJpbmdcIiE9PXR5cGVvZiBrKXRocm93IFdhKFwiaXRrblwiLGspO2cucHVzaChlJiZlLmhhc093blByb3BlcnR5KGspP2Vba106YyhrKSl9YS4kaW5qZWN0fHwoYT1hW2ZdKTtyZXR1cm4gYS5hcHBseShiLGcpfXJldHVybntpbnZva2U6ZCxpbnN0YW50aWF0ZTpmdW5jdGlvbihhLGIpe3ZhciBjPWZ1bmN0aW9uKCl7fSxlO2MucHJvdG90eXBlPShNKGEpP2FbYS5sZW5ndGgtMV06YSkucHJvdG90eXBlO2M9bmV3IGM7ZT1kKGEsYyxiKTtyZXR1cm4gWChlKXx8UChlKT9lOmN9LGdldDpjLGFubm90YXRlOm9jLGhhczpmdW5jdGlvbihiKXtyZXR1cm4gbS5oYXNPd25Qcm9wZXJ0eShiK2gpfHxhLmhhc093blByb3BlcnR5KGIpfX19XG52YXIgZj17fSxoPVwiUHJvdmlkZXJcIixsPVtdLGs9bmV3IFZhLG09eyRwcm92aWRlOntwcm92aWRlcjphKGMpLGZhY3Rvcnk6YShkKSxzZXJ2aWNlOmEoZnVuY3Rpb24oYSxiKXtyZXR1cm4gZChhLFtcIiRpbmplY3RvclwiLGZ1bmN0aW9uKGEpe3JldHVybiBhLmluc3RhbnRpYXRlKGIpfV0pfSksdmFsdWU6YShmdW5jdGlvbihhLGIpe3JldHVybiBkKGEsYWEoYikpfSksY29uc3RhbnQ6YShmdW5jdGlvbihhLGIpe0FhKGEsXCJjb25zdGFudFwiKTttW2FdPWI7cFthXT1ifSksZGVjb3JhdG9yOmZ1bmN0aW9uKGEsYil7dmFyIGM9bi5nZXQoYStoKSxkPWMuJGdldDtjLiRnZXQ9ZnVuY3Rpb24oKXt2YXIgYT1yLmludm9rZShkLGMpO3JldHVybiByLmludm9rZShiLG51bGwseyRkZWxlZ2F0ZTphfSl9fX19LG49bS4kaW5qZWN0b3I9ZyhtLGZ1bmN0aW9uKCl7dGhyb3cgV2EoXCJ1bnByXCIsbC5qb2luKFwiIDwtIFwiKSk7fSkscD17fSxyPXAuJGluamVjdG9yPWcocCxmdW5jdGlvbihhKXthPW4uZ2V0KGErXG5oKTtyZXR1cm4gci5pbnZva2UoYS4kZ2V0LGEpfSk7cShlKGIpLGZ1bmN0aW9uKGEpe3IuaW52b2tlKGF8fEMpfSk7cmV0dXJuIHJ9ZnVuY3Rpb24gS2QoKXt2YXIgYj0hMDt0aGlzLmRpc2FibGVBdXRvU2Nyb2xsaW5nPWZ1bmN0aW9uKCl7Yj0hMX07dGhpcy4kZ2V0PVtcIiR3aW5kb3dcIixcIiRsb2NhdGlvblwiLFwiJHJvb3RTY29wZVwiLGZ1bmN0aW9uKGEsYyxkKXtmdW5jdGlvbiBlKGEpe3ZhciBiPW51bGw7cShhLGZ1bmN0aW9uKGEpe2J8fFwiYVwiIT09SyhhLm5vZGVOYW1lKXx8KGI9YSl9KTtyZXR1cm4gYn1mdW5jdGlvbiBnKCl7dmFyIGI9Yy5oYXNoKCksZDtiPyhkPWYuZ2V0RWxlbWVudEJ5SWQoYikpP2Quc2Nyb2xsSW50b1ZpZXcoKTooZD1lKGYuZ2V0RWxlbWVudHNCeU5hbWUoYikpKT9kLnNjcm9sbEludG9WaWV3KCk6XCJ0b3BcIj09PWImJmEuc2Nyb2xsVG8oMCwwKTphLnNjcm9sbFRvKDAsMCl9dmFyIGY9YS5kb2N1bWVudDtiJiZkLiR3YXRjaChmdW5jdGlvbigpe3JldHVybiBjLmhhc2goKX0sXG5mdW5jdGlvbigpe2QuJGV2YWxBc3luYyhnKX0pO3JldHVybiBnfV19ZnVuY3Rpb24gZ2UoKXt0aGlzLiRnZXQ9W1wiJCRyQUZcIixcIiR0aW1lb3V0XCIsZnVuY3Rpb24oYixhKXtyZXR1cm4gYi5zdXBwb3J0ZWQ/ZnVuY3Rpb24oYSl7cmV0dXJuIGIoYSl9OmZ1bmN0aW9uKGIpe3JldHVybiBhKGIsMCwhMSl9fV19ZnVuY3Rpb24gc2UoYixhLGMsZCl7ZnVuY3Rpb24gZShhKXt0cnl7YS5hcHBseShudWxsLHlhLmNhbGwoYXJndW1lbnRzLDEpKX1maW5hbGx5e2lmKHotLSwwPT09eilmb3IoO3UubGVuZ3RoOyl0cnl7dS5wb3AoKSgpfWNhdGNoKGIpe2MuZXJyb3IoYil9fX1mdW5jdGlvbiBnKGEsYil7KGZ1bmN0aW9uIFQoKXtxKEYsZnVuY3Rpb24oYSl7YSgpfSk7dj1iKFQsYSl9KSgpfWZ1bmN0aW9uIGYoKXt4PW51bGw7SiE9aC51cmwoKSYmKEo9aC51cmwoKSxxKG1hLGZ1bmN0aW9uKGEpe2EoaC51cmwoKSl9KSl9dmFyIGg9dGhpcyxsPWFbMF0saz1iLmxvY2F0aW9uLG09Yi5oaXN0b3J5LFxubj1iLnNldFRpbWVvdXQscD1iLmNsZWFyVGltZW91dCxyPXt9O2guaXNNb2NrPSExO3ZhciB6PTAsdT1bXTtoLiQkY29tcGxldGVPdXRzdGFuZGluZ1JlcXVlc3Q9ZTtoLiQkaW5jT3V0c3RhbmRpbmdSZXF1ZXN0Q291bnQ9ZnVuY3Rpb24oKXt6Kyt9O2gubm90aWZ5V2hlbk5vT3V0c3RhbmRpbmdSZXF1ZXN0cz1mdW5jdGlvbihhKXtxKEYsZnVuY3Rpb24oYSl7YSgpfSk7MD09PXo/YSgpOnUucHVzaChhKX07dmFyIEY9W10sdjtoLmFkZFBvbGxGbj1mdW5jdGlvbihhKXtFKHYpJiZnKDEwMCxuKTtGLnB1c2goYSk7cmV0dXJuIGF9O3ZhciBKPWsuaHJlZixBPWEuZmluZChcImJhc2VcIikseD1udWxsO2gudXJsPWZ1bmN0aW9uKGEsYyl7ayE9PWIubG9jYXRpb24mJihrPWIubG9jYXRpb24pO20hPT1iLmhpc3RvcnkmJihtPWIuaGlzdG9yeSk7aWYoYSl7aWYoSiE9YSlyZXR1cm4gSj1hLGQuaGlzdG9yeT9jP20ucmVwbGFjZVN0YXRlKG51bGwsXCJcIixhKToobS5wdXNoU3RhdGUobnVsbCxcIlwiLFxuYSksQS5hdHRyKFwiaHJlZlwiLEEuYXR0cihcImhyZWZcIikpKTooeD1hLGM/ay5yZXBsYWNlKGEpOmsuaHJlZj1hKSxofWVsc2UgcmV0dXJuIHh8fGsuaHJlZi5yZXBsYWNlKC8lMjcvZyxcIidcIil9O3ZhciBtYT1bXSxMPSExO2gub25VcmxDaGFuZ2U9ZnVuY3Rpb24oYSl7aWYoIUwpe2lmKGQuaGlzdG9yeSl5KGIpLm9uKFwicG9wc3RhdGVcIixmKTtpZihkLmhhc2hjaGFuZ2UpeShiKS5vbihcImhhc2hjaGFuZ2VcIixmKTtlbHNlIGguYWRkUG9sbEZuKGYpO0w9ITB9bWEucHVzaChhKTtyZXR1cm4gYX07aC5iYXNlSHJlZj1mdW5jdGlvbigpe3ZhciBhPUEuYXR0cihcImhyZWZcIik7cmV0dXJuIGE/YS5yZXBsYWNlKC9eKGh0dHBzP1xcOik/XFwvXFwvW15cXC9dKi8sXCJcIik6XCJcIn07dmFyIFE9e30sZGE9XCJcIixIPWguYmFzZUhyZWYoKTtoLmNvb2tpZXM9ZnVuY3Rpb24oYSxiKXt2YXIgZCxlLGcsaDtpZihhKWI9PT1zP2wuY29va2llPWVzY2FwZShhKStcIj07cGF0aD1cIitIK1wiO2V4cGlyZXM9VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMCBHTVRcIjpcbncoYikmJihkPShsLmNvb2tpZT1lc2NhcGUoYSkrXCI9XCIrZXNjYXBlKGIpK1wiO3BhdGg9XCIrSCkubGVuZ3RoKzEsNDA5NjxkJiZjLndhcm4oXCJDb29raWUgJ1wiK2ErXCInIHBvc3NpYmx5IG5vdCBzZXQgb3Igb3ZlcmZsb3dlZCBiZWNhdXNlIGl0IHdhcyB0b28gbGFyZ2UgKFwiK2QrXCIgPiA0MDk2IGJ5dGVzKSFcIikpO2Vsc2V7aWYobC5jb29raWUhPT1kYSlmb3IoZGE9bC5jb29raWUsZD1kYS5zcGxpdChcIjsgXCIpLFE9e30sZz0wO2c8ZC5sZW5ndGg7ZysrKWU9ZFtnXSxoPWUuaW5kZXhPZihcIj1cIiksMDxoJiYoYT11bmVzY2FwZShlLnN1YnN0cmluZygwLGgpKSxRW2FdPT09cyYmKFFbYV09dW5lc2NhcGUoZS5zdWJzdHJpbmcoaCsxKSkpKTtyZXR1cm4gUX19O2guZGVmZXI9ZnVuY3Rpb24oYSxiKXt2YXIgYzt6Kys7Yz1uKGZ1bmN0aW9uKCl7ZGVsZXRlIHJbY107ZShhKX0sYnx8MCk7cltjXT0hMDtyZXR1cm4gY307aC5kZWZlci5jYW5jZWw9ZnVuY3Rpb24oYSl7cmV0dXJuIHJbYV0/KGRlbGV0ZSByW2FdLFxucChhKSxlKEMpLCEwKTohMX19ZnVuY3Rpb24gTWQoKXt0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLFwiJGxvZ1wiLFwiJHNuaWZmZXJcIixcIiRkb2N1bWVudFwiLGZ1bmN0aW9uKGIsYSxjLGQpe3JldHVybiBuZXcgc2UoYixkLGEsYyl9XX1mdW5jdGlvbiBOZCgpe3RoaXMuJGdldD1mdW5jdGlvbigpe2Z1bmN0aW9uIGIoYixkKXtmdW5jdGlvbiBlKGEpe2EhPW4mJihwP3A9PWEmJihwPWEubik6cD1hLGcoYS5uLGEucCksZyhhLG4pLG49YSxuLm49bnVsbCl9ZnVuY3Rpb24gZyhhLGIpe2EhPWImJihhJiYoYS5wPWIpLGImJihiLm49YSkpfWlmKGIgaW4gYSl0aHJvdyB0KFwiJGNhY2hlRmFjdG9yeVwiKShcImlpZFwiLGIpO3ZhciBmPTAsaD1EKHt9LGQse2lkOmJ9KSxsPXt9LGs9ZCYmZC5jYXBhY2l0eXx8TnVtYmVyLk1BWF9WQUxVRSxtPXt9LG49bnVsbCxwPW51bGw7cmV0dXJuIGFbYl09e3B1dDpmdW5jdGlvbihhLGIpe2lmKGs8TnVtYmVyLk1BWF9WQUxVRSl7dmFyIGM9bVthXXx8KG1bYV09e2tleTphfSk7XG5lKGMpfWlmKCFFKGIpKXJldHVybiBhIGluIGx8fGYrKyxsW2FdPWIsZj5rJiZ0aGlzLnJlbW92ZShwLmtleSksYn0sZ2V0OmZ1bmN0aW9uKGEpe2lmKGs8TnVtYmVyLk1BWF9WQUxVRSl7dmFyIGI9bVthXTtpZighYilyZXR1cm47ZShiKX1yZXR1cm4gbFthXX0scmVtb3ZlOmZ1bmN0aW9uKGEpe2lmKGs8TnVtYmVyLk1BWF9WQUxVRSl7dmFyIGI9bVthXTtpZighYilyZXR1cm47Yj09biYmKG49Yi5wKTtiPT1wJiYocD1iLm4pO2coYi5uLGIucCk7ZGVsZXRlIG1bYV19ZGVsZXRlIGxbYV07Zi0tfSxyZW1vdmVBbGw6ZnVuY3Rpb24oKXtsPXt9O2Y9MDttPXt9O249cD1udWxsfSxkZXN0cm95OmZ1bmN0aW9uKCl7bT1oPWw9bnVsbDtkZWxldGUgYVtiXX0saW5mbzpmdW5jdGlvbigpe3JldHVybiBEKHt9LGgse3NpemU6Zn0pfX19dmFyIGE9e307Yi5pbmZvPWZ1bmN0aW9uKCl7dmFyIGI9e307cShhLGZ1bmN0aW9uKGEsZSl7YltlXT1hLmluZm8oKX0pO3JldHVybiBifTtiLmdldD1mdW5jdGlvbihiKXtyZXR1cm4gYVtiXX07XG5yZXR1cm4gYn19ZnVuY3Rpb24gY2UoKXt0aGlzLiRnZXQ9W1wiJGNhY2hlRmFjdG9yeVwiLGZ1bmN0aW9uKGIpe3JldHVybiBiKFwidGVtcGxhdGVzXCIpfV19ZnVuY3Rpb24gY2MoYixhKXt2YXIgYz17fSxkPVwiRGlyZWN0aXZlXCIsZT0vXlxccypkaXJlY3RpdmVcXDpcXHMqKFtcXGRcXHdcXC1fXSspXFxzKyguKikkLyxnPS8oKFtcXGRcXHdcXC1fXSspKD86XFw6KFteO10rKSk/Oz8pLyxmPS9eKG9uW2Etel0rfGZvcm1hY3Rpb24pJC87dGhpcy5kaXJlY3RpdmU9ZnVuY3Rpb24gbChhLGUpe0FhKGEsXCJkaXJlY3RpdmVcIik7dyhhKT8oeGIoZSxcImRpcmVjdGl2ZUZhY3RvcnlcIiksYy5oYXNPd25Qcm9wZXJ0eShhKXx8KGNbYV09W10sYi5mYWN0b3J5KGErZCxbXCIkaW5qZWN0b3JcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsZnVuY3Rpb24oYixkKXt2YXIgZT1bXTtxKGNbYV0sZnVuY3Rpb24oYyxnKXt0cnl7dmFyIGY9Yi5pbnZva2UoYyk7UChmKT9mPXtjb21waWxlOmFhKGYpfTohZi5jb21waWxlJiZmLmxpbmsmJihmLmNvbXBpbGU9XG5hYShmLmxpbmspKTtmLnByaW9yaXR5PWYucHJpb3JpdHl8fDA7Zi5pbmRleD1nO2YubmFtZT1mLm5hbWV8fGE7Zi5yZXF1aXJlPWYucmVxdWlyZXx8Zi5jb250cm9sbGVyJiZmLm5hbWU7Zi5yZXN0cmljdD1mLnJlc3RyaWN0fHxcIkFcIjtlLnB1c2goZil9Y2F0Y2gobCl7ZChsKX19KTtyZXR1cm4gZX1dKSksY1thXS5wdXNoKGUpKTpxKGEsUmIobCkpO3JldHVybiB0aGlzfTt0aGlzLmFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0PWZ1bmN0aW9uKGIpe3JldHVybiBCKGIpPyhhLmFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0KGIpLHRoaXMpOmEuYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3QoKX07dGhpcy5pbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3Q9ZnVuY3Rpb24oYil7cmV0dXJuIEIoYik/KGEuaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0KGIpLHRoaXMpOmEuaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0KCl9O3RoaXMuJGdldD1bXCIkaW5qZWN0b3JcIixcIiRpbnRlcnBvbGF0ZVwiLFxuXCIkZXhjZXB0aW9uSGFuZGxlclwiLFwiJGh0dHBcIixcIiR0ZW1wbGF0ZUNhY2hlXCIsXCIkcGFyc2VcIixcIiRjb250cm9sbGVyXCIsXCIkcm9vdFNjb3BlXCIsXCIkZG9jdW1lbnRcIixcIiRzY2VcIixcIiRhbmltYXRlXCIsXCIkJHNhbml0aXplVXJpXCIsZnVuY3Rpb24oYSxiLG0sbixwLHIseix1LEYsdixKLEEpe2Z1bmN0aW9uIHgoYSxiLGMsZCxlKXthIGluc3RhbmNlb2YgeXx8KGE9eShhKSk7cShhLGZ1bmN0aW9uKGIsYyl7Mz09Yi5ub2RlVHlwZSYmYi5ub2RlVmFsdWUubWF0Y2goL1xcUysvKSYmKGFbY109eShiKS53cmFwKFwiPHNwYW4+PC9zcGFuPlwiKS5wYXJlbnQoKVswXSl9KTt2YXIgZz1MKGEsYixhLGMsZCxlKTttYShhLFwibmctc2NvcGVcIik7cmV0dXJuIGZ1bmN0aW9uKGIsYyxkKXt4YihiLFwic2NvcGVcIik7dmFyIGU9Yz9KYS5jbG9uZS5jYWxsKGEpOmE7cShkLGZ1bmN0aW9uKGEsYil7ZS5kYXRhKFwiJFwiK2IrXCJDb250cm9sbGVyXCIsYSl9KTtkPTA7Zm9yKHZhciBmPWUubGVuZ3RoO2Q8ZjtkKyspe3ZhciBsPVxuZVtkXS5ub2RlVHlwZTsxIT09bCYmOSE9PWx8fGUuZXEoZCkuZGF0YShcIiRzY29wZVwiLGIpfWMmJmMoZSxiKTtnJiZnKGIsZSxlKTtyZXR1cm4gZX19ZnVuY3Rpb24gbWEoYSxiKXt0cnl7YS5hZGRDbGFzcyhiKX1jYXRjaChjKXt9fWZ1bmN0aW9uIEwoYSxiLGMsZCxlLGcpe2Z1bmN0aW9uIGYoYSxjLGQsZSl7dmFyIGcsayxtLHIsbixwLHo7Zz1jLmxlbmd0aDt2YXIgST1BcnJheShnKTtmb3Iobj0wO248ZztuKyspSVtuXT1jW25dO3o9bj0wO2ZvcihwPWwubGVuZ3RoO248cDt6Kyspaz1JW3pdLGM9bFtuKytdLGc9bFtuKytdLG09eShrKSxjPyhjLnNjb3BlPyhyPWEuJG5ldygpLG0uZGF0YShcIiRzY29wZVwiLHIpKTpyPWEsKG09Yy50cmFuc2NsdWRlKXx8IWUmJmI/YyhnLHIsayxkLFEoYSxtfHxiKSk6YyhnLHIsayxkLGUpKTpnJiZnKGEsay5jaGlsZE5vZGVzLHMsZSl9Zm9yKHZhciBsPVtdLGssbSxyLG4scD0wO3A8YS5sZW5ndGg7cCsrKWs9bmV3IEhiLG09ZGEoYVtwXSxbXSxrLFxuMD09PXA/ZDpzLGUpLChnPW0ubGVuZ3RoP2lhKG0sYVtwXSxrLGIsYyxudWxsLFtdLFtdLGcpOm51bGwpJiZnLnNjb3BlJiZtYSh5KGFbcF0pLFwibmctc2NvcGVcIiksaz1nJiZnLnRlcm1pbmFsfHwhKHI9YVtwXS5jaGlsZE5vZGVzKXx8IXIubGVuZ3RoP251bGw6TChyLGc/Zy50cmFuc2NsdWRlOmIpLGwucHVzaChnLGspLG49bnx8Z3x8ayxnPW51bGw7cmV0dXJuIG4/ZjpudWxsfWZ1bmN0aW9uIFEoYSxiKXtyZXR1cm4gZnVuY3Rpb24oYyxkLGUpe3ZhciBnPSExO2N8fChjPWEuJG5ldygpLGc9Yy4kJHRyYW5zY2x1ZGVkPSEwKTtkPWIoYyxkLGUpO2lmKGcpZC5vbihcIiRkZXN0cm95XCIsZWIoYyxjLiRkZXN0cm95KSk7cmV0dXJuIGR9fWZ1bmN0aW9uIGRhKGEsYixjLGQsZil7dmFyIGs9Yy4kYXR0cixsO3N3aXRjaChhLm5vZGVUeXBlKXtjYXNlIDE6VChiLG5hKEthKGEpLnRvTG93ZXJDYXNlKCkpLFwiRVwiLGQsZik7dmFyIG0scixuO2w9YS5hdHRyaWJ1dGVzO2Zvcih2YXIgcD0wLHo9XG5sJiZsLmxlbmd0aDtwPHo7cCsrKXt2YXIgdT0hMSxGPSExO209bFtwXTtpZighU3x8ODw9U3x8bS5zcGVjaWZpZWQpe3I9bS5uYW1lO249bmEocik7Vy50ZXN0KG4pJiYocj1mYihuLnN1YnN0cig2KSxcIi1cIikpO3ZhciBKPW4ucmVwbGFjZSgvKFN0YXJ0fEVuZCkkLyxcIlwiKTtuPT09SitcIlN0YXJ0XCImJih1PXIsRj1yLnN1YnN0cigwLHIubGVuZ3RoLTUpK1wiZW5kXCIscj1yLnN1YnN0cigwLHIubGVuZ3RoLTYpKTtuPW5hKHIudG9Mb3dlckNhc2UoKSk7a1tuXT1yO2Nbbl09bT1jYShtLnZhbHVlKTttYyhhLG4pJiYoY1tuXT0hMCk7TihhLGIsbSxuKTtUKGIsbixcIkFcIixkLGYsdSxGKX19YT1hLmNsYXNzTmFtZTtpZih3KGEpJiZcIlwiIT09YSlmb3IoO2w9Zy5leGVjKGEpOyluPW5hKGxbMl0pLFQoYixuLFwiQ1wiLGQsZikmJihjW25dPWNhKGxbM10pKSxhPWEuc3Vic3RyKGwuaW5kZXgrbFswXS5sZW5ndGgpO2JyZWFrO2Nhc2UgMzp0KGIsYS5ub2RlVmFsdWUpO2JyZWFrO2Nhc2UgODp0cnl7aWYobD1cbmUuZXhlYyhhLm5vZGVWYWx1ZSkpbj1uYShsWzFdKSxUKGIsbixcIk1cIixkLGYpJiYoY1tuXT1jYShsWzJdKSl9Y2F0Y2goeCl7fX1iLnNvcnQoRSk7cmV0dXJuIGJ9ZnVuY3Rpb24gSChhLGIsYyl7dmFyIGQ9W10sZT0wO2lmKGImJmEuaGFzQXR0cmlidXRlJiZhLmhhc0F0dHJpYnV0ZShiKSl7ZG97aWYoIWEpdGhyb3cgamEoXCJ1dGVyZGlyXCIsYixjKTsxPT1hLm5vZGVUeXBlJiYoYS5oYXNBdHRyaWJ1dGUoYikmJmUrKyxhLmhhc0F0dHJpYnV0ZShjKSYmZS0tKTtkLnB1c2goYSk7YT1hLm5leHRTaWJsaW5nfXdoaWxlKDA8ZSl9ZWxzZSBkLnB1c2goYSk7cmV0dXJuIHkoZCl9ZnVuY3Rpb24gUihhLGIsYyl7cmV0dXJuIGZ1bmN0aW9uKGQsZSxnLGYsbCl7ZT1IKGVbMF0sYixjKTtyZXR1cm4gYShkLGUsZyxmLGwpfX1mdW5jdGlvbiBpYShhLGMsZCxlLGcsZixsLG4scCl7ZnVuY3Rpb24gdShhLGIsYyxkKXtpZihhKXtjJiYoYT1SKGEsYyxkKSk7YS5yZXF1aXJlPUcucmVxdWlyZTtpZihRPT09XG5HfHxHLiQkaXNvbGF0ZVNjb3BlKWE9cWMoYSx7aXNvbGF0ZVNjb3BlOiEwfSk7bC5wdXNoKGEpfWlmKGIpe2MmJihiPVIoYixjLGQpKTtiLnJlcXVpcmU9Ry5yZXF1aXJlO2lmKFE9PT1HfHxHLiQkaXNvbGF0ZVNjb3BlKWI9cWMoYix7aXNvbGF0ZVNjb3BlOiEwfSk7bi5wdXNoKGIpfX1mdW5jdGlvbiBGKGEsYixjKXt2YXIgZCxlPVwiZGF0YVwiLGc9ITE7aWYodyhhKSl7Zm9yKDtcIl5cIj09KGQ9YS5jaGFyQXQoMCkpfHxcIj9cIj09ZDspYT1hLnN1YnN0cigxKSxcIl5cIj09ZCYmKGU9XCJpbmhlcml0ZWREYXRhXCIpLGc9Z3x8XCI/XCI9PWQ7ZD1udWxsO2MmJlwiZGF0YVwiPT09ZSYmKGQ9Y1thXSk7ZD1kfHxiW2VdKFwiJFwiK2ErXCJDb250cm9sbGVyXCIpO2lmKCFkJiYhZyl0aHJvdyBqYShcImN0cmVxXCIsYSx0KTt9ZWxzZSBNKGEpJiYoZD1bXSxxKGEsZnVuY3Rpb24oYSl7ZC5wdXNoKEYoYSxiLGMpKX0pKTtyZXR1cm4gZH1mdW5jdGlvbiBKKGEsZSxnLGYscCl7ZnVuY3Rpb24gdShhLGIpe3ZhciBjOzI+YXJndW1lbnRzLmxlbmd0aCYmXG4oYj1hLGE9cyk7RCYmKGM9bGIpO3JldHVybiBwKGEsYixjKX12YXIgSSx4LHYsQSxSLEgsbGI9e30sZGE7ST1jPT09Zz9kOlViKGQsbmV3IEhiKHkoZyksZC4kYXR0cikpO3g9SS4kJGVsZW1lbnQ7aWYoUSl7dmFyIFQ9L15cXHMqKFtAPSZdKShcXD8/KVxccyooXFx3KilcXHMqJC87Zj15KGcpO0g9ZS4kbmV3KCEwKTtpYSYmaWE9PT1RLiQkb3JpZ2luYWxEaXJlY3RpdmU/Zi5kYXRhKFwiJGlzb2xhdGVTY29wZVwiLEgpOmYuZGF0YShcIiRpc29sYXRlU2NvcGVOb1RlbXBsYXRlXCIsSCk7bWEoZixcIm5nLWlzb2xhdGUtc2NvcGVcIik7cShRLnNjb3BlLGZ1bmN0aW9uKGEsYyl7dmFyIGQ9YS5tYXRjaChUKXx8W10sZz1kWzNdfHxjLGY9XCI/XCI9PWRbMl0sZD1kWzFdLGwsbSxuLHA7SC4kJGlzb2xhdGVCaW5kaW5nc1tjXT1kK2c7c3dpdGNoKGQpe2Nhc2UgXCJAXCI6SS4kb2JzZXJ2ZShnLGZ1bmN0aW9uKGEpe0hbY109YX0pO0kuJCRvYnNlcnZlcnNbZ10uJCRzY29wZT1lO0lbZ10mJihIW2NdPWIoSVtnXSkoZSkpO1xuYnJlYWs7Y2FzZSBcIj1cIjppZihmJiYhSVtnXSlicmVhazttPXIoSVtnXSk7cD1tLmxpdGVyYWw/eGE6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT09PWJ9O249bS5hc3NpZ258fGZ1bmN0aW9uKCl7bD1IW2NdPW0oZSk7dGhyb3cgamEoXCJub25hc3NpZ25cIixJW2ddLFEubmFtZSk7fTtsPUhbY109bShlKTtILiR3YXRjaChmdW5jdGlvbigpe3ZhciBhPW0oZSk7cChhLEhbY10pfHwocChhLGwpP24oZSxhPUhbY10pOkhbY109YSk7cmV0dXJuIGw9YX0sbnVsbCxtLmxpdGVyYWwpO2JyZWFrO2Nhc2UgXCImXCI6bT1yKElbZ10pO0hbY109ZnVuY3Rpb24oYSl7cmV0dXJuIG0oZSxhKX07YnJlYWs7ZGVmYXVsdDp0aHJvdyBqYShcImlzY3BcIixRLm5hbWUsYyxhKTt9fSl9ZGE9cCYmdTtMJiZxKEwsZnVuY3Rpb24oYSl7dmFyIGI9eyRzY29wZTphPT09UXx8YS4kJGlzb2xhdGVTY29wZT9IOmUsJGVsZW1lbnQ6eCwkYXR0cnM6SSwkdHJhbnNjbHVkZTpkYX0sYztSPWEuY29udHJvbGxlcjtcIkBcIj09UiYmKFI9XG5JW2EubmFtZV0pO2M9eihSLGIpO2xiW2EubmFtZV09YztEfHx4LmRhdGEoXCIkXCIrYS5uYW1lK1wiQ29udHJvbGxlclwiLGMpO2EuY29udHJvbGxlckFzJiYoYi4kc2NvcGVbYS5jb250cm9sbGVyQXNdPWMpfSk7Zj0wO2Zvcih2PWwubGVuZ3RoO2Y8djtmKyspdHJ5e0E9bFtmXSxBKEEuaXNvbGF0ZVNjb3BlP0g6ZSx4LEksQS5yZXF1aXJlJiZGKEEucmVxdWlyZSx4LGxiKSxkYSl9Y2F0Y2goRyl7bShHLGhhKHgpKX1mPWU7USYmKFEudGVtcGxhdGV8fG51bGw9PT1RLnRlbXBsYXRlVXJsKSYmKGY9SCk7YSYmYShmLGcuY2hpbGROb2RlcyxzLHApO2ZvcihmPW4ubGVuZ3RoLTE7MDw9ZjtmLS0pdHJ5e0E9bltmXSxBKEEuaXNvbGF0ZVNjb3BlP0g6ZSx4LEksQS5yZXF1aXJlJiZGKEEucmVxdWlyZSx4LGxiKSxkYSl9Y2F0Y2goQil7bShCLGhhKHgpKX19cD1wfHx7fTtmb3IodmFyIHY9LU51bWJlci5NQVhfVkFMVUUsQSxMPXAuY29udHJvbGxlckRpcmVjdGl2ZXMsUT1wLm5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZSxcbmlhPXAudGVtcGxhdGVEaXJlY3RpdmUsVD1wLm5vblRsYlRyYW5zY2x1ZGVEaXJlY3RpdmUsRT0hMSxEPXAuaGFzRWxlbWVudFRyYW5zY2x1ZGVEaXJlY3RpdmUsWj1kLiQkZWxlbWVudD15KGMpLEcsdCxWLFhhPWUsTyxOPTAsUz1hLmxlbmd0aDtOPFM7TisrKXtHPWFbTl07dmFyIHJhPUcuJCRzdGFydCxXPUcuJCRlbmQ7cmEmJihaPUgoYyxyYSxXKSk7Vj1zO2lmKHY+Ry5wcmlvcml0eSlicmVhaztpZihWPUcuc2NvcGUpQT1BfHxHLEcudGVtcGxhdGVVcmx8fChLKFwibmV3L2lzb2xhdGVkIHNjb3BlXCIsUSxHLFopLFgoVikmJihRPUcpKTt0PUcubmFtZTshRy50ZW1wbGF0ZVVybCYmRy5jb250cm9sbGVyJiYoVj1HLmNvbnRyb2xsZXIsTD1MfHx7fSxLKFwiJ1wiK3QrXCInIGNvbnRyb2xsZXJcIixMW3RdLEcsWiksTFt0XT1HKTtpZihWPUcudHJhbnNjbHVkZSlFPSEwLEcuJCR0bGJ8fChLKFwidHJhbnNjbHVzaW9uXCIsVCxHLFopLFQ9RyksXCJlbGVtZW50XCI9PVY/KEQ9ITAsdj1HLnByaW9yaXR5LFxuVj1IKGMscmEsVyksWj1kLiQkZWxlbWVudD15KFUuY3JlYXRlQ29tbWVudChcIiBcIit0K1wiOiBcIitkW3RdK1wiIFwiKSksYz1aWzBdLG1iKGcseSh5YS5jYWxsKFYsMCkpLGMpLFhhPXgoVixlLHYsZiYmZi5uYW1lLHtub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlOlR9KSk6KFY9eShFYihjKSkuY29udGVudHMoKSxaLmVtcHR5KCksWGE9eChWLGUpKTtpZihHLnRlbXBsYXRlKWlmKEsoXCJ0ZW1wbGF0ZVwiLGlhLEcsWiksaWE9RyxWPVAoRy50ZW1wbGF0ZSk/Ry50ZW1wbGF0ZShaLGQpOkcudGVtcGxhdGUsVj1ZKFYpLEcucmVwbGFjZSl7Zj1HO1Y9Q2IudGVzdChWKT95KFYpOltdO2M9VlswXTtpZigxIT1WLmxlbmd0aHx8MSE9PWMubm9kZVR5cGUpdGhyb3cgamEoXCJ0cGxydFwiLHQsXCJcIik7bWIoZyxaLGMpO1M9eyRhdHRyOnt9fTtWPWRhKGMsW10sUyk7dmFyICQ9YS5zcGxpY2UoTisxLGEubGVuZ3RoLShOKzEpKTtRJiZwYyhWKTthPWEuY29uY2F0KFYpLmNvbmNhdCgkKTtCKGQsUyk7Uz1hLmxlbmd0aH1lbHNlIFouaHRtbChWKTtcbmlmKEcudGVtcGxhdGVVcmwpSyhcInRlbXBsYXRlXCIsaWEsRyxaKSxpYT1HLEcucmVwbGFjZSYmKGY9RyksSj1DKGEuc3BsaWNlKE4sYS5sZW5ndGgtTiksWixkLGcsWGEsbCxuLHtjb250cm9sbGVyRGlyZWN0aXZlczpMLG5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZTpRLHRlbXBsYXRlRGlyZWN0aXZlOmlhLG5vblRsYlRyYW5zY2x1ZGVEaXJlY3RpdmU6VH0pLFM9YS5sZW5ndGg7ZWxzZSBpZihHLmNvbXBpbGUpdHJ5e089Ry5jb21waWxlKFosZCxYYSksUChPKT91KG51bGwsTyxyYSxXKTpPJiZ1KE8ucHJlLE8ucG9zdCxyYSxXKX1jYXRjaChhYSl7bShhYSxoYShaKSl9Ry50ZXJtaW5hbCYmKEoudGVybWluYWw9ITAsdj1NYXRoLm1heCh2LEcucHJpb3JpdHkpKX1KLnNjb3BlPUEmJiEwPT09QS5zY29wZTtKLnRyYW5zY2x1ZGU9RSYmWGE7cC5oYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZT1EO3JldHVybiBKfWZ1bmN0aW9uIHBjKGEpe2Zvcih2YXIgYj0wLGM9YS5sZW5ndGg7YjxjO2IrKylhW2JdPVxuVGIoYVtiXSx7JCRpc29sYXRlU2NvcGU6ITB9KX1mdW5jdGlvbiBUKGIsZSxnLGYsayxuLHIpe2lmKGU9PT1rKXJldHVybiBudWxsO2s9bnVsbDtpZihjLmhhc093blByb3BlcnR5KGUpKXt2YXIgcDtlPWEuZ2V0KGUrZCk7Zm9yKHZhciB6PTAsdT1lLmxlbmd0aDt6PHU7eisrKXRyeXtwPWVbel0sKGY9PT1zfHxmPnAucHJpb3JpdHkpJiYtMSE9cC5yZXN0cmljdC5pbmRleE9mKGcpJiYobiYmKHA9VGIocCx7JCRzdGFydDpuLCQkZW5kOnJ9KSksYi5wdXNoKHApLGs9cCl9Y2F0Y2goRil7bShGKX19cmV0dXJuIGt9ZnVuY3Rpb24gQihhLGIpe3ZhciBjPWIuJGF0dHIsZD1hLiRhdHRyLGU9YS4kJGVsZW1lbnQ7cShhLGZ1bmN0aW9uKGQsZSl7XCIkXCIhPWUuY2hhckF0KDApJiYoYltlXSYmKGQrPShcInN0eWxlXCI9PT1lP1wiO1wiOlwiIFwiKStiW2VdKSxhLiRzZXQoZSxkLCEwLGNbZV0pKX0pO3EoYixmdW5jdGlvbihiLGcpe1wiY2xhc3NcIj09Zz8obWEoZSxiKSxhW1wiY2xhc3NcIl09KGFbXCJjbGFzc1wiXT9cbmFbXCJjbGFzc1wiXStcIiBcIjpcIlwiKStiKTpcInN0eWxlXCI9PWc/KGUuYXR0cihcInN0eWxlXCIsZS5hdHRyKFwic3R5bGVcIikrXCI7XCIrYiksYS5zdHlsZT0oYS5zdHlsZT9hLnN0eWxlK1wiO1wiOlwiXCIpK2IpOlwiJFwiPT1nLmNoYXJBdCgwKXx8YS5oYXNPd25Qcm9wZXJ0eShnKXx8KGFbZ109YixkW2ddPWNbZ10pfSl9ZnVuY3Rpb24gQyhhLGIsYyxkLGUsZyxmLGwpe3ZhciBrPVtdLG0scix6PWJbMF0sdT1hLnNoaWZ0KCksRj1EKHt9LHUse3RlbXBsYXRlVXJsOm51bGwsdHJhbnNjbHVkZTpudWxsLHJlcGxhY2U6bnVsbCwkJG9yaWdpbmFsRGlyZWN0aXZlOnV9KSx4PVAodS50ZW1wbGF0ZVVybCk/dS50ZW1wbGF0ZVVybChiLGMpOnUudGVtcGxhdGVVcmw7Yi5lbXB0eSgpO24uZ2V0KHYuZ2V0VHJ1c3RlZFJlc291cmNlVXJsKHgpLHtjYWNoZTpwfSkuc3VjY2VzcyhmdW5jdGlvbihuKXt2YXIgcCxKO249WShuKTtpZih1LnJlcGxhY2Upe249Q2IudGVzdChuKT95KG4pOltdO3A9blswXTtpZigxIT1uLmxlbmd0aHx8XG4xIT09cC5ub2RlVHlwZSl0aHJvdyBqYShcInRwbHJ0XCIsdS5uYW1lLHgpO249eyRhdHRyOnt9fTttYihkLGIscCk7dmFyIHY9ZGEocCxbXSxuKTtYKHUuc2NvcGUpJiZwYyh2KTthPXYuY29uY2F0KGEpO0IoYyxuKX1lbHNlIHA9eixiLmh0bWwobik7YS51bnNoaWZ0KEYpO209aWEoYSxwLGMsZSxiLHUsZyxmLGwpO3EoZCxmdW5jdGlvbihhLGMpe2E9PXAmJihkW2NdPWJbMF0pfSk7Zm9yKHI9TChiWzBdLmNoaWxkTm9kZXMsZSk7ay5sZW5ndGg7KXtuPWsuc2hpZnQoKTtKPWsuc2hpZnQoKTt2YXIgQT1rLnNoaWZ0KCksUj1rLnNoaWZ0KCksdj1iWzBdO2lmKEohPT16KXt2YXIgSD1KLmNsYXNzTmFtZTtsLmhhc0VsZW1lbnRUcmFuc2NsdWRlRGlyZWN0aXZlJiZ1LnJlcGxhY2V8fCh2PUViKHApKTttYihBLHkoSiksdik7bWEoeSh2KSxIKX1KPW0udHJhbnNjbHVkZT9RKG4sbS50cmFuc2NsdWRlKTpSO20ocixuLHYsZCxKKX1rPW51bGx9KS5lcnJvcihmdW5jdGlvbihhLGIsYyxkKXt0aHJvdyBqYShcInRwbG9hZFwiLFxuZC51cmwpO30pO3JldHVybiBmdW5jdGlvbihhLGIsYyxkLGUpe2s/KGsucHVzaChiKSxrLnB1c2goYyksay5wdXNoKGQpLGsucHVzaChlKSk6bShyLGIsYyxkLGUpfX1mdW5jdGlvbiBFKGEsYil7dmFyIGM9Yi5wcmlvcml0eS1hLnByaW9yaXR5O3JldHVybiAwIT09Yz9jOmEubmFtZSE9PWIubmFtZT9hLm5hbWU8Yi5uYW1lPy0xOjE6YS5pbmRleC1iLmluZGV4fWZ1bmN0aW9uIEsoYSxiLGMsZCl7aWYoYil0aHJvdyBqYShcIm11bHRpZGlyXCIsYi5uYW1lLGMubmFtZSxhLGhhKGQpKTt9ZnVuY3Rpb24gdChhLGMpe3ZhciBkPWIoYywhMCk7ZCYmYS5wdXNoKHtwcmlvcml0eTowLGNvbXBpbGU6YWEoZnVuY3Rpb24oYSxiKXt2YXIgYz1iLnBhcmVudCgpLGU9Yy5kYXRhKFwiJGJpbmRpbmdcIil8fFtdO2UucHVzaChkKTttYShjLmRhdGEoXCIkYmluZGluZ1wiLGUpLFwibmctYmluZGluZ1wiKTthLiR3YXRjaChkLGZ1bmN0aW9uKGEpe2JbMF0ubm9kZVZhbHVlPWF9KX0pfSl9ZnVuY3Rpb24gTyhhLGIpe2lmKFwic3JjZG9jXCI9PVxuYilyZXR1cm4gdi5IVE1MO3ZhciBjPUthKGEpO2lmKFwieGxpbmtIcmVmXCI9PWJ8fFwiRk9STVwiPT1jJiZcImFjdGlvblwiPT1ifHxcIklNR1wiIT1jJiYoXCJzcmNcIj09Ynx8XCJuZ1NyY1wiPT1iKSlyZXR1cm4gdi5SRVNPVVJDRV9VUkx9ZnVuY3Rpb24gTihhLGMsZCxlKXt2YXIgZz1iKGQsITApO2lmKGcpe2lmKFwibXVsdGlwbGVcIj09PWUmJlwiU0VMRUNUXCI9PT1LYShhKSl0aHJvdyBqYShcInNlbG11bHRpXCIsaGEoYSkpO2MucHVzaCh7cHJpb3JpdHk6MTAwLGNvbXBpbGU6ZnVuY3Rpb24oKXtyZXR1cm57cHJlOmZ1bmN0aW9uKGMsZCxsKXtkPWwuJCRvYnNlcnZlcnN8fChsLiQkb2JzZXJ2ZXJzPXt9KTtpZihmLnRlc3QoZSkpdGhyb3cgamEoXCJub2RvbWV2ZW50c1wiKTtpZihnPWIobFtlXSwhMCxPKGEsZSkpKWxbZV09ZyhjKSwoZFtlXXx8KGRbZV09W10pKS4kJGludGVyPSEwLChsLiQkb2JzZXJ2ZXJzJiZsLiQkb2JzZXJ2ZXJzW2VdLiQkc2NvcGV8fGMpLiR3YXRjaChnLGZ1bmN0aW9uKGEsYil7XCJjbGFzc1wiPT09XG5lJiZhIT1iP2wuJHVwZGF0ZUNsYXNzKGEsYik6bC4kc2V0KGUsYSl9KX19fX0pfX1mdW5jdGlvbiBtYihhLGIsYyl7dmFyIGQ9YlswXSxlPWIubGVuZ3RoLGc9ZC5wYXJlbnROb2RlLGYsbDtpZihhKWZvcihmPTAsbD1hLmxlbmd0aDtmPGw7ZisrKWlmKGFbZl09PWQpe2FbZisrXT1jO2w9ZitlLTE7Zm9yKHZhciBrPWEubGVuZ3RoO2Y8aztmKyssbCsrKWw8az9hW2ZdPWFbbF06ZGVsZXRlIGFbZl07YS5sZW5ndGgtPWUtMTticmVha31nJiZnLnJlcGxhY2VDaGlsZChjLGQpO2E9VS5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7YS5hcHBlbmRDaGlsZChkKTtjW3kuZXhwYW5kb109ZFt5LmV4cGFuZG9dO2Q9MTtmb3IoZT1iLmxlbmd0aDtkPGU7ZCsrKWc9YltkXSx5KGcpLnJlbW92ZSgpLGEuYXBwZW5kQ2hpbGQoZyksZGVsZXRlIGJbZF07YlswXT1jO2IubGVuZ3RoPTF9ZnVuY3Rpb24gcWMoYSxiKXtyZXR1cm4gRChmdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sXG5hLGIpfXZhciBIYj1mdW5jdGlvbihhLGIpe3RoaXMuJCRlbGVtZW50PWE7dGhpcy4kYXR0cj1ifHx7fX07SGIucHJvdG90eXBlPXskbm9ybWFsaXplOm5hLCRhZGRDbGFzczpmdW5jdGlvbihhKXthJiYwPGEubGVuZ3RoJiZKLmFkZENsYXNzKHRoaXMuJCRlbGVtZW50LGEpfSwkcmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oYSl7YSYmMDxhLmxlbmd0aCYmSi5yZW1vdmVDbGFzcyh0aGlzLiQkZWxlbWVudCxhKX0sJHVwZGF0ZUNsYXNzOmZ1bmN0aW9uKGEsYil7dmFyIGM9cmMoYSxiKSxkPXJjKGIsYSk7MD09PWMubGVuZ3RoP0oucmVtb3ZlQ2xhc3ModGhpcy4kJGVsZW1lbnQsZCk6MD09PWQubGVuZ3RoP0ouYWRkQ2xhc3ModGhpcy4kJGVsZW1lbnQsYyk6Si5zZXRDbGFzcyh0aGlzLiQkZWxlbWVudCxjLGQpfSwkc2V0OmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPW1jKHRoaXMuJCRlbGVtZW50WzBdLGEpO2UmJih0aGlzLiQkZWxlbWVudC5wcm9wKGEsYiksZD1lKTt0aGlzW2FdPWI7ZD90aGlzLiRhdHRyW2FdPVxuZDooZD10aGlzLiRhdHRyW2FdKXx8KHRoaXMuJGF0dHJbYV09ZD1mYihhLFwiLVwiKSk7ZT1LYSh0aGlzLiQkZWxlbWVudCk7aWYoXCJBXCI9PT1lJiZcImhyZWZcIj09PWF8fFwiSU1HXCI9PT1lJiZcInNyY1wiPT09YSl0aGlzW2FdPWI9QShiLFwic3JjXCI9PT1hKTshMSE9PWMmJihudWxsPT09Ynx8Yj09PXM/dGhpcy4kJGVsZW1lbnQucmVtb3ZlQXR0cihkKTp0aGlzLiQkZWxlbWVudC5hdHRyKGQsYikpOyhjPXRoaXMuJCRvYnNlcnZlcnMpJiZxKGNbYV0sZnVuY3Rpb24oYSl7dHJ5e2EoYil9Y2F0Y2goYyl7bShjKX19KX0sJG9ic2VydmU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yy4kJG9ic2VydmVyc3x8KGMuJCRvYnNlcnZlcnM9e30pLGU9ZFthXXx8KGRbYV09W10pO2UucHVzaChiKTt1LiRldmFsQXN5bmMoZnVuY3Rpb24oKXtlLiQkaW50ZXJ8fGIoY1thXSl9KTtyZXR1cm4gYn19O3ZhciBaPWIuc3RhcnRTeW1ib2woKSxyYT1iLmVuZFN5bWJvbCgpLFk9XCJ7e1wiPT1afHxcIn19XCI9PXJhP1xuRGE6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZSgvXFx7XFx7L2csWikucmVwbGFjZSgvfX0vZyxyYSl9LFc9L15uZ0F0dHJbQS1aXS87cmV0dXJuIHh9XX1mdW5jdGlvbiBuYShiKXtyZXR1cm4gVGEoYi5yZXBsYWNlKHRlLFwiXCIpKX1mdW5jdGlvbiByYyhiLGEpe3ZhciBjPVwiXCIsZD1iLnNwbGl0KC9cXHMrLyksZT1hLnNwbGl0KC9cXHMrLyksZz0wO2E6Zm9yKDtnPGQubGVuZ3RoO2crKyl7Zm9yKHZhciBmPWRbZ10saD0wO2g8ZS5sZW5ndGg7aCsrKWlmKGY9PWVbaF0pY29udGludWUgYTtjKz0oMDxjLmxlbmd0aD9cIiBcIjpcIlwiKStmfXJldHVybiBjfWZ1bmN0aW9uIE9kKCl7dmFyIGI9e30sYT0vXihcXFMrKShcXHMrYXNcXHMrKFxcdyspKT8kLzt0aGlzLnJlZ2lzdGVyPWZ1bmN0aW9uKGEsZCl7QWEoYSxcImNvbnRyb2xsZXJcIik7WChhKT9EKGIsYSk6YlthXT1kfTt0aGlzLiRnZXQ9W1wiJGluamVjdG9yXCIsXCIkd2luZG93XCIsZnVuY3Rpb24oYyxkKXtyZXR1cm4gZnVuY3Rpb24oZSxnKXt2YXIgZixcbmgsbDt3KGUpJiYoZj1lLm1hdGNoKGEpLGg9ZlsxXSxsPWZbM10sZT1iLmhhc093blByb3BlcnR5KGgpP2JbaF06YmMoZy4kc2NvcGUsaCwhMCl8fGJjKGQsaCwhMCksUmEoZSxoLCEwKSk7Zj1jLmluc3RhbnRpYXRlKGUsZyk7aWYobCl7aWYoIWd8fFwib2JqZWN0XCIhPXR5cGVvZiBnLiRzY29wZSl0aHJvdyB0KFwiJGNvbnRyb2xsZXJcIikoXCJub3NjcFwiLGh8fGUubmFtZSxsKTtnLiRzY29wZVtsXT1mfXJldHVybiBmfX1dfWZ1bmN0aW9uIFBkKCl7dGhpcy4kZ2V0PVtcIiR3aW5kb3dcIixmdW5jdGlvbihiKXtyZXR1cm4geShiLmRvY3VtZW50KX1dfWZ1bmN0aW9uIFFkKCl7dGhpcy4kZ2V0PVtcIiRsb2dcIixmdW5jdGlvbihiKXtyZXR1cm4gZnVuY3Rpb24oYSxjKXtiLmVycm9yLmFwcGx5KGIsYXJndW1lbnRzKX19XX1mdW5jdGlvbiBzYyhiKXt2YXIgYT17fSxjLGQsZTtpZighYilyZXR1cm4gYTtxKGIuc3BsaXQoXCJcXG5cIiksZnVuY3Rpb24oYil7ZT1iLmluZGV4T2YoXCI6XCIpO2M9SyhjYShiLnN1YnN0cigwLFxuZSkpKTtkPWNhKGIuc3Vic3RyKGUrMSkpO2MmJihhW2NdPWFbY10/YVtjXSsoXCIsIFwiK2QpOmQpfSk7cmV0dXJuIGF9ZnVuY3Rpb24gdGMoYil7dmFyIGE9WChiKT9iOnM7cmV0dXJuIGZ1bmN0aW9uKGMpe2F8fChhPXNjKGIpKTtyZXR1cm4gYz9hW0soYyldfHxudWxsOmF9fWZ1bmN0aW9uIHVjKGIsYSxjKXtpZihQKGMpKXJldHVybiBjKGIsYSk7cShjLGZ1bmN0aW9uKGMpe2I9YyhiLGEpfSk7cmV0dXJuIGJ9ZnVuY3Rpb24gVGQoKXt2YXIgYj0vXlxccyooXFxbfFxce1teXFx7XSkvLGE9L1tcXH1cXF1dXFxzKiQvLGM9L15cXClcXF1cXH0nLD9cXG4vLGQ9e1wiQ29udGVudC1UeXBlXCI6XCJhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLThcIn0sZT10aGlzLmRlZmF1bHRzPXt0cmFuc2Zvcm1SZXNwb25zZTpbZnVuY3Rpb24oZCl7dyhkKSYmKGQ9ZC5yZXBsYWNlKGMsXCJcIiksYi50ZXN0KGQpJiZhLnRlc3QoZCkmJihkPVdiKGQpKSk7cmV0dXJuIGR9XSx0cmFuc2Zvcm1SZXF1ZXN0OltmdW5jdGlvbihhKXtyZXR1cm4gWChhKSYmXG5cIltvYmplY3QgRmlsZV1cIiE9PXdhLmNhbGwoYSkmJlwiW29iamVjdCBCbG9iXVwiIT09d2EuY2FsbChhKT9xYShhKTphfV0saGVhZGVyczp7Y29tbW9uOntBY2NlcHQ6XCJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLypcIn0scG9zdDpiYShkKSxwdXQ6YmEoZCkscGF0Y2g6YmEoZCl9LHhzcmZDb29raWVOYW1lOlwiWFNSRi1UT0tFTlwiLHhzcmZIZWFkZXJOYW1lOlwiWC1YU1JGLVRPS0VOXCJ9LGc9dGhpcy5pbnRlcmNlcHRvcnM9W10sZj10aGlzLnJlc3BvbnNlSW50ZXJjZXB0b3JzPVtdO3RoaXMuJGdldD1bXCIkaHR0cEJhY2tlbmRcIixcIiRicm93c2VyXCIsXCIkY2FjaGVGYWN0b3J5XCIsXCIkcm9vdFNjb3BlXCIsXCIkcVwiLFwiJGluamVjdG9yXCIsZnVuY3Rpb24oYSxiLGMsZCxuLHApe2Z1bmN0aW9uIHIoYSl7ZnVuY3Rpb24gYyhhKXt2YXIgYj1EKHt9LGEse2RhdGE6dWMoYS5kYXRhLGEuaGVhZGVycyxkLnRyYW5zZm9ybVJlc3BvbnNlKX0pO3JldHVybiAyMDA8PWEuc3RhdHVzJiYzMDA+YS5zdGF0dXM/XG5iOm4ucmVqZWN0KGIpfXZhciBkPXttZXRob2Q6XCJnZXRcIix0cmFuc2Zvcm1SZXF1ZXN0OmUudHJhbnNmb3JtUmVxdWVzdCx0cmFuc2Zvcm1SZXNwb25zZTplLnRyYW5zZm9ybVJlc3BvbnNlfSxnPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYSl7dmFyIGM7cShhLGZ1bmN0aW9uKGIsZCl7UChiKSYmKGM9YigpLG51bGwhPWM/YVtkXT1jOmRlbGV0ZSBhW2RdKX0pfXZhciBjPWUuaGVhZGVycyxkPUQoe30sYS5oZWFkZXJzKSxnLGYsYz1EKHt9LGMuY29tbW9uLGNbSyhhLm1ldGhvZCldKTtiKGMpO2IoZCk7YTpmb3IoZyBpbiBjKXthPUsoZyk7Zm9yKGYgaW4gZClpZihLKGYpPT09YSljb250aW51ZSBhO2RbZ109Y1tnXX1yZXR1cm4gZH0oYSk7RChkLGEpO2QuaGVhZGVycz1nO2QubWV0aG9kPUZhKGQubWV0aG9kKTsoYT1JYihkLnVybCk/Yi5jb29raWVzKClbZC54c3JmQ29va2llTmFtZXx8ZS54c3JmQ29va2llTmFtZV06cykmJihnW2QueHNyZkhlYWRlck5hbWV8fGUueHNyZkhlYWRlck5hbWVdPVxuYSk7dmFyIGY9W2Z1bmN0aW9uKGEpe2c9YS5oZWFkZXJzO3ZhciBiPXVjKGEuZGF0YSx0YyhnKSxhLnRyYW5zZm9ybVJlcXVlc3QpO0UoYS5kYXRhKSYmcShnLGZ1bmN0aW9uKGEsYil7XCJjb250ZW50LXR5cGVcIj09PUsoYikmJmRlbGV0ZSBnW2JdfSk7RShhLndpdGhDcmVkZW50aWFscykmJiFFKGUud2l0aENyZWRlbnRpYWxzKSYmKGEud2l0aENyZWRlbnRpYWxzPWUud2l0aENyZWRlbnRpYWxzKTtyZXR1cm4geihhLGIsZykudGhlbihjLGMpfSxzXSxoPW4ud2hlbihkKTtmb3IocSh2LGZ1bmN0aW9uKGEpeyhhLnJlcXVlc3R8fGEucmVxdWVzdEVycm9yKSYmZi51bnNoaWZ0KGEucmVxdWVzdCxhLnJlcXVlc3RFcnJvcik7KGEucmVzcG9uc2V8fGEucmVzcG9uc2VFcnJvcikmJmYucHVzaChhLnJlc3BvbnNlLGEucmVzcG9uc2VFcnJvcil9KTtmLmxlbmd0aDspe2E9Zi5zaGlmdCgpO3ZhciBrPWYuc2hpZnQoKSxoPWgudGhlbihhLGspfWguc3VjY2Vzcz1mdW5jdGlvbihhKXtoLnRoZW4oZnVuY3Rpb24oYil7YShiLmRhdGEsXG5iLnN0YXR1cyxiLmhlYWRlcnMsZCl9KTtyZXR1cm4gaH07aC5lcnJvcj1mdW5jdGlvbihhKXtoLnRoZW4obnVsbCxmdW5jdGlvbihiKXthKGIuZGF0YSxiLnN0YXR1cyxiLmhlYWRlcnMsZCl9KTtyZXR1cm4gaH07cmV0dXJuIGh9ZnVuY3Rpb24geihiLGMsZyl7ZnVuY3Rpb24gZihhLGIsYyxlKXt2JiYoMjAwPD1hJiYzMDA+YT92LnB1dChzLFthLGIsc2MoYyksZV0pOnYucmVtb3ZlKHMpKTtsKGIsYSxjLGUpO2QuJCRwaGFzZXx8ZC4kYXBwbHkoKX1mdW5jdGlvbiBsKGEsYyxkLGUpe2M9TWF0aC5tYXgoYywwKTsoMjAwPD1jJiYzMDA+Yz9wLnJlc29sdmU6cC5yZWplY3QpKHtkYXRhOmEsc3RhdHVzOmMsaGVhZGVyczp0YyhkKSxjb25maWc6YixzdGF0dXNUZXh0OmV9KX1mdW5jdGlvbiBrKCl7dmFyIGE9ZGIoci5wZW5kaW5nUmVxdWVzdHMsYik7LTEhPT1hJiZyLnBlbmRpbmdSZXF1ZXN0cy5zcGxpY2UoYSwxKX12YXIgcD1uLmRlZmVyKCksej1wLnByb21pc2UsdixxLHM9dShiLnVybCxcbmIucGFyYW1zKTtyLnBlbmRpbmdSZXF1ZXN0cy5wdXNoKGIpO3oudGhlbihrLGspOyhiLmNhY2hlfHxlLmNhY2hlKSYmKCExIT09Yi5jYWNoZSYmXCJHRVRcIj09Yi5tZXRob2QpJiYodj1YKGIuY2FjaGUpP2IuY2FjaGU6WChlLmNhY2hlKT9lLmNhY2hlOkYpO2lmKHYpaWYocT12LmdldChzKSxCKHEpKXtpZihxLnRoZW4pcmV0dXJuIHEudGhlbihrLGspLHE7TShxKT9sKHFbMV0scVswXSxiYShxWzJdKSxxWzNdKTpsKHEsMjAwLHt9LFwiT0tcIil9ZWxzZSB2LnB1dChzLHopO0UocSkmJmEoYi5tZXRob2QscyxjLGYsZyxiLnRpbWVvdXQsYi53aXRoQ3JlZGVudGlhbHMsYi5yZXNwb25zZVR5cGUpO3JldHVybiB6fWZ1bmN0aW9uIHUoYSxiKXtpZighYilyZXR1cm4gYTt2YXIgYz1bXTtTYyhiLGZ1bmN0aW9uKGEsYil7bnVsbD09PWF8fEUoYSl8fChNKGEpfHwoYT1bYV0pLHEoYSxmdW5jdGlvbihhKXtYKGEpJiYoYT1xYShhKSk7Yy5wdXNoKHphKGIpK1wiPVwiK3phKGEpKX0pKX0pOzA8Yy5sZW5ndGgmJlxuKGErPSgtMT09YS5pbmRleE9mKFwiP1wiKT9cIj9cIjpcIiZcIikrYy5qb2luKFwiJlwiKSk7cmV0dXJuIGF9dmFyIEY9YyhcIiRodHRwXCIpLHY9W107cShnLGZ1bmN0aW9uKGEpe3YudW5zaGlmdCh3KGEpP3AuZ2V0KGEpOnAuaW52b2tlKGEpKX0pO3EoZixmdW5jdGlvbihhLGIpe3ZhciBjPXcoYSk/cC5nZXQoYSk6cC5pbnZva2UoYSk7di5zcGxpY2UoYiwwLHtyZXNwb25zZTpmdW5jdGlvbihhKXtyZXR1cm4gYyhuLndoZW4oYSkpfSxyZXNwb25zZUVycm9yOmZ1bmN0aW9uKGEpe3JldHVybiBjKG4ucmVqZWN0KGEpKX19KX0pO3IucGVuZGluZ1JlcXVlc3RzPVtdOyhmdW5jdGlvbihhKXtxKGFyZ3VtZW50cyxmdW5jdGlvbihhKXtyW2FdPWZ1bmN0aW9uKGIsYyl7cmV0dXJuIHIoRChjfHx7fSx7bWV0aG9kOmEsdXJsOmJ9KSl9fSl9KShcImdldFwiLFwiZGVsZXRlXCIsXCJoZWFkXCIsXCJqc29ucFwiKTsoZnVuY3Rpb24oYSl7cShhcmd1bWVudHMsZnVuY3Rpb24oYSl7clthXT1mdW5jdGlvbihiLGMsZCl7cmV0dXJuIHIoRChkfHxcbnt9LHttZXRob2Q6YSx1cmw6YixkYXRhOmN9KSl9fSl9KShcInBvc3RcIixcInB1dFwiKTtyLmRlZmF1bHRzPWU7cmV0dXJuIHJ9XX1mdW5jdGlvbiB1ZShiKXtpZig4Pj1TJiYoIWIubWF0Y2goL14oZ2V0fHBvc3R8aGVhZHxwdXR8ZGVsZXRlfG9wdGlvbnMpJC9pKXx8IU8uWE1MSHR0cFJlcXVlc3QpKXJldHVybiBuZXcgTy5BY3RpdmVYT2JqZWN0KFwiTWljcm9zb2Z0LlhNTEhUVFBcIik7aWYoTy5YTUxIdHRwUmVxdWVzdClyZXR1cm4gbmV3IE8uWE1MSHR0cFJlcXVlc3Q7dGhyb3cgdChcIiRodHRwQmFja2VuZFwiKShcIm5veGhyXCIpO31mdW5jdGlvbiBVZCgpe3RoaXMuJGdldD1bXCIkYnJvd3NlclwiLFwiJHdpbmRvd1wiLFwiJGRvY3VtZW50XCIsZnVuY3Rpb24oYixhLGMpe3JldHVybiB2ZShiLHVlLGIuZGVmZXIsYS5hbmd1bGFyLmNhbGxiYWNrcyxjWzBdKX1dfWZ1bmN0aW9uIHZlKGIsYSxjLGQsZSl7ZnVuY3Rpb24gZyhhLGIpe3ZhciBjPWUuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKSxkPWZ1bmN0aW9uKCl7Yy5vbnJlYWR5c3RhdGVjaGFuZ2U9XG5jLm9ubG9hZD1jLm9uZXJyb3I9bnVsbDtlLmJvZHkucmVtb3ZlQ2hpbGQoYyk7YiYmYigpfTtjLnR5cGU9XCJ0ZXh0L2phdmFzY3JpcHRcIjtjLnNyYz1hO1MmJjg+PVM/Yy5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXsvbG9hZGVkfGNvbXBsZXRlLy50ZXN0KGMucmVhZHlTdGF0ZSkmJmQoKX06Yy5vbmxvYWQ9Yy5vbmVycm9yPWZ1bmN0aW9uKCl7ZCgpfTtlLmJvZHkuYXBwZW5kQ2hpbGQoYyk7cmV0dXJuIGR9dmFyIGY9LTE7cmV0dXJuIGZ1bmN0aW9uKGUsbCxrLG0sbixwLHIseil7ZnVuY3Rpb24gdSgpe3Y9ZjtBJiZBKCk7eCYmeC5hYm9ydCgpfWZ1bmN0aW9uIEYoYSxkLGUsZyxmKXtMJiZjLmNhbmNlbChMKTtBPXg9bnVsbDswPT09ZCYmKGQ9ZT8yMDA6XCJmaWxlXCI9PXNhKGwpLnByb3RvY29sPzQwNDowKTthKDEyMjM9PT1kPzIwNDpkLGUsZyxmfHxcIlwiKTtiLiQkY29tcGxldGVPdXRzdGFuZGluZ1JlcXVlc3QoQyl9dmFyIHY7Yi4kJGluY091dHN0YW5kaW5nUmVxdWVzdENvdW50KCk7XG5sPWx8fGIudXJsKCk7aWYoXCJqc29ucFwiPT1LKGUpKXt2YXIgSj1cIl9cIisoZC5jb3VudGVyKyspLnRvU3RyaW5nKDM2KTtkW0pdPWZ1bmN0aW9uKGEpe2RbSl0uZGF0YT1hfTt2YXIgQT1nKGwucmVwbGFjZShcIkpTT05fQ0FMTEJBQ0tcIixcImFuZ3VsYXIuY2FsbGJhY2tzLlwiK0opLGZ1bmN0aW9uKCl7ZFtKXS5kYXRhP0YobSwyMDAsZFtKXS5kYXRhKTpGKG0sdnx8LTIpO2RbSl09RWEubm9vcH0pfWVsc2V7dmFyIHg9YShlKTt4Lm9wZW4oZSxsLCEwKTtxKG4sZnVuY3Rpb24oYSxiKXtCKGEpJiZ4LnNldFJlcXVlc3RIZWFkZXIoYixhKX0pO3gub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7aWYoeCYmND09eC5yZWFkeVN0YXRlKXt2YXIgYT1udWxsLGI9bnVsbDt2IT09ZiYmKGE9eC5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSxiPVwicmVzcG9uc2VcImluIHg/eC5yZXNwb25zZTp4LnJlc3BvbnNlVGV4dCk7RihtLHZ8fHguc3RhdHVzLGIsYSx4LnN0YXR1c1RleHR8fFwiXCIpfX07ciYmKHgud2l0aENyZWRlbnRpYWxzPVxuITApO2lmKHopdHJ5e3gucmVzcG9uc2VUeXBlPXp9Y2F0Y2gocyl7aWYoXCJqc29uXCIhPT16KXRocm93IHM7fXguc2VuZChrfHxudWxsKX1pZigwPHApdmFyIEw9Yyh1LHApO2Vsc2UgcCYmcC50aGVuJiZwLnRoZW4odSl9fWZ1bmN0aW9uIFJkKCl7dmFyIGI9XCJ7e1wiLGE9XCJ9fVwiO3RoaXMuc3RhcnRTeW1ib2w9ZnVuY3Rpb24oYSl7cmV0dXJuIGE/KGI9YSx0aGlzKTpifTt0aGlzLmVuZFN5bWJvbD1mdW5jdGlvbihiKXtyZXR1cm4gYj8oYT1iLHRoaXMpOmF9O3RoaXMuJGdldD1bXCIkcGFyc2VcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsXCIkc2NlXCIsZnVuY3Rpb24oYyxkLGUpe2Z1bmN0aW9uIGcoZyxrLG0pe2Zvcih2YXIgbixwLHI9MCx6PVtdLHU9Zy5sZW5ndGgsRj0hMSx2PVtdO3I8dTspLTEhPShuPWcuaW5kZXhPZihiLHIpKSYmLTEhPShwPWcuaW5kZXhPZihhLG4rZikpPyhyIT1uJiZ6LnB1c2goZy5zdWJzdHJpbmcocixuKSksei5wdXNoKHI9YyhGPWcuc3Vic3RyaW5nKG4rZixwKSkpLFxuci5leHA9RixyPXAraCxGPSEwKToociE9dSYmei5wdXNoKGcuc3Vic3RyaW5nKHIpKSxyPXUpOyh1PXoubGVuZ3RoKXx8KHoucHVzaChcIlwiKSx1PTEpO2lmKG0mJjE8ei5sZW5ndGgpdGhyb3cgdmMoXCJub2NvbmNhdFwiLGcpO2lmKCFrfHxGKXJldHVybiB2Lmxlbmd0aD11LHI9ZnVuY3Rpb24oYSl7dHJ5e2Zvcih2YXIgYj0wLGM9dSxmO2I8YztiKyspXCJmdW5jdGlvblwiPT10eXBlb2YoZj16W2JdKSYmKGY9ZihhKSxmPW0/ZS5nZXRUcnVzdGVkKG0sZik6ZS52YWx1ZU9mKGYpLG51bGw9PT1mfHxFKGYpP2Y9XCJcIjpcInN0cmluZ1wiIT10eXBlb2YgZiYmKGY9cWEoZikpKSx2W2JdPWY7cmV0dXJuIHYuam9pbihcIlwiKX1jYXRjaChoKXthPXZjKFwiaW50ZXJyXCIsZyxoLnRvU3RyaW5nKCkpLGQoYSl9fSxyLmV4cD1nLHIucGFydHM9eixyfXZhciBmPWIubGVuZ3RoLGg9YS5sZW5ndGg7Zy5zdGFydFN5bWJvbD1mdW5jdGlvbigpe3JldHVybiBifTtnLmVuZFN5bWJvbD1mdW5jdGlvbigpe3JldHVybiBhfTtcbnJldHVybiBnfV19ZnVuY3Rpb24gU2QoKXt0aGlzLiRnZXQ9W1wiJHJvb3RTY29wZVwiLFwiJHdpbmRvd1wiLFwiJHFcIixmdW5jdGlvbihiLGEsYyl7ZnVuY3Rpb24gZChkLGYsaCxsKXt2YXIgaz1hLnNldEludGVydmFsLG09YS5jbGVhckludGVydmFsLG49Yy5kZWZlcigpLHA9bi5wcm9taXNlLHI9MCx6PUIobCkmJiFsO2g9QihoKT9oOjA7cC50aGVuKG51bGwsbnVsbCxkKTtwLiQkaW50ZXJ2YWxJZD1rKGZ1bmN0aW9uKCl7bi5ub3RpZnkocisrKTswPGgmJnI+PWgmJihuLnJlc29sdmUociksbShwLiQkaW50ZXJ2YWxJZCksZGVsZXRlIGVbcC4kJGludGVydmFsSWRdKTt6fHxiLiRhcHBseSgpfSxmKTtlW3AuJCRpbnRlcnZhbElkXT1uO3JldHVybiBwfXZhciBlPXt9O2QuY2FuY2VsPWZ1bmN0aW9uKGEpe3JldHVybiBhJiZhLiQkaW50ZXJ2YWxJZCBpbiBlPyhlW2EuJCRpbnRlcnZhbElkXS5yZWplY3QoXCJjYW5jZWxlZFwiKSxjbGVhckludGVydmFsKGEuJCRpbnRlcnZhbElkKSxkZWxldGUgZVthLiQkaW50ZXJ2YWxJZF0sXG4hMCk6ITF9O3JldHVybiBkfV19ZnVuY3Rpb24gYWQoKXt0aGlzLiRnZXQ9ZnVuY3Rpb24oKXtyZXR1cm57aWQ6XCJlbi11c1wiLE5VTUJFUl9GT1JNQVRTOntERUNJTUFMX1NFUDpcIi5cIixHUk9VUF9TRVA6XCIsXCIsUEFUVEVSTlM6W3ttaW5JbnQ6MSxtaW5GcmFjOjAsbWF4RnJhYzozLHBvc1ByZTpcIlwiLHBvc1N1ZjpcIlwiLG5lZ1ByZTpcIi1cIixuZWdTdWY6XCJcIixnU2l6ZTozLGxnU2l6ZTozfSx7bWluSW50OjEsbWluRnJhYzoyLG1heEZyYWM6Mixwb3NQcmU6XCJcXHUwMGE0XCIscG9zU3VmOlwiXCIsbmVnUHJlOlwiKFxcdTAwYTRcIixuZWdTdWY6XCIpXCIsZ1NpemU6MyxsZ1NpemU6M31dLENVUlJFTkNZX1NZTTpcIiRcIn0sREFURVRJTUVfRk9STUFUUzp7TU9OVEg6XCJKYW51YXJ5IEZlYnJ1YXJ5IE1hcmNoIEFwcmlsIE1heSBKdW5lIEp1bHkgQXVndXN0IFNlcHRlbWJlciBPY3RvYmVyIE5vdmVtYmVyIERlY2VtYmVyXCIuc3BsaXQoXCIgXCIpLFNIT1JUTU9OVEg6XCJKYW4gRmViIE1hciBBcHIgTWF5IEp1biBKdWwgQXVnIFNlcCBPY3QgTm92IERlY1wiLnNwbGl0KFwiIFwiKSxcbkRBWTpcIlN1bmRheSBNb25kYXkgVHVlc2RheSBXZWRuZXNkYXkgVGh1cnNkYXkgRnJpZGF5IFNhdHVyZGF5XCIuc3BsaXQoXCIgXCIpLFNIT1JUREFZOlwiU3VuIE1vbiBUdWUgV2VkIFRodSBGcmkgU2F0XCIuc3BsaXQoXCIgXCIpLEFNUE1TOltcIkFNXCIsXCJQTVwiXSxtZWRpdW06XCJNTU0gZCwgeSBoOm1tOnNzIGFcIixcInNob3J0XCI6XCJNL2QveXkgaDptbSBhXCIsZnVsbERhdGU6XCJFRUVFLCBNTU1NIGQsIHlcIixsb25nRGF0ZTpcIk1NTU0gZCwgeVwiLG1lZGl1bURhdGU6XCJNTU0gZCwgeVwiLHNob3J0RGF0ZTpcIk0vZC95eVwiLG1lZGl1bVRpbWU6XCJoOm1tOnNzIGFcIixzaG9ydFRpbWU6XCJoOm1tIGFcIn0scGx1cmFsQ2F0OmZ1bmN0aW9uKGIpe3JldHVybiAxPT09Yj9cIm9uZVwiOlwib3RoZXJcIn19fX1mdW5jdGlvbiB3YyhiKXtiPWIuc3BsaXQoXCIvXCIpO2Zvcih2YXIgYT1iLmxlbmd0aDthLS07KWJbYV09d2IoYlthXSk7cmV0dXJuIGIuam9pbihcIi9cIil9ZnVuY3Rpb24geGMoYixhLGMpe2I9c2EoYixjKTthLiQkcHJvdG9jb2w9XG5iLnByb3RvY29sO2EuJCRob3N0PWIuaG9zdG5hbWU7YS4kJHBvcnQ9WShiLnBvcnQpfHx3ZVtiLnByb3RvY29sXXx8bnVsbH1mdW5jdGlvbiB5YyhiLGEsYyl7dmFyIGQ9XCIvXCIhPT1iLmNoYXJBdCgwKTtkJiYoYj1cIi9cIitiKTtiPXNhKGIsYyk7YS4kJHBhdGg9ZGVjb2RlVVJJQ29tcG9uZW50KGQmJlwiL1wiPT09Yi5wYXRobmFtZS5jaGFyQXQoMCk/Yi5wYXRobmFtZS5zdWJzdHJpbmcoMSk6Yi5wYXRobmFtZSk7YS4kJHNlYXJjaD1ZYihiLnNlYXJjaCk7YS4kJGhhc2g9ZGVjb2RlVVJJQ29tcG9uZW50KGIuaGFzaCk7YS4kJHBhdGgmJlwiL1wiIT1hLiQkcGF0aC5jaGFyQXQoMCkmJihhLiQkcGF0aD1cIi9cIithLiQkcGF0aCl9ZnVuY3Rpb24gb2EoYixhKXtpZigwPT09YS5pbmRleE9mKGIpKXJldHVybiBhLnN1YnN0cihiLmxlbmd0aCl9ZnVuY3Rpb24gWWEoYil7dmFyIGE9Yi5pbmRleE9mKFwiI1wiKTtyZXR1cm4tMT09YT9iOmIuc3Vic3RyKDAsYSl9ZnVuY3Rpb24gSmIoYil7cmV0dXJuIGIuc3Vic3RyKDAsXG5ZYShiKS5sYXN0SW5kZXhPZihcIi9cIikrMSl9ZnVuY3Rpb24gemMoYixhKXt0aGlzLiQkaHRtbDU9ITA7YT1hfHxcIlwiO3ZhciBjPUpiKGIpO3hjKGIsdGhpcyxiKTt0aGlzLiQkcGFyc2U9ZnVuY3Rpb24oYSl7dmFyIGU9b2EoYyxhKTtpZighdyhlKSl0aHJvdyBLYihcImlwdGhwcmZ4XCIsYSxjKTt5YyhlLHRoaXMsYik7dGhpcy4kJHBhdGh8fCh0aGlzLiQkcGF0aD1cIi9cIik7dGhpcy4kJGNvbXBvc2UoKX07dGhpcy4kJGNvbXBvc2U9ZnVuY3Rpb24oKXt2YXIgYT1aYih0aGlzLiQkc2VhcmNoKSxiPXRoaXMuJCRoYXNoP1wiI1wiK3diKHRoaXMuJCRoYXNoKTpcIlwiO3RoaXMuJCR1cmw9d2ModGhpcy4kJHBhdGgpKyhhP1wiP1wiK2E6XCJcIikrYjt0aGlzLiQkYWJzVXJsPWMrdGhpcy4kJHVybC5zdWJzdHIoMSl9O3RoaXMuJCRyZXdyaXRlPWZ1bmN0aW9uKGQpe3ZhciBlO2lmKChlPW9hKGIsZCkpIT09cylyZXR1cm4gZD1lLChlPW9hKGEsZSkpIT09cz9jKyhvYShcIi9cIixlKXx8ZSk6YitkO2lmKChlPW9hKGMsXG5kKSkhPT1zKXJldHVybiBjK2U7aWYoYz09ZCtcIi9cIilyZXR1cm4gY319ZnVuY3Rpb24gTGIoYixhKXt2YXIgYz1KYihiKTt4YyhiLHRoaXMsYik7dGhpcy4kJHBhcnNlPWZ1bmN0aW9uKGQpe3ZhciBlPW9hKGIsZCl8fG9hKGMsZCksZT1cIiNcIj09ZS5jaGFyQXQoMCk/b2EoYSxlKTp0aGlzLiQkaHRtbDU/ZTpcIlwiO2lmKCF3KGUpKXRocm93IEtiKFwiaWhzaHByZnhcIixkLGEpO3ljKGUsdGhpcyxiKTtkPXRoaXMuJCRwYXRoO3ZhciBnPS9eXFwvPy4qPzooXFwvLiopLzswPT09ZS5pbmRleE9mKGIpJiYoZT1lLnJlcGxhY2UoYixcIlwiKSk7Zy5leGVjKGUpfHwoZD0oZT1nLmV4ZWMoZCkpP2VbMV06ZCk7dGhpcy4kJHBhdGg9ZDt0aGlzLiQkY29tcG9zZSgpfTt0aGlzLiQkY29tcG9zZT1mdW5jdGlvbigpe3ZhciBjPVpiKHRoaXMuJCRzZWFyY2gpLGU9dGhpcy4kJGhhc2g/XCIjXCIrd2IodGhpcy4kJGhhc2gpOlwiXCI7dGhpcy4kJHVybD13Yyh0aGlzLiQkcGF0aCkrKGM/XCI/XCIrYzpcIlwiKStlO3RoaXMuJCRhYnNVcmw9XG5iKyh0aGlzLiQkdXJsP2ErdGhpcy4kJHVybDpcIlwiKX07dGhpcy4kJHJld3JpdGU9ZnVuY3Rpb24oYSl7aWYoWWEoYik9PVlhKGEpKXJldHVybiBhfX1mdW5jdGlvbiBBYyhiLGEpe3RoaXMuJCRodG1sNT0hMDtMYi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGM9SmIoYik7dGhpcy4kJHJld3JpdGU9ZnVuY3Rpb24oZCl7dmFyIGU7aWYoYj09WWEoZCkpcmV0dXJuIGQ7aWYoZT1vYShjLGQpKXJldHVybiBiK2ErZTtpZihjPT09ZCtcIi9cIilyZXR1cm4gY319ZnVuY3Rpb24gbmIoYil7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXNbYl19fWZ1bmN0aW9uIEJjKGIsYSl7cmV0dXJuIGZ1bmN0aW9uKGMpe2lmKEUoYykpcmV0dXJuIHRoaXNbYl07dGhpc1tiXT1hKGMpO3RoaXMuJCRjb21wb3NlKCk7cmV0dXJuIHRoaXN9fWZ1bmN0aW9uIFZkKCl7dmFyIGI9XCJcIixhPSExO3RoaXMuaGFzaFByZWZpeD1mdW5jdGlvbihhKXtyZXR1cm4gQihhKT8oYj1hLHRoaXMpOmJ9O3RoaXMuaHRtbDVNb2RlPVxuZnVuY3Rpb24oYil7cmV0dXJuIEIoYik/KGE9Yix0aGlzKTphfTt0aGlzLiRnZXQ9W1wiJHJvb3RTY29wZVwiLFwiJGJyb3dzZXJcIixcIiRzbmlmZmVyXCIsXCIkcm9vdEVsZW1lbnRcIixmdW5jdGlvbihjLGQsZSxnKXtmdW5jdGlvbiBmKGEpe2MuJGJyb2FkY2FzdChcIiRsb2NhdGlvbkNoYW5nZVN1Y2Nlc3NcIixoLmFic1VybCgpLGEpfXZhciBoLGw9ZC5iYXNlSHJlZigpLGs9ZC51cmwoKTthPyhsPWsuc3Vic3RyaW5nKDAsay5pbmRleE9mKFwiL1wiLGsuaW5kZXhPZihcIi8vXCIpKzIpKSsobHx8XCIvXCIpLGU9ZS5oaXN0b3J5P3pjOkFjKToobD1ZYShrKSxlPUxiKTtoPW5ldyBlKGwsXCIjXCIrYik7aC4kJHBhcnNlKGguJCRyZXdyaXRlKGspKTtnLm9uKFwiY2xpY2tcIixmdW5jdGlvbihhKXtpZighYS5jdHJsS2V5JiYhYS5tZXRhS2V5JiYyIT1hLndoaWNoKXtmb3IodmFyIGI9eShhLnRhcmdldCk7XCJhXCIhPT1LKGJbMF0ubm9kZU5hbWUpOylpZihiWzBdPT09Z1swXXx8IShiPWIucGFyZW50KCkpWzBdKXJldHVybjtcbnZhciBlPWIucHJvcChcImhyZWZcIik7WChlKSYmXCJbb2JqZWN0IFNWR0FuaW1hdGVkU3RyaW5nXVwiPT09ZS50b1N0cmluZygpJiYoZT1zYShlLmFuaW1WYWwpLmhyZWYpO3ZhciBmPWguJCRyZXdyaXRlKGUpO2UmJighYi5hdHRyKFwidGFyZ2V0XCIpJiZmJiYhYS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkmJihhLnByZXZlbnREZWZhdWx0KCksZiE9ZC51cmwoKSYmKGguJCRwYXJzZShmKSxjLiRhcHBseSgpLE8uYW5ndWxhcltcImZmLTY4NDIwOC1wcmV2ZW50RGVmYXVsdFwiXT0hMCkpfX0pO2guYWJzVXJsKCkhPWsmJmQudXJsKGguYWJzVXJsKCksITApO2Qub25VcmxDaGFuZ2UoZnVuY3Rpb24oYSl7aC5hYnNVcmwoKSE9YSYmKGMuJGV2YWxBc3luYyhmdW5jdGlvbigpe3ZhciBiPWguYWJzVXJsKCk7aC4kJHBhcnNlKGEpO2MuJGJyb2FkY2FzdChcIiRsb2NhdGlvbkNoYW5nZVN0YXJ0XCIsYSxiKS5kZWZhdWx0UHJldmVudGVkPyhoLiQkcGFyc2UoYiksZC51cmwoYikpOmYoYil9KSxjLiQkcGhhc2V8fFxuYy4kZGlnZXN0KCkpfSk7dmFyIG09MDtjLiR3YXRjaChmdW5jdGlvbigpe3ZhciBhPWQudXJsKCksYj1oLiQkcmVwbGFjZTttJiZhPT1oLmFic1VybCgpfHwobSsrLGMuJGV2YWxBc3luYyhmdW5jdGlvbigpe2MuJGJyb2FkY2FzdChcIiRsb2NhdGlvbkNoYW5nZVN0YXJ0XCIsaC5hYnNVcmwoKSxhKS5kZWZhdWx0UHJldmVudGVkP2guJCRwYXJzZShhKTooZC51cmwoaC5hYnNVcmwoKSxiKSxmKGEpKX0pKTtoLiQkcmVwbGFjZT0hMTtyZXR1cm4gbX0pO3JldHVybiBofV19ZnVuY3Rpb24gV2QoKXt2YXIgYj0hMCxhPXRoaXM7dGhpcy5kZWJ1Z0VuYWJsZWQ9ZnVuY3Rpb24oYSl7cmV0dXJuIEIoYSk/KGI9YSx0aGlzKTpifTt0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLGZ1bmN0aW9uKGMpe2Z1bmN0aW9uIGQoYSl7YSBpbnN0YW5jZW9mIEVycm9yJiYoYS5zdGFjaz9hPWEubWVzc2FnZSYmLTE9PT1hLnN0YWNrLmluZGV4T2YoYS5tZXNzYWdlKT9cIkVycm9yOiBcIithLm1lc3NhZ2UrXCJcXG5cIithLnN0YWNrOlxuYS5zdGFjazphLnNvdXJjZVVSTCYmKGE9YS5tZXNzYWdlK1wiXFxuXCIrYS5zb3VyY2VVUkwrXCI6XCIrYS5saW5lKSk7cmV0dXJuIGF9ZnVuY3Rpb24gZShhKXt2YXIgYj1jLmNvbnNvbGV8fHt9LGU9YlthXXx8Yi5sb2d8fEM7YT0hMTt0cnl7YT0hIWUuYXBwbHl9Y2F0Y2gobCl7fXJldHVybiBhP2Z1bmN0aW9uKCl7dmFyIGE9W107cShhcmd1bWVudHMsZnVuY3Rpb24oYil7YS5wdXNoKGQoYikpfSk7cmV0dXJuIGUuYXBwbHkoYixhKX06ZnVuY3Rpb24oYSxiKXtlKGEsbnVsbD09Yj9cIlwiOmIpfX1yZXR1cm57bG9nOmUoXCJsb2dcIiksaW5mbzplKFwiaW5mb1wiKSx3YXJuOmUoXCJ3YXJuXCIpLGVycm9yOmUoXCJlcnJvclwiKSxkZWJ1ZzpmdW5jdGlvbigpe3ZhciBjPWUoXCJkZWJ1Z1wiKTtyZXR1cm4gZnVuY3Rpb24oKXtiJiZjLmFwcGx5KGEsYXJndW1lbnRzKX19KCl9fV19ZnVuY3Rpb24gZmEoYixhKXtpZihcImNvbnN0cnVjdG9yXCI9PT1iKXRocm93IEJhKFwiaXNlY2ZsZFwiLGEpO3JldHVybiBifWZ1bmN0aW9uIFphKGIsXG5hKXtpZihiKXtpZihiLmNvbnN0cnVjdG9yPT09Yil0aHJvdyBCYShcImlzZWNmblwiLGEpO2lmKGIuZG9jdW1lbnQmJmIubG9jYXRpb24mJmIuYWxlcnQmJmIuc2V0SW50ZXJ2YWwpdGhyb3cgQmEoXCJpc2Vjd2luZG93XCIsYSk7aWYoYi5jaGlsZHJlbiYmKGIubm9kZU5hbWV8fGIucHJvcCYmYi5hdHRyJiZiLmZpbmQpKXRocm93IEJhKFwiaXNlY2RvbVwiLGEpO31yZXR1cm4gYn1mdW5jdGlvbiBvYihiLGEsYyxkLGUpe2U9ZXx8e307YT1hLnNwbGl0KFwiLlwiKTtmb3IodmFyIGcsZj0wOzE8YS5sZW5ndGg7ZisrKXtnPWZhKGEuc2hpZnQoKSxkKTt2YXIgaD1iW2ddO2h8fChoPXt9LGJbZ109aCk7Yj1oO2IudGhlbiYmZS51bndyYXBQcm9taXNlcyYmKHRhKGQpLFwiJCR2XCJpbiBifHxmdW5jdGlvbihhKXthLnRoZW4oZnVuY3Rpb24oYil7YS4kJHY9Yn0pfShiKSxiLiQkdj09PXMmJihiLiQkdj17fSksYj1iLiQkdil9Zz1mYShhLnNoaWZ0KCksZCk7cmV0dXJuIGJbZ109Y31mdW5jdGlvbiBDYyhiLFxuYSxjLGQsZSxnLGYpe2ZhKGIsZyk7ZmEoYSxnKTtmYShjLGcpO2ZhKGQsZyk7ZmEoZSxnKTtyZXR1cm4gZi51bndyYXBQcm9taXNlcz9mdW5jdGlvbihmLGwpe3ZhciBrPWwmJmwuaGFzT3duUHJvcGVydHkoYik/bDpmLG07aWYobnVsbD09aylyZXR1cm4gazsoaz1rW2JdKSYmay50aGVuJiYodGEoZyksXCIkJHZcImluIGt8fChtPWssbS4kJHY9cyxtLnRoZW4oZnVuY3Rpb24oYSl7bS4kJHY9YX0pKSxrPWsuJCR2KTtpZighYSlyZXR1cm4gaztpZihudWxsPT1rKXJldHVybiBzOyhrPWtbYV0pJiZrLnRoZW4mJih0YShnKSxcIiQkdlwiaW4ga3x8KG09ayxtLiQkdj1zLG0udGhlbihmdW5jdGlvbihhKXttLiQkdj1hfSkpLGs9ay4kJHYpO2lmKCFjKXJldHVybiBrO2lmKG51bGw9PWspcmV0dXJuIHM7KGs9a1tjXSkmJmsudGhlbiYmKHRhKGcpLFwiJCR2XCJpbiBrfHwobT1rLG0uJCR2PXMsbS50aGVuKGZ1bmN0aW9uKGEpe20uJCR2PWF9KSksaz1rLiQkdik7aWYoIWQpcmV0dXJuIGs7aWYobnVsbD09XG5rKXJldHVybiBzOyhrPWtbZF0pJiZrLnRoZW4mJih0YShnKSxcIiQkdlwiaW4ga3x8KG09ayxtLiQkdj1zLG0udGhlbihmdW5jdGlvbihhKXttLiQkdj1hfSkpLGs9ay4kJHYpO2lmKCFlKXJldHVybiBrO2lmKG51bGw9PWspcmV0dXJuIHM7KGs9a1tlXSkmJmsudGhlbiYmKHRhKGcpLFwiJCR2XCJpbiBrfHwobT1rLG0uJCR2PXMsbS50aGVuKGZ1bmN0aW9uKGEpe20uJCR2PWF9KSksaz1rLiQkdik7cmV0dXJuIGt9OmZ1bmN0aW9uKGcsZil7dmFyIGs9ZiYmZi5oYXNPd25Qcm9wZXJ0eShiKT9mOmc7aWYobnVsbD09aylyZXR1cm4gaztrPWtbYl07aWYoIWEpcmV0dXJuIGs7aWYobnVsbD09aylyZXR1cm4gcztrPWtbYV07aWYoIWMpcmV0dXJuIGs7aWYobnVsbD09aylyZXR1cm4gcztrPWtbY107aWYoIWQpcmV0dXJuIGs7aWYobnVsbD09aylyZXR1cm4gcztrPWtbZF07cmV0dXJuIGU/bnVsbD09az9zOms9a1tlXTprfX1mdW5jdGlvbiB4ZShiLGEpe2ZhKGIsYSk7cmV0dXJuIGZ1bmN0aW9uKGEsXG5kKXtyZXR1cm4gbnVsbD09YT9zOihkJiZkLmhhc093blByb3BlcnR5KGIpP2Q6YSlbYl19fWZ1bmN0aW9uIHllKGIsYSxjKXtmYShiLGMpO2ZhKGEsYyk7cmV0dXJuIGZ1bmN0aW9uKGMsZSl7aWYobnVsbD09YylyZXR1cm4gcztjPShlJiZlLmhhc093blByb3BlcnR5KGIpP2U6YylbYl07cmV0dXJuIG51bGw9PWM/czpjW2FdfX1mdW5jdGlvbiBEYyhiLGEsYyl7aWYoTWIuaGFzT3duUHJvcGVydHkoYikpcmV0dXJuIE1iW2JdO3ZhciBkPWIuc3BsaXQoXCIuXCIpLGU9ZC5sZW5ndGgsZztpZihhLnVud3JhcFByb21pc2VzfHwxIT09ZSlpZihhLnVud3JhcFByb21pc2VzfHwyIT09ZSlpZihhLmNzcClnPTY+ZT9DYyhkWzBdLGRbMV0sZFsyXSxkWzNdLGRbNF0sYyxhKTpmdW5jdGlvbihiLGcpe3ZhciBmPTAsaDtkbyBoPUNjKGRbZisrXSxkW2YrK10sZFtmKytdLGRbZisrXSxkW2YrK10sYyxhKShiLGcpLGc9cyxiPWg7d2hpbGUoZjxlKTtyZXR1cm4gaH07ZWxzZXt2YXIgZj1cInZhciBwO1xcblwiO1xucShkLGZ1bmN0aW9uKGIsZCl7ZmEoYixjKTtmKz1cImlmKHMgPT0gbnVsbCkgcmV0dXJuIHVuZGVmaW5lZDtcXG5zPVwiKyhkP1wic1wiOicoKGsmJmsuaGFzT3duUHJvcGVydHkoXCInK2IrJ1wiKSk/azpzKScpKydbXCInK2IrJ1wiXTtcXG4nKyhhLnVud3JhcFByb21pc2VzPydpZiAocyAmJiBzLnRoZW4pIHtcXG4gcHcoXCInK2MucmVwbGFjZSgvKFtcIlxcclxcbl0pL2csXCJcXFxcJDFcIikrJ1wiKTtcXG4gaWYgKCEoXCIkJHZcIiBpbiBzKSkge1xcbiBwPXM7XFxuIHAuJCR2ID0gdW5kZWZpbmVkO1xcbiBwLnRoZW4oZnVuY3Rpb24odikge3AuJCR2PXY7fSk7XFxufVxcbiBzPXMuJCR2XFxufVxcbic6XCJcIil9KTt2YXIgZj1mK1wicmV0dXJuIHM7XCIsaD1uZXcgRnVuY3Rpb24oXCJzXCIsXCJrXCIsXCJwd1wiLGYpO2gudG9TdHJpbmc9YWEoZik7Zz1hLnVud3JhcFByb21pc2VzP2Z1bmN0aW9uKGEsYil7cmV0dXJuIGgoYSxiLHRhKX06aH1lbHNlIGc9eWUoZFswXSxkWzFdLGMpO2Vsc2UgZz14ZShkWzBdLGMpO1wiaGFzT3duUHJvcGVydHlcIiE9PVxuYiYmKE1iW2JdPWcpO3JldHVybiBnfWZ1bmN0aW9uIFhkKCl7dmFyIGI9e30sYT17Y3NwOiExLHVud3JhcFByb21pc2VzOiExLGxvZ1Byb21pc2VXYXJuaW5nczohMH07dGhpcy51bndyYXBQcm9taXNlcz1mdW5jdGlvbihiKXtyZXR1cm4gQihiKT8oYS51bndyYXBQcm9taXNlcz0hIWIsdGhpcyk6YS51bndyYXBQcm9taXNlc307dGhpcy5sb2dQcm9taXNlV2FybmluZ3M9ZnVuY3Rpb24oYil7cmV0dXJuIEIoYik/KGEubG9nUHJvbWlzZVdhcm5pbmdzPWIsdGhpcyk6YS5sb2dQcm9taXNlV2FybmluZ3N9O3RoaXMuJGdldD1bXCIkZmlsdGVyXCIsXCIkc25pZmZlclwiLFwiJGxvZ1wiLGZ1bmN0aW9uKGMsZCxlKXthLmNzcD1kLmNzcDt0YT1mdW5jdGlvbihiKXthLmxvZ1Byb21pc2VXYXJuaW5ncyYmIUVjLmhhc093blByb3BlcnR5KGIpJiYoRWNbYl09ITAsZS53YXJuKFwiWyRwYXJzZV0gUHJvbWlzZSBmb3VuZCBpbiB0aGUgZXhwcmVzc2lvbiBgXCIrYitcImAuIEF1dG9tYXRpYyB1bndyYXBwaW5nIG9mIHByb21pc2VzIGluIEFuZ3VsYXIgZXhwcmVzc2lvbnMgaXMgZGVwcmVjYXRlZC5cIikpfTtcbnJldHVybiBmdW5jdGlvbihkKXt2YXIgZTtzd2l0Y2godHlwZW9mIGQpe2Nhc2UgXCJzdHJpbmdcIjppZihiLmhhc093blByb3BlcnR5KGQpKXJldHVybiBiW2RdO2U9bmV3IE5iKGEpO2U9KG5ldyAkYShlLGMsYSkpLnBhcnNlKGQsITEpO1wiaGFzT3duUHJvcGVydHlcIiE9PWQmJihiW2RdPWUpO3JldHVybiBlO2Nhc2UgXCJmdW5jdGlvblwiOnJldHVybiBkO2RlZmF1bHQ6cmV0dXJuIEN9fX1dfWZ1bmN0aW9uIFpkKCl7dGhpcy4kZ2V0PVtcIiRyb290U2NvcGVcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsZnVuY3Rpb24oYixhKXtyZXR1cm4gemUoZnVuY3Rpb24oYSl7Yi4kZXZhbEFzeW5jKGEpfSxhKX1dfWZ1bmN0aW9uIHplKGIsYSl7ZnVuY3Rpb24gYyhhKXtyZXR1cm4gYX1mdW5jdGlvbiBkKGEpe3JldHVybiBmKGEpfXZhciBlPWZ1bmN0aW9uKCl7dmFyIGY9W10sayxtO3JldHVybiBtPXtyZXNvbHZlOmZ1bmN0aW9uKGEpe2lmKGYpe3ZhciBjPWY7Zj1zO2s9ZyhhKTtjLmxlbmd0aCYmYihmdW5jdGlvbigpe2Zvcih2YXIgYSxcbmI9MCxkPWMubGVuZ3RoO2I8ZDtiKyspYT1jW2JdLGsudGhlbihhWzBdLGFbMV0sYVsyXSl9KX19LHJlamVjdDpmdW5jdGlvbihhKXttLnJlc29sdmUoaChhKSl9LG5vdGlmeTpmdW5jdGlvbihhKXtpZihmKXt2YXIgYz1mO2YubGVuZ3RoJiZiKGZ1bmN0aW9uKCl7Zm9yKHZhciBiLGQ9MCxlPWMubGVuZ3RoO2Q8ZTtkKyspYj1jW2RdLGJbMl0oYSl9KX19LHByb21pc2U6e3RoZW46ZnVuY3Rpb24oYixnLGgpe3ZhciBtPWUoKSx1PWZ1bmN0aW9uKGQpe3RyeXttLnJlc29sdmUoKFAoYik/YjpjKShkKSl9Y2F0Y2goZSl7bS5yZWplY3QoZSksYShlKX19LEY9ZnVuY3Rpb24oYil7dHJ5e20ucmVzb2x2ZSgoUChnKT9nOmQpKGIpKX1jYXRjaChjKXttLnJlamVjdChjKSxhKGMpfX0sdj1mdW5jdGlvbihiKXt0cnl7bS5ub3RpZnkoKFAoaCk/aDpjKShiKSl9Y2F0Y2goZCl7YShkKX19O2Y/Zi5wdXNoKFt1LEYsdl0pOmsudGhlbih1LEYsdik7cmV0dXJuIG0ucHJvbWlzZX0sXCJjYXRjaFwiOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnRoZW4obnVsbCxcbmEpfSxcImZpbmFsbHlcIjpmdW5jdGlvbihhKXtmdW5jdGlvbiBiKGEsYyl7dmFyIGQ9ZSgpO2M/ZC5yZXNvbHZlKGEpOmQucmVqZWN0KGEpO3JldHVybiBkLnByb21pc2V9ZnVuY3Rpb24gZChlLGcpe3ZhciBmPW51bGw7dHJ5e2Y9KGF8fGMpKCl9Y2F0Y2goaCl7cmV0dXJuIGIoaCwhMSl9cmV0dXJuIGYmJlAoZi50aGVuKT9mLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYihlLGcpfSxmdW5jdGlvbihhKXtyZXR1cm4gYihhLCExKX0pOmIoZSxnKX1yZXR1cm4gdGhpcy50aGVuKGZ1bmN0aW9uKGEpe3JldHVybiBkKGEsITApfSxmdW5jdGlvbihhKXtyZXR1cm4gZChhLCExKX0pfX19fSxnPWZ1bmN0aW9uKGEpe3JldHVybiBhJiZQKGEudGhlbik/YTp7dGhlbjpmdW5jdGlvbihjKXt2YXIgZD1lKCk7YihmdW5jdGlvbigpe2QucmVzb2x2ZShjKGEpKX0pO3JldHVybiBkLnByb21pc2V9fX0sZj1mdW5jdGlvbihhKXt2YXIgYj1lKCk7Yi5yZWplY3QoYSk7cmV0dXJuIGIucHJvbWlzZX0saD1mdW5jdGlvbihjKXtyZXR1cm57dGhlbjpmdW5jdGlvbihnLFxuZil7dmFyIGg9ZSgpO2IoZnVuY3Rpb24oKXt0cnl7aC5yZXNvbHZlKChQKGYpP2Y6ZCkoYykpfWNhdGNoKGIpe2gucmVqZWN0KGIpLGEoYil9fSk7cmV0dXJuIGgucHJvbWlzZX19fTtyZXR1cm57ZGVmZXI6ZSxyZWplY3Q6Zix3aGVuOmZ1bmN0aW9uKGgsayxtLG4pe3ZhciBwPWUoKSxyLHo9ZnVuY3Rpb24oYil7dHJ5e3JldHVybihQKGspP2s6YykoYil9Y2F0Y2goZCl7cmV0dXJuIGEoZCksZihkKX19LHU9ZnVuY3Rpb24oYil7dHJ5e3JldHVybihQKG0pP206ZCkoYil9Y2F0Y2goYyl7cmV0dXJuIGEoYyksZihjKX19LEY9ZnVuY3Rpb24oYil7dHJ5e3JldHVybihQKG4pP246YykoYil9Y2F0Y2goZCl7YShkKX19O2IoZnVuY3Rpb24oKXtnKGgpLnRoZW4oZnVuY3Rpb24oYSl7cnx8KHI9ITAscC5yZXNvbHZlKGcoYSkudGhlbih6LHUsRikpKX0sZnVuY3Rpb24oYSl7cnx8KHI9ITAscC5yZXNvbHZlKHUoYSkpKX0sZnVuY3Rpb24oYSl7cnx8cC5ub3RpZnkoRihhKSl9KX0pO3JldHVybiBwLnByb21pc2V9LFxuYWxsOmZ1bmN0aW9uKGEpe3ZhciBiPWUoKSxjPTAsZD1NKGEpP1tdOnt9O3EoYSxmdW5jdGlvbihhLGUpe2MrKztnKGEpLnRoZW4oZnVuY3Rpb24oYSl7ZC5oYXNPd25Qcm9wZXJ0eShlKXx8KGRbZV09YSwtLWN8fGIucmVzb2x2ZShkKSl9LGZ1bmN0aW9uKGEpe2QuaGFzT3duUHJvcGVydHkoZSl8fGIucmVqZWN0KGEpfSl9KTswPT09YyYmYi5yZXNvbHZlKGQpO3JldHVybiBiLnByb21pc2V9fX1mdW5jdGlvbiBmZSgpe3RoaXMuJGdldD1bXCIkd2luZG93XCIsXCIkdGltZW91dFwiLGZ1bmN0aW9uKGIsYSl7dmFyIGM9Yi5yZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGIud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lfHxiLm1velJlcXVlc3RBbmltYXRpb25GcmFtZSxkPWIuY2FuY2VsQW5pbWF0aW9uRnJhbWV8fGIud2Via2l0Q2FuY2VsQW5pbWF0aW9uRnJhbWV8fGIubW96Q2FuY2VsQW5pbWF0aW9uRnJhbWV8fGIud2Via2l0Q2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lLGU9ISFjLGc9ZT9cbmZ1bmN0aW9uKGEpe3ZhciBiPWMoYSk7cmV0dXJuIGZ1bmN0aW9uKCl7ZChiKX19OmZ1bmN0aW9uKGIpe3ZhciBjPWEoYiwxNi42NiwhMSk7cmV0dXJuIGZ1bmN0aW9uKCl7YS5jYW5jZWwoYyl9fTtnLnN1cHBvcnRlZD1lO3JldHVybiBnfV19ZnVuY3Rpb24gWWQoKXt2YXIgYj0xMCxhPXQoXCIkcm9vdFNjb3BlXCIpLGM9bnVsbDt0aGlzLmRpZ2VzdFR0bD1mdW5jdGlvbihhKXthcmd1bWVudHMubGVuZ3RoJiYoYj1hKTtyZXR1cm4gYn07dGhpcy4kZ2V0PVtcIiRpbmplY3RvclwiLFwiJGV4Y2VwdGlvbkhhbmRsZXJcIixcIiRwYXJzZVwiLFwiJGJyb3dzZXJcIixmdW5jdGlvbihkLGUsZyxmKXtmdW5jdGlvbiBoKCl7dGhpcy4kaWQ9YmIoKTt0aGlzLiQkcGhhc2U9dGhpcy4kcGFyZW50PXRoaXMuJCR3YXRjaGVycz10aGlzLiQkbmV4dFNpYmxpbmc9dGhpcy4kJHByZXZTaWJsaW5nPXRoaXMuJCRjaGlsZEhlYWQ9dGhpcy4kJGNoaWxkVGFpbD1udWxsO3RoaXNbXCJ0aGlzXCJdPXRoaXMuJHJvb3Q9dGhpcztcbnRoaXMuJCRkZXN0cm95ZWQ9ITE7dGhpcy4kJGFzeW5jUXVldWU9W107dGhpcy4kJHBvc3REaWdlc3RRdWV1ZT1bXTt0aGlzLiQkbGlzdGVuZXJzPXt9O3RoaXMuJCRsaXN0ZW5lckNvdW50PXt9O3RoaXMuJCRpc29sYXRlQmluZGluZ3M9e319ZnVuY3Rpb24gbChiKXtpZihwLiQkcGhhc2UpdGhyb3cgYShcImlucHJvZ1wiLHAuJCRwaGFzZSk7cC4kJHBoYXNlPWJ9ZnVuY3Rpb24gayhhLGIpe3ZhciBjPWcoYSk7UmEoYyxiKTtyZXR1cm4gY31mdW5jdGlvbiBtKGEsYixjKXtkbyBhLiQkbGlzdGVuZXJDb3VudFtjXS09YiwwPT09YS4kJGxpc3RlbmVyQ291bnRbY10mJmRlbGV0ZSBhLiQkbGlzdGVuZXJDb3VudFtjXTt3aGlsZShhPWEuJHBhcmVudCl9ZnVuY3Rpb24gbigpe31oLnByb3RvdHlwZT17Y29uc3RydWN0b3I6aCwkbmV3OmZ1bmN0aW9uKGEpe2E/KGE9bmV3IGgsYS4kcm9vdD10aGlzLiRyb290LGEuJCRhc3luY1F1ZXVlPXRoaXMuJCRhc3luY1F1ZXVlLGEuJCRwb3N0RGlnZXN0UXVldWU9XG50aGlzLiQkcG9zdERpZ2VzdFF1ZXVlKTooYT1mdW5jdGlvbigpe30sYS5wcm90b3R5cGU9dGhpcyxhPW5ldyBhLGEuJGlkPWJiKCkpO2FbXCJ0aGlzXCJdPWE7YS4kJGxpc3RlbmVycz17fTthLiQkbGlzdGVuZXJDb3VudD17fTthLiRwYXJlbnQ9dGhpczthLiQkd2F0Y2hlcnM9YS4kJG5leHRTaWJsaW5nPWEuJCRjaGlsZEhlYWQ9YS4kJGNoaWxkVGFpbD1udWxsO2EuJCRwcmV2U2libGluZz10aGlzLiQkY2hpbGRUYWlsO3RoaXMuJCRjaGlsZEhlYWQ/dGhpcy4kJGNoaWxkVGFpbD10aGlzLiQkY2hpbGRUYWlsLiQkbmV4dFNpYmxpbmc9YTp0aGlzLiQkY2hpbGRIZWFkPXRoaXMuJCRjaGlsZFRhaWw9YTtyZXR1cm4gYX0sJHdhdGNoOmZ1bmN0aW9uKGEsYixkKXt2YXIgZT1rKGEsXCJ3YXRjaFwiKSxnPXRoaXMuJCR3YXRjaGVycyxmPXtmbjpiLGxhc3Q6bixnZXQ6ZSxleHA6YSxlcTohIWR9O2M9bnVsbDtpZighUChiKSl7dmFyIGg9ayhifHxDLFwibGlzdGVuZXJcIik7Zi5mbj1mdW5jdGlvbihhLFxuYixjKXtoKGMpfX1pZihcInN0cmluZ1wiPT10eXBlb2YgYSYmZS5jb25zdGFudCl7dmFyIGw9Zi5mbjtmLmZuPWZ1bmN0aW9uKGEsYixjKXtsLmNhbGwodGhpcyxhLGIsYyk7T2EoZyxmKX19Z3x8KGc9dGhpcy4kJHdhdGNoZXJzPVtdKTtnLnVuc2hpZnQoZik7cmV0dXJuIGZ1bmN0aW9uKCl7T2EoZyxmKTtjPW51bGx9fSwkd2F0Y2hDb2xsZWN0aW9uOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkLGUsZixoPTE8Yi5sZW5ndGgsbD0wLGs9ZyhhKSxtPVtdLG49e30scD0hMCxxPTA7cmV0dXJuIHRoaXMuJHdhdGNoKGZ1bmN0aW9uKCl7ZD1rKGMpO3ZhciBhLGI7aWYoWChkKSlpZihhYihkKSlmb3IoZSE9PW0mJihlPW0scT1lLmxlbmd0aD0wLGwrKyksYT1kLmxlbmd0aCxxIT09YSYmKGwrKyxlLmxlbmd0aD1xPWEpLGI9MDtiPGE7YisrKWVbYl0hPT1lW2JdJiZkW2JdIT09ZFtiXXx8ZVtiXT09PWRbYl18fChsKyssZVtiXT1kW2JdKTtlbHNle2UhPT1uJiYoZT1uPXt9LHE9MCxsKyspO2E9XG4wO2ZvcihiIGluIGQpZC5oYXNPd25Qcm9wZXJ0eShiKSYmKGErKyxlLmhhc093blByb3BlcnR5KGIpP2VbYl0hPT1kW2JdJiYobCsrLGVbYl09ZFtiXSk6KHErKyxlW2JdPWRbYl0sbCsrKSk7aWYocT5hKWZvcihiIGluIGwrKyxlKWUuaGFzT3duUHJvcGVydHkoYikmJiFkLmhhc093blByb3BlcnR5KGIpJiYocS0tLGRlbGV0ZSBlW2JdKX1lbHNlIGUhPT1kJiYoZT1kLGwrKyk7cmV0dXJuIGx9LGZ1bmN0aW9uKCl7cD8ocD0hMSxiKGQsZCxjKSk6YihkLGYsYyk7aWYoaClpZihYKGQpKWlmKGFiKGQpKXtmPUFycmF5KGQubGVuZ3RoKTtmb3IodmFyIGE9MDthPGQubGVuZ3RoO2ErKylmW2FdPWRbYV19ZWxzZSBmb3IoYSBpbiBmPXt9LGQpRmMuY2FsbChkLGEpJiYoZlthXT1kW2FdKTtlbHNlIGY9ZH0pfSwkZGlnZXN0OmZ1bmN0aW9uKCl7dmFyIGQsZyxmLGgsaz10aGlzLiQkYXN5bmNRdWV1ZSxtPXRoaXMuJCRwb3N0RGlnZXN0UXVldWUscSx4LHM9YixMLFE9W10seSxILFI7bChcIiRkaWdlc3RcIik7XG5jPW51bGw7ZG97eD0hMTtmb3IoTD10aGlzO2subGVuZ3RoOyl7dHJ5e1I9ay5zaGlmdCgpLFIuc2NvcGUuJGV2YWwoUi5leHByZXNzaW9uKX1jYXRjaChCKXtwLiQkcGhhc2U9bnVsbCxlKEIpfWM9bnVsbH1hOmRve2lmKGg9TC4kJHdhdGNoZXJzKWZvcihxPWgubGVuZ3RoO3EtLTspdHJ5e2lmKGQ9aFtxXSlpZigoZz1kLmdldChMKSkhPT0oZj1kLmxhc3QpJiYhKGQuZXE/eGEoZyxmKTpcIm51bWJlclwiPT10eXBlb2YgZyYmXCJudW1iZXJcIj09dHlwZW9mIGYmJmlzTmFOKGcpJiZpc05hTihmKSkpeD0hMCxjPWQsZC5sYXN0PWQuZXE/YmEoZyk6ZyxkLmZuKGcsZj09PW4/ZzpmLEwpLDU+cyYmKHk9NC1zLFFbeV18fChRW3ldPVtdKSxIPVAoZC5leHApP1wiZm46IFwiKyhkLmV4cC5uYW1lfHxkLmV4cC50b1N0cmluZygpKTpkLmV4cCxIKz1cIjsgbmV3VmFsOiBcIitxYShnKStcIjsgb2xkVmFsOiBcIitxYShmKSxRW3ldLnB1c2goSCkpO2Vsc2UgaWYoZD09PWMpe3g9ITE7YnJlYWsgYX19Y2F0Y2godyl7cC4kJHBoYXNlPVxubnVsbCxlKHcpfWlmKCEoaD1MLiQkY2hpbGRIZWFkfHxMIT09dGhpcyYmTC4kJG5leHRTaWJsaW5nKSlmb3IoO0whPT10aGlzJiYhKGg9TC4kJG5leHRTaWJsaW5nKTspTD1MLiRwYXJlbnR9d2hpbGUoTD1oKTtpZigoeHx8ay5sZW5ndGgpJiYhcy0tKXRocm93IHAuJCRwaGFzZT1udWxsLGEoXCJpbmZkaWdcIixiLHFhKFEpKTt9d2hpbGUoeHx8ay5sZW5ndGgpO2ZvcihwLiQkcGhhc2U9bnVsbDttLmxlbmd0aDspdHJ5e20uc2hpZnQoKSgpfWNhdGNoKFQpe2UoVCl9fSwkZGVzdHJveTpmdW5jdGlvbigpe2lmKCF0aGlzLiQkZGVzdHJveWVkKXt2YXIgYT10aGlzLiRwYXJlbnQ7dGhpcy4kYnJvYWRjYXN0KFwiJGRlc3Ryb3lcIik7dGhpcy4kJGRlc3Ryb3llZD0hMDt0aGlzIT09cCYmKHEodGhpcy4kJGxpc3RlbmVyQ291bnQsZWIobnVsbCxtLHRoaXMpKSxhLiQkY2hpbGRIZWFkPT10aGlzJiYoYS4kJGNoaWxkSGVhZD10aGlzLiQkbmV4dFNpYmxpbmcpLGEuJCRjaGlsZFRhaWw9PXRoaXMmJlxuKGEuJCRjaGlsZFRhaWw9dGhpcy4kJHByZXZTaWJsaW5nKSx0aGlzLiQkcHJldlNpYmxpbmcmJih0aGlzLiQkcHJldlNpYmxpbmcuJCRuZXh0U2libGluZz10aGlzLiQkbmV4dFNpYmxpbmcpLHRoaXMuJCRuZXh0U2libGluZyYmKHRoaXMuJCRuZXh0U2libGluZy4kJHByZXZTaWJsaW5nPXRoaXMuJCRwcmV2U2libGluZyksdGhpcy4kcGFyZW50PXRoaXMuJCRuZXh0U2libGluZz10aGlzLiQkcHJldlNpYmxpbmc9dGhpcy4kJGNoaWxkSGVhZD10aGlzLiQkY2hpbGRUYWlsPXRoaXMuJHJvb3Q9bnVsbCx0aGlzLiQkbGlzdGVuZXJzPXt9LHRoaXMuJCR3YXRjaGVycz10aGlzLiQkYXN5bmNRdWV1ZT10aGlzLiQkcG9zdERpZ2VzdFF1ZXVlPVtdLHRoaXMuJGRlc3Ryb3k9dGhpcy4kZGlnZXN0PXRoaXMuJGFwcGx5PUMsdGhpcy4kb249dGhpcy4kd2F0Y2g9ZnVuY3Rpb24oKXtyZXR1cm4gQ30pfX0sJGV2YWw6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZyhhKSh0aGlzLGIpfSwkZXZhbEFzeW5jOmZ1bmN0aW9uKGEpe3AuJCRwaGFzZXx8XG5wLiQkYXN5bmNRdWV1ZS5sZW5ndGh8fGYuZGVmZXIoZnVuY3Rpb24oKXtwLiQkYXN5bmNRdWV1ZS5sZW5ndGgmJnAuJGRpZ2VzdCgpfSk7dGhpcy4kJGFzeW5jUXVldWUucHVzaCh7c2NvcGU6dGhpcyxleHByZXNzaW9uOmF9KX0sJCRwb3N0RGlnZXN0OmZ1bmN0aW9uKGEpe3RoaXMuJCRwb3N0RGlnZXN0UXVldWUucHVzaChhKX0sJGFwcGx5OmZ1bmN0aW9uKGEpe3RyeXtyZXR1cm4gbChcIiRhcHBseVwiKSx0aGlzLiRldmFsKGEpfWNhdGNoKGIpe2UoYil9ZmluYWxseXtwLiQkcGhhc2U9bnVsbDt0cnl7cC4kZGlnZXN0KCl9Y2F0Y2goYyl7dGhyb3cgZShjKSxjO319fSwkb246ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLiQkbGlzdGVuZXJzW2FdO2N8fCh0aGlzLiQkbGlzdGVuZXJzW2FdPWM9W10pO2MucHVzaChiKTt2YXIgZD10aGlzO2RvIGQuJCRsaXN0ZW5lckNvdW50W2FdfHwoZC4kJGxpc3RlbmVyQ291bnRbYV09MCksZC4kJGxpc3RlbmVyQ291bnRbYV0rKzt3aGlsZShkPWQuJHBhcmVudCk7XG52YXIgZT10aGlzO3JldHVybiBmdW5jdGlvbigpe2NbZGIoYyxiKV09bnVsbDttKGUsMSxhKX19LCRlbWl0OmZ1bmN0aW9uKGEsYil7dmFyIGM9W10sZCxnPXRoaXMsZj0hMSxoPXtuYW1lOmEsdGFyZ2V0U2NvcGU6ZyxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXtmPSEwfSxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe2guZGVmYXVsdFByZXZlbnRlZD0hMH0sZGVmYXVsdFByZXZlbnRlZDohMX0sbD1baF0uY29uY2F0KHlhLmNhbGwoYXJndW1lbnRzLDEpKSxrLG07ZG97ZD1nLiQkbGlzdGVuZXJzW2FdfHxjO2guY3VycmVudFNjb3BlPWc7az0wO2ZvcihtPWQubGVuZ3RoO2s8bTtrKyspaWYoZFtrXSl0cnl7ZFtrXS5hcHBseShudWxsLGwpfWNhdGNoKG4pe2Uobil9ZWxzZSBkLnNwbGljZShrLDEpLGstLSxtLS07aWYoZilicmVhaztnPWcuJHBhcmVudH13aGlsZShnKTtyZXR1cm4gaH0sJGJyb2FkY2FzdDpmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz10aGlzLGQ9dGhpcyxnPXtuYW1lOmEsXG50YXJnZXRTY29wZTp0aGlzLHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7Zy5kZWZhdWx0UHJldmVudGVkPSEwfSxkZWZhdWx0UHJldmVudGVkOiExfSxmPVtnXS5jb25jYXQoeWEuY2FsbChhcmd1bWVudHMsMSkpLGgsaztjPWQ7KXtnLmN1cnJlbnRTY29wZT1jO2Q9Yy4kJGxpc3RlbmVyc1thXXx8W107aD0wO2ZvcihrPWQubGVuZ3RoO2g8aztoKyspaWYoZFtoXSl0cnl7ZFtoXS5hcHBseShudWxsLGYpfWNhdGNoKGwpe2UobCl9ZWxzZSBkLnNwbGljZShoLDEpLGgtLSxrLS07aWYoIShkPWMuJCRsaXN0ZW5lckNvdW50W2FdJiZjLiQkY2hpbGRIZWFkfHxjIT09dGhpcyYmYy4kJG5leHRTaWJsaW5nKSlmb3IoO2MhPT10aGlzJiYhKGQ9Yy4kJG5leHRTaWJsaW5nKTspYz1jLiRwYXJlbnR9cmV0dXJuIGd9fTt2YXIgcD1uZXcgaDtyZXR1cm4gcH1dfWZ1bmN0aW9uIGJkKCl7dmFyIGI9L15cXHMqKGh0dHBzP3xmdHB8bWFpbHRvfHRlbHxmaWxlKTovLGE9L15cXHMqKGh0dHBzP3xmdHB8ZmlsZSk6fGRhdGE6aW1hZ2VcXC8vO1xudGhpcy5hSHJlZlNhbml0aXphdGlvbldoaXRlbGlzdD1mdW5jdGlvbihhKXtyZXR1cm4gQihhKT8oYj1hLHRoaXMpOmJ9O3RoaXMuaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0PWZ1bmN0aW9uKGIpe3JldHVybiBCKGIpPyhhPWIsdGhpcyk6YX07dGhpcy4kZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7dmFyIGU9ZD9hOmIsZztpZighU3x8ODw9UylpZihnPXNhKGMpLmhyZWYsXCJcIiE9PWcmJiFnLm1hdGNoKGUpKXJldHVyblwidW5zYWZlOlwiK2c7cmV0dXJuIGN9fX1mdW5jdGlvbiBBZShiKXtpZihcInNlbGZcIj09PWIpcmV0dXJuIGI7aWYodyhiKSl7aWYoLTE8Yi5pbmRleE9mKFwiKioqXCIpKXRocm93IHVhKFwiaXdjYXJkXCIsYik7Yj1iLnJlcGxhY2UoLyhbLSgpXFxbXFxde30rPyouJFxcXnwsOiM8IVxcXFxdKS9nLFwiXFxcXCQxXCIpLnJlcGxhY2UoL1xceDA4L2csXCJcXFxceDA4XCIpLnJlcGxhY2UoXCJcXFxcKlxcXFwqXCIsXCIuKlwiKS5yZXBsYWNlKFwiXFxcXCpcIixcIlteOi8uPyY7XSpcIik7cmV0dXJuIFJlZ0V4cChcIl5cIitcbmIrXCIkXCIpfWlmKGNiKGIpKXJldHVybiBSZWdFeHAoXCJeXCIrYi5zb3VyY2UrXCIkXCIpO3Rocm93IHVhKFwiaW1hdGNoZXJcIik7fWZ1bmN0aW9uIEdjKGIpe3ZhciBhPVtdO0IoYikmJnEoYixmdW5jdGlvbihiKXthLnB1c2goQWUoYikpfSk7cmV0dXJuIGF9ZnVuY3Rpb24gYWUoKXt0aGlzLlNDRV9DT05URVhUUz1nYTt2YXIgYj1bXCJzZWxmXCJdLGE9W107dGhpcy5yZXNvdXJjZVVybFdoaXRlbGlzdD1mdW5jdGlvbihhKXthcmd1bWVudHMubGVuZ3RoJiYoYj1HYyhhKSk7cmV0dXJuIGJ9O3RoaXMucmVzb3VyY2VVcmxCbGFja2xpc3Q9ZnVuY3Rpb24oYil7YXJndW1lbnRzLmxlbmd0aCYmKGE9R2MoYikpO3JldHVybiBhfTt0aGlzLiRnZXQ9W1wiJGluamVjdG9yXCIsZnVuY3Rpb24oYyl7ZnVuY3Rpb24gZChhKXt2YXIgYj1mdW5jdGlvbihhKXt0aGlzLiQkdW53cmFwVHJ1c3RlZFZhbHVlPWZ1bmN0aW9uKCl7cmV0dXJuIGF9fTthJiYoYi5wcm90b3R5cGU9bmV3IGEpO2IucHJvdG90eXBlLnZhbHVlT2Y9XG5mdW5jdGlvbigpe3JldHVybiB0aGlzLiQkdW53cmFwVHJ1c3RlZFZhbHVlKCl9O2IucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJCR1bndyYXBUcnVzdGVkVmFsdWUoKS50b1N0cmluZygpfTtyZXR1cm4gYn12YXIgZT1mdW5jdGlvbihhKXt0aHJvdyB1YShcInVuc2FmZVwiKTt9O2MuaGFzKFwiJHNhbml0aXplXCIpJiYoZT1jLmdldChcIiRzYW5pdGl6ZVwiKSk7dmFyIGc9ZCgpLGY9e307ZltnYS5IVE1MXT1kKGcpO2ZbZ2EuQ1NTXT1kKGcpO2ZbZ2EuVVJMXT1kKGcpO2ZbZ2EuSlNdPWQoZyk7ZltnYS5SRVNPVVJDRV9VUkxdPWQoZltnYS5VUkxdKTtyZXR1cm57dHJ1c3RBczpmdW5jdGlvbihhLGIpe3ZhciBjPWYuaGFzT3duUHJvcGVydHkoYSk/ZlthXTpudWxsO2lmKCFjKXRocm93IHVhKFwiaWNvbnRleHRcIixhLGIpO2lmKG51bGw9PT1ifHxiPT09c3x8XCJcIj09PWIpcmV0dXJuIGI7aWYoXCJzdHJpbmdcIiE9PXR5cGVvZiBiKXRocm93IHVhKFwiaXR5cGVcIixhKTtyZXR1cm4gbmV3IGMoYil9LFxuZ2V0VHJ1c3RlZDpmdW5jdGlvbihjLGQpe2lmKG51bGw9PT1kfHxkPT09c3x8XCJcIj09PWQpcmV0dXJuIGQ7dmFyIGc9Zi5oYXNPd25Qcm9wZXJ0eShjKT9mW2NdOm51bGw7aWYoZyYmZCBpbnN0YW5jZW9mIGcpcmV0dXJuIGQuJCR1bndyYXBUcnVzdGVkVmFsdWUoKTtpZihjPT09Z2EuUkVTT1VSQ0VfVVJMKXt2YXIgZz1zYShkLnRvU3RyaW5nKCkpLG0sbixwPSExO209MDtmb3Iobj1iLmxlbmd0aDttPG47bSsrKWlmKFwic2VsZlwiPT09YlttXT9JYihnKTpiW21dLmV4ZWMoZy5ocmVmKSl7cD0hMDticmVha31pZihwKWZvcihtPTAsbj1hLmxlbmd0aDttPG47bSsrKWlmKFwic2VsZlwiPT09YVttXT9JYihnKTphW21dLmV4ZWMoZy5ocmVmKSl7cD0hMTticmVha31pZihwKXJldHVybiBkO3Rocm93IHVhKFwiaW5zZWN1cmxcIixkLnRvU3RyaW5nKCkpO31pZihjPT09Z2EuSFRNTClyZXR1cm4gZShkKTt0aHJvdyB1YShcInVuc2FmZVwiKTt9LHZhbHVlT2Y6ZnVuY3Rpb24oYSl7cmV0dXJuIGEgaW5zdGFuY2VvZlxuZz9hLiQkdW53cmFwVHJ1c3RlZFZhbHVlKCk6YX19fV19ZnVuY3Rpb24gJGQoKXt2YXIgYj0hMDt0aGlzLmVuYWJsZWQ9ZnVuY3Rpb24oYSl7YXJndW1lbnRzLmxlbmd0aCYmKGI9ISFhKTtyZXR1cm4gYn07dGhpcy4kZ2V0PVtcIiRwYXJzZVwiLFwiJHNuaWZmZXJcIixcIiRzY2VEZWxlZ2F0ZVwiLGZ1bmN0aW9uKGEsYyxkKXtpZihiJiZjLm1zaWUmJjg+Yy5tc2llRG9jdW1lbnRNb2RlKXRocm93IHVhKFwiaWVxdWlya3NcIik7dmFyIGU9YmEoZ2EpO2UuaXNFbmFibGVkPWZ1bmN0aW9uKCl7cmV0dXJuIGJ9O2UudHJ1c3RBcz1kLnRydXN0QXM7ZS5nZXRUcnVzdGVkPWQuZ2V0VHJ1c3RlZDtlLnZhbHVlT2Y9ZC52YWx1ZU9mO2J8fChlLnRydXN0QXM9ZS5nZXRUcnVzdGVkPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGJ9LGUudmFsdWVPZj1EYSk7ZS5wYXJzZUFzPWZ1bmN0aW9uKGIsYyl7dmFyIGQ9YShjKTtyZXR1cm4gZC5saXRlcmFsJiZkLmNvbnN0YW50P2Q6ZnVuY3Rpb24oYSxjKXtyZXR1cm4gZS5nZXRUcnVzdGVkKGIsXG5kKGEsYykpfX07dmFyIGc9ZS5wYXJzZUFzLGY9ZS5nZXRUcnVzdGVkLGg9ZS50cnVzdEFzO3EoZ2EsZnVuY3Rpb24oYSxiKXt2YXIgYz1LKGIpO2VbVGEoXCJwYXJzZV9hc19cIitjKV09ZnVuY3Rpb24oYil7cmV0dXJuIGcoYSxiKX07ZVtUYShcImdldF90cnVzdGVkX1wiK2MpXT1mdW5jdGlvbihiKXtyZXR1cm4gZihhLGIpfTtlW1RhKFwidHJ1c3RfYXNfXCIrYyldPWZ1bmN0aW9uKGIpe3JldHVybiBoKGEsYil9fSk7cmV0dXJuIGV9XX1mdW5jdGlvbiBiZSgpe3RoaXMuJGdldD1bXCIkd2luZG93XCIsXCIkZG9jdW1lbnRcIixmdW5jdGlvbihiLGEpe3ZhciBjPXt9LGQ9WSgoL2FuZHJvaWQgKFxcZCspLy5leGVjKEsoKGIubmF2aWdhdG9yfHx7fSkudXNlckFnZW50KSl8fFtdKVsxXSksZT0vQm94ZWUvaS50ZXN0KChiLm5hdmlnYXRvcnx8e30pLnVzZXJBZ2VudCksZz1hWzBdfHx7fSxmPWcuZG9jdW1lbnRNb2RlLGgsbD0vXihNb3p8d2Via2l0fE98bXMpKD89W0EtWl0pLyxrPWcuYm9keSYmZy5ib2R5LnN0eWxlLFxubT0hMSxuPSExO2lmKGspe2Zvcih2YXIgcCBpbiBrKWlmKG09bC5leGVjKHApKXtoPW1bMF07aD1oLnN1YnN0cigwLDEpLnRvVXBwZXJDYXNlKCkraC5zdWJzdHIoMSk7YnJlYWt9aHx8KGg9XCJXZWJraXRPcGFjaXR5XCJpbiBrJiZcIndlYmtpdFwiKTttPSEhKFwidHJhbnNpdGlvblwiaW4ga3x8aCtcIlRyYW5zaXRpb25cImluIGspO249ISEoXCJhbmltYXRpb25cImluIGt8fGgrXCJBbmltYXRpb25cImluIGspOyFkfHxtJiZufHwobT13KGcuYm9keS5zdHlsZS53ZWJraXRUcmFuc2l0aW9uKSxuPXcoZy5ib2R5LnN0eWxlLndlYmtpdEFuaW1hdGlvbikpfXJldHVybntoaXN0b3J5OiEoIWIuaGlzdG9yeXx8IWIuaGlzdG9yeS5wdXNoU3RhdGV8fDQ+ZHx8ZSksaGFzaGNoYW5nZTpcIm9uaGFzaGNoYW5nZVwiaW4gYiYmKCFmfHw3PGYpLGhhc0V2ZW50OmZ1bmN0aW9uKGEpe2lmKFwiaW5wdXRcIj09YSYmOT09UylyZXR1cm4hMTtpZihFKGNbYV0pKXt2YXIgYj1nLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7Y1thXT1cIm9uXCIrXG5hIGluIGJ9cmV0dXJuIGNbYV19LGNzcDpWYigpLHZlbmRvclByZWZpeDpoLHRyYW5zaXRpb25zOm0sYW5pbWF0aW9uczpuLGFuZHJvaWQ6ZCxtc2llOlMsbXNpZURvY3VtZW50TW9kZTpmfX1dfWZ1bmN0aW9uIGRlKCl7dGhpcy4kZ2V0PVtcIiRyb290U2NvcGVcIixcIiRicm93c2VyXCIsXCIkcVwiLFwiJGV4Y2VwdGlvbkhhbmRsZXJcIixmdW5jdGlvbihiLGEsYyxkKXtmdW5jdGlvbiBlKGUsaCxsKXt2YXIgaz1jLmRlZmVyKCksbT1rLnByb21pc2Usbj1CKGwpJiYhbDtoPWEuZGVmZXIoZnVuY3Rpb24oKXt0cnl7ay5yZXNvbHZlKGUoKSl9Y2F0Y2goYSl7ay5yZWplY3QoYSksZChhKX1maW5hbGx5e2RlbGV0ZSBnW20uJCR0aW1lb3V0SWRdfW58fGIuJGFwcGx5KCl9LGgpO20uJCR0aW1lb3V0SWQ9aDtnW2hdPWs7cmV0dXJuIG19dmFyIGc9e307ZS5jYW5jZWw9ZnVuY3Rpb24oYil7cmV0dXJuIGImJmIuJCR0aW1lb3V0SWQgaW4gZz8oZ1tiLiQkdGltZW91dElkXS5yZWplY3QoXCJjYW5jZWxlZFwiKSxcbmRlbGV0ZSBnW2IuJCR0aW1lb3V0SWRdLGEuZGVmZXIuY2FuY2VsKGIuJCR0aW1lb3V0SWQpKTohMX07cmV0dXJuIGV9XX1mdW5jdGlvbiBzYShiLGEpe3ZhciBjPWI7UyYmKFcuc2V0QXR0cmlidXRlKFwiaHJlZlwiLGMpLGM9Vy5ocmVmKTtXLnNldEF0dHJpYnV0ZShcImhyZWZcIixjKTtyZXR1cm57aHJlZjpXLmhyZWYscHJvdG9jb2w6Vy5wcm90b2NvbD9XLnByb3RvY29sLnJlcGxhY2UoLzokLyxcIlwiKTpcIlwiLGhvc3Q6Vy5ob3N0LHNlYXJjaDpXLnNlYXJjaD9XLnNlYXJjaC5yZXBsYWNlKC9eXFw/LyxcIlwiKTpcIlwiLGhhc2g6Vy5oYXNoP1cuaGFzaC5yZXBsYWNlKC9eIy8sXCJcIik6XCJcIixob3N0bmFtZTpXLmhvc3RuYW1lLHBvcnQ6Vy5wb3J0LHBhdGhuYW1lOlwiL1wiPT09Vy5wYXRobmFtZS5jaGFyQXQoMCk/Vy5wYXRobmFtZTpcIi9cIitXLnBhdGhuYW1lfX1mdW5jdGlvbiBJYihiKXtiPXcoYik/c2EoYik6YjtyZXR1cm4gYi5wcm90b2NvbD09PUhjLnByb3RvY29sJiZiLmhvc3Q9PT1IYy5ob3N0fVxuZnVuY3Rpb24gZWUoKXt0aGlzLiRnZXQ9YWEoTyl9ZnVuY3Rpb24gZ2MoYil7ZnVuY3Rpb24gYShkLGUpe2lmKFgoZCkpe3ZhciBnPXt9O3EoZCxmdW5jdGlvbihiLGMpe2dbY109YShjLGIpfSk7cmV0dXJuIGd9cmV0dXJuIGIuZmFjdG9yeShkK2MsZSl9dmFyIGM9XCJGaWx0ZXJcIjt0aGlzLnJlZ2lzdGVyPWE7dGhpcy4kZ2V0PVtcIiRpbmplY3RvclwiLGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gYS5nZXQoYitjKX19XTthKFwiY3VycmVuY3lcIixJYyk7YShcImRhdGVcIixKYyk7YShcImZpbHRlclwiLEJlKTthKFwianNvblwiLENlKTthKFwibGltaXRUb1wiLERlKTthKFwibG93ZXJjYXNlXCIsRWUpO2EoXCJudW1iZXJcIixLYyk7YShcIm9yZGVyQnlcIixMYyk7YShcInVwcGVyY2FzZVwiLEZlKX1mdW5jdGlvbiBCZSgpe3JldHVybiBmdW5jdGlvbihiLGEsYyl7aWYoIU0oYikpcmV0dXJuIGI7dmFyIGQ9dHlwZW9mIGMsZT1bXTtlLmNoZWNrPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wO2I8ZS5sZW5ndGg7YisrKWlmKCFlW2JdKGEpKXJldHVybiExO1xucmV0dXJuITB9O1wiZnVuY3Rpb25cIiE9PWQmJihjPVwiYm9vbGVhblwiPT09ZCYmYz9mdW5jdGlvbihhLGIpe3JldHVybiBFYS5lcXVhbHMoYSxiKX06ZnVuY3Rpb24oYSxiKXtpZihhJiZiJiZcIm9iamVjdFwiPT09dHlwZW9mIGEmJlwib2JqZWN0XCI9PT10eXBlb2YgYil7Zm9yKHZhciBkIGluIGEpaWYoXCIkXCIhPT1kLmNoYXJBdCgwKSYmRmMuY2FsbChhLGQpJiZjKGFbZF0sYltkXSkpcmV0dXJuITA7cmV0dXJuITF9Yj0oXCJcIitiKS50b0xvd2VyQ2FzZSgpO3JldHVybi0xPChcIlwiK2EpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihiKX0pO3ZhciBnPWZ1bmN0aW9uKGEsYil7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGImJlwiIVwiPT09Yi5jaGFyQXQoMCkpcmV0dXJuIWcoYSxiLnN1YnN0cigxKSk7c3dpdGNoKHR5cGVvZiBhKXtjYXNlIFwiYm9vbGVhblwiOmNhc2UgXCJudW1iZXJcIjpjYXNlIFwic3RyaW5nXCI6cmV0dXJuIGMoYSxiKTtjYXNlIFwib2JqZWN0XCI6c3dpdGNoKHR5cGVvZiBiKXtjYXNlIFwib2JqZWN0XCI6cmV0dXJuIGMoYSxcbmIpO2RlZmF1bHQ6Zm9yKHZhciBkIGluIGEpaWYoXCIkXCIhPT1kLmNoYXJBdCgwKSYmZyhhW2RdLGIpKXJldHVybiEwfXJldHVybiExO2Nhc2UgXCJhcnJheVwiOmZvcihkPTA7ZDxhLmxlbmd0aDtkKyspaWYoZyhhW2RdLGIpKXJldHVybiEwO3JldHVybiExO2RlZmF1bHQ6cmV0dXJuITF9fTtzd2l0Y2godHlwZW9mIGEpe2Nhc2UgXCJib29sZWFuXCI6Y2FzZSBcIm51bWJlclwiOmNhc2UgXCJzdHJpbmdcIjphPXskOmF9O2Nhc2UgXCJvYmplY3RcIjpmb3IodmFyIGYgaW4gYSkoZnVuY3Rpb24oYil7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGFbYl0mJmUucHVzaChmdW5jdGlvbihjKXtyZXR1cm4gZyhcIiRcIj09Yj9jOmMmJmNbYl0sYVtiXSl9KX0pKGYpO2JyZWFrO2Nhc2UgXCJmdW5jdGlvblwiOmUucHVzaChhKTticmVhaztkZWZhdWx0OnJldHVybiBifWQ9W107Zm9yKGY9MDtmPGIubGVuZ3RoO2YrKyl7dmFyIGg9YltmXTtlLmNoZWNrKGgpJiZkLnB1c2goaCl9cmV0dXJuIGR9fWZ1bmN0aW9uIEljKGIpe3ZhciBhPVxuYi5OVU1CRVJfRk9STUFUUztyZXR1cm4gZnVuY3Rpb24oYixkKXtFKGQpJiYoZD1hLkNVUlJFTkNZX1NZTSk7cmV0dXJuIE1jKGIsYS5QQVRURVJOU1sxXSxhLkdST1VQX1NFUCxhLkRFQ0lNQUxfU0VQLDIpLnJlcGxhY2UoL1xcdTAwQTQvZyxkKX19ZnVuY3Rpb24gS2MoYil7dmFyIGE9Yi5OVU1CRVJfRk9STUFUUztyZXR1cm4gZnVuY3Rpb24oYixkKXtyZXR1cm4gTWMoYixhLlBBVFRFUk5TWzBdLGEuR1JPVVBfU0VQLGEuREVDSU1BTF9TRVAsZCl9fWZ1bmN0aW9uIE1jKGIsYSxjLGQsZSl7aWYobnVsbD09Ynx8IWlzRmluaXRlKGIpfHxYKGIpKXJldHVyblwiXCI7dmFyIGc9MD5iO2I9TWF0aC5hYnMoYik7dmFyIGY9YitcIlwiLGg9XCJcIixsPVtdLGs9ITE7aWYoLTEhPT1mLmluZGV4T2YoXCJlXCIpKXt2YXIgbT1mLm1hdGNoKC8oW1xcZFxcLl0rKWUoLT8pKFxcZCspLyk7bSYmXCItXCI9PW1bMl0mJm1bM10+ZSsxP2Y9XCIwXCI6KGg9ZixrPSEwKX1pZihrKTA8ZSYmKC0xPGImJjE+YikmJihoPWIudG9GaXhlZChlKSk7XG5lbHNle2Y9KGYuc3BsaXQoTmMpWzFdfHxcIlwiKS5sZW5ndGg7RShlKSYmKGU9TWF0aC5taW4oTWF0aC5tYXgoYS5taW5GcmFjLGYpLGEubWF4RnJhYykpO2Y9TWF0aC5wb3coMTAsZSk7Yj1NYXRoLnJvdW5kKGIqZikvZjtiPShcIlwiK2IpLnNwbGl0KE5jKTtmPWJbMF07Yj1iWzFdfHxcIlwiO3ZhciBtPTAsbj1hLmxnU2l6ZSxwPWEuZ1NpemU7aWYoZi5sZW5ndGg+PW4rcClmb3IobT1mLmxlbmd0aC1uLGs9MDtrPG07aysrKTA9PT0obS1rKSVwJiYwIT09ayYmKGgrPWMpLGgrPWYuY2hhckF0KGspO2ZvcihrPW07azxmLmxlbmd0aDtrKyspMD09PShmLmxlbmd0aC1rKSVuJiYwIT09ayYmKGgrPWMpLGgrPWYuY2hhckF0KGspO2Zvcig7Yi5sZW5ndGg8ZTspYis9XCIwXCI7ZSYmXCIwXCIhPT1lJiYoaCs9ZCtiLnN1YnN0cigwLGUpKX1sLnB1c2goZz9hLm5lZ1ByZTphLnBvc1ByZSk7bC5wdXNoKGgpO2wucHVzaChnP2EubmVnU3VmOmEucG9zU3VmKTtyZXR1cm4gbC5qb2luKFwiXCIpfWZ1bmN0aW9uIE9iKGIsXG5hLGMpe3ZhciBkPVwiXCI7MD5iJiYoZD1cIi1cIixiPS1iKTtmb3IoYj1cIlwiK2I7Yi5sZW5ndGg8YTspYj1cIjBcIitiO2MmJihiPWIuc3Vic3RyKGIubGVuZ3RoLWEpKTtyZXR1cm4gZCtifWZ1bmN0aW9uICQoYixhLGMsZCl7Yz1jfHwwO3JldHVybiBmdW5jdGlvbihlKXtlPWVbXCJnZXRcIitiXSgpO2lmKDA8Y3x8ZT4tYyllKz1jOzA9PT1lJiYtMTI9PWMmJihlPTEyKTtyZXR1cm4gT2IoZSxhLGQpfX1mdW5jdGlvbiBwYihiLGEpe3JldHVybiBmdW5jdGlvbihjLGQpe3ZhciBlPWNbXCJnZXRcIitiXSgpLGc9RmEoYT9cIlNIT1JUXCIrYjpiKTtyZXR1cm4gZFtnXVtlXX19ZnVuY3Rpb24gSmMoYil7ZnVuY3Rpb24gYShhKXt2YXIgYjtpZihiPWEubWF0Y2goYykpe2E9bmV3IERhdGUoMCk7dmFyIGc9MCxmPTAsaD1iWzhdP2Euc2V0VVRDRnVsbFllYXI6YS5zZXRGdWxsWWVhcixsPWJbOF0/YS5zZXRVVENIb3VyczphLnNldEhvdXJzO2JbOV0mJihnPVkoYls5XStiWzEwXSksZj1ZKGJbOV0rYlsxMV0pKTtcbmguY2FsbChhLFkoYlsxXSksWShiWzJdKS0xLFkoYlszXSkpO2c9WShiWzRdfHwwKS1nO2Y9WShiWzVdfHwwKS1mO2g9WShiWzZdfHwwKTtiPU1hdGgucm91bmQoMUUzKnBhcnNlRmxvYXQoXCIwLlwiKyhiWzddfHwwKSkpO2wuY2FsbChhLGcsZixoLGIpfXJldHVybiBhfXZhciBjPS9eKFxcZHs0fSktPyhcXGRcXGQpLT8oXFxkXFxkKSg/OlQoXFxkXFxkKSg/Ojo/KFxcZFxcZCkoPzo6PyhcXGRcXGQpKD86XFwuKFxcZCspKT8pPyk/KFp8KFsrLV0pKFxcZFxcZCk6PyhcXGRcXGQpKT8pPyQvO3JldHVybiBmdW5jdGlvbihjLGUpe3ZhciBnPVwiXCIsZj1bXSxoLGw7ZT1lfHxcIm1lZGl1bURhdGVcIjtlPWIuREFURVRJTUVfRk9STUFUU1tlXXx8ZTt3KGMpJiYoYz1HZS50ZXN0KGMpP1koYyk6YShjKSk7dmIoYykmJihjPW5ldyBEYXRlKGMpKTtpZighTmEoYykpcmV0dXJuIGM7Zm9yKDtlOykobD1IZS5leGVjKGUpKT8oZj1mLmNvbmNhdCh5YS5jYWxsKGwsMSkpLGU9Zi5wb3AoKSk6KGYucHVzaChlKSxlPW51bGwpO3EoZixmdW5jdGlvbihhKXtoPVxuSWVbYV07Zys9aD9oKGMsYi5EQVRFVElNRV9GT1JNQVRTKTphLnJlcGxhY2UoLyheJ3wnJCkvZyxcIlwiKS5yZXBsYWNlKC8nJy9nLFwiJ1wiKX0pO3JldHVybiBnfX1mdW5jdGlvbiBDZSgpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gcWEoYiwhMCl9fWZ1bmN0aW9uIERlKCl7cmV0dXJuIGZ1bmN0aW9uKGIsYSl7aWYoIU0oYikmJiF3KGIpKXJldHVybiBiO2E9WShhKTtpZih3KGIpKXJldHVybiBhPzA8PWE/Yi5zbGljZSgwLGEpOmIuc2xpY2UoYSxiLmxlbmd0aCk6XCJcIjt2YXIgYz1bXSxkLGU7YT5iLmxlbmd0aD9hPWIubGVuZ3RoOmE8LWIubGVuZ3RoJiYoYT0tYi5sZW5ndGgpOzA8YT8oZD0wLGU9YSk6KGQ9Yi5sZW5ndGgrYSxlPWIubGVuZ3RoKTtmb3IoO2Q8ZTtkKyspYy5wdXNoKGJbZF0pO3JldHVybiBjfX1mdW5jdGlvbiBMYyhiKXtyZXR1cm4gZnVuY3Rpb24oYSxjLGQpe2Z1bmN0aW9uIGUoYSxiKXtyZXR1cm4gUWEoYik/ZnVuY3Rpb24oYixjKXtyZXR1cm4gYShjLGIpfTphfVxuZnVuY3Rpb24gZyhhLGIpe3ZhciBjPXR5cGVvZiBhLGQ9dHlwZW9mIGI7cmV0dXJuIGM9PWQ/KFwic3RyaW5nXCI9PWMmJihhPWEudG9Mb3dlckNhc2UoKSxiPWIudG9Mb3dlckNhc2UoKSksYT09PWI/MDphPGI/LTE6MSk6YzxkPy0xOjF9aWYoIU0oYSl8fCFjKXJldHVybiBhO2M9TShjKT9jOltjXTtjPVVjKGMsZnVuY3Rpb24oYSl7dmFyIGM9ITEsZD1hfHxEYTtpZih3KGEpKXtpZihcIitcIj09YS5jaGFyQXQoMCl8fFwiLVwiPT1hLmNoYXJBdCgwKSljPVwiLVwiPT1hLmNoYXJBdCgwKSxhPWEuc3Vic3RyaW5nKDEpO2Q9YihhKTtpZihkLmNvbnN0YW50KXt2YXIgZj1kKCk7cmV0dXJuIGUoZnVuY3Rpb24oYSxiKXtyZXR1cm4gZyhhW2ZdLGJbZl0pfSxjKX19cmV0dXJuIGUoZnVuY3Rpb24oYSxiKXtyZXR1cm4gZyhkKGEpLGQoYikpfSxjKX0pO2Zvcih2YXIgZj1bXSxoPTA7aDxhLmxlbmd0aDtoKyspZi5wdXNoKGFbaF0pO3JldHVybiBmLnNvcnQoZShmdW5jdGlvbihhLGIpe2Zvcih2YXIgZD1cbjA7ZDxjLmxlbmd0aDtkKyspe3ZhciBlPWNbZF0oYSxiKTtpZigwIT09ZSlyZXR1cm4gZX1yZXR1cm4gMH0sZCkpfX1mdW5jdGlvbiB2YShiKXtQKGIpJiYoYj17bGluazpifSk7Yi5yZXN0cmljdD1iLnJlc3RyaWN0fHxcIkFDXCI7cmV0dXJuIGFhKGIpfWZ1bmN0aW9uIE9jKGIsYSxjLGQpe2Z1bmN0aW9uIGUoYSxjKXtjPWM/XCItXCIrZmIoYyxcIi1cIik6XCJcIjtkLnJlbW92ZUNsYXNzKGIsKGE/cWI6cmIpK2MpO2QuYWRkQ2xhc3MoYiwoYT9yYjpxYikrYyl9dmFyIGc9dGhpcyxmPWIucGFyZW50KCkuY29udHJvbGxlcihcImZvcm1cIil8fHNiLGg9MCxsPWcuJGVycm9yPXt9LGs9W107Zy4kbmFtZT1hLm5hbWV8fGEubmdGb3JtO2cuJGRpcnR5PSExO2cuJHByaXN0aW5lPSEwO2cuJHZhbGlkPSEwO2cuJGludmFsaWQ9ITE7Zi4kYWRkQ29udHJvbChnKTtiLmFkZENsYXNzKExhKTtlKCEwKTtnLiRhZGRDb250cm9sPWZ1bmN0aW9uKGEpe0FhKGEuJG5hbWUsXCJpbnB1dFwiKTtrLnB1c2goYSk7YS4kbmFtZSYmXG4oZ1thLiRuYW1lXT1hKX07Zy4kcmVtb3ZlQ29udHJvbD1mdW5jdGlvbihhKXthLiRuYW1lJiZnW2EuJG5hbWVdPT09YSYmZGVsZXRlIGdbYS4kbmFtZV07cShsLGZ1bmN0aW9uKGIsYyl7Zy4kc2V0VmFsaWRpdHkoYywhMCxhKX0pO09hKGssYSl9O2cuJHNldFZhbGlkaXR5PWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1sW2FdO2lmKGIpZCYmKE9hKGQsYyksZC5sZW5ndGh8fChoLS0saHx8KGUoYiksZy4kdmFsaWQ9ITAsZy4kaW52YWxpZD0hMSksbFthXT0hMSxlKCEwLGEpLGYuJHNldFZhbGlkaXR5KGEsITAsZykpKTtlbHNle2h8fGUoYik7aWYoZCl7aWYoLTEhPWRiKGQsYykpcmV0dXJufWVsc2UgbFthXT1kPVtdLGgrKyxlKCExLGEpLGYuJHNldFZhbGlkaXR5KGEsITEsZyk7ZC5wdXNoKGMpO2cuJHZhbGlkPSExO2cuJGludmFsaWQ9ITB9fTtnLiRzZXREaXJ0eT1mdW5jdGlvbigpe2QucmVtb3ZlQ2xhc3MoYixMYSk7ZC5hZGRDbGFzcyhiLHRiKTtnLiRkaXJ0eT0hMDtnLiRwcmlzdGluZT1cbiExO2YuJHNldERpcnR5KCl9O2cuJHNldFByaXN0aW5lPWZ1bmN0aW9uKCl7ZC5yZW1vdmVDbGFzcyhiLHRiKTtkLmFkZENsYXNzKGIsTGEpO2cuJGRpcnR5PSExO2cuJHByaXN0aW5lPSEwO3EoayxmdW5jdGlvbihhKXthLiRzZXRQcmlzdGluZSgpfSl9fWZ1bmN0aW9uIHBhKGIsYSxjLGQpe2IuJHNldFZhbGlkaXR5KGEsYyk7cmV0dXJuIGM/ZDpzfWZ1bmN0aW9uIEplKGIsYSxjKXt2YXIgZD1jLnByb3AoXCJ2YWxpZGl0eVwiKTtYKGQpJiZiLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24oYyl7aWYoYi4kZXJyb3JbYV18fCEoZC5iYWRJbnB1dHx8ZC5jdXN0b21FcnJvcnx8ZC50eXBlTWlzbWF0Y2gpfHxkLnZhbHVlTWlzc2luZylyZXR1cm4gYztiLiRzZXRWYWxpZGl0eShhLCExKX0pfWZ1bmN0aW9uIHViKGIsYSxjLGQsZSxnKXt2YXIgZj1hLnByb3AoXCJ2YWxpZGl0eVwiKTtpZighZS5hbmRyb2lkKXt2YXIgaD0hMTthLm9uKFwiY29tcG9zaXRpb25zdGFydFwiLGZ1bmN0aW9uKGEpe2g9ITB9KTtcbmEub24oXCJjb21wb3NpdGlvbmVuZFwiLGZ1bmN0aW9uKCl7aD0hMTtsKCl9KX12YXIgbD1mdW5jdGlvbigpe2lmKCFoKXt2YXIgZT1hLnZhbCgpO1FhKGMubmdUcmltfHxcIlRcIikmJihlPWNhKGUpKTtpZihkLiR2aWV3VmFsdWUhPT1lfHxmJiZcIlwiPT09ZSYmIWYudmFsdWVNaXNzaW5nKWIuJCRwaGFzZT9kLiRzZXRWaWV3VmFsdWUoZSk6Yi4kYXBwbHkoZnVuY3Rpb24oKXtkLiRzZXRWaWV3VmFsdWUoZSl9KX19O2lmKGUuaGFzRXZlbnQoXCJpbnB1dFwiKSlhLm9uKFwiaW5wdXRcIixsKTtlbHNle3ZhciBrLG09ZnVuY3Rpb24oKXtrfHwoaz1nLmRlZmVyKGZ1bmN0aW9uKCl7bCgpO2s9bnVsbH0pKX07YS5vbihcImtleWRvd25cIixmdW5jdGlvbihhKXthPWEua2V5Q29kZTs5MT09PWF8fCgxNTxhJiYxOT5hfHwzNzw9YSYmNDA+PWEpfHxtKCl9KTtpZihlLmhhc0V2ZW50KFwicGFzdGVcIikpYS5vbihcInBhc3RlIGN1dFwiLG0pfWEub24oXCJjaGFuZ2VcIixsKTtkLiRyZW5kZXI9ZnVuY3Rpb24oKXthLnZhbChkLiRpc0VtcHR5KGQuJHZpZXdWYWx1ZSk/XG5cIlwiOmQuJHZpZXdWYWx1ZSl9O3ZhciBuPWMubmdQYXR0ZXJuO24mJigoZT1uLm1hdGNoKC9eXFwvKC4qKVxcLyhbZ2ltXSopJC8pKT8obj1SZWdFeHAoZVsxXSxlWzJdKSxlPWZ1bmN0aW9uKGEpe3JldHVybiBwYShkLFwicGF0dGVyblwiLGQuJGlzRW1wdHkoYSl8fG4udGVzdChhKSxhKX0pOmU9ZnVuY3Rpb24oYyl7dmFyIGU9Yi4kZXZhbChuKTtpZighZXx8IWUudGVzdCl0aHJvdyB0KFwibmdQYXR0ZXJuXCIpKFwibm9yZWdleHBcIixuLGUsaGEoYSkpO3JldHVybiBwYShkLFwicGF0dGVyblwiLGQuJGlzRW1wdHkoYyl8fGUudGVzdChjKSxjKX0sZC4kZm9ybWF0dGVycy5wdXNoKGUpLGQuJHBhcnNlcnMucHVzaChlKSk7aWYoYy5uZ01pbmxlbmd0aCl7dmFyIHA9WShjLm5nTWlubGVuZ3RoKTtlPWZ1bmN0aW9uKGEpe3JldHVybiBwYShkLFwibWlubGVuZ3RoXCIsZC4kaXNFbXB0eShhKXx8YS5sZW5ndGg+PXAsYSl9O2QuJHBhcnNlcnMucHVzaChlKTtkLiRmb3JtYXR0ZXJzLnB1c2goZSl9aWYoYy5uZ01heGxlbmd0aCl7dmFyIHI9XG5ZKGMubmdNYXhsZW5ndGgpO2U9ZnVuY3Rpb24oYSl7cmV0dXJuIHBhKGQsXCJtYXhsZW5ndGhcIixkLiRpc0VtcHR5KGEpfHxhLmxlbmd0aDw9cixhKX07ZC4kcGFyc2Vycy5wdXNoKGUpO2QuJGZvcm1hdHRlcnMucHVzaChlKX19ZnVuY3Rpb24gUGIoYixhKXtiPVwibmdDbGFzc1wiK2I7cmV0dXJuW1wiJGFuaW1hdGVcIixmdW5jdGlvbihjKXtmdW5jdGlvbiBkKGEsYil7dmFyIGM9W10sZD0wO2E6Zm9yKDtkPGEubGVuZ3RoO2QrKyl7Zm9yKHZhciBlPWFbZF0sbT0wO208Yi5sZW5ndGg7bSsrKWlmKGU9PWJbbV0pY29udGludWUgYTtjLnB1c2goZSl9cmV0dXJuIGN9ZnVuY3Rpb24gZShhKXtpZighTShhKSl7aWYodyhhKSlyZXR1cm4gYS5zcGxpdChcIiBcIik7aWYoWChhKSl7dmFyIGI9W107cShhLGZ1bmN0aW9uKGEsYyl7YSYmYi5wdXNoKGMpfSk7cmV0dXJuIGJ9fXJldHVybiBhfXJldHVybntyZXN0cmljdDpcIkFDXCIsbGluazpmdW5jdGlvbihnLGYsaCl7ZnVuY3Rpb24gbChhLGIpe3ZhciBjPVxuZi5kYXRhKFwiJGNsYXNzQ291bnRzXCIpfHx7fSxkPVtdO3EoYSxmdW5jdGlvbihhKXtpZigwPGJ8fGNbYV0pY1thXT0oY1thXXx8MCkrYixjW2FdPT09KygwPGIpJiZkLnB1c2goYSl9KTtmLmRhdGEoXCIkY2xhc3NDb3VudHNcIixjKTtyZXR1cm4gZC5qb2luKFwiIFwiKX1mdW5jdGlvbiBrKGIpe2lmKCEwPT09YXx8Zy4kaW5kZXglMj09PWEpe3ZhciBrPWUoYnx8W10pO2lmKCFtKXt2YXIgcj1sKGssMSk7aC4kYWRkQ2xhc3Mocil9ZWxzZSBpZigheGEoYixtKSl7dmFyIHE9ZShtKSxyPWQoayxxKSxrPWQocSxrKSxrPWwoaywtMSkscj1sKHIsMSk7MD09PXIubGVuZ3RoP2MucmVtb3ZlQ2xhc3MoZixrKTowPT09ay5sZW5ndGg/Yy5hZGRDbGFzcyhmLHIpOmMuc2V0Q2xhc3MoZixyLGspfX1tPWJhKGIpfXZhciBtO2cuJHdhdGNoKGhbYl0saywhMCk7aC4kb2JzZXJ2ZShcImNsYXNzXCIsZnVuY3Rpb24oYSl7ayhnLiRldmFsKGhbYl0pKX0pO1wibmdDbGFzc1wiIT09YiYmZy4kd2F0Y2goXCIkaW5kZXhcIixcbmZ1bmN0aW9uKGMsZCl7dmFyIGY9YyYxO2lmKGYhPT1kJjEpe3ZhciBrPWUoZy4kZXZhbChoW2JdKSk7Zj09PWE/KGY9bChrLDEpLGguJGFkZENsYXNzKGYpKTooZj1sKGssLTEpLGguJHJlbW92ZUNsYXNzKGYpKX19KX19fV19dmFyIEs9ZnVuY3Rpb24oYil7cmV0dXJuIHcoYik/Yi50b0xvd2VyQ2FzZSgpOmJ9LEZjPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksRmE9ZnVuY3Rpb24oYil7cmV0dXJuIHcoYik/Yi50b1VwcGVyQ2FzZSgpOmJ9LFMseSxHYSx5YT1bXS5zbGljZSxLZT1bXS5wdXNoLHdhPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsUGE9dChcIm5nXCIpLEVhPU8uYW5ndWxhcnx8KE8uYW5ndWxhcj17fSksU2EsS2Esa2E9W1wiMFwiLFwiMFwiLFwiMFwiXTtTPVkoKC9tc2llIChcXGQrKS8uZXhlYyhLKG5hdmlnYXRvci51c2VyQWdlbnQpKXx8W10pWzFdKTtpc05hTihTKSYmKFM9WSgoL3RyaWRlbnRcXC8uKjsgcnY6KFxcZCspLy5leGVjKEsobmF2aWdhdG9yLnVzZXJBZ2VudCkpfHxcbltdKVsxXSkpO0MuJGluamVjdD1bXTtEYS4kaW5qZWN0PVtdO3ZhciBjYT1mdW5jdGlvbigpe3JldHVybiBTdHJpbmcucHJvdG90eXBlLnRyaW0/ZnVuY3Rpb24oYil7cmV0dXJuIHcoYik/Yi50cmltKCk6Yn06ZnVuY3Rpb24oYil7cmV0dXJuIHcoYik/Yi5yZXBsYWNlKC9eXFxzXFxzKi8sXCJcIikucmVwbGFjZSgvXFxzXFxzKiQvLFwiXCIpOmJ9fSgpO0thPTk+Uz9mdW5jdGlvbihiKXtiPWIubm9kZU5hbWU/YjpiWzBdO3JldHVybiBiLnNjb3BlTmFtZSYmXCJIVE1MXCIhPWIuc2NvcGVOYW1lP0ZhKGIuc2NvcGVOYW1lK1wiOlwiK2Iubm9kZU5hbWUpOmIubm9kZU5hbWV9OmZ1bmN0aW9uKGIpe3JldHVybiBiLm5vZGVOYW1lP2Iubm9kZU5hbWU6YlswXS5ub2RlTmFtZX07dmFyIFhjPS9bQS1aXS9nLCRjPXtmdWxsOlwiMS4yLjE2XCIsbWFqb3I6MSxtaW5vcjoyLGRvdDoxNixjb2RlTmFtZTpcImJhZGdlci1lbnVtZXJhdGlvblwifSxVYT1OLmNhY2hlPXt9LGdiPU4uZXhwYW5kbz1cIm5nLVwiKyhuZXcgRGF0ZSkuZ2V0VGltZSgpLFxubWU9MSxQYz1PLmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXI/ZnVuY3Rpb24oYixhLGMpe2IuYWRkRXZlbnRMaXN0ZW5lcihhLGMsITEpfTpmdW5jdGlvbihiLGEsYyl7Yi5hdHRhY2hFdmVudChcIm9uXCIrYSxjKX0sRmI9Ty5kb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyP2Z1bmN0aW9uKGIsYSxjKXtiLnJlbW92ZUV2ZW50TGlzdGVuZXIoYSxjLCExKX06ZnVuY3Rpb24oYixhLGMpe2IuZGV0YWNoRXZlbnQoXCJvblwiK2EsYyl9O04uX2RhdGE9ZnVuY3Rpb24oYil7cmV0dXJuIHRoaXMuY2FjaGVbYlt0aGlzLmV4cGFuZG9dXXx8e319O3ZhciBoZT0vKFtcXDpcXC1cXF9dKyguKSkvZyxpZT0vXm1veihbQS1aXSkvLEJiPXQoXCJqcUxpdGVcIiksamU9L148KFxcdyspXFxzKlxcLz8+KD86PFxcL1xcMT58KSQvLENiPS88fCYjP1xcdys7LyxrZT0vPChbXFx3Ol0rKS8sbGU9LzwoPyFhcmVhfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8bGlua3xtZXRhfHBhcmFtKSgoW1xcdzpdKylbXj5dKilcXC8+L2dpLGVhPVxue29wdGlvbjpbMSwnPHNlbGVjdCBtdWx0aXBsZT1cIm11bHRpcGxlXCI+JyxcIjwvc2VsZWN0PlwiXSx0aGVhZDpbMSxcIjx0YWJsZT5cIixcIjwvdGFibGU+XCJdLGNvbDpbMixcIjx0YWJsZT48Y29sZ3JvdXA+XCIsXCI8L2NvbGdyb3VwPjwvdGFibGU+XCJdLHRyOlsyLFwiPHRhYmxlPjx0Ym9keT5cIixcIjwvdGJvZHk+PC90YWJsZT5cIl0sdGQ6WzMsXCI8dGFibGU+PHRib2R5Pjx0cj5cIixcIjwvdHI+PC90Ym9keT48L3RhYmxlPlwiXSxfZGVmYXVsdDpbMCxcIlwiLFwiXCJdfTtlYS5vcHRncm91cD1lYS5vcHRpb247ZWEudGJvZHk9ZWEudGZvb3Q9ZWEuY29sZ3JvdXA9ZWEuY2FwdGlvbj1lYS50aGVhZDtlYS50aD1lYS50ZDt2YXIgSmE9Ti5wcm90b3R5cGU9e3JlYWR5OmZ1bmN0aW9uKGIpe2Z1bmN0aW9uIGEoKXtjfHwoYz0hMCxiKCkpfXZhciBjPSExO1wiY29tcGxldGVcIj09PVUucmVhZHlTdGF0ZT9zZXRUaW1lb3V0KGEpOih0aGlzLm9uKFwiRE9NQ29udGVudExvYWRlZFwiLGEpLE4oTykub24oXCJsb2FkXCIsYSkpfSx0b1N0cmluZzpmdW5jdGlvbigpe3ZhciBiPVxuW107cSh0aGlzLGZ1bmN0aW9uKGEpe2IucHVzaChcIlwiK2EpfSk7cmV0dXJuXCJbXCIrYi5qb2luKFwiLCBcIikrXCJdXCJ9LGVxOmZ1bmN0aW9uKGIpe3JldHVybiAwPD1iP3kodGhpc1tiXSk6eSh0aGlzW3RoaXMubGVuZ3RoK2JdKX0sbGVuZ3RoOjAscHVzaDpLZSxzb3J0OltdLnNvcnQsc3BsaWNlOltdLnNwbGljZX0sa2I9e307cShcIm11bHRpcGxlIHNlbGVjdGVkIGNoZWNrZWQgZGlzYWJsZWQgcmVhZE9ubHkgcmVxdWlyZWQgb3BlblwiLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihiKXtrYltLKGIpXT1ifSk7dmFyIG5jPXt9O3EoXCJpbnB1dCBzZWxlY3Qgb3B0aW9uIHRleHRhcmVhIGJ1dHRvbiBmb3JtIGRldGFpbHNcIi5zcGxpdChcIiBcIiksZnVuY3Rpb24oYil7bmNbRmEoYildPSEwfSk7cSh7ZGF0YTpqYyxpbmhlcml0ZWREYXRhOmpiLHNjb3BlOmZ1bmN0aW9uKGIpe3JldHVybiB5KGIpLmRhdGEoXCIkc2NvcGVcIil8fGpiKGIucGFyZW50Tm9kZXx8YixbXCIkaXNvbGF0ZVNjb3BlXCIsXCIkc2NvcGVcIl0pfSxcbmlzb2xhdGVTY29wZTpmdW5jdGlvbihiKXtyZXR1cm4geShiKS5kYXRhKFwiJGlzb2xhdGVTY29wZVwiKXx8eShiKS5kYXRhKFwiJGlzb2xhdGVTY29wZU5vVGVtcGxhdGVcIil9LGNvbnRyb2xsZXI6a2MsaW5qZWN0b3I6ZnVuY3Rpb24oYil7cmV0dXJuIGpiKGIsXCIkaW5qZWN0b3JcIil9LHJlbW92ZUF0dHI6ZnVuY3Rpb24oYixhKXtiLnJlbW92ZUF0dHJpYnV0ZShhKX0saGFzQ2xhc3M6R2IsY3NzOmZ1bmN0aW9uKGIsYSxjKXthPVRhKGEpO2lmKEIoYykpYi5zdHlsZVthXT1jO2Vsc2V7dmFyIGQ7OD49UyYmKGQ9Yi5jdXJyZW50U3R5bGUmJmIuY3VycmVudFN0eWxlW2FdLFwiXCI9PT1kJiYoZD1cImF1dG9cIikpO2Q9ZHx8Yi5zdHlsZVthXTs4Pj1TJiYoZD1cIlwiPT09ZD9zOmQpO3JldHVybiBkfX0sYXR0cjpmdW5jdGlvbihiLGEsYyl7dmFyIGQ9SyhhKTtpZihrYltkXSlpZihCKGMpKWM/KGJbYV09ITAsYi5zZXRBdHRyaWJ1dGUoYSxkKSk6KGJbYV09ITEsYi5yZW1vdmVBdHRyaWJ1dGUoZCkpO1xuZWxzZSByZXR1cm4gYlthXXx8KGIuYXR0cmlidXRlcy5nZXROYW1lZEl0ZW0oYSl8fEMpLnNwZWNpZmllZD9kOnM7ZWxzZSBpZihCKGMpKWIuc2V0QXR0cmlidXRlKGEsYyk7ZWxzZSBpZihiLmdldEF0dHJpYnV0ZSlyZXR1cm4gYj1iLmdldEF0dHJpYnV0ZShhLDIpLG51bGw9PT1iP3M6Yn0scHJvcDpmdW5jdGlvbihiLGEsYyl7aWYoQihjKSliW2FdPWM7ZWxzZSByZXR1cm4gYlthXX0sdGV4dDpmdW5jdGlvbigpe2Z1bmN0aW9uIGIoYixkKXt2YXIgZT1hW2Iubm9kZVR5cGVdO2lmKEUoZCkpcmV0dXJuIGU/YltlXTpcIlwiO2JbZV09ZH12YXIgYT1bXTs5PlM/KGFbMV09XCJpbm5lclRleHRcIixhWzNdPVwibm9kZVZhbHVlXCIpOmFbMV09YVszXT1cInRleHRDb250ZW50XCI7Yi4kZHY9XCJcIjtyZXR1cm4gYn0oKSx2YWw6ZnVuY3Rpb24oYixhKXtpZihFKGEpKXtpZihcIlNFTEVDVFwiPT09S2EoYikmJmIubXVsdGlwbGUpe3ZhciBjPVtdO3EoYi5vcHRpb25zLGZ1bmN0aW9uKGEpe2Euc2VsZWN0ZWQmJlxuYy5wdXNoKGEudmFsdWV8fGEudGV4dCl9KTtyZXR1cm4gMD09PWMubGVuZ3RoP251bGw6Y31yZXR1cm4gYi52YWx1ZX1iLnZhbHVlPWF9LGh0bWw6ZnVuY3Rpb24oYixhKXtpZihFKGEpKXJldHVybiBiLmlubmVySFRNTDtmb3IodmFyIGM9MCxkPWIuY2hpbGROb2RlcztjPGQubGVuZ3RoO2MrKylIYShkW2NdKTtiLmlubmVySFRNTD1hfSxlbXB0eTpsY30sZnVuY3Rpb24oYixhKXtOLnByb3RvdHlwZVthXT1mdW5jdGlvbihhLGQpe3ZhciBlLGc7aWYoYiE9PWxjJiYoMj09Yi5sZW5ndGgmJmIhPT1HYiYmYiE9PWtjP2E6ZCk9PT1zKXtpZihYKGEpKXtmb3IoZT0wO2U8dGhpcy5sZW5ndGg7ZSsrKWlmKGI9PT1qYyliKHRoaXNbZV0sYSk7ZWxzZSBmb3IoZyBpbiBhKWIodGhpc1tlXSxnLGFbZ10pO3JldHVybiB0aGlzfWU9Yi4kZHY7Zz1lPT09cz9NYXRoLm1pbih0aGlzLmxlbmd0aCwxKTp0aGlzLmxlbmd0aDtmb3IodmFyIGY9MDtmPGc7ZisrKXt2YXIgaD1iKHRoaXNbZl0sYSxkKTtlPVxuZT9lK2g6aH1yZXR1cm4gZX1mb3IoZT0wO2U8dGhpcy5sZW5ndGg7ZSsrKWIodGhpc1tlXSxhLGQpO3JldHVybiB0aGlzfX0pO3Eoe3JlbW92ZURhdGE6aGMsZGVhbG9jOkhhLG9uOmZ1bmN0aW9uIGEoYyxkLGUsZyl7aWYoQihnKSl0aHJvdyBCYihcIm9uYXJnc1wiKTt2YXIgZj1sYShjLFwiZXZlbnRzXCIpLGg9bGEoYyxcImhhbmRsZVwiKTtmfHxsYShjLFwiZXZlbnRzXCIsZj17fSk7aHx8bGEoYyxcImhhbmRsZVwiLGg9bmUoYyxmKSk7cShkLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihkKXt2YXIgZz1mW2RdO2lmKCFnKXtpZihcIm1vdXNlZW50ZXJcIj09ZHx8XCJtb3VzZWxlYXZlXCI9PWQpe3ZhciBtPVUuYm9keS5jb250YWluc3x8VS5ib2R5LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uP2Z1bmN0aW9uKGEsYyl7dmFyIGQ9OT09PWEubm9kZVR5cGU/YS5kb2N1bWVudEVsZW1lbnQ6YSxlPWMmJmMucGFyZW50Tm9kZTtyZXR1cm4gYT09PWV8fCEhKGUmJjE9PT1lLm5vZGVUeXBlJiYoZC5jb250YWlucz9kLmNvbnRhaW5zKGUpOlxuYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiYmYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihlKSYxNikpfTpmdW5jdGlvbihhLGMpe2lmKGMpZm9yKDtjPWMucGFyZW50Tm9kZTspaWYoYz09PWEpcmV0dXJuITA7cmV0dXJuITF9O2ZbZF09W107YShjLHttb3VzZWxlYXZlOlwibW91c2VvdXRcIixtb3VzZWVudGVyOlwibW91c2VvdmVyXCJ9W2RdLGZ1bmN0aW9uKGEpe3ZhciBjPWEucmVsYXRlZFRhcmdldDtjJiYoYz09PXRoaXN8fG0odGhpcyxjKSl8fGgoYSxkKX0pfWVsc2UgUGMoYyxkLGgpLGZbZF09W107Zz1mW2RdfWcucHVzaChlKX0pfSxvZmY6aWMsb25lOmZ1bmN0aW9uKGEsYyxkKXthPXkoYSk7YS5vbihjLGZ1bmN0aW9uIGcoKXthLm9mZihjLGQpO2Eub2ZmKGMsZyl9KTthLm9uKGMsZCl9LHJlcGxhY2VXaXRoOmZ1bmN0aW9uKGEsYyl7dmFyIGQsZT1hLnBhcmVudE5vZGU7SGEoYSk7cShuZXcgTihjKSxmdW5jdGlvbihjKXtkP2UuaW5zZXJ0QmVmb3JlKGMsZC5uZXh0U2libGluZyk6XG5lLnJlcGxhY2VDaGlsZChjLGEpO2Q9Y30pfSxjaGlsZHJlbjpmdW5jdGlvbihhKXt2YXIgYz1bXTtxKGEuY2hpbGROb2RlcyxmdW5jdGlvbihhKXsxPT09YS5ub2RlVHlwZSYmYy5wdXNoKGEpfSk7cmV0dXJuIGN9LGNvbnRlbnRzOmZ1bmN0aW9uKGEpe3JldHVybiBhLmNvbnRlbnREb2N1bWVudHx8YS5jaGlsZE5vZGVzfHxbXX0sYXBwZW5kOmZ1bmN0aW9uKGEsYyl7cShuZXcgTihjKSxmdW5jdGlvbihjKXsxIT09YS5ub2RlVHlwZSYmMTEhPT1hLm5vZGVUeXBlfHxhLmFwcGVuZENoaWxkKGMpfSl9LHByZXBlbmQ6ZnVuY3Rpb24oYSxjKXtpZigxPT09YS5ub2RlVHlwZSl7dmFyIGQ9YS5maXJzdENoaWxkO3EobmV3IE4oYyksZnVuY3Rpb24oYyl7YS5pbnNlcnRCZWZvcmUoYyxkKX0pfX0sd3JhcDpmdW5jdGlvbihhLGMpe2M9eShjKVswXTt2YXIgZD1hLnBhcmVudE5vZGU7ZCYmZC5yZXBsYWNlQ2hpbGQoYyxhKTtjLmFwcGVuZENoaWxkKGEpfSxyZW1vdmU6ZnVuY3Rpb24oYSl7SGEoYSk7XG52YXIgYz1hLnBhcmVudE5vZGU7YyYmYy5yZW1vdmVDaGlsZChhKX0sYWZ0ZXI6ZnVuY3Rpb24oYSxjKXt2YXIgZD1hLGU9YS5wYXJlbnROb2RlO3EobmV3IE4oYyksZnVuY3Rpb24oYSl7ZS5pbnNlcnRCZWZvcmUoYSxkLm5leHRTaWJsaW5nKTtkPWF9KX0sYWRkQ2xhc3M6aWIscmVtb3ZlQ2xhc3M6aGIsdG9nZ2xlQ2xhc3M6ZnVuY3Rpb24oYSxjLGQpe2MmJnEoYy5zcGxpdChcIiBcIiksZnVuY3Rpb24oYyl7dmFyIGc9ZDtFKGcpJiYoZz0hR2IoYSxjKSk7KGc/aWI6aGIpKGEsYyl9KX0scGFyZW50OmZ1bmN0aW9uKGEpe3JldHVybihhPWEucGFyZW50Tm9kZSkmJjExIT09YS5ub2RlVHlwZT9hOm51bGx9LG5leHQ6ZnVuY3Rpb24oYSl7aWYoYS5uZXh0RWxlbWVudFNpYmxpbmcpcmV0dXJuIGEubmV4dEVsZW1lbnRTaWJsaW5nO2ZvcihhPWEubmV4dFNpYmxpbmc7bnVsbCE9YSYmMSE9PWEubm9kZVR5cGU7KWE9YS5uZXh0U2libGluZztyZXR1cm4gYX0sZmluZDpmdW5jdGlvbihhLGMpe3JldHVybiBhLmdldEVsZW1lbnRzQnlUYWdOYW1lP1xuYS5nZXRFbGVtZW50c0J5VGFnTmFtZShjKTpbXX0sY2xvbmU6RWIsdHJpZ2dlckhhbmRsZXI6ZnVuY3Rpb24oYSxjLGQpe2M9KGxhKGEsXCJldmVudHNcIil8fHt9KVtjXTtkPWR8fFtdO3ZhciBlPVt7cHJldmVudERlZmF1bHQ6QyxzdG9wUHJvcGFnYXRpb246Q31dO3EoYyxmdW5jdGlvbihjKXtjLmFwcGx5KGEsZS5jb25jYXQoZCkpfSl9fSxmdW5jdGlvbihhLGMpe04ucHJvdG90eXBlW2NdPWZ1bmN0aW9uKGMsZSxnKXtmb3IodmFyIGYsaD0wO2g8dGhpcy5sZW5ndGg7aCsrKUUoZik/KGY9YSh0aGlzW2hdLGMsZSxnKSxCKGYpJiYoZj15KGYpKSk6RGIoZixhKHRoaXNbaF0sYyxlLGcpKTtyZXR1cm4gQihmKT9mOnRoaXN9O04ucHJvdG90eXBlLmJpbmQ9Ti5wcm90b3R5cGUub247Ti5wcm90b3R5cGUudW5iaW5kPU4ucHJvdG90eXBlLm9mZn0pO1ZhLnByb3RvdHlwZT17cHV0OmZ1bmN0aW9uKGEsYyl7dGhpc1tJYShhKV09Y30sZ2V0OmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzW0lhKGEpXX0sXG5yZW1vdmU6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpc1thPUlhKGEpXTtkZWxldGUgdGhpc1thXTtyZXR1cm4gY319O3ZhciBwZT0vXmZ1bmN0aW9uXFxzKlteXFwoXSpcXChcXHMqKFteXFwpXSopXFwpL20scWU9LywvLHJlPS9eXFxzKihfPykoXFxTKz8pXFwxXFxzKiQvLG9lPS8oKFxcL1xcLy4qJCl8KFxcL1xcKltcXHNcXFNdKj9cXCpcXC8pKS9tZyxXYT10KFwiJGluamVjdG9yXCIpLExlPXQoXCIkYW5pbWF0ZVwiKSxMZD1bXCIkcHJvdmlkZVwiLGZ1bmN0aW9uKGEpe3RoaXMuJCRzZWxlY3RvcnM9e307dGhpcy5yZWdpc3Rlcj1mdW5jdGlvbihjLGQpe3ZhciBlPWMrXCItYW5pbWF0aW9uXCI7aWYoYyYmXCIuXCIhPWMuY2hhckF0KDApKXRocm93IExlKFwibm90Y3NlbFwiLGMpO3RoaXMuJCRzZWxlY3RvcnNbYy5zdWJzdHIoMSldPWU7YS5mYWN0b3J5KGUsZCl9O3RoaXMuY2xhc3NOYW1lRmlsdGVyPWZ1bmN0aW9uKGEpezE9PT1hcmd1bWVudHMubGVuZ3RoJiYodGhpcy4kJGNsYXNzTmFtZUZpbHRlcj1hIGluc3RhbmNlb2YgUmVnRXhwP1xuYTpudWxsKTtyZXR1cm4gdGhpcy4kJGNsYXNzTmFtZUZpbHRlcn07dGhpcy4kZ2V0PVtcIiR0aW1lb3V0XCIsXCIkJGFzeW5jQ2FsbGJhY2tcIixmdW5jdGlvbihhLGQpe3JldHVybntlbnRlcjpmdW5jdGlvbihhLGMsZixoKXtmP2YuYWZ0ZXIoYSk6KGMmJmNbMF18fChjPWYucGFyZW50KCkpLGMuYXBwZW5kKGEpKTtoJiZkKGgpfSxsZWF2ZTpmdW5jdGlvbihhLGMpe2EucmVtb3ZlKCk7YyYmZChjKX0sbW92ZTpmdW5jdGlvbihhLGMsZCxoKXt0aGlzLmVudGVyKGEsYyxkLGgpfSxhZGRDbGFzczpmdW5jdGlvbihhLGMsZil7Yz13KGMpP2M6TShjKT9jLmpvaW4oXCIgXCIpOlwiXCI7cShhLGZ1bmN0aW9uKGEpe2liKGEsYyl9KTtmJiZkKGYpfSxyZW1vdmVDbGFzczpmdW5jdGlvbihhLGMsZil7Yz13KGMpP2M6TShjKT9jLmpvaW4oXCIgXCIpOlwiXCI7cShhLGZ1bmN0aW9uKGEpe2hiKGEsYyl9KTtmJiZkKGYpfSxzZXRDbGFzczpmdW5jdGlvbihhLGMsZixoKXtxKGEsZnVuY3Rpb24oYSl7aWIoYSxjKTtoYihhLFxuZil9KTtoJiZkKGgpfSxlbmFibGVkOkN9fV19XSxqYT10KFwiJGNvbXBpbGVcIik7Y2MuJGluamVjdD1bXCIkcHJvdmlkZVwiLFwiJCRzYW5pdGl6ZVVyaVByb3ZpZGVyXCJdO3ZhciB0ZT0vXih4W1xcOlxcLV9dfGRhdGFbXFw6XFwtX10pL2ksdmM9dChcIiRpbnRlcnBvbGF0ZVwiKSxNZT0vXihbXlxcPyNdKikoXFw/KFteI10qKSk/KCMoLiopKT8kLyx3ZT17aHR0cDo4MCxodHRwczo0NDMsZnRwOjIxfSxLYj10KFwiJGxvY2F0aW9uXCIpO0FjLnByb3RvdHlwZT1MYi5wcm90b3R5cGU9emMucHJvdG90eXBlPXskJGh0bWw1OiExLCQkcmVwbGFjZTohMSxhYnNVcmw6bmIoXCIkJGFic1VybFwiKSx1cmw6ZnVuY3Rpb24oYSxjKXtpZihFKGEpKXJldHVybiB0aGlzLiQkdXJsO3ZhciBkPU1lLmV4ZWMoYSk7ZFsxXSYmdGhpcy5wYXRoKGRlY29kZVVSSUNvbXBvbmVudChkWzFdKSk7KGRbMl18fGRbMV0pJiZ0aGlzLnNlYXJjaChkWzNdfHxcIlwiKTt0aGlzLmhhc2goZFs1XXx8XCJcIixjKTtyZXR1cm4gdGhpc30scHJvdG9jb2w6bmIoXCIkJHByb3RvY29sXCIpLFxuaG9zdDpuYihcIiQkaG9zdFwiKSxwb3J0Om5iKFwiJCRwb3J0XCIpLHBhdGg6QmMoXCIkJHBhdGhcIixmdW5jdGlvbihhKXtyZXR1cm5cIi9cIj09YS5jaGFyQXQoMCk/YTpcIi9cIithfSksc2VhcmNoOmZ1bmN0aW9uKGEsYyl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gdGhpcy4kJHNlYXJjaDtjYXNlIDE6aWYodyhhKSl0aGlzLiQkc2VhcmNoPVliKGEpO2Vsc2UgaWYoWChhKSl0aGlzLiQkc2VhcmNoPWE7ZWxzZSB0aHJvdyBLYihcImlzcmNoYXJnXCIpO2JyZWFrO2RlZmF1bHQ6RShjKXx8bnVsbD09PWM/ZGVsZXRlIHRoaXMuJCRzZWFyY2hbYV06dGhpcy4kJHNlYXJjaFthXT1jfXRoaXMuJCRjb21wb3NlKCk7cmV0dXJuIHRoaXN9LGhhc2g6QmMoXCIkJGhhc2hcIixEYSkscmVwbGFjZTpmdW5jdGlvbigpe3RoaXMuJCRyZXBsYWNlPSEwO3JldHVybiB0aGlzfX07dmFyIEJhPXQoXCIkcGFyc2VcIiksRWM9e30sdGEsTWE9e1wibnVsbFwiOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LFwidHJ1ZVwiOmZ1bmN0aW9uKCl7cmV0dXJuITB9LFxuXCJmYWxzZVwiOmZ1bmN0aW9uKCl7cmV0dXJuITF9LHVuZGVmaW5lZDpDLFwiK1wiOmZ1bmN0aW9uKGEsYyxkLGUpe2Q9ZChhLGMpO2U9ZShhLGMpO3JldHVybiBCKGQpP0IoZSk/ZCtlOmQ6QihlKT9lOnN9LFwiLVwiOmZ1bmN0aW9uKGEsYyxkLGUpe2Q9ZChhLGMpO2U9ZShhLGMpO3JldHVybihCKGQpP2Q6MCktKEIoZSk/ZTowKX0sXCIqXCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKSplKGEsYyl9LFwiL1wiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYykvZShhLGMpfSxcIiVcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpJWUoYSxjKX0sXCJeXCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKV5lKGEsYyl9LFwiPVwiOkMsXCI9PT1cIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpPT09ZShhLGMpfSxcIiE9PVwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYykhPT1lKGEsYyl9LFwiPT1cIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpPT1lKGEsXG5jKX0sXCIhPVwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYykhPWUoYSxjKX0sXCI8XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKTxlKGEsYyl9LFwiPlwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYyk+ZShhLGMpfSxcIjw9XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKTw9ZShhLGMpfSxcIj49XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKT49ZShhLGMpfSxcIiYmXCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKSYmZShhLGMpfSxcInx8XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKXx8ZShhLGMpfSxcIiZcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpJmUoYSxjKX0sXCJ8XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGUoYSxjKShhLGMsZChhLGMpKX0sXCIhXCI6ZnVuY3Rpb24oYSxjLGQpe3JldHVybiFkKGEsYyl9fSxOZT17bjpcIlxcblwiLGY6XCJcXGZcIixyOlwiXFxyXCIsdDpcIlxcdFwiLHY6XCJcXHZcIixcIidcIjpcIidcIiwnXCInOidcIid9LFxuTmI9ZnVuY3Rpb24oYSl7dGhpcy5vcHRpb25zPWF9O05iLnByb3RvdHlwZT17Y29uc3RydWN0b3I6TmIsbGV4OmZ1bmN0aW9uKGEpe3RoaXMudGV4dD1hO3RoaXMuaW5kZXg9MDt0aGlzLmNoPXM7dGhpcy5sYXN0Q2g9XCI6XCI7dGhpcy50b2tlbnM9W107dmFyIGM7Zm9yKGE9W107dGhpcy5pbmRleDx0aGlzLnRleHQubGVuZ3RoOyl7dGhpcy5jaD10aGlzLnRleHQuY2hhckF0KHRoaXMuaW5kZXgpO2lmKHRoaXMuaXMoXCJcXFwiJ1wiKSl0aGlzLnJlYWRTdHJpbmcodGhpcy5jaCk7ZWxzZSBpZih0aGlzLmlzTnVtYmVyKHRoaXMuY2gpfHx0aGlzLmlzKFwiLlwiKSYmdGhpcy5pc051bWJlcih0aGlzLnBlZWsoKSkpdGhpcy5yZWFkTnVtYmVyKCk7ZWxzZSBpZih0aGlzLmlzSWRlbnQodGhpcy5jaCkpdGhpcy5yZWFkSWRlbnQoKSx0aGlzLndhcyhcInssXCIpJiYoXCJ7XCI9PT1hWzBdJiYoYz10aGlzLnRva2Vuc1t0aGlzLnRva2Vucy5sZW5ndGgtMV0pKSYmKGMuanNvbj0tMT09PWMudGV4dC5pbmRleE9mKFwiLlwiKSk7XG5lbHNlIGlmKHRoaXMuaXMoXCIoKXt9W10uLDs6P1wiKSl0aGlzLnRva2Vucy5wdXNoKHtpbmRleDp0aGlzLmluZGV4LHRleHQ6dGhpcy5jaCxqc29uOnRoaXMud2FzKFwiOlssXCIpJiZ0aGlzLmlzKFwie1tcIil8fHRoaXMuaXMoXCJ9XTosXCIpfSksdGhpcy5pcyhcIntbXCIpJiZhLnVuc2hpZnQodGhpcy5jaCksdGhpcy5pcyhcIn1dXCIpJiZhLnNoaWZ0KCksdGhpcy5pbmRleCsrO2Vsc2UgaWYodGhpcy5pc1doaXRlc3BhY2UodGhpcy5jaCkpe3RoaXMuaW5kZXgrKztjb250aW51ZX1lbHNle3ZhciBkPXRoaXMuY2grdGhpcy5wZWVrKCksZT1kK3RoaXMucGVlaygyKSxnPU1hW3RoaXMuY2hdLGY9TWFbZF0saD1NYVtlXTtoPyh0aGlzLnRva2Vucy5wdXNoKHtpbmRleDp0aGlzLmluZGV4LHRleHQ6ZSxmbjpofSksdGhpcy5pbmRleCs9Myk6Zj8odGhpcy50b2tlbnMucHVzaCh7aW5kZXg6dGhpcy5pbmRleCx0ZXh0OmQsZm46Zn0pLHRoaXMuaW5kZXgrPTIpOmc/KHRoaXMudG9rZW5zLnB1c2goe2luZGV4OnRoaXMuaW5kZXgsXG50ZXh0OnRoaXMuY2gsZm46Zyxqc29uOnRoaXMud2FzKFwiWyw6XCIpJiZ0aGlzLmlzKFwiKy1cIil9KSx0aGlzLmluZGV4Kz0xKTp0aGlzLnRocm93RXJyb3IoXCJVbmV4cGVjdGVkIG5leHQgY2hhcmFjdGVyIFwiLHRoaXMuaW5kZXgsdGhpcy5pbmRleCsxKX10aGlzLmxhc3RDaD10aGlzLmNofXJldHVybiB0aGlzLnRva2Vuc30saXM6ZnVuY3Rpb24oYSl7cmV0dXJuLTEhPT1hLmluZGV4T2YodGhpcy5jaCl9LHdhczpmdW5jdGlvbihhKXtyZXR1cm4tMSE9PWEuaW5kZXhPZih0aGlzLmxhc3RDaCl9LHBlZWs6ZnVuY3Rpb24oYSl7YT1hfHwxO3JldHVybiB0aGlzLmluZGV4K2E8dGhpcy50ZXh0Lmxlbmd0aD90aGlzLnRleHQuY2hhckF0KHRoaXMuaW5kZXgrYSk6ITF9LGlzTnVtYmVyOmZ1bmN0aW9uKGEpe3JldHVyblwiMFwiPD1hJiZcIjlcIj49YX0saXNXaGl0ZXNwYWNlOmZ1bmN0aW9uKGEpe3JldHVyblwiIFwiPT09YXx8XCJcXHJcIj09PWF8fFwiXFx0XCI9PT1hfHxcIlxcblwiPT09YXx8XCJcXHZcIj09PWF8fFwiXFx1MDBhMFwiPT09XG5hfSxpc0lkZW50OmZ1bmN0aW9uKGEpe3JldHVyblwiYVwiPD1hJiZcInpcIj49YXx8XCJBXCI8PWEmJlwiWlwiPj1hfHxcIl9cIj09PWF8fFwiJFwiPT09YX0saXNFeHBPcGVyYXRvcjpmdW5jdGlvbihhKXtyZXR1cm5cIi1cIj09PWF8fFwiK1wiPT09YXx8dGhpcy5pc051bWJlcihhKX0sdGhyb3dFcnJvcjpmdW5jdGlvbihhLGMsZCl7ZD1kfHx0aGlzLmluZGV4O2M9QihjKT9cInMgXCIrYytcIi1cIit0aGlzLmluZGV4K1wiIFtcIit0aGlzLnRleHQuc3Vic3RyaW5nKGMsZCkrXCJdXCI6XCIgXCIrZDt0aHJvdyBCYShcImxleGVyclwiLGEsYyx0aGlzLnRleHQpO30scmVhZE51bWJlcjpmdW5jdGlvbigpe2Zvcih2YXIgYT1cIlwiLGM9dGhpcy5pbmRleDt0aGlzLmluZGV4PHRoaXMudGV4dC5sZW5ndGg7KXt2YXIgZD1LKHRoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCkpO2lmKFwiLlwiPT1kfHx0aGlzLmlzTnVtYmVyKGQpKWErPWQ7ZWxzZXt2YXIgZT10aGlzLnBlZWsoKTtpZihcImVcIj09ZCYmdGhpcy5pc0V4cE9wZXJhdG9yKGUpKWErPVxuZDtlbHNlIGlmKHRoaXMuaXNFeHBPcGVyYXRvcihkKSYmZSYmdGhpcy5pc051bWJlcihlKSYmXCJlXCI9PWEuY2hhckF0KGEubGVuZ3RoLTEpKWErPWQ7ZWxzZSBpZighdGhpcy5pc0V4cE9wZXJhdG9yKGQpfHxlJiZ0aGlzLmlzTnVtYmVyKGUpfHxcImVcIiE9YS5jaGFyQXQoYS5sZW5ndGgtMSkpYnJlYWs7ZWxzZSB0aGlzLnRocm93RXJyb3IoXCJJbnZhbGlkIGV4cG9uZW50XCIpfXRoaXMuaW5kZXgrK31hKj0xO3RoaXMudG9rZW5zLnB1c2goe2luZGV4OmMsdGV4dDphLGpzb246ITAsZm46ZnVuY3Rpb24oKXtyZXR1cm4gYX19KX0scmVhZElkZW50OmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMsYz1cIlwiLGQ9dGhpcy5pbmRleCxlLGcsZixoO3RoaXMuaW5kZXg8dGhpcy50ZXh0Lmxlbmd0aDspe2g9dGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4KTtpZihcIi5cIj09PWh8fHRoaXMuaXNJZGVudChoKXx8dGhpcy5pc051bWJlcihoKSlcIi5cIj09PWgmJihlPXRoaXMuaW5kZXgpLGMrPWg7ZWxzZSBicmVhaztcbnRoaXMuaW5kZXgrK31pZihlKWZvcihnPXRoaXMuaW5kZXg7Zzx0aGlzLnRleHQubGVuZ3RoOyl7aD10aGlzLnRleHQuY2hhckF0KGcpO2lmKFwiKFwiPT09aCl7Zj1jLnN1YnN0cihlLWQrMSk7Yz1jLnN1YnN0cigwLGUtZCk7dGhpcy5pbmRleD1nO2JyZWFrfWlmKHRoaXMuaXNXaGl0ZXNwYWNlKGgpKWcrKztlbHNlIGJyZWFrfWQ9e2luZGV4OmQsdGV4dDpjfTtpZihNYS5oYXNPd25Qcm9wZXJ0eShjKSlkLmZuPU1hW2NdLGQuanNvbj1NYVtjXTtlbHNle3ZhciBsPURjKGMsdGhpcy5vcHRpb25zLHRoaXMudGV4dCk7ZC5mbj1EKGZ1bmN0aW9uKGEsYyl7cmV0dXJuIGwoYSxjKX0se2Fzc2lnbjpmdW5jdGlvbihkLGUpe3JldHVybiBvYihkLGMsZSxhLnRleHQsYS5vcHRpb25zKX19KX10aGlzLnRva2Vucy5wdXNoKGQpO2YmJih0aGlzLnRva2Vucy5wdXNoKHtpbmRleDplLHRleHQ6XCIuXCIsanNvbjohMX0pLHRoaXMudG9rZW5zLnB1c2goe2luZGV4OmUrMSx0ZXh0OmYsanNvbjohMX0pKX0sXG5yZWFkU3RyaW5nOmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMuaW5kZXg7dGhpcy5pbmRleCsrO2Zvcih2YXIgZD1cIlwiLGU9YSxnPSExO3RoaXMuaW5kZXg8dGhpcy50ZXh0Lmxlbmd0aDspe3ZhciBmPXRoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCksZT1lK2Y7aWYoZylcInVcIj09PWY/KGY9dGhpcy50ZXh0LnN1YnN0cmluZyh0aGlzLmluZGV4KzEsdGhpcy5pbmRleCs1KSxmLm1hdGNoKC9bXFxkYS1mXXs0fS9pKXx8dGhpcy50aHJvd0Vycm9yKFwiSW52YWxpZCB1bmljb2RlIGVzY2FwZSBbXFxcXHVcIitmK1wiXVwiKSx0aGlzLmluZGV4Kz00LGQrPVN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQoZiwxNikpKTpkPShnPU5lW2ZdKT9kK2c6ZCtmLGc9ITE7ZWxzZSBpZihcIlxcXFxcIj09PWYpZz0hMDtlbHNle2lmKGY9PT1hKXt0aGlzLmluZGV4Kys7dGhpcy50b2tlbnMucHVzaCh7aW5kZXg6Yyx0ZXh0OmUsc3RyaW5nOmQsanNvbjohMCxmbjpmdW5jdGlvbigpe3JldHVybiBkfX0pO3JldHVybn1kKz1cbmZ9dGhpcy5pbmRleCsrfXRoaXMudGhyb3dFcnJvcihcIlVudGVybWluYXRlZCBxdW90ZVwiLGMpfX07dmFyICRhPWZ1bmN0aW9uKGEsYyxkKXt0aGlzLmxleGVyPWE7dGhpcy4kZmlsdGVyPWM7dGhpcy5vcHRpb25zPWR9OyRhLlpFUk89RChmdW5jdGlvbigpe3JldHVybiAwfSx7Y29uc3RhbnQ6ITB9KTskYS5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOiRhLHBhcnNlOmZ1bmN0aW9uKGEsYyl7dGhpcy50ZXh0PWE7dGhpcy5qc29uPWM7dGhpcy50b2tlbnM9dGhpcy5sZXhlci5sZXgoYSk7YyYmKHRoaXMuYXNzaWdubWVudD10aGlzLmxvZ2ljYWxPUix0aGlzLmZ1bmN0aW9uQ2FsbD10aGlzLmZpZWxkQWNjZXNzPXRoaXMub2JqZWN0SW5kZXg9dGhpcy5maWx0ZXJDaGFpbj1mdW5jdGlvbigpe3RoaXMudGhyb3dFcnJvcihcImlzIG5vdCB2YWxpZCBqc29uXCIse3RleHQ6YSxpbmRleDowfSl9KTt2YXIgZD1jP3RoaXMucHJpbWFyeSgpOnRoaXMuc3RhdGVtZW50cygpOzAhPT10aGlzLnRva2Vucy5sZW5ndGgmJlxudGhpcy50aHJvd0Vycm9yKFwiaXMgYW4gdW5leHBlY3RlZCB0b2tlblwiLHRoaXMudG9rZW5zWzBdKTtkLmxpdGVyYWw9ISFkLmxpdGVyYWw7ZC5jb25zdGFudD0hIWQuY29uc3RhbnQ7cmV0dXJuIGR9LHByaW1hcnk6ZnVuY3Rpb24oKXt2YXIgYTtpZih0aGlzLmV4cGVjdChcIihcIikpYT10aGlzLmZpbHRlckNoYWluKCksdGhpcy5jb25zdW1lKFwiKVwiKTtlbHNlIGlmKHRoaXMuZXhwZWN0KFwiW1wiKSlhPXRoaXMuYXJyYXlEZWNsYXJhdGlvbigpO2Vsc2UgaWYodGhpcy5leHBlY3QoXCJ7XCIpKWE9dGhpcy5vYmplY3QoKTtlbHNle3ZhciBjPXRoaXMuZXhwZWN0KCk7KGE9Yy5mbil8fHRoaXMudGhyb3dFcnJvcihcIm5vdCBhIHByaW1hcnkgZXhwcmVzc2lvblwiLGMpO2MuanNvbiYmKGEuY29uc3RhbnQ9ITAsYS5saXRlcmFsPSEwKX1mb3IodmFyIGQ7Yz10aGlzLmV4cGVjdChcIihcIixcIltcIixcIi5cIik7KVwiKFwiPT09Yy50ZXh0PyhhPXRoaXMuZnVuY3Rpb25DYWxsKGEsZCksZD1udWxsKTpcIltcIj09PWMudGV4dD9cbihkPWEsYT10aGlzLm9iamVjdEluZGV4KGEpKTpcIi5cIj09PWMudGV4dD8oZD1hLGE9dGhpcy5maWVsZEFjY2VzcyhhKSk6dGhpcy50aHJvd0Vycm9yKFwiSU1QT1NTSUJMRVwiKTtyZXR1cm4gYX0sdGhyb3dFcnJvcjpmdW5jdGlvbihhLGMpe3Rocm93IEJhKFwic3ludGF4XCIsYy50ZXh0LGEsYy5pbmRleCsxLHRoaXMudGV4dCx0aGlzLnRleHQuc3Vic3RyaW5nKGMuaW5kZXgpKTt9LHBlZWtUb2tlbjpmdW5jdGlvbigpe2lmKDA9PT10aGlzLnRva2Vucy5sZW5ndGgpdGhyb3cgQmEoXCJ1ZW9lXCIsdGhpcy50ZXh0KTtyZXR1cm4gdGhpcy50b2tlbnNbMF19LHBlZWs6ZnVuY3Rpb24oYSxjLGQsZSl7aWYoMDx0aGlzLnRva2Vucy5sZW5ndGgpe3ZhciBnPXRoaXMudG9rZW5zWzBdLGY9Zy50ZXh0O2lmKGY9PT1hfHxmPT09Y3x8Zj09PWR8fGY9PT1lfHwhKGF8fGN8fGR8fGUpKXJldHVybiBnfXJldHVybiExfSxleHBlY3Q6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuKGE9dGhpcy5wZWVrKGEsYyxkLFxuZSkpPyh0aGlzLmpzb24mJiFhLmpzb24mJnRoaXMudGhyb3dFcnJvcihcImlzIG5vdCB2YWxpZCBqc29uXCIsYSksdGhpcy50b2tlbnMuc2hpZnQoKSxhKTohMX0sY29uc3VtZTpmdW5jdGlvbihhKXt0aGlzLmV4cGVjdChhKXx8dGhpcy50aHJvd0Vycm9yKFwiaXMgdW5leHBlY3RlZCwgZXhwZWN0aW5nIFtcIithK1wiXVwiLHRoaXMucGVlaygpKX0sdW5hcnlGbjpmdW5jdGlvbihhLGMpe3JldHVybiBEKGZ1bmN0aW9uKGQsZSl7cmV0dXJuIGEoZCxlLGMpfSx7Y29uc3RhbnQ6Yy5jb25zdGFudH0pfSx0ZXJuYXJ5Rm46ZnVuY3Rpb24oYSxjLGQpe3JldHVybiBEKGZ1bmN0aW9uKGUsZyl7cmV0dXJuIGEoZSxnKT9jKGUsZyk6ZChlLGcpfSx7Y29uc3RhbnQ6YS5jb25zdGFudCYmYy5jb25zdGFudCYmZC5jb25zdGFudH0pfSxiaW5hcnlGbjpmdW5jdGlvbihhLGMsZCl7cmV0dXJuIEQoZnVuY3Rpb24oZSxnKXtyZXR1cm4gYyhlLGcsYSxkKX0se2NvbnN0YW50OmEuY29uc3RhbnQmJmQuY29uc3RhbnR9KX0sXG5zdGF0ZW1lbnRzOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdOzspaWYoMDx0aGlzLnRva2Vucy5sZW5ndGgmJiF0aGlzLnBlZWsoXCJ9XCIsXCIpXCIsXCI7XCIsXCJdXCIpJiZhLnB1c2godGhpcy5maWx0ZXJDaGFpbigpKSwhdGhpcy5leHBlY3QoXCI7XCIpKXJldHVybiAxPT09YS5sZW5ndGg/YVswXTpmdW5jdGlvbihjLGQpe2Zvcih2YXIgZSxnPTA7ZzxhLmxlbmd0aDtnKyspe3ZhciBmPWFbZ107ZiYmKGU9ZihjLGQpKX1yZXR1cm4gZX19LGZpbHRlckNoYWluOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMuZXhwcmVzc2lvbigpLGM7OylpZihjPXRoaXMuZXhwZWN0KFwifFwiKSlhPXRoaXMuYmluYXJ5Rm4oYSxjLmZuLHRoaXMuZmlsdGVyKCkpO2Vsc2UgcmV0dXJuIGF9LGZpbHRlcjpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmV4cGVjdCgpLGM9dGhpcy4kZmlsdGVyKGEudGV4dCksZD1bXTs7KWlmKGE9dGhpcy5leHBlY3QoXCI6XCIpKWQucHVzaCh0aGlzLmV4cHJlc3Npb24oKSk7ZWxzZXt2YXIgZT1cbmZ1bmN0aW9uKGEsZSxoKXtoPVtoXTtmb3IodmFyIGw9MDtsPGQubGVuZ3RoO2wrKyloLnB1c2goZFtsXShhLGUpKTtyZXR1cm4gYy5hcHBseShhLGgpfTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gZX19fSxleHByZXNzaW9uOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYXNzaWdubWVudCgpfSxhc3NpZ25tZW50OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy50ZXJuYXJ5KCksYyxkO3JldHVybihkPXRoaXMuZXhwZWN0KFwiPVwiKSk/KGEuYXNzaWdufHx0aGlzLnRocm93RXJyb3IoXCJpbXBsaWVzIGFzc2lnbm1lbnQgYnV0IFtcIit0aGlzLnRleHQuc3Vic3RyaW5nKDAsZC5pbmRleCkrXCJdIGNhbiBub3QgYmUgYXNzaWduZWQgdG9cIixkKSxjPXRoaXMudGVybmFyeSgpLGZ1bmN0aW9uKGQsZyl7cmV0dXJuIGEuYXNzaWduKGQsYyhkLGcpLGcpfSk6YX0sdGVybmFyeTpmdW5jdGlvbigpe3ZhciBhPXRoaXMubG9naWNhbE9SKCksYyxkO2lmKHRoaXMuZXhwZWN0KFwiP1wiKSl7Yz10aGlzLnRlcm5hcnkoKTtcbmlmKGQ9dGhpcy5leHBlY3QoXCI6XCIpKXJldHVybiB0aGlzLnRlcm5hcnlGbihhLGMsdGhpcy50ZXJuYXJ5KCkpO3RoaXMudGhyb3dFcnJvcihcImV4cGVjdGVkIDpcIixkKX1lbHNlIHJldHVybiBhfSxsb2dpY2FsT1I6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5sb2dpY2FsQU5EKCksYzs7KWlmKGM9dGhpcy5leHBlY3QoXCJ8fFwiKSlhPXRoaXMuYmluYXJ5Rm4oYSxjLmZuLHRoaXMubG9naWNhbEFORCgpKTtlbHNlIHJldHVybiBhfSxsb2dpY2FsQU5EOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5lcXVhbGl0eSgpLGM7aWYoYz10aGlzLmV4cGVjdChcIiYmXCIpKWE9dGhpcy5iaW5hcnlGbihhLGMuZm4sdGhpcy5sb2dpY2FsQU5EKCkpO3JldHVybiBhfSxlcXVhbGl0eTpmdW5jdGlvbigpe3ZhciBhPXRoaXMucmVsYXRpb25hbCgpLGM7aWYoYz10aGlzLmV4cGVjdChcIj09XCIsXCIhPVwiLFwiPT09XCIsXCIhPT1cIikpYT10aGlzLmJpbmFyeUZuKGEsYy5mbix0aGlzLmVxdWFsaXR5KCkpO3JldHVybiBhfSxcbnJlbGF0aW9uYWw6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmFkZGl0aXZlKCksYztpZihjPXRoaXMuZXhwZWN0KFwiPFwiLFwiPlwiLFwiPD1cIixcIj49XCIpKWE9dGhpcy5iaW5hcnlGbihhLGMuZm4sdGhpcy5yZWxhdGlvbmFsKCkpO3JldHVybiBhfSxhZGRpdGl2ZTpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLm11bHRpcGxpY2F0aXZlKCksYztjPXRoaXMuZXhwZWN0KFwiK1wiLFwiLVwiKTspYT10aGlzLmJpbmFyeUZuKGEsYy5mbix0aGlzLm11bHRpcGxpY2F0aXZlKCkpO3JldHVybiBhfSxtdWx0aXBsaWNhdGl2ZTpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLnVuYXJ5KCksYztjPXRoaXMuZXhwZWN0KFwiKlwiLFwiL1wiLFwiJVwiKTspYT10aGlzLmJpbmFyeUZuKGEsYy5mbix0aGlzLnVuYXJ5KCkpO3JldHVybiBhfSx1bmFyeTpmdW5jdGlvbigpe3ZhciBhO3JldHVybiB0aGlzLmV4cGVjdChcIitcIik/dGhpcy5wcmltYXJ5KCk6KGE9dGhpcy5leHBlY3QoXCItXCIpKT90aGlzLmJpbmFyeUZuKCRhLlpFUk8sYS5mbixcbnRoaXMudW5hcnkoKSk6KGE9dGhpcy5leHBlY3QoXCIhXCIpKT90aGlzLnVuYXJ5Rm4oYS5mbix0aGlzLnVuYXJ5KCkpOnRoaXMucHJpbWFyeSgpfSxmaWVsZEFjY2VzczpmdW5jdGlvbihhKXt2YXIgYz10aGlzLGQ9dGhpcy5leHBlY3QoKS50ZXh0LGU9RGMoZCx0aGlzLm9wdGlvbnMsdGhpcy50ZXh0KTtyZXR1cm4gRChmdW5jdGlvbihjLGQsaCl7cmV0dXJuIGUoaHx8YShjLGQpKX0se2Fzc2lnbjpmdW5jdGlvbihlLGYsaCl7cmV0dXJuIG9iKGEoZSxoKSxkLGYsYy50ZXh0LGMub3B0aW9ucyl9fSl9LG9iamVjdEluZGV4OmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMsZD10aGlzLmV4cHJlc3Npb24oKTt0aGlzLmNvbnN1bWUoXCJdXCIpO3JldHVybiBEKGZ1bmN0aW9uKGUsZyl7dmFyIGY9YShlLGcpLGg9ZChlLGcpLGw7aWYoIWYpcmV0dXJuIHM7KGY9WmEoZltoXSxjLnRleHQpKSYmKGYudGhlbiYmYy5vcHRpb25zLnVud3JhcFByb21pc2VzKSYmKGw9ZixcIiQkdlwiaW4gZnx8KGwuJCR2PXMsbC50aGVuKGZ1bmN0aW9uKGEpe2wuJCR2PVxuYX0pKSxmPWYuJCR2KTtyZXR1cm4gZn0se2Fzc2lnbjpmdW5jdGlvbihlLGcsZil7dmFyIGg9ZChlLGYpO3JldHVybiBaYShhKGUsZiksYy50ZXh0KVtoXT1nfX0pfSxmdW5jdGlvbkNhbGw6ZnVuY3Rpb24oYSxjKXt2YXIgZD1bXTtpZihcIilcIiE9PXRoaXMucGVla1Rva2VuKCkudGV4dCl7ZG8gZC5wdXNoKHRoaXMuZXhwcmVzc2lvbigpKTt3aGlsZSh0aGlzLmV4cGVjdChcIixcIikpfXRoaXMuY29uc3VtZShcIilcIik7dmFyIGU9dGhpcztyZXR1cm4gZnVuY3Rpb24oZyxmKXtmb3IodmFyIGg9W10sbD1jP2MoZyxmKTpnLGs9MDtrPGQubGVuZ3RoO2srKyloLnB1c2goZFtrXShnLGYpKTtrPWEoZyxmLGwpfHxDO1phKGwsZS50ZXh0KTtaYShrLGUudGV4dCk7aD1rLmFwcGx5P2suYXBwbHkobCxoKTprKGhbMF0saFsxXSxoWzJdLGhbM10saFs0XSk7cmV0dXJuIFphKGgsZS50ZXh0KX19LGFycmF5RGVjbGFyYXRpb246ZnVuY3Rpb24oKXt2YXIgYT1bXSxjPSEwO2lmKFwiXVwiIT09dGhpcy5wZWVrVG9rZW4oKS50ZXh0KXtkb3tpZih0aGlzLnBlZWsoXCJdXCIpKWJyZWFrO1xudmFyIGQ9dGhpcy5leHByZXNzaW9uKCk7YS5wdXNoKGQpO2QuY29uc3RhbnR8fChjPSExKX13aGlsZSh0aGlzLmV4cGVjdChcIixcIikpfXRoaXMuY29uc3VtZShcIl1cIik7cmV0dXJuIEQoZnVuY3Rpb24oYyxkKXtmb3IodmFyIGY9W10saD0wO2g8YS5sZW5ndGg7aCsrKWYucHVzaChhW2hdKGMsZCkpO3JldHVybiBmfSx7bGl0ZXJhbDohMCxjb25zdGFudDpjfSl9LG9iamVjdDpmdW5jdGlvbigpe3ZhciBhPVtdLGM9ITA7aWYoXCJ9XCIhPT10aGlzLnBlZWtUb2tlbigpLnRleHQpe2Rve2lmKHRoaXMucGVlayhcIn1cIikpYnJlYWs7dmFyIGQ9dGhpcy5leHBlY3QoKSxkPWQuc3RyaW5nfHxkLnRleHQ7dGhpcy5jb25zdW1lKFwiOlwiKTt2YXIgZT10aGlzLmV4cHJlc3Npb24oKTthLnB1c2goe2tleTpkLHZhbHVlOmV9KTtlLmNvbnN0YW50fHwoYz0hMSl9d2hpbGUodGhpcy5leHBlY3QoXCIsXCIpKX10aGlzLmNvbnN1bWUoXCJ9XCIpO3JldHVybiBEKGZ1bmN0aW9uKGMsZCl7Zm9yKHZhciBlPXt9LGw9MDtsPFxuYS5sZW5ndGg7bCsrKXt2YXIgaz1hW2xdO2Vbay5rZXldPWsudmFsdWUoYyxkKX1yZXR1cm4gZX0se2xpdGVyYWw6ITAsY29uc3RhbnQ6Y30pfX07dmFyIE1iPXt9LHVhPXQoXCIkc2NlXCIpLGdhPXtIVE1MOlwiaHRtbFwiLENTUzpcImNzc1wiLFVSTDpcInVybFwiLFJFU09VUkNFX1VSTDpcInJlc291cmNlVXJsXCIsSlM6XCJqc1wifSxXPVUuY3JlYXRlRWxlbWVudChcImFcIiksSGM9c2EoTy5sb2NhdGlvbi5ocmVmLCEwKTtnYy4kaW5qZWN0PVtcIiRwcm92aWRlXCJdO0ljLiRpbmplY3Q9W1wiJGxvY2FsZVwiXTtLYy4kaW5qZWN0PVtcIiRsb2NhbGVcIl07dmFyIE5jPVwiLlwiLEllPXt5eXl5OiQoXCJGdWxsWWVhclwiLDQpLHl5OiQoXCJGdWxsWWVhclwiLDIsMCwhMCkseTokKFwiRnVsbFllYXJcIiwxKSxNTU1NOnBiKFwiTW9udGhcIiksTU1NOnBiKFwiTW9udGhcIiwhMCksTU06JChcIk1vbnRoXCIsMiwxKSxNOiQoXCJNb250aFwiLDEsMSksZGQ6JChcIkRhdGVcIiwyKSxkOiQoXCJEYXRlXCIsMSksSEg6JChcIkhvdXJzXCIsMiksSDokKFwiSG91cnNcIixcbjEpLGhoOiQoXCJIb3Vyc1wiLDIsLTEyKSxoOiQoXCJIb3Vyc1wiLDEsLTEyKSxtbTokKFwiTWludXRlc1wiLDIpLG06JChcIk1pbnV0ZXNcIiwxKSxzczokKFwiU2Vjb25kc1wiLDIpLHM6JChcIlNlY29uZHNcIiwxKSxzc3M6JChcIk1pbGxpc2Vjb25kc1wiLDMpLEVFRUU6cGIoXCJEYXlcIiksRUVFOnBiKFwiRGF5XCIsITApLGE6ZnVuY3Rpb24oYSxjKXtyZXR1cm4gMTI+YS5nZXRIb3VycygpP2MuQU1QTVNbMF06Yy5BTVBNU1sxXX0sWjpmdW5jdGlvbihhKXthPS0xKmEuZ2V0VGltZXpvbmVPZmZzZXQoKTtyZXR1cm4gYT0oMDw9YT9cIitcIjpcIlwiKSsoT2IoTWF0aFswPGE/XCJmbG9vclwiOlwiY2VpbFwiXShhLzYwKSwyKStPYihNYXRoLmFicyhhJTYwKSwyKSl9fSxIZT0vKCg/OlteeU1kSGhtc2FaRSddKyl8KD86Jyg/OlteJ118JycpKicpfCg/OkUrfHkrfE0rfGQrfEgrfGgrfG0rfHMrfGF8WikpKC4qKS8sR2U9L15cXC0/XFxkKyQvO0pjLiRpbmplY3Q9W1wiJGxvY2FsZVwiXTt2YXIgRWU9YWEoSyksRmU9YWEoRmEpO0xjLiRpbmplY3Q9XG5bXCIkcGFyc2VcIl07dmFyIGNkPWFhKHtyZXN0cmljdDpcIkVcIixjb21waWxlOmZ1bmN0aW9uKGEsYyl7OD49UyYmKGMuaHJlZnx8Yy5uYW1lfHxjLiRzZXQoXCJocmVmXCIsXCJcIiksYS5hcHBlbmQoVS5jcmVhdGVDb21tZW50KFwiSUUgZml4XCIpKSk7aWYoIWMuaHJlZiYmIWMueGxpbmtIcmVmJiYhYy5uYW1lKXJldHVybiBmdW5jdGlvbihhLGMpe3ZhciBnPVwiW29iamVjdCBTVkdBbmltYXRlZFN0cmluZ11cIj09PXdhLmNhbGwoYy5wcm9wKFwiaHJlZlwiKSk/XCJ4bGluazpocmVmXCI6XCJocmVmXCI7Yy5vbihcImNsaWNrXCIsZnVuY3Rpb24oYSl7Yy5hdHRyKGcpfHxhLnByZXZlbnREZWZhdWx0KCl9KX19fSksemI9e307cShrYixmdW5jdGlvbihhLGMpe2lmKFwibXVsdGlwbGVcIiE9YSl7dmFyIGQ9bmEoXCJuZy1cIitjKTt6YltkXT1mdW5jdGlvbigpe3JldHVybntwcmlvcml0eToxMDAsbGluazpmdW5jdGlvbihhLGcsZil7YS4kd2F0Y2goZltkXSxmdW5jdGlvbihhKXtmLiRzZXQoYywhIWEpfSl9fX19fSk7cShbXCJzcmNcIixcblwic3Jjc2V0XCIsXCJocmVmXCJdLGZ1bmN0aW9uKGEpe3ZhciBjPW5hKFwibmctXCIrYSk7emJbY109ZnVuY3Rpb24oKXtyZXR1cm57cHJpb3JpdHk6OTksbGluazpmdW5jdGlvbihkLGUsZyl7dmFyIGY9YSxoPWE7XCJocmVmXCI9PT1hJiZcIltvYmplY3QgU1ZHQW5pbWF0ZWRTdHJpbmddXCI9PT13YS5jYWxsKGUucHJvcChcImhyZWZcIikpJiYoaD1cInhsaW5rSHJlZlwiLGcuJGF0dHJbaF09XCJ4bGluazpocmVmXCIsZj1udWxsKTtnLiRvYnNlcnZlKGMsZnVuY3Rpb24oYSl7YSYmKGcuJHNldChoLGEpLFMmJmYmJmUucHJvcChmLGdbaF0pKX0pfX19fSk7dmFyIHNiPXskYWRkQ29udHJvbDpDLCRyZW1vdmVDb250cm9sOkMsJHNldFZhbGlkaXR5OkMsJHNldERpcnR5OkMsJHNldFByaXN0aW5lOkN9O09jLiRpbmplY3Q9W1wiJGVsZW1lbnRcIixcIiRhdHRyc1wiLFwiJHNjb3BlXCIsXCIkYW5pbWF0ZVwiXTt2YXIgUWM9ZnVuY3Rpb24oYSl7cmV0dXJuW1wiJHRpbWVvdXRcIixmdW5jdGlvbihjKXtyZXR1cm57bmFtZTpcImZvcm1cIixcbnJlc3RyaWN0OmE/XCJFQUNcIjpcIkVcIixjb250cm9sbGVyOk9jLGNvbXBpbGU6ZnVuY3Rpb24oKXtyZXR1cm57cHJlOmZ1bmN0aW9uKGEsZSxnLGYpe2lmKCFnLmFjdGlvbil7dmFyIGg9ZnVuY3Rpb24oYSl7YS5wcmV2ZW50RGVmYXVsdD9hLnByZXZlbnREZWZhdWx0KCk6YS5yZXR1cm5WYWx1ZT0hMX07UGMoZVswXSxcInN1Ym1pdFwiLGgpO2Uub24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7YyhmdW5jdGlvbigpe0ZiKGVbMF0sXCJzdWJtaXRcIixoKX0sMCwhMSl9KX12YXIgbD1lLnBhcmVudCgpLmNvbnRyb2xsZXIoXCJmb3JtXCIpLGs9Zy5uYW1lfHxnLm5nRm9ybTtrJiZvYihhLGssZixrKTtpZihsKWUub24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7bC4kcmVtb3ZlQ29udHJvbChmKTtrJiZvYihhLGsscyxrKTtEKGYsc2IpfSl9fX19fV19LGRkPVFjKCkscWQ9UWMoITApLE9lPS9eKGZ0cHxodHRwfGh0dHBzKTpcXC9cXC8oXFx3Kzp7MCwxfVxcdypAKT8oXFxTKykoOlswLTldKyk/KFxcL3xcXC8oW1xcdyMhOi4/Kz0mJUAhXFwtXFwvXSkpPyQvLFxuUGU9L15bYS16MC05ISMkJSYnKisvPT9eX2B7fH1+Li1dK0BbYS16MC05LV0rKFxcLlthLXowLTktXSspKiQvaSxRZT0vXlxccyooXFwtfFxcKyk/KFxcZCt8KFxcZCooXFwuXFxkKikpKVxccyokLyxSYz17dGV4dDp1YixudW1iZXI6ZnVuY3Rpb24oYSxjLGQsZSxnLGYpe3ViKGEsYyxkLGUsZyxmKTtlLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24oYSl7dmFyIGM9ZS4kaXNFbXB0eShhKTtpZihjfHxRZS50ZXN0KGEpKXJldHVybiBlLiRzZXRWYWxpZGl0eShcIm51bWJlclwiLCEwKSxcIlwiPT09YT9udWxsOmM/YTpwYXJzZUZsb2F0KGEpO2UuJHNldFZhbGlkaXR5KFwibnVtYmVyXCIsITEpO3JldHVybiBzfSk7SmUoZSxcIm51bWJlclwiLGMpO2UuJGZvcm1hdHRlcnMucHVzaChmdW5jdGlvbihhKXtyZXR1cm4gZS4kaXNFbXB0eShhKT9cIlwiOlwiXCIrYX0pO2QubWluJiYoYT1mdW5jdGlvbihhKXt2YXIgYz1wYXJzZUZsb2F0KGQubWluKTtyZXR1cm4gcGEoZSxcIm1pblwiLGUuJGlzRW1wdHkoYSl8fGE+PWMsYSl9LGUuJHBhcnNlcnMucHVzaChhKSxcbmUuJGZvcm1hdHRlcnMucHVzaChhKSk7ZC5tYXgmJihhPWZ1bmN0aW9uKGEpe3ZhciBjPXBhcnNlRmxvYXQoZC5tYXgpO3JldHVybiBwYShlLFwibWF4XCIsZS4kaXNFbXB0eShhKXx8YTw9YyxhKX0sZS4kcGFyc2Vycy5wdXNoKGEpLGUuJGZvcm1hdHRlcnMucHVzaChhKSk7ZS4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKGEpe3JldHVybiBwYShlLFwibnVtYmVyXCIsZS4kaXNFbXB0eShhKXx8dmIoYSksYSl9KX0sdXJsOmZ1bmN0aW9uKGEsYyxkLGUsZyxmKXt1YihhLGMsZCxlLGcsZik7YT1mdW5jdGlvbihhKXtyZXR1cm4gcGEoZSxcInVybFwiLGUuJGlzRW1wdHkoYSl8fE9lLnRlc3QoYSksYSl9O2UuJGZvcm1hdHRlcnMucHVzaChhKTtlLiRwYXJzZXJzLnB1c2goYSl9LGVtYWlsOmZ1bmN0aW9uKGEsYyxkLGUsZyxmKXt1YihhLGMsZCxlLGcsZik7YT1mdW5jdGlvbihhKXtyZXR1cm4gcGEoZSxcImVtYWlsXCIsZS4kaXNFbXB0eShhKXx8UGUudGVzdChhKSxhKX07ZS4kZm9ybWF0dGVycy5wdXNoKGEpO1xuZS4kcGFyc2Vycy5wdXNoKGEpfSxyYWRpbzpmdW5jdGlvbihhLGMsZCxlKXtFKGQubmFtZSkmJmMuYXR0cihcIm5hbWVcIixiYigpKTtjLm9uKFwiY2xpY2tcIixmdW5jdGlvbigpe2NbMF0uY2hlY2tlZCYmYS4kYXBwbHkoZnVuY3Rpb24oKXtlLiRzZXRWaWV3VmFsdWUoZC52YWx1ZSl9KX0pO2UuJHJlbmRlcj1mdW5jdGlvbigpe2NbMF0uY2hlY2tlZD1kLnZhbHVlPT1lLiR2aWV3VmFsdWV9O2QuJG9ic2VydmUoXCJ2YWx1ZVwiLGUuJHJlbmRlcil9LGNoZWNrYm94OmZ1bmN0aW9uKGEsYyxkLGUpe3ZhciBnPWQubmdUcnVlVmFsdWUsZj1kLm5nRmFsc2VWYWx1ZTt3KGcpfHwoZz0hMCk7dyhmKXx8KGY9ITEpO2Mub24oXCJjbGlja1wiLGZ1bmN0aW9uKCl7YS4kYXBwbHkoZnVuY3Rpb24oKXtlLiRzZXRWaWV3VmFsdWUoY1swXS5jaGVja2VkKX0pfSk7ZS4kcmVuZGVyPWZ1bmN0aW9uKCl7Y1swXS5jaGVja2VkPWUuJHZpZXdWYWx1ZX07ZS4kaXNFbXB0eT1mdW5jdGlvbihhKXtyZXR1cm4gYSE9PWd9O1xuZS4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKGEpe3JldHVybiBhPT09Z30pO2UuJHBhcnNlcnMucHVzaChmdW5jdGlvbihhKXtyZXR1cm4gYT9nOmZ9KX0saGlkZGVuOkMsYnV0dG9uOkMsc3VibWl0OkMscmVzZXQ6QyxmaWxlOkN9LGRjPVtcIiRicm93c2VyXCIsXCIkc25pZmZlclwiLGZ1bmN0aW9uKGEsYyl7cmV0dXJue3Jlc3RyaWN0OlwiRVwiLHJlcXVpcmU6XCI/bmdNb2RlbFwiLGxpbms6ZnVuY3Rpb24oZCxlLGcsZil7ZiYmKFJjW0soZy50eXBlKV18fFJjLnRleHQpKGQsZSxnLGYsYyxhKX19fV0scmI9XCJuZy12YWxpZFwiLHFiPVwibmctaW52YWxpZFwiLExhPVwibmctcHJpc3RpbmVcIix0Yj1cIm5nLWRpcnR5XCIsUmU9W1wiJHNjb3BlXCIsXCIkZXhjZXB0aW9uSGFuZGxlclwiLFwiJGF0dHJzXCIsXCIkZWxlbWVudFwiLFwiJHBhcnNlXCIsXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEsYyxkLGUsZyxmKXtmdW5jdGlvbiBoKGEsYyl7Yz1jP1wiLVwiK2ZiKGMsXCItXCIpOlwiXCI7Zi5yZW1vdmVDbGFzcyhlLChhP3FiOnJiKStjKTtcbmYuYWRkQ2xhc3MoZSwoYT9yYjpxYikrYyl9dGhpcy4kbW9kZWxWYWx1ZT10aGlzLiR2aWV3VmFsdWU9TnVtYmVyLk5hTjt0aGlzLiRwYXJzZXJzPVtdO3RoaXMuJGZvcm1hdHRlcnM9W107dGhpcy4kdmlld0NoYW5nZUxpc3RlbmVycz1bXTt0aGlzLiRwcmlzdGluZT0hMDt0aGlzLiRkaXJ0eT0hMTt0aGlzLiR2YWxpZD0hMDt0aGlzLiRpbnZhbGlkPSExO3RoaXMuJG5hbWU9ZC5uYW1lO3ZhciBsPWcoZC5uZ01vZGVsKSxrPWwuYXNzaWduO2lmKCFrKXRocm93IHQoXCJuZ01vZGVsXCIpKFwibm9uYXNzaWduXCIsZC5uZ01vZGVsLGhhKGUpKTt0aGlzLiRyZW5kZXI9Qzt0aGlzLiRpc0VtcHR5PWZ1bmN0aW9uKGEpe3JldHVybiBFKGEpfHxcIlwiPT09YXx8bnVsbD09PWF8fGEhPT1hfTt2YXIgbT1lLmluaGVyaXRlZERhdGEoXCIkZm9ybUNvbnRyb2xsZXJcIil8fHNiLG49MCxwPXRoaXMuJGVycm9yPXt9O2UuYWRkQ2xhc3MoTGEpO2goITApO3RoaXMuJHNldFZhbGlkaXR5PWZ1bmN0aW9uKGEsYyl7cFthXSE9PVxuIWMmJihjPyhwW2FdJiZuLS0sbnx8KGgoITApLHRoaXMuJHZhbGlkPSEwLHRoaXMuJGludmFsaWQ9ITEpKTooaCghMSksdGhpcy4kaW52YWxpZD0hMCx0aGlzLiR2YWxpZD0hMSxuKyspLHBbYV09IWMsaChjLGEpLG0uJHNldFZhbGlkaXR5KGEsYyx0aGlzKSl9O3RoaXMuJHNldFByaXN0aW5lPWZ1bmN0aW9uKCl7dGhpcy4kZGlydHk9ITE7dGhpcy4kcHJpc3RpbmU9ITA7Zi5yZW1vdmVDbGFzcyhlLHRiKTtmLmFkZENsYXNzKGUsTGEpfTt0aGlzLiRzZXRWaWV3VmFsdWU9ZnVuY3Rpb24oZCl7dGhpcy4kdmlld1ZhbHVlPWQ7dGhpcy4kcHJpc3RpbmUmJih0aGlzLiRkaXJ0eT0hMCx0aGlzLiRwcmlzdGluZT0hMSxmLnJlbW92ZUNsYXNzKGUsTGEpLGYuYWRkQ2xhc3MoZSx0YiksbS4kc2V0RGlydHkoKSk7cSh0aGlzLiRwYXJzZXJzLGZ1bmN0aW9uKGEpe2Q9YShkKX0pO3RoaXMuJG1vZGVsVmFsdWUhPT1kJiYodGhpcy4kbW9kZWxWYWx1ZT1kLGsoYSxkKSxxKHRoaXMuJHZpZXdDaGFuZ2VMaXN0ZW5lcnMsXG5mdW5jdGlvbihhKXt0cnl7YSgpfWNhdGNoKGQpe2MoZCl9fSkpfTt2YXIgcj10aGlzO2EuJHdhdGNoKGZ1bmN0aW9uKCl7dmFyIGM9bChhKTtpZihyLiRtb2RlbFZhbHVlIT09Yyl7dmFyIGQ9ci4kZm9ybWF0dGVycyxlPWQubGVuZ3RoO2ZvcihyLiRtb2RlbFZhbHVlPWM7ZS0tOyljPWRbZV0oYyk7ci4kdmlld1ZhbHVlIT09YyYmKHIuJHZpZXdWYWx1ZT1jLHIuJHJlbmRlcigpKX1yZXR1cm4gY30pfV0sRmQ9ZnVuY3Rpb24oKXtyZXR1cm57cmVxdWlyZTpbXCJuZ01vZGVsXCIsXCJeP2Zvcm1cIl0sY29udHJvbGxlcjpSZSxsaW5rOmZ1bmN0aW9uKGEsYyxkLGUpe3ZhciBnPWVbMF0sZj1lWzFdfHxzYjtmLiRhZGRDb250cm9sKGcpO2EuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2YuJHJlbW92ZUNvbnRyb2woZyl9KX19fSxIZD1hYSh7cmVxdWlyZTpcIm5nTW9kZWxcIixsaW5rOmZ1bmN0aW9uKGEsYyxkLGUpe2UuJHZpZXdDaGFuZ2VMaXN0ZW5lcnMucHVzaChmdW5jdGlvbigpe2EuJGV2YWwoZC5uZ0NoYW5nZSl9KX19KSxcbmVjPWZ1bmN0aW9uKCl7cmV0dXJue3JlcXVpcmU6XCI/bmdNb2RlbFwiLGxpbms6ZnVuY3Rpb24oYSxjLGQsZSl7aWYoZSl7ZC5yZXF1aXJlZD0hMDt2YXIgZz1mdW5jdGlvbihhKXtpZihkLnJlcXVpcmVkJiZlLiRpc0VtcHR5KGEpKWUuJHNldFZhbGlkaXR5KFwicmVxdWlyZWRcIiwhMSk7ZWxzZSByZXR1cm4gZS4kc2V0VmFsaWRpdHkoXCJyZXF1aXJlZFwiLCEwKSxhfTtlLiRmb3JtYXR0ZXJzLnB1c2goZyk7ZS4kcGFyc2Vycy51bnNoaWZ0KGcpO2QuJG9ic2VydmUoXCJyZXF1aXJlZFwiLGZ1bmN0aW9uKCl7ZyhlLiR2aWV3VmFsdWUpfSl9fX19LEdkPWZ1bmN0aW9uKCl7cmV0dXJue3JlcXVpcmU6XCJuZ01vZGVsXCIsbGluazpmdW5jdGlvbihhLGMsZCxlKXt2YXIgZz0oYT0vXFwvKC4qKVxcLy8uZXhlYyhkLm5nTGlzdCkpJiZSZWdFeHAoYVsxXSl8fGQubmdMaXN0fHxcIixcIjtlLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24oYSl7aWYoIUUoYSkpe3ZhciBjPVtdO2EmJnEoYS5zcGxpdChnKSxmdW5jdGlvbihhKXthJiZcbmMucHVzaChjYShhKSl9KTtyZXR1cm4gY319KTtlLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24oYSl7cmV0dXJuIE0oYSk/YS5qb2luKFwiLCBcIik6c30pO2UuJGlzRW1wdHk9ZnVuY3Rpb24oYSl7cmV0dXJuIWF8fCFhLmxlbmd0aH19fX0sU2U9L14odHJ1ZXxmYWxzZXxcXGQrKSQvLElkPWZ1bmN0aW9uKCl7cmV0dXJue3ByaW9yaXR5OjEwMCxjb21waWxlOmZ1bmN0aW9uKGEsYyl7cmV0dXJuIFNlLnRlc3QoYy5uZ1ZhbHVlKT9mdW5jdGlvbihhLGMsZyl7Zy4kc2V0KFwidmFsdWVcIixhLiRldmFsKGcubmdWYWx1ZSkpfTpmdW5jdGlvbihhLGMsZyl7YS4kd2F0Y2goZy5uZ1ZhbHVlLGZ1bmN0aW9uKGEpe2cuJHNldChcInZhbHVlXCIsYSl9KX19fX0saWQ9dmEoZnVuY3Rpb24oYSxjLGQpe2MuYWRkQ2xhc3MoXCJuZy1iaW5kaW5nXCIpLmRhdGEoXCIkYmluZGluZ1wiLGQubmdCaW5kKTthLiR3YXRjaChkLm5nQmluZCxmdW5jdGlvbihhKXtjLnRleHQoYT09cz9cIlwiOmEpfSl9KSxrZD1bXCIkaW50ZXJwb2xhdGVcIixcbmZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihjLGQsZSl7Yz1hKGQuYXR0cihlLiRhdHRyLm5nQmluZFRlbXBsYXRlKSk7ZC5hZGRDbGFzcyhcIm5nLWJpbmRpbmdcIikuZGF0YShcIiRiaW5kaW5nXCIsYyk7ZS4kb2JzZXJ2ZShcIm5nQmluZFRlbXBsYXRlXCIsZnVuY3Rpb24oYSl7ZC50ZXh0KGEpfSl9fV0samQ9W1wiJHNjZVwiLFwiJHBhcnNlXCIsZnVuY3Rpb24oYSxjKXtyZXR1cm4gZnVuY3Rpb24oZCxlLGcpe2UuYWRkQ2xhc3MoXCJuZy1iaW5kaW5nXCIpLmRhdGEoXCIkYmluZGluZ1wiLGcubmdCaW5kSHRtbCk7dmFyIGY9YyhnLm5nQmluZEh0bWwpO2QuJHdhdGNoKGZ1bmN0aW9uKCl7cmV0dXJuKGYoZCl8fFwiXCIpLnRvU3RyaW5nKCl9LGZ1bmN0aW9uKGMpe2UuaHRtbChhLmdldFRydXN0ZWRIdG1sKGYoZCkpfHxcIlwiKX0pfX1dLGxkPVBiKFwiXCIsITApLG5kPVBiKFwiT2RkXCIsMCksbWQ9UGIoXCJFdmVuXCIsMSksb2Q9dmEoe2NvbXBpbGU6ZnVuY3Rpb24oYSxjKXtjLiRzZXQoXCJuZ0Nsb2FrXCIscyk7YS5yZW1vdmVDbGFzcyhcIm5nLWNsb2FrXCIpfX0pLFxucGQ9W2Z1bmN0aW9uKCl7cmV0dXJue3Njb3BlOiEwLGNvbnRyb2xsZXI6XCJAXCIscHJpb3JpdHk6NTAwfX1dLGZjPXt9O3EoXCJjbGljayBkYmxjbGljayBtb3VzZWRvd24gbW91c2V1cCBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2Vtb3ZlIG1vdXNlZW50ZXIgbW91c2VsZWF2ZSBrZXlkb3duIGtleXVwIGtleXByZXNzIHN1Ym1pdCBmb2N1cyBibHVyIGNvcHkgY3V0IHBhc3RlXCIuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGEpe3ZhciBjPW5hKFwibmctXCIrYSk7ZmNbY109W1wiJHBhcnNlXCIsZnVuY3Rpb24oZCl7cmV0dXJue2NvbXBpbGU6ZnVuY3Rpb24oZSxnKXt2YXIgZj1kKGdbY10pO3JldHVybiBmdW5jdGlvbihjLGQsZSl7ZC5vbihLKGEpLGZ1bmN0aW9uKGEpe2MuJGFwcGx5KGZ1bmN0aW9uKCl7ZihjLHskZXZlbnQ6YX0pfSl9KX19fX1dfSk7dmFyIHNkPVtcIiRhbmltYXRlXCIsZnVuY3Rpb24oYSl7cmV0dXJue3RyYW5zY2x1ZGU6XCJlbGVtZW50XCIscHJpb3JpdHk6NjAwLHRlcm1pbmFsOiEwLHJlc3RyaWN0OlwiQVwiLFxuJCR0bGI6ITAsbGluazpmdW5jdGlvbihjLGQsZSxnLGYpe3ZhciBoLGwsaztjLiR3YXRjaChlLm5nSWYsZnVuY3Rpb24oZyl7UWEoZyk/bHx8KGw9Yy4kbmV3KCksZihsLGZ1bmN0aW9uKGMpe2NbYy5sZW5ndGgrK109VS5jcmVhdGVDb21tZW50KFwiIGVuZCBuZ0lmOiBcIitlLm5nSWYrXCIgXCIpO2g9e2Nsb25lOmN9O2EuZW50ZXIoYyxkLnBhcmVudCgpLGQpfSkpOihrJiYoay5yZW1vdmUoKSxrPW51bGwpLGwmJihsLiRkZXN0cm95KCksbD1udWxsKSxoJiYoaz15YihoLmNsb25lKSxhLmxlYXZlKGssZnVuY3Rpb24oKXtrPW51bGx9KSxoPW51bGwpKX0pfX19XSx0ZD1bXCIkaHR0cFwiLFwiJHRlbXBsYXRlQ2FjaGVcIixcIiRhbmNob3JTY3JvbGxcIixcIiRhbmltYXRlXCIsXCIkc2NlXCIsZnVuY3Rpb24oYSxjLGQsZSxnKXtyZXR1cm57cmVzdHJpY3Q6XCJFQ0FcIixwcmlvcml0eTo0MDAsdGVybWluYWw6ITAsdHJhbnNjbHVkZTpcImVsZW1lbnRcIixjb250cm9sbGVyOkVhLm5vb3AsY29tcGlsZTpmdW5jdGlvbihmLFxuaCl7dmFyIGw9aC5uZ0luY2x1ZGV8fGguc3JjLGs9aC5vbmxvYWR8fFwiXCIsbT1oLmF1dG9zY3JvbGw7cmV0dXJuIGZ1bmN0aW9uKGYsaCxxLHMsdSl7dmFyIEY9MCx2LHksQSx4PWZ1bmN0aW9uKCl7eSYmKHkucmVtb3ZlKCkseT1udWxsKTt2JiYodi4kZGVzdHJveSgpLHY9bnVsbCk7QSYmKGUubGVhdmUoQSxmdW5jdGlvbigpe3k9bnVsbH0pLHk9QSxBPW51bGwpfTtmLiR3YXRjaChnLnBhcnNlQXNSZXNvdXJjZVVybChsKSxmdW5jdGlvbihnKXt2YXIgbD1mdW5jdGlvbigpeyFCKG0pfHxtJiYhZi4kZXZhbChtKXx8ZCgpfSxxPSsrRjtnPyhhLmdldChnLHtjYWNoZTpjfSkuc3VjY2VzcyhmdW5jdGlvbihhKXtpZihxPT09Ril7dmFyIGM9Zi4kbmV3KCk7cy50ZW1wbGF0ZT1hO2E9dShjLGZ1bmN0aW9uKGEpe3goKTtlLmVudGVyKGEsbnVsbCxoLGwpfSk7dj1jO0E9YTt2LiRlbWl0KFwiJGluY2x1ZGVDb250ZW50TG9hZGVkXCIpO2YuJGV2YWwoayl9fSkuZXJyb3IoZnVuY3Rpb24oKXtxPT09XG5GJiZ4KCl9KSxmLiRlbWl0KFwiJGluY2x1ZGVDb250ZW50UmVxdWVzdGVkXCIpKTooeCgpLHMudGVtcGxhdGU9bnVsbCl9KX19fX1dLEpkPVtcIiRjb21waWxlXCIsZnVuY3Rpb24oYSl7cmV0dXJue3Jlc3RyaWN0OlwiRUNBXCIscHJpb3JpdHk6LTQwMCxyZXF1aXJlOlwibmdJbmNsdWRlXCIsbGluazpmdW5jdGlvbihjLGQsZSxnKXtkLmh0bWwoZy50ZW1wbGF0ZSk7YShkLmNvbnRlbnRzKCkpKGMpfX19XSx1ZD12YSh7cHJpb3JpdHk6NDUwLGNvbXBpbGU6ZnVuY3Rpb24oKXtyZXR1cm57cHJlOmZ1bmN0aW9uKGEsYyxkKXthLiRldmFsKGQubmdJbml0KX19fX0pLHZkPXZhKHt0ZXJtaW5hbDohMCxwcmlvcml0eToxRTN9KSx3ZD1bXCIkbG9jYWxlXCIsXCIkaW50ZXJwb2xhdGVcIixmdW5jdGlvbihhLGMpe3ZhciBkPS97fS9nO3JldHVybntyZXN0cmljdDpcIkVBXCIsbGluazpmdW5jdGlvbihlLGcsZil7dmFyIGg9Zi5jb3VudCxsPWYuJGF0dHIud2hlbiYmZy5hdHRyKGYuJGF0dHIud2hlbiksaz1mLm9mZnNldHx8XG4wLG09ZS4kZXZhbChsKXx8e30sbj17fSxwPWMuc3RhcnRTeW1ib2woKSxyPWMuZW5kU3ltYm9sKCkscz0vXndoZW4oTWludXMpPyguKykkLztxKGYsZnVuY3Rpb24oYSxjKXtzLnRlc3QoYykmJihtW0soYy5yZXBsYWNlKFwid2hlblwiLFwiXCIpLnJlcGxhY2UoXCJNaW51c1wiLFwiLVwiKSldPWcuYXR0cihmLiRhdHRyW2NdKSl9KTtxKG0sZnVuY3Rpb24oYSxlKXtuW2VdPWMoYS5yZXBsYWNlKGQscCtoK1wiLVwiK2srcikpfSk7ZS4kd2F0Y2goZnVuY3Rpb24oKXt2YXIgYz1wYXJzZUZsb2F0KGUuJGV2YWwoaCkpO2lmKGlzTmFOKGMpKXJldHVyblwiXCI7YyBpbiBtfHwoYz1hLnBsdXJhbENhdChjLWspKTtyZXR1cm4gbltjXShlLGcsITApfSxmdW5jdGlvbihhKXtnLnRleHQoYSl9KX19fV0seGQ9W1wiJHBhcnNlXCIsXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEsYyl7dmFyIGQ9dChcIm5nUmVwZWF0XCIpO3JldHVybnt0cmFuc2NsdWRlOlwiZWxlbWVudFwiLHByaW9yaXR5OjFFMyx0ZXJtaW5hbDohMCwkJHRsYjohMCxcbmxpbms6ZnVuY3Rpb24oZSxnLGYsaCxsKXt2YXIgaz1mLm5nUmVwZWF0LG09ay5tYXRjaCgvXlxccyooW1xcc1xcU10rPylcXHMraW5cXHMrKFtcXHNcXFNdKz8pKD86XFxzK3RyYWNrXFxzK2J5XFxzKyhbXFxzXFxTXSs/KSk/XFxzKiQvKSxuLHAscixzLHUsRix2PXskaWQ6SWF9O2lmKCFtKXRocm93IGQoXCJpZXhwXCIsayk7Zj1tWzFdO2g9bVsyXTsobT1tWzNdKT8obj1hKG0pLHA9ZnVuY3Rpb24oYSxjLGQpe0YmJih2W0ZdPWEpO3ZbdV09Yzt2LiRpbmRleD1kO3JldHVybiBuKGUsdil9KToocj1mdW5jdGlvbihhLGMpe3JldHVybiBJYShjKX0scz1mdW5jdGlvbihhKXtyZXR1cm4gYX0pO209Zi5tYXRjaCgvXig/OihbXFwkXFx3XSspfFxcKChbXFwkXFx3XSspXFxzKixcXHMqKFtcXCRcXHddKylcXCkpJC8pO2lmKCFtKXRocm93IGQoXCJpaWRleHBcIixmKTt1PW1bM118fG1bMV07Rj1tWzJdO3ZhciBCPXt9O2UuJHdhdGNoQ29sbGVjdGlvbihoLGZ1bmN0aW9uKGEpe3ZhciBmLGgsbT1nWzBdLG4sdj17fSxILFIsdyxDLFQsdCxcbkU9W107aWYoYWIoYSkpVD1hLG49cHx8cjtlbHNle249cHx8cztUPVtdO2Zvcih3IGluIGEpYS5oYXNPd25Qcm9wZXJ0eSh3KSYmXCIkXCIhPXcuY2hhckF0KDApJiZULnB1c2godyk7VC5zb3J0KCl9SD1ULmxlbmd0aDtoPUUubGVuZ3RoPVQubGVuZ3RoO2ZvcihmPTA7ZjxoO2YrKylpZih3PWE9PT1UP2Y6VFtmXSxDPWFbd10sQz1uKHcsQyxmKSxBYShDLFwiYHRyYWNrIGJ5YCBpZFwiKSxCLmhhc093blByb3BlcnR5KEMpKXQ9QltDXSxkZWxldGUgQltDXSx2W0NdPXQsRVtmXT10O2Vsc2V7aWYodi5oYXNPd25Qcm9wZXJ0eShDKSl0aHJvdyBxKEUsZnVuY3Rpb24oYSl7YSYmYS5zY29wZSYmKEJbYS5pZF09YSl9KSxkKFwiZHVwZXNcIixrLEMpO0VbZl09e2lkOkN9O3ZbQ109ITF9Zm9yKHcgaW4gQilCLmhhc093blByb3BlcnR5KHcpJiYodD1CW3ddLGY9eWIodC5jbG9uZSksYy5sZWF2ZShmKSxxKGYsZnVuY3Rpb24oYSl7YS4kJE5HX1JFTU9WRUQ9ITB9KSx0LnNjb3BlLiRkZXN0cm95KCkpO1xuZj0wO2ZvcihoPVQubGVuZ3RoO2Y8aDtmKyspe3c9YT09PVQ/ZjpUW2ZdO0M9YVt3XTt0PUVbZl07RVtmLTFdJiYobT1FW2YtMV0uY2xvbmVbRVtmLTFdLmNsb25lLmxlbmd0aC0xXSk7aWYodC5zY29wZSl7Uj10LnNjb3BlO249bTtkbyBuPW4ubmV4dFNpYmxpbmc7d2hpbGUobiYmbi4kJE5HX1JFTU9WRUQpO3QuY2xvbmVbMF0hPW4mJmMubW92ZSh5Yih0LmNsb25lKSxudWxsLHkobSkpO209dC5jbG9uZVt0LmNsb25lLmxlbmd0aC0xXX1lbHNlIFI9ZS4kbmV3KCk7Ult1XT1DO0YmJihSW0ZdPXcpO1IuJGluZGV4PWY7Ui4kZmlyc3Q9MD09PWY7Ui4kbGFzdD1mPT09SC0xO1IuJG1pZGRsZT0hKFIuJGZpcnN0fHxSLiRsYXN0KTtSLiRvZGQ9IShSLiRldmVuPTA9PT0oZiYxKSk7dC5zY29wZXx8bChSLGZ1bmN0aW9uKGEpe2FbYS5sZW5ndGgrK109VS5jcmVhdGVDb21tZW50KFwiIGVuZCBuZ1JlcGVhdDogXCIraytcIiBcIik7Yy5lbnRlcihhLG51bGwseShtKSk7bT1hO3Quc2NvcGU9Ujt0LmNsb25lPVxuYTt2W3QuaWRdPXR9KX1CPXZ9KX19fV0seWQ9W1wiJGFuaW1hdGVcIixmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYyxkLGUpe2MuJHdhdGNoKGUubmdTaG93LGZ1bmN0aW9uKGMpe2FbUWEoYyk/XCJyZW1vdmVDbGFzc1wiOlwiYWRkQ2xhc3NcIl0oZCxcIm5nLWhpZGVcIil9KX19XSxyZD1bXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihjLGQsZSl7Yy4kd2F0Y2goZS5uZ0hpZGUsZnVuY3Rpb24oYyl7YVtRYShjKT9cImFkZENsYXNzXCI6XCJyZW1vdmVDbGFzc1wiXShkLFwibmctaGlkZVwiKX0pfX1dLHpkPXZhKGZ1bmN0aW9uKGEsYyxkKXthLiR3YXRjaChkLm5nU3R5bGUsZnVuY3Rpb24oYSxkKXtkJiZhIT09ZCYmcShkLGZ1bmN0aW9uKGEsZCl7Yy5jc3MoZCxcIlwiKX0pO2EmJmMuY3NzKGEpfSwhMCl9KSxBZD1bXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEpe3JldHVybntyZXN0cmljdDpcIkVBXCIscmVxdWlyZTpcIm5nU3dpdGNoXCIsY29udHJvbGxlcjpbXCIkc2NvcGVcIixmdW5jdGlvbigpe3RoaXMuY2FzZXM9XG57fX1dLGxpbms6ZnVuY3Rpb24oYyxkLGUsZyl7dmFyIGYsaCxsLGs9W107Yy4kd2F0Y2goZS5uZ1N3aXRjaHx8ZS5vbixmdW5jdGlvbihkKXt2YXIgbixwPWsubGVuZ3RoO2lmKDA8cCl7aWYobCl7Zm9yKG49MDtuPHA7bisrKWxbbl0ucmVtb3ZlKCk7bD1udWxsfWw9W107Zm9yKG49MDtuPHA7bisrKXt2YXIgcj1oW25dO2tbbl0uJGRlc3Ryb3koKTtsW25dPXI7YS5sZWF2ZShyLGZ1bmN0aW9uKCl7bC5zcGxpY2UobiwxKTswPT09bC5sZW5ndGgmJihsPW51bGwpfSl9fWg9W107az1bXTtpZihmPWcuY2FzZXNbXCIhXCIrZF18fGcuY2FzZXNbXCI/XCJdKWMuJGV2YWwoZS5jaGFuZ2UpLHEoZixmdW5jdGlvbihkKXt2YXIgZT1jLiRuZXcoKTtrLnB1c2goZSk7ZC50cmFuc2NsdWRlKGUsZnVuY3Rpb24oYyl7dmFyIGU9ZC5lbGVtZW50O2gucHVzaChjKTthLmVudGVyKGMsZS5wYXJlbnQoKSxlKX0pfSl9KX19fV0sQmQ9dmEoe3RyYW5zY2x1ZGU6XCJlbGVtZW50XCIscHJpb3JpdHk6ODAwLHJlcXVpcmU6XCJebmdTd2l0Y2hcIixcbmxpbms6ZnVuY3Rpb24oYSxjLGQsZSxnKXtlLmNhc2VzW1wiIVwiK2QubmdTd2l0Y2hXaGVuXT1lLmNhc2VzW1wiIVwiK2QubmdTd2l0Y2hXaGVuXXx8W107ZS5jYXNlc1tcIiFcIitkLm5nU3dpdGNoV2hlbl0ucHVzaCh7dHJhbnNjbHVkZTpnLGVsZW1lbnQ6Y30pfX0pLENkPXZhKHt0cmFuc2NsdWRlOlwiZWxlbWVudFwiLHByaW9yaXR5OjgwMCxyZXF1aXJlOlwiXm5nU3dpdGNoXCIsbGluazpmdW5jdGlvbihhLGMsZCxlLGcpe2UuY2FzZXNbXCI/XCJdPWUuY2FzZXNbXCI/XCJdfHxbXTtlLmNhc2VzW1wiP1wiXS5wdXNoKHt0cmFuc2NsdWRlOmcsZWxlbWVudDpjfSl9fSksRWQ9dmEoe2xpbms6ZnVuY3Rpb24oYSxjLGQsZSxnKXtpZighZyl0aHJvdyB0KFwibmdUcmFuc2NsdWRlXCIpKFwib3JwaGFuXCIsaGEoYykpO2coZnVuY3Rpb24oYSl7Yy5lbXB0eSgpO2MuYXBwZW5kKGEpfSl9fSksZWQ9W1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIsdGVybWluYWw6ITAsY29tcGlsZTpmdW5jdGlvbihjLFxuZCl7XCJ0ZXh0L25nLXRlbXBsYXRlXCI9PWQudHlwZSYmYS5wdXQoZC5pZCxjWzBdLnRleHQpfX19XSxUZT10KFwibmdPcHRpb25zXCIpLERkPWFhKHt0ZXJtaW5hbDohMH0pLGZkPVtcIiRjb21waWxlXCIsXCIkcGFyc2VcIixmdW5jdGlvbihhLGMpe3ZhciBkPS9eXFxzKihbXFxzXFxTXSs/KSg/Olxccythc1xccysoW1xcc1xcU10rPykpPyg/Olxccytncm91cFxccytieVxccysoW1xcc1xcU10rPykpP1xccytmb3JcXHMrKD86KFtcXCRcXHddW1xcJFxcd10qKXwoPzpcXChcXHMqKFtcXCRcXHddW1xcJFxcd10qKVxccyosXFxzKihbXFwkXFx3XVtcXCRcXHddKilcXHMqXFwpKSlcXHMraW5cXHMrKFtcXHNcXFNdKz8pKD86XFxzK3RyYWNrXFxzK2J5XFxzKyhbXFxzXFxTXSs/KSk/JC8sZT17JHNldFZpZXdWYWx1ZTpDfTtyZXR1cm57cmVzdHJpY3Q6XCJFXCIscmVxdWlyZTpbXCJzZWxlY3RcIixcIj9uZ01vZGVsXCJdLGNvbnRyb2xsZXI6W1wiJGVsZW1lbnRcIixcIiRzY29wZVwiLFwiJGF0dHJzXCIsZnVuY3Rpb24oYSxjLGQpe3ZhciBsPXRoaXMsaz17fSxtPWUsbjtsLmRhdGFib3VuZD1cbmQubmdNb2RlbDtsLmluaXQ9ZnVuY3Rpb24oYSxjLGQpe209YTtuPWR9O2wuYWRkT3B0aW9uPWZ1bmN0aW9uKGMpe0FhKGMsJ1wib3B0aW9uIHZhbHVlXCInKTtrW2NdPSEwO20uJHZpZXdWYWx1ZT09YyYmKGEudmFsKGMpLG4ucGFyZW50KCkmJm4ucmVtb3ZlKCkpfTtsLnJlbW92ZU9wdGlvbj1mdW5jdGlvbihhKXt0aGlzLmhhc09wdGlvbihhKSYmKGRlbGV0ZSBrW2FdLG0uJHZpZXdWYWx1ZT09YSYmdGhpcy5yZW5kZXJVbmtub3duT3B0aW9uKGEpKX07bC5yZW5kZXJVbmtub3duT3B0aW9uPWZ1bmN0aW9uKGMpe2M9XCI/IFwiK0lhKGMpK1wiID9cIjtuLnZhbChjKTthLnByZXBlbmQobik7YS52YWwoYyk7bi5wcm9wKFwic2VsZWN0ZWRcIiwhMCl9O2wuaGFzT3B0aW9uPWZ1bmN0aW9uKGEpe3JldHVybiBrLmhhc093blByb3BlcnR5KGEpfTtjLiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtsLnJlbmRlclVua25vd25PcHRpb249Q30pfV0sbGluazpmdW5jdGlvbihlLGYsaCxsKXtmdW5jdGlvbiBrKGEsXG5jLGQsZSl7ZC4kcmVuZGVyPWZ1bmN0aW9uKCl7dmFyIGE9ZC4kdmlld1ZhbHVlO2UuaGFzT3B0aW9uKGEpPyhBLnBhcmVudCgpJiZBLnJlbW92ZSgpLGMudmFsKGEpLFwiXCI9PT1hJiZ3LnByb3AoXCJzZWxlY3RlZFwiLCEwKSk6RShhKSYmdz9jLnZhbChcIlwiKTplLnJlbmRlclVua25vd25PcHRpb24oYSl9O2Mub24oXCJjaGFuZ2VcIixmdW5jdGlvbigpe2EuJGFwcGx5KGZ1bmN0aW9uKCl7QS5wYXJlbnQoKSYmQS5yZW1vdmUoKTtkLiRzZXRWaWV3VmFsdWUoYy52YWwoKSl9KX0pfWZ1bmN0aW9uIG0oYSxjLGQpe3ZhciBlO2QuJHJlbmRlcj1mdW5jdGlvbigpe3ZhciBhPW5ldyBWYShkLiR2aWV3VmFsdWUpO3EoYy5maW5kKFwib3B0aW9uXCIpLGZ1bmN0aW9uKGMpe2Muc2VsZWN0ZWQ9QihhLmdldChjLnZhbHVlKSl9KX07YS4kd2F0Y2goZnVuY3Rpb24oKXt4YShlLGQuJHZpZXdWYWx1ZSl8fChlPWJhKGQuJHZpZXdWYWx1ZSksZC4kcmVuZGVyKCkpfSk7Yy5vbihcImNoYW5nZVwiLGZ1bmN0aW9uKCl7YS4kYXBwbHkoZnVuY3Rpb24oKXt2YXIgYT1cbltdO3EoYy5maW5kKFwib3B0aW9uXCIpLGZ1bmN0aW9uKGMpe2Muc2VsZWN0ZWQmJmEucHVzaChjLnZhbHVlKX0pO2QuJHNldFZpZXdWYWx1ZShhKX0pfSl9ZnVuY3Rpb24gbihlLGYsZyl7ZnVuY3Rpb24gaCgpe3ZhciBhPXtcIlwiOltdfSxjPVtcIlwiXSxkLGsscyx0LHo7dD1nLiRtb2RlbFZhbHVlO3o9eShlKXx8W107dmFyIEU9bj9RYih6KTp6LEYsSSxBO0k9e307cz0hMTt2YXIgRCxIO2lmKHIpaWYodyYmTSh0KSlmb3Iocz1uZXcgVmEoW10pLEE9MDtBPHQubGVuZ3RoO0ErKylJW21dPXRbQV0scy5wdXQodyhlLEkpLHRbQV0pO2Vsc2Ugcz1uZXcgVmEodCk7Zm9yKEE9MDtGPUUubGVuZ3RoLEE8RjtBKyspe2s9QTtpZihuKXtrPUVbQV07aWYoXCIkXCI9PT1rLmNoYXJBdCgwKSljb250aW51ZTtJW25dPWt9SVttXT16W2tdO2Q9cChlLEkpfHxcIlwiOyhrPWFbZF0pfHwoaz1hW2RdPVtdLGMucHVzaChkKSk7cj9kPUIocy5yZW1vdmUodz93KGUsSSk6cShlLEkpKSk6KHc/KGQ9e30sZFttXT10LGQ9XG53KGUsZCk9PT13KGUsSSkpOmQ9dD09PXEoZSxJKSxzPXN8fGQpO0Q9bChlLEkpO0Q9QihEKT9EOlwiXCI7ay5wdXNoKHtpZDp3P3coZSxJKTpuP0VbQV06QSxsYWJlbDpELHNlbGVjdGVkOmR9KX1yfHwodXx8bnVsbD09PXQ/YVtcIlwiXS51bnNoaWZ0KHtpZDpcIlwiLGxhYmVsOlwiXCIsc2VsZWN0ZWQ6IXN9KTpzfHxhW1wiXCJdLnVuc2hpZnQoe2lkOlwiP1wiLGxhYmVsOlwiXCIsc2VsZWN0ZWQ6ITB9KSk7ST0wO2ZvcihFPWMubGVuZ3RoO0k8RTtJKyspe2Q9Y1tJXTtrPWFbZF07eC5sZW5ndGg8PUk/KHQ9e2VsZW1lbnQ6Qy5jbG9uZSgpLmF0dHIoXCJsYWJlbFwiLGQpLGxhYmVsOmsubGFiZWx9LHo9W3RdLHgucHVzaCh6KSxmLmFwcGVuZCh0LmVsZW1lbnQpKTooej14W0ldLHQ9elswXSx0LmxhYmVsIT1kJiZ0LmVsZW1lbnQuYXR0cihcImxhYmVsXCIsdC5sYWJlbD1kKSk7RD1udWxsO0E9MDtmb3IoRj1rLmxlbmd0aDtBPEY7QSsrKXM9a1tBXSwoZD16W0ErMV0pPyhEPWQuZWxlbWVudCxkLmxhYmVsIT09cy5sYWJlbCYmXG5ELnRleHQoZC5sYWJlbD1zLmxhYmVsKSxkLmlkIT09cy5pZCYmRC52YWwoZC5pZD1zLmlkKSxkLnNlbGVjdGVkIT09cy5zZWxlY3RlZCYmRC5wcm9wKFwic2VsZWN0ZWRcIixkLnNlbGVjdGVkPXMuc2VsZWN0ZWQpKTooXCJcIj09PXMuaWQmJnU/SD11OihIPXYuY2xvbmUoKSkudmFsKHMuaWQpLmF0dHIoXCJzZWxlY3RlZFwiLHMuc2VsZWN0ZWQpLnRleHQocy5sYWJlbCksei5wdXNoKHtlbGVtZW50OkgsbGFiZWw6cy5sYWJlbCxpZDpzLmlkLHNlbGVjdGVkOnMuc2VsZWN0ZWR9KSxEP0QuYWZ0ZXIoSCk6dC5lbGVtZW50LmFwcGVuZChIKSxEPUgpO2ZvcihBKys7ei5sZW5ndGg+QTspei5wb3AoKS5lbGVtZW50LnJlbW92ZSgpfWZvcig7eC5sZW5ndGg+STspeC5wb3AoKVswXS5lbGVtZW50LnJlbW92ZSgpfXZhciBrO2lmKCEoaz10Lm1hdGNoKGQpKSl0aHJvdyBUZShcImlleHBcIix0LGhhKGYpKTt2YXIgbD1jKGtbMl18fGtbMV0pLG09a1s0XXx8a1s2XSxuPWtbNV0scD1jKGtbM118fFwiXCIpLHE9XG5jKGtbMl0/a1sxXTptKSx5PWMoa1s3XSksdz1rWzhdP2Moa1s4XSk6bnVsbCx4PVtbe2VsZW1lbnQ6ZixsYWJlbDpcIlwifV1dO3UmJihhKHUpKGUpLHUucmVtb3ZlQ2xhc3MoXCJuZy1zY29wZVwiKSx1LnJlbW92ZSgpKTtmLmVtcHR5KCk7Zi5vbihcImNoYW5nZVwiLGZ1bmN0aW9uKCl7ZS4kYXBwbHkoZnVuY3Rpb24oKXt2YXIgYSxjPXkoZSl8fFtdLGQ9e30saCxrLGwscCx0LHYsdTtpZihyKWZvcihrPVtdLHA9MCx2PXgubGVuZ3RoO3A8djtwKyspZm9yKGE9eFtwXSxsPTEsdD1hLmxlbmd0aDtsPHQ7bCsrKXtpZigoaD1hW2xdLmVsZW1lbnQpWzBdLnNlbGVjdGVkKXtoPWgudmFsKCk7biYmKGRbbl09aCk7aWYodylmb3IodT0wO3U8Yy5sZW5ndGgmJihkW21dPWNbdV0sdyhlLGQpIT1oKTt1KyspO2Vsc2UgZFttXT1jW2hdO2sucHVzaChxKGUsZCkpfX1lbHNle2g9Zi52YWwoKTtpZihcIj9cIj09aClrPXM7ZWxzZSBpZihcIlwiPT09aClrPW51bGw7ZWxzZSBpZih3KWZvcih1PTA7dTxjLmxlbmd0aDt1Kyspe2lmKGRbbV09XG5jW3VdLHcoZSxkKT09aCl7az1xKGUsZCk7YnJlYWt9fWVsc2UgZFttXT1jW2hdLG4mJihkW25dPWgpLGs9cShlLGQpOzE8eFswXS5sZW5ndGgmJnhbMF1bMV0uaWQhPT1oJiYoeFswXVsxXS5zZWxlY3RlZD0hMSl9Zy4kc2V0Vmlld1ZhbHVlKGspfSl9KTtnLiRyZW5kZXI9aDtlLiR3YXRjaChoKX1pZihsWzFdKXt2YXIgcD1sWzBdO2w9bFsxXTt2YXIgcj1oLm11bHRpcGxlLHQ9aC5uZ09wdGlvbnMsdT0hMSx3LHY9eShVLmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIikpLEM9eShVLmNyZWF0ZUVsZW1lbnQoXCJvcHRncm91cFwiKSksQT12LmNsb25lKCk7aD0wO2Zvcih2YXIgeD1mLmNoaWxkcmVuKCksRD14Lmxlbmd0aDtoPEQ7aCsrKWlmKFwiXCI9PT14W2hdLnZhbHVlKXt3PXU9eC5lcShoKTticmVha31wLmluaXQobCx1LEEpO3ImJihsLiRpc0VtcHR5PWZ1bmN0aW9uKGEpe3JldHVybiFhfHwwPT09YS5sZW5ndGh9KTt0P24oZSxmLGwpOnI/bShlLGYsbCk6ayhlLGYsbCxwKX19fX1dLGhkPVtcIiRpbnRlcnBvbGF0ZVwiLFxuZnVuY3Rpb24oYSl7dmFyIGM9e2FkZE9wdGlvbjpDLHJlbW92ZU9wdGlvbjpDfTtyZXR1cm57cmVzdHJpY3Q6XCJFXCIscHJpb3JpdHk6MTAwLGNvbXBpbGU6ZnVuY3Rpb24oZCxlKXtpZihFKGUudmFsdWUpKXt2YXIgZz1hKGQudGV4dCgpLCEwKTtnfHxlLiRzZXQoXCJ2YWx1ZVwiLGQudGV4dCgpKX1yZXR1cm4gZnVuY3Rpb24oYSxkLGUpe3ZhciBrPWQucGFyZW50KCksbT1rLmRhdGEoXCIkc2VsZWN0Q29udHJvbGxlclwiKXx8ay5wYXJlbnQoKS5kYXRhKFwiJHNlbGVjdENvbnRyb2xsZXJcIik7bSYmbS5kYXRhYm91bmQ/ZC5wcm9wKFwic2VsZWN0ZWRcIiwhMSk6bT1jO2c/YS4kd2F0Y2goZyxmdW5jdGlvbihhLGMpe2UuJHNldChcInZhbHVlXCIsYSk7YSE9PWMmJm0ucmVtb3ZlT3B0aW9uKGMpO20uYWRkT3B0aW9uKGEpfSk6bS5hZGRPcHRpb24oZS52YWx1ZSk7ZC5vbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXttLnJlbW92ZU9wdGlvbihlLnZhbHVlKX0pfX19fV0sZ2Q9YWEoe3Jlc3RyaWN0OlwiRVwiLFxudGVybWluYWw6ITB9KTtPLmFuZ3VsYXIuYm9vdHN0cmFwP2NvbnNvbGUubG9nKFwiV0FSTklORzogVHJpZWQgdG8gbG9hZCBhbmd1bGFyIG1vcmUgdGhhbiBvbmNlLlwiKTooKEdhPU8ualF1ZXJ5KT8oeT1HYSxEKEdhLmZuLHtzY29wZTpKYS5zY29wZSxpc29sYXRlU2NvcGU6SmEuaXNvbGF0ZVNjb3BlLGNvbnRyb2xsZXI6SmEuY29udHJvbGxlcixpbmplY3RvcjpKYS5pbmplY3Rvcixpbmhlcml0ZWREYXRhOkphLmluaGVyaXRlZERhdGF9KSxBYihcInJlbW92ZVwiLCEwLCEwLCExKSxBYihcImVtcHR5XCIsITEsITEsITEpLEFiKFwiaHRtbFwiLCExLCExLCEwKSk6eT1OLEVhLmVsZW1lbnQ9eSxaYyhFYSkseShVKS5yZWFkeShmdW5jdGlvbigpe1djKFUsJGIpfSkpfSkod2luZG93LGRvY3VtZW50KTshYW5ndWxhci4kJGNzcCgpJiZhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLmZpbmQoXCJoZWFkXCIpLnByZXBlbmQoJzxzdHlsZSB0eXBlPVwidGV4dC9jc3NcIj5AY2hhcnNldCBcIlVURi04XCI7W25nXFxcXDpjbG9ha10sW25nLWNsb2FrXSxbZGF0YS1uZy1jbG9ha10sW3gtbmctY2xvYWtdLC5uZy1jbG9haywueC1uZy1jbG9haywubmctaGlkZXtkaXNwbGF5Om5vbmUgIWltcG9ydGFudDt9bmdcXFxcOmZvcm17ZGlzcGxheTpibG9jazt9Lm5nLWFuaW1hdGUtYmxvY2stdHJhbnNpdGlvbnN7dHJhbnNpdGlvbjowcyBhbGwhaW1wb3J0YW50Oy13ZWJraXQtdHJhbnNpdGlvbjowcyBhbGwhaW1wb3J0YW50O308L3N0eWxlPicpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YW5ndWxhci5taW4uanMubWFwXG4iLCJyZXF1aXJlKFwiLi9hbmd1bGFyL2FuZ3VsYXIubWluLmpzXCIpO1xucmVxdWlyZShcImFuZ3VsYXItYW5pbWF0ZVwiKTtcbnJlcXVpcmUoXCIuL2xpYnMvdWktYm9vdHN0cmFwLXRwbHMtMC4xMS4yLm1pbi5qc1wiKTtcbnJlcXVpcmUoXCIuL2xpYnMvYW5ndWxhci10cmFuc2xhdGUuanNcIik7XG5yZXF1aXJlKFwiLi9saWJzL2FuZ3VsYXItdHJhbnNsYXRlLWxvYWRlci1zdGF0aWMtZmlsZXMuanNcIik7XG5yZXF1aXJlKFwiLi9saWJzL3Byb21pc2UtdHJhY2tlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2xpYnMvcHJvbWlzZS10cmFja2VyLWh0dHAtaW50ZXJjZXB0b3IuanNcIik7XG5yZXF1aXJlKFwiLi9tdWx0aXNlbGVjdC9tdWx0aXNlbGVjdC5qc1wiKTtcbnJlcXVpcmUoXCIuL25hdmlnYXRpb24tYmxvY2tlci9uYXZpZ2F0aW9uLWJsb2NrZXIuanNcIik7XG5yZXF1aXJlKFwiLi9sYW5ndWFnZS1jaGFuZ2VyL2xhbmd1YWdlLWNoYW5nZXIuanNcIik7XG5yZXF1aXJlKFwiLi90YWJzL2Zvcm0tdGFicy5qc1wiKTtcbnJlcXVpcmUoXCIuL3V0aWxzL3V0aWxzLmpzXCIpO1xucmVxdWlyZShcIi4vZXJyb3ItbWFwcGVyL2Vycm9yLW1hcHBlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2FuZ3VsYXItZWxhc3RpYy9lbGFzdGljLmpzXCIpO1xucmVxdWlyZShcIi4vb3JkZXItb2JqZWN0LWJ5L25nLW9yZGVyLW9iamVjdC1ieS5qc1wiKTtcbnJlcXVpcmUoXCIuL25vdGlmaWNhdGlvbi9ub3RpZmljYXRpb24uanNcIik7XG5yZXF1aXJlKFwiLi9saWJzL3VpLWhhbmRzb250YWJsZS5qc1wiKTtcbnJlcXVpcmUoXCIuL2xpYnMvbnVtZXJhbC5kZS1kZS5qc1wiKTtcbnJlcXVpcmUoXCIuL2FuZ3VsYXItYXBwLmpzXCIpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGFyZ29hYXZhIG9uIDEzLjA1LjE0LlxyXG4gKi9cclxuXHJcbmFuZ3VsYXIubW9kdWxlKCd1aS5lcnJvck1hcHBlcicsIFtdKVxyXG4gICAgLnNlcnZpY2UoJ2Vycm9yTWFwcGVyU2VydmljZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuZXJyb3JNYXBwaW5ncyA9IHtcclxuICAgICAgICAgICAgXCJyZXF1aXJlZFwiIDogXCJUaGlzIGlzIGEgcmVxdWlyZWQgZmllbGRcIixcclxuICAgICAgICAgICAgXCJwYXR0ZXJuX2RlY2ltYWxcIiA6IFwiUGxlYXNlIHByb3ZpZGUgYSBudW1iZXIgZ3JlYXRlciB0aGFuIDBcIixcclxuICAgICAgICAgICAgXCJwYXR0ZXJuX2ludGVnZXJcIiA6IFwiUGxlYXNlIHByb3ZpZGUgYSB3aG9sZSBudW1iZXIgZ3JlYXRlciB0aGFuIDBcIixcclxuICAgICAgICAgICAgXCJwYXR0ZXJuX3RlbGVwaG9uZVwiIDogXCJQbGVhc2UgZW50ZXIgYSB2YWxpZCB0ZWxlcGhvbmUgbnVtYmVyIChhdCBsZWFzdCA3IGRpZ2l0cylcIixcclxuICAgICAgICAgICAgXCJwYXR0ZXJuX2VtYWlsXCIgOiBcIlBsZWFzZSBlbnRlciBhIHZhbGlkIGVtYWlsIGFkZHJlc3NcIixcclxuICAgICAgICAgICAgXCJwYXR0ZXJuX3VybFwiIDogXCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBVUkxcIixcclxuICAgICAgICAgICAgXCJwYXR0ZXJuX2xvbmdpdHVkZVwiIDogXCJQbGVhc2UgZW50ZXIgbnVtYmVyIGJldHdlZW4gLTE4MCBhbmQgMTgwIFwiLFxyXG4gICAgICAgICAgICBcInBhdHRlcm5fbGF0aXR1ZGVcIiA6IFwiUGxlYXNlIGVudGVyIG51bWJlciBiZXR3ZWVuIC05MCBhbmQgOTBcIn07XHJcblxyXG4gICAgICAgIHRoaXMuZ2V0RXJyb3JNYXBwaW5ncyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lcnJvck1hcHBpbmdzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5hZGRFcnJvck1hcHBpbmcgPSBmdW5jdGlvbihrZXksIG1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5lcnJvck1hcHBpbmdzW2tleV0gPSBtZXNzYWdlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zZXRFcnJvck1hcHBpbmdzID0gZnVuY3Rpb24oZXJyb3JNYXBwaW5ncykge1xyXG4gICAgICAgICAgICB0aGlzLmVycm9yTWFwcGluZ3MgPSBlcnJvck1hcHBpbmdzO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICAuY29udHJvbGxlcihcIkVycm9yQ29udHJvbGxlclwiLCBmdW5jdGlvbiAoJHNjb3BlLCBlcnJvck1hcHBlclNlcnZpY2UpIHtcclxuXHJcbiAgICAgICAgJHNjb3BlLmVycm9yTWFwcGluZ3MgPSBlcnJvck1hcHBlclNlcnZpY2UuZ2V0RXJyb3JNYXBwaW5ncygpO1xyXG4gICAgICAgICRzY29wZS5zaG93Q3VycmVudEVycm9yID0gZmFsc2U7XHJcblxyXG4gICAgICAgICRzY29wZS5nZXRFcnJvck1lc3NhZ2UgPSBmdW5jdGlvbihlcnJvckNvZGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzY29wZS5lcnJvck1hcHBpbmdzW2Vycm9yQ29kZV07XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmdldENvbnRyb2xsZXIgPSBmdW5jdGlvbihhdHRyaWJ1dGVzKSB7XHJcbiAgICAgICAgICAgIGlmICghYXR0cmlidXRlcy53YXRjaFZpZXcpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciB0b2tlbnMgPSBhdHRyaWJ1dGVzLndhdGNoVmlldy5zcGxpdChcIi5cIik7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSAkc2NvcGU7XHJcbiAgICAgICAgICAgIHdoaWxlKHRva2Vucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdFt0b2tlbnMuc2hpZnQoKV07XHJcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnBhcnNlRXJyb3JzID0gZnVuY3Rpb24oY3RybCwgYXR0cmlidXRlcykge1xyXG4gICAgICAgICAgICB2YXIgZmllbGROYW1lSWRlbnRpZmllciA9ICFhdHRyaWJ1dGVzLndhdGNoVmlldz8gYXR0cmlidXRlcy5lcnJvck1hcHBlciA6IGF0dHJpYnV0ZXMud2F0Y2hWaWV3O1xyXG4gICAgICAgICAgICB2YXIgbmFtZVRva2VucyA9IGZpZWxkTmFtZUlkZW50aWZpZXIuc3BsaXQoJy4nKTtcclxuICAgICAgICAgICAgdmFyIG5hbWUgPSBuYW1lVG9rZW5zWzFdO1xyXG5cclxuICAgICAgICAgICAgdmFyIGZpZWxkQ29udHJvbGxlciA9ICFjdHJsW25hbWVdPyAkc2NvcGUuZ2V0Q29udHJvbGxlcihhdHRyaWJ1dGVzKSA6IGN0cmxbbmFtZV07XHJcbiAgICAgICAgICAgIGlmICghZmllbGRDb250cm9sbGVyKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWF0dHJpYnV0ZXMucmFkaW9CdXR0b25WYWx1ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcihcImlucHV0IGZpZWxkIGNvbnRyb2xsZXIgbm90IGZvdW5kIGZvciBcIiArIGF0dHJpYnV0ZXMuZXJyb3JNYXBwZXIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmFkaW9CdXR0b25WYWx1ZXMgPSBKU09OLnBhcnNlKGF0dHJpYnV0ZXMucmFkaW9CdXR0b25WYWx1ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93Q3VycmVudEVycm9yID0gIXJhZGlvQnV0dG9uVmFsdWVzLnZhbHVlICYmICRzY29wZS5zdWJtaXR0ZWQgJiYgcmFkaW9CdXR0b25WYWx1ZXMucmVxdWlyZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRFcnJvckNvZGUgPSAncmVxdWlyZWQnO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGNvbnRyb2xsZXJFcnJvcnMgPSBmaWVsZENvbnRyb2xsZXIuJGVycm9yO1xyXG4gICAgICAgICAgICBpZiAoICFhdHRyaWJ1dGVzLmVycm9yc1RvU2hvdykgcmV0dXJuO1xyXG4gICAgICAgICAgICB2YXIgZXJyb3JzVG9TaG93QXNBcnJheSA9IEpTT04ucGFyc2UoYXR0cmlidXRlcy5lcnJvcnNUb1Nob3cpO1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlcnJvcnNUb1Nob3dBc0FycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3BsaXRFcnJvclN0cmluZyA9IGVycm9yc1RvU2hvd0FzQXJyYXlbaV0uc3BsaXQoJ18nKTtcclxuICAgICAgICAgICAgICAgIHZhciBzdHJpcHBlZEVycm9yU3RyaW5nID0gc3BsaXRFcnJvclN0cmluZ1swXTtcclxuICAgICAgICAgICAgICAgIGlmIChjb250cm9sbGVyRXJyb3JzW3N0cmlwcGVkRXJyb3JTdHJpbmddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dDdXJyZW50RXJyb3IgPSAkc2NvcGUuc2hvd0Vycm9yKGZpZWxkQ29udHJvbGxlciwgc3RyaXBwZWRFcnJvclN0cmluZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRFcnJvckNvZGUgPSBlcnJvcnNUb1Nob3dBc0FycmF5W2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0N1cnJlbnRFcnJvciA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuc2hvd0Vycm9yID0gZnVuY3Rpb24obW9kZWxDb250cm9sbGVyLCBlcnJvckNvZGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuICgkc2NvcGUuc3VibWl0dGVkIHx8IG1vZGVsQ29udHJvbGxlci4kZGlydHkpICYmIG1vZGVsQ29udHJvbGxlci4kZXJyb3JbZXJyb3JDb2RlXSAmJiBtb2RlbENvbnRyb2xsZXIuJGludmFsaWQ7XHJcbiAgICAgICAgfTtcclxuICAgIH0pXHJcblxyXG4gICAgLy8gRXJyb3IgbWFwcGVyIGRpcmVjdGl2ZSB0byBzaW1wbGlmeSBzaG93aW5nIGVycm9ycyBmb3IgaW5wdXQgZmllbGRzIGFuZCBnZXQgcmlkIG9mIHNvbWVcclxuICAgIC8vIGJvaWxlcnBsYXRlIGNvZGUuXHJcbiAgICAvL1xyXG4gICAgLy8gVXNhZ2U6XHJcbiAgICAvL1xyXG4gICAgLy8gPGlucHV0IG5hbWU9XCJNb25leVwiIG5nLW1vZGVsPVwiaW5zdGFuY2UuTU1SQXJ0aWNsZTE3UXVlc3Rpb25uYWlyZS5UYWJsZTEuTW9uZXlcIiB0eXBlPVwidGV4dFwiXHJcbiAgICAvLyAgICAgIG5nLXBhdHRlcm49XCJkZWNpbWFsTnVtYmVyUGF0dGVyblwiIHJlcXVpcmVkLz5cclxuICAgIC8vIDxkaXYgY2xhc3M9XCJpbnZhbGlkLW1zZ1wiIHRkLWVycm9yLW1hcHBlciB3YXRjaC1lbGVtZW50cz0nW1wiVGFibGUxLk90aGVyRGVzY3JpcHRpb25cIl0nXHJcbiAgICAvLyAgICAgIHdhdGNoLXZpZXc9XCJGb3JtLklucHV0TmFtZVwiIGVycm9ycy10by1zaG93PSdbXCJyZXF1aXJlZFwiLCBcInBhdHRlcm5fZGVjaW1hbFwiXSc+PC9kaXY+XHJcbiAgICAvLyAuLi5cclxuICAgIC8vIFdoZXJlIDxkaXY+IHdpdGggJ3RkLWVycm9yLW1hcHBlcicgYXR0cmlidXRlIGlzIHVzZWQgYXMgZXJyb3IgZGl2IGFuZCBhbGwgZnVuY3Rpb25hbGl0eSBpcyBhcHBsaWVkLlxyXG4gICAgLy9cclxuICAgIC8vIENvbmZpZ3VyYXRpb24gcGFyYW1ldGVyczpcclxuICAgIC8vIHRkLWVycm9yLW1hcHBlciAtIGlkZW50aWZpZXIgZm9yIGVycm9yIG1hcHBlciBhbmQgc2NvcGUgcGFyYW1ldGVyIHdhdGNoZXIgZS5nIHRkLWVycm9yLW1hcHBlcj1cInVzZXJOYW1lXCIuIFdoZW5ldmVyXHJcbiAgICAvLyAgICAgICAgICAgICAgICAgICAkc2NvcGUudXNlck5hbWUgY2hhbmdlcyBpdCBpcyBwaWNrZWQgdXAgYnkgbWFwcGVyIGFuZCBjb3JyZWN0IGVycm9yIGlzIHNob3duIHdoZW4gaWRlbnRpZmllZC5cclxuICAgIC8vIHdhdGNoLXZpZXcgICAgICAtIFVzZWQgdG8gd2F0Y2ggdmlldyB2YWx1ZSBvZiB0aGUgZmllbGQuIFVzZWZ1bCBmb3Igd2F0Y2hpbmcgbnVtYmVyIGZpZWxkcyBldGMuIHdoZW4gYWN0dWFsIHNjb3BlXHJcbiAgICAvLyAgICAgICAgICAgICAgICAgICB2YWx1ZSBkb2VzIG5vdCBjaGFuZ2Ugb24gaW52YWxpZCBmaWVsZCB2YWx1ZS5cclxuICAgIC8vICAgICAgICAgICAgICAgICAgIFNob3VsZCBiZSB1c2VkIGFzIHtGb3JtTmFtZX0ue0lucHV0TmFtZX0gc28gSW5wdXROYW1lIGNhbiBiZSBleHRyYWN0ZWQgdG8gZ2V0IGNvcnJlY3QgY29udHJvbGxlci5cclxuICAgIC8vIHdhdGNoLWVsZW1lbnRzICAtIEFycmF5IG9mIHN0cmluZyB0aGF0IGlzIHBhcnNlZCBhbmQgcmVnaXN0ZXJlZCBmb3Igd2F0Y2hpbmcuIFdoZW5ldmVyICdUYWJsZTEuT3RoZXJEZXNjcmlwdGlvbidcclxuICAgIC8vICAgICAgICAgICAgICAgICAgIGNoYW5nZXMgdGhlbiBwYXJzZSBmdW5jdGlvbiBpcyBjYWxsZWQgYW5kIGNvcnJlY3QgZXJyb3JzIHNob3cgZm9yIGN1cnJlbnQgaW5wdXQuXHJcbiAgICAvLyBlcnJvcnMtdG8tc2hvdyAgLSBFcnJvcnMgdG8gYmUgc2hvd24gYXMgYXJyYXkuIFRoaXMgc3RyaW5nIGlzIHBhcnNlZCBhbmQgZXJyb3JzIGFyZSBzaG93biBpbiB0aGUgc2FtZSBvcmRlclxyXG4gICAgLy8gICAgICAgICAgICAgICAgICAgYXMgYXJyYXkuIE5hbWVzIGNhbiBiZSB1c2VkIGZvciBkaWZmZXJlbnQga2luZCBvZiBtZXNzYWdlcyBhcyBmb2xsb3dzIGUuZyBcInBhdHRlcm5fZGVjaW1hbFwiXHJcbiAgICAvLyAgICAgICAgICAgICAgICAgICBtZWFucyBlcnJvciB0eXBlIGlzIHBhdHRlcm4gYW5kIG1lc3NhZ2UgdHlwZSBkZWNpbWFsLiBGaXJzdCBwYXJ0IGlzIGV4dHJhY3RlZCB1c2VkIHRvZ2V0aGVyIHdpdGhcclxuICAgIC8vICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIgbmctcGF0dGVybiBkaXJlY3RpdmUgdG8gZ2V0IGNvcnJlY3QgcmVzdWx0LlxyXG4gICAgLmRpcmVjdGl2ZSgnZXJyb3JNYXBwZXInLGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgICAgICByZXF1aXJlOiAnP15mb3JtJyxcclxuICAgICAgICAgICAgc2NvcGU6IHRydWUsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdFcnJvckNvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxzcGFuIG5nLXNob3c9XFxcInNob3dDdXJyZW50RXJyb3JcXFwiPnt7Z2V0RXJyb3JNZXNzYWdlKGN1cnJlbnRFcnJvckNvZGUpfX08L3NwYW4+JyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjdHJsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWF0dHJzLndhdGNoVmlldykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaChhdHRycy5lcnJvck1hcHBlciwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnBhcnNlRXJyb3JzKGN0cmwsIGF0dHJzKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKGF0dHJzLndhdGNoVmlldyArIFwiLiR2aWV3VmFsdWVcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnBhcnNlRXJyb3JzKGN0cmwsIGF0dHJzKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goJ3N1Ym1pdHRlZCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnBhcnNlRXJyb3JzKGN0cmwsIGF0dHJzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vRm9yIHdhdGNoaW5nIG90aGVyIHZhbHVlcyB0aGF0IHRoaXMgZXJyb3IgZGVwZW5kcyBvblxyXG4gICAgICAgICAgICAgICAgaWYgKGF0dHJzLndhdGNoRWxlbWVudHMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgd2F0Y2hBcnJheSA9IEpTT04ucGFyc2UoYXR0cnMud2F0Y2hFbGVtZW50cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3YXRjaEFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaCh3YXRjaEFycmF5W2ldICsgXCIuJHZpZXdWYWx1ZVwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnBhcnNlRXJyb3JzKGN0cmwsIGF0dHJzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgYXJnb2FhdmEgb24gMjIuMDQuMTQuXHJcbiAqL1xyXG5cclxuLy8gTW9kdWxlIHRoYXQgcHJvdmlkZXMgbGFuZ3VhZ2UgY2hhbmdpbmcgZnVuY3Rpb25hbGl0eSB0byB3ZWJmb3JtLlxyXG4vL1xyXG4vLyBNb2R1bGUgbmVlZHMgY29uZmlndXJhdGlvbiBhbmQgPGRpdiB0ZC1sYW5ndWFnZS1jaGFuZ2VyPjwvZGl2PiBvciA8dGQtbGFuZ3VhZ2UtY2hhbmdlci8+IHRhZ3MuXHJcbi8vIHRkLWxhbmd1YWdlLWNoYW5nZXIgY29tcG9uZW50IGlzIHJlcGxhY2VkIHdpdGggbGFuZ3VhZ2Ugc2VsZWN0IGlucHV0IHRoYXQgaXMgY29uZmlndXJlZCB0byB1c2VcclxuLy8gcHJlLWNvbmZpZ3VyZWQgdmFsdWVzLlxyXG4vL1xyXG4vLyBFeGFtcGxlIGNvbmZpZ3VyYXRpb24gb2YgbGFuZ3VhZ2VDaGFuZ2VyXHJcbi8vXHJcbi8vIGFwcC5jb25maWcoW1wibGFuZ3VhZ2VDaGFuZ2VyUHJvdmlkZXJcIiwgZnVuY3Rpb24obGFuZ3VhZ2VDaGFuZ2VyUHJvdmlkZXIpIHtcclxuLy8gICAgbGFuZ3VhZ2VDaGFuZ2VyUHJvdmlkZXIuc2V0RGVmYXVsdExhbmd1YWdlKCdlbicpO1xyXG4vLyAgICBsYW5ndWFnZUNoYW5nZXJQcm92aWRlci5zZXRMYW5ndWFnZUZpbGVQcmVmaXgoJ2VuLWxhYmVscy0nKTtcclxuLy8gICAgbGFuZ3VhZ2VDaGFuZ2VyUHJvdmlkZXIuc2V0QXZhaWxhYmxlTGFuZ3VhZ2VzKHtcIml0ZW1cIiA6W3tcclxuLy8gICAgICAgIFwiY29kZVwiOiBcImJnXCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwi0JHRitC70LPQsNGA0YHQutC4IChiZylcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcImNzXCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwixI1lxaF0aW5hIChjcylcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcImhyXCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiSHJ2YXRza2kgKGhyKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwiZGFcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJEYW5zayAoZGEpXCJ9LCB7XHJcbi8vICAgICAgICBcImNvZGVcIjogXCJubFwiLFxyXG4vLyAgICAgICAgXCJsYWJlbFwiOiBcIk5lZGVybGFuZHMgKG5sKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwiZWxcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCLOtc67zrvOt869zrnOus6sIChlbClcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcImVuXCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiRW5nbGlzaCAoZW4pXCJ9LCB7XHJcbi8vICAgICAgICBcImNvZGVcIjogXCJldFwiLFxyXG4vLyAgICAgICAgXCJsYWJlbFwiOiBcIkVlc3RpIChldClcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcImZpXCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiU3VvbWkgKGZpKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwiZnJcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJGcmFuw6dhaXMgKGZyKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwiZGVcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJEZXV0c2NoIChkZSlcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcImh1XCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiTWFneWFyIChodSlcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcImlzXCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiw41zbGVuc2thIChpcylcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcIml0XCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiSXRhbGlhbm8gKGl0KVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwibHZcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJMYXR2aWXFoXUgKGx2KVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwibHRcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJMaWV0dXZpxbMgKGx0KVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwibXRcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJNYWx0aSAobXQpXCJ9LCB7XHJcbi8vICAgICAgICBcImNvZGVcIjogXCJub1wiLFxyXG4vLyAgICAgICAgXCJsYWJlbFwiOiBcIk5vcnNrIChubylcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcInBsXCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiUG9sc2tpIChwbClcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcInB0XCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiUG9ydHVndcOqcyAocHQpXCJ9LCB7XHJcbi8vICAgICAgICBcImNvZGVcIjogXCJyb1wiLFxyXG4vLyAgICAgICAgXCJsYWJlbFwiOiBcIlJvbcOibsSDIChybylcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcInNrXCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiU2xvdmVuxI1pbmEgKHNrKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwic2xcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJTbG92ZW7FocSNaW5hIChzbClcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcImVzXCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiRXNwYcOxb2wgKGVzKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwic3ZcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJTdmVuc2thIChzdilcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcInRyXCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiVMO8cmvDp2UgKHRyKVwifV19KVxyXG4vL31dKTtcclxuXHJcblxyXG5hbmd1bGFyLm1vZHVsZSgndHJhbnNsYXRlLmxhbmd1YWdlQ2hhbmdlcicsIFsncGFzY2FscHJlY2h0LnRyYW5zbGF0ZSddKVxyXG4gICAgLmZhY3RvcnkoJ2N1c3RvbUxvYWRlcicsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkaHR0cCwgJHEsIGxhbmd1YWdlQ2hhbmdlcikge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFsYW5ndWFnZUNoYW5nZXIuZ2V0TGFuZ3VhZ2VGaWxlUHJlZml4KCkpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkxhbmd1YWdlIGZpbGUgcHJlZml4IG11c3QgYmUgZGVmaW5lZCB3aGVuIHVzaW5nIGxhbmd1YWdlQ2hhbmdlciBjb21wb25lbnQuXCIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgbGFuZ3VhZ2VVcmwgPSBsYW5ndWFnZUNoYW5nZXIuZ2V0TGFuZ3VhZ2VGaWxlUHJlZml4KCkgKyBvcHRpb25zLmtleSArICcueG1sP2Zvcm1hdD1qc29uJztcclxuXHJcbiAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDonR0VUJyxcclxuICAgICAgICAgICAgICAgIHVybDogbGFuZ3VhZ2VVcmxcclxuICAgICAgICAgICAgfSwge3RyYWNrZXIgOiAkcm9vdFNjb3BlLmxvYWRpbmdUcmFja2VyfSlcclxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShkYXRhLmxhYmVscyk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9hbGVydCgnbGFiZWwtJyArIG9wdGlvbnMua2V5ICsgJy5qc29uJyArJyBzdWNjZXNzJyk7XHJcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KG9wdGlvbnMua2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KCdsYWJlbC0nICsgb3B0aW9ucy5rZXkgKyAnLmpzb24nICsnIGVycm9yJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vYWxlcnQob3B0aW9ucy5rZXkpO1xyXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIC5wcm92aWRlcignbGFuZ3VhZ2VDaGFuZ2VyJywgZnVuY3Rpb24gbGFuZ3VhZ2VDaGFuZ2VyUHJvdmlkZXIoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY3VycmVudExhbmd1YWdlID0gJ2VuJztcclxuICAgICAgICB0aGlzLmF2YWlsYWJsZUxhbmd1YWdlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMubGFuZ3VhZ2VGaWxlUHJlZml4ID0gJyc7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0RGVmYXVsdExhbmd1YWdlID0gZnVuY3Rpb24oZGVmYXVsdExhbmd1YWdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudExhbmd1YWdlID0gZGVmYXVsdExhbmd1YWdlO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuc2V0TGFuZ3VhZ2VGaWxlUHJlZml4ID0gZnVuY3Rpb24ocHJlZml4KSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFuZ3VhZ2VGaWxlUHJlZml4ID0gcHJlZml4O1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuc2V0QXZhaWxhYmxlTGFuZ3VhZ2VzID0gZnVuY3Rpb24oYXZhaWxhYmxlTGFuZ3VhZ2VzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXZhaWxhYmxlTGFuZ3VhZ2VzID0gYXZhaWxhYmxlTGFuZ3VhZ2VzO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuJGdldCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgYXZhaWxhYmxlTGFuZ3VhZ2VzID0gdGhpcy5hdmFpbGFibGVMYW5ndWFnZXM7XHJcbiAgICAgICAgICAgIHZhciBjdXJyZW50TGFuZ3VhZ2UgPSB0aGlzLmN1cnJlbnRMYW5ndWFnZTtcclxuICAgICAgICAgICAgdmFyIHByZWZpeCA9IHRoaXMubGFuZ3VhZ2VGaWxlUHJlZml4O1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgZ2V0TGFuZ3VhZ2UgOiBmdW5jdGlvbigpIHtyZXR1cm4gY3VycmVudExhbmd1YWdlO30sXHJcbiAgICAgICAgICAgICAgICBzZXRMYW5ndWFnZSA6IGZ1bmN0aW9uKG5ld0xhbmd1YWdlKSB7Y3VycmVudExhbmd1YWdlID0gbmV3TGFuZ3VhZ2U7fSxcclxuICAgICAgICAgICAgICAgIGdldEF2YWlsYWJsZUxhbmd1YWdlcyA6IGZ1bmN0aW9uKCkge3JldHVybiBhdmFpbGFibGVMYW5ndWFnZXM7fSxcclxuICAgICAgICAgICAgICAgIGdldExhbmd1YWdlRmlsZVByZWZpeCA6IGZ1bmN0aW9uKCkge3JldHVybiBwcmVmaXg7fVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0pXHJcblxyXG4gICAgLmNvbmZpZyggZnVuY3Rpb24gKCR0cmFuc2xhdGVQcm92aWRlcikge1xyXG4gICAgICAgICR0cmFuc2xhdGVQcm92aWRlci51c2VMb2FkZXIoJ2N1c3RvbUxvYWRlcicsIHt9KTtcclxuICAgICAgICAvLyBsb2FkICdlbicgdGFibGUgb24gc3RhcnR1cFxyXG4gICAgICAgICR0cmFuc2xhdGVQcm92aWRlci5wcmVmZXJyZWRMYW5ndWFnZSgnZW4nKTtcclxuICAgIH0pXHJcblxyXG4gICAgLmNvbnRyb2xsZXIoJ0xhbmd1YWdlQ3RybCcsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJHRyYW5zbGF0ZScsICdsYW5ndWFnZUNoYW5nZXInLCAnZGF0YVJlcG9zaXRvcnknLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCAkdHJhbnNsYXRlLCBsYW5ndWFnZUNoYW5nZXIsIGRhdGFSZXBvc2l0b3J5KSB7XHJcblxyXG4gICAgICAgICRzY29wZS5jdXJyZW50TGFuZ3VhZ2UgPSBsYW5ndWFnZUNoYW5nZXIuZ2V0TGFuZ3VhZ2UoKTtcclxuICAgICAgICAkc2NvcGUuYXZhaWxhYmxlTGFuZ3VhZ2VzID0gbGFuZ3VhZ2VDaGFuZ2VyLmdldEF2YWlsYWJsZUxhbmd1YWdlcygpO1xyXG5cclxuICAgICAgICAkc2NvcGUuY2hhbmdlTGFuZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbGFuZ3VhZ2VDaGFuZ2VyLnNldExhbmd1YWdlKCRzY29wZS5jdXJyZW50TGFuZ3VhZ2UpXHJcbiAgICAgICAgICAgICR0cmFuc2xhdGUudXNlKGxhbmd1YWdlQ2hhbmdlci5nZXRMYW5ndWFnZSgpKTtcclxuICAgICAgICAgICAgZGF0YVJlcG9zaXRvcnkubG9hZENvZGVMaXN0KGxhbmd1YWdlQ2hhbmdlci5nZXRMYW5ndWFnZSgpKTtcclxuICAgICAgICAgICAgaWYgKGxhbmd1YWdlQ2hhbmdlci5nZXRMYW5ndWFnZSgpICE9ICRyb290U2NvcGUuY3VycmVudExhbmd1YWdlKSB7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRMYW5ndWFnZSA9IGxhbmd1YWdlQ2hhbmdlci5nZXRMYW5ndWFnZSgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgICRyb290U2NvcGUuJHdhdGNoKCdjdXJyZW50TGFuZ3VhZ2UnLCBmdW5jdGlvbihuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKCFuZXdWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFvbGRWYWx1ZSB8fCAobGFuZ3VhZ2VDaGFuZ2VyLmdldExhbmd1YWdlKCkgIT0gJHJvb3RTY29wZS5jdXJyZW50TGFuZ3VhZ2UpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRMYW5ndWFnZSA9ICRyb290U2NvcGUuY3VycmVudExhbmd1YWdlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jaGFuZ2VMYW5nKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfV0pXHJcblxyXG4gICAgLmRpcmVjdGl2ZShcImxhbmd1YWdlQ2hhbmdlclwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0xhbmd1YWdlQ3RybCcsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiBcIjxkaXYgbmctc2hvdz1cXFwiYXZhaWxhYmxlTGFuZ3VhZ2VzLml0ZW0ubGVuZ3RoID4gMFxcXCIgY2xhc3M9XFxcInNwYW4yXFxcIiBuZy1jb250cm9sbGVyPVxcXCJMYW5ndWFnZUN0cmxcXFwiIHN0eWxlPVxcXCJmbG9hdDogcmlnaHQ7XFxcIj48c2VsZWN0IG5hbWU9XFxcIkZvcm1MYW5ndWFnZVxcXCIgY2xhc3M9XFxcImlucHV0LW1lZGl1bVxcXCIgbmctbW9kZWw9XFxcImN1cnJlbnRMYW5ndWFnZVxcXCIgbmctb3B0aW9ucz1cXFwibGFuZ3VhZ2UuY29kZSBhcyBsYW5ndWFnZS5sYWJlbCBmb3IgbGFuZ3VhZ2UgaW4gYXZhaWxhYmxlTGFuZ3VhZ2VzLml0ZW1cXFwiIG5nLWNoYW5nZT1cXFwiY2hhbmdlTGFuZygpXFxcIj48L3NlbGVjdD48L2Rpdj5cIlxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdwYXNjYWxwcmVjaHQudHJhbnNsYXRlJykuZmFjdG9yeSgnJHRyYW5zbGF0ZVN0YXRpY0ZpbGVzTG9hZGVyJywgW1xuICAnJHEnLFxuICAnJGh0dHAnLFxuICBmdW5jdGlvbiAoJHEsICRodHRwKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICBpZiAoIW9wdGlvbnMgfHwgKCFhbmd1bGFyLmlzU3RyaW5nKG9wdGlvbnMucHJlZml4KSB8fCAhYW5ndWxhci5pc1N0cmluZyhvcHRpb25zLnN1ZmZpeCkpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGRuXFwndCBsb2FkIHN0YXRpYyBmaWxlcywgbm8gcHJlZml4IG9yIHN1ZmZpeCBzcGVjaWZpZWQhJyk7XG4gICAgICB9XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgJGh0dHAoe1xuICAgICAgICB1cmw6IFtcbiAgICAgICAgICBvcHRpb25zLnByZWZpeCxcbiAgICAgICAgICBvcHRpb25zLmtleSxcbiAgICAgICAgICBvcHRpb25zLnN1ZmZpeFxuICAgICAgICBdLmpvaW4oJycpLFxuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICBwYXJhbXM6ICcnXG4gICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGRlZmVycmVkLnJlc29sdmUoZGF0YSk7XG4gICAgICB9KS5lcnJvcihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBkZWZlcnJlZC5yZWplY3Qob3B0aW9ucy5rZXkpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICB9O1xuICB9XG5dKTsiLCJhbmd1bGFyLm1vZHVsZSgncGFzY2FscHJlY2h0LnRyYW5zbGF0ZScsIFsnbmcnXSkucnVuKFtcbiAgJyR0cmFuc2xhdGUnLFxuICBmdW5jdGlvbiAoJHRyYW5zbGF0ZSkge1xuICAgIHZhciBrZXkgPSAkdHJhbnNsYXRlLnN0b3JhZ2VLZXkoKSwgc3RvcmFnZSA9ICR0cmFuc2xhdGUuc3RvcmFnZSgpO1xuICAgIGlmIChzdG9yYWdlKSB7XG4gICAgICBpZiAoIXN0b3JhZ2UuZ2V0KGtleSkpIHtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNTdHJpbmcoJHRyYW5zbGF0ZS5wcmVmZXJyZWRMYW5ndWFnZSgpKSkge1xuICAgICAgICAgICR0cmFuc2xhdGUudXNlKCR0cmFuc2xhdGUucHJlZmVycmVkTGFuZ3VhZ2UoKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc3RvcmFnZS5zZXQoa2V5LCAkdHJhbnNsYXRlLnVzZSgpKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHRyYW5zbGF0ZS51c2Uoc3RvcmFnZS5nZXQoa2V5KSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChhbmd1bGFyLmlzU3RyaW5nKCR0cmFuc2xhdGUucHJlZmVycmVkTGFuZ3VhZ2UoKSkpIHtcbiAgICAgICR0cmFuc2xhdGUudXNlKCR0cmFuc2xhdGUucHJlZmVycmVkTGFuZ3VhZ2UoKSk7XG4gICAgfVxuICB9XG5dKTtcbmFuZ3VsYXIubW9kdWxlKCdwYXNjYWxwcmVjaHQudHJhbnNsYXRlJykucHJvdmlkZXIoJyR0cmFuc2xhdGUnLCBbXG4gICckU1RPUkFHRV9LRVknLFxuICBmdW5jdGlvbiAoJFNUT1JBR0VfS0VZKSB7XG4gICAgdmFyICR0cmFuc2xhdGlvblRhYmxlID0ge30sICRwcmVmZXJyZWRMYW5ndWFnZSwgJGF2YWlsYWJsZUxhbmd1YWdlS2V5cyA9IFtdLCAkbGFuZ3VhZ2VLZXlBbGlhc2VzLCAkZmFsbGJhY2tMYW5ndWFnZSwgJGZhbGxiYWNrV2FzU3RyaW5nLCAkdXNlcywgJG5leHRMYW5nLCAkc3RvcmFnZUZhY3RvcnksICRzdG9yYWdlS2V5ID0gJFNUT1JBR0VfS0VZLCAkc3RvcmFnZVByZWZpeCwgJG1pc3NpbmdUcmFuc2xhdGlvbkhhbmRsZXJGYWN0b3J5LCAkaW50ZXJwb2xhdGlvbkZhY3RvcnksICRpbnRlcnBvbGF0b3JGYWN0b3JpZXMgPSBbXSwgJGludGVycG9sYXRpb25TYW5pdGl6YXRpb25TdHJhdGVneSA9IGZhbHNlLCAkbG9hZGVyRmFjdG9yeSwgJGNsb2FrQ2xhc3NOYW1lID0gJ3RyYW5zbGF0ZS1jbG9haycsICRsb2FkZXJPcHRpb25zLCAkbm90Rm91bmRJbmRpY2F0b3JMZWZ0LCAkbm90Rm91bmRJbmRpY2F0b3JSaWdodCwgJHBvc3RDb21waWxpbmdFbmFibGVkID0gZmFsc2UsIE5FU1RFRF9PQkpFQ1RfREVMSU1JVEVSID0gJy4nO1xuICAgIHZhciBnZXRMb2NhbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgbmF2ID0gd2luZG93Lm5hdmlnYXRvcjtcbiAgICAgIHJldHVybiAobmF2Lmxhbmd1YWdlIHx8IG5hdi5icm93c2VyTGFuZ3VhZ2UgfHwgbmF2LnN5c3RlbUxhbmd1YWdlIHx8IG5hdi51c2VyTGFuZ3VhZ2UgfHwgJycpLnNwbGl0KCctJykuam9pbignXycpO1xuICAgIH07XG4gICAgdmFyIG5lZ290aWF0ZUxvY2FsZSA9IGZ1bmN0aW9uIChwcmVmZXJyZWQpIHtcbiAgICAgIHZhciBhdmFpbCA9IFtdLCBsb2NhbGUgPSBhbmd1bGFyLmxvd2VyY2FzZShwcmVmZXJyZWQpLCBpID0gMCwgbiA9ICRhdmFpbGFibGVMYW5ndWFnZUtleXMubGVuZ3RoO1xuICAgICAgZm9yICg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgYXZhaWwucHVzaChhbmd1bGFyLmxvd2VyY2FzZSgkYXZhaWxhYmxlTGFuZ3VhZ2VLZXlzW2ldKSk7XG4gICAgICB9XG4gICAgICBpZiAoYXZhaWwuaW5kZXhPZihsb2NhbGUpID4gLTEpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsZTtcbiAgICAgIH1cbiAgICAgIGlmICgkbGFuZ3VhZ2VLZXlBbGlhc2VzKSB7XG4gICAgICAgIGlmICgkbGFuZ3VhZ2VLZXlBbGlhc2VzW3ByZWZlcnJlZF0pIHtcbiAgICAgICAgICB2YXIgYWxpYXMgPSAkbGFuZ3VhZ2VLZXlBbGlhc2VzW3ByZWZlcnJlZF07XG4gICAgICAgICAgaWYgKGF2YWlsLmluZGV4T2YoYW5ndWxhci5sb3dlcmNhc2UoYWxpYXMpKSA+IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gYWxpYXM7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICB2YXIgcGFydHMgPSBwcmVmZXJyZWQuc3BsaXQoJ18nKTtcbiAgICAgIGlmIChwYXJ0cy5sZW5ndGggPiAxICYmIGF2YWlsLmluZGV4T2YoYW5ndWxhci5sb3dlcmNhc2UocGFydHNbMF0pKSA+IDEpIHtcbiAgICAgICAgcmV0dXJuIHBhcnRzWzBdO1xuICAgICAgfVxuICAgIH07XG4gICAgdmFyIHRyYW5zbGF0aW9ucyA9IGZ1bmN0aW9uIChsYW5nS2V5LCB0cmFuc2xhdGlvblRhYmxlKSB7XG4gICAgICBpZiAoIWxhbmdLZXkgJiYgIXRyYW5zbGF0aW9uVGFibGUpIHtcbiAgICAgICAgcmV0dXJuICR0cmFuc2xhdGlvblRhYmxlO1xuICAgICAgfVxuICAgICAgaWYgKGxhbmdLZXkgJiYgIXRyYW5zbGF0aW9uVGFibGUpIHtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNTdHJpbmcobGFuZ0tleSkpIHtcbiAgICAgICAgICByZXR1cm4gJHRyYW5zbGF0aW9uVGFibGVbbGFuZ0tleV07XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghYW5ndWxhci5pc09iamVjdCgkdHJhbnNsYXRpb25UYWJsZVtsYW5nS2V5XSkpIHtcbiAgICAgICAgICAkdHJhbnNsYXRpb25UYWJsZVtsYW5nS2V5XSA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIGFuZ3VsYXIuZXh0ZW5kKCR0cmFuc2xhdGlvblRhYmxlW2xhbmdLZXldLCBmbGF0T2JqZWN0KHRyYW5zbGF0aW9uVGFibGUpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy50cmFuc2xhdGlvbnMgPSB0cmFuc2xhdGlvbnM7XG4gICAgdGhpcy5jbG9ha0NsYXNzTmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICBpZiAoIW5hbWUpIHtcbiAgICAgICAgcmV0dXJuICRjbG9ha0NsYXNzTmFtZTtcbiAgICAgIH1cbiAgICAgICRjbG9ha0NsYXNzTmFtZSA9IG5hbWU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHZhciBmbGF0T2JqZWN0ID0gZnVuY3Rpb24gKGRhdGEsIHBhdGgsIHJlc3VsdCwgcHJldktleSkge1xuICAgICAgdmFyIGtleSwga2V5V2l0aFBhdGgsIGtleVdpdGhTaG9ydFBhdGgsIHZhbDtcbiAgICAgIGlmICghcGF0aCkge1xuICAgICAgICBwYXRoID0gW107XG4gICAgICB9XG4gICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXN1bHQgPSB7fTtcbiAgICAgIH1cbiAgICAgIGZvciAoa2V5IGluIGRhdGEpIHtcbiAgICAgICAgaWYgKCFkYXRhLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB2YWwgPSBkYXRhW2tleV07XG4gICAgICAgIGlmIChhbmd1bGFyLmlzT2JqZWN0KHZhbCkpIHtcbiAgICAgICAgICBmbGF0T2JqZWN0KHZhbCwgcGF0aC5jb25jYXQoa2V5KSwgcmVzdWx0LCBrZXkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGtleVdpdGhQYXRoID0gcGF0aC5sZW5ndGggPyAnJyArIHBhdGguam9pbihORVNURURfT0JKRUNUX0RFTElNSVRFUikgKyBORVNURURfT0JKRUNUX0RFTElNSVRFUiArIGtleSA6IGtleTtcbiAgICAgICAgICBpZiAocGF0aC5sZW5ndGggJiYga2V5ID09PSBwcmV2S2V5KSB7XG4gICAgICAgICAgICBrZXlXaXRoU2hvcnRQYXRoID0gJycgKyBwYXRoLmpvaW4oTkVTVEVEX09CSkVDVF9ERUxJTUlURVIpO1xuICAgICAgICAgICAgcmVzdWx0W2tleVdpdGhTaG9ydFBhdGhdID0gJ0A6JyArIGtleVdpdGhQYXRoO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXN1bHRba2V5V2l0aFBhdGhdID0gdmFsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgdGhpcy5hZGRJbnRlcnBvbGF0aW9uID0gZnVuY3Rpb24gKGZhY3RvcnkpIHtcbiAgICAgICRpbnRlcnBvbGF0b3JGYWN0b3JpZXMucHVzaChmYWN0b3J5KTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy51c2VNZXNzYWdlRm9ybWF0SW50ZXJwb2xhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLnVzZUludGVycG9sYXRpb24oJyR0cmFuc2xhdGVNZXNzYWdlRm9ybWF0SW50ZXJwb2xhdGlvbicpO1xuICAgIH07XG4gICAgdGhpcy51c2VJbnRlcnBvbGF0aW9uID0gZnVuY3Rpb24gKGZhY3RvcnkpIHtcbiAgICAgICRpbnRlcnBvbGF0aW9uRmFjdG9yeSA9IGZhY3Rvcnk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHRoaXMudXNlU2FuaXRpemVWYWx1ZVN0cmF0ZWd5ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAkaW50ZXJwb2xhdGlvblNhbml0aXphdGlvblN0cmF0ZWd5ID0gdmFsdWU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHRoaXMucHJlZmVycmVkTGFuZ3VhZ2UgPSBmdW5jdGlvbiAobGFuZ0tleSkge1xuICAgICAgaWYgKGxhbmdLZXkpIHtcbiAgICAgICAgJHByZWZlcnJlZExhbmd1YWdlID0gbGFuZ0tleTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG4gICAgICByZXR1cm4gJHByZWZlcnJlZExhbmd1YWdlO1xuICAgIH07XG4gICAgdGhpcy50cmFuc2xhdGlvbk5vdEZvdW5kSW5kaWNhdG9yID0gZnVuY3Rpb24gKGluZGljYXRvcikge1xuICAgICAgdGhpcy50cmFuc2xhdGlvbk5vdEZvdW5kSW5kaWNhdG9yTGVmdChpbmRpY2F0b3IpO1xuICAgICAgdGhpcy50cmFuc2xhdGlvbk5vdEZvdW5kSW5kaWNhdG9yUmlnaHQoaW5kaWNhdG9yKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy50cmFuc2xhdGlvbk5vdEZvdW5kSW5kaWNhdG9yTGVmdCA9IGZ1bmN0aW9uIChpbmRpY2F0b3IpIHtcbiAgICAgIGlmICghaW5kaWNhdG9yKSB7XG4gICAgICAgIHJldHVybiAkbm90Rm91bmRJbmRpY2F0b3JMZWZ0O1xuICAgICAgfVxuICAgICAgJG5vdEZvdW5kSW5kaWNhdG9yTGVmdCA9IGluZGljYXRvcjtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy50cmFuc2xhdGlvbk5vdEZvdW5kSW5kaWNhdG9yUmlnaHQgPSBmdW5jdGlvbiAoaW5kaWNhdG9yKSB7XG4gICAgICBpZiAoIWluZGljYXRvcikge1xuICAgICAgICByZXR1cm4gJG5vdEZvdW5kSW5kaWNhdG9yUmlnaHQ7XG4gICAgICB9XG4gICAgICAkbm90Rm91bmRJbmRpY2F0b3JSaWdodCA9IGluZGljYXRvcjtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy5mYWxsYmFja0xhbmd1YWdlID0gZnVuY3Rpb24gKGxhbmdLZXkpIHtcbiAgICAgIGZhbGxiYWNrU3RhY2sobGFuZ0tleSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHZhciBmYWxsYmFja1N0YWNrID0gZnVuY3Rpb24gKGxhbmdLZXkpIHtcbiAgICAgIGlmIChsYW5nS2V5KSB7XG4gICAgICAgIGlmIChhbmd1bGFyLmlzU3RyaW5nKGxhbmdLZXkpKSB7XG4gICAgICAgICAgJGZhbGxiYWNrV2FzU3RyaW5nID0gdHJ1ZTtcbiAgICAgICAgICAkZmFsbGJhY2tMYW5ndWFnZSA9IFtsYW5nS2V5XTtcbiAgICAgICAgfSBlbHNlIGlmIChhbmd1bGFyLmlzQXJyYXkobGFuZ0tleSkpIHtcbiAgICAgICAgICAkZmFsbGJhY2tXYXNTdHJpbmcgPSBmYWxzZTtcbiAgICAgICAgICAkZmFsbGJhY2tMYW5ndWFnZSA9IGxhbmdLZXk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNTdHJpbmcoJHByZWZlcnJlZExhbmd1YWdlKSkge1xuICAgICAgICAgICRmYWxsYmFja0xhbmd1YWdlLnB1c2goJHByZWZlcnJlZExhbmd1YWdlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICgkZmFsbGJhY2tXYXNTdHJpbmcpIHtcbiAgICAgICAgICByZXR1cm4gJGZhbGxiYWNrTGFuZ3VhZ2VbMF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuICRmYWxsYmFja0xhbmd1YWdlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLnVzZSA9IGZ1bmN0aW9uIChsYW5nS2V5KSB7XG4gICAgICBpZiAobGFuZ0tleSkge1xuICAgICAgICBpZiAoISR0cmFuc2xhdGlvblRhYmxlW2xhbmdLZXldICYmICEkbG9hZGVyRmFjdG9yeSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignJHRyYW5zbGF0ZVByb3ZpZGVyIGNvdWxkblxcJ3QgZmluZCB0cmFuc2xhdGlvblRhYmxlIGZvciBsYW5nS2V5OiBcXCcnICsgbGFuZ0tleSArICdcXCcnKTtcbiAgICAgICAgfVxuICAgICAgICAkdXNlcyA9IGxhbmdLZXk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgICAgcmV0dXJuICR1c2VzO1xuICAgIH07XG4gICAgdmFyIHN0b3JhZ2VLZXkgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICBpZiAoIWtleSkge1xuICAgICAgICBpZiAoJHN0b3JhZ2VQcmVmaXgpIHtcbiAgICAgICAgICByZXR1cm4gJHN0b3JhZ2VQcmVmaXggKyAkc3RvcmFnZUtleTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJHN0b3JhZ2VLZXk7XG4gICAgICB9XG4gICAgICAkc3RvcmFnZUtleSA9IGtleTtcbiAgICB9O1xuICAgIHRoaXMuc3RvcmFnZUtleSA9IHN0b3JhZ2VLZXk7XG4gICAgdGhpcy51c2VVcmxMb2FkZXIgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgICByZXR1cm4gdGhpcy51c2VMb2FkZXIoJyR0cmFuc2xhdGVVcmxMb2FkZXInLCB7IHVybDogdXJsIH0pO1xuICAgIH07XG4gICAgdGhpcy51c2VTdGF0aWNGaWxlc0xvYWRlciA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICByZXR1cm4gdGhpcy51c2VMb2FkZXIoJyR0cmFuc2xhdGVTdGF0aWNGaWxlc0xvYWRlcicsIG9wdGlvbnMpO1xuICAgIH07XG4gICAgdGhpcy51c2VMb2FkZXIgPSBmdW5jdGlvbiAobG9hZGVyRmFjdG9yeSwgb3B0aW9ucykge1xuICAgICAgJGxvYWRlckZhY3RvcnkgPSBsb2FkZXJGYWN0b3J5O1xuICAgICAgJGxvYWRlck9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLnVzZUxvY2FsU3RvcmFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLnVzZVN0b3JhZ2UoJyR0cmFuc2xhdGVMb2NhbFN0b3JhZ2UnKTtcbiAgICB9O1xuICAgIHRoaXMudXNlQ29va2llU3RvcmFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLnVzZVN0b3JhZ2UoJyR0cmFuc2xhdGVDb29raWVTdG9yYWdlJyk7XG4gICAgfTtcbiAgICB0aGlzLnVzZVN0b3JhZ2UgPSBmdW5jdGlvbiAoc3RvcmFnZUZhY3RvcnkpIHtcbiAgICAgICRzdG9yYWdlRmFjdG9yeSA9IHN0b3JhZ2VGYWN0b3J5O1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLnN0b3JhZ2VQcmVmaXggPSBmdW5jdGlvbiAocHJlZml4KSB7XG4gICAgICBpZiAoIXByZWZpeCkge1xuICAgICAgICByZXR1cm4gcHJlZml4O1xuICAgICAgfVxuICAgICAgJHN0b3JhZ2VQcmVmaXggPSBwcmVmaXg7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHRoaXMudXNlTWlzc2luZ1RyYW5zbGF0aW9uSGFuZGxlckxvZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLnVzZU1pc3NpbmdUcmFuc2xhdGlvbkhhbmRsZXIoJyR0cmFuc2xhdGVNaXNzaW5nVHJhbnNsYXRpb25IYW5kbGVyTG9nJyk7XG4gICAgfTtcbiAgICB0aGlzLnVzZU1pc3NpbmdUcmFuc2xhdGlvbkhhbmRsZXIgPSBmdW5jdGlvbiAoZmFjdG9yeSkge1xuICAgICAgJG1pc3NpbmdUcmFuc2xhdGlvbkhhbmRsZXJGYWN0b3J5ID0gZmFjdG9yeTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy51c2VQb3N0Q29tcGlsaW5nID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAkcG9zdENvbXBpbGluZ0VuYWJsZWQgPSAhIXZhbHVlO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLmRldGVybWluZVByZWZlcnJlZExhbmd1YWdlID0gZnVuY3Rpb24gKGZuKSB7XG4gICAgICB2YXIgbG9jYWxlID0gZm4gJiYgYW5ndWxhci5pc0Z1bmN0aW9uKGZuKSA/IGZuKCkgOiBnZXRMb2NhbGUoKTtcbiAgICAgIGlmICghJGF2YWlsYWJsZUxhbmd1YWdlS2V5cy5sZW5ndGgpIHtcbiAgICAgICAgJHByZWZlcnJlZExhbmd1YWdlID0gbG9jYWxlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRwcmVmZXJyZWRMYW5ndWFnZSA9IG5lZ290aWF0ZUxvY2FsZShsb2NhbGUpO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5yZWdpc3RlckF2YWlsYWJsZUxhbmd1YWdlS2V5cyA9IGZ1bmN0aW9uIChsYW5ndWFnZUtleXMsIGFsaWFzZXMpIHtcbiAgICAgIGlmIChsYW5ndWFnZUtleXMpIHtcbiAgICAgICAgJGF2YWlsYWJsZUxhbmd1YWdlS2V5cyA9IGxhbmd1YWdlS2V5cztcbiAgICAgICAgaWYgKGFsaWFzZXMpIHtcbiAgICAgICAgICAkbGFuZ3VhZ2VLZXlBbGlhc2VzID0gYWxpYXNlcztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cbiAgICAgIHJldHVybiAkYXZhaWxhYmxlTGFuZ3VhZ2VLZXlzO1xuICAgIH07XG4gICAgdGhpcy4kZ2V0ID0gW1xuICAgICAgJyRsb2cnLFxuICAgICAgJyRpbmplY3RvcicsXG4gICAgICAnJHJvb3RTY29wZScsXG4gICAgICAnJHEnLFxuICAgICAgZnVuY3Rpb24gKCRsb2csICRpbmplY3RvciwgJHJvb3RTY29wZSwgJHEpIHtcbiAgICAgICAgdmFyIFN0b3JhZ2UsIGRlZmF1bHRJbnRlcnBvbGF0b3IgPSAkaW5qZWN0b3IuZ2V0KCRpbnRlcnBvbGF0aW9uRmFjdG9yeSB8fCAnJHRyYW5zbGF0ZURlZmF1bHRJbnRlcnBvbGF0aW9uJyksIHBlbmRpbmdMb2FkZXIgPSBmYWxzZSwgaW50ZXJwb2xhdG9ySGFzaE1hcCA9IHt9LCBsYW5nUHJvbWlzZXMgPSB7fSwgZmFsbGJhY2tJbmRleCwgc3RhcnRGYWxsYmFja0l0ZXJhdGlvbjtcbiAgICAgICAgdmFyICR0cmFuc2xhdGUgPSBmdW5jdGlvbiAodHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIGludGVycG9sYXRpb25JZCkge1xuICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgdHJhbnNsYXRpb25JZCA9IHRyYW5zbGF0aW9uSWQudHJpbSgpO1xuICAgICAgICAgIHZhciBwcm9taXNlVG9XYWl0Rm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9ICRwcmVmZXJyZWRMYW5ndWFnZSA/IGxhbmdQcm9taXNlc1skcHJlZmVycmVkTGFuZ3VhZ2VdIDogbGFuZ1Byb21pc2VzWyR1c2VzXTtcbiAgICAgICAgICAgICAgZmFsbGJhY2tJbmRleCA9IDA7XG4gICAgICAgICAgICAgIGlmICgkc3RvcmFnZUZhY3RvcnkgJiYgIXByb21pc2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGFuZ0tleSA9IFN0b3JhZ2UuZ2V0KCRzdG9yYWdlS2V5KTtcbiAgICAgICAgICAgICAgICBwcm9taXNlID0gbGFuZ1Byb21pc2VzW2xhbmdLZXldO1xuICAgICAgICAgICAgICAgIGlmICgkZmFsbGJhY2tMYW5ndWFnZSAmJiAkZmFsbGJhY2tMYW5ndWFnZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IGluZGV4T2YoJGZhbGxiYWNrTGFuZ3VhZ2UsIGxhbmdLZXkpO1xuICAgICAgICAgICAgICAgICAgZmFsbGJhY2tJbmRleCA9IGluZGV4ID4gLTEgPyBpbmRleCArPSAxIDogMDtcbiAgICAgICAgICAgICAgICAgICRmYWxsYmFja0xhbmd1YWdlLnB1c2goJHByZWZlcnJlZExhbmd1YWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgICAgICB9KCk7XG4gICAgICAgICAgaWYgKCFwcm9taXNlVG9XYWl0Rm9yKSB7XG4gICAgICAgICAgICBkZXRlcm1pbmVUcmFuc2xhdGlvbih0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgaW50ZXJwb2xhdGlvbklkKS50aGVuKGRlZmVycmVkLnJlc29sdmUsIGRlZmVycmVkLnJlamVjdCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb21pc2VUb1dhaXRGb3IudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIGRldGVybWluZVRyYW5zbGF0aW9uKHRyYW5zbGF0aW9uSWQsIGludGVycG9sYXRlUGFyYW1zLCBpbnRlcnBvbGF0aW9uSWQpLnRoZW4oZGVmZXJyZWQucmVzb2x2ZSwgZGVmZXJyZWQucmVqZWN0KTtcbiAgICAgICAgICAgIH0sIGRlZmVycmVkLnJlamVjdCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgaW5kZXhPZiA9IGZ1bmN0aW9uIChhcnJheSwgc2VhcmNoRWxlbWVudCkge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhcnJheS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgaWYgKGFycmF5W2ldID09PSBzZWFyY2hFbGVtZW50KSB7XG4gICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBhcHBseU5vdEZvdW5kSW5kaWNhdG9ycyA9IGZ1bmN0aW9uICh0cmFuc2xhdGlvbklkKSB7XG4gICAgICAgICAgaWYgKCRub3RGb3VuZEluZGljYXRvckxlZnQpIHtcbiAgICAgICAgICAgIHRyYW5zbGF0aW9uSWQgPSBbXG4gICAgICAgICAgICAgICRub3RGb3VuZEluZGljYXRvckxlZnQsXG4gICAgICAgICAgICAgIHRyYW5zbGF0aW9uSWRcbiAgICAgICAgICAgIF0uam9pbignICcpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoJG5vdEZvdW5kSW5kaWNhdG9yUmlnaHQpIHtcbiAgICAgICAgICAgIHRyYW5zbGF0aW9uSWQgPSBbXG4gICAgICAgICAgICAgIHRyYW5zbGF0aW9uSWQsXG4gICAgICAgICAgICAgICRub3RGb3VuZEluZGljYXRvclJpZ2h0XG4gICAgICAgICAgICBdLmpvaW4oJyAnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRyYW5zbGF0aW9uSWQ7XG4gICAgICAgIH07XG4gICAgICAgIHZhciB1c2VMYW5ndWFnZSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAkdXNlcyA9IGtleTtcbiAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCckdHJhbnNsYXRlQ2hhbmdlU3VjY2VzcycpO1xuICAgICAgICAgIGlmICgkc3RvcmFnZUZhY3RvcnkpIHtcbiAgICAgICAgICAgIFN0b3JhZ2Uuc2V0KCR0cmFuc2xhdGUuc3RvcmFnZUtleSgpLCAkdXNlcyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGRlZmF1bHRJbnRlcnBvbGF0b3Iuc2V0TG9jYWxlKCR1c2VzKTtcbiAgICAgICAgICBhbmd1bGFyLmZvckVhY2goaW50ZXJwb2xhdG9ySGFzaE1hcCwgZnVuY3Rpb24gKGludGVycG9sYXRvciwgaWQpIHtcbiAgICAgICAgICAgIGludGVycG9sYXRvckhhc2hNYXBbaWRdLnNldExvY2FsZSgkdXNlcyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnJHRyYW5zbGF0ZUNoYW5nZUVuZCcpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgbG9hZEFzeW5jID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIGlmICgha2V5KSB7XG4gICAgICAgICAgICB0aHJvdyAnTm8gbGFuZ3VhZ2Uga2V5IHNwZWNpZmllZCBmb3IgbG9hZGluZy4nO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJyR0cmFuc2xhdGVMb2FkaW5nU3RhcnQnKTtcbiAgICAgICAgICBwZW5kaW5nTG9hZGVyID0gdHJ1ZTtcbiAgICAgICAgICAkaW5qZWN0b3IuZ2V0KCRsb2FkZXJGYWN0b3J5KShhbmd1bGFyLmV4dGVuZCgkbG9hZGVyT3B0aW9ucywgeyBrZXk6IGtleSB9KSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmFyIHRyYW5zbGF0aW9uVGFibGUgPSB7fTtcbiAgICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJyR0cmFuc2xhdGVMb2FkaW5nU3VjY2VzcycpO1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZGF0YSwgZnVuY3Rpb24gKHRhYmxlKSB7XG4gICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQodHJhbnNsYXRpb25UYWJsZSwgZmxhdE9iamVjdCh0YWJsZSkpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKHRyYW5zbGF0aW9uVGFibGUsIGZsYXRPYmplY3QoZGF0YSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGVuZGluZ0xvYWRlciA9IGZhbHNlO1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSh7XG4gICAgICAgICAgICAgIGtleToga2V5LFxuICAgICAgICAgICAgICB0YWJsZTogdHJhbnNsYXRpb25UYWJsZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCckdHJhbnNsYXRlTG9hZGluZ0VuZCcpO1xuICAgICAgICAgIH0sIGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJyR0cmFuc2xhdGVMb2FkaW5nRXJyb3InKTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChrZXkpO1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnJHRyYW5zbGF0ZUxvYWRpbmdFbmQnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCRzdG9yYWdlRmFjdG9yeSkge1xuICAgICAgICAgIFN0b3JhZ2UgPSAkaW5qZWN0b3IuZ2V0KCRzdG9yYWdlRmFjdG9yeSk7XG4gICAgICAgICAgaWYgKCFTdG9yYWdlLmdldCB8fCAhU3RvcmFnZS5zZXQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGRuXFwndCB1c2Ugc3RvcmFnZSBcXCcnICsgJHN0b3JhZ2VGYWN0b3J5ICsgJ1xcJywgbWlzc2luZyBnZXQoKSBvciBzZXQoKSBtZXRob2QhJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24oZGVmYXVsdEludGVycG9sYXRvci51c2VTYW5pdGl6ZVZhbHVlU3RyYXRlZ3kpKSB7XG4gICAgICAgICAgZGVmYXVsdEludGVycG9sYXRvci51c2VTYW5pdGl6ZVZhbHVlU3RyYXRlZ3koJGludGVycG9sYXRpb25TYW5pdGl6YXRpb25TdHJhdGVneSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCRpbnRlcnBvbGF0b3JGYWN0b3JpZXMubGVuZ3RoKSB7XG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRpbnRlcnBvbGF0b3JGYWN0b3JpZXMsIGZ1bmN0aW9uIChpbnRlcnBvbGF0b3JGYWN0b3J5KSB7XG4gICAgICAgICAgICB2YXIgaW50ZXJwb2xhdG9yID0gJGluamVjdG9yLmdldChpbnRlcnBvbGF0b3JGYWN0b3J5KTtcbiAgICAgICAgICAgIGludGVycG9sYXRvci5zZXRMb2NhbGUoJHByZWZlcnJlZExhbmd1YWdlIHx8ICR1c2VzKTtcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24oaW50ZXJwb2xhdG9yLnVzZVNhbml0aXplVmFsdWVTdHJhdGVneSkpIHtcbiAgICAgICAgICAgICAgaW50ZXJwb2xhdG9yLnVzZVNhbml0aXplVmFsdWVTdHJhdGVneSgkaW50ZXJwb2xhdGlvblNhbml0aXphdGlvblN0cmF0ZWd5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGludGVycG9sYXRvckhhc2hNYXBbaW50ZXJwb2xhdG9yLmdldEludGVycG9sYXRpb25JZGVudGlmaWVyKCldID0gaW50ZXJwb2xhdG9yO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBnZXRUcmFuc2xhdGlvblRhYmxlID0gZnVuY3Rpb24gKGxhbmdLZXkpIHtcbiAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgIGlmICgkdHJhbnNsYXRpb25UYWJsZS5oYXNPd25Qcm9wZXJ0eShsYW5nS2V5KSkge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgkdHJhbnNsYXRpb25UYWJsZVtsYW5nS2V5XSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGFuZ1Byb21pc2VzW2xhbmdLZXldLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgdHJhbnNsYXRpb25zKGRhdGEua2V5LCBkYXRhLnRhYmxlKTtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShkYXRhLnRhYmxlKTtcbiAgICAgICAgICAgIH0sIGRlZmVycmVkLnJlamVjdCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgZ2V0RmFsbGJhY2tUcmFuc2xhdGlvbiA9IGZ1bmN0aW9uIChsYW5nS2V5LCB0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgSW50ZXJwb2xhdG9yKSB7XG4gICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICBnZXRUcmFuc2xhdGlvblRhYmxlKGxhbmdLZXkpLnRoZW4oZnVuY3Rpb24gKHRyYW5zbGF0aW9uVGFibGUpIHtcbiAgICAgICAgICAgIGlmICh0cmFuc2xhdGlvblRhYmxlLmhhc093blByb3BlcnR5KHRyYW5zbGF0aW9uSWQpKSB7XG4gICAgICAgICAgICAgIEludGVycG9sYXRvci5zZXRMb2NhbGUobGFuZ0tleSk7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoSW50ZXJwb2xhdG9yLmludGVycG9sYXRlKHRyYW5zbGF0aW9uVGFibGVbdHJhbnNsYXRpb25JZF0sIGludGVycG9sYXRlUGFyYW1zKSk7XG4gICAgICAgICAgICAgIEludGVycG9sYXRvci5zZXRMb2NhbGUoJHVzZXMpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgZGVmZXJyZWQucmVqZWN0KTtcbiAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGdldEZhbGxiYWNrVHJhbnNsYXRpb25JbnN0YW50ID0gZnVuY3Rpb24gKGxhbmdLZXksIHRyYW5zbGF0aW9uSWQsIGludGVycG9sYXRlUGFyYW1zLCBJbnRlcnBvbGF0b3IpIHtcbiAgICAgICAgICB2YXIgcmVzdWx0LCB0cmFuc2xhdGlvblRhYmxlID0gJHRyYW5zbGF0aW9uVGFibGVbbGFuZ0tleV07XG4gICAgICAgICAgaWYgKHRyYW5zbGF0aW9uVGFibGUuaGFzT3duUHJvcGVydHkodHJhbnNsYXRpb25JZCkpIHtcbiAgICAgICAgICAgIEludGVycG9sYXRvci5zZXRMb2NhbGUobGFuZ0tleSk7XG4gICAgICAgICAgICByZXN1bHQgPSBJbnRlcnBvbGF0b3IuaW50ZXJwb2xhdGUodHJhbnNsYXRpb25UYWJsZVt0cmFuc2xhdGlvbklkXSwgaW50ZXJwb2xhdGVQYXJhbXMpO1xuICAgICAgICAgICAgSW50ZXJwb2xhdG9yLnNldExvY2FsZSgkdXNlcyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICAgIHZhciByZXNvbHZlRm9yRmFsbGJhY2tMYW5ndWFnZSA9IGZ1bmN0aW9uIChmYWxsYmFja0xhbmd1YWdlSW5kZXgsIHRyYW5zbGF0aW9uSWQsIGludGVycG9sYXRlUGFyYW1zLCBJbnRlcnBvbGF0b3IpIHtcbiAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgIGlmIChmYWxsYmFja0xhbmd1YWdlSW5kZXggPCAkZmFsbGJhY2tMYW5ndWFnZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciBsYW5nS2V5ID0gJGZhbGxiYWNrTGFuZ3VhZ2VbZmFsbGJhY2tMYW5ndWFnZUluZGV4XTtcbiAgICAgICAgICAgIGdldEZhbGxiYWNrVHJhbnNsYXRpb24obGFuZ0tleSwgdHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIEludGVycG9sYXRvcikudGhlbihmdW5jdGlvbiAodHJhbnNsYXRpb24pIHtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSh0cmFuc2xhdGlvbik7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHZhciBuZXh0RmFsbGJhY2tMYW5ndWFnZVByb21pc2UgPSByZXNvbHZlRm9yRmFsbGJhY2tMYW5ndWFnZShmYWxsYmFja0xhbmd1YWdlSW5kZXggKyAxLCB0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgSW50ZXJwb2xhdG9yKTtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShuZXh0RmFsbGJhY2tMYW5ndWFnZVByb21pc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUodHJhbnNsYXRpb25JZCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgcmVzb2x2ZUZvckZhbGxiYWNrTGFuZ3VhZ2VJbnN0YW50ID0gZnVuY3Rpb24gKGZhbGxiYWNrTGFuZ3VhZ2VJbmRleCwgdHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIEludGVycG9sYXRvcikge1xuICAgICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgICAgaWYgKGZhbGxiYWNrTGFuZ3VhZ2VJbmRleCA8ICRmYWxsYmFja0xhbmd1YWdlLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIGxhbmdLZXkgPSAkZmFsbGJhY2tMYW5ndWFnZVtmYWxsYmFja0xhbmd1YWdlSW5kZXhdO1xuICAgICAgICAgICAgcmVzdWx0ID0gZ2V0RmFsbGJhY2tUcmFuc2xhdGlvbkluc3RhbnQobGFuZ0tleSwgdHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIEludGVycG9sYXRvcik7XG4gICAgICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgICByZXN1bHQgPSByZXNvbHZlRm9yRmFsbGJhY2tMYW5ndWFnZUluc3RhbnQoZmFsbGJhY2tMYW5ndWFnZUluZGV4ICsgMSwgdHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIEludGVycG9sYXRvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBmYWxsYmFja1RyYW5zbGF0aW9uID0gZnVuY3Rpb24gKHRyYW5zbGF0aW9uSWQsIGludGVycG9sYXRlUGFyYW1zLCBJbnRlcnBvbGF0b3IpIHtcbiAgICAgICAgICByZXR1cm4gcmVzb2x2ZUZvckZhbGxiYWNrTGFuZ3VhZ2Uoc3RhcnRGYWxsYmFja0l0ZXJhdGlvbiA+IDAgPyBzdGFydEZhbGxiYWNrSXRlcmF0aW9uIDogZmFsbGJhY2tJbmRleCwgdHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIEludGVycG9sYXRvcik7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBmYWxsYmFja1RyYW5zbGF0aW9uSW5zdGFudCA9IGZ1bmN0aW9uICh0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgSW50ZXJwb2xhdG9yKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc29sdmVGb3JGYWxsYmFja0xhbmd1YWdlSW5zdGFudChzdGFydEZhbGxiYWNrSXRlcmF0aW9uID4gMCA/IHN0YXJ0RmFsbGJhY2tJdGVyYXRpb24gOiBmYWxsYmFja0luZGV4LCB0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgSW50ZXJwb2xhdG9yKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGRldGVybWluZVRyYW5zbGF0aW9uID0gZnVuY3Rpb24gKHRyYW5zbGF0aW9uSWQsIGludGVycG9sYXRlUGFyYW1zLCBpbnRlcnBvbGF0aW9uSWQpIHtcbiAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgIHZhciB0YWJsZSA9ICR1c2VzID8gJHRyYW5zbGF0aW9uVGFibGVbJHVzZXNdIDogJHRyYW5zbGF0aW9uVGFibGUsIEludGVycG9sYXRvciA9IGludGVycG9sYXRpb25JZCA/IGludGVycG9sYXRvckhhc2hNYXBbaW50ZXJwb2xhdGlvbklkXSA6IGRlZmF1bHRJbnRlcnBvbGF0b3I7XG4gICAgICAgICAgaWYgKHRhYmxlICYmIHRhYmxlLmhhc093blByb3BlcnR5KHRyYW5zbGF0aW9uSWQpKSB7XG4gICAgICAgICAgICB2YXIgdHJhbnNsYXRpb24gPSB0YWJsZVt0cmFuc2xhdGlvbklkXTtcbiAgICAgICAgICAgIGlmICh0cmFuc2xhdGlvbi5zdWJzdHIoMCwgMikgPT09ICdAOicpIHtcbiAgICAgICAgICAgICAgJHRyYW5zbGF0ZSh0cmFuc2xhdGlvbi5zdWJzdHIoMiksIGludGVycG9sYXRlUGFyYW1zLCBpbnRlcnBvbGF0aW9uSWQpLnRoZW4oZGVmZXJyZWQucmVzb2x2ZSwgZGVmZXJyZWQucmVqZWN0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoSW50ZXJwb2xhdG9yLmludGVycG9sYXRlKHRyYW5zbGF0aW9uLCBpbnRlcnBvbGF0ZVBhcmFtcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoJG1pc3NpbmdUcmFuc2xhdGlvbkhhbmRsZXJGYWN0b3J5ICYmICFwZW5kaW5nTG9hZGVyKSB7XG4gICAgICAgICAgICAgICRpbmplY3Rvci5nZXQoJG1pc3NpbmdUcmFuc2xhdGlvbkhhbmRsZXJGYWN0b3J5KSh0cmFuc2xhdGlvbklkLCAkdXNlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoJHVzZXMgJiYgJGZhbGxiYWNrTGFuZ3VhZ2UgJiYgJGZhbGxiYWNrTGFuZ3VhZ2UubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIGZhbGxiYWNrVHJhbnNsYXRpb24odHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIEludGVycG9sYXRvcikudGhlbihmdW5jdGlvbiAodHJhbnNsYXRpb24pIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHRyYW5zbGF0aW9uKTtcbiAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKF90cmFuc2xhdGlvbklkKSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGFwcGx5Tm90Rm91bmRJbmRpY2F0b3JzKF90cmFuc2xhdGlvbklkKSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGFwcGx5Tm90Rm91bmRJbmRpY2F0b3JzKHRyYW5zbGF0aW9uSWQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBkZXRlcm1pbmVUcmFuc2xhdGlvbkluc3RhbnQgPSBmdW5jdGlvbiAodHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIGludGVycG9sYXRpb25JZCkge1xuICAgICAgICAgIHZhciByZXN1bHQsIHRhYmxlID0gJHVzZXMgPyAkdHJhbnNsYXRpb25UYWJsZVskdXNlc10gOiAkdHJhbnNsYXRpb25UYWJsZSwgSW50ZXJwb2xhdG9yID0gaW50ZXJwb2xhdGlvbklkID8gaW50ZXJwb2xhdG9ySGFzaE1hcFtpbnRlcnBvbGF0aW9uSWRdIDogZGVmYXVsdEludGVycG9sYXRvcjtcbiAgICAgICAgICBpZiAodGFibGUgJiYgdGFibGUuaGFzT3duUHJvcGVydHkodHJhbnNsYXRpb25JZCkpIHtcbiAgICAgICAgICAgIHZhciB0cmFuc2xhdGlvbiA9IHRhYmxlW3RyYW5zbGF0aW9uSWRdO1xuICAgICAgICAgICAgaWYgKHRyYW5zbGF0aW9uLnN1YnN0cigwLCAyKSA9PT0gJ0A6Jykge1xuICAgICAgICAgICAgICByZXN1bHQgPSBkZXRlcm1pbmVUcmFuc2xhdGlvbkluc3RhbnQodHJhbnNsYXRpb24uc3Vic3RyKDIpLCBpbnRlcnBvbGF0ZVBhcmFtcywgaW50ZXJwb2xhdGlvbklkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJlc3VsdCA9IEludGVycG9sYXRvci5pbnRlcnBvbGF0ZSh0cmFuc2xhdGlvbiwgaW50ZXJwb2xhdGVQYXJhbXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoJG1pc3NpbmdUcmFuc2xhdGlvbkhhbmRsZXJGYWN0b3J5ICYmICFwZW5kaW5nTG9hZGVyKSB7XG4gICAgICAgICAgICAgICRpbmplY3Rvci5nZXQoJG1pc3NpbmdUcmFuc2xhdGlvbkhhbmRsZXJGYWN0b3J5KSh0cmFuc2xhdGlvbklkLCAkdXNlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoJHVzZXMgJiYgJGZhbGxiYWNrTGFuZ3VhZ2UgJiYgJGZhbGxiYWNrTGFuZ3VhZ2UubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIGZhbGxiYWNrSW5kZXggPSAwO1xuICAgICAgICAgICAgICByZXN1bHQgPSBmYWxsYmFja1RyYW5zbGF0aW9uSW5zdGFudCh0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgSW50ZXJwb2xhdG9yKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJlc3VsdCA9IGFwcGx5Tm90Rm91bmRJbmRpY2F0b3JzKHRyYW5zbGF0aW9uSWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgICAkdHJhbnNsYXRlLnByZWZlcnJlZExhbmd1YWdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiAkcHJlZmVycmVkTGFuZ3VhZ2U7XG4gICAgICAgIH07XG4gICAgICAgICR0cmFuc2xhdGUuY2xvYWtDbGFzc05hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuICRjbG9ha0NsYXNzTmFtZTtcbiAgICAgICAgfTtcbiAgICAgICAgJHRyYW5zbGF0ZS5mYWxsYmFja0xhbmd1YWdlID0gZnVuY3Rpb24gKGxhbmdLZXkpIHtcbiAgICAgICAgICBpZiAobGFuZ0tleSAhPT0gdW5kZWZpbmVkICYmIGxhbmdLZXkgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGZhbGxiYWNrU3RhY2sobGFuZ0tleSk7XG4gICAgICAgICAgICBpZiAoJGxvYWRlckZhY3RvcnkpIHtcbiAgICAgICAgICAgICAgaWYgKCRmYWxsYmFja0xhbmd1YWdlICYmICRmYWxsYmFja0xhbmd1YWdlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSAkZmFsbGJhY2tMYW5ndWFnZS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgICAgaWYgKCFsYW5nUHJvbWlzZXNbJGZhbGxiYWNrTGFuZ3VhZ2VbaV1dKSB7XG4gICAgICAgICAgICAgICAgICAgIGxhbmdQcm9taXNlc1skZmFsbGJhY2tMYW5ndWFnZVtpXV0gPSBsb2FkQXN5bmMoJGZhbGxiYWNrTGFuZ3VhZ2VbaV0pO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHRyYW5zbGF0ZS51c2UoJHRyYW5zbGF0ZS51c2UoKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICgkZmFsbGJhY2tXYXNTdHJpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiAkZmFsbGJhY2tMYW5ndWFnZVswXTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICRmYWxsYmFja0xhbmd1YWdlO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgJHRyYW5zbGF0ZS51c2VGYWxsYmFja0xhbmd1YWdlID0gZnVuY3Rpb24gKGxhbmdLZXkpIHtcbiAgICAgICAgICBpZiAobGFuZ0tleSAhPT0gdW5kZWZpbmVkICYmIGxhbmdLZXkgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGlmICghbGFuZ0tleSkge1xuICAgICAgICAgICAgICBzdGFydEZhbGxiYWNrSXRlcmF0aW9uID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHZhciBsYW5nS2V5UG9zaXRpb24gPSBpbmRleE9mKCRmYWxsYmFja0xhbmd1YWdlLCBsYW5nS2V5KTtcbiAgICAgICAgICAgICAgaWYgKGxhbmdLZXlQb3NpdGlvbiA+IC0xKSB7XG4gICAgICAgICAgICAgICAgc3RhcnRGYWxsYmFja0l0ZXJhdGlvbiA9IGxhbmdLZXlQb3NpdGlvbjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgJHRyYW5zbGF0ZS5wcm9wb3NlZExhbmd1YWdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiAkbmV4dExhbmc7XG4gICAgICAgIH07XG4gICAgICAgICR0cmFuc2xhdGUuc3RvcmFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gU3RvcmFnZTtcbiAgICAgICAgfTtcbiAgICAgICAgJHRyYW5zbGF0ZS51c2UgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgaWYgKCFrZXkpIHtcbiAgICAgICAgICAgIHJldHVybiAkdXNlcztcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCckdHJhbnNsYXRlQ2hhbmdlU3RhcnQnKTtcbiAgICAgICAgICBpZiAoISR0cmFuc2xhdGlvblRhYmxlW2tleV0gJiYgJGxvYWRlckZhY3RvcnkpIHtcbiAgICAgICAgICAgICRuZXh0TGFuZyA9IGtleTtcbiAgICAgICAgICAgIGxhbmdQcm9taXNlc1trZXldID0gbG9hZEFzeW5jKGtleSkudGhlbihmdW5jdGlvbiAodHJhbnNsYXRpb24pIHtcbiAgICAgICAgICAgICAgdHJhbnNsYXRpb25zKHRyYW5zbGF0aW9uLmtleSwgdHJhbnNsYXRpb24udGFibGUpO1xuICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHRyYW5zbGF0aW9uLmtleSk7XG4gICAgICAgICAgICAgIGlmICgkbmV4dExhbmcgPT09IGtleSkge1xuICAgICAgICAgICAgICAgIHVzZUxhbmd1YWdlKHRyYW5zbGF0aW9uLmtleSk7XG4gICAgICAgICAgICAgICAgJG5leHRMYW5nID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAgICRuZXh0TGFuZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnJHRyYW5zbGF0ZUNoYW5nZUVycm9yJyk7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChrZXkpO1xuICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCckdHJhbnNsYXRlQ2hhbmdlRW5kJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShrZXkpO1xuICAgICAgICAgICAgdXNlTGFuZ3VhZ2Uoa2V5KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH07XG4gICAgICAgICR0cmFuc2xhdGUuc3RvcmFnZUtleSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gc3RvcmFnZUtleSgpO1xuICAgICAgICB9O1xuICAgICAgICAkdHJhbnNsYXRlLmlzUG9zdENvbXBpbGluZ0VuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuICRwb3N0Q29tcGlsaW5nRW5hYmxlZDtcbiAgICAgICAgfTtcbiAgICAgICAgJHRyYW5zbGF0ZS5yZWZyZXNoID0gZnVuY3Rpb24gKGxhbmdLZXkpIHtcbiAgICAgICAgICBpZiAoISRsb2FkZXJGYWN0b3J5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkblxcJ3QgcmVmcmVzaCB0cmFuc2xhdGlvbiB0YWJsZSwgbm8gbG9hZGVyIHJlZ2lzdGVyZWQhJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZSgpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJyR0cmFuc2xhdGVSZWZyZXNoRW5kJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZ1bmN0aW9uIHJlamVjdCgpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCgpO1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnJHRyYW5zbGF0ZVJlZnJlc2hFbmQnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnJHRyYW5zbGF0ZVJlZnJlc2hTdGFydCcpO1xuICAgICAgICAgIGlmICghbGFuZ0tleSkge1xuICAgICAgICAgICAgdmFyIHRhYmxlcyA9IFtdO1xuICAgICAgICAgICAgaWYgKCRmYWxsYmFja0xhbmd1YWdlICYmICRmYWxsYmFja0xhbmd1YWdlLmxlbmd0aCkge1xuICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gJGZhbGxiYWNrTGFuZ3VhZ2UubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0YWJsZXMucHVzaChsb2FkQXN5bmMoJGZhbGxiYWNrTGFuZ3VhZ2VbaV0pKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCR1c2VzKSB7XG4gICAgICAgICAgICAgIHRhYmxlcy5wdXNoKGxvYWRBc3luYygkdXNlcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHEuYWxsKHRhYmxlcykudGhlbihmdW5jdGlvbiAodGFibGVEYXRhKSB7XG4gICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCh0YWJsZURhdGEsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKCR0cmFuc2xhdGlvblRhYmxlW2RhdGEua2V5XSkge1xuICAgICAgICAgICAgICAgICAgZGVsZXRlICR0cmFuc2xhdGlvblRhYmxlW2RhdGEua2V5XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdHJhbnNsYXRpb25zKGRhdGEua2V5LCBkYXRhLnRhYmxlKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGlmICgkdXNlcykge1xuICAgICAgICAgICAgICAgIHVzZUxhbmd1YWdlKCR1c2VzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2UgaWYgKCR0cmFuc2xhdGlvblRhYmxlW2xhbmdLZXldKSB7XG4gICAgICAgICAgICBsb2FkQXN5bmMobGFuZ0tleSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICB0cmFuc2xhdGlvbnMoZGF0YS5rZXksIGRhdGEudGFibGUpO1xuICAgICAgICAgICAgICBpZiAobGFuZ0tleSA9PT0gJHVzZXMpIHtcbiAgICAgICAgICAgICAgICB1c2VMYW5ndWFnZSgkdXNlcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSwgcmVqZWN0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICAkdHJhbnNsYXRlLmluc3RhbnQgPSBmdW5jdGlvbiAodHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIGludGVycG9sYXRpb25JZCkge1xuICAgICAgICAgIGlmICh0eXBlb2YgdHJhbnNsYXRpb25JZCA9PT0gJ3VuZGVmaW5lZCcgfHwgdHJhbnNsYXRpb25JZCA9PT0gJycpIHtcbiAgICAgICAgICAgIHJldHVybiB0cmFuc2xhdGlvbklkO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0cmFuc2xhdGlvbklkID0gdHJhbnNsYXRpb25JZC50cmltKCk7XG4gICAgICAgICAgdmFyIHJlc3VsdCwgcG9zc2libGVMYW5nS2V5cyA9IFtdO1xuICAgICAgICAgIGlmICgkcHJlZmVycmVkTGFuZ3VhZ2UpIHtcbiAgICAgICAgICAgIHBvc3NpYmxlTGFuZ0tleXMucHVzaCgkcHJlZmVycmVkTGFuZ3VhZ2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoJHVzZXMpIHtcbiAgICAgICAgICAgIHBvc3NpYmxlTGFuZ0tleXMucHVzaCgkdXNlcyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICgkZmFsbGJhY2tMYW5ndWFnZSAmJiAkZmFsbGJhY2tMYW5ndWFnZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHBvc3NpYmxlTGFuZ0tleXMgPSBwb3NzaWJsZUxhbmdLZXlzLmNvbmNhdCgkZmFsbGJhY2tMYW5ndWFnZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjID0gcG9zc2libGVMYW5nS2V5cy5sZW5ndGg7IGkgPCBjOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBwb3NzaWJsZUxhbmdLZXkgPSBwb3NzaWJsZUxhbmdLZXlzW2ldO1xuICAgICAgICAgICAgaWYgKCR0cmFuc2xhdGlvblRhYmxlW3Bvc3NpYmxlTGFuZ0tleV0pIHtcbiAgICAgICAgICAgICAgaWYgKCR0cmFuc2xhdGlvblRhYmxlW3Bvc3NpYmxlTGFuZ0tleV1bdHJhbnNsYXRpb25JZF0pIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBkZXRlcm1pbmVUcmFuc2xhdGlvbkluc3RhbnQodHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIGludGVycG9sYXRpb25JZCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzdWx0ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHRyYW5zbGF0aW9uSWQ7XG4gICAgICAgICAgICBpZiAoJG1pc3NpbmdUcmFuc2xhdGlvbkhhbmRsZXJGYWN0b3J5ICYmICFwZW5kaW5nTG9hZGVyKSB7XG4gICAgICAgICAgICAgICRpbmplY3Rvci5nZXQoJG1pc3NpbmdUcmFuc2xhdGlvbkhhbmRsZXJGYWN0b3J5KSh0cmFuc2xhdGlvbklkLCAkdXNlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICAgIGlmICgkbG9hZGVyRmFjdG9yeSkge1xuICAgICAgICAgIGlmIChhbmd1bGFyLmVxdWFscygkdHJhbnNsYXRpb25UYWJsZSwge30pKSB7XG4gICAgICAgICAgICAkdHJhbnNsYXRlLnVzZSgkdHJhbnNsYXRlLnVzZSgpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCRmYWxsYmFja0xhbmd1YWdlICYmICRmYWxsYmFja0xhbmd1YWdlLmxlbmd0aCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9ICRmYWxsYmFja0xhbmd1YWdlLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgIGxhbmdQcm9taXNlc1skZmFsbGJhY2tMYW5ndWFnZVtpXV0gPSBsb2FkQXN5bmMoJGZhbGxiYWNrTGFuZ3VhZ2VbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJHRyYW5zbGF0ZTtcbiAgICAgIH1cbiAgICBdO1xuICB9XG5dKTtcbmFuZ3VsYXIubW9kdWxlKCdwYXNjYWxwcmVjaHQudHJhbnNsYXRlJykuZmFjdG9yeSgnJHRyYW5zbGF0ZURlZmF1bHRJbnRlcnBvbGF0aW9uJywgW1xuICAnJGludGVycG9sYXRlJyxcbiAgZnVuY3Rpb24gKCRpbnRlcnBvbGF0ZSkge1xuICAgIHZhciAkdHJhbnNsYXRlSW50ZXJwb2xhdG9yID0ge30sICRsb2NhbGUsICRpZGVudGlmaWVyID0gJ2RlZmF1bHQnLCAkc2FuaXRpemVWYWx1ZVN0cmF0ZWd5ID0gbnVsbCwgc2FuaXRpemVWYWx1ZVN0cmF0ZWdpZXMgPSB7XG4gICAgICAgIGVzY2FwZWQ6IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgZm9yICh2YXIga2V5IGluIHBhcmFtcykge1xuICAgICAgICAgICAgaWYgKHBhcmFtcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgIHJlc3VsdFtrZXldID0gYW5ndWxhci5lbGVtZW50KCc8ZGl2PjwvZGl2PicpLnRleHQocGFyYW1zW2tleV0pLmh0bWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB2YXIgc2FuaXRpemVQYXJhbXMgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICB2YXIgcmVzdWx0O1xuICAgICAgaWYgKGFuZ3VsYXIuaXNGdW5jdGlvbihzYW5pdGl6ZVZhbHVlU3RyYXRlZ2llc1skc2FuaXRpemVWYWx1ZVN0cmF0ZWd5XSkpIHtcbiAgICAgICAgcmVzdWx0ID0gc2FuaXRpemVWYWx1ZVN0cmF0ZWdpZXNbJHNhbml0aXplVmFsdWVTdHJhdGVneV0ocGFyYW1zKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IHBhcmFtcztcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICAkdHJhbnNsYXRlSW50ZXJwb2xhdG9yLnNldExvY2FsZSA9IGZ1bmN0aW9uIChsb2NhbGUpIHtcbiAgICAgICRsb2NhbGUgPSBsb2NhbGU7XG4gICAgfTtcbiAgICAkdHJhbnNsYXRlSW50ZXJwb2xhdG9yLmdldEludGVycG9sYXRpb25JZGVudGlmaWVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuICRpZGVudGlmaWVyO1xuICAgIH07XG4gICAgJHRyYW5zbGF0ZUludGVycG9sYXRvci51c2VTYW5pdGl6ZVZhbHVlU3RyYXRlZ3kgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICRzYW5pdGl6ZVZhbHVlU3RyYXRlZ3kgPSB2YWx1ZTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgJHRyYW5zbGF0ZUludGVycG9sYXRvci5pbnRlcnBvbGF0ZSA9IGZ1bmN0aW9uIChzdHJpbmcsIGludGVycG9sYXRlUGFyYW1zKSB7XG4gICAgICBpZiAoJHNhbml0aXplVmFsdWVTdHJhdGVneSkge1xuICAgICAgICBpbnRlcnBvbGF0ZVBhcmFtcyA9IHNhbml0aXplUGFyYW1zKGludGVycG9sYXRlUGFyYW1zKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAkaW50ZXJwb2xhdGUoc3RyaW5nKShpbnRlcnBvbGF0ZVBhcmFtcyk7XG4gICAgfTtcbiAgICByZXR1cm4gJHRyYW5zbGF0ZUludGVycG9sYXRvcjtcbiAgfVxuXSk7XG5hbmd1bGFyLm1vZHVsZSgncGFzY2FscHJlY2h0LnRyYW5zbGF0ZScpLmNvbnN0YW50KCckU1RPUkFHRV9LRVknLCAnTkdfVFJBTlNMQVRFX0xBTkdfS0VZJyk7XG5hbmd1bGFyLm1vZHVsZSgncGFzY2FscHJlY2h0LnRyYW5zbGF0ZScpLmRpcmVjdGl2ZSgndHJhbnNsYXRlJywgW1xuICAnJHRyYW5zbGF0ZScsXG4gICckcScsXG4gICckaW50ZXJwb2xhdGUnLFxuICAnJGNvbXBpbGUnLFxuICAnJHBhcnNlJyxcbiAgJyRyb290U2NvcGUnLFxuICBmdW5jdGlvbiAoJHRyYW5zbGF0ZSwgJHEsICRpbnRlcnBvbGF0ZSwgJGNvbXBpbGUsICRwYXJzZSwgJHJvb3RTY29wZSkge1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0FFJyxcbiAgICAgIHNjb3BlOiB0cnVlLFxuICAgICAgY29tcGlsZTogZnVuY3Rpb24gKHRFbGVtZW50LCB0QXR0cikge1xuICAgICAgICB2YXIgdHJhbnNsYXRlVmFsdWVzRXhpc3QgPSB0QXR0ci50cmFuc2xhdGVWYWx1ZXMgPyB0QXR0ci50cmFuc2xhdGVWYWx1ZXMgOiB1bmRlZmluZWQ7XG4gICAgICAgIHZhciB0cmFuc2xhdGVJbnRlcnBvbGF0aW9uID0gdEF0dHIudHJhbnNsYXRlSW50ZXJwb2xhdGlvbiA/IHRBdHRyLnRyYW5zbGF0ZUludGVycG9sYXRpb24gOiB1bmRlZmluZWQ7XG4gICAgICAgIHZhciB0cmFuc2xhdGVWYWx1ZUV4aXN0ID0gdEVsZW1lbnRbMF0ub3V0ZXJIVE1MLm1hdGNoKC90cmFuc2xhdGUtdmFsdWUtKy9pKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGxpbmtGbihzY29wZSwgaUVsZW1lbnQsIGlBdHRyKSB7XG4gICAgICAgICAgc2NvcGUuaW50ZXJwb2xhdGVQYXJhbXMgPSB7fTtcbiAgICAgICAgICBpQXR0ci4kb2JzZXJ2ZSgndHJhbnNsYXRlJywgZnVuY3Rpb24gKHRyYW5zbGF0aW9uSWQpIHtcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmVxdWFscyh0cmFuc2xhdGlvbklkLCAnJykgfHwgIWFuZ3VsYXIuaXNEZWZpbmVkKHRyYW5zbGF0aW9uSWQpKSB7XG4gICAgICAgICAgICAgIHNjb3BlLnRyYW5zbGF0aW9uSWQgPSAkaW50ZXJwb2xhdGUoaUVsZW1lbnQudGV4dCgpLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKSkoc2NvcGUuJHBhcmVudCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzY29wZS50cmFuc2xhdGlvbklkID0gdHJhbnNsYXRpb25JZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAodHJhbnNsYXRlVmFsdWVzRXhpc3QpIHtcbiAgICAgICAgICAgIGlBdHRyLiRvYnNlcnZlKCd0cmFuc2xhdGVWYWx1ZXMnLCBmdW5jdGlvbiAoaW50ZXJwb2xhdGVQYXJhbXMpIHtcbiAgICAgICAgICAgICAgaWYgKGludGVycG9sYXRlUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgc2NvcGUuJHBhcmVudC4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoc2NvcGUuaW50ZXJwb2xhdGVQYXJhbXMsICRwYXJzZShpbnRlcnBvbGF0ZVBhcmFtcykoc2NvcGUuJHBhcmVudCkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRyYW5zbGF0ZVZhbHVlRXhpc3QpIHtcbiAgICAgICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uIChhdHRyTmFtZSkge1xuICAgICAgICAgICAgICBpQXR0ci4kb2JzZXJ2ZShhdHRyTmFtZSwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgc2NvcGUuaW50ZXJwb2xhdGVQYXJhbXNbYW5ndWxhci5sb3dlcmNhc2UoYXR0ck5hbWUuc3Vic3RyKDE0KSldID0gdmFsdWU7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGZvciAodmFyIGF0dHIgaW4gaUF0dHIpIHtcbiAgICAgICAgICAgICAgaWYgKGlBdHRyLmhhc093blByb3BlcnR5KGF0dHIpICYmIGF0dHIuc3Vic3RyKDAsIDE0KSA9PT0gJ3RyYW5zbGF0ZVZhbHVlJyAmJiBhdHRyICE9PSAndHJhbnNsYXRlVmFsdWVzJykge1xuICAgICAgICAgICAgICAgIGZuKGF0dHIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBhcHBseUVsZW1lbnRDb250ZW50ID0gZnVuY3Rpb24gKHZhbHVlLCBzY29wZSkge1xuICAgICAgICAgICAgaUVsZW1lbnQuaHRtbCh2YWx1ZSk7XG4gICAgICAgICAgICB2YXIgZ2xvYmFsbHlFbmFibGVkID0gJHRyYW5zbGF0ZS5pc1Bvc3RDb21waWxpbmdFbmFibGVkKCk7XG4gICAgICAgICAgICB2YXIgbG9jYWxseURlZmluZWQgPSB0eXBlb2YgdEF0dHIudHJhbnNsYXRlQ29tcGlsZSAhPT0gJ3VuZGVmaW5lZCc7XG4gICAgICAgICAgICB2YXIgbG9jYWxseUVuYWJsZWQgPSBsb2NhbGx5RGVmaW5lZCAmJiB0QXR0ci50cmFuc2xhdGVDb21waWxlICE9PSAnZmFsc2UnO1xuICAgICAgICAgICAgaWYgKGdsb2JhbGx5RW5hYmxlZCAmJiAhbG9jYWxseURlZmluZWQgfHwgbG9jYWxseUVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgJGNvbXBpbGUoaUVsZW1lbnQuY29udGVudHMoKSkoc2NvcGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgICAgdmFyIHVwZGF0ZVRyYW5zbGF0aW9uRm4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIGlmICghdHJhbnNsYXRlVmFsdWVzRXhpc3QgJiYgIXRyYW5zbGF0ZVZhbHVlRXhpc3QpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgdmFyIHVud2F0Y2ggPSBzY29wZS4kd2F0Y2goJ3RyYW5zbGF0aW9uSWQnLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUudHJhbnNsYXRpb25JZCAmJiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHRyYW5zbGF0ZSh2YWx1ZSwge30sIHRyYW5zbGF0ZUludGVycG9sYXRpb24pLnRoZW4oZnVuY3Rpb24gKHRyYW5zbGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGx5RWxlbWVudENvbnRlbnQodHJhbnNsYXRpb24sIHNjb3BlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdW53YXRjaCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHRyYW5zbGF0aW9uSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwbHlFbGVtZW50Q29udGVudCh0cmFuc2xhdGlvbklkLCBzY29wZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVud2F0Y2goKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKCdpbnRlcnBvbGF0ZVBhcmFtcycsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUudHJhbnNsYXRpb25JZCAmJiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICR0cmFuc2xhdGUoc2NvcGUudHJhbnNsYXRpb25JZCwgdmFsdWUsIHRyYW5zbGF0ZUludGVycG9sYXRpb24pLnRoZW4oZnVuY3Rpb24gKHRyYW5zbGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBseUVsZW1lbnRDb250ZW50KHRyYW5zbGF0aW9uLCBzY29wZSk7XG4gICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHRyYW5zbGF0aW9uSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGx5RWxlbWVudENvbnRlbnQodHJhbnNsYXRpb25JZCwgc2NvcGUpO1xuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KCk7XG4gICAgICAgICAgdmFyIHVuYmluZCA9ICRyb290U2NvcGUuJG9uKCckdHJhbnNsYXRlQ2hhbmdlU3VjY2VzcycsIHVwZGF0ZVRyYW5zbGF0aW9uRm4pO1xuICAgICAgICAgIHVwZGF0ZVRyYW5zbGF0aW9uRm4oKTtcbiAgICAgICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgdW5iaW5kKTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5dKTtcbmFuZ3VsYXIubW9kdWxlKCdwYXNjYWxwcmVjaHQudHJhbnNsYXRlJykuZGlyZWN0aXZlKCd0cmFuc2xhdGVDbG9haycsIFtcbiAgJyRyb290U2NvcGUnLFxuICAnJHRyYW5zbGF0ZScsXG4gIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkdHJhbnNsYXRlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uICh0RWxlbWVudCkge1xuICAgICAgICAkcm9vdFNjb3BlLiRvbignJHRyYW5zbGF0ZUxvYWRpbmdTdWNjZXNzJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHRFbGVtZW50LnJlbW92ZUNsYXNzKCR0cmFuc2xhdGUuY2xvYWtDbGFzc05hbWUoKSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0RWxlbWVudC5hZGRDbGFzcygkdHJhbnNsYXRlLmNsb2FrQ2xhc3NOYW1lKCkpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbl0pO1xuYW5ndWxhci5tb2R1bGUoJ3Bhc2NhbHByZWNodC50cmFuc2xhdGUnKS5maWx0ZXIoJ3RyYW5zbGF0ZScsIFtcbiAgJyRwYXJzZScsXG4gICckdHJhbnNsYXRlJyxcbiAgZnVuY3Rpb24gKCRwYXJzZSwgJHRyYW5zbGF0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAodHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIGludGVycG9sYXRpb24pIHtcbiAgICAgIGlmICghYW5ndWxhci5pc09iamVjdChpbnRlcnBvbGF0ZVBhcmFtcykpIHtcbiAgICAgICAgaW50ZXJwb2xhdGVQYXJhbXMgPSAkcGFyc2UoaW50ZXJwb2xhdGVQYXJhbXMpKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gJHRyYW5zbGF0ZS5pbnN0YW50KHRyYW5zbGF0aW9uSWQsIGludGVycG9sYXRlUGFyYW1zLCBpbnRlcnBvbGF0aW9uKTtcbiAgICB9O1xuICB9XG5dKTsiLCIvKiEgXG4gKiBudW1lcmFsLmpzIGxhbmd1YWdlIGNvbmZpZ3VyYXRpb25cbiAqIGxhbmd1YWdlIDogR2VybWFuIChkZSkg4oCTIGdlbmVyYWxseSB1c2VmdWwgaW4gR2VybWFueSwgQXVzdHJpYSwgTHV4ZW1ib3VyZywgQmVsZ2l1bVxuICogYXV0aG9yIDogTWFyY28gS3JhZ2UgOiBodHRwczovL2dpdGh1Yi5jb20vc2lua3lcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbGFuZ3VhZ2UgPSB7XG4gICAgICAgIGRlbGltaXRlcnM6IHtcbiAgICAgICAgICAgIHRob3VzYW5kczogJyAnLFxuICAgICAgICAgICAgZGVjaW1hbDogJywnXG4gICAgICAgIH0sXG4gICAgICAgIGFiYnJldmlhdGlvbnM6IHtcbiAgICAgICAgICAgIHRob3VzYW5kOiAnaycsXG4gICAgICAgICAgICBtaWxsaW9uOiAnbScsXG4gICAgICAgICAgICBiaWxsaW9uOiAnYicsXG4gICAgICAgICAgICB0cmlsbGlvbjogJ3QnXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGluYWw6IGZ1bmN0aW9uIChudW1iZXIpIHtcbiAgICAgICAgICAgIHJldHVybiAnLic7XG4gICAgICAgIH0sXG4gICAgICAgIGN1cnJlbmN5OiB7XG4gICAgICAgICAgICBzeW1ib2w6ICfigqwnXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gTm9kZVxuICAgIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGxhbmd1YWdlO1xuICAgIH1cbiAgICAvLyBCcm93c2VyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHRoaXMubnVtZXJhbCAmJiB0aGlzLm51bWVyYWwubGFuZ3VhZ2UpIHtcbiAgICAgICAgdGhpcy5udW1lcmFsLmxhbmd1YWdlKCdkZScsIGxhbmd1YWdlKTtcbiAgICAgICAgdGhpcy5udW1lcmFsLmxhbmd1YWdlKCdkZS1kZScsIGxhbmd1YWdlKTtcbiAgICB9XG59KCkpOyIsIi8qXG4gKiBwcm9taXNlLXRyYWNrZXIgLSB2Mi4wLjEgLSAyMDE0LTA0LTExXG4gKiBodHRwOi8vZ2l0aHViLmNvbS9ham9zbGluL2FuZ3VsYXItcHJvbWlzZS10cmFja2VyXG4gKiBDcmVhdGVkIGJ5IEFuZHkgSm9zbGluOyBMaWNlbnNlZCB1bmRlciBQdWJsaWMgRG9tYWluXG4gKi9cblxuKGZ1bmN0aW9uKCkge1xuXG5hbmd1bGFyLm1vZHVsZSgnYWpvc2xpbi5wcm9taXNlLXRyYWNrZXInKVxuLmNvbmZpZyhbJyRodHRwUHJvdmlkZXInLCBmdW5jdGlvbigkaHR0cFByb3ZpZGVyKSB7XG4gICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goWyckcScsICdwcm9taXNlVHJhY2tlcicsIGZ1bmN0aW9uKCRxLCBwcm9taXNlVHJhY2tlcikge1xuICAgIHJldHVybiB7XG4gICAgICByZXF1ZXN0OiBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgaWYgKGNvbmZpZy50cmFja2VyKSB7XG4gICAgICAgICAgaWYgKCFhbmd1bGFyLmlzQXJyYXkoY29uZmlnLnRyYWNrZXIpKSB7XG4gICAgICAgICAgICBjb25maWcudHJhY2tlciA9IFtjb25maWcudHJhY2tlcl07XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbmZpZy4kcHJvbWlzZVRyYWNrZXJEZWZlcnJlZCA9IGNvbmZpZy4kcHJvbWlzZVRyYWNrZXJEZWZlcnJlZCB8fCBbXTtcblxuICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChjb25maWcudHJhY2tlciwgZnVuY3Rpb24odHJhY2tlcikge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gdHJhY2tlci5jcmVhdGVQcm9taXNlKCk7XG4gICAgICAgICAgICBjb25maWcuJHByb21pc2VUcmFja2VyRGVmZXJyZWQucHVzaChkZWZlcnJlZCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICRxLndoZW4oY29uZmlnKTtcbiAgICAgIH0sXG4gICAgICByZXNwb25zZTogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmNvbmZpZyAmJiByZXNwb25zZS5jb25maWcuJHByb21pc2VUcmFja2VyRGVmZXJyZWQpIHtcbiAgICAgICAgICBhbmd1bGFyLmZvckVhY2gocmVzcG9uc2UuY29uZmlnLiRwcm9taXNlVHJhY2tlckRlZmVycmVkLCBmdW5jdGlvbihkZWZlcnJlZCkge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgfSxcbiAgICAgIHJlc3BvbnNlRXJyb3I6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5jb25maWcgJiYgcmVzcG9uc2UuY29uZmlnLiRwcm9taXNlVHJhY2tlckRlZmVycmVkKSB7XG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHJlc3BvbnNlLmNvbmZpZy4kcHJvbWlzZVRyYWNrZXJEZWZlcnJlZCwgZnVuY3Rpb24oZGVmZXJyZWQpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XG4gICAgICB9XG4gICAgfTtcbiAgfV0pO1xufV0pO1xuXG59KCkpOyIsIi8qXG4gKiBwcm9taXNlLXRyYWNrZXIgLSB2Mi4wLjEgLSAyMDE0LTA0LTExXG4gKiBodHRwOi8vZ2l0aHViLmNvbS9ham9zbGluL2FuZ3VsYXItcHJvbWlzZS10cmFja2VyXG4gKiBDcmVhdGVkIGJ5IEFuZHkgSm9zbGluOyBMaWNlbnNlZCB1bmRlciBQdWJsaWMgRG9tYWluXG4gKi9cblxuKGZ1bmN0aW9uKCkge1xuXG5hbmd1bGFyLm1vZHVsZSgnYWpvc2xpbi5wcm9taXNlLXRyYWNrZXInLCBbXSlcblxuLnByb3ZpZGVyKCdwcm9taXNlVHJhY2tlcicsIGZ1bmN0aW9uKCkge1xuICB2YXIgdHJhY2tlcnMgPSB7fTtcblxuICB0aGlzLiRnZXQgPSBbJyRxJywgJyR0aW1lb3V0JywgZnVuY3Rpb24oJHEsICR0aW1lb3V0KSB7XG4gICAgZnVuY3Rpb24gY2FuY2VsVGltZW91dChwcm9taXNlKSB7XG4gICAgICBpZiAocHJvbWlzZSkge1xuICAgICAgICAkdGltZW91dC5jYW5jZWwocHJvbWlzZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIFByb21pc2VUcmFja2VyKG9wdGlvbnMpIHtcbiAgICAgIC8vZG8gbmV3IGlmIHVzZXIgZG9lc24ndFxuICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFByb21pc2VUcmFja2VyKSkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2VUcmFja2VyKG9wdGlvbnMpO1xuICAgICAgfVxuXG4gICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgLy9BcnJheSBvZiBwcm9taXNlcyBiZWluZyB0cmFja2VkXG4gICAgICB2YXIgdHJhY2tlZCA9IFtdO1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAvL0FsbG93IGFuIG9wdGlvbmFsIFwibWluaW11bSBkdXJhdGlvblwiIHRoYXQgdGhlIHRyYWNrZXIgaGFzIHRvIHN0YXkgYWN0aXZlIGZvci5cbiAgICAgIHZhciBtaW5EdXJhdGlvbiA9IG9wdGlvbnMubWluRHVyYXRpb247XG4gICAgICAvL0FsbG93IGEgZGVsYXkgdGhhdCB3aWxsIHN0b3AgdGhlIHRyYWNrZXIgZnJvbSBhY3RpdmF0aW5nIHVudGlsIHRoYXQgdGltZSBpcyByZWFjaGVkXG4gICAgICB2YXIgYWN0aXZhdGlvbkRlbGF5ID0gb3B0aW9ucy5hY3RpdmF0aW9uRGVsYXk7XG5cbiAgICAgIHZhciBtaW5EdXJhdGlvblByb21pc2U7XG4gICAgICB2YXIgYWN0aXZhdGlvbkRlbGF5UHJvbWlzZTtcblxuICAgICAgc2VsZi5hY3RpdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLy9FdmVuIGlmIHdlIGhhdmUgYSBwcm9taXNlIGluIG91ciB0cmFja2VyLCB3ZSBhcmVuJ3QgYWN0aXZlIHVudGlsIGRlbGF5IGlzIGVsYXBzZWRcbiAgICAgICAgaWYgKGFjdGl2YXRpb25EZWxheVByb21pc2UpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRyYWNrZWQubGVuZ3RoID4gMDtcbiAgICAgIH07XG5cbiAgICAgIHNlbGYudHJhY2tpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLy9FdmVuIGlmIHdlIGFyZW4ndCBhY3RpdmUsIHdlIGNvdWxkIHN0aWxsIGhhdmUgYSBwcm9taXNlIGluIG91ciB0cmFja2VyXG4gICAgICAgIHJldHVybiB0cmFja2VkLmxlbmd0aCA+IDA7XG4gICAgICB9O1xuXG4gICAgICBzZWxmLmRlc3Ryb3kgPSBzZWxmLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBtaW5EdXJhdGlvblByb21pc2UgPSBjYW5jZWxUaW1lb3V0KG1pbkR1cmF0aW9uUHJvbWlzZSk7XG4gICAgICAgIGFjdGl2YXRpb25EZWxheVByb21pc2UgPSBjYW5jZWxUaW1lb3V0KGFjdGl2YXRpb25EZWxheVByb21pc2UpO1xuICAgICAgICBmb3IgKHZhciBpPXRyYWNrZWQubGVuZ3RoLTE7IGk+PTA7IGktLSkge1xuICAgICAgICAgIHRyYWNrZWRbaV0ucmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRyYWNrZWQubGVuZ3RoID0gMDtcbiAgICAgIH07XG5cbiAgICAgIC8vQ3JlYXRlIGEgcHJvbWlzZSB0aGF0IHdpbGwgbWFrZSBvdXIgdHJhY2tlciBhY3RpdmUgdW50aWwgaXQgaXMgcmVzb2x2ZWQuXG4gICAgICAvLyBAcmV0dXJuIGRlZmVycmVkIC0gb3VyIGRlZmVycmVkIG9iamVjdCB0aGF0IGlzIGJlaW5nIHRyYWNrZWRcbiAgICAgIHNlbGYuY3JlYXRlUHJvbWlzZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB0cmFja2VkLnB1c2goZGVmZXJyZWQpO1xuXG4gICAgICAgIC8vSWYgdGhlIHRyYWNrZXIgd2FzIGp1c3QgaW5hY3RpdmUgYW5kIHRoaXMgdGhlIGZpcnN0IGluIHRoZSBsaXN0IG9mXG4gICAgICAgIC8vcHJvbWlzZXMsIHdlIHJlc2V0IG91ciBkZWxheSBhbmQgbWluRHVyYXRpb25cbiAgICAgICAgLy9hZ2Fpbi5cbiAgICAgICAgaWYgKHRyYWNrZWQubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgaWYgKGFjdGl2YXRpb25EZWxheSkge1xuICAgICAgICAgICAgYWN0aXZhdGlvbkRlbGF5UHJvbWlzZSA9ICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBhY3RpdmF0aW9uRGVsYXlQcm9taXNlID0gY2FuY2VsVGltZW91dChhY3RpdmF0aW9uRGVsYXlQcm9taXNlKTtcbiAgICAgICAgICAgICAgc3RhcnRNaW5EdXJhdGlvbigpO1xuICAgICAgICAgICAgfSwgYWN0aXZhdGlvbkRlbGF5KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RhcnRNaW5EdXJhdGlvbigpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGRlZmVycmVkLnByb21pc2UudGhlbihvbkRvbmUoZmFsc2UpLCBvbkRvbmUodHJ1ZSkpO1xuXG4gICAgICAgIHJldHVybiBkZWZlcnJlZDtcblxuICAgICAgICBmdW5jdGlvbiBzdGFydE1pbkR1cmF0aW9uKCkge1xuICAgICAgICAgIGlmIChtaW5EdXJhdGlvbikge1xuICAgICAgICAgICAgbWluRHVyYXRpb25Qcm9taXNlID0gJHRpbWVvdXQoYW5ndWxhci5ub29wLCBtaW5EdXJhdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9DcmVhdGUgYSBjYWxsYmFjayBmb3Igd2hlbiB0aGlzIHByb21pc2UgaXMgZG9uZS4gSXQgd2lsbCByZW1vdmUgb3VyXG4gICAgICAgIC8vdHJhY2tlZCBwcm9taXNlIGZyb20gdGhlIGFycmF5IGlmIG9uY2UgbWluRHVyYXRpb24gaXMgY29tcGxldGVcbiAgICAgICAgZnVuY3Rpb24gb25Eb25lKGlzRXJyb3IpIHtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIChtaW5EdXJhdGlvblByb21pc2UgfHwgJHEud2hlbigpKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICB2YXIgaW5kZXggPSB0cmFja2VkLmluZGV4T2YoZGVmZXJyZWQpO1xuICAgICAgICAgICAgICB0cmFja2VkLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICAgICAgICAgICAgLy9JZiB0aGlzIGlzIHRoZSBsYXN0IHByb21pc2UsIGNsZWFudXAgdGhlIHRpbWVvdXRzXG4gICAgICAgICAgICAgIC8vZm9yIGFjdGl2YXRpb25EZWxheVxuICAgICAgICAgICAgICBpZiAodHJhY2tlZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBhY3RpdmF0aW9uRGVsYXlQcm9taXNlID0gY2FuY2VsVGltZW91dChhY3RpdmF0aW9uRGVsYXlQcm9taXNlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgc2VsZi5hZGRQcm9taXNlID0gZnVuY3Rpb24ocHJvbWlzZSkge1xuICAgICAgICB2YXIgdGhlbiA9IHByb21pc2UgJiYgKHByb21pc2UudGhlbiB8fCBwcm9taXNlLiR0aGVuIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHByb21pc2UuJHByb21pc2UgJiYgcHJvbWlzZS4kcHJvbWlzZS50aGVuKSk7XG4gICAgICAgIGlmICghdGhlbikge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInByb21pc2VUcmFja2VyI2FkZFByb21pc2UgZXhwZWN0cyBhIHByb21pc2Ugb2JqZWN0IVwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGVmZXJyZWQgPSBzZWxmLmNyZWF0ZVByb21pc2UoKTtcblxuICAgICAgICAvL1doZW4gZ2l2ZW4gcHJvbWlzZSBpcyBkb25lLCByZXNvbHZlIG91ciBjcmVhdGVkIHByb21pc2VcbiAgICAgICAgLy9BbGxvdyAkdGhlbiBmb3IgYW5ndWxhci1yZXNvdXJjZSBvYmplY3RzXG4gICAgICAgIHRoZW4oZnVuY3Rpb24gc3VjY2Vzcyh2YWx1ZSkge1xuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUodmFsdWUpO1xuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3IodmFsdWUpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QodmFsdWUpO1xuICAgICAgICAgIHJldHVybiAkcS5yZWplY3QodmFsdWUpO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZGVmZXJyZWQ7XG4gICAgICB9O1xuICAgIH07XG4gIH1dO1xufSk7XG5cbn0oKSk7XG4iLCIvKlxuICogYW5ndWxhci11aS1ib290c3RyYXBcbiAqIGh0dHA6Ly9hbmd1bGFyLXVpLmdpdGh1Yi5pby9ib290c3RyYXAvXG5cbiAqIFZlcnNpb246IDAuMTEuMiAtIDIwMTQtMDktMjZcbiAqIExpY2Vuc2U6IE1JVFxuICovXG5hbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcFwiLFtcInVpLmJvb3RzdHJhcC50cGxzXCIsXCJ1aS5ib290c3RyYXAudHJhbnNpdGlvblwiLFwidWkuYm9vdHN0cmFwLmNvbGxhcHNlXCIsXCJ1aS5ib290c3RyYXAuYWNjb3JkaW9uXCIsXCJ1aS5ib290c3RyYXAuYWxlcnRcIixcInVpLmJvb3RzdHJhcC5iaW5kSHRtbFwiLFwidWkuYm9vdHN0cmFwLmJ1dHRvbnNcIixcInVpLmJvb3RzdHJhcC5jYXJvdXNlbFwiLFwidWkuYm9vdHN0cmFwLmRhdGVwYXJzZXJcIixcInVpLmJvb3RzdHJhcC5wb3NpdGlvblwiLFwidWkuYm9vdHN0cmFwLmRhdGVwaWNrZXJcIixcInVpLmJvb3RzdHJhcC5kcm9wZG93blwiLFwidWkuYm9vdHN0cmFwLm1vZGFsXCIsXCJ1aS5ib290c3RyYXAucGFnaW5hdGlvblwiLFwidWkuYm9vdHN0cmFwLnRvb2x0aXBcIixcInVpLmJvb3RzdHJhcC5wb3BvdmVyXCIsXCJ1aS5ib290c3RyYXAucHJvZ3Jlc3NiYXJcIixcInVpLmJvb3RzdHJhcC5yYXRpbmdcIixcInVpLmJvb3RzdHJhcC50YWJzXCIsXCJ1aS5ib290c3RyYXAudGltZXBpY2tlclwiLFwidWkuYm9vdHN0cmFwLnR5cGVhaGVhZFwiXSksYW5ndWxhci5tb2R1bGUoXCJ1aS5ib290c3RyYXAudHBsc1wiLFtcInRlbXBsYXRlL2FjY29yZGlvbi9hY2NvcmRpb24tZ3JvdXAuaHRtbFwiLFwidGVtcGxhdGUvYWNjb3JkaW9uL2FjY29yZGlvbi5odG1sXCIsXCJ0ZW1wbGF0ZS9hbGVydC9hbGVydC5odG1sXCIsXCJ0ZW1wbGF0ZS9jYXJvdXNlbC9jYXJvdXNlbC5odG1sXCIsXCJ0ZW1wbGF0ZS9jYXJvdXNlbC9zbGlkZS5odG1sXCIsXCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL2RhdGVwaWNrZXIuaHRtbFwiLFwidGVtcGxhdGUvZGF0ZXBpY2tlci9kYXkuaHRtbFwiLFwidGVtcGxhdGUvZGF0ZXBpY2tlci9tb250aC5odG1sXCIsXCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL3BvcHVwLmh0bWxcIixcInRlbXBsYXRlL2RhdGVwaWNrZXIveWVhci5odG1sXCIsXCJ0ZW1wbGF0ZS9tb2RhbC9iYWNrZHJvcC5odG1sXCIsXCJ0ZW1wbGF0ZS9tb2RhbC93aW5kb3cuaHRtbFwiLFwidGVtcGxhdGUvcGFnaW5hdGlvbi9wYWdlci5odG1sXCIsXCJ0ZW1wbGF0ZS9wYWdpbmF0aW9uL3BhZ2luYXRpb24uaHRtbFwiLFwidGVtcGxhdGUvdG9vbHRpcC90b29sdGlwLWh0bWwtdW5zYWZlLXBvcHVwLmh0bWxcIixcInRlbXBsYXRlL3Rvb2x0aXAvdG9vbHRpcC1wb3B1cC5odG1sXCIsXCJ0ZW1wbGF0ZS9wb3BvdmVyL3BvcG92ZXIuaHRtbFwiLFwidGVtcGxhdGUvcHJvZ3Jlc3NiYXIvYmFyLmh0bWxcIixcInRlbXBsYXRlL3Byb2dyZXNzYmFyL3Byb2dyZXNzLmh0bWxcIixcInRlbXBsYXRlL3Byb2dyZXNzYmFyL3Byb2dyZXNzYmFyLmh0bWxcIixcInRlbXBsYXRlL3JhdGluZy9yYXRpbmcuaHRtbFwiLFwidGVtcGxhdGUvdGFicy90YWIuaHRtbFwiLFwidGVtcGxhdGUvdGFicy90YWJzZXQuaHRtbFwiLFwidGVtcGxhdGUvdGltZXBpY2tlci90aW1lcGlja2VyLmh0bWxcIixcInRlbXBsYXRlL3R5cGVhaGVhZC90eXBlYWhlYWQtbWF0Y2guaHRtbFwiLFwidGVtcGxhdGUvdHlwZWFoZWFkL3R5cGVhaGVhZC1wb3B1cC5odG1sXCJdKSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC50cmFuc2l0aW9uXCIsW10pLmZhY3RvcnkoXCIkdHJhbnNpdGlvblwiLFtcIiRxXCIsXCIkdGltZW91dFwiLFwiJHJvb3RTY29wZVwiLGZ1bmN0aW9uKGEsYixjKXtmdW5jdGlvbiBkKGEpe2Zvcih2YXIgYiBpbiBhKWlmKHZvaWQgMCE9PWYuc3R5bGVbYl0pcmV0dXJuIGFbYl19dmFyIGU9ZnVuY3Rpb24oZCxmLGcpe2c9Z3x8e307dmFyIGg9YS5kZWZlcigpLGk9ZVtnLmFuaW1hdGlvbj9cImFuaW1hdGlvbkVuZEV2ZW50TmFtZVwiOlwidHJhbnNpdGlvbkVuZEV2ZW50TmFtZVwiXSxqPWZ1bmN0aW9uKCl7Yy4kYXBwbHkoZnVuY3Rpb24oKXtkLnVuYmluZChpLGopLGgucmVzb2x2ZShkKX0pfTtyZXR1cm4gaSYmZC5iaW5kKGksaiksYihmdW5jdGlvbigpe2FuZ3VsYXIuaXNTdHJpbmcoZik/ZC5hZGRDbGFzcyhmKTphbmd1bGFyLmlzRnVuY3Rpb24oZik/ZihkKTphbmd1bGFyLmlzT2JqZWN0KGYpJiZkLmNzcyhmKSxpfHxoLnJlc29sdmUoZCl9KSxoLnByb21pc2UuY2FuY2VsPWZ1bmN0aW9uKCl7aSYmZC51bmJpbmQoaSxqKSxoLnJlamVjdChcIlRyYW5zaXRpb24gY2FuY2VsbGVkXCIpfSxoLnByb21pc2V9LGY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRyYW5zXCIpLGc9e1dlYmtpdFRyYW5zaXRpb246XCJ3ZWJraXRUcmFuc2l0aW9uRW5kXCIsTW96VHJhbnNpdGlvbjpcInRyYW5zaXRpb25lbmRcIixPVHJhbnNpdGlvbjpcIm9UcmFuc2l0aW9uRW5kXCIsdHJhbnNpdGlvbjpcInRyYW5zaXRpb25lbmRcIn0saD17V2Via2l0VHJhbnNpdGlvbjpcIndlYmtpdEFuaW1hdGlvbkVuZFwiLE1velRyYW5zaXRpb246XCJhbmltYXRpb25lbmRcIixPVHJhbnNpdGlvbjpcIm9BbmltYXRpb25FbmRcIix0cmFuc2l0aW9uOlwiYW5pbWF0aW9uZW5kXCJ9O3JldHVybiBlLnRyYW5zaXRpb25FbmRFdmVudE5hbWU9ZChnKSxlLmFuaW1hdGlvbkVuZEV2ZW50TmFtZT1kKGgpLGV9XSksYW5ndWxhci5tb2R1bGUoXCJ1aS5ib290c3RyYXAuY29sbGFwc2VcIixbXCJ1aS5ib290c3RyYXAudHJhbnNpdGlvblwiXSkuZGlyZWN0aXZlKFwiY29sbGFwc2VcIixbXCIkdHJhbnNpdGlvblwiLGZ1bmN0aW9uKGEpe3JldHVybntsaW5rOmZ1bmN0aW9uKGIsYyxkKXtmdW5jdGlvbiBlKGIpe2Z1bmN0aW9uIGQoKXtqPT09ZSYmKGo9dm9pZCAwKX12YXIgZT1hKGMsYik7cmV0dXJuIGomJmouY2FuY2VsKCksaj1lLGUudGhlbihkLGQpLGV9ZnVuY3Rpb24gZigpe2s/KGs9ITEsZygpKTooYy5yZW1vdmVDbGFzcyhcImNvbGxhcHNlXCIpLmFkZENsYXNzKFwiY29sbGFwc2luZ1wiKSxlKHtoZWlnaHQ6Y1swXS5zY3JvbGxIZWlnaHQrXCJweFwifSkudGhlbihnKSl9ZnVuY3Rpb24gZygpe2MucmVtb3ZlQ2xhc3MoXCJjb2xsYXBzaW5nXCIpLGMuYWRkQ2xhc3MoXCJjb2xsYXBzZSBpblwiKSxjLmNzcyh7aGVpZ2h0OlwiYXV0b1wifSl9ZnVuY3Rpb24gaCgpe2lmKGspaz0hMSxpKCksYy5jc3Moe2hlaWdodDowfSk7ZWxzZXtjLmNzcyh7aGVpZ2h0OmNbMF0uc2Nyb2xsSGVpZ2h0K1wicHhcIn0pO3tjWzBdLm9mZnNldFdpZHRofWMucmVtb3ZlQ2xhc3MoXCJjb2xsYXBzZSBpblwiKS5hZGRDbGFzcyhcImNvbGxhcHNpbmdcIiksZSh7aGVpZ2h0OjB9KS50aGVuKGkpfX1mdW5jdGlvbiBpKCl7Yy5yZW1vdmVDbGFzcyhcImNvbGxhcHNpbmdcIiksYy5hZGRDbGFzcyhcImNvbGxhcHNlXCIpfXZhciBqLGs9ITA7Yi4kd2F0Y2goZC5jb2xsYXBzZSxmdW5jdGlvbihhKXthP2goKTpmKCl9KX19fV0pLGFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwLmFjY29yZGlvblwiLFtcInVpLmJvb3RzdHJhcC5jb2xsYXBzZVwiXSkuY29uc3RhbnQoXCJhY2NvcmRpb25Db25maWdcIix7Y2xvc2VPdGhlcnM6ITB9KS5jb250cm9sbGVyKFwiQWNjb3JkaW9uQ29udHJvbGxlclwiLFtcIiRzY29wZVwiLFwiJGF0dHJzXCIsXCJhY2NvcmRpb25Db25maWdcIixmdW5jdGlvbihhLGIsYyl7dGhpcy5ncm91cHM9W10sdGhpcy5jbG9zZU90aGVycz1mdW5jdGlvbihkKXt2YXIgZT1hbmd1bGFyLmlzRGVmaW5lZChiLmNsb3NlT3RoZXJzKT9hLiRldmFsKGIuY2xvc2VPdGhlcnMpOmMuY2xvc2VPdGhlcnM7ZSYmYW5ndWxhci5mb3JFYWNoKHRoaXMuZ3JvdXBzLGZ1bmN0aW9uKGEpe2EhPT1kJiYoYS5pc09wZW49ITEpfSl9LHRoaXMuYWRkR3JvdXA9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpczt0aGlzLmdyb3Vwcy5wdXNoKGEpLGEuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2IucmVtb3ZlR3JvdXAoYSl9KX0sdGhpcy5yZW1vdmVHcm91cD1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmdyb3Vwcy5pbmRleE9mKGEpOy0xIT09YiYmdGhpcy5ncm91cHMuc3BsaWNlKGIsMSl9fV0pLmRpcmVjdGl2ZShcImFjY29yZGlvblwiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixjb250cm9sbGVyOlwiQWNjb3JkaW9uQ29udHJvbGxlclwiLHRyYW5zY2x1ZGU6ITAscmVwbGFjZTohMSx0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL2FjY29yZGlvbi9hY2NvcmRpb24uaHRtbFwifX0pLmRpcmVjdGl2ZShcImFjY29yZGlvbkdyb3VwXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVxdWlyZTpcIl5hY2NvcmRpb25cIixyZXN0cmljdDpcIkVBXCIsdHJhbnNjbHVkZTohMCxyZXBsYWNlOiEwLHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvYWNjb3JkaW9uL2FjY29yZGlvbi1ncm91cC5odG1sXCIsc2NvcGU6e2hlYWRpbmc6XCJAXCIsaXNPcGVuOlwiPT9cIixpc0Rpc2FibGVkOlwiPT9cIn0sY29udHJvbGxlcjpmdW5jdGlvbigpe3RoaXMuc2V0SGVhZGluZz1mdW5jdGlvbihhKXt0aGlzLmhlYWRpbmc9YX19LGxpbms6ZnVuY3Rpb24oYSxiLGMsZCl7ZC5hZGRHcm91cChhKSxhLiR3YXRjaChcImlzT3BlblwiLGZ1bmN0aW9uKGIpe2ImJmQuY2xvc2VPdGhlcnMoYSl9KSxhLnRvZ2dsZU9wZW49ZnVuY3Rpb24oKXthLmlzRGlzYWJsZWR8fChhLmlzT3Blbj0hYS5pc09wZW4pfX19fSkuZGlyZWN0aXZlKFwiYWNjb3JkaW9uSGVhZGluZ1wiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIix0cmFuc2NsdWRlOiEwLHRlbXBsYXRlOlwiXCIscmVwbGFjZTohMCxyZXF1aXJlOlwiXmFjY29yZGlvbkdyb3VwXCIsbGluazpmdW5jdGlvbihhLGIsYyxkLGUpe2Quc2V0SGVhZGluZyhlKGEsZnVuY3Rpb24oKXt9KSl9fX0pLmRpcmVjdGl2ZShcImFjY29yZGlvblRyYW5zY2x1ZGVcIixmdW5jdGlvbigpe3JldHVybntyZXF1aXJlOlwiXmFjY29yZGlvbkdyb3VwXCIsbGluazpmdW5jdGlvbihhLGIsYyxkKXthLiR3YXRjaChmdW5jdGlvbigpe3JldHVybiBkW2MuYWNjb3JkaW9uVHJhbnNjbHVkZV19LGZ1bmN0aW9uKGEpe2EmJihiLmh0bWwoXCJcIiksYi5hcHBlbmQoYSkpfSl9fX0pLGFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwLmFsZXJ0XCIsW10pLmNvbnRyb2xsZXIoXCJBbGVydENvbnRyb2xsZXJcIixbXCIkc2NvcGVcIixcIiRhdHRyc1wiLGZ1bmN0aW9uKGEsYil7YS5jbG9zZWFibGU9XCJjbG9zZVwiaW4gYn1dKS5kaXJlY3RpdmUoXCJhbGVydFwiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixjb250cm9sbGVyOlwiQWxlcnRDb250cm9sbGVyXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZS9hbGVydC9hbGVydC5odG1sXCIsdHJhbnNjbHVkZTohMCxyZXBsYWNlOiEwLHNjb3BlOnt0eXBlOlwiQFwiLGNsb3NlOlwiJlwifX19KSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC5iaW5kSHRtbFwiLFtdKS5kaXJlY3RpdmUoXCJiaW5kSHRtbFVuc2FmZVwiLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsYixjKXtiLmFkZENsYXNzKFwibmctYmluZGluZ1wiKS5kYXRhKFwiJGJpbmRpbmdcIixjLmJpbmRIdG1sVW5zYWZlKSxhLiR3YXRjaChjLmJpbmRIdG1sVW5zYWZlLGZ1bmN0aW9uKGEpe2IuaHRtbChhfHxcIlwiKX0pfX0pLGFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwLmJ1dHRvbnNcIixbXSkuY29uc3RhbnQoXCJidXR0b25Db25maWdcIix7YWN0aXZlQ2xhc3M6XCJhY3RpdmVcIix0b2dnbGVFdmVudDpcImNsaWNrXCJ9KS5jb250cm9sbGVyKFwiQnV0dG9uc0NvbnRyb2xsZXJcIixbXCJidXR0b25Db25maWdcIixmdW5jdGlvbihhKXt0aGlzLmFjdGl2ZUNsYXNzPWEuYWN0aXZlQ2xhc3N8fFwiYWN0aXZlXCIsdGhpcy50b2dnbGVFdmVudD1hLnRvZ2dsZUV2ZW50fHxcImNsaWNrXCJ9XSkuZGlyZWN0aXZlKFwiYnRuUmFkaW9cIixmdW5jdGlvbigpe3JldHVybntyZXF1aXJlOltcImJ0blJhZGlvXCIsXCJuZ01vZGVsXCJdLGNvbnRyb2xsZXI6XCJCdXR0b25zQ29udHJvbGxlclwiLGxpbms6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9ZFswXSxmPWRbMV07Zi4kcmVuZGVyPWZ1bmN0aW9uKCl7Yi50b2dnbGVDbGFzcyhlLmFjdGl2ZUNsYXNzLGFuZ3VsYXIuZXF1YWxzKGYuJG1vZGVsVmFsdWUsYS4kZXZhbChjLmJ0blJhZGlvKSkpfSxiLmJpbmQoZS50b2dnbGVFdmVudCxmdW5jdGlvbigpe3ZhciBkPWIuaGFzQ2xhc3MoZS5hY3RpdmVDbGFzcyk7KCFkfHxhbmd1bGFyLmlzRGVmaW5lZChjLnVuY2hlY2thYmxlKSkmJmEuJGFwcGx5KGZ1bmN0aW9uKCl7Zi4kc2V0Vmlld1ZhbHVlKGQ/bnVsbDphLiRldmFsKGMuYnRuUmFkaW8pKSxmLiRyZW5kZXIoKX0pfSl9fX0pLmRpcmVjdGl2ZShcImJ0bkNoZWNrYm94XCIsZnVuY3Rpb24oKXtyZXR1cm57cmVxdWlyZTpbXCJidG5DaGVja2JveFwiLFwibmdNb2RlbFwiXSxjb250cm9sbGVyOlwiQnV0dG9uc0NvbnRyb2xsZXJcIixsaW5rOmZ1bmN0aW9uKGEsYixjLGQpe2Z1bmN0aW9uIGUoKXtyZXR1cm4gZyhjLmJ0bkNoZWNrYm94VHJ1ZSwhMCl9ZnVuY3Rpb24gZigpe3JldHVybiBnKGMuYnRuQ2hlY2tib3hGYWxzZSwhMSl9ZnVuY3Rpb24gZyhiLGMpe3ZhciBkPWEuJGV2YWwoYik7cmV0dXJuIGFuZ3VsYXIuaXNEZWZpbmVkKGQpP2Q6Y312YXIgaD1kWzBdLGk9ZFsxXTtpLiRyZW5kZXI9ZnVuY3Rpb24oKXtiLnRvZ2dsZUNsYXNzKGguYWN0aXZlQ2xhc3MsYW5ndWxhci5lcXVhbHMoaS4kbW9kZWxWYWx1ZSxlKCkpKX0sYi5iaW5kKGgudG9nZ2xlRXZlbnQsZnVuY3Rpb24oKXthLiRhcHBseShmdW5jdGlvbigpe2kuJHNldFZpZXdWYWx1ZShiLmhhc0NsYXNzKGguYWN0aXZlQ2xhc3MpP2YoKTplKCkpLGkuJHJlbmRlcigpfSl9KX19fSksYW5ndWxhci5tb2R1bGUoXCJ1aS5ib290c3RyYXAuY2Fyb3VzZWxcIixbXCJ1aS5ib290c3RyYXAudHJhbnNpdGlvblwiXSkuY29udHJvbGxlcihcIkNhcm91c2VsQ29udHJvbGxlclwiLFtcIiRzY29wZVwiLFwiJHRpbWVvdXRcIixcIiR0cmFuc2l0aW9uXCIsZnVuY3Rpb24oYSxiLGMpe2Z1bmN0aW9uIGQoKXtlKCk7dmFyIGM9K2EuaW50ZXJ2YWw7IWlzTmFOKGMpJiZjPj0wJiYoZz1iKGYsYykpfWZ1bmN0aW9uIGUoKXtnJiYoYi5jYW5jZWwoZyksZz1udWxsKX1mdW5jdGlvbiBmKCl7aD8oYS5uZXh0KCksZCgpKTphLnBhdXNlKCl9dmFyIGcsaCxpPXRoaXMsaj1pLnNsaWRlcz1hLnNsaWRlcz1bXSxrPS0xO2kuY3VycmVudFNsaWRlPW51bGw7dmFyIGw9ITE7aS5zZWxlY3Q9YS5zZWxlY3Q9ZnVuY3Rpb24oZSxmKXtmdW5jdGlvbiBnKCl7aWYoIWwpe2lmKGkuY3VycmVudFNsaWRlJiZhbmd1bGFyLmlzU3RyaW5nKGYpJiYhYS5ub1RyYW5zaXRpb24mJmUuJGVsZW1lbnQpe2UuJGVsZW1lbnQuYWRkQ2xhc3MoZik7e2UuJGVsZW1lbnRbMF0ub2Zmc2V0V2lkdGh9YW5ndWxhci5mb3JFYWNoKGosZnVuY3Rpb24oYSl7YW5ndWxhci5leHRlbmQoYSx7ZGlyZWN0aW9uOlwiXCIsZW50ZXJpbmc6ITEsbGVhdmluZzohMSxhY3RpdmU6ITF9KX0pLGFuZ3VsYXIuZXh0ZW5kKGUse2RpcmVjdGlvbjpmLGFjdGl2ZTohMCxlbnRlcmluZzohMH0pLGFuZ3VsYXIuZXh0ZW5kKGkuY3VycmVudFNsaWRlfHx7fSx7ZGlyZWN0aW9uOmYsbGVhdmluZzohMH0pLGEuJGN1cnJlbnRUcmFuc2l0aW9uPWMoZS4kZWxlbWVudCx7fSksZnVuY3Rpb24oYixjKXthLiRjdXJyZW50VHJhbnNpdGlvbi50aGVuKGZ1bmN0aW9uKCl7aChiLGMpfSxmdW5jdGlvbigpe2goYixjKX0pfShlLGkuY3VycmVudFNsaWRlKX1lbHNlIGgoZSxpLmN1cnJlbnRTbGlkZSk7aS5jdXJyZW50U2xpZGU9ZSxrPW0sZCgpfX1mdW5jdGlvbiBoKGIsYyl7YW5ndWxhci5leHRlbmQoYix7ZGlyZWN0aW9uOlwiXCIsYWN0aXZlOiEwLGxlYXZpbmc6ITEsZW50ZXJpbmc6ITF9KSxhbmd1bGFyLmV4dGVuZChjfHx7fSx7ZGlyZWN0aW9uOlwiXCIsYWN0aXZlOiExLGxlYXZpbmc6ITEsZW50ZXJpbmc6ITF9KSxhLiRjdXJyZW50VHJhbnNpdGlvbj1udWxsfXZhciBtPWouaW5kZXhPZihlKTt2b2lkIDA9PT1mJiYoZj1tPms/XCJuZXh0XCI6XCJwcmV2XCIpLGUmJmUhPT1pLmN1cnJlbnRTbGlkZSYmKGEuJGN1cnJlbnRUcmFuc2l0aW9uPyhhLiRjdXJyZW50VHJhbnNpdGlvbi5jYW5jZWwoKSxiKGcpKTpnKCkpfSxhLiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtsPSEwfSksaS5pbmRleE9mU2xpZGU9ZnVuY3Rpb24oYSl7cmV0dXJuIGouaW5kZXhPZihhKX0sYS5uZXh0PWZ1bmN0aW9uKCl7dmFyIGI9KGsrMSklai5sZW5ndGg7cmV0dXJuIGEuJGN1cnJlbnRUcmFuc2l0aW9uP3ZvaWQgMDppLnNlbGVjdChqW2JdLFwibmV4dFwiKX0sYS5wcmV2PWZ1bmN0aW9uKCl7dmFyIGI9MD5rLTE/ai5sZW5ndGgtMTprLTE7cmV0dXJuIGEuJGN1cnJlbnRUcmFuc2l0aW9uP3ZvaWQgMDppLnNlbGVjdChqW2JdLFwicHJldlwiKX0sYS5pc0FjdGl2ZT1mdW5jdGlvbihhKXtyZXR1cm4gaS5jdXJyZW50U2xpZGU9PT1hfSxhLiR3YXRjaChcImludGVydmFsXCIsZCksYS4kb24oXCIkZGVzdHJveVwiLGUpLGEucGxheT1mdW5jdGlvbigpe2h8fChoPSEwLGQoKSl9LGEucGF1c2U9ZnVuY3Rpb24oKXthLm5vUGF1c2V8fChoPSExLGUoKSl9LGkuYWRkU2xpZGU9ZnVuY3Rpb24oYixjKXtiLiRlbGVtZW50PWMsai5wdXNoKGIpLDE9PT1qLmxlbmd0aHx8Yi5hY3RpdmU/KGkuc2VsZWN0KGpbai5sZW5ndGgtMV0pLDE9PWoubGVuZ3RoJiZhLnBsYXkoKSk6Yi5hY3RpdmU9ITF9LGkucmVtb3ZlU2xpZGU9ZnVuY3Rpb24oYSl7dmFyIGI9ai5pbmRleE9mKGEpO2ouc3BsaWNlKGIsMSksai5sZW5ndGg+MCYmYS5hY3RpdmU/aS5zZWxlY3QoYj49ai5sZW5ndGg/altiLTFdOmpbYl0pOms+YiYmay0tfX1dKS5kaXJlY3RpdmUoXCJjYXJvdXNlbFwiLFtmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVBXCIsdHJhbnNjbHVkZTohMCxyZXBsYWNlOiEwLGNvbnRyb2xsZXI6XCJDYXJvdXNlbENvbnRyb2xsZXJcIixyZXF1aXJlOlwiY2Fyb3VzZWxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL2Nhcm91c2VsL2Nhcm91c2VsLmh0bWxcIixzY29wZTp7aW50ZXJ2YWw6XCI9XCIsbm9UcmFuc2l0aW9uOlwiPVwiLG5vUGF1c2U6XCI9XCJ9fX1dKS5kaXJlY3RpdmUoXCJzbGlkZVwiLGZ1bmN0aW9uKCl7cmV0dXJue3JlcXVpcmU6XCJeY2Fyb3VzZWxcIixyZXN0cmljdDpcIkVBXCIsdHJhbnNjbHVkZTohMCxyZXBsYWNlOiEwLHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvY2Fyb3VzZWwvc2xpZGUuaHRtbFwiLHNjb3BlOnthY3RpdmU6XCI9P1wifSxsaW5rOmZ1bmN0aW9uKGEsYixjLGQpe2QuYWRkU2xpZGUoYSxiKSxhLiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtkLnJlbW92ZVNsaWRlKGEpfSksYS4kd2F0Y2goXCJhY3RpdmVcIixmdW5jdGlvbihiKXtiJiZkLnNlbGVjdChhKX0pfX19KSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC5kYXRlcGFyc2VyXCIsW10pLnNlcnZpY2UoXCJkYXRlUGFyc2VyXCIsW1wiJGxvY2FsZVwiLFwib3JkZXJCeUZpbHRlclwiLGZ1bmN0aW9uKGEsYil7ZnVuY3Rpb24gYyhhKXt2YXIgYz1bXSxkPWEuc3BsaXQoXCJcIik7cmV0dXJuIGFuZ3VsYXIuZm9yRWFjaChlLGZ1bmN0aW9uKGIsZSl7dmFyIGY9YS5pbmRleE9mKGUpO2lmKGY+LTEpe2E9YS5zcGxpdChcIlwiKSxkW2ZdPVwiKFwiK2IucmVnZXgrXCIpXCIsYVtmXT1cIiRcIjtmb3IodmFyIGc9ZisxLGg9ZitlLmxlbmd0aDtoPmc7ZysrKWRbZ109XCJcIixhW2ddPVwiJFwiO2E9YS5qb2luKFwiXCIpLGMucHVzaCh7aW5kZXg6ZixhcHBseTpiLmFwcGx5fSl9fSkse3JlZ2V4Om5ldyBSZWdFeHAoXCJeXCIrZC5qb2luKFwiXCIpK1wiJFwiKSxtYXA6YihjLFwiaW5kZXhcIil9fWZ1bmN0aW9uIGQoYSxiLGMpe3JldHVybiAxPT09YiYmYz4yOD8yOT09PWMmJihhJTQ9PT0wJiZhJTEwMCE9PTB8fGElNDAwPT09MCk6Mz09PWJ8fDU9PT1ifHw4PT09Ynx8MTA9PT1iPzMxPmM6ITB9dGhpcy5wYXJzZXJzPXt9O3ZhciBlPXt5eXl5OntyZWdleDpcIlxcXFxkezR9XCIsYXBwbHk6ZnVuY3Rpb24oYSl7dGhpcy55ZWFyPSthfX0seXk6e3JlZ2V4OlwiXFxcXGR7Mn1cIixhcHBseTpmdW5jdGlvbihhKXt0aGlzLnllYXI9K2ErMmUzfX0seTp7cmVnZXg6XCJcXFxcZHsxLDR9XCIsYXBwbHk6ZnVuY3Rpb24oYSl7dGhpcy55ZWFyPSthfX0sTU1NTTp7cmVnZXg6YS5EQVRFVElNRV9GT1JNQVRTLk1PTlRILmpvaW4oXCJ8XCIpLGFwcGx5OmZ1bmN0aW9uKGIpe3RoaXMubW9udGg9YS5EQVRFVElNRV9GT1JNQVRTLk1PTlRILmluZGV4T2YoYil9fSxNTU06e3JlZ2V4OmEuREFURVRJTUVfRk9STUFUUy5TSE9SVE1PTlRILmpvaW4oXCJ8XCIpLGFwcGx5OmZ1bmN0aW9uKGIpe3RoaXMubW9udGg9YS5EQVRFVElNRV9GT1JNQVRTLlNIT1JUTU9OVEguaW5kZXhPZihiKX19LE1NOntyZWdleDpcIjBbMS05XXwxWzAtMl1cIixhcHBseTpmdW5jdGlvbihhKXt0aGlzLm1vbnRoPWEtMX19LE06e3JlZ2V4OlwiWzEtOV18MVswLTJdXCIsYXBwbHk6ZnVuY3Rpb24oYSl7dGhpcy5tb250aD1hLTF9fSxkZDp7cmVnZXg6XCJbMC0yXVswLTldezF9fDNbMC0xXXsxfVwiLGFwcGx5OmZ1bmN0aW9uKGEpe3RoaXMuZGF0ZT0rYX19LGQ6e3JlZ2V4OlwiWzEtMl0/WzAtOV17MX18M1swLTFdezF9XCIsYXBwbHk6ZnVuY3Rpb24oYSl7dGhpcy5kYXRlPSthfX0sRUVFRTp7cmVnZXg6YS5EQVRFVElNRV9GT1JNQVRTLkRBWS5qb2luKFwifFwiKX0sRUVFOntyZWdleDphLkRBVEVUSU1FX0ZPUk1BVFMuU0hPUlREQVkuam9pbihcInxcIil9fTt0aGlzLnBhcnNlPWZ1bmN0aW9uKGIsZSl7aWYoIWFuZ3VsYXIuaXNTdHJpbmcoYil8fCFlKXJldHVybiBiO2U9YS5EQVRFVElNRV9GT1JNQVRTW2VdfHxlLHRoaXMucGFyc2Vyc1tlXXx8KHRoaXMucGFyc2Vyc1tlXT1jKGUpKTt2YXIgZj10aGlzLnBhcnNlcnNbZV0sZz1mLnJlZ2V4LGg9Zi5tYXAsaT1iLm1hdGNoKGcpO2lmKGkmJmkubGVuZ3RoKXtmb3IodmFyIGosaz17eWVhcjoxOTAwLG1vbnRoOjAsZGF0ZToxLGhvdXJzOjB9LGw9MSxtPWkubGVuZ3RoO20+bDtsKyspe3ZhciBuPWhbbC0xXTtuLmFwcGx5JiZuLmFwcGx5LmNhbGwoayxpW2xdKX1yZXR1cm4gZChrLnllYXIsay5tb250aCxrLmRhdGUpJiYoaj1uZXcgRGF0ZShrLnllYXIsay5tb250aCxrLmRhdGUsay5ob3VycykpLGp9fX1dKSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC5wb3NpdGlvblwiLFtdKS5mYWN0b3J5KFwiJHBvc2l0aW9uXCIsW1wiJGRvY3VtZW50XCIsXCIkd2luZG93XCIsZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBjKGEsYyl7cmV0dXJuIGEuY3VycmVudFN0eWxlP2EuY3VycmVudFN0eWxlW2NdOmIuZ2V0Q29tcHV0ZWRTdHlsZT9iLmdldENvbXB1dGVkU3R5bGUoYSlbY106YS5zdHlsZVtjXX1mdW5jdGlvbiBkKGEpe3JldHVyblwic3RhdGljXCI9PT0oYyhhLFwicG9zaXRpb25cIil8fFwic3RhdGljXCIpfXZhciBlPWZ1bmN0aW9uKGIpe2Zvcih2YXIgYz1hWzBdLGU9Yi5vZmZzZXRQYXJlbnR8fGM7ZSYmZSE9PWMmJmQoZSk7KWU9ZS5vZmZzZXRQYXJlbnQ7cmV0dXJuIGV8fGN9O3JldHVybntwb3NpdGlvbjpmdW5jdGlvbihiKXt2YXIgYz10aGlzLm9mZnNldChiKSxkPXt0b3A6MCxsZWZ0OjB9LGY9ZShiWzBdKTtmIT1hWzBdJiYoZD10aGlzLm9mZnNldChhbmd1bGFyLmVsZW1lbnQoZikpLGQudG9wKz1mLmNsaWVudFRvcC1mLnNjcm9sbFRvcCxkLmxlZnQrPWYuY2xpZW50TGVmdC1mLnNjcm9sbExlZnQpO3ZhciBnPWJbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7cmV0dXJue3dpZHRoOmcud2lkdGh8fGIucHJvcChcIm9mZnNldFdpZHRoXCIpLGhlaWdodDpnLmhlaWdodHx8Yi5wcm9wKFwib2Zmc2V0SGVpZ2h0XCIpLHRvcDpjLnRvcC1kLnRvcCxsZWZ0OmMubGVmdC1kLmxlZnR9fSxvZmZzZXQ6ZnVuY3Rpb24oYyl7dmFyIGQ9Y1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtyZXR1cm57d2lkdGg6ZC53aWR0aHx8Yy5wcm9wKFwib2Zmc2V0V2lkdGhcIiksaGVpZ2h0OmQuaGVpZ2h0fHxjLnByb3AoXCJvZmZzZXRIZWlnaHRcIiksdG9wOmQudG9wKyhiLnBhZ2VZT2Zmc2V0fHxhWzBdLmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3ApLGxlZnQ6ZC5sZWZ0KyhiLnBhZ2VYT2Zmc2V0fHxhWzBdLmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0KX19LHBvc2l0aW9uRWxlbWVudHM6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGUsZixnLGgsaT1jLnNwbGl0KFwiLVwiKSxqPWlbMF0saz1pWzFdfHxcImNlbnRlclwiO2U9ZD90aGlzLm9mZnNldChhKTp0aGlzLnBvc2l0aW9uKGEpLGY9Yi5wcm9wKFwib2Zmc2V0V2lkdGhcIiksZz1iLnByb3AoXCJvZmZzZXRIZWlnaHRcIik7dmFyIGw9e2NlbnRlcjpmdW5jdGlvbigpe3JldHVybiBlLmxlZnQrZS53aWR0aC8yLWYvMn0sbGVmdDpmdW5jdGlvbigpe3JldHVybiBlLmxlZnR9LHJpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIGUubGVmdCtlLndpZHRofX0sbT17Y2VudGVyOmZ1bmN0aW9uKCl7cmV0dXJuIGUudG9wK2UuaGVpZ2h0LzItZy8yfSx0b3A6ZnVuY3Rpb24oKXtyZXR1cm4gZS50b3B9LGJvdHRvbTpmdW5jdGlvbigpe3JldHVybiBlLnRvcCtlLmhlaWdodH19O3N3aXRjaChqKXtjYXNlXCJyaWdodFwiOmg9e3RvcDptW2tdKCksbGVmdDpsW2pdKCl9O2JyZWFrO2Nhc2VcImxlZnRcIjpoPXt0b3A6bVtrXSgpLGxlZnQ6ZS5sZWZ0LWZ9O2JyZWFrO2Nhc2VcImJvdHRvbVwiOmg9e3RvcDptW2pdKCksbGVmdDpsW2tdKCl9O2JyZWFrO2RlZmF1bHQ6aD17dG9wOmUudG9wLWcsbGVmdDpsW2tdKCl9fXJldHVybiBofX19XSksYW5ndWxhci5tb2R1bGUoXCJ1aS5ib290c3RyYXAuZGF0ZXBpY2tlclwiLFtcInVpLmJvb3RzdHJhcC5kYXRlcGFyc2VyXCIsXCJ1aS5ib290c3RyYXAucG9zaXRpb25cIl0pLmNvbnN0YW50KFwiZGF0ZXBpY2tlckNvbmZpZ1wiLHtmb3JtYXREYXk6XCJkZFwiLGZvcm1hdE1vbnRoOlwiTU1NTVwiLGZvcm1hdFllYXI6XCJ5eXl5XCIsZm9ybWF0RGF5SGVhZGVyOlwiRUVFXCIsZm9ybWF0RGF5VGl0bGU6XCJNTU1NIHl5eXlcIixmb3JtYXRNb250aFRpdGxlOlwieXl5eVwiLGRhdGVwaWNrZXJNb2RlOlwiZGF5XCIsbWluTW9kZTpcImRheVwiLG1heE1vZGU6XCJ5ZWFyXCIsc2hvd1dlZWtzOiEwLHN0YXJ0aW5nRGF5OjAseWVhclJhbmdlOjIwLG1pbkRhdGU6bnVsbCxtYXhEYXRlOm51bGx9KS5jb250cm9sbGVyKFwiRGF0ZXBpY2tlckNvbnRyb2xsZXJcIixbXCIkc2NvcGVcIixcIiRhdHRyc1wiLFwiJHBhcnNlXCIsXCIkaW50ZXJwb2xhdGVcIixcIiR0aW1lb3V0XCIsXCIkbG9nXCIsXCJkYXRlRmlsdGVyXCIsXCJkYXRlcGlja2VyQ29uZmlnXCIsZnVuY3Rpb24oYSxiLGMsZCxlLGYsZyxoKXt2YXIgaT10aGlzLGo9eyRzZXRWaWV3VmFsdWU6YW5ndWxhci5ub29wfTt0aGlzLm1vZGVzPVtcImRheVwiLFwibW9udGhcIixcInllYXJcIl0sYW5ndWxhci5mb3JFYWNoKFtcImZvcm1hdERheVwiLFwiZm9ybWF0TW9udGhcIixcImZvcm1hdFllYXJcIixcImZvcm1hdERheUhlYWRlclwiLFwiZm9ybWF0RGF5VGl0bGVcIixcImZvcm1hdE1vbnRoVGl0bGVcIixcIm1pbk1vZGVcIixcIm1heE1vZGVcIixcInNob3dXZWVrc1wiLFwic3RhcnRpbmdEYXlcIixcInllYXJSYW5nZVwiXSxmdW5jdGlvbihjLGUpe2lbY109YW5ndWxhci5pc0RlZmluZWQoYltjXSk/OD5lP2QoYltjXSkoYS4kcGFyZW50KTphLiRwYXJlbnQuJGV2YWwoYltjXSk6aFtjXX0pLGFuZ3VsYXIuZm9yRWFjaChbXCJtaW5EYXRlXCIsXCJtYXhEYXRlXCJdLGZ1bmN0aW9uKGQpe2JbZF0/YS4kcGFyZW50LiR3YXRjaChjKGJbZF0pLGZ1bmN0aW9uKGEpe2lbZF09YT9uZXcgRGF0ZShhKTpudWxsLGkucmVmcmVzaFZpZXcoKX0pOmlbZF09aFtkXT9uZXcgRGF0ZShoW2RdKTpudWxsfSksYS5kYXRlcGlja2VyTW9kZT1hLmRhdGVwaWNrZXJNb2RlfHxoLmRhdGVwaWNrZXJNb2RlLGEudW5pcXVlSWQ9XCJkYXRlcGlja2VyLVwiK2EuJGlkK1wiLVwiK01hdGguZmxvb3IoMWU0Kk1hdGgucmFuZG9tKCkpLHRoaXMuYWN0aXZlRGF0ZT1hbmd1bGFyLmlzRGVmaW5lZChiLmluaXREYXRlKT9hLiRwYXJlbnQuJGV2YWwoYi5pbml0RGF0ZSk6bmV3IERhdGUsYS5pc0FjdGl2ZT1mdW5jdGlvbihiKXtyZXR1cm4gMD09PWkuY29tcGFyZShiLmRhdGUsaS5hY3RpdmVEYXRlKT8oYS5hY3RpdmVEYXRlSWQ9Yi51aWQsITApOiExfSx0aGlzLmluaXQ9ZnVuY3Rpb24oYSl7aj1hLGouJHJlbmRlcj1mdW5jdGlvbigpe2kucmVuZGVyKCl9fSx0aGlzLnJlbmRlcj1mdW5jdGlvbigpe2lmKGouJG1vZGVsVmFsdWUpe3ZhciBhPW5ldyBEYXRlKGouJG1vZGVsVmFsdWUpLGI9IWlzTmFOKGEpO2I/dGhpcy5hY3RpdmVEYXRlPWE6Zi5lcnJvcignRGF0ZXBpY2tlciBkaXJlY3RpdmU6IFwibmctbW9kZWxcIiB2YWx1ZSBtdXN0IGJlIGEgRGF0ZSBvYmplY3QsIGEgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBzaW5jZSAwMS4wMS4xOTcwIG9yIGEgc3RyaW5nIHJlcHJlc2VudGluZyBhbiBSRkMyODIyIG9yIElTTyA4NjAxIGRhdGUuJyksai4kc2V0VmFsaWRpdHkoXCJkYXRlXCIsYil9dGhpcy5yZWZyZXNoVmlldygpfSx0aGlzLnJlZnJlc2hWaWV3PWZ1bmN0aW9uKCl7aWYodGhpcy5lbGVtZW50KXt0aGlzLl9yZWZyZXNoVmlldygpO3ZhciBhPWouJG1vZGVsVmFsdWU/bmV3IERhdGUoai4kbW9kZWxWYWx1ZSk6bnVsbDtqLiRzZXRWYWxpZGl0eShcImRhdGUtZGlzYWJsZWRcIiwhYXx8dGhpcy5lbGVtZW50JiYhdGhpcy5pc0Rpc2FibGVkKGEpKX19LHRoaXMuY3JlYXRlRGF0ZU9iamVjdD1mdW5jdGlvbihhLGIpe3ZhciBjPWouJG1vZGVsVmFsdWU/bmV3IERhdGUoai4kbW9kZWxWYWx1ZSk6bnVsbDtyZXR1cm57ZGF0ZTphLGxhYmVsOmcoYSxiKSxzZWxlY3RlZDpjJiYwPT09dGhpcy5jb21wYXJlKGEsYyksZGlzYWJsZWQ6dGhpcy5pc0Rpc2FibGVkKGEpLGN1cnJlbnQ6MD09PXRoaXMuY29tcGFyZShhLG5ldyBEYXRlKX19LHRoaXMuaXNEaXNhYmxlZD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5taW5EYXRlJiZ0aGlzLmNvbXBhcmUoYyx0aGlzLm1pbkRhdGUpPDB8fHRoaXMubWF4RGF0ZSYmdGhpcy5jb21wYXJlKGMsdGhpcy5tYXhEYXRlKT4wfHxiLmRhdGVEaXNhYmxlZCYmYS5kYXRlRGlzYWJsZWQoe2RhdGU6Yyxtb2RlOmEuZGF0ZXBpY2tlck1vZGV9KX0sdGhpcy5zcGxpdD1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz1bXTthLmxlbmd0aD4wOyljLnB1c2goYS5zcGxpY2UoMCxiKSk7cmV0dXJuIGN9LGEuc2VsZWN0PWZ1bmN0aW9uKGIpe2lmKGEuZGF0ZXBpY2tlck1vZGU9PT1pLm1pbk1vZGUpe3ZhciBjPWouJG1vZGVsVmFsdWU/bmV3IERhdGUoai4kbW9kZWxWYWx1ZSk6bmV3IERhdGUoMCwwLDAsMCwwLDAsMCk7Yy5zZXRGdWxsWWVhcihiLmdldEZ1bGxZZWFyKCksYi5nZXRNb250aCgpLGIuZ2V0RGF0ZSgpKSxqLiRzZXRWaWV3VmFsdWUoYyksai4kcmVuZGVyKCl9ZWxzZSBpLmFjdGl2ZURhdGU9YixhLmRhdGVwaWNrZXJNb2RlPWkubW9kZXNbaS5tb2Rlcy5pbmRleE9mKGEuZGF0ZXBpY2tlck1vZGUpLTFdfSxhLm1vdmU9ZnVuY3Rpb24oYSl7dmFyIGI9aS5hY3RpdmVEYXRlLmdldEZ1bGxZZWFyKCkrYSooaS5zdGVwLnllYXJzfHwwKSxjPWkuYWN0aXZlRGF0ZS5nZXRNb250aCgpK2EqKGkuc3RlcC5tb250aHN8fDApO2kuYWN0aXZlRGF0ZS5zZXRGdWxsWWVhcihiLGMsMSksaS5yZWZyZXNoVmlldygpfSxhLnRvZ2dsZU1vZGU9ZnVuY3Rpb24oYil7Yj1ifHwxLGEuZGF0ZXBpY2tlck1vZGU9PT1pLm1heE1vZGUmJjE9PT1ifHxhLmRhdGVwaWNrZXJNb2RlPT09aS5taW5Nb2RlJiYtMT09PWJ8fChhLmRhdGVwaWNrZXJNb2RlPWkubW9kZXNbaS5tb2Rlcy5pbmRleE9mKGEuZGF0ZXBpY2tlck1vZGUpK2JdKX0sYS5rZXlzPXsxMzpcImVudGVyXCIsMzI6XCJzcGFjZVwiLDMzOlwicGFnZXVwXCIsMzQ6XCJwYWdlZG93blwiLDM1OlwiZW5kXCIsMzY6XCJob21lXCIsMzc6XCJsZWZ0XCIsMzg6XCJ1cFwiLDM5OlwicmlnaHRcIiw0MDpcImRvd25cIn07dmFyIGs9ZnVuY3Rpb24oKXtlKGZ1bmN0aW9uKCl7aS5lbGVtZW50WzBdLmZvY3VzKCl9LDAsITEpfTthLiRvbihcImRhdGVwaWNrZXIuZm9jdXNcIixrKSxhLmtleWRvd249ZnVuY3Rpb24oYil7dmFyIGM9YS5rZXlzW2Iud2hpY2hdO2lmKGMmJiFiLnNoaWZ0S2V5JiYhYi5hbHRLZXkpaWYoYi5wcmV2ZW50RGVmYXVsdCgpLGIuc3RvcFByb3BhZ2F0aW9uKCksXCJlbnRlclwiPT09Y3x8XCJzcGFjZVwiPT09Yyl7aWYoaS5pc0Rpc2FibGVkKGkuYWN0aXZlRGF0ZSkpcmV0dXJuO2Euc2VsZWN0KGkuYWN0aXZlRGF0ZSksaygpfWVsc2UhYi5jdHJsS2V5fHxcInVwXCIhPT1jJiZcImRvd25cIiE9PWM/KGkuaGFuZGxlS2V5RG93bihjLGIpLGkucmVmcmVzaFZpZXcoKSk6KGEudG9nZ2xlTW9kZShcInVwXCI9PT1jPzE6LTEpLGsoKSl9fV0pLmRpcmVjdGl2ZShcImRhdGVwaWNrZXJcIixmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVBXCIscmVwbGFjZTohMCx0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL2RhdGVwaWNrZXIvZGF0ZXBpY2tlci5odG1sXCIsc2NvcGU6e2RhdGVwaWNrZXJNb2RlOlwiPT9cIixkYXRlRGlzYWJsZWQ6XCImXCJ9LHJlcXVpcmU6W1wiZGF0ZXBpY2tlclwiLFwiP15uZ01vZGVsXCJdLGNvbnRyb2xsZXI6XCJEYXRlcGlja2VyQ29udHJvbGxlclwiLGxpbms6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9ZFswXSxmPWRbMV07ZiYmZS5pbml0KGYpfX19KS5kaXJlY3RpdmUoXCJkYXlwaWNrZXJcIixbXCJkYXRlRmlsdGVyXCIsZnVuY3Rpb24oYSl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixyZXBsYWNlOiEwLHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvZGF0ZXBpY2tlci9kYXkuaHRtbFwiLHJlcXVpcmU6XCJeZGF0ZXBpY2tlclwiLGxpbms6ZnVuY3Rpb24oYixjLGQsZSl7ZnVuY3Rpb24gZihhLGIpe3JldHVybiAxIT09Ynx8YSU0IT09MHx8YSUxMDA9PT0wJiZhJTQwMCE9PTA/aVtiXToyOX1mdW5jdGlvbiBnKGEsYil7dmFyIGM9bmV3IEFycmF5KGIpLGQ9bmV3IERhdGUoYSksZT0wO2ZvcihkLnNldEhvdXJzKDEyKTtiPmU7KWNbZSsrXT1uZXcgRGF0ZShkKSxkLnNldERhdGUoZC5nZXREYXRlKCkrMSk7cmV0dXJuIGN9ZnVuY3Rpb24gaChhKXt2YXIgYj1uZXcgRGF0ZShhKTtiLnNldERhdGUoYi5nZXREYXRlKCkrNC0oYi5nZXREYXkoKXx8NykpO3ZhciBjPWIuZ2V0VGltZSgpO3JldHVybiBiLnNldE1vbnRoKDApLGIuc2V0RGF0ZSgxKSxNYXRoLmZsb29yKE1hdGgucm91bmQoKGMtYikvODY0ZTUpLzcpKzF9Yi5zaG93V2Vla3M9ZS5zaG93V2Vla3MsZS5zdGVwPXttb250aHM6MX0sZS5lbGVtZW50PWM7dmFyIGk9WzMxLDI4LDMxLDMwLDMxLDMwLDMxLDMxLDMwLDMxLDMwLDMxXTtlLl9yZWZyZXNoVmlldz1mdW5jdGlvbigpe3ZhciBjPWUuYWN0aXZlRGF0ZS5nZXRGdWxsWWVhcigpLGQ9ZS5hY3RpdmVEYXRlLmdldE1vbnRoKCksZj1uZXcgRGF0ZShjLGQsMSksaT1lLnN0YXJ0aW5nRGF5LWYuZ2V0RGF5KCksaj1pPjA/Ny1pOi1pLGs9bmV3IERhdGUoZik7aj4wJiZrLnNldERhdGUoLWorMSk7Zm9yKHZhciBsPWcoayw0MiksbT0wOzQyPm07bSsrKWxbbV09YW5ndWxhci5leHRlbmQoZS5jcmVhdGVEYXRlT2JqZWN0KGxbbV0sZS5mb3JtYXREYXkpLHtzZWNvbmRhcnk6bFttXS5nZXRNb250aCgpIT09ZCx1aWQ6Yi51bmlxdWVJZCtcIi1cIittfSk7Yi5sYWJlbHM9bmV3IEFycmF5KDcpO2Zvcih2YXIgbj0wOzc+bjtuKyspYi5sYWJlbHNbbl09e2FiYnI6YShsW25dLmRhdGUsZS5mb3JtYXREYXlIZWFkZXIpLGZ1bGw6YShsW25dLmRhdGUsXCJFRUVFXCIpfTtpZihiLnRpdGxlPWEoZS5hY3RpdmVEYXRlLGUuZm9ybWF0RGF5VGl0bGUpLGIucm93cz1lLnNwbGl0KGwsNyksYi5zaG93V2Vla3Mpe2Iud2Vla051bWJlcnM9W107Zm9yKHZhciBvPWgoYi5yb3dzWzBdWzBdLmRhdGUpLHA9Yi5yb3dzLmxlbmd0aDtiLndlZWtOdW1iZXJzLnB1c2gobysrKTxwOyk7fX0sZS5jb21wYXJlPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBEYXRlKGEuZ2V0RnVsbFllYXIoKSxhLmdldE1vbnRoKCksYS5nZXREYXRlKCkpLW5ldyBEYXRlKGIuZ2V0RnVsbFllYXIoKSxiLmdldE1vbnRoKCksYi5nZXREYXRlKCkpfSxlLmhhbmRsZUtleURvd249ZnVuY3Rpb24oYSl7dmFyIGI9ZS5hY3RpdmVEYXRlLmdldERhdGUoKTtpZihcImxlZnRcIj09PWEpYi09MTtlbHNlIGlmKFwidXBcIj09PWEpYi09NztlbHNlIGlmKFwicmlnaHRcIj09PWEpYis9MTtlbHNlIGlmKFwiZG93blwiPT09YSliKz03O2Vsc2UgaWYoXCJwYWdldXBcIj09PWF8fFwicGFnZWRvd25cIj09PWEpe3ZhciBjPWUuYWN0aXZlRGF0ZS5nZXRNb250aCgpKyhcInBhZ2V1cFwiPT09YT8tMToxKTtlLmFjdGl2ZURhdGUuc2V0TW9udGgoYywxKSxiPU1hdGgubWluKGYoZS5hY3RpdmVEYXRlLmdldEZ1bGxZZWFyKCksZS5hY3RpdmVEYXRlLmdldE1vbnRoKCkpLGIpfWVsc2VcImhvbWVcIj09PWE/Yj0xOlwiZW5kXCI9PT1hJiYoYj1mKGUuYWN0aXZlRGF0ZS5nZXRGdWxsWWVhcigpLGUuYWN0aXZlRGF0ZS5nZXRNb250aCgpKSk7ZS5hY3RpdmVEYXRlLnNldERhdGUoYil9LGUucmVmcmVzaFZpZXcoKX19fV0pLmRpcmVjdGl2ZShcIm1vbnRocGlja2VyXCIsW1wiZGF0ZUZpbHRlclwiLGZ1bmN0aW9uKGEpe3JldHVybntyZXN0cmljdDpcIkVBXCIscmVwbGFjZTohMCx0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL2RhdGVwaWNrZXIvbW9udGguaHRtbFwiLHJlcXVpcmU6XCJeZGF0ZXBpY2tlclwiLGxpbms6ZnVuY3Rpb24oYixjLGQsZSl7ZS5zdGVwPXt5ZWFyczoxfSxlLmVsZW1lbnQ9YyxlLl9yZWZyZXNoVmlldz1mdW5jdGlvbigpe2Zvcih2YXIgYz1uZXcgQXJyYXkoMTIpLGQ9ZS5hY3RpdmVEYXRlLmdldEZ1bGxZZWFyKCksZj0wOzEyPmY7ZisrKWNbZl09YW5ndWxhci5leHRlbmQoZS5jcmVhdGVEYXRlT2JqZWN0KG5ldyBEYXRlKGQsZiwxKSxlLmZvcm1hdE1vbnRoKSx7dWlkOmIudW5pcXVlSWQrXCItXCIrZn0pO2IudGl0bGU9YShlLmFjdGl2ZURhdGUsZS5mb3JtYXRNb250aFRpdGxlKSxiLnJvd3M9ZS5zcGxpdChjLDMpfSxlLmNvbXBhcmU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IERhdGUoYS5nZXRGdWxsWWVhcigpLGEuZ2V0TW9udGgoKSktbmV3IERhdGUoYi5nZXRGdWxsWWVhcigpLGIuZ2V0TW9udGgoKSl9LGUuaGFuZGxlS2V5RG93bj1mdW5jdGlvbihhKXt2YXIgYj1lLmFjdGl2ZURhdGUuZ2V0TW9udGgoKTtpZihcImxlZnRcIj09PWEpYi09MTtlbHNlIGlmKFwidXBcIj09PWEpYi09MztlbHNlIGlmKFwicmlnaHRcIj09PWEpYis9MTtlbHNlIGlmKFwiZG93blwiPT09YSliKz0zO2Vsc2UgaWYoXCJwYWdldXBcIj09PWF8fFwicGFnZWRvd25cIj09PWEpe3ZhciBjPWUuYWN0aXZlRGF0ZS5nZXRGdWxsWWVhcigpKyhcInBhZ2V1cFwiPT09YT8tMToxKTtlLmFjdGl2ZURhdGUuc2V0RnVsbFllYXIoYyl9ZWxzZVwiaG9tZVwiPT09YT9iPTA6XCJlbmRcIj09PWEmJihiPTExKTtlLmFjdGl2ZURhdGUuc2V0TW9udGgoYil9LGUucmVmcmVzaFZpZXcoKX19fV0pLmRpcmVjdGl2ZShcInllYXJwaWNrZXJcIixbXCJkYXRlRmlsdGVyXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHJlcGxhY2U6ITAsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL3llYXIuaHRtbFwiLHJlcXVpcmU6XCJeZGF0ZXBpY2tlclwiLGxpbms6ZnVuY3Rpb24oYSxiLGMsZCl7ZnVuY3Rpb24gZShhKXtyZXR1cm4gcGFyc2VJbnQoKGEtMSkvZiwxMCkqZisxfXZhciBmPWQueWVhclJhbmdlO2Quc3RlcD17eWVhcnM6Zn0sZC5lbGVtZW50PWIsZC5fcmVmcmVzaFZpZXc9ZnVuY3Rpb24oKXtmb3IodmFyIGI9bmV3IEFycmF5KGYpLGM9MCxnPWUoZC5hY3RpdmVEYXRlLmdldEZ1bGxZZWFyKCkpO2Y+YztjKyspYltjXT1hbmd1bGFyLmV4dGVuZChkLmNyZWF0ZURhdGVPYmplY3QobmV3IERhdGUoZytjLDAsMSksZC5mb3JtYXRZZWFyKSx7dWlkOmEudW5pcXVlSWQrXCItXCIrY30pO2EudGl0bGU9W2JbMF0ubGFiZWwsYltmLTFdLmxhYmVsXS5qb2luKFwiIC0gXCIpLGEucm93cz1kLnNwbGl0KGIsNSl9LGQuY29tcGFyZT1mdW5jdGlvbihhLGIpe3JldHVybiBhLmdldEZ1bGxZZWFyKCktYi5nZXRGdWxsWWVhcigpfSxkLmhhbmRsZUtleURvd249ZnVuY3Rpb24oYSl7dmFyIGI9ZC5hY3RpdmVEYXRlLmdldEZ1bGxZZWFyKCk7XCJsZWZ0XCI9PT1hP2ItPTE6XCJ1cFwiPT09YT9iLT01OlwicmlnaHRcIj09PWE/Yis9MTpcImRvd25cIj09PWE/Yis9NTpcInBhZ2V1cFwiPT09YXx8XCJwYWdlZG93blwiPT09YT9iKz0oXCJwYWdldXBcIj09PWE/LTE6MSkqZC5zdGVwLnllYXJzOlwiaG9tZVwiPT09YT9iPWUoZC5hY3RpdmVEYXRlLmdldEZ1bGxZZWFyKCkpOlwiZW5kXCI9PT1hJiYoYj1lKGQuYWN0aXZlRGF0ZS5nZXRGdWxsWWVhcigpKStmLTEpLGQuYWN0aXZlRGF0ZS5zZXRGdWxsWWVhcihiKX0sZC5yZWZyZXNoVmlldygpfX19XSkuY29uc3RhbnQoXCJkYXRlcGlja2VyUG9wdXBDb25maWdcIix7ZGF0ZXBpY2tlclBvcHVwOlwieXl5eS1NTS1kZFwiLGN1cnJlbnRUZXh0OlwiVG9kYXlcIixjbGVhclRleHQ6XCJDbGVhclwiLGNsb3NlVGV4dDpcIkRvbmVcIixjbG9zZU9uRGF0ZVNlbGVjdGlvbjohMCxhcHBlbmRUb0JvZHk6ITEsc2hvd0J1dHRvbkJhcjohMH0pLmRpcmVjdGl2ZShcImRhdGVwaWNrZXJQb3B1cFwiLFtcIiRjb21waWxlXCIsXCIkcGFyc2VcIixcIiRkb2N1bWVudFwiLFwiJHBvc2l0aW9uXCIsXCJkYXRlRmlsdGVyXCIsXCJkYXRlUGFyc2VyXCIsXCJkYXRlcGlja2VyUG9wdXBDb25maWdcIixmdW5jdGlvbihhLGIsYyxkLGUsZixnKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHJlcXVpcmU6XCJuZ01vZGVsXCIsc2NvcGU6e2lzT3BlbjpcIj0/XCIsY3VycmVudFRleHQ6XCJAXCIsY2xlYXJUZXh0OlwiQFwiLGNsb3NlVGV4dDpcIkBcIixkYXRlRGlzYWJsZWQ6XCImXCJ9LGxpbms6ZnVuY3Rpb24oaCxpLGosayl7ZnVuY3Rpb24gbChhKXtyZXR1cm4gYS5yZXBsYWNlKC8oW0EtWl0pL2csZnVuY3Rpb24oYSl7cmV0dXJuXCItXCIrYS50b0xvd2VyQ2FzZSgpfSl9ZnVuY3Rpb24gbShhKXtpZihhKXtpZihhbmd1bGFyLmlzRGF0ZShhKSYmIWlzTmFOKGEpKXJldHVybiBrLiRzZXRWYWxpZGl0eShcImRhdGVcIiwhMCksYTtpZihhbmd1bGFyLmlzU3RyaW5nKGEpKXt2YXIgYj1mLnBhcnNlKGEsbil8fG5ldyBEYXRlKGEpO3JldHVybiBpc05hTihiKT92b2lkIGsuJHNldFZhbGlkaXR5KFwiZGF0ZVwiLCExKTooay4kc2V0VmFsaWRpdHkoXCJkYXRlXCIsITApLGIpfXJldHVybiB2b2lkIGsuJHNldFZhbGlkaXR5KFwiZGF0ZVwiLCExKX1yZXR1cm4gay4kc2V0VmFsaWRpdHkoXCJkYXRlXCIsITApLG51bGx9dmFyIG4sbz1hbmd1bGFyLmlzRGVmaW5lZChqLmNsb3NlT25EYXRlU2VsZWN0aW9uKT9oLiRwYXJlbnQuJGV2YWwoai5jbG9zZU9uRGF0ZVNlbGVjdGlvbik6Zy5jbG9zZU9uRGF0ZVNlbGVjdGlvbixwPWFuZ3VsYXIuaXNEZWZpbmVkKGouZGF0ZXBpY2tlckFwcGVuZFRvQm9keSk/aC4kcGFyZW50LiRldmFsKGouZGF0ZXBpY2tlckFwcGVuZFRvQm9keSk6Zy5hcHBlbmRUb0JvZHk7aC5zaG93QnV0dG9uQmFyPWFuZ3VsYXIuaXNEZWZpbmVkKGouc2hvd0J1dHRvbkJhcik/aC4kcGFyZW50LiRldmFsKGouc2hvd0J1dHRvbkJhcik6Zy5zaG93QnV0dG9uQmFyLGguZ2V0VGV4dD1mdW5jdGlvbihhKXtyZXR1cm4gaFthK1wiVGV4dFwiXXx8Z1thK1wiVGV4dFwiXX0sai4kb2JzZXJ2ZShcImRhdGVwaWNrZXJQb3B1cFwiLGZ1bmN0aW9uKGEpe249YXx8Zy5kYXRlcGlja2VyUG9wdXAsay4kcmVuZGVyKCl9KTt2YXIgcT1hbmd1bGFyLmVsZW1lbnQoXCI8ZGl2IGRhdGVwaWNrZXItcG9wdXAtd3JhcD48ZGl2IGRhdGVwaWNrZXI+PC9kaXY+PC9kaXY+XCIpO3EuYXR0cih7XCJuZy1tb2RlbFwiOlwiZGF0ZVwiLFwibmctY2hhbmdlXCI6XCJkYXRlU2VsZWN0aW9uKClcIn0pO3ZhciByPWFuZ3VsYXIuZWxlbWVudChxLmNoaWxkcmVuKClbMF0pO2ouZGF0ZXBpY2tlck9wdGlvbnMmJmFuZ3VsYXIuZm9yRWFjaChoLiRwYXJlbnQuJGV2YWwoai5kYXRlcGlja2VyT3B0aW9ucyksZnVuY3Rpb24oYSxiKXtyLmF0dHIobChiKSxhKX0pLGgud2F0Y2hEYXRhPXt9LGFuZ3VsYXIuZm9yRWFjaChbXCJtaW5EYXRlXCIsXCJtYXhEYXRlXCIsXCJkYXRlcGlja2VyTW9kZVwiXSxmdW5jdGlvbihhKXtpZihqW2FdKXt2YXIgYz1iKGpbYV0pO2lmKGguJHBhcmVudC4kd2F0Y2goYyxmdW5jdGlvbihiKXtoLndhdGNoRGF0YVthXT1ifSksci5hdHRyKGwoYSksXCJ3YXRjaERhdGEuXCIrYSksXCJkYXRlcGlja2VyTW9kZVwiPT09YSl7dmFyIGQ9Yy5hc3NpZ247aC4kd2F0Y2goXCJ3YXRjaERhdGEuXCIrYSxmdW5jdGlvbihhLGIpe2EhPT1iJiZkKGguJHBhcmVudCxhKX0pfX19KSxqLmRhdGVEaXNhYmxlZCYmci5hdHRyKFwiZGF0ZS1kaXNhYmxlZFwiLFwiZGF0ZURpc2FibGVkKHsgZGF0ZTogZGF0ZSwgbW9kZTogbW9kZSB9KVwiKSxrLiRwYXJzZXJzLnVuc2hpZnQobSksaC5kYXRlU2VsZWN0aW9uPWZ1bmN0aW9uKGEpe2FuZ3VsYXIuaXNEZWZpbmVkKGEpJiYoaC5kYXRlPWEpLGsuJHNldFZpZXdWYWx1ZShoLmRhdGUpLGsuJHJlbmRlcigpLG8mJihoLmlzT3Blbj0hMSxpWzBdLmZvY3VzKCkpfSxpLmJpbmQoXCJpbnB1dCBjaGFuZ2Uga2V5dXBcIixmdW5jdGlvbigpe2guJGFwcGx5KGZ1bmN0aW9uKCl7aC5kYXRlPWsuJG1vZGVsVmFsdWV9KX0pLGsuJHJlbmRlcj1mdW5jdGlvbigpe3ZhciBhPWsuJHZpZXdWYWx1ZT9lKGsuJHZpZXdWYWx1ZSxuKTpcIlwiO2kudmFsKGEpLGguZGF0ZT1tKGsuJG1vZGVsVmFsdWUpfTt2YXIgcz1mdW5jdGlvbihhKXtoLmlzT3BlbiYmYS50YXJnZXQhPT1pWzBdJiZoLiRhcHBseShmdW5jdGlvbigpe2guaXNPcGVuPSExfSl9LHQ9ZnVuY3Rpb24oYSl7aC5rZXlkb3duKGEpfTtpLmJpbmQoXCJrZXlkb3duXCIsdCksaC5rZXlkb3duPWZ1bmN0aW9uKGEpezI3PT09YS53aGljaD8oYS5wcmV2ZW50RGVmYXVsdCgpLGEuc3RvcFByb3BhZ2F0aW9uKCksaC5jbG9zZSgpKTo0MCE9PWEud2hpY2h8fGguaXNPcGVufHwoaC5pc09wZW49ITApfSxoLiR3YXRjaChcImlzT3BlblwiLGZ1bmN0aW9uKGEpe2E/KGguJGJyb2FkY2FzdChcImRhdGVwaWNrZXIuZm9jdXNcIiksaC5wb3NpdGlvbj1wP2Qub2Zmc2V0KGkpOmQucG9zaXRpb24oaSksaC5wb3NpdGlvbi50b3A9aC5wb3NpdGlvbi50b3AraS5wcm9wKFwib2Zmc2V0SGVpZ2h0XCIpLGMuYmluZChcImNsaWNrXCIscykpOmMudW5iaW5kKFwiY2xpY2tcIixzKX0pLGguc2VsZWN0PWZ1bmN0aW9uKGEpe2lmKFwidG9kYXlcIj09PWEpe3ZhciBiPW5ldyBEYXRlO2FuZ3VsYXIuaXNEYXRlKGsuJG1vZGVsVmFsdWUpPyhhPW5ldyBEYXRlKGsuJG1vZGVsVmFsdWUpLGEuc2V0RnVsbFllYXIoYi5nZXRGdWxsWWVhcigpLGIuZ2V0TW9udGgoKSxiLmdldERhdGUoKSkpOmE9bmV3IERhdGUoYi5zZXRIb3VycygwLDAsMCwwKSl9aC5kYXRlU2VsZWN0aW9uKGEpfSxoLmNsb3NlPWZ1bmN0aW9uKCl7aC5pc09wZW49ITEsaVswXS5mb2N1cygpfTt2YXIgdT1hKHEpKGgpO3EucmVtb3ZlKCkscD9jLmZpbmQoXCJib2R5XCIpLmFwcGVuZCh1KTppLmFmdGVyKHUpLGguJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe3UucmVtb3ZlKCksaS51bmJpbmQoXCJrZXlkb3duXCIsdCksYy51bmJpbmQoXCJjbGlja1wiLHMpfSl9fX1dKS5kaXJlY3RpdmUoXCJkYXRlcGlja2VyUG9wdXBXcmFwXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHJlcGxhY2U6ITAsdHJhbnNjbHVkZTohMCx0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL2RhdGVwaWNrZXIvcG9wdXAuaHRtbFwiLGxpbms6ZnVuY3Rpb24oYSxiKXtiLmJpbmQoXCJjbGlja1wiLGZ1bmN0aW9uKGEpe2EucHJldmVudERlZmF1bHQoKSxhLnN0b3BQcm9wYWdhdGlvbigpfSl9fX0pLGFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwLmRyb3Bkb3duXCIsW10pLmNvbnN0YW50KFwiZHJvcGRvd25Db25maWdcIix7b3BlbkNsYXNzOlwib3BlblwifSkuc2VydmljZShcImRyb3Bkb3duU2VydmljZVwiLFtcIiRkb2N1bWVudFwiLGZ1bmN0aW9uKGEpe3ZhciBiPW51bGw7dGhpcy5vcGVuPWZ1bmN0aW9uKGUpe2J8fChhLmJpbmQoXCJjbGlja1wiLGMpLGEuYmluZChcImtleWRvd25cIixkKSksYiYmYiE9PWUmJihiLmlzT3Blbj0hMSksYj1lfSx0aGlzLmNsb3NlPWZ1bmN0aW9uKGUpe2I9PT1lJiYoYj1udWxsLGEudW5iaW5kKFwiY2xpY2tcIixjKSxhLnVuYmluZChcImtleWRvd25cIixkKSl9O3ZhciBjPWZ1bmN0aW9uKGEpe3ZhciBjPWIuZ2V0VG9nZ2xlRWxlbWVudCgpO2EmJmMmJmNbMF0uY29udGFpbnMoYS50YXJnZXQpfHxiLiRhcHBseShmdW5jdGlvbigpe2IuaXNPcGVuPSExfSl9LGQ9ZnVuY3Rpb24oYSl7Mjc9PT1hLndoaWNoJiYoYi5mb2N1c1RvZ2dsZUVsZW1lbnQoKSxjKCkpfX1dKS5jb250cm9sbGVyKFwiRHJvcGRvd25Db250cm9sbGVyXCIsW1wiJHNjb3BlXCIsXCIkYXR0cnNcIixcIiRwYXJzZVwiLFwiZHJvcGRvd25Db25maWdcIixcImRyb3Bkb3duU2VydmljZVwiLFwiJGFuaW1hdGVcIixmdW5jdGlvbihhLGIsYyxkLGUsZil7dmFyIGcsaD10aGlzLGk9YS4kbmV3KCksaj1kLm9wZW5DbGFzcyxrPWFuZ3VsYXIubm9vcCxsPWIub25Ub2dnbGU/YyhiLm9uVG9nZ2xlKTphbmd1bGFyLm5vb3A7dGhpcy5pbml0PWZ1bmN0aW9uKGQpe2guJGVsZW1lbnQ9ZCxiLmlzT3BlbiYmKGc9YyhiLmlzT3Blbiksaz1nLmFzc2lnbixhLiR3YXRjaChnLGZ1bmN0aW9uKGEpe2kuaXNPcGVuPSEhYX0pKX0sdGhpcy50b2dnbGU9ZnVuY3Rpb24oYSl7cmV0dXJuIGkuaXNPcGVuPWFyZ3VtZW50cy5sZW5ndGg/ISFhOiFpLmlzT3Blbn0sdGhpcy5pc09wZW49ZnVuY3Rpb24oKXtyZXR1cm4gaS5pc09wZW59LGkuZ2V0VG9nZ2xlRWxlbWVudD1mdW5jdGlvbigpe3JldHVybiBoLnRvZ2dsZUVsZW1lbnR9LGkuZm9jdXNUb2dnbGVFbGVtZW50PWZ1bmN0aW9uKCl7aC50b2dnbGVFbGVtZW50JiZoLnRvZ2dsZUVsZW1lbnRbMF0uZm9jdXMoKX0saS4kd2F0Y2goXCJpc09wZW5cIixmdW5jdGlvbihiLGMpe2ZbYj9cImFkZENsYXNzXCI6XCJyZW1vdmVDbGFzc1wiXShoLiRlbGVtZW50LGopLGI/KGkuZm9jdXNUb2dnbGVFbGVtZW50KCksZS5vcGVuKGkpKTplLmNsb3NlKGkpLGsoYSxiKSxhbmd1bGFyLmlzRGVmaW5lZChiKSYmYiE9PWMmJmwoYSx7b3BlbjohIWJ9KX0pLGEuJG9uKFwiJGxvY2F0aW9uQ2hhbmdlU3VjY2Vzc1wiLGZ1bmN0aW9uKCl7aS5pc09wZW49ITF9KSxhLiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtpLiRkZXN0cm95KCl9KX1dKS5kaXJlY3RpdmUoXCJkcm9wZG93blwiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiQ0FcIixjb250cm9sbGVyOlwiRHJvcGRvd25Db250cm9sbGVyXCIsbGluazpmdW5jdGlvbihhLGIsYyxkKXtkLmluaXQoYil9fX0pLmRpcmVjdGl2ZShcImRyb3Bkb3duVG9nZ2xlXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJDQVwiLHJlcXVpcmU6XCI/XmRyb3Bkb3duXCIsbGluazpmdW5jdGlvbihhLGIsYyxkKXtpZihkKXtkLnRvZ2dsZUVsZW1lbnQ9Yjt2YXIgZT1mdW5jdGlvbihlKXtlLnByZXZlbnREZWZhdWx0KCksYi5oYXNDbGFzcyhcImRpc2FibGVkXCIpfHxjLmRpc2FibGVkfHxhLiRhcHBseShmdW5jdGlvbigpe2QudG9nZ2xlKCl9KX07Yi5iaW5kKFwiY2xpY2tcIixlKSxiLmF0dHIoe1wiYXJpYS1oYXNwb3B1cFwiOiEwLFwiYXJpYS1leHBhbmRlZFwiOiExfSksYS4kd2F0Y2goZC5pc09wZW4sZnVuY3Rpb24oYSl7Yi5hdHRyKFwiYXJpYS1leHBhbmRlZFwiLCEhYSl9KSxhLiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtiLnVuYmluZChcImNsaWNrXCIsZSl9KX19fX0pLGFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwLm1vZGFsXCIsW1widWkuYm9vdHN0cmFwLnRyYW5zaXRpb25cIl0pLmZhY3RvcnkoXCIkJHN0YWNrZWRNYXBcIixmdW5jdGlvbigpe3JldHVybntjcmVhdGVOZXc6ZnVuY3Rpb24oKXt2YXIgYT1bXTtyZXR1cm57YWRkOmZ1bmN0aW9uKGIsYyl7YS5wdXNoKHtrZXk6Yix2YWx1ZTpjfSl9LGdldDpmdW5jdGlvbihiKXtmb3IodmFyIGM9MDtjPGEubGVuZ3RoO2MrKylpZihiPT1hW2NdLmtleSlyZXR1cm4gYVtjXX0sa2V5czpmdW5jdGlvbigpe2Zvcih2YXIgYj1bXSxjPTA7YzxhLmxlbmd0aDtjKyspYi5wdXNoKGFbY10ua2V5KTtyZXR1cm4gYn0sdG9wOmZ1bmN0aW9uKCl7cmV0dXJuIGFbYS5sZW5ndGgtMV19LHJlbW92ZTpmdW5jdGlvbihiKXtmb3IodmFyIGM9LTEsZD0wO2Q8YS5sZW5ndGg7ZCsrKWlmKGI9PWFbZF0ua2V5KXtjPWQ7YnJlYWt9cmV0dXJuIGEuc3BsaWNlKGMsMSlbMF19LHJlbW92ZVRvcDpmdW5jdGlvbigpe3JldHVybiBhLnNwbGljZShhLmxlbmd0aC0xLDEpWzBdfSxsZW5ndGg6ZnVuY3Rpb24oKXtyZXR1cm4gYS5sZW5ndGh9fX19fSkuZGlyZWN0aXZlKFwibW9kYWxCYWNrZHJvcFwiLFtcIiR0aW1lb3V0XCIsZnVuY3Rpb24oYSl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixyZXBsYWNlOiEwLHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvbW9kYWwvYmFja2Ryb3AuaHRtbFwiLGxpbms6ZnVuY3Rpb24oYixjLGQpe2IuYmFja2Ryb3BDbGFzcz1kLmJhY2tkcm9wQ2xhc3N8fFwiXCIsYi5hbmltYXRlPSExLGEoZnVuY3Rpb24oKXtiLmFuaW1hdGU9ITB9KX19fV0pLmRpcmVjdGl2ZShcIm1vZGFsV2luZG93XCIsW1wiJG1vZGFsU3RhY2tcIixcIiR0aW1lb3V0XCIsZnVuY3Rpb24oYSxiKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHNjb3BlOntpbmRleDpcIkBcIixhbmltYXRlOlwiPVwifSxyZXBsYWNlOiEwLHRyYW5zY2x1ZGU6ITAsdGVtcGxhdGVVcmw6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi50ZW1wbGF0ZVVybHx8XCJ0ZW1wbGF0ZS9tb2RhbC93aW5kb3cuaHRtbFwifSxsaW5rOmZ1bmN0aW9uKGMsZCxlKXtkLmFkZENsYXNzKGUud2luZG93Q2xhc3N8fFwiXCIpLGMuc2l6ZT1lLnNpemUsYihmdW5jdGlvbigpe2MuYW5pbWF0ZT0hMCxkWzBdLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbYXV0b2ZvY3VzXVwiKS5sZW5ndGh8fGRbMF0uZm9jdXMoKX0pLGMuY2xvc2U9ZnVuY3Rpb24oYil7dmFyIGM9YS5nZXRUb3AoKTtjJiZjLnZhbHVlLmJhY2tkcm9wJiZcInN0YXRpY1wiIT1jLnZhbHVlLmJhY2tkcm9wJiZiLnRhcmdldD09PWIuY3VycmVudFRhcmdldCYmKGIucHJldmVudERlZmF1bHQoKSxiLnN0b3BQcm9wYWdhdGlvbigpLGEuZGlzbWlzcyhjLmtleSxcImJhY2tkcm9wIGNsaWNrXCIpKX19fX1dKS5kaXJlY3RpdmUoXCJtb2RhbFRyYW5zY2x1ZGVcIixmdW5jdGlvbigpe3JldHVybntsaW5rOmZ1bmN0aW9uKGEsYixjLGQsZSl7ZShhLiRwYXJlbnQsZnVuY3Rpb24oYSl7Yi5lbXB0eSgpLGIuYXBwZW5kKGEpfSl9fX0pLmZhY3RvcnkoXCIkbW9kYWxTdGFja1wiLFtcIiR0cmFuc2l0aW9uXCIsXCIkdGltZW91dFwiLFwiJGRvY3VtZW50XCIsXCIkY29tcGlsZVwiLFwiJHJvb3RTY29wZVwiLFwiJCRzdGFja2VkTWFwXCIsZnVuY3Rpb24oYSxiLGMsZCxlLGYpe2Z1bmN0aW9uIGcoKXtmb3IodmFyIGE9LTEsYj1uLmtleXMoKSxjPTA7YzxiLmxlbmd0aDtjKyspbi5nZXQoYltjXSkudmFsdWUuYmFja2Ryb3AmJihhPWMpO3JldHVybiBhfWZ1bmN0aW9uIGgoYSl7dmFyIGI9Yy5maW5kKFwiYm9keVwiKS5lcSgwKSxkPW4uZ2V0KGEpLnZhbHVlO24ucmVtb3ZlKGEpLGooZC5tb2RhbERvbUVsLGQubW9kYWxTY29wZSwzMDAsZnVuY3Rpb24oKXtkLm1vZGFsU2NvcGUuJGRlc3Ryb3koKSxiLnRvZ2dsZUNsYXNzKG0sbi5sZW5ndGgoKT4wKSxpKCl9KX1mdW5jdGlvbiBpKCl7aWYoayYmLTE9PWcoKSl7dmFyIGE9bDtqKGssbCwxNTAsZnVuY3Rpb24oKXthLiRkZXN0cm95KCksYT1udWxsfSksaz12b2lkIDAsbD12b2lkIDB9fWZ1bmN0aW9uIGooYyxkLGUsZil7ZnVuY3Rpb24gZygpe2cuZG9uZXx8KGcuZG9uZT0hMCxjLnJlbW92ZSgpLGYmJmYoKSl9ZC5hbmltYXRlPSExO3ZhciBoPWEudHJhbnNpdGlvbkVuZEV2ZW50TmFtZTtpZihoKXt2YXIgaT1iKGcsZSk7Yy5iaW5kKGgsZnVuY3Rpb24oKXtiLmNhbmNlbChpKSxnKCksZC4kYXBwbHkoKX0pfWVsc2UgYihnKX12YXIgayxsLG09XCJtb2RhbC1vcGVuXCIsbj1mLmNyZWF0ZU5ldygpLG89e307cmV0dXJuIGUuJHdhdGNoKGcsZnVuY3Rpb24oYSl7bCYmKGwuaW5kZXg9YSl9KSxjLmJpbmQoXCJrZXlkb3duXCIsZnVuY3Rpb24oYSl7dmFyIGI7Mjc9PT1hLndoaWNoJiYoYj1uLnRvcCgpLGImJmIudmFsdWUua2V5Ym9hcmQmJihhLnByZXZlbnREZWZhdWx0KCksZS4kYXBwbHkoZnVuY3Rpb24oKXtvLmRpc21pc3MoYi5rZXksXCJlc2NhcGUga2V5IHByZXNzXCIpfSkpKX0pLG8ub3Blbj1mdW5jdGlvbihhLGIpe24uYWRkKGEse2RlZmVycmVkOmIuZGVmZXJyZWQsbW9kYWxTY29wZTpiLnNjb3BlLGJhY2tkcm9wOmIuYmFja2Ryb3Asa2V5Ym9hcmQ6Yi5rZXlib2FyZH0pO3ZhciBmPWMuZmluZChcImJvZHlcIikuZXEoMCksaD1nKCk7aWYoaD49MCYmIWspe2w9ZS4kbmV3KCEwKSxsLmluZGV4PWg7dmFyIGk9YW5ndWxhci5lbGVtZW50KFwiPGRpdiBtb2RhbC1iYWNrZHJvcD48L2Rpdj5cIik7aS5hdHRyKFwiYmFja2Ryb3AtY2xhc3NcIixiLmJhY2tkcm9wQ2xhc3MpLGs9ZChpKShsKSxmLmFwcGVuZChrKX12YXIgaj1hbmd1bGFyLmVsZW1lbnQoXCI8ZGl2IG1vZGFsLXdpbmRvdz48L2Rpdj5cIik7ai5hdHRyKHtcInRlbXBsYXRlLXVybFwiOmIud2luZG93VGVtcGxhdGVVcmwsXCJ3aW5kb3ctY2xhc3NcIjpiLndpbmRvd0NsYXNzLHNpemU6Yi5zaXplLGluZGV4Om4ubGVuZ3RoKCktMSxhbmltYXRlOlwiYW5pbWF0ZVwifSkuaHRtbChiLmNvbnRlbnQpO3ZhciBvPWQoaikoYi5zY29wZSk7bi50b3AoKS52YWx1ZS5tb2RhbERvbUVsPW8sZi5hcHBlbmQobyksZi5hZGRDbGFzcyhtKX0sby5jbG9zZT1mdW5jdGlvbihhLGIpe3ZhciBjPW4uZ2V0KGEpO2MmJihjLnZhbHVlLmRlZmVycmVkLnJlc29sdmUoYiksaChhKSl9LG8uZGlzbWlzcz1mdW5jdGlvbihhLGIpe3ZhciBjPW4uZ2V0KGEpO2MmJihjLnZhbHVlLmRlZmVycmVkLnJlamVjdChiKSxoKGEpKX0sby5kaXNtaXNzQWxsPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLmdldFRvcCgpO2I7KXRoaXMuZGlzbWlzcyhiLmtleSxhKSxiPXRoaXMuZ2V0VG9wKCl9LG8uZ2V0VG9wPWZ1bmN0aW9uKCl7cmV0dXJuIG4udG9wKCl9LG99XSkucHJvdmlkZXIoXCIkbW9kYWxcIixmdW5jdGlvbigpe3ZhciBhPXtvcHRpb25zOntiYWNrZHJvcDohMCxrZXlib2FyZDohMH0sJGdldDpbXCIkaW5qZWN0b3JcIixcIiRyb290U2NvcGVcIixcIiRxXCIsXCIkaHR0cFwiLFwiJHRlbXBsYXRlQ2FjaGVcIixcIiRjb250cm9sbGVyXCIsXCIkbW9kYWxTdGFja1wiLGZ1bmN0aW9uKGIsYyxkLGUsZixnLGgpe2Z1bmN0aW9uIGkoYSl7cmV0dXJuIGEudGVtcGxhdGU/ZC53aGVuKGEudGVtcGxhdGUpOmUuZ2V0KGFuZ3VsYXIuaXNGdW5jdGlvbihhLnRlbXBsYXRlVXJsKT9hLnRlbXBsYXRlVXJsKCk6YS50ZW1wbGF0ZVVybCx7Y2FjaGU6Zn0pLnRoZW4oZnVuY3Rpb24oYSl7cmV0dXJuIGEuZGF0YX0pfWZ1bmN0aW9uIGooYSl7dmFyIGM9W107cmV0dXJuIGFuZ3VsYXIuZm9yRWFjaChhLGZ1bmN0aW9uKGEpeyhhbmd1bGFyLmlzRnVuY3Rpb24oYSl8fGFuZ3VsYXIuaXNBcnJheShhKSkmJmMucHVzaChkLndoZW4oYi5pbnZva2UoYSkpKX0pLGN9dmFyIGs9e307cmV0dXJuIGsub3Blbj1mdW5jdGlvbihiKXt2YXIgZT1kLmRlZmVyKCksZj1kLmRlZmVyKCksaz17cmVzdWx0OmUucHJvbWlzZSxvcGVuZWQ6Zi5wcm9taXNlLGNsb3NlOmZ1bmN0aW9uKGEpe2guY2xvc2UoayxhKX0sZGlzbWlzczpmdW5jdGlvbihhKXtoLmRpc21pc3MoayxhKX19O2lmKGI9YW5ndWxhci5leHRlbmQoe30sYS5vcHRpb25zLGIpLGIucmVzb2x2ZT1iLnJlc29sdmV8fHt9LCFiLnRlbXBsYXRlJiYhYi50ZW1wbGF0ZVVybCl0aHJvdyBuZXcgRXJyb3IoXCJPbmUgb2YgdGVtcGxhdGUgb3IgdGVtcGxhdGVVcmwgb3B0aW9ucyBpcyByZXF1aXJlZC5cIik7dmFyIGw9ZC5hbGwoW2koYildLmNvbmNhdChqKGIucmVzb2x2ZSkpKTtyZXR1cm4gbC50aGVuKGZ1bmN0aW9uKGEpe3ZhciBkPShiLnNjb3BlfHxjKS4kbmV3KCk7ZC4kY2xvc2U9ay5jbG9zZSxkLiRkaXNtaXNzPWsuZGlzbWlzczt2YXIgZixpPXt9LGo9MTtiLmNvbnRyb2xsZXImJihpLiRzY29wZT1kLGkuJG1vZGFsSW5zdGFuY2U9ayxhbmd1bGFyLmZvckVhY2goYi5yZXNvbHZlLGZ1bmN0aW9uKGIsYyl7aVtjXT1hW2orK119KSxmPWcoYi5jb250cm9sbGVyLGkpLGIuY29udHJvbGxlckFzJiYoZFtiLmNvbnRyb2xsZXJBc109ZikpLGgub3BlbihrLHtzY29wZTpkLGRlZmVycmVkOmUsY29udGVudDphWzBdLGJhY2tkcm9wOmIuYmFja2Ryb3Asa2V5Ym9hcmQ6Yi5rZXlib2FyZCxiYWNrZHJvcENsYXNzOmIuYmFja2Ryb3BDbGFzcyx3aW5kb3dDbGFzczpiLndpbmRvd0NsYXNzLHdpbmRvd1RlbXBsYXRlVXJsOmIud2luZG93VGVtcGxhdGVVcmwsc2l6ZTpiLnNpemV9KX0sZnVuY3Rpb24oYSl7ZS5yZWplY3QoYSl9KSxsLnRoZW4oZnVuY3Rpb24oKXtmLnJlc29sdmUoITApfSxmdW5jdGlvbigpe2YucmVqZWN0KCExKX0pLGt9LGt9XX07cmV0dXJuIGF9KSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC5wYWdpbmF0aW9uXCIsW10pLmNvbnRyb2xsZXIoXCJQYWdpbmF0aW9uQ29udHJvbGxlclwiLFtcIiRzY29wZVwiLFwiJGF0dHJzXCIsXCIkcGFyc2VcIixmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcyxlPXskc2V0Vmlld1ZhbHVlOmFuZ3VsYXIubm9vcH0sZj1iLm51bVBhZ2VzP2MoYi5udW1QYWdlcykuYXNzaWduOmFuZ3VsYXIubm9vcDt0aGlzLmluaXQ9ZnVuY3Rpb24oZixnKXtlPWYsdGhpcy5jb25maWc9ZyxlLiRyZW5kZXI9ZnVuY3Rpb24oKXtkLnJlbmRlcigpfSxiLml0ZW1zUGVyUGFnZT9hLiRwYXJlbnQuJHdhdGNoKGMoYi5pdGVtc1BlclBhZ2UpLGZ1bmN0aW9uKGIpe2QuaXRlbXNQZXJQYWdlPXBhcnNlSW50KGIsMTApLGEudG90YWxQYWdlcz1kLmNhbGN1bGF0ZVRvdGFsUGFnZXMoKX0pOnRoaXMuaXRlbXNQZXJQYWdlPWcuaXRlbXNQZXJQYWdlfSx0aGlzLmNhbGN1bGF0ZVRvdGFsUGFnZXM9ZnVuY3Rpb24oKXt2YXIgYj10aGlzLml0ZW1zUGVyUGFnZTwxPzE6TWF0aC5jZWlsKGEudG90YWxJdGVtcy90aGlzLml0ZW1zUGVyUGFnZSk7cmV0dXJuIE1hdGgubWF4KGJ8fDAsMSl9LHRoaXMucmVuZGVyPWZ1bmN0aW9uKCl7YS5wYWdlPXBhcnNlSW50KGUuJHZpZXdWYWx1ZSwxMCl8fDF9LGEuc2VsZWN0UGFnZT1mdW5jdGlvbihiKXthLnBhZ2UhPT1iJiZiPjAmJmI8PWEudG90YWxQYWdlcyYmKGUuJHNldFZpZXdWYWx1ZShiKSxlLiRyZW5kZXIoKSl9LGEuZ2V0VGV4dD1mdW5jdGlvbihiKXtyZXR1cm4gYVtiK1wiVGV4dFwiXXx8ZC5jb25maWdbYitcIlRleHRcIl19LGEubm9QcmV2aW91cz1mdW5jdGlvbigpe3JldHVybiAxPT09YS5wYWdlfSxhLm5vTmV4dD1mdW5jdGlvbigpe3JldHVybiBhLnBhZ2U9PT1hLnRvdGFsUGFnZXN9LGEuJHdhdGNoKFwidG90YWxJdGVtc1wiLGZ1bmN0aW9uKCl7YS50b3RhbFBhZ2VzPWQuY2FsY3VsYXRlVG90YWxQYWdlcygpfSksYS4kd2F0Y2goXCJ0b3RhbFBhZ2VzXCIsZnVuY3Rpb24oYil7ZihhLiRwYXJlbnQsYiksYS5wYWdlPmI/YS5zZWxlY3RQYWdlKGIpOmUuJHJlbmRlcigpfSl9XSkuY29uc3RhbnQoXCJwYWdpbmF0aW9uQ29uZmlnXCIse2l0ZW1zUGVyUGFnZToxMCxib3VuZGFyeUxpbmtzOiExLGRpcmVjdGlvbkxpbmtzOiEwLGZpcnN0VGV4dDpcIkZpcnN0XCIscHJldmlvdXNUZXh0OlwiUHJldmlvdXNcIixuZXh0VGV4dDpcIk5leHRcIixsYXN0VGV4dDpcIkxhc3RcIixyb3RhdGU6ITB9KS5kaXJlY3RpdmUoXCJwYWdpbmF0aW9uXCIsW1wiJHBhcnNlXCIsXCJwYWdpbmF0aW9uQ29uZmlnXCIsZnVuY3Rpb24oYSxiKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHNjb3BlOnt0b3RhbEl0ZW1zOlwiPVwiLGZpcnN0VGV4dDpcIkBcIixwcmV2aW91c1RleHQ6XCJAXCIsbmV4dFRleHQ6XCJAXCIsbGFzdFRleHQ6XCJAXCJ9LHJlcXVpcmU6W1wicGFnaW5hdGlvblwiLFwiP25nTW9kZWxcIl0sY29udHJvbGxlcjpcIlBhZ2luYXRpb25Db250cm9sbGVyXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZS9wYWdpbmF0aW9uL3BhZ2luYXRpb24uaHRtbFwiLHJlcGxhY2U6ITAsbGluazpmdW5jdGlvbihjLGQsZSxmKXtmdW5jdGlvbiBnKGEsYixjKXtyZXR1cm57bnVtYmVyOmEsdGV4dDpiLGFjdGl2ZTpjfX1mdW5jdGlvbiBoKGEsYil7dmFyIGM9W10sZD0xLGU9YixmPWFuZ3VsYXIuaXNEZWZpbmVkKGspJiZiPms7ZiYmKGw/KGQ9TWF0aC5tYXgoYS1NYXRoLmZsb29yKGsvMiksMSksZT1kK2stMSxlPmImJihlPWIsZD1lLWsrMSkpOihkPShNYXRoLmNlaWwoYS9rKS0xKSprKzEsZT1NYXRoLm1pbihkK2stMSxiKSkpO2Zvcih2YXIgaD1kO2U+PWg7aCsrKXt2YXIgaT1nKGgsaCxoPT09YSk7Yy5wdXNoKGkpfWlmKGYmJiFsKXtpZihkPjEpe3ZhciBqPWcoZC0xLFwiLi4uXCIsITEpO2MudW5zaGlmdChqKX1pZihiPmUpe3ZhciBtPWcoZSsxLFwiLi4uXCIsITEpO2MucHVzaChtKX19cmV0dXJuIGN9dmFyIGk9ZlswXSxqPWZbMV07aWYoail7dmFyIGs9YW5ndWxhci5pc0RlZmluZWQoZS5tYXhTaXplKT9jLiRwYXJlbnQuJGV2YWwoZS5tYXhTaXplKTpiLm1heFNpemUsbD1hbmd1bGFyLmlzRGVmaW5lZChlLnJvdGF0ZSk/Yy4kcGFyZW50LiRldmFsKGUucm90YXRlKTpiLnJvdGF0ZTtjLmJvdW5kYXJ5TGlua3M9YW5ndWxhci5pc0RlZmluZWQoZS5ib3VuZGFyeUxpbmtzKT9jLiRwYXJlbnQuJGV2YWwoZS5ib3VuZGFyeUxpbmtzKTpiLmJvdW5kYXJ5TGlua3MsYy5kaXJlY3Rpb25MaW5rcz1hbmd1bGFyLmlzRGVmaW5lZChlLmRpcmVjdGlvbkxpbmtzKT9jLiRwYXJlbnQuJGV2YWwoZS5kaXJlY3Rpb25MaW5rcyk6Yi5kaXJlY3Rpb25MaW5rcyxpLmluaXQoaixiKSxlLm1heFNpemUmJmMuJHBhcmVudC4kd2F0Y2goYShlLm1heFNpemUpLGZ1bmN0aW9uKGEpe2s9cGFyc2VJbnQoYSwxMCksaS5yZW5kZXIoKVxufSk7dmFyIG09aS5yZW5kZXI7aS5yZW5kZXI9ZnVuY3Rpb24oKXttKCksYy5wYWdlPjAmJmMucGFnZTw9Yy50b3RhbFBhZ2VzJiYoYy5wYWdlcz1oKGMucGFnZSxjLnRvdGFsUGFnZXMpKX19fX19XSkuY29uc3RhbnQoXCJwYWdlckNvbmZpZ1wiLHtpdGVtc1BlclBhZ2U6MTAscHJldmlvdXNUZXh0OlwiwqsgUHJldmlvdXNcIixuZXh0VGV4dDpcIk5leHQgwrtcIixhbGlnbjohMH0pLmRpcmVjdGl2ZShcInBhZ2VyXCIsW1wicGFnZXJDb25maWdcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHNjb3BlOnt0b3RhbEl0ZW1zOlwiPVwiLHByZXZpb3VzVGV4dDpcIkBcIixuZXh0VGV4dDpcIkBcIn0scmVxdWlyZTpbXCJwYWdlclwiLFwiP25nTW9kZWxcIl0sY29udHJvbGxlcjpcIlBhZ2luYXRpb25Db250cm9sbGVyXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZS9wYWdpbmF0aW9uL3BhZ2VyLmh0bWxcIixyZXBsYWNlOiEwLGxpbms6ZnVuY3Rpb24oYixjLGQsZSl7dmFyIGY9ZVswXSxnPWVbMV07ZyYmKGIuYWxpZ249YW5ndWxhci5pc0RlZmluZWQoZC5hbGlnbik/Yi4kcGFyZW50LiRldmFsKGQuYWxpZ24pOmEuYWxpZ24sZi5pbml0KGcsYSkpfX19XSksYW5ndWxhci5tb2R1bGUoXCJ1aS5ib290c3RyYXAudG9vbHRpcFwiLFtcInVpLmJvb3RzdHJhcC5wb3NpdGlvblwiLFwidWkuYm9vdHN0cmFwLmJpbmRIdG1sXCJdKS5wcm92aWRlcihcIiR0b29sdGlwXCIsZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBiPS9bQS1aXS9nLGM9XCItXCI7cmV0dXJuIGEucmVwbGFjZShiLGZ1bmN0aW9uKGEsYil7cmV0dXJuKGI/YzpcIlwiKSthLnRvTG93ZXJDYXNlKCl9KX12YXIgYj17cGxhY2VtZW50OlwidG9wXCIsYW5pbWF0aW9uOiEwLHBvcHVwRGVsYXk6MH0sYz17bW91c2VlbnRlcjpcIm1vdXNlbGVhdmVcIixjbGljazpcImNsaWNrXCIsZm9jdXM6XCJibHVyXCJ9LGQ9e307dGhpcy5vcHRpb25zPWZ1bmN0aW9uKGEpe2FuZ3VsYXIuZXh0ZW5kKGQsYSl9LHRoaXMuc2V0VHJpZ2dlcnM9ZnVuY3Rpb24oYSl7YW5ndWxhci5leHRlbmQoYyxhKX0sdGhpcy4kZ2V0PVtcIiR3aW5kb3dcIixcIiRjb21waWxlXCIsXCIkdGltZW91dFwiLFwiJHBhcnNlXCIsXCIkZG9jdW1lbnRcIixcIiRwb3NpdGlvblwiLFwiJGludGVycG9sYXRlXCIsZnVuY3Rpb24oZSxmLGcsaCxpLGosayl7cmV0dXJuIGZ1bmN0aW9uKGUsbCxtKXtmdW5jdGlvbiBuKGEpe3ZhciBiPWF8fG8udHJpZ2dlcnx8bSxkPWNbYl18fGI7cmV0dXJue3Nob3c6YixoaWRlOmR9fXZhciBvPWFuZ3VsYXIuZXh0ZW5kKHt9LGIsZCkscD1hKGUpLHE9ay5zdGFydFN5bWJvbCgpLHI9ay5lbmRTeW1ib2woKSxzPVwiPGRpdiBcIitwKyctcG9wdXAgdGl0bGU9XCInK3ErXCJ0dF90aXRsZVwiK3IrJ1wiIGNvbnRlbnQ9XCInK3ErXCJ0dF9jb250ZW50XCIrcisnXCIgcGxhY2VtZW50PVwiJytxK1widHRfcGxhY2VtZW50XCIrcisnXCIgYW5pbWF0aW9uPVwidHRfYW5pbWF0aW9uXCIgaXMtb3Blbj1cInR0X2lzT3BlblwiPjwvZGl2Pic7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixzY29wZTohMCxjb21waWxlOmZ1bmN0aW9uKCl7dmFyIGE9ZihzKTtyZXR1cm4gZnVuY3Rpb24oYixjLGQpe2Z1bmN0aW9uIGYoKXtiLnR0X2lzT3Blbj9tKCk6aygpfWZ1bmN0aW9uIGsoKXsoIXl8fGIuJGV2YWwoZFtsK1wiRW5hYmxlXCJdKSkmJihiLnR0X3BvcHVwRGVsYXk/dnx8KHY9ZyhwLGIudHRfcG9wdXBEZWxheSwhMSksdi50aGVuKGZ1bmN0aW9uKGEpe2EoKX0pKTpwKCkoKSl9ZnVuY3Rpb24gbSgpe2IuJGFwcGx5KGZ1bmN0aW9uKCl7cSgpfSl9ZnVuY3Rpb24gcCgpe3JldHVybiB2PW51bGwsdSYmKGcuY2FuY2VsKHUpLHU9bnVsbCksYi50dF9jb250ZW50PyhyKCksdC5jc3Moe3RvcDowLGxlZnQ6MCxkaXNwbGF5OlwiYmxvY2tcIn0pLHc/aS5maW5kKFwiYm9keVwiKS5hcHBlbmQodCk6Yy5hZnRlcih0KSx6KCksYi50dF9pc09wZW49ITAsYi4kZGlnZXN0KCkseik6YW5ndWxhci5ub29wfWZ1bmN0aW9uIHEoKXtiLnR0X2lzT3Blbj0hMSxnLmNhbmNlbCh2KSx2PW51bGwsYi50dF9hbmltYXRpb24/dXx8KHU9ZyhzLDUwMCkpOnMoKX1mdW5jdGlvbiByKCl7dCYmcygpLHQ9YShiLGZ1bmN0aW9uKCl7fSksYi4kZGlnZXN0KCl9ZnVuY3Rpb24gcygpe3U9bnVsbCx0JiYodC5yZW1vdmUoKSx0PW51bGwpfXZhciB0LHUsdix3PWFuZ3VsYXIuaXNEZWZpbmVkKG8uYXBwZW5kVG9Cb2R5KT9vLmFwcGVuZFRvQm9keTohMSx4PW4odm9pZCAwKSx5PWFuZ3VsYXIuaXNEZWZpbmVkKGRbbCtcIkVuYWJsZVwiXSksej1mdW5jdGlvbigpe3ZhciBhPWoucG9zaXRpb25FbGVtZW50cyhjLHQsYi50dF9wbGFjZW1lbnQsdyk7YS50b3ArPVwicHhcIixhLmxlZnQrPVwicHhcIix0LmNzcyhhKX07Yi50dF9pc09wZW49ITEsZC4kb2JzZXJ2ZShlLGZ1bmN0aW9uKGEpe2IudHRfY29udGVudD1hLCFhJiZiLnR0X2lzT3BlbiYmcSgpfSksZC4kb2JzZXJ2ZShsK1wiVGl0bGVcIixmdW5jdGlvbihhKXtiLnR0X3RpdGxlPWF9KSxkLiRvYnNlcnZlKGwrXCJQbGFjZW1lbnRcIixmdW5jdGlvbihhKXtiLnR0X3BsYWNlbWVudD1hbmd1bGFyLmlzRGVmaW5lZChhKT9hOm8ucGxhY2VtZW50fSksZC4kb2JzZXJ2ZShsK1wiUG9wdXBEZWxheVwiLGZ1bmN0aW9uKGEpe3ZhciBjPXBhcnNlSW50KGEsMTApO2IudHRfcG9wdXBEZWxheT1pc05hTihjKT9vLnBvcHVwRGVsYXk6Y30pO3ZhciBBPWZ1bmN0aW9uKCl7Yy51bmJpbmQoeC5zaG93LGspLGMudW5iaW5kKHguaGlkZSxtKX07ZC4kb2JzZXJ2ZShsK1wiVHJpZ2dlclwiLGZ1bmN0aW9uKGEpe0EoKSx4PW4oYSkseC5zaG93PT09eC5oaWRlP2MuYmluZCh4LnNob3csZik6KGMuYmluZCh4LnNob3csayksYy5iaW5kKHguaGlkZSxtKSl9KTt2YXIgQj1iLiRldmFsKGRbbCtcIkFuaW1hdGlvblwiXSk7Yi50dF9hbmltYXRpb249YW5ndWxhci5pc0RlZmluZWQoQik/ISFCOm8uYW5pbWF0aW9uLGQuJG9ic2VydmUobCtcIkFwcGVuZFRvQm9keVwiLGZ1bmN0aW9uKGEpe3c9YW5ndWxhci5pc0RlZmluZWQoYSk/aChhKShiKTp3fSksdyYmYi4kb24oXCIkbG9jYXRpb25DaGFuZ2VTdWNjZXNzXCIsZnVuY3Rpb24oKXtiLnR0X2lzT3BlbiYmcSgpfSksYi4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7Zy5jYW5jZWwodSksZy5jYW5jZWwodiksQSgpLHMoKX0pfX19fX1dfSkuZGlyZWN0aXZlKFwidG9vbHRpcFBvcHVwXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHJlcGxhY2U6ITAsc2NvcGU6e2NvbnRlbnQ6XCJAXCIscGxhY2VtZW50OlwiQFwiLGFuaW1hdGlvbjpcIiZcIixpc09wZW46XCImXCJ9LHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvdG9vbHRpcC90b29sdGlwLXBvcHVwLmh0bWxcIn19KS5kaXJlY3RpdmUoXCJ0b29sdGlwXCIsW1wiJHRvb2x0aXBcIixmdW5jdGlvbihhKXtyZXR1cm4gYShcInRvb2x0aXBcIixcInRvb2x0aXBcIixcIm1vdXNlZW50ZXJcIil9XSkuZGlyZWN0aXZlKFwidG9vbHRpcEh0bWxVbnNhZmVQb3B1cFwiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixyZXBsYWNlOiEwLHNjb3BlOntjb250ZW50OlwiQFwiLHBsYWNlbWVudDpcIkBcIixhbmltYXRpb246XCImXCIsaXNPcGVuOlwiJlwifSx0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL3Rvb2x0aXAvdG9vbHRpcC1odG1sLXVuc2FmZS1wb3B1cC5odG1sXCJ9fSkuZGlyZWN0aXZlKFwidG9vbHRpcEh0bWxVbnNhZmVcIixbXCIkdG9vbHRpcFwiLGZ1bmN0aW9uKGEpe3JldHVybiBhKFwidG9vbHRpcEh0bWxVbnNhZmVcIixcInRvb2x0aXBcIixcIm1vdXNlZW50ZXJcIil9XSksYW5ndWxhci5tb2R1bGUoXCJ1aS5ib290c3RyYXAucG9wb3ZlclwiLFtcInVpLmJvb3RzdHJhcC50b29sdGlwXCJdKS5kaXJlY3RpdmUoXCJwb3BvdmVyUG9wdXBcIixmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVBXCIscmVwbGFjZTohMCxzY29wZTp7dGl0bGU6XCJAXCIsY29udGVudDpcIkBcIixwbGFjZW1lbnQ6XCJAXCIsYW5pbWF0aW9uOlwiJlwiLGlzT3BlbjpcIiZcIn0sdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZS9wb3BvdmVyL3BvcG92ZXIuaHRtbFwifX0pLmRpcmVjdGl2ZShcInBvcG92ZXJcIixbXCIkdG9vbHRpcFwiLGZ1bmN0aW9uKGEpe3JldHVybiBhKFwicG9wb3ZlclwiLFwicG9wb3ZlclwiLFwiY2xpY2tcIil9XSksYW5ndWxhci5tb2R1bGUoXCJ1aS5ib290c3RyYXAucHJvZ3Jlc3NiYXJcIixbXSkuY29uc3RhbnQoXCJwcm9ncmVzc0NvbmZpZ1wiLHthbmltYXRlOiEwLG1heDoxMDB9KS5jb250cm9sbGVyKFwiUHJvZ3Jlc3NDb250cm9sbGVyXCIsW1wiJHNjb3BlXCIsXCIkYXR0cnNcIixcInByb2dyZXNzQ29uZmlnXCIsZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMsZT1hbmd1bGFyLmlzRGVmaW5lZChiLmFuaW1hdGUpP2EuJHBhcmVudC4kZXZhbChiLmFuaW1hdGUpOmMuYW5pbWF0ZTt0aGlzLmJhcnM9W10sYS5tYXg9YW5ndWxhci5pc0RlZmluZWQoYi5tYXgpP2EuJHBhcmVudC4kZXZhbChiLm1heCk6Yy5tYXgsdGhpcy5hZGRCYXI9ZnVuY3Rpb24oYixjKXtlfHxjLmNzcyh7dHJhbnNpdGlvbjpcIm5vbmVcIn0pLHRoaXMuYmFycy5wdXNoKGIpLGIuJHdhdGNoKFwidmFsdWVcIixmdW5jdGlvbihjKXtiLnBlcmNlbnQ9KygxMDAqYy9hLm1heCkudG9GaXhlZCgyKX0pLGIuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2M9bnVsbCxkLnJlbW92ZUJhcihiKX0pfSx0aGlzLnJlbW92ZUJhcj1mdW5jdGlvbihhKXt0aGlzLmJhcnMuc3BsaWNlKHRoaXMuYmFycy5pbmRleE9mKGEpLDEpfX1dKS5kaXJlY3RpdmUoXCJwcm9ncmVzc1wiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixyZXBsYWNlOiEwLHRyYW5zY2x1ZGU6ITAsY29udHJvbGxlcjpcIlByb2dyZXNzQ29udHJvbGxlclwiLHJlcXVpcmU6XCJwcm9ncmVzc1wiLHNjb3BlOnt9LHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvcHJvZ3Jlc3NiYXIvcHJvZ3Jlc3MuaHRtbFwifX0pLmRpcmVjdGl2ZShcImJhclwiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixyZXBsYWNlOiEwLHRyYW5zY2x1ZGU6ITAscmVxdWlyZTpcIl5wcm9ncmVzc1wiLHNjb3BlOnt2YWx1ZTpcIj1cIix0eXBlOlwiQFwifSx0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL3Byb2dyZXNzYmFyL2Jhci5odG1sXCIsbGluazpmdW5jdGlvbihhLGIsYyxkKXtkLmFkZEJhcihhLGIpfX19KS5kaXJlY3RpdmUoXCJwcm9ncmVzc2JhclwiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixyZXBsYWNlOiEwLHRyYW5zY2x1ZGU6ITAsY29udHJvbGxlcjpcIlByb2dyZXNzQ29udHJvbGxlclwiLHNjb3BlOnt2YWx1ZTpcIj1cIix0eXBlOlwiQFwifSx0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL3Byb2dyZXNzYmFyL3Byb2dyZXNzYmFyLmh0bWxcIixsaW5rOmZ1bmN0aW9uKGEsYixjLGQpe2QuYWRkQmFyKGEsYW5ndWxhci5lbGVtZW50KGIuY2hpbGRyZW4oKVswXSkpfX19KSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC5yYXRpbmdcIixbXSkuY29uc3RhbnQoXCJyYXRpbmdDb25maWdcIix7bWF4OjUsc3RhdGVPbjpudWxsLHN0YXRlT2ZmOm51bGx9KS5jb250cm9sbGVyKFwiUmF0aW5nQ29udHJvbGxlclwiLFtcIiRzY29wZVwiLFwiJGF0dHJzXCIsXCJyYXRpbmdDb25maWdcIixmdW5jdGlvbihhLGIsYyl7dmFyIGQ9eyRzZXRWaWV3VmFsdWU6YW5ndWxhci5ub29wfTt0aGlzLmluaXQ9ZnVuY3Rpb24oZSl7ZD1lLGQuJHJlbmRlcj10aGlzLnJlbmRlcix0aGlzLnN0YXRlT249YW5ndWxhci5pc0RlZmluZWQoYi5zdGF0ZU9uKT9hLiRwYXJlbnQuJGV2YWwoYi5zdGF0ZU9uKTpjLnN0YXRlT24sdGhpcy5zdGF0ZU9mZj1hbmd1bGFyLmlzRGVmaW5lZChiLnN0YXRlT2ZmKT9hLiRwYXJlbnQuJGV2YWwoYi5zdGF0ZU9mZik6Yy5zdGF0ZU9mZjt2YXIgZj1hbmd1bGFyLmlzRGVmaW5lZChiLnJhdGluZ1N0YXRlcyk/YS4kcGFyZW50LiRldmFsKGIucmF0aW5nU3RhdGVzKTpuZXcgQXJyYXkoYW5ndWxhci5pc0RlZmluZWQoYi5tYXgpP2EuJHBhcmVudC4kZXZhbChiLm1heCk6Yy5tYXgpO2EucmFuZ2U9dGhpcy5idWlsZFRlbXBsYXRlT2JqZWN0cyhmKX0sdGhpcy5idWlsZFRlbXBsYXRlT2JqZWN0cz1mdW5jdGlvbihhKXtmb3IodmFyIGI9MCxjPWEubGVuZ3RoO2M+YjtiKyspYVtiXT1hbmd1bGFyLmV4dGVuZCh7aW5kZXg6Yn0se3N0YXRlT246dGhpcy5zdGF0ZU9uLHN0YXRlT2ZmOnRoaXMuc3RhdGVPZmZ9LGFbYl0pO3JldHVybiBhfSxhLnJhdGU9ZnVuY3Rpb24oYil7IWEucmVhZG9ubHkmJmI+PTAmJmI8PWEucmFuZ2UubGVuZ3RoJiYoZC4kc2V0Vmlld1ZhbHVlKGIpLGQuJHJlbmRlcigpKX0sYS5lbnRlcj1mdW5jdGlvbihiKXthLnJlYWRvbmx5fHwoYS52YWx1ZT1iKSxhLm9uSG92ZXIoe3ZhbHVlOmJ9KX0sYS5yZXNldD1mdW5jdGlvbigpe2EudmFsdWU9ZC4kdmlld1ZhbHVlLGEub25MZWF2ZSgpfSxhLm9uS2V5ZG93bj1mdW5jdGlvbihiKXsvKDM3fDM4fDM5fDQwKS8udGVzdChiLndoaWNoKSYmKGIucHJldmVudERlZmF1bHQoKSxiLnN0b3BQcm9wYWdhdGlvbigpLGEucmF0ZShhLnZhbHVlKygzOD09PWIud2hpY2h8fDM5PT09Yi53aGljaD8xOi0xKSkpfSx0aGlzLnJlbmRlcj1mdW5jdGlvbigpe2EudmFsdWU9ZC4kdmlld1ZhbHVlfX1dKS5kaXJlY3RpdmUoXCJyYXRpbmdcIixmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVBXCIscmVxdWlyZTpbXCJyYXRpbmdcIixcIm5nTW9kZWxcIl0sc2NvcGU6e3JlYWRvbmx5OlwiPT9cIixvbkhvdmVyOlwiJlwiLG9uTGVhdmU6XCImXCJ9LGNvbnRyb2xsZXI6XCJSYXRpbmdDb250cm9sbGVyXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZS9yYXRpbmcvcmF0aW5nLmh0bWxcIixyZXBsYWNlOiEwLGxpbms6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9ZFswXSxmPWRbMV07ZiYmZS5pbml0KGYpfX19KSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC50YWJzXCIsW10pLmNvbnRyb2xsZXIoXCJUYWJzZXRDb250cm9sbGVyXCIsW1wiJHNjb3BlXCIsZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPWIudGFicz1hLnRhYnM9W107Yi5zZWxlY3Q9ZnVuY3Rpb24oYSl7YW5ndWxhci5mb3JFYWNoKGMsZnVuY3Rpb24oYil7Yi5hY3RpdmUmJmIhPT1hJiYoYi5hY3RpdmU9ITEsYi5vbkRlc2VsZWN0KCkpfSksYS5hY3RpdmU9ITAsYS5vblNlbGVjdCgpfSxiLmFkZFRhYj1mdW5jdGlvbihhKXtjLnB1c2goYSksMT09PWMubGVuZ3RoP2EuYWN0aXZlPSEwOmEuYWN0aXZlJiZiLnNlbGVjdChhKX0sYi5yZW1vdmVUYWI9ZnVuY3Rpb24oYSl7dmFyIGQ9Yy5pbmRleE9mKGEpO2lmKGEuYWN0aXZlJiZjLmxlbmd0aD4xKXt2YXIgZT1kPT1jLmxlbmd0aC0xP2QtMTpkKzE7Yi5zZWxlY3QoY1tlXSl9Yy5zcGxpY2UoZCwxKX19XSkuZGlyZWN0aXZlKFwidGFic2V0XCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHRyYW5zY2x1ZGU6ITAscmVwbGFjZTohMCxzY29wZTp7dHlwZTpcIkBcIn0sY29udHJvbGxlcjpcIlRhYnNldENvbnRyb2xsZXJcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL3RhYnMvdGFic2V0Lmh0bWxcIixsaW5rOmZ1bmN0aW9uKGEsYixjKXthLnZlcnRpY2FsPWFuZ3VsYXIuaXNEZWZpbmVkKGMudmVydGljYWwpP2EuJHBhcmVudC4kZXZhbChjLnZlcnRpY2FsKTohMSxhLmp1c3RpZmllZD1hbmd1bGFyLmlzRGVmaW5lZChjLmp1c3RpZmllZCk/YS4kcGFyZW50LiRldmFsKGMuanVzdGlmaWVkKTohMX19fSkuZGlyZWN0aXZlKFwidGFiXCIsW1wiJHBhcnNlXCIsZnVuY3Rpb24oYSl7cmV0dXJue3JlcXVpcmU6XCJedGFic2V0XCIscmVzdHJpY3Q6XCJFQVwiLHJlcGxhY2U6ITAsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZS90YWJzL3RhYi5odG1sXCIsdHJhbnNjbHVkZTohMCxzY29wZTp7YWN0aXZlOlwiPT9cIixoZWFkaW5nOlwiQFwiLG9uU2VsZWN0OlwiJnNlbGVjdFwiLG9uRGVzZWxlY3Q6XCImZGVzZWxlY3RcIn0sY29udHJvbGxlcjpmdW5jdGlvbigpe30sY29tcGlsZTpmdW5jdGlvbihiLGMsZCl7cmV0dXJuIGZ1bmN0aW9uKGIsYyxlLGYpe2IuJHdhdGNoKFwiYWN0aXZlXCIsZnVuY3Rpb24oYSl7YSYmZi5zZWxlY3QoYil9KSxiLmRpc2FibGVkPSExLGUuZGlzYWJsZWQmJmIuJHBhcmVudC4kd2F0Y2goYShlLmRpc2FibGVkKSxmdW5jdGlvbihhKXtiLmRpc2FibGVkPSEhYX0pLGIuc2VsZWN0PWZ1bmN0aW9uKCl7Yi5kaXNhYmxlZHx8KGIuYWN0aXZlPSEwKX0sZi5hZGRUYWIoYiksYi4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7Zi5yZW1vdmVUYWIoYil9KSxiLiR0cmFuc2NsdWRlRm49ZH19fX1dKS5kaXJlY3RpdmUoXCJ0YWJIZWFkaW5nVHJhbnNjbHVkZVwiLFtmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkFcIixyZXF1aXJlOlwiXnRhYlwiLGxpbms6ZnVuY3Rpb24oYSxiKXthLiR3YXRjaChcImhlYWRpbmdFbGVtZW50XCIsZnVuY3Rpb24oYSl7YSYmKGIuaHRtbChcIlwiKSxiLmFwcGVuZChhKSl9KX19fV0pLmRpcmVjdGl2ZShcInRhYkNvbnRlbnRUcmFuc2NsdWRlXCIsZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3JldHVybiBhLnRhZ05hbWUmJihhLmhhc0F0dHJpYnV0ZShcInRhYi1oZWFkaW5nXCIpfHxhLmhhc0F0dHJpYnV0ZShcImRhdGEtdGFiLWhlYWRpbmdcIil8fFwidGFiLWhlYWRpbmdcIj09PWEudGFnTmFtZS50b0xvd2VyQ2FzZSgpfHxcImRhdGEtdGFiLWhlYWRpbmdcIj09PWEudGFnTmFtZS50b0xvd2VyQ2FzZSgpKX1yZXR1cm57cmVzdHJpY3Q6XCJBXCIscmVxdWlyZTpcIl50YWJzZXRcIixsaW5rOmZ1bmN0aW9uKGIsYyxkKXt2YXIgZT1iLiRldmFsKGQudGFiQ29udGVudFRyYW5zY2x1ZGUpO2UuJHRyYW5zY2x1ZGVGbihlLiRwYXJlbnQsZnVuY3Rpb24oYil7YW5ndWxhci5mb3JFYWNoKGIsZnVuY3Rpb24oYil7YShiKT9lLmhlYWRpbmdFbGVtZW50PWI6Yy5hcHBlbmQoYil9KX0pfX19KSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC50aW1lcGlja2VyXCIsW10pLmNvbnN0YW50KFwidGltZXBpY2tlckNvbmZpZ1wiLHtob3VyU3RlcDoxLG1pbnV0ZVN0ZXA6MSxzaG93TWVyaWRpYW46ITAsbWVyaWRpYW5zOm51bGwscmVhZG9ubHlJbnB1dDohMSxtb3VzZXdoZWVsOiEwfSkuY29udHJvbGxlcihcIlRpbWVwaWNrZXJDb250cm9sbGVyXCIsW1wiJHNjb3BlXCIsXCIkYXR0cnNcIixcIiRwYXJzZVwiLFwiJGxvZ1wiLFwiJGxvY2FsZVwiLFwidGltZXBpY2tlckNvbmZpZ1wiLGZ1bmN0aW9uKGEsYixjLGQsZSxmKXtmdW5jdGlvbiBnKCl7dmFyIGI9cGFyc2VJbnQoYS5ob3VycywxMCksYz1hLnNob3dNZXJpZGlhbj9iPjAmJjEzPmI6Yj49MCYmMjQ+YjtyZXR1cm4gYz8oYS5zaG93TWVyaWRpYW4mJigxMj09PWImJihiPTApLGEubWVyaWRpYW49PT1wWzFdJiYoYis9MTIpKSxiKTp2b2lkIDB9ZnVuY3Rpb24gaCgpe3ZhciBiPXBhcnNlSW50KGEubWludXRlcywxMCk7cmV0dXJuIGI+PTAmJjYwPmI/Yjp2b2lkIDB9ZnVuY3Rpb24gaShhKXtyZXR1cm4gYW5ndWxhci5pc0RlZmluZWQoYSkmJmEudG9TdHJpbmcoKS5sZW5ndGg8Mj9cIjBcIithOmF9ZnVuY3Rpb24gaihhKXtrKCksby4kc2V0Vmlld1ZhbHVlKG5ldyBEYXRlKG4pKSxsKGEpfWZ1bmN0aW9uIGsoKXtvLiRzZXRWYWxpZGl0eShcInRpbWVcIiwhMCksYS5pbnZhbGlkSG91cnM9ITEsYS5pbnZhbGlkTWludXRlcz0hMX1mdW5jdGlvbiBsKGIpe3ZhciBjPW4uZ2V0SG91cnMoKSxkPW4uZ2V0TWludXRlcygpO2Euc2hvd01lcmlkaWFuJiYoYz0wPT09Y3x8MTI9PT1jPzEyOmMlMTIpLGEuaG91cnM9XCJoXCI9PT1iP2M6aShjKSxhLm1pbnV0ZXM9XCJtXCI9PT1iP2Q6aShkKSxhLm1lcmlkaWFuPW4uZ2V0SG91cnMoKTwxMj9wWzBdOnBbMV19ZnVuY3Rpb24gbShhKXt2YXIgYj1uZXcgRGF0ZShuLmdldFRpbWUoKSs2ZTQqYSk7bi5zZXRIb3VycyhiLmdldEhvdXJzKCksYi5nZXRNaW51dGVzKCkpLGooKX12YXIgbj1uZXcgRGF0ZSxvPXskc2V0Vmlld1ZhbHVlOmFuZ3VsYXIubm9vcH0scD1hbmd1bGFyLmlzRGVmaW5lZChiLm1lcmlkaWFucyk/YS4kcGFyZW50LiRldmFsKGIubWVyaWRpYW5zKTpmLm1lcmlkaWFuc3x8ZS5EQVRFVElNRV9GT1JNQVRTLkFNUE1TO3RoaXMuaW5pdD1mdW5jdGlvbihjLGQpe289YyxvLiRyZW5kZXI9dGhpcy5yZW5kZXI7dmFyIGU9ZC5lcSgwKSxnPWQuZXEoMSksaD1hbmd1bGFyLmlzRGVmaW5lZChiLm1vdXNld2hlZWwpP2EuJHBhcmVudC4kZXZhbChiLm1vdXNld2hlZWwpOmYubW91c2V3aGVlbDtoJiZ0aGlzLnNldHVwTW91c2V3aGVlbEV2ZW50cyhlLGcpLGEucmVhZG9ubHlJbnB1dD1hbmd1bGFyLmlzRGVmaW5lZChiLnJlYWRvbmx5SW5wdXQpP2EuJHBhcmVudC4kZXZhbChiLnJlYWRvbmx5SW5wdXQpOmYucmVhZG9ubHlJbnB1dCx0aGlzLnNldHVwSW5wdXRFdmVudHMoZSxnKX07dmFyIHE9Zi5ob3VyU3RlcDtiLmhvdXJTdGVwJiZhLiRwYXJlbnQuJHdhdGNoKGMoYi5ob3VyU3RlcCksZnVuY3Rpb24oYSl7cT1wYXJzZUludChhLDEwKX0pO3ZhciByPWYubWludXRlU3RlcDtiLm1pbnV0ZVN0ZXAmJmEuJHBhcmVudC4kd2F0Y2goYyhiLm1pbnV0ZVN0ZXApLGZ1bmN0aW9uKGEpe3I9cGFyc2VJbnQoYSwxMCl9KSxhLnNob3dNZXJpZGlhbj1mLnNob3dNZXJpZGlhbixiLnNob3dNZXJpZGlhbiYmYS4kcGFyZW50LiR3YXRjaChjKGIuc2hvd01lcmlkaWFuKSxmdW5jdGlvbihiKXtpZihhLnNob3dNZXJpZGlhbj0hIWIsby4kZXJyb3IudGltZSl7dmFyIGM9ZygpLGQ9aCgpO2FuZ3VsYXIuaXNEZWZpbmVkKGMpJiZhbmd1bGFyLmlzRGVmaW5lZChkKSYmKG4uc2V0SG91cnMoYyksaigpKX1lbHNlIGwoKX0pLHRoaXMuc2V0dXBNb3VzZXdoZWVsRXZlbnRzPWZ1bmN0aW9uKGIsYyl7dmFyIGQ9ZnVuY3Rpb24oYSl7YS5vcmlnaW5hbEV2ZW50JiYoYT1hLm9yaWdpbmFsRXZlbnQpO3ZhciBiPWEud2hlZWxEZWx0YT9hLndoZWVsRGVsdGE6LWEuZGVsdGFZO3JldHVybiBhLmRldGFpbHx8Yj4wfTtiLmJpbmQoXCJtb3VzZXdoZWVsIHdoZWVsXCIsZnVuY3Rpb24oYil7YS4kYXBwbHkoZChiKT9hLmluY3JlbWVudEhvdXJzKCk6YS5kZWNyZW1lbnRIb3VycygpKSxiLnByZXZlbnREZWZhdWx0KCl9KSxjLmJpbmQoXCJtb3VzZXdoZWVsIHdoZWVsXCIsZnVuY3Rpb24oYil7YS4kYXBwbHkoZChiKT9hLmluY3JlbWVudE1pbnV0ZXMoKTphLmRlY3JlbWVudE1pbnV0ZXMoKSksYi5wcmV2ZW50RGVmYXVsdCgpfSl9LHRoaXMuc2V0dXBJbnB1dEV2ZW50cz1mdW5jdGlvbihiLGMpe2lmKGEucmVhZG9ubHlJbnB1dClyZXR1cm4gYS51cGRhdGVIb3Vycz1hbmd1bGFyLm5vb3Asdm9pZChhLnVwZGF0ZU1pbnV0ZXM9YW5ndWxhci5ub29wKTt2YXIgZD1mdW5jdGlvbihiLGMpe28uJHNldFZpZXdWYWx1ZShudWxsKSxvLiRzZXRWYWxpZGl0eShcInRpbWVcIiwhMSksYW5ndWxhci5pc0RlZmluZWQoYikmJihhLmludmFsaWRIb3Vycz1iKSxhbmd1bGFyLmlzRGVmaW5lZChjKSYmKGEuaW52YWxpZE1pbnV0ZXM9Yyl9O2EudXBkYXRlSG91cnM9ZnVuY3Rpb24oKXt2YXIgYT1nKCk7YW5ndWxhci5pc0RlZmluZWQoYSk/KG4uc2V0SG91cnMoYSksaihcImhcIikpOmQoITApfSxiLmJpbmQoXCJibHVyXCIsZnVuY3Rpb24oKXshYS5pbnZhbGlkSG91cnMmJmEuaG91cnM8MTAmJmEuJGFwcGx5KGZ1bmN0aW9uKCl7YS5ob3Vycz1pKGEuaG91cnMpfSl9KSxhLnVwZGF0ZU1pbnV0ZXM9ZnVuY3Rpb24oKXt2YXIgYT1oKCk7YW5ndWxhci5pc0RlZmluZWQoYSk/KG4uc2V0TWludXRlcyhhKSxqKFwibVwiKSk6ZCh2b2lkIDAsITApfSxjLmJpbmQoXCJibHVyXCIsZnVuY3Rpb24oKXshYS5pbnZhbGlkTWludXRlcyYmYS5taW51dGVzPDEwJiZhLiRhcHBseShmdW5jdGlvbigpe2EubWludXRlcz1pKGEubWludXRlcyl9KX0pfSx0aGlzLnJlbmRlcj1mdW5jdGlvbigpe3ZhciBhPW8uJG1vZGVsVmFsdWU/bmV3IERhdGUoby4kbW9kZWxWYWx1ZSk6bnVsbDtpc05hTihhKT8oby4kc2V0VmFsaWRpdHkoXCJ0aW1lXCIsITEpLGQuZXJyb3IoJ1RpbWVwaWNrZXIgZGlyZWN0aXZlOiBcIm5nLW1vZGVsXCIgdmFsdWUgbXVzdCBiZSBhIERhdGUgb2JqZWN0LCBhIG51bWJlciBvZiBtaWxsaXNlY29uZHMgc2luY2UgMDEuMDEuMTk3MCBvciBhIHN0cmluZyByZXByZXNlbnRpbmcgYW4gUkZDMjgyMiBvciBJU08gODYwMSBkYXRlLicpKTooYSYmKG49YSksaygpLGwoKSl9LGEuaW5jcmVtZW50SG91cnM9ZnVuY3Rpb24oKXttKDYwKnEpfSxhLmRlY3JlbWVudEhvdXJzPWZ1bmN0aW9uKCl7bSg2MCotcSl9LGEuaW5jcmVtZW50TWludXRlcz1mdW5jdGlvbigpe20ocil9LGEuZGVjcmVtZW50TWludXRlcz1mdW5jdGlvbigpe20oLXIpfSxhLnRvZ2dsZU1lcmlkaWFuPWZ1bmN0aW9uKCl7bSg3MjAqKG4uZ2V0SG91cnMoKTwxMj8xOi0xKSl9fV0pLmRpcmVjdGl2ZShcInRpbWVwaWNrZXJcIixmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVBXCIscmVxdWlyZTpbXCJ0aW1lcGlja2VyXCIsXCI/Xm5nTW9kZWxcIl0sY29udHJvbGxlcjpcIlRpbWVwaWNrZXJDb250cm9sbGVyXCIscmVwbGFjZTohMCxzY29wZTp7fSx0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL3RpbWVwaWNrZXIvdGltZXBpY2tlci5odG1sXCIsbGluazpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1kWzBdLGY9ZFsxXTtmJiZlLmluaXQoZixiLmZpbmQoXCJpbnB1dFwiKSl9fX0pLGFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwLnR5cGVhaGVhZFwiLFtcInVpLmJvb3RzdHJhcC5wb3NpdGlvblwiLFwidWkuYm9vdHN0cmFwLmJpbmRIdG1sXCJdKS5mYWN0b3J5KFwidHlwZWFoZWFkUGFyc2VyXCIsW1wiJHBhcnNlXCIsZnVuY3Rpb24oYSl7dmFyIGI9L15cXHMqKFtcXHNcXFNdKz8pKD86XFxzK2FzXFxzKyhbXFxzXFxTXSs/KSk/XFxzK2ZvclxccysoPzooW1xcJFxcd11bXFwkXFx3XFxkXSopKVxccytpblxccysoW1xcc1xcU10rPykkLztyZXR1cm57cGFyc2U6ZnVuY3Rpb24oYyl7dmFyIGQ9Yy5tYXRjaChiKTtpZighZCl0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIHR5cGVhaGVhZCBzcGVjaWZpY2F0aW9uIGluIGZvcm0gb2YgXCJfbW9kZWxWYWx1ZV8gKGFzIF9sYWJlbF8pPyBmb3IgX2l0ZW1fIGluIF9jb2xsZWN0aW9uX1wiIGJ1dCBnb3QgXCInK2MrJ1wiLicpO3JldHVybntpdGVtTmFtZTpkWzNdLHNvdXJjZTphKGRbNF0pLHZpZXdNYXBwZXI6YShkWzJdfHxkWzFdKSxtb2RlbE1hcHBlcjphKGRbMV0pfX19fV0pLmRpcmVjdGl2ZShcInR5cGVhaGVhZFwiLFtcIiRjb21waWxlXCIsXCIkcGFyc2VcIixcIiRxXCIsXCIkdGltZW91dFwiLFwiJGRvY3VtZW50XCIsXCIkcG9zaXRpb25cIixcInR5cGVhaGVhZFBhcnNlclwiLGZ1bmN0aW9uKGEsYixjLGQsZSxmLGcpe3ZhciBoPVs5LDEzLDI3LDM4LDQwXTtyZXR1cm57cmVxdWlyZTpcIm5nTW9kZWxcIixsaW5rOmZ1bmN0aW9uKGksaixrLGwpe3ZhciBtLG49aS4kZXZhbChrLnR5cGVhaGVhZE1pbkxlbmd0aCl8fDEsbz1pLiRldmFsKGsudHlwZWFoZWFkV2FpdE1zKXx8MCxwPWkuJGV2YWwoay50eXBlYWhlYWRFZGl0YWJsZSkhPT0hMSxxPWIoay50eXBlYWhlYWRMb2FkaW5nKS5hc3NpZ258fGFuZ3VsYXIubm9vcCxyPWIoay50eXBlYWhlYWRPblNlbGVjdCkscz1rLnR5cGVhaGVhZElucHV0Rm9ybWF0dGVyP2Ioay50eXBlYWhlYWRJbnB1dEZvcm1hdHRlcik6dm9pZCAwLHQ9ay50eXBlYWhlYWRBcHBlbmRUb0JvZHk/aS4kZXZhbChrLnR5cGVhaGVhZEFwcGVuZFRvQm9keSk6ITEsdT1iKGsubmdNb2RlbCkuYXNzaWduLHY9Zy5wYXJzZShrLnR5cGVhaGVhZCksdz1pLiRuZXcoKTtpLiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXt3LiRkZXN0cm95KCl9KTt2YXIgeD1cInR5cGVhaGVhZC1cIit3LiRpZCtcIi1cIitNYXRoLmZsb29yKDFlNCpNYXRoLnJhbmRvbSgpKTtqLmF0dHIoe1wiYXJpYS1hdXRvY29tcGxldGVcIjpcImxpc3RcIixcImFyaWEtZXhwYW5kZWRcIjohMSxcImFyaWEtb3duc1wiOnh9KTt2YXIgeT1hbmd1bGFyLmVsZW1lbnQoXCI8ZGl2IHR5cGVhaGVhZC1wb3B1cD48L2Rpdj5cIik7eS5hdHRyKHtpZDp4LG1hdGNoZXM6XCJtYXRjaGVzXCIsYWN0aXZlOlwiYWN0aXZlSWR4XCIsc2VsZWN0Olwic2VsZWN0KGFjdGl2ZUlkeClcIixxdWVyeTpcInF1ZXJ5XCIscG9zaXRpb246XCJwb3NpdGlvblwifSksYW5ndWxhci5pc0RlZmluZWQoay50eXBlYWhlYWRUZW1wbGF0ZVVybCkmJnkuYXR0cihcInRlbXBsYXRlLXVybFwiLGsudHlwZWFoZWFkVGVtcGxhdGVVcmwpO3ZhciB6PWZ1bmN0aW9uKCl7dy5tYXRjaGVzPVtdLHcuYWN0aXZlSWR4PS0xLGouYXR0cihcImFyaWEtZXhwYW5kZWRcIiwhMSl9LEE9ZnVuY3Rpb24oYSl7cmV0dXJuIHgrXCItb3B0aW9uLVwiK2F9O3cuJHdhdGNoKFwiYWN0aXZlSWR4XCIsZnVuY3Rpb24oYSl7MD5hP2oucmVtb3ZlQXR0cihcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiKTpqLmF0dHIoXCJhcmlhLWFjdGl2ZWRlc2NlbmRhbnRcIixBKGEpKX0pO3ZhciBCPWZ1bmN0aW9uKGEpe3ZhciBiPXskdmlld1ZhbHVlOmF9O3EoaSwhMCksYy53aGVuKHYuc291cmNlKGksYikpLnRoZW4oZnVuY3Rpb24oYyl7dmFyIGQ9YT09PWwuJHZpZXdWYWx1ZTtpZihkJiZtKWlmKGMubGVuZ3RoPjApe3cuYWN0aXZlSWR4PTAsdy5tYXRjaGVzLmxlbmd0aD0wO2Zvcih2YXIgZT0wO2U8Yy5sZW5ndGg7ZSsrKWJbdi5pdGVtTmFtZV09Y1tlXSx3Lm1hdGNoZXMucHVzaCh7aWQ6QShlKSxsYWJlbDp2LnZpZXdNYXBwZXIodyxiKSxtb2RlbDpjW2VdfSk7dy5xdWVyeT1hLHcucG9zaXRpb249dD9mLm9mZnNldChqKTpmLnBvc2l0aW9uKGopLHcucG9zaXRpb24udG9wPXcucG9zaXRpb24udG9wK2oucHJvcChcIm9mZnNldEhlaWdodFwiKSxqLmF0dHIoXCJhcmlhLWV4cGFuZGVkXCIsITApfWVsc2UgeigpO2QmJnEoaSwhMSl9LGZ1bmN0aW9uKCl7eigpLHEoaSwhMSl9KX07eigpLHcucXVlcnk9dm9pZCAwO3ZhciBDLEQ9ZnVuY3Rpb24oYSl7Qz1kKGZ1bmN0aW9uKCl7QihhKX0sbyl9LEU9ZnVuY3Rpb24oKXtDJiZkLmNhbmNlbChDKX07bC4kcGFyc2Vycy51bnNoaWZ0KGZ1bmN0aW9uKGEpe3JldHVybiBtPSEwLGEmJmEubGVuZ3RoPj1uP28+MD8oRSgpLEQoYSkpOkIoYSk6KHEoaSwhMSksRSgpLHooKSkscD9hOmE/dm9pZCBsLiRzZXRWYWxpZGl0eShcImVkaXRhYmxlXCIsITEpOihsLiRzZXRWYWxpZGl0eShcImVkaXRhYmxlXCIsITApLGEpfSksbC4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKGEpe3ZhciBiLGMsZD17fTtyZXR1cm4gcz8oZC4kbW9kZWw9YSxzKGksZCkpOihkW3YuaXRlbU5hbWVdPWEsYj12LnZpZXdNYXBwZXIoaSxkKSxkW3YuaXRlbU5hbWVdPXZvaWQgMCxjPXYudmlld01hcHBlcihpLGQpLGIhPT1jP2I6YSl9KSx3LnNlbGVjdD1mdW5jdGlvbihhKXt2YXIgYixjLGU9e307ZVt2Lml0ZW1OYW1lXT1jPXcubWF0Y2hlc1thXS5tb2RlbCxiPXYubW9kZWxNYXBwZXIoaSxlKSx1KGksYiksbC4kc2V0VmFsaWRpdHkoXCJlZGl0YWJsZVwiLCEwKSxyKGkseyRpdGVtOmMsJG1vZGVsOmIsJGxhYmVsOnYudmlld01hcHBlcihpLGUpfSkseigpLGQoZnVuY3Rpb24oKXtqWzBdLmZvY3VzKCl9LDAsITEpfSxqLmJpbmQoXCJrZXlkb3duXCIsZnVuY3Rpb24oYSl7MCE9PXcubWF0Y2hlcy5sZW5ndGgmJi0xIT09aC5pbmRleE9mKGEud2hpY2gpJiYoYS5wcmV2ZW50RGVmYXVsdCgpLDQwPT09YS53aGljaD8ody5hY3RpdmVJZHg9KHcuYWN0aXZlSWR4KzEpJXcubWF0Y2hlcy5sZW5ndGgsdy4kZGlnZXN0KCkpOjM4PT09YS53aGljaD8ody5hY3RpdmVJZHg9KHcuYWN0aXZlSWR4P3cuYWN0aXZlSWR4OncubWF0Y2hlcy5sZW5ndGgpLTEsdy4kZGlnZXN0KCkpOjEzPT09YS53aGljaHx8OT09PWEud2hpY2g/dy4kYXBwbHkoZnVuY3Rpb24oKXt3LnNlbGVjdCh3LmFjdGl2ZUlkeCl9KToyNz09PWEud2hpY2gmJihhLnN0b3BQcm9wYWdhdGlvbigpLHooKSx3LiRkaWdlc3QoKSkpfSksai5iaW5kKFwiYmx1clwiLGZ1bmN0aW9uKCl7bT0hMX0pO3ZhciBGPWZ1bmN0aW9uKGEpe2pbMF0hPT1hLnRhcmdldCYmKHooKSx3LiRkaWdlc3QoKSl9O2UuYmluZChcImNsaWNrXCIsRiksaS4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7ZS51bmJpbmQoXCJjbGlja1wiLEYpfSk7dmFyIEc9YSh5KSh3KTt0P2UuZmluZChcImJvZHlcIikuYXBwZW5kKEcpOmouYWZ0ZXIoRyl9fX1dKS5kaXJlY3RpdmUoXCJ0eXBlYWhlYWRQb3B1cFwiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixzY29wZTp7bWF0Y2hlczpcIj1cIixxdWVyeTpcIj1cIixhY3RpdmU6XCI9XCIscG9zaXRpb246XCI9XCIsc2VsZWN0OlwiJlwifSxyZXBsYWNlOiEwLHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvdHlwZWFoZWFkL3R5cGVhaGVhZC1wb3B1cC5odG1sXCIsbGluazpmdW5jdGlvbihhLGIsYyl7YS50ZW1wbGF0ZVVybD1jLnRlbXBsYXRlVXJsLGEuaXNPcGVuPWZ1bmN0aW9uKCl7cmV0dXJuIGEubWF0Y2hlcy5sZW5ndGg+MH0sYS5pc0FjdGl2ZT1mdW5jdGlvbihiKXtyZXR1cm4gYS5hY3RpdmU9PWJ9LGEuc2VsZWN0QWN0aXZlPWZ1bmN0aW9uKGIpe2EuYWN0aXZlPWJ9LGEuc2VsZWN0TWF0Y2g9ZnVuY3Rpb24oYil7YS5zZWxlY3Qoe2FjdGl2ZUlkeDpifSl9fX19KS5kaXJlY3RpdmUoXCJ0eXBlYWhlYWRNYXRjaFwiLFtcIiRodHRwXCIsXCIkdGVtcGxhdGVDYWNoZVwiLFwiJGNvbXBpbGVcIixcIiRwYXJzZVwiLGZ1bmN0aW9uKGEsYixjLGQpe3JldHVybntyZXN0cmljdDpcIkVBXCIsc2NvcGU6e2luZGV4OlwiPVwiLG1hdGNoOlwiPVwiLHF1ZXJ5OlwiPVwifSxsaW5rOmZ1bmN0aW9uKGUsZixnKXt2YXIgaD1kKGcudGVtcGxhdGVVcmwpKGUuJHBhcmVudCl8fFwidGVtcGxhdGUvdHlwZWFoZWFkL3R5cGVhaGVhZC1tYXRjaC5odG1sXCI7YS5nZXQoaCx7Y2FjaGU6Yn0pLnN1Y2Nlc3MoZnVuY3Rpb24oYSl7Zi5yZXBsYWNlV2l0aChjKGEudHJpbSgpKShlKSl9KX19fV0pLmZpbHRlcihcInR5cGVhaGVhZEhpZ2hsaWdodFwiLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXtyZXR1cm4gYS5yZXBsYWNlKC8oWy4/KiteJFtcXF1cXFxcKCl7fXwtXSkvZyxcIlxcXFwkMVwiKX1yZXR1cm4gZnVuY3Rpb24oYixjKXtyZXR1cm4gYz8oXCJcIitiKS5yZXBsYWNlKG5ldyBSZWdFeHAoYShjKSxcImdpXCIpLFwiPHN0cm9uZz4kJjwvc3Ryb25nPlwiKTpifX0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvYWNjb3JkaW9uL2FjY29yZGlvbi1ncm91cC5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvYWNjb3JkaW9uL2FjY29yZGlvbi1ncm91cC5odG1sXCIsJzxkaXYgY2xhc3M9XCJwYW5lbCBwYW5lbC1kZWZhdWx0XCI+XFxuICA8ZGl2IGNsYXNzPVwicGFuZWwtaGVhZGluZ1wiPlxcbiAgICA8aDQgY2xhc3M9XCJwYW5lbC10aXRsZVwiPlxcbiAgICAgIDxhIGNsYXNzPVwiYWNjb3JkaW9uLXRvZ2dsZVwiIG5nLWNsaWNrPVwidG9nZ2xlT3BlbigpXCIgYWNjb3JkaW9uLXRyYW5zY2x1ZGU9XCJoZWFkaW5nXCI+PHNwYW4gbmctY2xhc3M9XCJ7XFwndGV4dC1tdXRlZFxcJzogaXNEaXNhYmxlZH1cIj57e2hlYWRpbmd9fTwvc3Bhbj48L2E+XFxuICAgIDwvaDQ+XFxuICA8L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XCJwYW5lbC1jb2xsYXBzZVwiIGNvbGxhcHNlPVwiIWlzT3BlblwiPlxcblx0ICA8ZGl2IGNsYXNzPVwicGFuZWwtYm9keVwiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+XFxuICA8L2Rpdj5cXG48L2Rpdj4nKX1dKSxhbmd1bGFyLm1vZHVsZShcInRlbXBsYXRlL2FjY29yZGlvbi9hY2NvcmRpb24uaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL2FjY29yZGlvbi9hY2NvcmRpb24uaHRtbFwiLCc8ZGl2IGNsYXNzPVwicGFuZWwtZ3JvdXBcIiBuZy10cmFuc2NsdWRlPjwvZGl2PicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvYWxlcnQvYWxlcnQuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL2FsZXJ0L2FsZXJ0Lmh0bWxcIiwnPGRpdiBjbGFzcz1cImFsZXJ0XCIgbmctY2xhc3M9XCJbXFwnYWxlcnQtXFwnICsgKHR5cGUgfHwgXFwnd2FybmluZ1xcJyksIGNsb3NlYWJsZSA/IFxcJ2FsZXJ0LWRpc21pc3NhYmxlXFwnIDogbnVsbF1cIiByb2xlPVwiYWxlcnRcIj5cXG4gICAgPGJ1dHRvbiBuZy1zaG93PVwiY2xvc2VhYmxlXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiY2xvc2VcIiBuZy1jbGljaz1cImNsb3NlKClcIj5cXG4gICAgICAgIDxzcGFuIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPiZ0aW1lczs8L3NwYW4+XFxuICAgICAgICA8c3BhbiBjbGFzcz1cInNyLW9ubHlcIj5DbG9zZTwvc3Bhbj5cXG4gICAgPC9idXR0b24+XFxuICAgIDxkaXYgbmctdHJhbnNjbHVkZT48L2Rpdj5cXG48L2Rpdj5cXG4nKX1dKSxhbmd1bGFyLm1vZHVsZShcInRlbXBsYXRlL2Nhcm91c2VsL2Nhcm91c2VsLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS9jYXJvdXNlbC9jYXJvdXNlbC5odG1sXCIsJzxkaXYgbmctbW91c2VlbnRlcj1cInBhdXNlKClcIiBuZy1tb3VzZWxlYXZlPVwicGxheSgpXCIgY2xhc3M9XCJjYXJvdXNlbFwiIG5nLXN3aXBlLXJpZ2h0PVwicHJldigpXCIgbmctc3dpcGUtbGVmdD1cIm5leHQoKVwiPlxcbiAgICA8b2wgY2xhc3M9XCJjYXJvdXNlbC1pbmRpY2F0b3JzXCIgbmctc2hvdz1cInNsaWRlcy5sZW5ndGggPiAxXCI+XFxuICAgICAgICA8bGkgbmctcmVwZWF0PVwic2xpZGUgaW4gc2xpZGVzIHRyYWNrIGJ5ICRpbmRleFwiIG5nLWNsYXNzPVwie2FjdGl2ZTogaXNBY3RpdmUoc2xpZGUpfVwiIG5nLWNsaWNrPVwic2VsZWN0KHNsaWRlKVwiPjwvbGk+XFxuICAgIDwvb2w+XFxuICAgIDxkaXYgY2xhc3M9XCJjYXJvdXNlbC1pbm5lclwiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+XFxuICAgIDxhIGNsYXNzPVwibGVmdCBjYXJvdXNlbC1jb250cm9sXCIgbmctY2xpY2s9XCJwcmV2KClcIiBuZy1zaG93PVwic2xpZGVzLmxlbmd0aCA+IDFcIj48c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tY2hldnJvbi1sZWZ0XCI+PC9zcGFuPjwvYT5cXG4gICAgPGEgY2xhc3M9XCJyaWdodCBjYXJvdXNlbC1jb250cm9sXCIgbmctY2xpY2s9XCJuZXh0KClcIiBuZy1zaG93PVwic2xpZGVzLmxlbmd0aCA+IDFcIj48c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tY2hldnJvbi1yaWdodFwiPjwvc3Bhbj48L2E+XFxuPC9kaXY+XFxuJyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS9jYXJvdXNlbC9zbGlkZS5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvY2Fyb3VzZWwvc2xpZGUuaHRtbFwiLFwiPGRpdiBuZy1jbGFzcz1cXFwie1xcbiAgICAnYWN0aXZlJzogbGVhdmluZyB8fCAoYWN0aXZlICYmICFlbnRlcmluZyksXFxuICAgICdwcmV2JzogKG5leHQgfHwgYWN0aXZlKSAmJiBkaXJlY3Rpb249PSdwcmV2JyxcXG4gICAgJ25leHQnOiAobmV4dCB8fCBhY3RpdmUpICYmIGRpcmVjdGlvbj09J25leHQnLFxcbiAgICAncmlnaHQnOiBkaXJlY3Rpb249PSdwcmV2JyxcXG4gICAgJ2xlZnQnOiBkaXJlY3Rpb249PSduZXh0J1xcbiAgfVxcXCIgY2xhc3M9XFxcIml0ZW0gdGV4dC1jZW50ZXJcXFwiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+XFxuXCIpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvZGF0ZXBpY2tlci9kYXRlcGlja2VyLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL2RhdGVwaWNrZXIuaHRtbFwiLCc8ZGl2IG5nLXN3aXRjaD1cImRhdGVwaWNrZXJNb2RlXCIgcm9sZT1cImFwcGxpY2F0aW9uXCIgbmcta2V5ZG93bj1cImtleWRvd24oJGV2ZW50KVwiPlxcbiAgPGRheXBpY2tlciBuZy1zd2l0Y2gtd2hlbj1cImRheVwiIHRhYmluZGV4PVwiMFwiPjwvZGF5cGlja2VyPlxcbiAgPG1vbnRocGlja2VyIG5nLXN3aXRjaC13aGVuPVwibW9udGhcIiB0YWJpbmRleD1cIjBcIj48L21vbnRocGlja2VyPlxcbiAgPHllYXJwaWNrZXIgbmctc3dpdGNoLXdoZW49XCJ5ZWFyXCIgdGFiaW5kZXg9XCIwXCI+PC95ZWFycGlja2VyPlxcbjwvZGl2PicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvZGF0ZXBpY2tlci9kYXkuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL2RhdGVwaWNrZXIvZGF5Lmh0bWxcIiwnPHRhYmxlIHJvbGU9XCJncmlkXCIgYXJpYS1sYWJlbGxlZGJ5PVwie3t1bmlxdWVJZH19LXRpdGxlXCIgYXJpYS1hY3RpdmVkZXNjZW5kYW50PVwie3thY3RpdmVEYXRlSWR9fVwiPlxcbiAgPHRoZWFkPlxcbiAgICA8dHI+XFxuICAgICAgPHRoPjxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbSBwdWxsLWxlZnRcIiBuZy1jbGljaz1cIm1vdmUoLTEpXCIgdGFiaW5kZXg9XCItMVwiPjxpIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1jaGV2cm9uLWxlZnRcIj48L2k+PC9idXR0b24+PC90aD5cXG4gICAgICA8dGggY29sc3Bhbj1cInt7NSArIHNob3dXZWVrc319XCI+PGJ1dHRvbiBpZD1cInt7dW5pcXVlSWR9fS10aXRsZVwiIHJvbGU9XCJoZWFkaW5nXCIgYXJpYS1saXZlPVwiYXNzZXJ0aXZlXCIgYXJpYS1hdG9taWM9XCJ0cnVlXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVwiIG5nLWNsaWNrPVwidG9nZ2xlTW9kZSgpXCIgdGFiaW5kZXg9XCItMVwiIHN0eWxlPVwid2lkdGg6MTAwJTtcIj48c3Ryb25nPnt7dGl0bGV9fTwvc3Ryb25nPjwvYnV0dG9uPjwvdGg+XFxuICAgICAgPHRoPjxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbSBwdWxsLXJpZ2h0XCIgbmctY2xpY2s9XCJtb3ZlKDEpXCIgdGFiaW5kZXg9XCItMVwiPjxpIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1jaGV2cm9uLXJpZ2h0XCI+PC9pPjwvYnV0dG9uPjwvdGg+XFxuICAgIDwvdHI+XFxuICAgIDx0cj5cXG4gICAgICA8dGggbmctc2hvdz1cInNob3dXZWVrc1wiIGNsYXNzPVwidGV4dC1jZW50ZXJcIj48L3RoPlxcbiAgICAgIDx0aCBuZy1yZXBlYXQ9XCJsYWJlbCBpbiBsYWJlbHMgdHJhY2sgYnkgJGluZGV4XCIgY2xhc3M9XCJ0ZXh0LWNlbnRlclwiPjxzbWFsbCBhcmlhLWxhYmVsPVwie3tsYWJlbC5mdWxsfX1cIj57e2xhYmVsLmFiYnJ9fTwvc21hbGw+PC90aD5cXG4gICAgPC90cj5cXG4gIDwvdGhlYWQ+XFxuICA8dGJvZHk+XFxuICAgIDx0ciBuZy1yZXBlYXQ9XCJyb3cgaW4gcm93cyB0cmFjayBieSAkaW5kZXhcIj5cXG4gICAgICA8dGQgbmctc2hvdz1cInNob3dXZWVrc1wiIGNsYXNzPVwidGV4dC1jZW50ZXIgaDZcIj48ZW0+e3sgd2Vla051bWJlcnNbJGluZGV4XSB9fTwvZW0+PC90ZD5cXG4gICAgICA8dGQgbmctcmVwZWF0PVwiZHQgaW4gcm93IHRyYWNrIGJ5IGR0LmRhdGVcIiBjbGFzcz1cInRleHQtY2VudGVyXCIgcm9sZT1cImdyaWRjZWxsXCIgaWQ9XCJ7e2R0LnVpZH19XCIgYXJpYS1kaXNhYmxlZD1cInt7ISFkdC5kaXNhYmxlZH19XCI+XFxuICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBzdHlsZT1cIndpZHRoOjEwMCU7XCIgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXCIgbmctY2xhc3M9XCJ7XFwnYnRuLWluZm9cXCc6IGR0LnNlbGVjdGVkLCBhY3RpdmU6IGlzQWN0aXZlKGR0KX1cIiBuZy1jbGljaz1cInNlbGVjdChkdC5kYXRlKVwiIG5nLWRpc2FibGVkPVwiZHQuZGlzYWJsZWRcIiB0YWJpbmRleD1cIi0xXCI+PHNwYW4gbmctY2xhc3M9XCJ7XFwndGV4dC1tdXRlZFxcJzogZHQuc2Vjb25kYXJ5LCBcXCd0ZXh0LWluZm9cXCc6IGR0LmN1cnJlbnR9XCI+e3tkdC5sYWJlbH19PC9zcGFuPjwvYnV0dG9uPlxcbiAgICAgIDwvdGQ+XFxuICAgIDwvdHI+XFxuICA8L3Rib2R5PlxcbjwvdGFibGU+XFxuJyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL21vbnRoLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL21vbnRoLmh0bWxcIiwnPHRhYmxlIHJvbGU9XCJncmlkXCIgYXJpYS1sYWJlbGxlZGJ5PVwie3t1bmlxdWVJZH19LXRpdGxlXCIgYXJpYS1hY3RpdmVkZXNjZW5kYW50PVwie3thY3RpdmVEYXRlSWR9fVwiPlxcbiAgPHRoZWFkPlxcbiAgICA8dHI+XFxuICAgICAgPHRoPjxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbSBwdWxsLWxlZnRcIiBuZy1jbGljaz1cIm1vdmUoLTEpXCIgdGFiaW5kZXg9XCItMVwiPjxpIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1jaGV2cm9uLWxlZnRcIj48L2k+PC9idXR0b24+PC90aD5cXG4gICAgICA8dGg+PGJ1dHRvbiBpZD1cInt7dW5pcXVlSWR9fS10aXRsZVwiIHJvbGU9XCJoZWFkaW5nXCIgYXJpYS1saXZlPVwiYXNzZXJ0aXZlXCIgYXJpYS1hdG9taWM9XCJ0cnVlXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVwiIG5nLWNsaWNrPVwidG9nZ2xlTW9kZSgpXCIgdGFiaW5kZXg9XCItMVwiIHN0eWxlPVwid2lkdGg6MTAwJTtcIj48c3Ryb25nPnt7dGl0bGV9fTwvc3Ryb25nPjwvYnV0dG9uPjwvdGg+XFxuICAgICAgPHRoPjxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbSBwdWxsLXJpZ2h0XCIgbmctY2xpY2s9XCJtb3ZlKDEpXCIgdGFiaW5kZXg9XCItMVwiPjxpIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1jaGV2cm9uLXJpZ2h0XCI+PC9pPjwvYnV0dG9uPjwvdGg+XFxuICAgIDwvdHI+XFxuICA8L3RoZWFkPlxcbiAgPHRib2R5PlxcbiAgICA8dHIgbmctcmVwZWF0PVwicm93IGluIHJvd3MgdHJhY2sgYnkgJGluZGV4XCI+XFxuICAgICAgPHRkIG5nLXJlcGVhdD1cImR0IGluIHJvdyB0cmFjayBieSBkdC5kYXRlXCIgY2xhc3M9XCJ0ZXh0LWNlbnRlclwiIHJvbGU9XCJncmlkY2VsbFwiIGlkPVwie3tkdC51aWR9fVwiIGFyaWEtZGlzYWJsZWQ9XCJ7eyEhZHQuZGlzYWJsZWR9fVwiPlxcbiAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgc3R5bGU9XCJ3aWR0aDoxMDAlO1wiIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0XCIgbmctY2xhc3M9XCJ7XFwnYnRuLWluZm9cXCc6IGR0LnNlbGVjdGVkLCBhY3RpdmU6IGlzQWN0aXZlKGR0KX1cIiBuZy1jbGljaz1cInNlbGVjdChkdC5kYXRlKVwiIG5nLWRpc2FibGVkPVwiZHQuZGlzYWJsZWRcIiB0YWJpbmRleD1cIi0xXCI+PHNwYW4gbmctY2xhc3M9XCJ7XFwndGV4dC1pbmZvXFwnOiBkdC5jdXJyZW50fVwiPnt7ZHQubGFiZWx9fTwvc3Bhbj48L2J1dHRvbj5cXG4gICAgICA8L3RkPlxcbiAgICA8L3RyPlxcbiAgPC90Ym9keT5cXG48L3RhYmxlPlxcbicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvZGF0ZXBpY2tlci9wb3B1cC5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvZGF0ZXBpY2tlci9wb3B1cC5odG1sXCIsJzx1bCBjbGFzcz1cImRyb3Bkb3duLW1lbnVcIiBuZy1zdHlsZT1cIntkaXNwbGF5OiAoaXNPcGVuICYmIFxcJ2Jsb2NrXFwnKSB8fCBcXCdub25lXFwnLCB0b3A6IHBvc2l0aW9uLnRvcCtcXCdweFxcJywgbGVmdDogcG9zaXRpb24ubGVmdCtcXCdweFxcJ31cIiBuZy1rZXlkb3duPVwia2V5ZG93bigkZXZlbnQpXCI+XFxuXHQ8bGkgbmctdHJhbnNjbHVkZT48L2xpPlxcblx0PGxpIG5nLWlmPVwic2hvd0J1dHRvbkJhclwiIHN0eWxlPVwicGFkZGluZzoxMHB4IDlweCAycHhcIj5cXG5cdFx0PHNwYW4gY2xhc3M9XCJidG4tZ3JvdXBcIj5cXG5cdFx0XHQ8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tc20gYnRuLWluZm9cIiBuZy1jbGljaz1cInNlbGVjdChcXCd0b2RheVxcJylcIj57eyBnZXRUZXh0KFxcJ2N1cnJlbnRcXCcpIH19PC9idXR0b24+XFxuXHRcdFx0PGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXNtIGJ0bi1kYW5nZXJcIiBuZy1jbGljaz1cInNlbGVjdChudWxsKVwiPnt7IGdldFRleHQoXFwnY2xlYXJcXCcpIH19PC9idXR0b24+XFxuXHRcdDwvc3Bhbj5cXG5cdFx0PGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXNtIGJ0bi1zdWNjZXNzIHB1bGwtcmlnaHRcIiBuZy1jbGljaz1cImNsb3NlKClcIj57eyBnZXRUZXh0KFxcJ2Nsb3NlXFwnKSB9fTwvYnV0dG9uPlxcblx0PC9saT5cXG48L3VsPlxcbicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvZGF0ZXBpY2tlci95ZWFyLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL3llYXIuaHRtbFwiLCc8dGFibGUgcm9sZT1cImdyaWRcIiBhcmlhLWxhYmVsbGVkYnk9XCJ7e3VuaXF1ZUlkfX0tdGl0bGVcIiBhcmlhLWFjdGl2ZWRlc2NlbmRhbnQ9XCJ7e2FjdGl2ZURhdGVJZH19XCI+XFxuICA8dGhlYWQ+XFxuICAgIDx0cj5cXG4gICAgICA8dGg+PGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtIHB1bGwtbGVmdFwiIG5nLWNsaWNrPVwibW92ZSgtMSlcIiB0YWJpbmRleD1cIi0xXCI+PGkgY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLWNoZXZyb24tbGVmdFwiPjwvaT48L2J1dHRvbj48L3RoPlxcbiAgICAgIDx0aCBjb2xzcGFuPVwiM1wiPjxidXR0b24gaWQ9XCJ7e3VuaXF1ZUlkfX0tdGl0bGVcIiByb2xlPVwiaGVhZGluZ1wiIGFyaWEtbGl2ZT1cImFzc2VydGl2ZVwiIGFyaWEtYXRvbWljPVwidHJ1ZVwiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBidG4tc21cIiBuZy1jbGljaz1cInRvZ2dsZU1vZGUoKVwiIHRhYmluZGV4PVwiLTFcIiBzdHlsZT1cIndpZHRoOjEwMCU7XCI+PHN0cm9uZz57e3RpdGxlfX08L3N0cm9uZz48L2J1dHRvbj48L3RoPlxcbiAgICAgIDx0aD48YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBidG4tc20gcHVsbC1yaWdodFwiIG5nLWNsaWNrPVwibW92ZSgxKVwiIHRhYmluZGV4PVwiLTFcIj48aSBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tY2hldnJvbi1yaWdodFwiPjwvaT48L2J1dHRvbj48L3RoPlxcbiAgICA8L3RyPlxcbiAgPC90aGVhZD5cXG4gIDx0Ym9keT5cXG4gICAgPHRyIG5nLXJlcGVhdD1cInJvdyBpbiByb3dzIHRyYWNrIGJ5ICRpbmRleFwiPlxcbiAgICAgIDx0ZCBuZy1yZXBlYXQ9XCJkdCBpbiByb3cgdHJhY2sgYnkgZHQuZGF0ZVwiIGNsYXNzPVwidGV4dC1jZW50ZXJcIiByb2xlPVwiZ3JpZGNlbGxcIiBpZD1cInt7ZHQudWlkfX1cIiBhcmlhLWRpc2FibGVkPVwie3shIWR0LmRpc2FibGVkfX1cIj5cXG4gICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIHN0eWxlPVwid2lkdGg6MTAwJTtcIiBjbGFzcz1cImJ0biBidG4tZGVmYXVsdFwiIG5nLWNsYXNzPVwie1xcJ2J0bi1pbmZvXFwnOiBkdC5zZWxlY3RlZCwgYWN0aXZlOiBpc0FjdGl2ZShkdCl9XCIgbmctY2xpY2s9XCJzZWxlY3QoZHQuZGF0ZSlcIiBuZy1kaXNhYmxlZD1cImR0LmRpc2FibGVkXCIgdGFiaW5kZXg9XCItMVwiPjxzcGFuIG5nLWNsYXNzPVwie1xcJ3RleHQtaW5mb1xcJzogZHQuY3VycmVudH1cIj57e2R0LmxhYmVsfX08L3NwYW4+PC9idXR0b24+XFxuICAgICAgPC90ZD5cXG4gICAgPC90cj5cXG4gIDwvdGJvZHk+XFxuPC90YWJsZT5cXG4nKX1dKSxhbmd1bGFyLm1vZHVsZShcInRlbXBsYXRlL21vZGFsL2JhY2tkcm9wLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS9tb2RhbC9iYWNrZHJvcC5odG1sXCIsJzxkaXYgY2xhc3M9XCJtb2RhbC1iYWNrZHJvcCBmYWRlIHt7IGJhY2tkcm9wQ2xhc3MgfX1cIlxcbiAgICAgbmctY2xhc3M9XCJ7aW46IGFuaW1hdGV9XCJcXG4gICAgIG5nLXN0eWxlPVwie1xcJ3otaW5kZXhcXCc6IDEwNDAgKyAoaW5kZXggJiYgMSB8fCAwKSArIGluZGV4KjEwfVwiXFxuPjwvZGl2PlxcbicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvbW9kYWwvd2luZG93Lmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS9tb2RhbC93aW5kb3cuaHRtbFwiLCc8ZGl2IHRhYmluZGV4PVwiLTFcIiByb2xlPVwiZGlhbG9nXCIgY2xhc3M9XCJtb2RhbCBmYWRlXCIgbmctY2xhc3M9XCJ7aW46IGFuaW1hdGV9XCIgbmctc3R5bGU9XCJ7XFwnei1pbmRleFxcJzogMTA1MCArIGluZGV4KjEwLCBkaXNwbGF5OiBcXCdibG9ja1xcJ31cIiBuZy1jbGljaz1cImNsb3NlKCRldmVudClcIj5cXG4gICAgPGRpdiBjbGFzcz1cIm1vZGFsLWRpYWxvZ1wiIG5nLWNsYXNzPVwie1xcJ21vZGFsLXNtXFwnOiBzaXplID09IFxcJ3NtXFwnLCBcXCdtb2RhbC1sZ1xcJzogc2l6ZSA9PSBcXCdsZ1xcJ31cIj48ZGl2IGNsYXNzPVwibW9kYWwtY29udGVudFwiIG1vZGFsLXRyYW5zY2x1ZGU+PC9kaXY+PC9kaXY+XFxuPC9kaXY+Jyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS9wYWdpbmF0aW9uL3BhZ2VyLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS9wYWdpbmF0aW9uL3BhZ2VyLmh0bWxcIiwnPHVsIGNsYXNzPVwicGFnZXJcIj5cXG4gIDxsaSBuZy1jbGFzcz1cIntkaXNhYmxlZDogbm9QcmV2aW91cygpLCBwcmV2aW91czogYWxpZ259XCI+PGEgaHJlZiBuZy1jbGljaz1cInNlbGVjdFBhZ2UocGFnZSAtIDEpXCI+e3tnZXRUZXh0KFxcJ3ByZXZpb3VzXFwnKX19PC9hPjwvbGk+XFxuICA8bGkgbmctY2xhc3M9XCJ7ZGlzYWJsZWQ6IG5vTmV4dCgpLCBuZXh0OiBhbGlnbn1cIj48YSBocmVmIG5nLWNsaWNrPVwic2VsZWN0UGFnZShwYWdlICsgMSlcIj57e2dldFRleHQoXFwnbmV4dFxcJyl9fTwvYT48L2xpPlxcbjwvdWw+Jyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS9wYWdpbmF0aW9uL3BhZ2luYXRpb24uaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL3BhZ2luYXRpb24vcGFnaW5hdGlvbi5odG1sXCIsJzx1bCBjbGFzcz1cInBhZ2luYXRpb25cIj5cXG4gIDxsaSBuZy1pZj1cImJvdW5kYXJ5TGlua3NcIiBuZy1jbGFzcz1cIntkaXNhYmxlZDogbm9QcmV2aW91cygpfVwiPjxhIGhyZWYgbmctY2xpY2s9XCJzZWxlY3RQYWdlKDEpXCI+e3tnZXRUZXh0KFxcJ2ZpcnN0XFwnKX19PC9hPjwvbGk+XFxuICA8bGkgbmctaWY9XCJkaXJlY3Rpb25MaW5rc1wiIG5nLWNsYXNzPVwie2Rpc2FibGVkOiBub1ByZXZpb3VzKCl9XCI+PGEgaHJlZiBuZy1jbGljaz1cInNlbGVjdFBhZ2UocGFnZSAtIDEpXCI+e3tnZXRUZXh0KFxcJ3ByZXZpb3VzXFwnKX19PC9hPjwvbGk+XFxuICA8bGkgbmctcmVwZWF0PVwicGFnZSBpbiBwYWdlcyB0cmFjayBieSAkaW5kZXhcIiBuZy1jbGFzcz1cInthY3RpdmU6IHBhZ2UuYWN0aXZlfVwiPjxhIGhyZWYgbmctY2xpY2s9XCJzZWxlY3RQYWdlKHBhZ2UubnVtYmVyKVwiPnt7cGFnZS50ZXh0fX08L2E+PC9saT5cXG4gIDxsaSBuZy1pZj1cImRpcmVjdGlvbkxpbmtzXCIgbmctY2xhc3M9XCJ7ZGlzYWJsZWQ6IG5vTmV4dCgpfVwiPjxhIGhyZWYgbmctY2xpY2s9XCJzZWxlY3RQYWdlKHBhZ2UgKyAxKVwiPnt7Z2V0VGV4dChcXCduZXh0XFwnKX19PC9hPjwvbGk+XFxuICA8bGkgbmctaWY9XCJib3VuZGFyeUxpbmtzXCIgbmctY2xhc3M9XCJ7ZGlzYWJsZWQ6IG5vTmV4dCgpfVwiPjxhIGhyZWYgbmctY2xpY2s9XCJzZWxlY3RQYWdlKHRvdGFsUGFnZXMpXCI+e3tnZXRUZXh0KFxcJ2xhc3RcXCcpfX08L2E+PC9saT5cXG48L3VsPicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvdG9vbHRpcC90b29sdGlwLWh0bWwtdW5zYWZlLXBvcHVwLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS90b29sdGlwL3Rvb2x0aXAtaHRtbC11bnNhZmUtcG9wdXAuaHRtbFwiLCc8ZGl2IGNsYXNzPVwidG9vbHRpcCB7e3BsYWNlbWVudH19XCIgbmctY2xhc3M9XCJ7IGluOiBpc09wZW4oKSwgZmFkZTogYW5pbWF0aW9uKCkgfVwiPlxcbiAgPGRpdiBjbGFzcz1cInRvb2x0aXAtYXJyb3dcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XCJ0b29sdGlwLWlubmVyXCIgYmluZC1odG1sLXVuc2FmZT1cImNvbnRlbnRcIj48L2Rpdj5cXG48L2Rpdj5cXG4nKX1dKSxhbmd1bGFyLm1vZHVsZShcInRlbXBsYXRlL3Rvb2x0aXAvdG9vbHRpcC1wb3B1cC5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvdG9vbHRpcC90b29sdGlwLXBvcHVwLmh0bWxcIiwnPGRpdiBjbGFzcz1cInRvb2x0aXAge3twbGFjZW1lbnR9fVwiIG5nLWNsYXNzPVwieyBpbjogaXNPcGVuKCksIGZhZGU6IGFuaW1hdGlvbigpIH1cIj5cXG4gIDxkaXYgY2xhc3M9XCJ0b29sdGlwLWFycm93XCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVwidG9vbHRpcC1pbm5lclwiIG5nLWJpbmQ9XCJjb250ZW50XCI+PC9kaXY+XFxuPC9kaXY+XFxuJyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS9wb3BvdmVyL3BvcG92ZXIuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL3BvcG92ZXIvcG9wb3Zlci5odG1sXCIsJzxkaXYgY2xhc3M9XCJwb3BvdmVyIHt7cGxhY2VtZW50fX1cIiBuZy1jbGFzcz1cInsgaW46IGlzT3BlbigpLCBmYWRlOiBhbmltYXRpb24oKSB9XCI+XFxuICA8ZGl2IGNsYXNzPVwiYXJyb3dcIj48L2Rpdj5cXG5cXG4gIDxkaXYgY2xhc3M9XCJwb3BvdmVyLWlubmVyXCI+XFxuICAgICAgPGgzIGNsYXNzPVwicG9wb3Zlci10aXRsZVwiIG5nLWJpbmQ9XCJ0aXRsZVwiIG5nLXNob3c9XCJ0aXRsZVwiPjwvaDM+XFxuICAgICAgPGRpdiBjbGFzcz1cInBvcG92ZXItY29udGVudFwiIG5nLWJpbmQ9XCJjb250ZW50XCI+PC9kaXY+XFxuICA8L2Rpdj5cXG48L2Rpdj5cXG4nKX1dKSxhbmd1bGFyLm1vZHVsZShcInRlbXBsYXRlL3Byb2dyZXNzYmFyL2Jhci5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvcHJvZ3Jlc3NiYXIvYmFyLmh0bWxcIiwnPGRpdiBjbGFzcz1cInByb2dyZXNzLWJhclwiIG5nLWNsYXNzPVwidHlwZSAmJiBcXCdwcm9ncmVzcy1iYXItXFwnICsgdHlwZVwiIHJvbGU9XCJwcm9ncmVzc2JhclwiIGFyaWEtdmFsdWVub3c9XCJ7e3ZhbHVlfX1cIiBhcmlhLXZhbHVlbWluPVwiMFwiIGFyaWEtdmFsdWVtYXg9XCJ7e21heH19XCIgbmctc3R5bGU9XCJ7d2lkdGg6IHBlcmNlbnQgKyBcXCclXFwnfVwiIGFyaWEtdmFsdWV0ZXh0PVwie3twZXJjZW50IHwgbnVtYmVyOjB9fSVcIiBuZy10cmFuc2NsdWRlPjwvZGl2PicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvcHJvZ3Jlc3NiYXIvcHJvZ3Jlc3MuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL3Byb2dyZXNzYmFyL3Byb2dyZXNzLmh0bWxcIiwnPGRpdiBjbGFzcz1cInByb2dyZXNzXCIgbmctdHJhbnNjbHVkZT48L2Rpdj4nKX1dKSxhbmd1bGFyLm1vZHVsZShcInRlbXBsYXRlL3Byb2dyZXNzYmFyL3Byb2dyZXNzYmFyLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS9wcm9ncmVzc2Jhci9wcm9ncmVzc2Jhci5odG1sXCIsJzxkaXYgY2xhc3M9XCJwcm9ncmVzc1wiPlxcbiAgPGRpdiBjbGFzcz1cInByb2dyZXNzLWJhclwiIG5nLWNsYXNzPVwidHlwZSAmJiBcXCdwcm9ncmVzcy1iYXItXFwnICsgdHlwZVwiIHJvbGU9XCJwcm9ncmVzc2JhclwiIGFyaWEtdmFsdWVub3c9XCJ7e3ZhbHVlfX1cIiBhcmlhLXZhbHVlbWluPVwiMFwiIGFyaWEtdmFsdWVtYXg9XCJ7e21heH19XCIgbmctc3R5bGU9XCJ7d2lkdGg6IHBlcmNlbnQgKyBcXCclXFwnfVwiIGFyaWEtdmFsdWV0ZXh0PVwie3twZXJjZW50IHwgbnVtYmVyOjB9fSVcIiBuZy10cmFuc2NsdWRlPjwvZGl2PlxcbjwvZGl2PicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvcmF0aW5nL3JhdGluZy5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvcmF0aW5nL3JhdGluZy5odG1sXCIsJzxzcGFuIG5nLW1vdXNlbGVhdmU9XCJyZXNldCgpXCIgbmcta2V5ZG93bj1cIm9uS2V5ZG93bigkZXZlbnQpXCIgdGFiaW5kZXg9XCIwXCIgcm9sZT1cInNsaWRlclwiIGFyaWEtdmFsdWVtaW49XCIwXCIgYXJpYS12YWx1ZW1heD1cInt7cmFuZ2UubGVuZ3RofX1cIiBhcmlhLXZhbHVlbm93PVwie3t2YWx1ZX19XCI+XFxuICAgIDxpIG5nLXJlcGVhdD1cInIgaW4gcmFuZ2UgdHJhY2sgYnkgJGluZGV4XCIgbmctbW91c2VlbnRlcj1cImVudGVyKCRpbmRleCArIDEpXCIgbmctY2xpY2s9XCJyYXRlKCRpbmRleCArIDEpXCIgY2xhc3M9XCJnbHlwaGljb25cIiBuZy1jbGFzcz1cIiRpbmRleCA8IHZhbHVlICYmIChyLnN0YXRlT24gfHwgXFwnZ2x5cGhpY29uLXN0YXJcXCcpIHx8IChyLnN0YXRlT2ZmIHx8IFxcJ2dseXBoaWNvbi1zdGFyLWVtcHR5XFwnKVwiPlxcbiAgICAgICAgPHNwYW4gY2xhc3M9XCJzci1vbmx5XCI+KHt7ICRpbmRleCA8IHZhbHVlID8gXFwnKlxcJyA6IFxcJyBcXCcgfX0pPC9zcGFuPlxcbiAgICA8L2k+XFxuPC9zcGFuPicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvdGFicy90YWIuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL3RhYnMvdGFiLmh0bWxcIiwnPGxpIG5nLWNsYXNzPVwie2FjdGl2ZTogYWN0aXZlLCBkaXNhYmxlZDogZGlzYWJsZWR9XCI+XFxuICA8YSBuZy1jbGljaz1cInNlbGVjdCgpXCIgdGFiLWhlYWRpbmctdHJhbnNjbHVkZT57e2hlYWRpbmd9fTwvYT5cXG48L2xpPlxcbicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvdGFicy90YWJzZXQuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL3RhYnMvdGFic2V0Lmh0bWxcIiwnPGRpdj5cXG4gIDx1bCBjbGFzcz1cIm5hdiBuYXYte3t0eXBlIHx8IFxcJ3RhYnNcXCd9fVwiIG5nLWNsYXNzPVwie1xcJ25hdi1zdGFja2VkXFwnOiB2ZXJ0aWNhbCwgXFwnbmF2LWp1c3RpZmllZFxcJzoganVzdGlmaWVkfVwiIG5nLXRyYW5zY2x1ZGU+PC91bD5cXG4gIDxkaXYgY2xhc3M9XCJ0YWItY29udGVudFwiPlxcbiAgICA8ZGl2IGNsYXNzPVwidGFiLXBhbmVcIiBcXG4gICAgICAgICBuZy1yZXBlYXQ9XCJ0YWIgaW4gdGFic1wiIFxcbiAgICAgICAgIG5nLWNsYXNzPVwie2FjdGl2ZTogdGFiLmFjdGl2ZX1cIlxcbiAgICAgICAgIHRhYi1jb250ZW50LXRyYW5zY2x1ZGU9XCJ0YWJcIj5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj5cXG48L2Rpdj5cXG4nKX1dKSxhbmd1bGFyLm1vZHVsZShcInRlbXBsYXRlL3RpbWVwaWNrZXIvdGltZXBpY2tlci5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvdGltZXBpY2tlci90aW1lcGlja2VyLmh0bWxcIiwnPHRhYmxlPlxcblx0PHRib2R5Plxcblx0XHQ8dHIgY2xhc3M9XCJ0ZXh0LWNlbnRlclwiPlxcblx0XHRcdDx0ZD48YSBuZy1jbGljaz1cImluY3JlbWVudEhvdXJzKClcIiBjbGFzcz1cImJ0biBidG4tbGlua1wiPjxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1jaGV2cm9uLXVwXCI+PC9zcGFuPjwvYT48L3RkPlxcblx0XHRcdDx0ZD4mbmJzcDs8L3RkPlxcblx0XHRcdDx0ZD48YSBuZy1jbGljaz1cImluY3JlbWVudE1pbnV0ZXMoKVwiIGNsYXNzPVwiYnRuIGJ0bi1saW5rXCI+PHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLWNoZXZyb24tdXBcIj48L3NwYW4+PC9hPjwvdGQ+XFxuXHRcdFx0PHRkIG5nLXNob3c9XCJzaG93TWVyaWRpYW5cIj48L3RkPlxcblx0XHQ8L3RyPlxcblx0XHQ8dHI+XFxuXHRcdFx0PHRkIHN0eWxlPVwid2lkdGg6NTBweDtcIiBjbGFzcz1cImZvcm0tZ3JvdXBcIiBuZy1jbGFzcz1cIntcXCdoYXMtZXJyb3JcXCc6IGludmFsaWRIb3Vyc31cIj5cXG5cdFx0XHRcdDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwiaG91cnNcIiBuZy1jaGFuZ2U9XCJ1cGRhdGVIb3VycygpXCIgY2xhc3M9XCJmb3JtLWNvbnRyb2wgdGV4dC1jZW50ZXJcIiBuZy1tb3VzZXdoZWVsPVwiaW5jcmVtZW50SG91cnMoKVwiIG5nLXJlYWRvbmx5PVwicmVhZG9ubHlJbnB1dFwiIG1heGxlbmd0aD1cIjJcIj5cXG5cdFx0XHQ8L3RkPlxcblx0XHRcdDx0ZD46PC90ZD5cXG5cdFx0XHQ8dGQgc3R5bGU9XCJ3aWR0aDo1MHB4O1wiIGNsYXNzPVwiZm9ybS1ncm91cFwiIG5nLWNsYXNzPVwie1xcJ2hhcy1lcnJvclxcJzogaW52YWxpZE1pbnV0ZXN9XCI+XFxuXHRcdFx0XHQ8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cIm1pbnV0ZXNcIiBuZy1jaGFuZ2U9XCJ1cGRhdGVNaW51dGVzKClcIiBjbGFzcz1cImZvcm0tY29udHJvbCB0ZXh0LWNlbnRlclwiIG5nLXJlYWRvbmx5PVwicmVhZG9ubHlJbnB1dFwiIG1heGxlbmd0aD1cIjJcIj5cXG5cdFx0XHQ8L3RkPlxcblx0XHRcdDx0ZCBuZy1zaG93PVwic2hvd01lcmlkaWFuXCI+PGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgdGV4dC1jZW50ZXJcIiBuZy1jbGljaz1cInRvZ2dsZU1lcmlkaWFuKClcIj57e21lcmlkaWFufX08L2J1dHRvbj48L3RkPlxcblx0XHQ8L3RyPlxcblx0XHQ8dHIgY2xhc3M9XCJ0ZXh0LWNlbnRlclwiPlxcblx0XHRcdDx0ZD48YSBuZy1jbGljaz1cImRlY3JlbWVudEhvdXJzKClcIiBjbGFzcz1cImJ0biBidG4tbGlua1wiPjxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1jaGV2cm9uLWRvd25cIj48L3NwYW4+PC9hPjwvdGQ+XFxuXHRcdFx0PHRkPiZuYnNwOzwvdGQ+XFxuXHRcdFx0PHRkPjxhIG5nLWNsaWNrPVwiZGVjcmVtZW50TWludXRlcygpXCIgY2xhc3M9XCJidG4gYnRuLWxpbmtcIj48c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tY2hldnJvbi1kb3duXCI+PC9zcGFuPjwvYT48L3RkPlxcblx0XHRcdDx0ZCBuZy1zaG93PVwic2hvd01lcmlkaWFuXCI+PC90ZD5cXG5cdFx0PC90cj5cXG5cdDwvdGJvZHk+XFxuPC90YWJsZT5cXG4nKX1dKSxhbmd1bGFyLm1vZHVsZShcInRlbXBsYXRlL3R5cGVhaGVhZC90eXBlYWhlYWQtbWF0Y2guaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL3R5cGVhaGVhZC90eXBlYWhlYWQtbWF0Y2guaHRtbFwiLCc8YSB0YWJpbmRleD1cIi0xXCIgYmluZC1odG1sLXVuc2FmZT1cIm1hdGNoLmxhYmVsIHwgdHlwZWFoZWFkSGlnaGxpZ2h0OnF1ZXJ5XCI+PC9hPicpXG59XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS90eXBlYWhlYWQvdHlwZWFoZWFkLXBvcHVwLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS90eXBlYWhlYWQvdHlwZWFoZWFkLXBvcHVwLmh0bWxcIiwnPHVsIGNsYXNzPVwiZHJvcGRvd24tbWVudVwiIG5nLXNob3c9XCJpc09wZW4oKVwiIG5nLXN0eWxlPVwie3RvcDogcG9zaXRpb24udG9wK1xcJ3B4XFwnLCBsZWZ0OiBwb3NpdGlvbi5sZWZ0K1xcJ3B4XFwnfVwiIHN0eWxlPVwiZGlzcGxheTogYmxvY2s7XCIgcm9sZT1cImxpc3Rib3hcIiBhcmlhLWhpZGRlbj1cInt7IWlzT3BlbigpfX1cIj5cXG4gICAgPGxpIG5nLXJlcGVhdD1cIm1hdGNoIGluIG1hdGNoZXMgdHJhY2sgYnkgJGluZGV4XCIgbmctY2xhc3M9XCJ7YWN0aXZlOiBpc0FjdGl2ZSgkaW5kZXgpIH1cIiBuZy1tb3VzZWVudGVyPVwic2VsZWN0QWN0aXZlKCRpbmRleClcIiBuZy1jbGljaz1cInNlbGVjdE1hdGNoKCRpbmRleClcIiByb2xlPVwib3B0aW9uXCIgaWQ9XCJ7e21hdGNoLmlkfX1cIj5cXG4gICAgICAgIDxkaXYgdHlwZWFoZWFkLW1hdGNoIGluZGV4PVwiJGluZGV4XCIgbWF0Y2g9XCJtYXRjaFwiIHF1ZXJ5PVwicXVlcnlcIiB0ZW1wbGF0ZS11cmw9XCJ0ZW1wbGF0ZVVybFwiPjwvZGl2PlxcbiAgICA8L2xpPlxcbjwvdWw+XFxuJyl9XSk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkga2FzcGVyZW4gb24gMTguMDkuMTQuXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgndWkuaGFuZHNvbnRhYmxlJywgW10pXHJcbiAgICAuc2VydmljZSgnaGFuZHNvbnRhYmxlU3J2YycsIGZ1bmN0aW9uKCkge1xyXG4gICAgfSlcclxuICAgIC5jb250cm9sbGVyKFwiSGFuZHNvbkNvbnRyb2xsZXJcIiwgZnVuY3Rpb24gKCRzY29wZSkge1xyXG5cdFx0LypcclxuXHRcdCRzY29wZS5kYXRhID0gaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5saXN0T2ZQbGFudHM7XHJcblx0XHQkc2NvcGUuZGF0YSA9IFtcclxuXHRcdFx0e1xyXG5cdFx0XHRcdFwiZGVsZXRlXCI6IGZhbHNlLFxyXG5cdFx0XHRcdFwicGxhbnROYW1lXCI6IFwiMVwiLFxyXG5cdFx0XHRcdFwicGxhbnRJZFwiOiBcIlwiLFxyXG5cdFx0XHRcdFwiZXBydHJOYXRpb25hbElkXCI6IFwiXCIsXHJcblx0XHRcdFx0XCJhZGRyZXNzMVwiOiBcIlwiLFxyXG5cdFx0XHRcdFwiYWRkcmVzczJcIjogXCJcIixcclxuXHRcdFx0XHRcImNpdHlcIjogXCJcIixcclxuXHRcdFx0XHRcInJlZ2lvblwiOiBcIlwiLFxyXG5cdFx0XHRcdFwicG9zdGFsQ29kZVwiOiBcIlwiLFxyXG5cdFx0XHRcdFwibG9uZ2l0dWRlXCI6IFwiXCIsXHJcblx0XHRcdFx0XCJsYXRpdHVkZVwiOiBcIlwiXHJcblx0XHRcdH0sXHJcblx0XHRcdHtcclxuXHRcdFx0XHRcImRlbGV0ZVwiOiBmYWxzZSxcclxuXHRcdFx0XHRcInBsYW50TmFtZVwiOiBcIjJcIixcclxuXHRcdFx0XHRcInBsYW50SWRcIjogbnVsbCxcclxuXHRcdFx0XHRcImVwcnRyTmF0aW9uYWxJZFwiOiBudWxsLFxyXG5cdFx0XHRcdFwiYWRkcmVzczFcIjogbnVsbCxcclxuXHRcdFx0XHRcImFkZHJlc3MyXCI6IG51bGwsXHJcblx0XHRcdFx0XCJjaXR5XCI6IG51bGwsXHJcblx0XHRcdFx0XCJyZWdpb25cIjogbnVsbCxcclxuXHRcdFx0XHRcInBvc3RhbENvZGVcIjogbnVsbCxcclxuXHRcdFx0XHRcImxvbmdpdHVkZVwiOiBudWxsLFxyXG5cdFx0XHRcdFwibGF0aXR1ZGVcIjogbnVsbFxyXG5cdFx0XHR9XHJcblx0XHRdO1xyXG5cdFx0Ki9cclxuXHR9KVxyXG5cdC5kaXJlY3RpdmUoJ3VpSGFuZHNvbnRhYmxlJywgZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0cmVzdHJpY3Q6ICdBJyxcclxuXHRcdFx0c2NvcGU6IHtcclxuXHRcdFx0XHRkYXRhOiAnPSdcclxuXHRcdFx0fSxcclxuXHRcdFx0cmVwbGFjZTogdHJ1ZSxcclxuXHRcdFx0bGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtLCBhdHRycykge1xyXG5cdFx0XHRcdGVsZW0uaGFuZHNvbnRhYmxlKHtcclxuXHRcdFx0XHRkYXRhOiBzY29wZS5kYXRhLFxyXG4gICAgICAgICAgICAgICAgY29udGV4dE1lbnU6IHRydWUsXHJcblx0XHRcdFx0cm93SGVhZGVyczogdHJ1ZSxcclxuXHRcdFx0XHRtaW5TcGFyZVJvd3M6IDEsXHJcbiAgICAgICAgICAgICAgICBjb2xIZWFkZXJzOiBbXCJEZWxldGVcIiwgXCJQbGFudCBOYW1lXCIsIFwiUGxhbnQgSWRcIiwgXCJFLVBSVFIgbmF0aW9uYWwgSURcIiwgXCJBZGRyZXNzIDFcIiwgXCJBZGRyZXNzIDJcIiwgXCJDaXR5XCIsIFwiUmVnaW9uXCIsIFwiUG9zdGFsIGNvZGVcIiwgXCJMb25naXR1ZGVcIiwgXCJMYXRpdHVkZVwiXSxcclxuICAgICAgICAgICAgICAgIGNvbHVtbnM6IFtcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IFwiZGVsZXRlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiY2hlY2tib3hcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBcInBsYW50TmFtZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IFwicGxhbnRJZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbnVtZXJpYydcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogXCJlcHJ0ck5hdGlvbmFsSWRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ251bWVyaWMnXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IFwiYWRkcmVzczFcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBcImFkZHJlc3MyXCJcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogXCJjaXR5XCJcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogXCJyZWdpb25cIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBcInBvc3RhbENvZGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ251bWVyaWMnXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IFwibG9uZ2l0dWRlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdudW1lcmljJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiAnMDAwLjAwMCdcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogXCJsYXRpdHVkZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbnVtZXJpYycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogJzAwMC4wMDAnXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHR9KSIsIi8vIE1vZHVsZSB0aGF0IHByb3ZpZGVzIG11bHRpc2VsZWN0IGJveCB0byB3ZWJmb3JtIGZyb20ganNvbi1sZCBmb3JtYXQuXHJcbi8vXHJcbi8vIFVzYWdlIEV4YW1wbGU6XHJcbi8vIDxkaXYgbXVsdGlzZWxlY3QgY2xhc3M9XCJtdWx0aXNlbGVjdFwiIG5hbWU9XCJUeXBlT2ZVc2VcIiBtdWx0aXBsZT1cInRydWVcIlxyXG4vLyAgICAgIG5nLW1vZGVsPVwicm93LlR5cGVPZlVzZVwiXHJcbi8vICAgICAgb3B0aW9ucz1cImFubmV4MUNvbmNlcHRbJ0BpZCddIGFzIGFubmV4MUNvbmNlcHQucHJlZkxhYmVsWzBdWydAdmFsdWUnXSBmb3IgYW5uZXgxQ29uY2VwdCBpbiBjb2RlTGlzdC5MQ1BDb2RlbGlzdHMuQW5uZXgxQWN0aXZpdGllcy5jb25jZXB0c1wiXHJcbi8vICAgICAgY2hhbmdlPVwic2VsZWN0ZWQoKVwiIHJlcXVpcmVkPjwvZGl2PlxyXG4vL1xyXG4vLyBOb3RlISBvcHRpb25zIGluc3RlYWQgb2Ygbmctb3B0aW9ucyBpcyB1c2VkLlxyXG5hbmd1bGFyLm1vZHVsZSgndWkubXVsdGlzZWxlY3QnLCBbXHJcbiAgICAgICAgJ211bHRpc2VsZWN0LnRwbC5odG1sJ1xyXG4gICAgXSlcclxuXHJcbiAgICAvL2Zyb20gYm9vdHN0cmFwLXVpIHR5cGVhaGVhZCBwYXJzZXJcclxuICAgIC5mYWN0b3J5KCdvcHRpb25QYXJzZXInLCBbJyRwYXJzZScsIGZ1bmN0aW9uICgkcGFyc2UpIHtcclxuXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgMDAwMDAxMTEwMDAwMDAwMDAwMDAwMjIyMDAwMDAwMDAwMDAwMDAwMDMzMzMzMzMzMzMzMzMzMzAwMDAwMDAwMDAwNDQwMDBcclxuICAgICAgICB2YXIgVFlQRUFIRUFEX1JFR0VYUCA9IC9eXFxzKiguKj8pKD86XFxzK2FzXFxzKyguKj8pKT9cXHMrZm9yXFxzKyg/OihbXFwkXFx3XVtcXCRcXHdcXGRdKikpXFxzK2luXFxzKyguKikkLztcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcGFyc2U6IGZ1bmN0aW9uIChpbnB1dCkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBtYXRjaCA9IGlucHV0Lm1hdGNoKFRZUEVBSEVBRF9SRUdFWFApLCBtb2RlbE1hcHBlciwgdmlld01hcHBlciwgc291cmNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFtYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJFeHBlY3RlZCB0eXBlYWhlYWQgc3BlY2lmaWNhdGlvbiBpbiBmb3JtIG9mICdfbW9kZWxWYWx1ZV8gKGFzIF9sYWJlbF8pPyBmb3IgX2l0ZW1fIGluIF9jb2xsZWN0aW9uXydcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBidXQgZ290ICdcIiArIGlucHV0ICsgXCInLlwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OYW1lOiBtYXRjaFszXSxcclxuICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICRwYXJzZShtYXRjaFs0XSksXHJcbiAgICAgICAgICAgICAgICAgICAgdmlld01hcHBlcjogJHBhcnNlKG1hdGNoWzJdIHx8IG1hdGNoWzFdKSxcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbE1hcHBlcjogJHBhcnNlKG1hdGNoWzFdKVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XSlcclxuXHJcbiAgICAuZGlyZWN0aXZlKCdtdWx0aXNlbGVjdCcsIFsnJHBhcnNlJywgJyRkb2N1bWVudCcsICckY29tcGlsZScsICckaW50ZXJwb2xhdGUnLCAnb3B0aW9uUGFyc2VyJyxcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gKCRwYXJzZSwgJGRvY3VtZW50LCAkY29tcGlsZSwgJGludGVycG9sYXRlLCBvcHRpb25QYXJzZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHJlc3RyaWN0OiAnQUUnLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxyXG4gICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKG9yaWdpbmFsU2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBtb2RlbEN0cmwpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV4cCA9IGF0dHJzLm9wdGlvbnMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlZFJlc3VsdCA9IG9wdGlvblBhcnNlci5wYXJzZShleHApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc011bHRpcGxlID0gKGF0dHJzLm11bHRpcGxlID09PSBcInRydWVcIikgPyB0cnVlIDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dDaGVja0FsbCA9IChhdHRycy5zaG93Y2hlY2thbGwgPT09IFwidHJ1ZVwiKSA/IHRydWUgOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0ZpbHRlciA9IChhdHRycy5zaG93ZmlsdGVyID09PSBcInRydWVcIikgPyB0cnVlIDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkID0gZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlID0gb3JpZ2luYWxTY29wZS4kbmV3KCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZUhhbmRsZXIgPSBhdHRycy5jaGFuZ2UgfHwgYW5ndWxhci5ub29wO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5ncm91cHMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5oZWFkZXIgPSAnU2VsZWN0JztcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5tdWx0aXBsZSA9IGlzTXVsdGlwbGU7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5zaG93Q2hlY2tBbGwgPSBzaG93Q2hlY2tBbGw7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuc2hvd0ZpbHRlciA9IHNob3dGaWx0ZXI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsU2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvcFVwRWwgPSBhbmd1bGFyLmVsZW1lbnQoJzxtdWx0aXNlbGVjdC1wb3B1cD48L211bHRpc2VsZWN0LXBvcHVwPicpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL3JlcXVpcmVkIHZhbGlkYXRvclxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhdHRycy5yZXF1aXJlZCB8fCBhdHRycy5uZ1JlcXVpcmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cnMuJG9ic2VydmUoJ3JlcXVpcmVkJywgZnVuY3Rpb24obmV3VmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkID0gbmV3VmFsO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL3dhdGNoIGRpc2FibGVkIHN0YXRlXHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRwYXJzZShhdHRycy5kaXNhYmxlZCkob3JpZ2luYWxTY29wZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKG5ld1ZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5kaXNhYmxlZCA9IG5ld1ZhbDtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy93YXRjaCBzaW5nbGUvbXVsdGlwbGUgc3RhdGUgZm9yIGR5bmFtaWNhbGx5IGNoYW5nZSBzaW5nbGUgdG8gbXVsdGlwbGVcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHBhcnNlKGF0dHJzLm11bHRpcGxlKShvcmlnaW5hbFNjb3BlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAobmV3VmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzTXVsdGlwbGUgPSBuZXdWYWwgfHwgZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vd2F0Y2ggb3B0aW9uIGNoYW5nZXMgZm9yIG9wdGlvbnMgdGhhdCBhcmUgcG9wdWxhdGVkIGR5bmFtaWNhbGx5XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlZFJlc3VsdC5zb3VyY2Uob3JpZ2luYWxTY29wZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKG5ld1ZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQobmV3VmFsKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlTW9kZWwoKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCB0cnVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy93YXRjaCBtb2RlbCBjaGFuZ2VcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kZWxDdHJsLiRtb2RlbFZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChuZXdWYWwsIG9sZFZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3doZW4gZGlyZWN0aXZlIGluaXRpYWxpemUsIG5ld1ZhbCB1c3VhbGx5IHVuZGVmaW5lZC4gQWxzbywgaWYgbW9kZWwgdmFsdWUgYWxyZWFkeSBzZXQgaW4gdGhlIGNvbnRyb2xsZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9mb3IgcHJlc2VsZWN0ZWQgbGlzdCB0aGVuIHdlIG5lZWQgdG8gbWFyayBjaGVja2VkIGluIG91ciBzY29wZSBpdGVtLiBCdXQgd2UgZG9uJ3Qgd2FudCB0byBkbyB0aGlzIGV2ZXJ5IHRpbWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9tb2RlbCBjaGFuZ2VzLiBXZSBuZWVkIHRvIGRvIHRoaXMgb25seSBpZiBpdCBpcyBkb25lIG91dHNpZGUgZGlyZWN0aXZlIHNjb3BlLCBmcm9tIGNvbnRyb2xsZXIsIGZvciBleGFtcGxlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQobmV3VmFsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya0NoZWNrZWQobmV3VmFsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRldmFsKGNoYW5nZUhhbmRsZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldEhlYWRlclRleHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxDdHJsLiRzZXRWYWxpZGl0eSgncmVxdWlyZWQnLCBzY29wZS52YWxpZCgpKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCB0cnVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcGFyc2VNb2RlbCgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZ3JvdXBzLmxlbmd0aCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2RlbCA9IHBhcnNlZFJlc3VsdC5zb3VyY2Uob3JpZ2luYWxTY29wZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cEluZGV4ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwSWRJbmRleE1hcCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdEdyb3VwID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRHcm91cC5pdGVtcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZighYW5ndWxhci5pc0RlZmluZWQobW9kZWwpKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1vZGVsLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQobW9kZWxbaV0ubmFycm93ZXIpICYmIG1vZGVsW2ldLm5hcnJvd2VyLmxlbmd0aCA+IDApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vbm93IHdlIGhhdmUgZ3JvdXBzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZ3JvdXBzW2dyb3VwSW5kZXhdID0geyBcIm5hbWVcIiA6IG1vZGVsW2ldLnByZWZMYWJlbFswXVsnQHZhbHVlJ10sIFwiaXRlbXNcIiA6IFtdfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cElkSW5kZXhNYXBbbW9kZWxbaV1bJ0BpZCddXSA9IGdyb3VwSW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBJbmRleCsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGRlZmF1bHRHcm91cDsgLy9pZiB0aGVyZSBpcyBubyBncm91cCBvciBncm91cCBjYW5ub3QgYmUgZm91bmQsIHRoZW4gYWRkIGl0IHRvIGRlZmF1bHQgZ3JvdXBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChtb2RlbFtpXS5icm9hZGVyKSAmJiBtb2RlbFtpXS5icm9hZGVyLmxlbmd0aCA9PSAxICYmIGFuZ3VsYXIuaXNEZWZpbmVkKGdyb3VwSWRJbmRleE1hcFttb2RlbFtpXS5icm9hZGVyWzBdWydAaWQnXV0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9ub3cgd2UgaGF2ZSBhIHN1YiBlbGVtZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAgPSBzY29wZS5ncm91cHNbZ3JvdXBJZEluZGV4TWFwW21vZGVsW2ldLmJyb2FkZXJbMF1bJ0BpZCddXV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFtwYXJzZWRSZXN1bHQuaXRlbU5hbWVdID0gbW9kZWxbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZGVsQ3RybC4kbW9kZWxWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vVE9ETyB3aGF0IGlzIHRoaXMgbW9kZWxDdHJsIGFuZCBtb2RlbFZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIShtb2RlbEN0cmwuJG1vZGVsVmFsdWUgaW5zdGFuY2VvZiBBcnJheSkgJiYgbW9kZWxbaV1bJ0BpZCddID09PSBtb2RlbEN0cmwuJG1vZGVsVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKChtb2RlbEN0cmwuJG1vZGVsVmFsdWUgaW5zdGFuY2VvZiBBcnJheSkgJiYgY29udGFpbnMobW9kZWxDdHJsLiRtb2RlbFZhbHVlLCBtb2RlbFtpXVsnQGlkJ10pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cC5pdGVtcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogcGFyc2VkUmVzdWx0LnZpZXdNYXBwZXIobG9jYWwpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsOiBtb2RlbFtpXVsnQGlkJ10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZDogY2hlY2tlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vdyBhZGQgZGVmYXVsdCBncm91cFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5ncm91cHNbZ3JvdXBJbmRleF0gPSBkZWZhdWx0R3JvdXA7XHJcbiAgICAgICAgICAgICAgICAgICAgfSAvL2VuZCBvZiBmdW5jdGlvbiBwYXJzZU1vZGVsXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNvbnRhaW5zKGFycmF5LCBuZWVkbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJyYXlbaV0gPT0gbmVlZGxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VNb2RlbCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZCgkY29tcGlsZShwb3BVcEVsKShzY29wZSkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRIZWFkZXJUZXh0KCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdEhlYWRlciA9ICdTZWxlY3QnO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFtb2RlbEN0cmwuJG1vZGVsVmFsdWUpIHJldHVybiBzY29wZS5oZWFkZXIgPSBhdHRycy5tc0hlYWRlciB8fCBkZWZhdWx0SGVhZGVyO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZGVsQ3RybC4kbW9kZWxWYWx1ZSAmJiBtb2RlbEN0cmwuJG1vZGVsVmFsdWUgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJzLm1zU2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5oZWFkZXIgPSAkaW50ZXJwb2xhdGUoYXR0cnMubXNTZWxlY3RlZCkoc2NvcGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5oZWFkZXIgPSBtb2RlbEN0cmwuJG1vZGVsVmFsdWVbMF0gIT0gJyc/IG1vZGVsQ3RybC4kbW9kZWxWYWx1ZS5sZW5ndGggKyAnICcgKyAnc2VsZWN0ZWQnIDogZGVmYXVsdEhlYWRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZihtb2RlbEN0cmwuJG1vZGVsVmFsdWUgJiYgdHlwZW9mIDApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuaGVhZGVyID0gJzEgc2VsZWN0ZWQnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFtwYXJzZWRSZXN1bHQuaXRlbU5hbWVdID0gbW9kZWxDdHJsLiRtb2RlbFZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuaGVhZGVyID0gcGFyc2VkUmVzdWx0LnZpZXdNYXBwZXIobG9jYWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBpc19lbXB0eShvYmopIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvYmopIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqLmxlbmd0aCAmJiBvYmoubGVuZ3RoID4gMCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBwcm9wIGluIG9iaikgaWYgKG9ialtwcm9wXSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzY29wZS52YWxpZCA9IGZ1bmN0aW9uIHZhbGlkTW9kZWwoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFyZXF1aXJlZCkgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IG1vZGVsQ3RybC4kbW9kZWxWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChhbmd1bGFyLmlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA+IDApIHx8ICghYW5ndWxhci5pc0FycmF5KHZhbHVlKSAmJiB2YWx1ZSAhPSBudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBzZWxlY3RTaW5nbGUoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS51bmNoZWNrQWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS51bmNoZWNrQWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSAhaXRlbS5jaGVja2VkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldE1vZGVsVmFsdWUoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gc2VsZWN0TXVsdGlwbGUoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSAhaXRlbS5jaGVja2VkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRNb2RlbFZhbHVlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gc2V0TW9kZWxWYWx1ZShpc011bHRpcGxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc011bHRpcGxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHNjb3BlLmdyb3VwcywgZnVuY3Rpb24gKGdyb3VwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGdyb3VwLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5jaGVja2VkKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLnB1c2goaXRlbS5tb2RlbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzY29wZS5ncm91cHMsIGZ1bmN0aW9uIChncm91cCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChncm91cC5pdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBpdGVtLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gbWFya0NoZWNrZWQobmV3VmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYW5ndWxhci5pc0FycmF5KG5ld1ZhbCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIW5ld1ZhbCAmJiB0eXBlb2YgbmV3VmFsICE9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsID0gbmV3VmFsLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goc2NvcGUuZ3JvdXBzLCBmdW5jdGlvbiAoZ3JvdXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZ3JvdXAuaXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbmd1bGFyLmVxdWFscyhpdGVtLm1vZGVsLCBuZXdWYWwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHNjb3BlLmdyb3VwcywgZnVuY3Rpb24gKGdyb3VwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGdyb3VwLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKG5ld1ZhbCwgZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIWkgJiYgdHlwZW9mIGkgIT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gaS50b1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFuZ3VsYXIuZXF1YWxzKGl0ZW0ubW9kZWwsIGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGVja0FsbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc011bHRpcGxlKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzY29wZS5ncm91cHMsIGZ1bmN0aW9uIChncm91cCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGdyb3VwLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0TW9kZWxWYWx1ZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzY29wZS51bmNoZWNrQWxsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goc2NvcGUuZ3JvdXBzLCBmdW5jdGlvbiAoZ3JvdXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChncm91cC5pdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRNb2RlbFZhbHVlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnNlbGVjdCA9IGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc011bHRpcGxlID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0U2luZ2xlKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudG9nZ2xlU2VsZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RNdWx0aXBsZShpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XSlcclxuXHJcbiAgICAuZGlyZWN0aXZlKCdtdWx0aXNlbGVjdFBvcHVwJywgWyckZG9jdW1lbnQnLCBmdW5jdGlvbiAoJGRvY3VtZW50KSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBRScsXHJcbiAgICAgICAgICAgIHNjb3BlOiBmYWxzZSxcclxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtdWx0aXNlbGVjdC50cGwuaHRtbCcsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBzY29wZS5pc1Zpc2libGUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICBzY29wZS50b2dnbGVTZWxlY3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ29wZW4nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdvcGVuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRkb2N1bWVudC51bmJpbmQoJ2NsaWNrJywgY2xpY2tIYW5kbGVyKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdvcGVuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRkb2N1bWVudC5iaW5kKCdjbGljaycsIGNsaWNrSGFuZGxlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc2NvcGUuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNsaWNrSGFuZGxlcihldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50TWF0Y2hlc0FueUluQXJyYXkoZXZlbnQudGFyZ2V0LCBlbGVtZW50LmZpbmQoZXZlbnQudGFyZ2V0LnRhZ05hbWUpKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ29wZW4nKTtcclxuICAgICAgICAgICAgICAgICAgICAkZG9jdW1lbnQudW5iaW5kKCdjbGljaycsIGNsaWNrSGFuZGxlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4vLyAgICAgICAgICAgICAgICBzY29wZS5mb2N1cyA9IGZ1bmN0aW9uIGZvY3VzKCl7XHJcbi8vICAgICAgICAgICAgICAgICAgICB2YXIgc2VhcmNoQm94ID0gZWxlbWVudC5maW5kKCdpbnB1dCcpWzBdO1xyXG4vLyAgICAgICAgICAgICAgICAgICAgc2VhcmNoQm94LmZvY3VzKCk7XHJcbi8vICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudE1hdGNoZXNBbnlJbkFycmF5ID0gZnVuY3Rpb24gKGVsZW1lbnQsIGVsZW1lbnRBcnJheSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudEFycmF5Lmxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudCA9PSBlbGVtZW50QXJyYXlbaV0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XSk7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnbXVsdGlzZWxlY3QudHBsLmh0bWwnLCBbXSlcclxuXHJcbiAgICAucnVuKFsnJHRlbXBsYXRlQ2FjaGUnLCBmdW5jdGlvbigkdGVtcGxhdGVDYWNoZSkge1xyXG4gICAgICAgICR0ZW1wbGF0ZUNhY2hlLnB1dCgnbXVsdGlzZWxlY3QudHBsLmh0bWwnLFxyXG5cclxuICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPVxcXCJkcm9wZG93blxcXCI+XFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgXCIgIDxidXR0b24gdHlwZT1cXFwiYnV0dG9uXFxcIiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0XFxcIiBuZy1jbGljaz1cXFwidG9nZ2xlU2VsZWN0KClcXFwiIG5nLWRpc2FibGVkPVxcXCJkaXNhYmxlZFxcXCIgbmctY2xhc3M9XFxcInsnZXJyb3InOiAhdmFsaWQoKX1cXFwiPlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICAgIHt7aGVhZGVyfX0gPHNwYW4gY2xhc3M9XFxcImNhcmV0XFxcIj48L3NwYW4+XFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgXCIgIDwvYnV0dG9uPlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICA8dWwgY2xhc3M9XFxcImRyb3Bkb3duLW1lbnVcXFwiPlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICAgIDxsaSBuZy1zaG93PVxcXCJzaG93RmlsdGVyXFxcIj5cXG5cIiArXHJcbiAgICAgICAgICAgICAgICBcIiAgICAgIDxpbnB1dCBjbGFzcz1cXFwiZm9ybS1jb250cm9sIGlucHV0LXNtXFxcIiB0eXBlPVxcXCJ0ZXh0XFxcIiBuZy1tb2RlbD1cXFwic2VhcmNoVGV4dC5sYWJlbFxcXCIgYXV0b2ZvY3VzPVxcXCJhdXRvZm9jdXNcXFwiIHBsYWNlaG9sZGVyPVxcXCJGaWx0ZXJcXFwiIC8+XFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgXCIgICAgPC9saT5cXG5cIiArXHJcbiAgICAgICAgICAgICAgICBcIiAgICA8bGkgbmctc2hvdz1cXFwibXVsdGlwbGUgJiYgc2hvd0NoZWNrQWxsXFxcIiByb2xlPVxcXCJwcmVzZW50YXRpb25cXFwiIGNsYXNzPVxcXCJcXFwiPlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1saW5rIGJ0bi14c1xcXCIgbmctY2xpY2s9XFxcImNoZWNrQWxsKClcXFwiIHR5cGU9XFxcImJ1dHRvblxcXCI+PGkgY2xhc3M9XFxcImljb24tb2tcXFwiPjwvaT4gQ2hlY2sgYWxsPC9idXR0b24+XFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgXCIgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWxpbmsgYnRuLXhzXFxcIiBuZy1jbGljaz1cXFwidW5jaGVja0FsbCgpXFxcIiB0eXBlPVxcXCJidXR0b25cXFwiPjxpIGNsYXNzPVxcXCJpY29uLXJlbW92ZVxcXCI+PC9pPiBVbmNoZWNrIGFsbDwvYnV0dG9uPlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICAgIDwvbGk+XFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgXCIgICAgPGRpdiBuZy1yZXBlYXQ9XFxcImkgaW4gZ3JvdXBzXFxcIj5cXG5cIiArXHJcbiAgICAgICAgICAgICAgICBcIiAgICAgICA8ZGl2PlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICAgICAgICAgICA8aDU+e3tpLm5hbWV9fTwvaDU+XCIrXHJcbiAgICAgICAgICAgICAgICBcIiAgICAgICA8L2Rpdj5cXG5cIiArXHJcbiAgICAgICAgICAgICAgICBcIiAgICAgICA8ZGl2IGNsYXNzPVxcXCJkcm9wZG93bi1jb250YWluZXJcXFwiIG5nLXJlcGVhdD1cXFwiaiBpbiBpLml0ZW1zIHwgZmlsdGVyOnNlYXJjaFRleHRcXFwiPlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICAgICAgICAgICA8YSBuZy1jbGljaz1cXFwic2VsZWN0KGopOyBmb2N1cygpXFxcIj5cXG5cIiArXHJcbiAgICAgICAgICAgICAgICBcIiAgICAgICAgICAgICAgIDxpIG5nLWNsYXNzPVxcXCJ7J2ljb24tb2snOiBqLmNoZWNrZWQsICdpY29uLWVtcHR5JzogIWouY2hlY2tlZH1cXFwiPjwvaT4ge3tqLmxhYmVsfX08L2E+XFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgXCIgICAgICAgPC9kaXY+XFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgXCIgICAgPC9kaXY+XFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgXCIgIDwvdWw+XFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgXCI8L2Rpdj5cIik7XHJcbiAgICB9XSk7XHJcbiIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGFyZ29hYXZhIG9uIDIyLjA0LjE0LlxyXG4gKi9cclxuXHJcbi8vIE1vZHVsZSB0aGF0IHByb3ZpZGVzIGZ1bmN0aW9uYWxpdHkgdG8gYXNrIGNvbmZpcm1hdGlvbiBmcm9tIHVzZXIgd2hlblxyXG4vLyBmb3JtIGhhcyBjaGFuZ2VkIGFuZCB1c2VyIHRyaWVzIHRvIGxlYXZlIHBhZ2Ugd2l0aG91dCBzYXZpbmcuXHJcbi8vXHJcbi8vIFVzYWdlIGV4YW1wbGU6XHJcbi8vXHJcbi8vIDxkaXYgbmctZm9ybT1cImFwcEZvcm1cIiBub3ZhbGlkYXRlIGNsYXNzPVwiY3NzLWZvcm1cIiBuZy1jbGFzcz1cInsgJ3N1Ym1pdHRlZCcgOiBzdWJtaXR0ZWQgfVwiIHRkLW5hdmlnYXRpb24tYmxvY2tlci1mb3JtPlxyXG4vL1xyXG4vLyAndGQtbmF2aWdhdGlvbi1ibG9ja2VyLWZvcm0nIG11c3QgYmUgc3BlY2lmaWVkIGFzIGF0dHJpYnV0ZSBmb3IgdGhlIGZvcm0gdGhhdCBjb25maXJtYXRpb24gZnVuY3Rpb25hbGl0eVxyXG4vLyBtdXN0IGFwcGx5IHRvLlxyXG5cclxuLy9GSVhNRSBzaG91bGQgYmUgYWJsZSB0byBtYWtlIGl0IHNvIHRoYXQgcm9vdFNjb3BlIGlzIG5vdCB1c2VkLlxyXG5hbmd1bGFyLm1vZHVsZSgnbmF2aWdhdGlvbi5uYXZpZ2F0aW9uQmxvY2tlcicsIFtdKVxyXG4gICAgLnJ1bihbJyRyb290U2NvcGUnLCAnJGxvY2F0aW9uJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRsb2NhdGlvbikge1xyXG4gICAgICAgIHZhciBfcHJldmVudE5hdmlnYXRpb24gPSBmYWxzZTtcclxuICAgICAgICB2YXIgX3ByZXZlbnROYXZpZ2F0aW9uVXJsID0gbnVsbDtcclxuXHJcbiAgICAgICAgJHJvb3RTY29wZS5hbGxvd05hdmlnYXRpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgX3ByZXZlbnROYXZpZ2F0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHJvb3RTY29wZS5wcmV2ZW50TmF2aWdhdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBfcHJldmVudE5hdmlnYXRpb24gPSB0cnVlO1xyXG4gICAgICAgICAgICBfcHJldmVudE5hdmlnYXRpb25VcmwgPSAkbG9jYXRpb24uYWJzVXJsKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkcm9vdFNjb3BlLiRvbignJGxvY2F0aW9uQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQsIG5ld1VybCwgb2xkVXJsKSB7XHJcbiAgICAgICAgICAgIC8vIEFsbG93IG5hdmlnYXRpb24gaWYgb3VyIG9sZCB1cmwgd2Fzbid0IHdoZXJlIHdlIHByZXZlbnRlZCBuYXZpZ2F0aW9uIGZyb21cclxuICAgICAgICAgICAgaWYgKF9wcmV2ZW50TmF2aWdhdGlvblVybCAhPSBvbGRVcmwgfHwgX3ByZXZlbnROYXZpZ2F0aW9uVXJsID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWxsb3dOYXZpZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChfcHJldmVudE5hdmlnYXRpb24gJiYgIWNvbmZpcm0oXCJZb3UgaGF2ZSB1bnNhdmVkIGNoYW5nZXMsIGRvIHlvdSB3YW50IHRvIGNvbnRpbnVlP1wiKSkge1xyXG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWxsb3dOYXZpZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gVGFrZSBjYXJlIG9mIHByZXZlbnRpbmcgbmF2aWdhdGlvbiBvdXQgb2Ygb3VyIGFuZ3VsYXIgYXBwXHJcbiAgICAgICAgd2luZG93Lm9uYmVmb3JldW5sb2FkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vIFVzZSB0aGUgc2FtZSBkYXRhIHRoYXQgd2UndmUgc2V0IGluIG91ciBhbmd1bGFyIGFwcFxyXG4gICAgICAgICAgICBpZiAoX3ByZXZlbnROYXZpZ2F0aW9uICYmICRsb2NhdGlvbi5hYnNVcmwoKSA9PSBfcHJldmVudE5hdmlnYXRpb25VcmwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIllvdSBoYXZlIHVuc2F2ZWQgY2hhbmdlcywgZG8geW91IHdhbnQgdG8gY29udGludWU/XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XSlcclxuXHJcbiAgICAuZGlyZWN0aXZlKFwiYmxvY2tGb3JtTmF2aWdhdGlvblwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICAgICAgcmVxdWlyZTogWydeZm9ybSddLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBmb3JtQ29udHJvbGxlcikge1xyXG4gICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKGF0dHJzLm5nRm9ybSArICcuJGRpcnR5JywgZnVuY3Rpb24gKGRpcnR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRpcnR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRyb290LnByZXZlbnROYXZpZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHJvb3QuYWxsb3dOYXZpZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KVxyXG5cclxuXHJcbiIsIid1c2Ugc3RyaWN0Jztcbi8vICBTZXJ2aWNlIGZvciBjcmVhdGluZyBub3RpZmljYXRpb25zLlxuLy8gIE9yaWdpbjogaHR0cHM6Ly9naXRodWIuY29tL0RlcmVrUmllcy9Bbmd1bGFyLU5vdGlmaWNhdGlvbnNcbi8vXG4vLyAgRGVwZW5kZW5jaWVzOlxuLy8gICAgICBJdCB1c2UgQm9vdHN0cmFiIGNvbXBvbmVudDogIGh0dHA6Ly9nZXRib290c3RyYXAuY29tL2NvbXBvbmVudHMvXG5cbi8vICBJbnN0YWxsYXRpb246XG4vLyAgICAgIDEuIEFkZCBzY3JpcHQgZmlsZTpcbi8vICAgICAgICAgIDxzY3JpcHQgc3JjPVwibm90aWZpY2F0aW9uLmpzXCI+PC9zY3JpcHQ+XG4vL1xuLy8gICAgICAyLiBBZGQgY3NzIHRvIHlvdXIgd2ViZm9ybTpcbi8vICAgICAgICAgIDxsaW5rIHJlbD1cInN0eWxlc2hlZXRcIiBocmVmPVwibm90aWZpY2F0aW9uLmNzc1wiLz5cbi8vXG4vLyAgICAgIDMuIEFkZCBub3RpZmljYXRpb25zIG1vZHVsZSBhcyBhIGRlcGVuZGVuY3kgb2YgeW91ciBhcHAgbW9kdWxlOlxuLy8gICAgICAgICAgZS5nIGFuZ3VsYXIubW9kdWxlKCduZ2NvbXBvbmVudHNBcHAnLCBbJ25vdGlmaWNhdGlvbnMnXSlcbi8vXG4vLyAgICAgIDQuIEFkZCBhIGRpdiB0byB5b3VyIGJvZHkgdGFnIHNvbWV3aGVyZSBhbmQgZ2l2ZSBpdCBhXG4vLyAgICAgICAgICBub3RpZmljYXRpb25zIGRpcmVjdGl2ZSBzcGVjaWZ5aW5nIGl0cyBwb3NpdGlvbiBsaWtlIHNvOlxuLy8gICAgICAgICAgICAgIDxkaXYgbm90aWZpY2F0aW9ucz1cImJvdHRvbSByaWdodFwiPjwvZGl2PlxuLy9cbi8vIFVzYWdlIEV4YW1wbGU6XG4vLyAgICAgIFlvdSBjYW4gdXNlIHRoZXNlIG1ldGhvZHMgd2l0aCB0aGUgZm9sbG93aW5nXG4vLyAgICAgIGxpbmUgb2YgY29kZSAodXNlckRhdGEgcGFyYW1ldGVyIGlzIG9wdGlvbmFsLCBjdXJyZW50bHkgdGl0bGUgaXMgbm90IHVzZWQpOlxuLy9cbi8vICAgICRub3RpZmljYXRpb24uaW5mbyh0aXRsZSwgY29udGVudCwgdXNlckRhdGEpO1xuLy8gICAgJG5vdGlmaWNhdGlvbi53YXJuaW5nKHRpdGxlLCBjb250ZW50LCB1c2VyRGF0YSk7XG4vLyAgICAkbm90aWZpY2F0aW9uLmVycm9yKFwiU2F2ZVwiLCBcIkRhdGEgaXMgbm90IHNhdmVkICFcIik7XG4vLyAgICAkbm90aWZpY2F0aW9uLnN1Y2Nlc3MoXCJTYXZlXCIsIFwiRGF0YSBpcyBzYXZlZCBzdWNjZXNzZnVsbHkuXCIpO1xuLy9cbmFuZ3VsYXIubW9kdWxlKCdub3RpZmljYXRpb25zJywgW10pLlxuICAgIGZhY3RvcnkoJyRub3RpZmljYXRpb24nLCBbJyR0aW1lb3V0JyxmdW5jdGlvbigkdGltZW91dCl7XG5cbiAgICAgICAgLy9jb25zb2xlLmxvZygnbm90aWZpY2F0aW9uIHNlcnZpY2Ugb25saW5lJyk7XG4gICAgICAgIHZhciBub3RpZmljYXRpb25zID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnJG5vdGlmaWNhdGlvbnMnKSkgfHwgW10sXG4gICAgICAgICAgICBxdWV1ZSA9IFtdO1xuXG4gICAgICAgIHZhciBzZXR0aW5ncyA9IHtcbiAgICAgICAgICAgIGluZm86IHsgZHVyYXRpb246IDUwMDAsIGVuYWJsZWQ6IHRydWUgfSxcbiAgICAgICAgICAgIHdhcm5pbmc6IHsgZHVyYXRpb246IDUwMDAsIGVuYWJsZWQ6IHRydWUgfSxcbiAgICAgICAgICAgIGVycm9yOiB7IGR1cmF0aW9uOiA1MDAwLCBlbmFibGVkOiB0cnVlIH0sXG4gICAgICAgICAgICBzdWNjZXNzOiB7IGR1cmF0aW9uOiA1MDAwLCBlbmFibGVkOiB0cnVlIH0sXG4gICAgICAgICAgICBwcm9ncmVzczogeyBkdXJhdGlvbjogMCwgZW5hYmxlZDogdHJ1ZSB9LFxuICAgICAgICAgICAgY3VzdG9tOiB7IGR1cmF0aW9uOiAzNTAwMCwgZW5hYmxlZDogdHJ1ZSB9LFxuICAgICAgICAgICAgZGV0YWlsczogdHJ1ZSxcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZTogZmFsc2UsXG4gICAgICAgICAgICBodG1sNU1vZGU6IGZhbHNlLFxuICAgICAgICAgICAgaHRtbDVEZWZhdWx0SWNvbjogJ2ljb24ucG5nJ1xuICAgICAgICB9O1xuXG4gICAgICAgIGZ1bmN0aW9uIGh0bWw1Tm90aWZ5KGljb24sIHRpdGxlLCBjb250ZW50LCBvbmRpc3BsYXksIG9uY2xvc2Upe1xuICAgICAgICAgICAgaWYod2luZG93LndlYmtpdE5vdGlmaWNhdGlvbnMuY2hlY2tQZXJtaXNzaW9uKCkgPT09IDApe1xuICAgICAgICAgICAgICAgIGlmKCFpY29uKXtcbiAgICAgICAgICAgICAgICAgICAgaWNvbiA9ICdmYXZpY29uLmljbyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBub3RpID0gd2luZG93LndlYmtpdE5vdGlmaWNhdGlvbnMuY3JlYXRlTm90aWZpY2F0aW9uKGljb24sIHRpdGxlLCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICBpZih0eXBlb2Ygb25kaXNwbGF5ID09PSAnZnVuY3Rpb24nKXtcbiAgICAgICAgICAgICAgICAgICAgbm90aS5vbmRpc3BsYXkgPSBvbmRpc3BsYXk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBvbmNsb3NlID09PSAnZnVuY3Rpb24nKXtcbiAgICAgICAgICAgICAgICAgICAgbm90aS5vbmNsb3NlID0gb25jbG9zZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbm90aS5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZXR0aW5ncy5odG1sNU1vZGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICAgICAgcmV0dXJuIHtcblxuICAgICAgICAgICAgLyogPT09PT09PT09PSBTRVRUSU5HUyBSRUxBVEVEIE1FVEhPRFMgPT09PT09PT09PT09PSovXG5cbiAgICAgICAgICAgIGRpc2FibGVIdG1sNU1vZGU6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgc2V0dGluZ3MuaHRtbDVNb2RlID0gZmFsc2U7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBkaXNhYmxlVHlwZTogZnVuY3Rpb24obm90aWZpY2F0aW9uVHlwZSl7XG4gICAgICAgICAgICAgICAgc2V0dGluZ3Nbbm90aWZpY2F0aW9uVHlwZV0uZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgZW5hYmxlSHRtbDVNb2RlOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIC8vIHNldHRpbmdzLmh0bWw1TW9kZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgc2V0dGluZ3MuaHRtbDVNb2RlID0gdGhpcy5yZXF1ZXN0SHRtbDVNb2RlUGVybWlzc2lvbnMoKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGVuYWJsZVR5cGU6IGZ1bmN0aW9uKG5vdGlmaWNhdGlvblR5cGUpe1xuICAgICAgICAgICAgICAgIHNldHRpbmdzW25vdGlmaWNhdGlvblR5cGVdLmVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgZ2V0U2V0dGluZ3M6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNldHRpbmdzO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgdG9nZ2xlVHlwZTogZnVuY3Rpb24obm90aWZpY2F0aW9uVHlwZSl7XG4gICAgICAgICAgICAgICAgc2V0dGluZ3Nbbm90aWZpY2F0aW9uVHlwZV0uZW5hYmxlZCA9ICFzZXR0aW5nc1tub3RpZmljYXRpb25UeXBlXS5lbmFibGVkO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgdG9nZ2xlSHRtbDVNb2RlOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHNldHRpbmdzLmh0bWw1TW9kZSA9ICFzZXR0aW5ncy5odG1sNU1vZGU7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICByZXF1ZXN0SHRtbDVNb2RlUGVybWlzc2lvbnM6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy53ZWJraXROb3RpZmljYXRpb25zKXtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnbm90aWZpY2F0aW9ucyBhcmUgYXZhaWxhYmxlJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cud2Via2l0Tm90aWZpY2F0aW9ucy5jaGVja1Blcm1pc3Npb24oKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy53ZWJraXROb3RpZmljYXRpb25zLnJlcXVlc3RQZXJtaXNzaW9uKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYod2luZG93LndlYmtpdE5vdGlmaWNhdGlvbnMuY2hlY2tQZXJtaXNzaW9uKCkgPT09IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncy5odG1sNU1vZGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncy5odG1sNU1vZGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdub3RpZmljYXRpb25zIGFyZSBub3Qgc3VwcG9ydGVkJyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuXG5cbiAgICAgICAgICAgIC8qID09PT09PT09PT09PSBRVUVSWUlORyBSRUxBVEVEIE1FVEhPRFMgPT09PT09PT09PT09Ki9cblxuICAgICAgICAgICAgZ2V0QWxsOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIC8vIFJldHVybnMgYWxsIG5vdGlmaWNhdGlvbnMgdGhhdCBhcmUgY3VycmVudGx5IHN0b3JlZFxuICAgICAgICAgICAgICAgIHJldHVybiBub3RpZmljYXRpb25zO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgZ2V0UXVldWU6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXVlO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLyogPT09PT09PT09PT09PT0gTk9USUZJQ0FUSU9OIE1FVEhPRFMgPT09PT09PT09PT09PT0qL1xuXG4gICAgICAgICAgICBpbmZvOiBmdW5jdGlvbih0aXRsZSwgY29udGVudCwgdXNlckRhdGEpe1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2codGl0bGUsIGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmF3ZXNvbWVOb3RpZnkoJ2luZm8nLCdpbmZvLXNpZ24nLCB0aXRsZSwgY29udGVudCwgdXNlckRhdGEpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHRpdGxlLCBjb250ZW50LCB1c2VyRGF0YSl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXdlc29tZU5vdGlmeSgnZXJyb3InLCAncmVtb3ZlLXNpZ24nLCB0aXRsZSwgY29udGVudCwgdXNlckRhdGEpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24odGl0bGUsIGNvbnRlbnQsIHVzZXJEYXRhKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hd2Vzb21lTm90aWZ5KCdzdWNjZXNzJywgJ29rLXNpZ24nLCB0aXRsZSwgY29udGVudCwgdXNlckRhdGEpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgd2FybmluZzogZnVuY3Rpb24odGl0bGUsIGNvbnRlbnQsIHVzZXJEYXRhKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hd2Vzb21lTm90aWZ5KCd3YXJuaW5nJywgJ2V4Y2xhbWF0aW9uLXNpZ24nLCB0aXRsZSwgY29udGVudCwgdXNlckRhdGEpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgYXdlc29tZU5vdGlmeTogZnVuY3Rpb24odHlwZSwgaWNvbiwgdGl0bGUsIGNvbnRlbnQsIHVzZXJEYXRhKXtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBTdXBwb3NlZCB0byB3cmFwIHRoZSBtYWtlTm90aWZpY2F0aW9uIG1ldGhvZCBmb3IgZHJhd2luZyBpY29ucyB1c2luZyBmb250LWF3ZXNvbWVcbiAgICAgICAgICAgICAgICAgKiByYXRoZXIgdGhhbiBhbiBpbWFnZS5cbiAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAqIE5lZWQgdG8gZmluZCBvdXQgaG93IEknbSBnb2luZyB0byBtYWtlIHRoZSBBUEkgdGFrZSBlaXRoZXIgYW4gaW1hZ2VcbiAgICAgICAgICAgICAgICAgKiByZXNvdXJjZSwgb3IgYSBmb250LWF3ZXNvbWUgaWNvbiBhbmQgdGhlbiBkaXNwbGF5IGVpdGhlciBvZiB0aGVtLlxuICAgICAgICAgICAgICAgICAqIEFsc28gc2hvdWxkIHByb2JhYmx5IHByb3ZpZGUgc29tZSBiaXRzIG9mIGNvbG9yLCBjb3VsZCBkbyB0aGUgY29sb3JpbmdcbiAgICAgICAgICAgICAgICAgKiB0aHJvdWdoIGNsYXNzZXMuXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgLy8gaW1hZ2UgPSAnPGkgY2xhc3M9XCJpY29uLScgKyBpbWFnZSArICdcIj48L2k+JztcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tYWtlTm90aWZpY2F0aW9uKHR5cGUsIGZhbHNlLCBpY29uLCB0aXRsZSwgY29udGVudCwgdXNlckRhdGEpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgbm90aWZ5OiBmdW5jdGlvbihpbWFnZSwgdGl0bGUsIGNvbnRlbnQsIHVzZXJEYXRhKXtcbiAgICAgICAgICAgICAgICAvLyBXcmFwcyB0aGUgbWFrZU5vdGlmaWNhdGlvbiBtZXRob2QgZm9yIGRpc3BsYXlpbmcgbm90aWZpY2F0aW9ucyB3aXRoIGltYWdlc1xuICAgICAgICAgICAgICAgIC8vIHJhdGhlciB0aGFuIGljb25zXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubWFrZU5vdGlmaWNhdGlvbignY3VzdG9tJywgaW1hZ2UsIHRydWUsIHRpdGxlLCBjb250ZW50LCB1c2VyRGF0YSk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBtYWtlTm90aWZpY2F0aW9uOiBmdW5jdGlvbih0eXBlLCBpbWFnZSwgaWNvbiwgdGl0bGUsIGNvbnRlbnQsIHVzZXJEYXRhKXtcbiAgICAgICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICAndHlwZSc6IHR5cGUsXG4gICAgICAgICAgICAgICAgICAgICdpbWFnZSc6IGltYWdlLFxuICAgICAgICAgICAgICAgICAgICAnaWNvbic6IGljb24sXG4gICAgICAgICAgICAgICAgICAgICd0aXRsZSc6IHRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAnY29udGVudCc6IGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICd0aW1lc3RhbXAnOiArbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgICAgICAgJ3VzZXJEYXRhJzogdXNlckRhdGFcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbnMucHVzaChub3RpZmljYXRpb24pO1xuXG4gICAgICAgICAgICAgICAgaWYoc2V0dGluZ3MuaHRtbDVNb2RlKXtcbiAgICAgICAgICAgICAgICAgICAgaHRtbDVOb3RpZnkoaW1hZ2UsIHRpdGxlLCBjb250ZW50LCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcImlubmVyIG9uIGRpc3BsYXkgZnVuY3Rpb25cIik7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiaW5uZXIgb24gY2xvc2UgZnVuY3Rpb25cIik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICBxdWV1ZS5wdXNoKG5vdGlmaWNhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uIHJlbW92ZUZyb21RdWV1ZVRpbWVvdXQoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXVlLnNwbGljZShxdWV1ZS5pbmRleE9mKG5vdGlmaWNhdGlvbiksIDEpO1xuICAgICAgICAgICAgICAgICAgICB9LCBzZXR0aW5nc1t0eXBlXS5kdXJhdGlvbik7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNhdmUoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbm90aWZpY2F0aW9uO1xuICAgICAgICAgICAgfSxcblxuXG4gICAgICAgICAgICAvKiA9PT09PT09PT09PT0gUEVSU0lTVEVOQ0UgTUVUSE9EUyA9PT09PT09PT09PT0gKi9cblxuICAgICAgICAgICAgc2F2ZTogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAvLyBTYXZlIGFsbCB0aGUgbm90aWZpY2F0aW9ucyBpbnRvIGxvY2FsU3RvcmFnZVxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKEpTT04pO1xuICAgICAgICAgICAgICAgIGlmKHNldHRpbmdzLmxvY2FsU3RvcmFnZSl7XG4gICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCckbm90aWZpY2F0aW9ucycsIEpTT04uc3RyaW5naWZ5KG5vdGlmaWNhdGlvbnMpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cobG9jYWxTdG9yYWdlLmdldEl0ZW0oJyRub3RpZmljYXRpb25zJykpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgcmVzdG9yZTogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAvLyBMb2FkIGFsbCBub3RpZmljYXRpb25zIGZyb20gbG9jYWxTdG9yYWdlXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBjbGVhcjogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb25zID0gW107XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfTtcbiAgICB9XSkuXG4gICAgZGlyZWN0aXZlKCdub3RpZmljYXRpb25zJywgWyckbm90aWZpY2F0aW9uJywgJyRjb21waWxlJywgZnVuY3Rpb24oJG5vdGlmaWNhdGlvbiwgJGNvbXBpbGUpe1xuICAgICAgICAvKipcbiAgICAgICAgICpcbiAgICAgICAgICogSXQgc2hvdWxkIGFsc28gcGFyc2UgdGhlIGFyZ3VtZW50cyBwYXNzZWQgdG8gaXQgdGhhdCBzcGVjaWZ5XG4gICAgICAgICAqIGl0cyBwb3NpdGlvbiBvbiB0aGUgc2NyZWVuIGxpa2UgXCJib3R0b20gcmlnaHRcIiBhbmQgYXBwbHkgdGhvc2VcbiAgICAgICAgICogcG9zaXRpb25zIGFzIGEgY2xhc3MgdG8gdGhlIGNvbnRhaW5lciBlbGVtZW50XG4gICAgICAgICAqXG4gICAgICAgICAqIEZpbmFsbHksIHRoZSBkaXJlY3RpdmUgc2hvdWxkIGhhdmUgaXRzIG93biBjb250cm9sbGVyIGZvclxuICAgICAgICAgKiBoYW5kbGluZyBhbGwgb2YgdGhlIG5vdGlmaWNhdGlvbnMgZnJvbSB0aGUgbm90aWZpY2F0aW9uIHNlcnZpY2VcbiAgICAgICAgICovXG4gICAgICAgIC8vY29uc29sZS5sb2coJ3RoaXMgaXMgYSBuZXcgZGlyZWN0aXZlJyk7XG4gICAgICAgIHZhciBodG1sID1cbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZHItbm90aWZpY2F0aW9uLXdyYXBwZXJcIiBuZy1yZXBlYXQ9XCJub3RpIGluIHF1ZXVlXCI+JyArXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJkci1ub3RpZmljYXRpb24tY2xvc2UtYnRuXCIgbmctY2xpY2s9XCJyZW1vdmVOb3RpZmljYXRpb24obm90aSlcIj4nICtcbiAgICAgICAgICAgICAgICAgICAgJzxpIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmVcIj48L2k+JyArXG4gICAgICAgICAgICAgICAgJzwvZGl2PicgK1xuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZHItbm90aWZpY2F0aW9uIG5vdGktYmFjay1ncm91bmQte3tub3RpLnR5cGV9fVwiPicgK1xuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImRyLW5vdGlmaWNhdGlvbi1pbWFnZSBkci1ub3RpZmljYXRpb24tdHlwZS17e25vdGkudHlwZX19XCIgbmctc3dpdGNoIG9uPVwibm90aS5pbWFnZVwiPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxpIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi17e25vdGkuaWNvbn19XCIgbmctc3dpdGNoLXdoZW49XCJmYWxzZVwiPjwvaT4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8aW1nIG5nLXNyYz1cInt7bm90aS5pbWFnZX19XCIgbmctc3dpdGNoLWRlZmF1bHQgLz4nICtcbiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicgK1xuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImRyLW5vdGlmaWNhdGlvbi1jb250ZW50XCI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAvKic8aDMgY2xhc3M9XCJkci1ub3RpZmljYXRpb24tdGl0bGVcIj57e25vdGkudGl0bGV9fTwvaDM+JyArICovXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHAgY2xhc3M9XCJkci1ub3RpZmljYXRpb24tdGV4dFwiPnt7bm90aS5jb250ZW50fX08L3A+JyArXG4gICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nICtcbiAgICAgICAgICAgICAgICAnPC9kaXY+JyArXG4gICAgICAgICAgICAnPC9kaXY+JztcblxuXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKXtcbiAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IGF0dHJzLm5vdGlmaWNhdGlvbnM7XG4gICAgICAgICAgICBwb3NpdGlvbiA9IHBvc2l0aW9uLnNwbGl0KCcgJyk7XG4gICAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdkci1ub3RpZmljYXRpb24tY29udGFpbmVyJyk7XG4gICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgcG9zaXRpb24ubGVuZ3RoIDsgaSsrKXtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKHBvc2l0aW9uW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICBzY29wZToge30sXG4gICAgICAgICAgICB0ZW1wbGF0ZTogaHRtbCxcbiAgICAgICAgICAgIGxpbms6IGxpbmssXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJyRzY29wZScsIGZ1bmN0aW9uIE5vdGlmaWNhdGlvbnNDdHJsKCAkc2NvcGUgKXtcbiAgICAgICAgICAgICAgICAkc2NvcGUucXVldWUgPSAkbm90aWZpY2F0aW9uLmdldFF1ZXVlKCk7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUucmVtb3ZlTm90aWZpY2F0aW9uID0gZnVuY3Rpb24obm90aSl7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5xdWV1ZS5zcGxpY2UoJHNjb3BlLnF1ZXVlLmluZGV4T2Yobm90aSksIDEpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG5cbiAgICAgICAgfTtcbiAgICB9XSk7IiwiJ3VzZSBzdHJpY3QnO1xuXG4oXG4gICAgZnVuY3Rpb24oYW5ndWxhcikge1xuICAgICAgICByZXR1cm4gYW5ndWxhclxuICAgICAgICAgICAgLm1vZHVsZSgnbmdPcmRlck9iamVjdEJ5JywgW10pXG4gICAgICAgICAgICAuZmlsdGVyKCdvcmRlck9iamVjdEJ5JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChpdGVtcywgZmllbGQsIHJldmVyc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbHRlcmVkID0gW107XG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChpdGVtcywgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWQucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGluZGV4KG9iaiwgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9ialtpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZC5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29tcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWR1Y2VkQSA9IGZpZWxkLnNwbGl0KCcuJykucmVkdWNlKGluZGV4LCBhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWR1Y2VkQiA9IGZpZWxkLnNwbGl0KCcuJykucmVkdWNlKGluZGV4LCBiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWR1Y2VkQSA9PT0gcmVkdWNlZEIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wYXJhdG9yID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFyYXRvciA9IChyZWR1Y2VkQSA+IHJlZHVjZWRCID8gMSA6IC0xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJldmVyc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkLnJldmVyc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVyZWQ7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbiAgICApKGFuZ3VsYXIpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGFyZ29hYXZhIG9uIDEzLjA1LjE0LlxyXG4gKi9cclxuXHJcblxyXG4vLyBNb2R1bGUgdGhhdCBjb250YWlucyBmdW5jdGlvbmFsaXR5IGZvciB0YWIgbmF2aWdhdGlvbi4gVXNlciBtdXN0IGZpbGwgJ3RhYlNlcnZpY2UnIHdpdGhcclxuLy8gYXZhaWxhYmxlIHRhYnMgYXMgZm9sbG93czpcclxuLy9cclxuLy8gYXBwLnJ1bihmdW5jdGlvbigkcm9vdFNjb3BlLCBwcm9taXNlVHJhY2tlciwgJGxvY2F0aW9uLCB0YWJTZXJ2aWNlKSB7XHJcbi8vICAgICAgdGFiU2VydmljZS5zZXRUYWJzKFtcclxuLy8gICAgICAgICAge1wiaWRcIjpcIlRhYmxlMVwiLFwiYWN0aXZlXCIgOiB0cnVlfSxcclxuLy8gICAgICAgICAge1wiaWRcIjpcIlRhYmxlMlwiLFwiYWN0aXZlXCIgOiBmYWxzZX0sXHJcbi8vICAgICAgICAgIHtcImlkXCI6XCJUYWJsZTNcIixcImFjdGl2ZVwiIDogZmFsc2V9LFxyXG4vLyAgICAgICAgICB7XCJpZFwiOlwiVGFibGU0XCIsXCJhY3RpdmVcIiA6IGZhbHNlfSxcclxuLy8gICAgICAgICAge1wiaWRcIjpcIlRhYmxlNVwiLFwiYWN0aXZlXCIgOiBmYWxzZX1dKTtcclxuLy8gfSk7XHJcbi8vXHJcbi8vIHRoZW4gJ1RhYkNvbnRyb2xsZXInIG11c3QgYmUgc2V0IHRvIGVsZW1lbnRzIHRoYXQgd2FudCB0byBpbnRlcmFjdCB3aXRoXHJcbi8vIHRhYlNlcnZpY2UuXHJcbi8vXHJcbi8vIDx1bCB0YWJzZXQgbmctY2xvYWsgbmctY29udHJvbGxlcj1cIlRhYkNvbnRyb2xsZXJcIj5cclxuLy8gICAgICA8ZGl2IG5nLWNsYXNzPVwieydpbnZhbGlkVGFiJyA6IGlzSW52YWxpZFRhYignVGFibGUxJyl9XCI+XHJcbi8vICAgICAgICAgIDxsaSB0YWIgaGVhZGluZz1cIlRhYmxlIDFcIiBhY3RpdmU9XCJ0YWJzW2dldFRhYkluZGV4KCdUYWJsZTEnKV0uYWN0aXZlXCI+XHJcbi8vICAgICAgICAgIDwvbGk+XHJcbi8vICAgICAgPC9kaXY+XHJcbi8vIDwvdWw+XHJcbi8vXHJcbi8vIG9yXHJcbi8vXHJcbi8vIDxkaXYgY2xhc3M9XCJhbmltYXRlLXNob3dcIiBuZy1zaG93PVwic2hvd01lbnVcIiBzdHlsZT1cImZsb2F0OnJpZ2h0XCIgbmctY29udHJvbGxlcj1cIlRhYkNvbnRyb2xsZXJcIj5cclxuLy8gICAgICA8aW5wdXQgdHlwZT1cImJ1dHRvblwiIG5nLWNsaWNrPVwicHJldmlvdXNUYWIoKVwiIHZhbHVlPVwiUHJldlwiIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1wcmltYXJ5XCIgbmctZGlzYWJsZWQ9XCJnZXRBY3RpdmVUYWJJbmRleCgpID09IDBcIj5cclxuLy8gICAgICA8aW5wdXQgdHlwZT1cImJ1dHRvblwiIG5nLWNsaWNrPVwibmV4dFRhYigpXCIgdmFsdWU9XCJOZXh0XCIgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgYnRuLXByaW1hcnlcIiBuZy1kaXNhYmxlZD1cImdldEFjdGl2ZVRhYkluZGV4KCkgPT0gKHRhYnMubGVuZ3RoIC0gMSlcIi8+XHJcbi8vIDwvZGl2PlxyXG4vL1xyXG5hbmd1bGFyLm1vZHVsZSgndGFicy5mb3JtVGFicycsIFtdKVxyXG4gICAgLnNlcnZpY2UoJ3RhYlNlcnZpY2UnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLnRhYnMgPSBbXTtcclxuXHJcbiAgICAgICAgdGhpcy5nZXRUYWJzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRhYnM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNldFRhYnMgPSBmdW5jdGlvbih0YWJzKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGFicyA9IHRhYnM7XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuICAgIC5jb250cm9sbGVyKFwiVGFiQ29udHJvbGxlclwiLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCAkbG9jYXRpb24sICR0aW1lb3V0LCAkYW5jaG9yU2Nyb2xsLCB0YWJTZXJ2aWNlKSB7XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIGlmICh0YWJTZXJ2aWNlLmdldFRhYnMoKS5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcIllvdSBtdXN0IGNvbmZpZ3VyZSB0YWJTZXJ2aWNlXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLnRhYnMgPSB0YWJTZXJ2aWNlLnRhYnM7XHJcblxyXG4gICAgICAgICRzY29wZS5nb3RvID0gZnVuY3Rpb24gKHRhYiwgaWQpe1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS50YWJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnRhYnNbaV0uaWQgPT0gdGFiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhYnNbaV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhYnNbaV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBvbGQgPSAkbG9jYXRpb24uaGFzaCgpO1xyXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5oYXNoKGlkKTtcclxuICAgICAgICAgICAgICAgICRhbmNob3JTY3JvbGwoKTtcclxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5oYXNoKG9sZCk7XHJcbiAgICAgICAgICAgIH0sIDIwMCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmdldEFjdGl2ZVRhYkluZGV4ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJHNjb3BlLnRhYnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUudGFic1tpXS5hY3RpdmUgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5nZXRUYWJJbmRleCA9IGZ1bmN0aW9uKHRhYklkKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJHNjb3BlLnRhYnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUudGFic1tpXS5pZCA9PSB0YWJJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUubmV4dFRhYiA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHZhciBhY3RpdmVUYWJJbmRleCA9ICRzY29wZS5nZXRBY3RpdmVUYWJJbmRleCgpO1xyXG4gICAgICAgICAgICB2YXIgbmV4dFRhYiA9IChhY3RpdmVUYWJJbmRleCArIDEgPD0gJHNjb3BlLnRhYnMubGVuZ3RoKT8gYWN0aXZlVGFiSW5kZXgrMSA6IGFjdGl2ZVRhYkluZGV4O1xyXG4gICAgICAgICAgICAkc2NvcGUuZ290bygkc2NvcGUudGFic1tuZXh0VGFiXS5pZCwgJ2JlZ2lubmluZycpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5wcmV2aW91c1RhYiA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHZhciBhY3RpdmVUYWJJbmRleCA9ICRzY29wZS5nZXRBY3RpdmVUYWJJbmRleCgpO1xyXG4gICAgICAgICAgICB2YXIgcHJldmlvdXNUYWIgPSAoYWN0aXZlVGFiSW5kZXggLSAxID49IDApPyBhY3RpdmVUYWJJbmRleCAtIDEgOiBhY3RpdmVUYWJJbmRleDtcclxuICAgICAgICAgICAgJHNjb3BlLmdvdG8oJHNjb3BlLnRhYnNbcHJldmlvdXNUYWJdLmlkLCAnYmVnaW5uaW5nJyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmlzSW52YWxpZFRhYiA9IGZ1bmN0aW9uKHRhYklkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUuc3VibWl0dGVkICYmICRzY29wZS5hcHBGb3JtW3RhYklkXS4kaW52YWxpZDtcclxuICAgICAgICB9O1xyXG4gICAgfSkiLCIvKipcclxuICogQ3JlYXRlZCBieSBhcmdvYWF2YSBvbiAxMy4wNS4xNC5cclxuICovXHJcblxyXG4vL0NoZWNrcyBpZiBhcnJheSBpcyBlbXB0eS5cclxud2luZG93LmlzRW1wdHlBcnJheSA9IGZ1bmN0aW9uKGFycmF5KSB7XHJcbiAgICBpZiAoIShhcnJheSBpbnN0YW5jZW9mIEFycmF5KSkge1xyXG4gICAgICAgIHRocm93IEVycm9yKFwiRWxlbWVudCBub3QgYXJyYXlcIik7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmICghYXJyYXlbaV0pIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG4vLyBDb3VudHMgYWxsIHByb3BlcnRpZXMgb2YgYW4gb2JqZWN0IG9yIGFycmF5LlxyXG4vLyBSZWR1Y2VzIHRoZSBjb3VudCBieSBvbmUgd2hlbiBvYmplY3QgaXMgY29uc2lkZXJlZCBmaXhlZCBxdWVzdGlvblxyXG4vLyBpbiB0aGlzIGNhc2UgZmlyc3QgZWxlbWVudCBvZiBvYmplY3QgaXMgcHJlZmlsbGVkIGFuZCBtdXN0IG5vdCBiZSBjb3VudGVkLlxyXG53aW5kb3cuY291bnROb25FbXB0eVByb3BlcnRpZXMgPSBmdW5jdGlvbihvYmplY3RPckFycmF5LCBpc0ZpeGVkUXVlc3Rpb24pIHtcclxuICAgIHZhciBjb3VudCA9IDA7XHJcblxyXG4gICAgaWYgKCEob2JqZWN0T3JBcnJheSBpbnN0YW5jZW9mIEFycmF5KSkge1xyXG4gICAgICAgIGNvdW50ID0gY291bnRPYmplY3RQcm9wZXJ0aWVzKG9iamVjdE9yQXJyYXkpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iamVjdE9yQXJyYXkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIG9iamVjdENvdW50ID0gY291bnRPYmplY3RQcm9wZXJ0aWVzKG9iamVjdE9yQXJyYXlbaV0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGlzRml4ZWRRdWVzdGlvbikge1xyXG4gICAgICAgICAgICAgICAgb2JqZWN0Q291bnQgLT0gMTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY291bnQgKz0gb2JqZWN0Q291bnQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNvdW50O1xyXG59O1xyXG5cclxuLy8gQ291bnRzIG9ubHlcclxud2luZG93LmNvdW50T2JqZWN0UHJvcGVydGllcyA9IGZ1bmN0aW9uKG9iamVjdCkge1xyXG4gICAgdmFyIGNvdW50ID0gMDtcclxuXHJcbiAgICAvL0ZvciBwcmltaXRpdmVzXHJcbiAgICBpZiAoISh0eXBlb2Ygb2JqZWN0ID09PSAnb2JqZWN0JykgJiZcclxuICAgICAgICAhKHR5cGVvZiBvYmplY3QgPT09ICdhcnJheScpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgfVxyXG5cclxuICAgIGZvciAodmFyIGkgaW4gb2JqZWN0KSB7XHJcbiAgICAgICAgaWYgKG9iamVjdC5oYXNPd25Qcm9wZXJ0eShpKVxyXG4gICAgICAgICAgICAmJiAhIW9iamVjdFtpXVxyXG4gICAgICAgICAgICAmJiAoaSAhPSAnJCRoYXNoS2V5JykpIHtcclxuXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygb2JqZWN0W2ldID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9iamVjdEVsZW1lbnRDb3VudCA9IGNvdW50Tm9uRW1wdHlQcm9wZXJ0aWVzKG9iamVjdFtpXSk7XHJcbiAgICAgICAgICAgICAgICBjb3VudCArPSBvYmplY3RFbGVtZW50Q291bnQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNvdW50O1xyXG59O1xyXG5cclxuLy8gQ2xlYXJzIG9iamVjdCBvciBhcnJheSBkYXRhLiBXaGVuIG9iamVjdCBpcyBhcnJheSBhbGwgb3RoZXIgZWxlbWVudHMgZXhjZXB0XHJcbi8vIGZpcnN0IGFyZSBkZWxldGVkLlxyXG53aW5kb3cuY2xlYXJPYmplY3QgPSBmdW5jdGlvbihvYmplY3QsIGtlZXBGaXJzdCkge1xyXG4gICAgaWYgKCEob2JqZWN0IGluc3RhbmNlb2YgQXJyYXkpKSB7XHJcblxyXG4gICAgICAgIHZhciBpbmRleENvdW50ZXIgPSAwO1xyXG4gICAgICAgIGZvciAodmFyIGkgaW4gb2JqZWN0KSB7XHJcbiAgICAgICAgICAgIGlmIChvYmplY3QuaGFzT3duUHJvcGVydHkoaSkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpbmRleENvdW50ZXIgPT0gMCAmJiBrZWVwRmlyc3QpIHtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0W2ldID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpbmRleENvdW50ZXIrKztcclxuICAgICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNsZWFyQXJyYXkob2JqZWN0LCBrZWVwRmlyc3QpO1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuLy8gRGVsZXRlcyBhbGwgb3RoZXIgYXJyYXkgZWxlbWVudHMgZXhwZWN0IGZpcnN0IG9uZSBhbmRcclxuLy8gY2xlYXJzIGFsbCBkYXRhIGZyb20gZmlyc3QgZWxlbWVudC5cclxud2luZG93LmNsZWFyQXJyYXkgPWZ1bmN0aW9uKGFycmF5LCBrZWVwUm93KSB7XHJcbiAgICBmb3IgKHZhciBpID0gYXJyYXkubGVuZ3RoOyBpID4gMDsgaS0tKSB7XHJcbiAgICAgICAgaWYgKGtlZXBSb3cpIHtcclxuICAgICAgICAgICAgY2xlYXJPYmplY3QoYXJyYXlbaV0sIGtlZXBSb3cpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGFycmF5LnNwbGljZShpLCAxKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjbGVhck9iamVjdChhcnJheVswXSwga2VlcFJvdyk7XHJcblxyXG4gICAgLy8gRm9yIGFycmF5cyB0aGF0IGNvbnRhaW4gcHJpbWl0aXZlcy4gTGFzdCBlbGVtZW50IG11c3QgYmVcclxuICAgIC8vIGxlZnQgYnV0IGhhcyB0byBiZSBlbXB0eSBzbyBlbGVtZW50IGlzIHN0aWxsIHByZXNlbnQgYWZ0ZXJcclxuICAgIC8vIGNvbnZlcnNpb24gdG8geG1sLlxyXG4gICAgaWYgKCEoYXJyYXlbMF0gaW5zdGFuY2VvZiBPYmplY3QpKSB7XHJcbiAgICAgICAgYXJyYXlbMF0gPSBcIlwiO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxufVxyXG5cclxuLy9DbG9uZSBvYmplY3QuXHJcbndpbmRvdy5jbG9uZSA9IGZ1bmN0aW9uKG9iaikge1xyXG4gICAgLy8gSGFuZGxlIHRoZSAzIHNpbXBsZSB0eXBlcywgYW5kIG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAobnVsbCA9PSBvYmogfHwgXCJvYmplY3RcIiAhPSB0eXBlb2Ygb2JqKSByZXR1cm4gb2JqO1xyXG5cclxuICAgIC8vIEhhbmRsZSBEYXRlXHJcbiAgICBpZiAob2JqIGluc3RhbmNlb2YgRGF0ZSkge1xyXG4gICAgICAgIHZhciBjb3B5ID0gbmV3IERhdGUoKTtcclxuICAgICAgICBjb3B5LnNldFRpbWUob2JqLmdldFRpbWUoKSk7XHJcbiAgICAgICAgcmV0dXJuIGNvcHk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSGFuZGxlIEFycmF5XHJcbiAgICBpZiAob2JqIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICB2YXIgY29weSA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBvYmoubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgY29weVtpXSA9IGNsb25lKG9ialtpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjb3B5O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEhhbmRsZSBPYmplY3RcclxuICAgIGlmIChvYmogaW5zdGFuY2VvZiBPYmplY3QpIHtcclxuICAgICAgICB2YXIgY29weSA9IHt9O1xyXG4gICAgICAgIGZvciAodmFyIGF0dHIgaW4gb2JqKSB7XHJcbiAgICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoYXR0cikpIGNvcHlbYXR0cl0gPSBjbG9uZShvYmpbYXR0cl0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY29weTtcclxuICAgIH1cclxuXHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmFibGUgdG8gY29weSBvYmohIEl0cyB0eXBlIGlzbid0IHN1cHBvcnRlZC5cIik7XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIGlzIHVzZWQgYmVmb3JlIHNhdmluZyBKU09OIG9iamVjdCBiYWNrIHRvIFhNTCBmaWxlLiBXaGVuIGRlbGV0aW5nIGZpZWxkIG9uIHRoZSBmb3JtXHJcbi8vIGFuZ3VsYXIgc2V0cyBpdCB0byB1bmRlZmluZWQgd2hpY2ggYnJlYWtzIHRoZSBvcmRlciBvZiBlbGVtZW50cyBpZiBjb252ZXJ0ZWQgdG8gWE1MLlxyXG53aW5kb3cuZml4VW5kZWZpbmVkID0gZnVuY3Rpb24ob2JqKSB7XHJcbiAgICB2YXIgaXNBcnJheSA9IG9iaiBpbnN0YW5jZW9mIEFycmF5O1xyXG4gICAgZm9yICh2YXIgaiBpbiBvYmopIHtcclxuICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGopKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Yob2JqW2pdKSA9PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgICAgICBmaXhVbmRlZmluZWQob2JqW2pdKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmKCFpc0FycmF5ICYmIGogIT0gJyQkaGFzaGtleScpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb2JqW2pdID09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JqW2pdID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuLy8gaGVscGVyIGZ1bmN0aW9uIGZvciBnZXR0aW5nIHF1ZXJ5IHN0cmluZyBwYXJhbWV0ZXIgdmFsdWVzLiBBbmd1bGFySlMgc29sdXRpb24gJGxvY2F0aW9uLnNlYXJjaCgpIGRvZXNuJ3Qgd29yayBpbiBJRTguXHJcbndpbmRvdy5nZXRQYXJhbWV0ZXJCeU5hbWUgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAvLyBGSVhNRSAtIFdlYlEgaW5zdGFuY2UgcGFyYW0gaXMgbm90IGVzY2FwZWRcclxuICAgIHZhciBzZWFyY2hBcnIgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnNwbGl0KCc/Jyk7XHJcbiAgICB2YXIgc2VhcmNoID0gJz8nICsgc2VhcmNoQXJyW3NlYXJjaEFyci5sZW5ndGggLSAxXTtcclxuICAgIHZhciBtYXRjaCA9IG5ldyBSZWdFeHAoJ1s/Jl0nICsgbmFtZSArICc9KFteJl0qKScpLmV4ZWMoc2VhcmNoKTtcclxuICAgIHJldHVybiBtYXRjaCAmJiBkZWNvZGVVUklDb21wb25lbnQobWF0Y2hbMV0ucmVwbGFjZSgvXFwrL2csICcgJykpO1xyXG59OyIsIi8qKlxuICogQGxpY2Vuc2UgQW5ndWxhckpTIHYxLjIuMTZcbiAqIChjKSAyMDEwLTIwMTQgR29vZ2xlLCBJbmMuIGh0dHA6Ly9hbmd1bGFyanMub3JnXG4gKiBMaWNlbnNlOiBNSVRcbiAqL1xuKGZ1bmN0aW9uKHdpbmRvdywgYW5ndWxhciwgdW5kZWZpbmVkKSB7J3VzZSBzdHJpY3QnO1xuXG4vKiBqc2hpbnQgbWF4bGVuOiBmYWxzZSAqL1xuXG4vKipcbiAqIEBuZ2RvYyBtb2R1bGVcbiAqIEBuYW1lIG5nQW5pbWF0ZVxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogIyBuZ0FuaW1hdGVcbiAqXG4gKiBUaGUgYG5nQW5pbWF0ZWAgbW9kdWxlIHByb3ZpZGVzIHN1cHBvcnQgZm9yIEphdmFTY3JpcHQsIENTUzMgdHJhbnNpdGlvbiBhbmQgQ1NTMyBrZXlmcmFtZSBhbmltYXRpb24gaG9va3Mgd2l0aGluIGV4aXN0aW5nIGNvcmUgYW5kIGN1c3RvbSBkaXJlY3RpdmVzLlxuICpcbiAqXG4gKiA8ZGl2IGRvYy1tb2R1bGUtY29tcG9uZW50cz1cIm5nQW5pbWF0ZVwiPjwvZGl2PlxuICpcbiAqICMgVXNhZ2VcbiAqXG4gKiBUbyBzZWUgYW5pbWF0aW9ucyBpbiBhY3Rpb24sIGFsbCB0aGF0IGlzIHJlcXVpcmVkIGlzIHRvIGRlZmluZSB0aGUgYXBwcm9wcmlhdGUgQ1NTIGNsYXNzZXNcbiAqIG9yIHRvIHJlZ2lzdGVyIGEgSmF2YVNjcmlwdCBhbmltYXRpb24gdmlhIHRoZSBteU1vZHVsZS5hbmltYXRpb24oKSBmdW5jdGlvbi4gVGhlIGRpcmVjdGl2ZXMgdGhhdCBzdXBwb3J0IGFuaW1hdGlvbiBhdXRvbWF0aWNhbGx5IGFyZTpcbiAqIGBuZ1JlcGVhdGAsIGBuZ0luY2x1ZGVgLCBgbmdJZmAsIGBuZ1N3aXRjaGAsIGBuZ1Nob3dgLCBgbmdIaWRlYCwgYG5nVmlld2AgYW5kIGBuZ0NsYXNzYC4gQ3VzdG9tIGRpcmVjdGl2ZXMgY2FuIHRha2UgYWR2YW50YWdlIG9mIGFuaW1hdGlvblxuICogYnkgdXNpbmcgdGhlIGAkYW5pbWF0ZWAgc2VydmljZS5cbiAqXG4gKiBCZWxvdyBpcyBhIG1vcmUgZGV0YWlsZWQgYnJlYWtkb3duIG9mIHRoZSBzdXBwb3J0ZWQgYW5pbWF0aW9uIGV2ZW50cyBwcm92aWRlZCBieSBwcmUtZXhpc3RpbmcgbmcgZGlyZWN0aXZlczpcbiAqXG4gKiB8IERpcmVjdGl2ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFN1cHBvcnRlZCBBbmltYXRpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nUmVwZWF0I3VzYWdlX2FuaW1hdGlvbnMgbmdSZXBlYXR9ICAgICAgICAgfCBlbnRlciwgbGVhdmUgYW5kIG1vdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IHtAbGluayBuZ1JvdXRlLmRpcmVjdGl2ZTpuZ1ZpZXcjdXNhZ2VfYW5pbWF0aW9ucyBuZ1ZpZXd9ICAgICAgICB8IGVudGVyIGFuZCBsZWF2ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0luY2x1ZGUjdXNhZ2VfYW5pbWF0aW9ucyBuZ0luY2x1ZGV9ICAgICAgIHwgZW50ZXIgYW5kIGxlYXZlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nU3dpdGNoI3VzYWdlX2FuaW1hdGlvbnMgbmdTd2l0Y2h9ICAgICAgICAgfCBlbnRlciBhbmQgbGVhdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdJZiN1c2FnZV9hbmltYXRpb25zIG5nSWZ9ICAgICAgICAgICAgICAgICB8IGVudGVyIGFuZCBsZWF2ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0NsYXNzI3VzYWdlX2FuaW1hdGlvbnMgbmdDbGFzc30gICAgICAgICAgIHwgYWRkIGFuZCByZW1vdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nU2hvdyN1c2FnZV9hbmltYXRpb25zIG5nU2hvdyAmIG5nSGlkZX0gICAgfCBhZGQgYW5kIHJlbW92ZSAodGhlIG5nLWhpZGUgY2xhc3MgdmFsdWUpICAgICAgICAgICB8XG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6Zm9ybSN1c2FnZV9hbmltYXRpb25zIGZvcm19ICAgICAgICAgICAgICAgICB8IGFkZCBhbmQgcmVtb3ZlIChkaXJ0eSwgcHJpc3RpbmUsIHZhbGlkLCBpbnZhbGlkICYgYWxsIG90aGVyIHZhbGlkYXRpb25zKSAgICAgICAgICAgICAgICB8XG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdNb2RlbCN1c2FnZV9hbmltYXRpb25zIG5nTW9kZWx9ICAgICAgICAgICB8IGFkZCBhbmQgcmVtb3ZlIChkaXJ0eSwgcHJpc3RpbmUsIHZhbGlkLCBpbnZhbGlkICYgYWxsIG90aGVyIHZhbGlkYXRpb25zKSAgICAgICAgICAgICAgICB8XG4gKlxuICogWW91IGNhbiBmaW5kIG91dCBtb3JlIGluZm9ybWF0aW9uIGFib3V0IGFuaW1hdGlvbnMgdXBvbiB2aXNpdGluZyBlYWNoIGRpcmVjdGl2ZSBwYWdlLlxuICpcbiAqIEJlbG93IGlzIGFuIGV4YW1wbGUgb2YgaG93IHRvIGFwcGx5IGFuaW1hdGlvbnMgdG8gYSBkaXJlY3RpdmUgdGhhdCBzdXBwb3J0cyBhbmltYXRpb24gaG9va3M6XG4gKlxuICogYGBgaHRtbFxuICogPHN0eWxlIHR5cGU9XCJ0ZXh0L2Nzc1wiPlxuICogLnNsaWRlLm5nLWVudGVyLCAuc2xpZGUubmctbGVhdmUge1xuICogICAtd2Via2l0LXRyYW5zaXRpb246MC41cyBsaW5lYXIgYWxsO1xuICogICB0cmFuc2l0aW9uOjAuNXMgbGluZWFyIGFsbDtcbiAqIH1cbiAqXG4gKiAuc2xpZGUubmctZW50ZXIgeyB9ICAgICAgICAvJiM0Mjsgc3RhcnRpbmcgYW5pbWF0aW9ucyBmb3IgZW50ZXIgJiM0MjsvXG4gKiAuc2xpZGUubmctZW50ZXItYWN0aXZlIHsgfSAvJiM0MjsgdGVybWluYWwgYW5pbWF0aW9ucyBmb3IgZW50ZXIgJiM0MjsvXG4gKiAuc2xpZGUubmctbGVhdmUgeyB9ICAgICAgICAvJiM0Mjsgc3RhcnRpbmcgYW5pbWF0aW9ucyBmb3IgbGVhdmUgJiM0MjsvXG4gKiAuc2xpZGUubmctbGVhdmUtYWN0aXZlIHsgfSAvJiM0MjsgdGVybWluYWwgYW5pbWF0aW9ucyBmb3IgbGVhdmUgJiM0MjsvXG4gKiA8L3N0eWxlPlxuICpcbiAqIDwhLS1cbiAqIHRoZSBhbmltYXRlIHNlcnZpY2Ugd2lsbCBhdXRvbWF0aWNhbGx5IGFkZCAubmctZW50ZXIgYW5kIC5uZy1sZWF2ZSB0byB0aGUgZWxlbWVudFxuICogdG8gdHJpZ2dlciB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uc1xuICogLS0+XG4gKiA8QU5ZIGNsYXNzPVwic2xpZGVcIiBuZy1pbmNsdWRlPVwiLi4uXCI+PC9BTlk+XG4gKiBgYGBcbiAqXG4gKiBLZWVwIGluIG1pbmQgdGhhdCBpZiBhbiBhbmltYXRpb24gaXMgcnVubmluZywgYW55IGNoaWxkIGVsZW1lbnRzIGNhbm5vdCBiZSBhbmltYXRlZCB1bnRpbCB0aGUgcGFyZW50IGVsZW1lbnQnc1xuICogYW5pbWF0aW9uIGhhcyBjb21wbGV0ZWQuXG4gKlxuICogPGgyPkNTUy1kZWZpbmVkIEFuaW1hdGlvbnM8L2gyPlxuICogVGhlIGFuaW1hdGUgc2VydmljZSB3aWxsIGF1dG9tYXRpY2FsbHkgYXBwbHkgdHdvIENTUyBjbGFzc2VzIHRvIHRoZSBhbmltYXRlZCBlbGVtZW50IGFuZCB0aGVzZSB0d28gQ1NTIGNsYXNzZXNcbiAqIGFyZSBkZXNpZ25lZCB0byBjb250YWluIHRoZSBzdGFydCBhbmQgZW5kIENTUyBzdHlsaW5nLiBCb3RoIENTUyB0cmFuc2l0aW9ucyBhbmQga2V5ZnJhbWUgYW5pbWF0aW9ucyBhcmUgc3VwcG9ydGVkXG4gKiBhbmQgY2FuIGJlIHVzZWQgdG8gcGxheSBhbG9uZyB3aXRoIHRoaXMgbmFtaW5nIHN0cnVjdHVyZS5cbiAqXG4gKiBUaGUgZm9sbG93aW5nIGNvZGUgYmVsb3cgZGVtb25zdHJhdGVzIGhvdyB0byBwZXJmb3JtIGFuaW1hdGlvbnMgdXNpbmcgKipDU1MgdHJhbnNpdGlvbnMqKiB3aXRoIEFuZ3VsYXI6XG4gKlxuICogYGBgaHRtbFxuICogPHN0eWxlIHR5cGU9XCJ0ZXh0L2Nzc1wiPlxuICogLyYjNDI7XG4gKiAgVGhlIGFuaW1hdGUgY2xhc3MgaXMgYXBhcnQgb2YgdGhlIGVsZW1lbnQgYW5kIHRoZSBuZy1lbnRlciBjbGFzc1xuICogIGlzIGF0dGFjaGVkIHRvIHRoZSBlbGVtZW50IG9uY2UgdGhlIGVudGVyIGFuaW1hdGlvbiBldmVudCBpcyB0cmlnZ2VyZWRcbiAqICYjNDI7L1xuICogLnJldmVhbC1hbmltYXRpb24ubmctZW50ZXIge1xuICogIC13ZWJraXQtdHJhbnNpdGlvbjogMXMgbGluZWFyIGFsbDsgLyYjNDI7IFNhZmFyaS9DaHJvbWUgJiM0MjsvXG4gKiAgdHJhbnNpdGlvbjogMXMgbGluZWFyIGFsbDsgLyYjNDI7IEFsbCBvdGhlciBtb2Rlcm4gYnJvd3NlcnMgYW5kIElFMTArICYjNDI7L1xuICpcbiAqICAvJiM0MjsgVGhlIGFuaW1hdGlvbiBwcmVwYXJhdGlvbiBjb2RlICYjNDI7L1xuICogIG9wYWNpdHk6IDA7XG4gKiB9XG4gKlxuICogLyYjNDI7XG4gKiAgS2VlcCBpbiBtaW5kIHRoYXQgeW91IHdhbnQgdG8gY29tYmluZSBib3RoIENTU1xuICogIGNsYXNzZXMgdG9nZXRoZXIgdG8gYXZvaWQgYW55IENTUy1zcGVjaWZpY2l0eVxuICogIGNvbmZsaWN0c1xuICogJiM0MjsvXG4gKiAucmV2ZWFsLWFuaW1hdGlvbi5uZy1lbnRlci5uZy1lbnRlci1hY3RpdmUge1xuICogIC8mIzQyOyBUaGUgYW5pbWF0aW9uIGNvZGUgaXRzZWxmICYjNDI7L1xuICogIG9wYWNpdHk6IDE7XG4gKiB9XG4gKiA8L3N0eWxlPlxuICpcbiAqIDxkaXYgY2xhc3M9XCJ2aWV3LWNvbnRhaW5lclwiPlxuICogICA8ZGl2IG5nLXZpZXcgY2xhc3M9XCJyZXZlYWwtYW5pbWF0aW9uXCI+PC9kaXY+XG4gKiA8L2Rpdj5cbiAqIGBgYFxuICpcbiAqIFRoZSBmb2xsb3dpbmcgY29kZSBiZWxvdyBkZW1vbnN0cmF0ZXMgaG93IHRvIHBlcmZvcm0gYW5pbWF0aW9ucyB1c2luZyAqKkNTUyBhbmltYXRpb25zKiogd2l0aCBBbmd1bGFyOlxuICpcbiAqIGBgYGh0bWxcbiAqIDxzdHlsZSB0eXBlPVwidGV4dC9jc3NcIj5cbiAqIC5yZXZlYWwtYW5pbWF0aW9uLm5nLWVudGVyIHtcbiAqICAgLXdlYmtpdC1hbmltYXRpb246IGVudGVyX3NlcXVlbmNlIDFzIGxpbmVhcjsgLyYjNDI7IFNhZmFyaS9DaHJvbWUgJiM0MjsvXG4gKiAgIGFuaW1hdGlvbjogZW50ZXJfc2VxdWVuY2UgMXMgbGluZWFyOyAvJiM0MjsgSUUxMCsgYW5kIEZ1dHVyZSBCcm93c2VycyAmIzQyOy9cbiAqIH1cbiAqIEAtd2Via2l0LWtleWZyYW1lcyBlbnRlcl9zZXF1ZW5jZSB7XG4gKiAgIGZyb20geyBvcGFjaXR5OjA7IH1cbiAqICAgdG8geyBvcGFjaXR5OjE7IH1cbiAqIH1cbiAqIEBrZXlmcmFtZXMgZW50ZXJfc2VxdWVuY2Uge1xuICogICBmcm9tIHsgb3BhY2l0eTowOyB9XG4gKiAgIHRvIHsgb3BhY2l0eToxOyB9XG4gKiB9XG4gKiA8L3N0eWxlPlxuICpcbiAqIDxkaXYgY2xhc3M9XCJ2aWV3LWNvbnRhaW5lclwiPlxuICogICA8ZGl2IG5nLXZpZXcgY2xhc3M9XCJyZXZlYWwtYW5pbWF0aW9uXCI+PC9kaXY+XG4gKiA8L2Rpdj5cbiAqIGBgYFxuICpcbiAqIEJvdGggQ1NTMyBhbmltYXRpb25zIGFuZCB0cmFuc2l0aW9ucyBjYW4gYmUgdXNlZCB0b2dldGhlciBhbmQgdGhlIGFuaW1hdGUgc2VydmljZSB3aWxsIGZpZ3VyZSBvdXQgdGhlIGNvcnJlY3QgZHVyYXRpb24gYW5kIGRlbGF5IHRpbWluZy5cbiAqXG4gKiBVcG9uIERPTSBtdXRhdGlvbiwgdGhlIGV2ZW50IGNsYXNzIGlzIGFkZGVkIGZpcnN0IChzb21ldGhpbmcgbGlrZSBgbmctZW50ZXJgKSwgdGhlbiB0aGUgYnJvd3NlciBwcmVwYXJlcyBpdHNlbGYgdG8gYWRkXG4gKiB0aGUgYWN0aXZlIGNsYXNzIChpbiB0aGlzIGNhc2UgYG5nLWVudGVyLWFjdGl2ZWApIHdoaWNoIHRoZW4gdHJpZ2dlcnMgdGhlIGFuaW1hdGlvbi4gVGhlIGFuaW1hdGlvbiBtb2R1bGUgd2lsbCBhdXRvbWF0aWNhbGx5XG4gKiBkZXRlY3QgdGhlIENTUyBjb2RlIHRvIGRldGVybWluZSB3aGVuIHRoZSBhbmltYXRpb24gZW5kcy4gT25jZSB0aGUgYW5pbWF0aW9uIGlzIG92ZXIgdGhlbiBib3RoIENTUyBjbGFzc2VzIHdpbGwgYmVcbiAqIHJlbW92ZWQgZnJvbSB0aGUgRE9NLiBJZiBhIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBDU1MgdHJhbnNpdGlvbnMgb3IgQ1NTIGFuaW1hdGlvbnMgdGhlbiB0aGUgYW5pbWF0aW9uIHdpbGwgc3RhcnQgYW5kIGVuZFxuICogaW1tZWRpYXRlbHkgcmVzdWx0aW5nIGluIGEgRE9NIGVsZW1lbnQgdGhhdCBpcyBhdCBpdHMgZmluYWwgc3RhdGUuIFRoaXMgZmluYWwgc3RhdGUgaXMgd2hlbiB0aGUgRE9NIGVsZW1lbnRcbiAqIGhhcyBubyBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24gY2xhc3NlcyBhcHBsaWVkIHRvIGl0LlxuICpcbiAqIDxoMz5DU1MgU3RhZ2dlcmluZyBBbmltYXRpb25zPC9oMz5cbiAqIEEgU3RhZ2dlcmluZyBhbmltYXRpb24gaXMgYSBjb2xsZWN0aW9uIG9mIGFuaW1hdGlvbnMgdGhhdCBhcmUgaXNzdWVkIHdpdGggYSBzbGlnaHQgZGVsYXkgaW4gYmV0d2VlbiBlYWNoIHN1Y2Nlc3NpdmUgb3BlcmF0aW9uIHJlc3VsdGluZyBpbiBhXG4gKiBjdXJ0YWluLWxpa2UgZWZmZWN0LiBUaGUgbmdBbmltYXRlIG1vZHVsZSwgYXMgb2YgMS4yLjAsIHN1cHBvcnRzIHN0YWdnZXJpbmcgYW5pbWF0aW9ucyBhbmQgdGhlIHN0YWdnZXIgZWZmZWN0IGNhbiBiZVxuICogcGVyZm9ybWVkIGJ5IGNyZWF0aW5nIGEgKipuZy1FVkVOVC1zdGFnZ2VyKiogQ1NTIGNsYXNzIGFuZCBhdHRhY2hpbmcgdGhhdCBjbGFzcyB0byB0aGUgYmFzZSBDU1MgY2xhc3MgdXNlZCBmb3JcbiAqIHRoZSBhbmltYXRpb24uIFRoZSBzdHlsZSBwcm9wZXJ0eSBleHBlY3RlZCB3aXRoaW4gdGhlIHN0YWdnZXIgY2xhc3MgY2FuIGVpdGhlciBiZSBhICoqdHJhbnNpdGlvbi1kZWxheSoqIG9yIGFuXG4gKiAqKmFuaW1hdGlvbi1kZWxheSoqIHByb3BlcnR5IChvciBib3RoIGlmIHlvdXIgYW5pbWF0aW9uIGNvbnRhaW5zIGJvdGggdHJhbnNpdGlvbnMgYW5kIGtleWZyYW1lIGFuaW1hdGlvbnMpLlxuICpcbiAqIGBgYGNzc1xuICogLm15LWFuaW1hdGlvbi5uZy1lbnRlciB7XG4gKiAgIC8mIzQyOyBzdGFuZGFyZCB0cmFuc2l0aW9uIGNvZGUgJiM0MjsvXG4gKiAgIC13ZWJraXQtdHJhbnNpdGlvbjogMXMgbGluZWFyIGFsbDtcbiAqICAgdHJhbnNpdGlvbjogMXMgbGluZWFyIGFsbDtcbiAqICAgb3BhY2l0eTowO1xuICogfVxuICogLm15LWFuaW1hdGlvbi5uZy1lbnRlci1zdGFnZ2VyIHtcbiAqICAgLyYjNDI7IHRoaXMgd2lsbCBoYXZlIGEgMTAwbXMgZGVsYXkgYmV0d2VlbiBlYWNoIHN1Y2Nlc3NpdmUgbGVhdmUgYW5pbWF0aW9uICYjNDI7L1xuICogICAtd2Via2l0LXRyYW5zaXRpb24tZGVsYXk6IDAuMXM7XG4gKiAgIHRyYW5zaXRpb24tZGVsYXk6IDAuMXM7XG4gKlxuICogICAvJiM0MjsgaW4gY2FzZSB0aGUgc3RhZ2dlciBkb2Vzbid0IHdvcmsgdGhlbiB0aGVzZSB0d28gdmFsdWVzXG4gKiAgICBtdXN0IGJlIHNldCB0byAwIHRvIGF2b2lkIGFuIGFjY2lkZW50YWwgQ1NTIGluaGVyaXRhbmNlICYjNDI7L1xuICogICAtd2Via2l0LXRyYW5zaXRpb24tZHVyYXRpb246IDBzO1xuICogICB0cmFuc2l0aW9uLWR1cmF0aW9uOiAwcztcbiAqIH1cbiAqIC5teS1hbmltYXRpb24ubmctZW50ZXIubmctZW50ZXItYWN0aXZlIHtcbiAqICAgLyYjNDI7IHN0YW5kYXJkIHRyYW5zaXRpb24gc3R5bGVzICYjNDI7L1xuICogICBvcGFjaXR5OjE7XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBTdGFnZ2VyaW5nIGFuaW1hdGlvbnMgd29yayBieSBkZWZhdWx0IGluIG5nUmVwZWF0IChzbyBsb25nIGFzIHRoZSBDU1MgY2xhc3MgaXMgZGVmaW5lZCkuIE91dHNpZGUgb2YgbmdSZXBlYXQsIHRvIHVzZSBzdGFnZ2VyaW5nIGFuaW1hdGlvbnNcbiAqIG9uIHlvdXIgb3duLCB0aGV5IGNhbiBiZSB0cmlnZ2VyZWQgYnkgZmlyaW5nIG11bHRpcGxlIGNhbGxzIHRvIHRoZSBzYW1lIGV2ZW50IG9uICRhbmltYXRlLiBIb3dldmVyLCB0aGUgcmVzdHJpY3Rpb25zIHN1cnJvdW5kaW5nIHRoaXNcbiAqIGFyZSB0aGF0IGVhY2ggb2YgdGhlIGVsZW1lbnRzIG11c3QgaGF2ZSB0aGUgc2FtZSBDU1MgY2xhc3NOYW1lIHZhbHVlIGFzIHdlbGwgYXMgdGhlIHNhbWUgcGFyZW50IGVsZW1lbnQuIEEgc3RhZ2dlciBvcGVyYXRpb25cbiAqIHdpbGwgYWxzbyBiZSByZXNldCBpZiBtb3JlIHRoYW4gMTBtcyBoYXMgcGFzc2VkIGFmdGVyIHRoZSBsYXN0IGFuaW1hdGlvbiBoYXMgYmVlbiBmaXJlZC5cbiAqXG4gKiBUaGUgZm9sbG93aW5nIGNvZGUgd2lsbCBpc3N1ZSB0aGUgKipuZy1sZWF2ZS1zdGFnZ2VyKiogZXZlbnQgb24gdGhlIGVsZW1lbnQgcHJvdmlkZWQ6XG4gKlxuICogYGBganNcbiAqIHZhciBraWRzID0gcGFyZW50LmNoaWxkcmVuKCk7XG4gKlxuICogJGFuaW1hdGUubGVhdmUoa2lkc1swXSk7IC8vc3RhZ2dlciBpbmRleD0wXG4gKiAkYW5pbWF0ZS5sZWF2ZShraWRzWzFdKTsgLy9zdGFnZ2VyIGluZGV4PTFcbiAqICRhbmltYXRlLmxlYXZlKGtpZHNbMl0pOyAvL3N0YWdnZXIgaW5kZXg9MlxuICogJGFuaW1hdGUubGVhdmUoa2lkc1szXSk7IC8vc3RhZ2dlciBpbmRleD0zXG4gKiAkYW5pbWF0ZS5sZWF2ZShraWRzWzRdKTsgLy9zdGFnZ2VyIGluZGV4PTRcbiAqXG4gKiAkdGltZW91dChmdW5jdGlvbigpIHtcbiAqICAgLy9zdGFnZ2VyIGhhcyByZXNldCBpdHNlbGZcbiAqICAgJGFuaW1hdGUubGVhdmUoa2lkc1s1XSk7IC8vc3RhZ2dlciBpbmRleD0wXG4gKiAgICRhbmltYXRlLmxlYXZlKGtpZHNbNl0pOyAvL3N0YWdnZXIgaW5kZXg9MVxuICogfSwgMTAwLCBmYWxzZSk7XG4gKiBgYGBcbiAqXG4gKiBTdGFnZ2VyIGFuaW1hdGlvbnMgYXJlIGN1cnJlbnRseSBvbmx5IHN1cHBvcnRlZCB3aXRoaW4gQ1NTLWRlZmluZWQgYW5pbWF0aW9ucy5cbiAqXG4gKiA8aDI+SmF2YVNjcmlwdC1kZWZpbmVkIEFuaW1hdGlvbnM8L2gyPlxuICogSW4gdGhlIGV2ZW50IHRoYXQgeW91IGRvIG5vdCB3YW50IHRvIHVzZSBDU1MzIHRyYW5zaXRpb25zIG9yIENTUzMgYW5pbWF0aW9ucyBvciBpZiB5b3Ugd2lzaCB0byBvZmZlciBhbmltYXRpb25zIG9uIGJyb3dzZXJzIHRoYXQgZG8gbm90XG4gKiB5ZXQgc3VwcG9ydCBDU1MgdHJhbnNpdGlvbnMvYW5pbWF0aW9ucywgdGhlbiB5b3UgY2FuIG1ha2UgdXNlIG9mIEphdmFTY3JpcHQgYW5pbWF0aW9ucyBkZWZpbmVkIGluc2lkZSBvZiB5b3VyIEFuZ3VsYXJKUyBtb2R1bGUuXG4gKlxuICogYGBganNcbiAqIC8vIWFubm90YXRlPVwiWW91ckFwcFwiIFlvdXIgQW5ndWxhckpTIE1vZHVsZXxSZXBsYWNlIHRoaXMgb3IgbmdNb2R1bGUgd2l0aCB0aGUgbW9kdWxlIHRoYXQgeW91IHVzZWQgdG8gZGVmaW5lIHlvdXIgYXBwbGljYXRpb24uXG4gKiB2YXIgbmdNb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnWW91ckFwcCcsIFsnbmdBbmltYXRlJ10pO1xuICogbmdNb2R1bGUuYW5pbWF0aW9uKCcubXktY3JhenktYW5pbWF0aW9uJywgZnVuY3Rpb24oKSB7XG4gKiAgIHJldHVybiB7XG4gKiAgICAgZW50ZXI6IGZ1bmN0aW9uKGVsZW1lbnQsIGRvbmUpIHtcbiAqICAgICAgIC8vcnVuIHRoZSBhbmltYXRpb24gaGVyZSBhbmQgY2FsbCBkb25lIHdoZW4gdGhlIGFuaW1hdGlvbiBpcyBjb21wbGV0ZVxuICogICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNhbmNlbGxlZCkge1xuICogICAgICAgICAvL3RoaXMgKG9wdGlvbmFsKSBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBhbmltYXRpb25cbiAqICAgICAgICAgLy9jb21wbGV0ZXMgb3Igd2hlbiB0aGUgYW5pbWF0aW9uIGlzIGNhbmNlbGxlZCAodGhlIGNhbmNlbGxlZFxuICogICAgICAgICAvL2ZsYWcgd2lsbCBiZSBzZXQgdG8gdHJ1ZSBpZiBjYW5jZWxsZWQpLlxuICogICAgICAgfTtcbiAqICAgICB9LFxuICogICAgIGxlYXZlOiBmdW5jdGlvbihlbGVtZW50LCBkb25lKSB7IH0sXG4gKiAgICAgbW92ZTogZnVuY3Rpb24oZWxlbWVudCwgZG9uZSkgeyB9LFxuICpcbiAqICAgICAvL2FuaW1hdGlvbiB0aGF0IGNhbiBiZSB0cmlnZ2VyZWQgYmVmb3JlIHRoZSBjbGFzcyBpcyBhZGRlZFxuICogICAgIGJlZm9yZUFkZENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpIHsgfSxcbiAqXG4gKiAgICAgLy9hbmltYXRpb24gdGhhdCBjYW4gYmUgdHJpZ2dlcmVkIGFmdGVyIHRoZSBjbGFzcyBpcyBhZGRlZFxuICogICAgIGFkZENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpIHsgfSxcbiAqXG4gKiAgICAgLy9hbmltYXRpb24gdGhhdCBjYW4gYmUgdHJpZ2dlcmVkIGJlZm9yZSB0aGUgY2xhc3MgaXMgcmVtb3ZlZFxuICogICAgIGJlZm9yZVJlbW92ZUNsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpIHsgfSxcbiAqXG4gKiAgICAgLy9hbmltYXRpb24gdGhhdCBjYW4gYmUgdHJpZ2dlcmVkIGFmdGVyIHRoZSBjbGFzcyBpcyByZW1vdmVkXG4gKiAgICAgcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZSkgeyB9XG4gKiAgIH07XG4gKiB9KTtcbiAqIGBgYFxuICpcbiAqIEphdmFTY3JpcHQtZGVmaW5lZCBhbmltYXRpb25zIGFyZSBjcmVhdGVkIHdpdGggYSBDU1MtbGlrZSBjbGFzcyBzZWxlY3RvciBhbmQgYSBjb2xsZWN0aW9uIG9mIGV2ZW50cyB3aGljaCBhcmUgc2V0IHRvIHJ1blxuICogYSBqYXZhc2NyaXB0IGNhbGxiYWNrIGZ1bmN0aW9uLiBXaGVuIGFuIGFuaW1hdGlvbiBpcyB0cmlnZ2VyZWQsICRhbmltYXRlIHdpbGwgbG9vayBmb3IgYSBtYXRjaGluZyBhbmltYXRpb24gd2hpY2ggZml0c1xuICogdGhlIGVsZW1lbnQncyBDU1MgY2xhc3MgYXR0cmlidXRlIHZhbHVlIGFuZCB0aGVuIHJ1biB0aGUgbWF0Y2hpbmcgYW5pbWF0aW9uIGV2ZW50IGZ1bmN0aW9uIChpZiBmb3VuZCkuXG4gKiBJbiBvdGhlciB3b3JkcywgaWYgdGhlIENTUyBjbGFzc2VzIHByZXNlbnQgb24gdGhlIGFuaW1hdGVkIGVsZW1lbnQgbWF0Y2ggYW55IG9mIHRoZSBKYXZhU2NyaXB0IGFuaW1hdGlvbnMgdGhlbiB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gd2lsbFxuICogYmUgZXhlY3V0ZWQuIEl0IHNob3VsZCBiZSBhbHNvIG5vdGVkIHRoYXQgb25seSBzaW1wbGUsIHNpbmdsZSBjbGFzcyBzZWxlY3RvcnMgYXJlIGFsbG93ZWQgKGNvbXBvdW5kIGNsYXNzIHNlbGVjdG9ycyBhcmUgbm90IHN1cHBvcnRlZCkuXG4gKlxuICogV2l0aGluIGEgSmF2YVNjcmlwdCBhbmltYXRpb24sIGFuIG9iamVjdCBjb250YWluaW5nIHZhcmlvdXMgZXZlbnQgY2FsbGJhY2sgYW5pbWF0aW9uIGZ1bmN0aW9ucyBpcyBleHBlY3RlZCB0byBiZSByZXR1cm5lZC5cbiAqIEFzIGV4cGxhaW5lZCBhYm92ZSwgdGhlc2UgY2FsbGJhY2tzIGFyZSB0cmlnZ2VyZWQgYmFzZWQgb24gdGhlIGFuaW1hdGlvbiBldmVudC4gVGhlcmVmb3JlIGlmIGFuIGVudGVyIGFuaW1hdGlvbiBpcyBydW4sXG4gKiBhbmQgdGhlIEphdmFTY3JpcHQgYW5pbWF0aW9uIGlzIGZvdW5kLCB0aGVuIHRoZSBlbnRlciBjYWxsYmFjayB3aWxsIGhhbmRsZSB0aGF0IGFuaW1hdGlvbiAoaW4gYWRkaXRpb24gdG8gdGhlIENTUyBrZXlmcmFtZSBhbmltYXRpb25cbiAqIG9yIHRyYW5zaXRpb24gY29kZSB0aGF0IGlzIGRlZmluZWQgdmlhIGEgc3R5bGVzaGVldCkuXG4gKlxuICovXG5cbmFuZ3VsYXIubW9kdWxlKCduZ0FuaW1hdGUnLCBbJ25nJ10pXG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBwcm92aWRlclxuICAgKiBAbmFtZSAkYW5pbWF0ZVByb3ZpZGVyXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBUaGUgYCRhbmltYXRlUHJvdmlkZXJgIGFsbG93cyBkZXZlbG9wZXJzIHRvIHJlZ2lzdGVyIEphdmFTY3JpcHQgYW5pbWF0aW9uIGV2ZW50IGhhbmRsZXJzIGRpcmVjdGx5IGluc2lkZSBvZiBhIG1vZHVsZS5cbiAgICogV2hlbiBhbiBhbmltYXRpb24gaXMgdHJpZ2dlcmVkLCB0aGUgJGFuaW1hdGUgc2VydmljZSB3aWxsIHF1ZXJ5IHRoZSAkYW5pbWF0ZSBzZXJ2aWNlIHRvIGZpbmQgYW55IGFuaW1hdGlvbnMgdGhhdCBtYXRjaFxuICAgKiB0aGUgcHJvdmlkZWQgbmFtZSB2YWx1ZS5cbiAgICpcbiAgICogUmVxdWlyZXMgdGhlIHtAbGluayBuZ0FuaW1hdGUgYG5nQW5pbWF0ZWB9IG1vZHVsZSB0byBiZSBpbnN0YWxsZWQuXG4gICAqXG4gICAqIFBsZWFzZSB2aXNpdCB0aGUge0BsaW5rIG5nQW5pbWF0ZSBgbmdBbmltYXRlYH0gbW9kdWxlIG92ZXJ2aWV3IHBhZ2UgbGVhcm4gbW9yZSBhYm91dCBob3cgdG8gdXNlIGFuaW1hdGlvbnMgaW4geW91ciBhcHBsaWNhdGlvbi5cbiAgICpcbiAgICovXG5cbiAgLy90aGlzIHByaXZhdGUgc2VydmljZSBpcyBvbmx5IHVzZWQgd2l0aGluIENTUy1lbmFibGVkIGFuaW1hdGlvbnNcbiAgLy9JRTggKyBJRTkgZG8gbm90IHN1cHBvcnQgckFGIG5hdGl2ZWx5LCBidXQgdGhhdCBpcyBmaW5lIHNpbmNlIHRoZXlcbiAgLy9hbHNvIGRvbid0IHN1cHBvcnQgdHJhbnNpdGlvbnMgYW5kIGtleWZyYW1lcyB3aGljaCBtZWFucyB0aGF0IHRoZSBjb2RlXG4gIC8vYmVsb3cgd2lsbCBuZXZlciBiZSB1c2VkIGJ5IHRoZSB0d28gYnJvd3NlcnMuXG4gIC5mYWN0b3J5KCckJGFuaW1hdGVSZWZsb3cnLCBbJyQkckFGJywgJyRkb2N1bWVudCcsIGZ1bmN0aW9uKCQkckFGLCAkZG9jdW1lbnQpIHtcbiAgICB2YXIgYm9kID0gJGRvY3VtZW50WzBdLmJvZHk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGZuKSB7XG4gICAgICAvL3RoZSByZXR1cm5lZCBmdW5jdGlvbiBhY3RzIGFzIHRoZSBjYW5jZWxsYXRpb24gZnVuY3Rpb25cbiAgICAgIHJldHVybiAkJHJBRihmdW5jdGlvbigpIHtcbiAgICAgICAgLy90aGUgbGluZSBiZWxvdyB3aWxsIGZvcmNlIHRoZSBicm93c2VyIHRvIHBlcmZvcm0gYSByZXBhaW50XG4gICAgICAgIC8vc28gdGhhdCBhbGwgdGhlIGFuaW1hdGVkIGVsZW1lbnRzIHdpdGhpbiB0aGUgYW5pbWF0aW9uIGZyYW1lXG4gICAgICAgIC8vd2lsbCBiZSBwcm9wZXJseSB1cGRhdGVkIGFuZCBkcmF3biBvbiBzY3JlZW4uIFRoaXMgaXNcbiAgICAgICAgLy9yZXF1aXJlZCB0byBwZXJmb3JtIG11bHRpLWNsYXNzIENTUyBiYXNlZCBhbmltYXRpb25zIHdpdGhcbiAgICAgICAgLy9GaXJlZm94LiBETyBOT1QgUkVNT1ZFIFRISVMgTElORS5cbiAgICAgICAgdmFyIGEgPSBib2Qub2Zmc2V0V2lkdGggKyAxO1xuICAgICAgICBmbigpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfV0pXG5cbiAgLmNvbmZpZyhbJyRwcm92aWRlJywgJyRhbmltYXRlUHJvdmlkZXInLCBmdW5jdGlvbigkcHJvdmlkZSwgJGFuaW1hdGVQcm92aWRlcikge1xuICAgIHZhciBub29wID0gYW5ndWxhci5ub29wO1xuICAgIHZhciBmb3JFYWNoID0gYW5ndWxhci5mb3JFYWNoO1xuICAgIHZhciBzZWxlY3RvcnMgPSAkYW5pbWF0ZVByb3ZpZGVyLiQkc2VsZWN0b3JzO1xuXG4gICAgdmFyIEVMRU1FTlRfTk9ERSA9IDE7XG4gICAgdmFyIE5HX0FOSU1BVEVfU1RBVEUgPSAnJCRuZ0FuaW1hdGVTdGF0ZSc7XG4gICAgdmFyIE5HX0FOSU1BVEVfQ0xBU1NfTkFNRSA9ICduZy1hbmltYXRlJztcbiAgICB2YXIgcm9vdEFuaW1hdGVTdGF0ZSA9IHtydW5uaW5nOiB0cnVlfTtcblxuICAgIGZ1bmN0aW9uIGV4dHJhY3RFbGVtZW50Tm9kZShlbGVtZW50KSB7XG4gICAgICBmb3IodmFyIGkgPSAwOyBpIDwgZWxlbWVudC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgZWxtID0gZWxlbWVudFtpXTtcbiAgICAgICAgaWYoZWxtLm5vZGVUeXBlID09IEVMRU1FTlRfTk9ERSkge1xuICAgICAgICAgIHJldHVybiBlbG07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdHJpcENvbW1lbnRzRnJvbUVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgcmV0dXJuIGFuZ3VsYXIuZWxlbWVudChleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzTWF0Y2hpbmdFbGVtZW50KGVsbTEsIGVsbTIpIHtcbiAgICAgIHJldHVybiBleHRyYWN0RWxlbWVudE5vZGUoZWxtMSkgPT0gZXh0cmFjdEVsZW1lbnROb2RlKGVsbTIpO1xuICAgIH1cblxuICAgICRwcm92aWRlLmRlY29yYXRvcignJGFuaW1hdGUnLCBbJyRkZWxlZ2F0ZScsICckaW5qZWN0b3InLCAnJHNuaWZmZXInLCAnJHJvb3RFbGVtZW50JywgJyQkYXN5bmNDYWxsYmFjaycsICckcm9vdFNjb3BlJywgJyRkb2N1bWVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oJGRlbGVnYXRlLCAgICRpbmplY3RvciwgICAkc25pZmZlciwgICAkcm9vdEVsZW1lbnQsICAgJCRhc3luY0NhbGxiYWNrLCAgICAkcm9vdFNjb3BlLCAgICRkb2N1bWVudCkge1xuXG4gICAgICB2YXIgZ2xvYmFsQW5pbWF0aW9uQ291bnRlciA9IDA7XG4gICAgICAkcm9vdEVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFLCByb290QW5pbWF0ZVN0YXRlKTtcblxuICAgICAgLy8gZGlzYWJsZSBhbmltYXRpb25zIGR1cmluZyBib290c3RyYXAsIGJ1dCBvbmNlIHdlIGJvb3RzdHJhcHBlZCwgd2FpdCBhZ2FpblxuICAgICAgLy8gZm9yIGFub3RoZXIgZGlnZXN0IHVudGlsIGVuYWJsaW5nIGFuaW1hdGlvbnMuIFRoZSByZWFzb24gd2h5IHdlIGRpZ2VzdCB0d2ljZVxuICAgICAgLy8gaXMgYmVjYXVzZSBhbGwgc3RydWN0dXJhbCBhbmltYXRpb25zIChlbnRlciwgbGVhdmUgYW5kIG1vdmUpIGFsbCBwZXJmb3JtIGFcbiAgICAgIC8vIHBvc3QgZGlnZXN0IG9wZXJhdGlvbiBiZWZvcmUgYW5pbWF0aW5nLiBJZiB3ZSBvbmx5IHdhaXQgZm9yIGEgc2luZ2xlIGRpZ2VzdFxuICAgICAgLy8gdG8gcGFzcyB0aGVuIHRoZSBzdHJ1Y3R1cmFsIGFuaW1hdGlvbiB3b3VsZCByZW5kZXIgaXRzIGFuaW1hdGlvbiBvbiBwYWdlIGxvYWQuXG4gICAgICAvLyAod2hpY2ggaXMgd2hhdCB3ZSdyZSB0cnlpbmcgdG8gYXZvaWQgd2hlbiB0aGUgYXBwbGljYXRpb24gZmlyc3QgYm9vdHMgdXAuKVxuICAgICAgJHJvb3RTY29wZS4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKSB7XG4gICAgICAgICRyb290U2NvcGUuJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJvb3RBbmltYXRlU3RhdGUucnVubmluZyA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICB2YXIgY2xhc3NOYW1lRmlsdGVyID0gJGFuaW1hdGVQcm92aWRlci5jbGFzc05hbWVGaWx0ZXIoKTtcbiAgICAgIHZhciBpc0FuaW1hdGFibGVDbGFzc05hbWUgPSAhY2xhc3NOYW1lRmlsdGVyXG4gICAgICAgICAgICAgID8gZnVuY3Rpb24oKSB7IHJldHVybiB0cnVlOyB9XG4gICAgICAgICAgICAgIDogZnVuY3Rpb24oY2xhc3NOYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNsYXNzTmFtZUZpbHRlci50ZXN0KGNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgIH07XG5cbiAgICAgIGZ1bmN0aW9uIGxvb2t1cChuYW1lKSB7XG4gICAgICAgIGlmIChuYW1lKSB7XG4gICAgICAgICAgdmFyIG1hdGNoZXMgPSBbXSxcbiAgICAgICAgICAgICAgZmxhZ01hcCA9IHt9LFxuICAgICAgICAgICAgICBjbGFzc2VzID0gbmFtZS5zdWJzdHIoMSkuc3BsaXQoJy4nKTtcblxuICAgICAgICAgIC8vdGhlIGVtcHR5IHN0cmluZyB2YWx1ZSBpcyB0aGUgZGVmYXVsdCBhbmltYXRpb25cbiAgICAgICAgICAvL29wZXJhdGlvbiB3aGljaCBwZXJmb3JtcyBDU1MgdHJhbnNpdGlvbiBhbmQga2V5ZnJhbWVcbiAgICAgICAgICAvL2FuaW1hdGlvbnMgc25pZmZpbmcuIFRoaXMgaXMgYWx3YXlzIGluY2x1ZGVkIGZvciBlYWNoXG4gICAgICAgICAgLy9lbGVtZW50IGFuaW1hdGlvbiBwcm9jZWR1cmUgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHNcbiAgICAgICAgICAvL3RyYW5zaXRpb25zIGFuZC9vciBrZXlmcmFtZSBhbmltYXRpb25zLiBUaGUgZGVmYXVsdFxuICAgICAgICAgIC8vYW5pbWF0aW9uIGlzIGFkZGVkIHRvIHRoZSB0b3Agb2YgdGhlIGxpc3QgdG8gcHJldmVudFxuICAgICAgICAgIC8vYW55IHByZXZpb3VzIGFuaW1hdGlvbnMgZnJvbSBhZmZlY3RpbmcgdGhlIGVsZW1lbnQgc3R5bGluZ1xuICAgICAgICAgIC8vcHJpb3IgdG8gdGhlIGVsZW1lbnQgYmVpbmcgYW5pbWF0ZWQuXG4gICAgICAgICAgaWYgKCRzbmlmZmVyLnRyYW5zaXRpb25zIHx8ICRzbmlmZmVyLmFuaW1hdGlvbnMpIHtcbiAgICAgICAgICAgIG1hdGNoZXMucHVzaCgkaW5qZWN0b3IuZ2V0KHNlbGVjdG9yc1snJ10pKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmb3IodmFyIGk9MDsgaSA8IGNsYXNzZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBrbGFzcyA9IGNsYXNzZXNbaV0sXG4gICAgICAgICAgICAgICAgc2VsZWN0b3JGYWN0b3J5TmFtZSA9IHNlbGVjdG9yc1trbGFzc107XG4gICAgICAgICAgICBpZihzZWxlY3RvckZhY3RvcnlOYW1lICYmICFmbGFnTWFwW2tsYXNzXSkge1xuICAgICAgICAgICAgICBtYXRjaGVzLnB1c2goJGluamVjdG9yLmdldChzZWxlY3RvckZhY3RvcnlOYW1lKSk7XG4gICAgICAgICAgICAgIGZsYWdNYXBba2xhc3NdID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG1hdGNoZXM7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYW5pbWF0aW9uUnVubmVyKGVsZW1lbnQsIGFuaW1hdGlvbkV2ZW50LCBjbGFzc05hbWUpIHtcbiAgICAgICAgLy90cmFuc2NsdWRlZCBkaXJlY3RpdmVzIG1heSBzb21ldGltZXMgZmlyZSBhbiBhbmltYXRpb24gdXNpbmcgb25seSBjb21tZW50IG5vZGVzXG4gICAgICAgIC8vYmVzdCB0byBjYXRjaCB0aGlzIGVhcmx5IG9uIHRvIHByZXZlbnQgYW55IGFuaW1hdGlvbiBvcGVyYXRpb25zIGZyb20gb2NjdXJyaW5nXG4gICAgICAgIHZhciBub2RlID0gZWxlbWVudFswXTtcbiAgICAgICAgaWYoIW5vZGUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgaXNTZXRDbGFzc09wZXJhdGlvbiA9IGFuaW1hdGlvbkV2ZW50ID09ICdzZXRDbGFzcyc7XG4gICAgICAgIHZhciBpc0NsYXNzQmFzZWQgPSBpc1NldENsYXNzT3BlcmF0aW9uIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25FdmVudCA9PSAnYWRkQ2xhc3MnIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25FdmVudCA9PSAncmVtb3ZlQ2xhc3MnO1xuXG4gICAgICAgIHZhciBjbGFzc05hbWVBZGQsIGNsYXNzTmFtZVJlbW92ZTtcbiAgICAgICAgaWYoYW5ndWxhci5pc0FycmF5KGNsYXNzTmFtZSkpIHtcbiAgICAgICAgICBjbGFzc05hbWVBZGQgPSBjbGFzc05hbWVbMF07XG4gICAgICAgICAgY2xhc3NOYW1lUmVtb3ZlID0gY2xhc3NOYW1lWzFdO1xuICAgICAgICAgIGNsYXNzTmFtZSA9IGNsYXNzTmFtZUFkZCArICcgJyArIGNsYXNzTmFtZVJlbW92ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBjdXJyZW50Q2xhc3NOYW1lID0gZWxlbWVudC5hdHRyKCdjbGFzcycpO1xuICAgICAgICB2YXIgY2xhc3NlcyA9IGN1cnJlbnRDbGFzc05hbWUgKyAnICcgKyBjbGFzc05hbWU7XG4gICAgICAgIGlmKCFpc0FuaW1hdGFibGVDbGFzc05hbWUoY2xhc3NlcykpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgYmVmb3JlQ29tcGxldGUgPSBub29wLFxuICAgICAgICAgICAgYmVmb3JlQ2FuY2VsID0gW10sXG4gICAgICAgICAgICBiZWZvcmUgPSBbXSxcbiAgICAgICAgICAgIGFmdGVyQ29tcGxldGUgPSBub29wLFxuICAgICAgICAgICAgYWZ0ZXJDYW5jZWwgPSBbXSxcbiAgICAgICAgICAgIGFmdGVyID0gW107XG5cbiAgICAgICAgdmFyIGFuaW1hdGlvbkxvb2t1cCA9ICgnICcgKyBjbGFzc2VzKS5yZXBsYWNlKC9cXHMrL2csJy4nKTtcbiAgICAgICAgZm9yRWFjaChsb29rdXAoYW5pbWF0aW9uTG9va3VwKSwgZnVuY3Rpb24oYW5pbWF0aW9uRmFjdG9yeSkge1xuICAgICAgICAgIHZhciBjcmVhdGVkID0gcmVnaXN0ZXJBbmltYXRpb24oYW5pbWF0aW9uRmFjdG9yeSwgYW5pbWF0aW9uRXZlbnQpO1xuICAgICAgICAgIGlmKCFjcmVhdGVkICYmIGlzU2V0Q2xhc3NPcGVyYXRpb24pIHtcbiAgICAgICAgICAgIHJlZ2lzdGVyQW5pbWF0aW9uKGFuaW1hdGlvbkZhY3RvcnksICdhZGRDbGFzcycpO1xuICAgICAgICAgICAgcmVnaXN0ZXJBbmltYXRpb24oYW5pbWF0aW9uRmFjdG9yeSwgJ3JlbW92ZUNsYXNzJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBmdW5jdGlvbiByZWdpc3RlckFuaW1hdGlvbihhbmltYXRpb25GYWN0b3J5LCBldmVudCkge1xuICAgICAgICAgIHZhciBhZnRlckZuID0gYW5pbWF0aW9uRmFjdG9yeVtldmVudF07XG4gICAgICAgICAgdmFyIGJlZm9yZUZuID0gYW5pbWF0aW9uRmFjdG9yeVsnYmVmb3JlJyArIGV2ZW50LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgZXZlbnQuc3Vic3RyKDEpXTtcbiAgICAgICAgICBpZihhZnRlckZuIHx8IGJlZm9yZUZuKSB7XG4gICAgICAgICAgICBpZihldmVudCA9PSAnbGVhdmUnKSB7XG4gICAgICAgICAgICAgIGJlZm9yZUZuID0gYWZ0ZXJGbjtcbiAgICAgICAgICAgICAgLy93aGVuIHNldCBhcyBudWxsIHRoZW4gYW5pbWF0aW9uIGtub3dzIHRvIHNraXAgdGhpcyBwaGFzZVxuICAgICAgICAgICAgICBhZnRlckZuID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFmdGVyLnB1c2goe1xuICAgICAgICAgICAgICBldmVudCA6IGV2ZW50LCBmbiA6IGFmdGVyRm5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYmVmb3JlLnB1c2goe1xuICAgICAgICAgICAgICBldmVudCA6IGV2ZW50LCBmbiA6IGJlZm9yZUZuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJ1bihmbnMsIGNhbmNlbGxhdGlvbnMsIGFsbENvbXBsZXRlRm4pIHtcbiAgICAgICAgICB2YXIgYW5pbWF0aW9ucyA9IFtdO1xuICAgICAgICAgIGZvckVhY2goZm5zLCBmdW5jdGlvbihhbmltYXRpb24pIHtcbiAgICAgICAgICAgIGFuaW1hdGlvbi5mbiAmJiBhbmltYXRpb25zLnB1c2goYW5pbWF0aW9uKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBjb3VudCA9IDA7XG4gICAgICAgICAgZnVuY3Rpb24gYWZ0ZXJBbmltYXRpb25Db21wbGV0ZShpbmRleCkge1xuICAgICAgICAgICAgaWYoY2FuY2VsbGF0aW9ucykge1xuICAgICAgICAgICAgICAoY2FuY2VsbGF0aW9uc1tpbmRleF0gfHwgbm9vcCkoKTtcbiAgICAgICAgICAgICAgaWYoKytjb3VudCA8IGFuaW1hdGlvbnMubGVuZ3RoKSByZXR1cm47XG4gICAgICAgICAgICAgIGNhbmNlbGxhdGlvbnMgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWxsQ29tcGxldGVGbigpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vVGhlIGNvZGUgYmVsb3cgYWRkcyBkaXJlY3RseSB0byB0aGUgYXJyYXkgaW4gb3JkZXIgdG8gd29yayB3aXRoXG4gICAgICAgICAgLy9ib3RoIHN5bmMgYW5kIGFzeW5jIGFuaW1hdGlvbnMuIFN5bmMgYW5pbWF0aW9ucyBhcmUgd2hlbiB0aGUgZG9uZSgpXG4gICAgICAgICAgLy9vcGVyYXRpb24gaXMgY2FsbGVkIHJpZ2h0IGF3YXkuIERPIE5PVCBSRUZBQ1RPUiFcbiAgICAgICAgICBmb3JFYWNoKGFuaW1hdGlvbnMsIGZ1bmN0aW9uKGFuaW1hdGlvbiwgaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBwcm9ncmVzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBhZnRlckFuaW1hdGlvbkNvbXBsZXRlKGluZGV4KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzd2l0Y2goYW5pbWF0aW9uLmV2ZW50KSB7XG4gICAgICAgICAgICAgIGNhc2UgJ3NldENsYXNzJzpcbiAgICAgICAgICAgICAgICBjYW5jZWxsYXRpb25zLnB1c2goYW5pbWF0aW9uLmZuKGVsZW1lbnQsIGNsYXNzTmFtZUFkZCwgY2xhc3NOYW1lUmVtb3ZlLCBwcm9ncmVzcykpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlICdhZGRDbGFzcyc6XG4gICAgICAgICAgICAgICAgY2FuY2VsbGF0aW9ucy5wdXNoKGFuaW1hdGlvbi5mbihlbGVtZW50LCBjbGFzc05hbWVBZGQgfHwgY2xhc3NOYW1lLCAgICAgcHJvZ3Jlc3MpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSAncmVtb3ZlQ2xhc3MnOlxuICAgICAgICAgICAgICAgIGNhbmNlbGxhdGlvbnMucHVzaChhbmltYXRpb24uZm4oZWxlbWVudCwgY2xhc3NOYW1lUmVtb3ZlIHx8IGNsYXNzTmFtZSwgIHByb2dyZXNzKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY2FuY2VsbGF0aW9ucy5wdXNoKGFuaW1hdGlvbi5mbihlbGVtZW50LCBwcm9ncmVzcykpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaWYoY2FuY2VsbGF0aW9ucyAmJiBjYW5jZWxsYXRpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgYWxsQ29tcGxldGVGbigpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbm9kZSA6IG5vZGUsXG4gICAgICAgICAgZXZlbnQgOiBhbmltYXRpb25FdmVudCxcbiAgICAgICAgICBjbGFzc05hbWUgOiBjbGFzc05hbWUsXG4gICAgICAgICAgaXNDbGFzc0Jhc2VkIDogaXNDbGFzc0Jhc2VkLFxuICAgICAgICAgIGlzU2V0Q2xhc3NPcGVyYXRpb24gOiBpc1NldENsYXNzT3BlcmF0aW9uLFxuICAgICAgICAgIGJlZm9yZSA6IGZ1bmN0aW9uKGFsbENvbXBsZXRlRm4pIHtcbiAgICAgICAgICAgIGJlZm9yZUNvbXBsZXRlID0gYWxsQ29tcGxldGVGbjtcbiAgICAgICAgICAgIHJ1bihiZWZvcmUsIGJlZm9yZUNhbmNlbCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGJlZm9yZUNvbXBsZXRlID0gbm9vcDtcbiAgICAgICAgICAgICAgYWxsQ29tcGxldGVGbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBhZnRlciA6IGZ1bmN0aW9uKGFsbENvbXBsZXRlRm4pIHtcbiAgICAgICAgICAgIGFmdGVyQ29tcGxldGUgPSBhbGxDb21wbGV0ZUZuO1xuICAgICAgICAgICAgcnVuKGFmdGVyLCBhZnRlckNhbmNlbCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGFmdGVyQ29tcGxldGUgPSBub29wO1xuICAgICAgICAgICAgICBhbGxDb21wbGV0ZUZuKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNhbmNlbCA6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYoYmVmb3JlQ2FuY2VsKSB7XG4gICAgICAgICAgICAgIGZvckVhY2goYmVmb3JlQ2FuY2VsLCBmdW5jdGlvbihjYW5jZWxGbikge1xuICAgICAgICAgICAgICAgIChjYW5jZWxGbiB8fCBub29wKSh0cnVlKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGJlZm9yZUNvbXBsZXRlKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoYWZ0ZXJDYW5jZWwpIHtcbiAgICAgICAgICAgICAgZm9yRWFjaChhZnRlckNhbmNlbCwgZnVuY3Rpb24oY2FuY2VsRm4pIHtcbiAgICAgICAgICAgICAgICAoY2FuY2VsRm4gfHwgbm9vcCkodHJ1ZSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBhZnRlckNvbXBsZXRlKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBAbmdkb2Mgc2VydmljZVxuICAgICAgICogQG5hbWUgJGFuaW1hdGVcbiAgICAgICAqIEBmdW5jdGlvblxuICAgICAgICpcbiAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICogVGhlIGAkYW5pbWF0ZWAgc2VydmljZSBwcm92aWRlcyBhbmltYXRpb24gZGV0ZWN0aW9uIHN1cHBvcnQgd2hpbGUgcGVyZm9ybWluZyBET00gb3BlcmF0aW9ucyAoZW50ZXIsIGxlYXZlIGFuZCBtb3ZlKSBhcyB3ZWxsIGFzIGR1cmluZyBhZGRDbGFzcyBhbmQgcmVtb3ZlQ2xhc3Mgb3BlcmF0aW9ucy5cbiAgICAgICAqIFdoZW4gYW55IG9mIHRoZXNlIG9wZXJhdGlvbnMgYXJlIHJ1biwgdGhlICRhbmltYXRlIHNlcnZpY2VcbiAgICAgICAqIHdpbGwgZXhhbWluZSBhbnkgSmF2YVNjcmlwdC1kZWZpbmVkIGFuaW1hdGlvbnMgKHdoaWNoIGFyZSBkZWZpbmVkIGJ5IHVzaW5nIHRoZSAkYW5pbWF0ZVByb3ZpZGVyIHByb3ZpZGVyIG9iamVjdClcbiAgICAgICAqIGFzIHdlbGwgYXMgYW55IENTUy1kZWZpbmVkIGFuaW1hdGlvbnMgYWdhaW5zdCB0aGUgQ1NTIGNsYXNzZXMgcHJlc2VudCBvbiB0aGUgZWxlbWVudCBvbmNlIHRoZSBET00gb3BlcmF0aW9uIGlzIHJ1bi5cbiAgICAgICAqXG4gICAgICAgKiBUaGUgYCRhbmltYXRlYCBzZXJ2aWNlIGlzIHVzZWQgYmVoaW5kIHRoZSBzY2VuZXMgd2l0aCBwcmUtZXhpc3RpbmcgZGlyZWN0aXZlcyBhbmQgYW5pbWF0aW9uIHdpdGggdGhlc2UgZGlyZWN0aXZlc1xuICAgICAgICogd2lsbCB3b3JrIG91dCBvZiB0aGUgYm94IHdpdGhvdXQgYW55IGV4dHJhIGNvbmZpZ3VyYXRpb24uXG4gICAgICAgKlxuICAgICAgICogUmVxdWlyZXMgdGhlIHtAbGluayBuZ0FuaW1hdGUgYG5nQW5pbWF0ZWB9IG1vZHVsZSB0byBiZSBpbnN0YWxsZWQuXG4gICAgICAgKlxuICAgICAgICogUGxlYXNlIHZpc2l0IHRoZSB7QGxpbmsgbmdBbmltYXRlIGBuZ0FuaW1hdGVgfSBtb2R1bGUgb3ZlcnZpZXcgcGFnZSBsZWFybiBtb3JlIGFib3V0IGhvdyB0byB1c2UgYW5pbWF0aW9ucyBpbiB5b3VyIGFwcGxpY2F0aW9uLlxuICAgICAgICpcbiAgICAgICAqL1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICogQG5hbWUgJGFuaW1hdGUjZW50ZXJcbiAgICAgICAgICogQGZ1bmN0aW9uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBBcHBlbmRzIHRoZSBlbGVtZW50IHRvIHRoZSBwYXJlbnRFbGVtZW50IGVsZW1lbnQgdGhhdCByZXNpZGVzIGluIHRoZSBkb2N1bWVudCBhbmQgdGhlbiBydW5zIHRoZSBlbnRlciBhbmltYXRpb24uIE9uY2VcbiAgICAgICAgICogdGhlIGFuaW1hdGlvbiBpcyBzdGFydGVkLCB0aGUgZm9sbG93aW5nIENTUyBjbGFzc2VzIHdpbGwgYmUgcHJlc2VudCBvbiB0aGUgZWxlbWVudCBmb3IgdGhlIGR1cmF0aW9uIG9mIHRoZSBhbmltYXRpb246XG4gICAgICAgICAqXG4gICAgICAgICAqIEJlbG93IGlzIGEgYnJlYWtkb3duIG9mIGVhY2ggc3RlcCB0aGF0IG9jY3VycyBkdXJpbmcgZW50ZXIgYW5pbWF0aW9uOlxuICAgICAgICAgKlxuICAgICAgICAgKiB8IEFuaW1hdGlvbiBTdGVwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgV2hhdCB0aGUgZWxlbWVudCBjbGFzcyBhdHRyaWJ1dGUgbG9va3MgbGlrZSB8XG4gICAgICAgICAqIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbiAgICAgICAgICogfCAxLiAkYW5pbWF0ZS5lbnRlciguLi4pIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uXCIgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMi4gZWxlbWVudCBpcyBpbnNlcnRlZCBpbnRvIHRoZSBwYXJlbnRFbGVtZW50IGVsZW1lbnQgb3IgYmVzaWRlIHRoZSBhZnRlckVsZW1lbnQgZWxlbWVudCAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvblwiICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDMuICRhbmltYXRlIHJ1bnMgYW55IEphdmFTY3JpcHQtZGVmaW5lZCBhbmltYXRpb25zIG9uIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZVwiICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA0LiB0aGUgLm5nLWVudGVyIGNsYXNzIGlzIGFkZGVkIHRvIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctZW50ZXJcIiAgICB8XG4gICAgICAgICAqIHwgNS4gJGFuaW1hdGUgc2NhbnMgdGhlIGVsZW1lbnQgc3R5bGVzIHRvIGdldCB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uIGR1cmF0aW9uIGFuZCBkZWxheSAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWVudGVyXCIgICAgfFxuICAgICAgICAgKiB8IDYuICRhbmltYXRlIHdhaXRzIGZvciAxMG1zICh0aGlzIHBlcmZvcm1zIGEgcmVmbG93KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1lbnRlclwiICAgIHxcbiAgICAgICAgICogfCA3LiB0aGUgLm5nLWVudGVyLWFjdGl2ZSBhbmQgLm5nLWFuaW1hdGUtYWN0aXZlIGNsYXNzZXMgYXJlIGFkZGVkICh0aGlzIHRyaWdnZXJzIHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24pIHwgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1hbmltYXRlLWFjdGl2ZSBuZy1lbnRlciBuZy1lbnRlci1hY3RpdmVcIiB8XG4gICAgICAgICAqIHwgOC4gJGFuaW1hdGUgd2FpdHMgZm9yIFggbWlsbGlzZWNvbmRzIGZvciB0aGUgYW5pbWF0aW9uIHRvIGNvbXBsZXRlICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWFuaW1hdGUtYWN0aXZlIG5nLWVudGVyIG5nLWVudGVyLWFjdGl2ZVwiIHxcbiAgICAgICAgICogfCA5LiBUaGUgYW5pbWF0aW9uIGVuZHMgYW5kIGFsbCBnZW5lcmF0ZWQgQ1NTIGNsYXNzZXMgYXJlIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudCAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uXCIgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMTAuIFRoZSBkb25lQ2FsbGJhY2soKSBjYWxsYmFjayBpcyBmaXJlZCAoaWYgcHJvdmlkZWQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvblwiICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHRoZSBmb2N1cyBvZiB0aGUgZW50ZXIgYW5pbWF0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gcGFyZW50RWxlbWVudCB0aGUgcGFyZW50IGVsZW1lbnQgb2YgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHRoZSBmb2N1cyBvZiB0aGUgZW50ZXIgYW5pbWF0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gYWZ0ZXJFbGVtZW50IHRoZSBzaWJsaW5nIGVsZW1lbnQgKHdoaWNoIGlzIHRoZSBwcmV2aW91cyBlbGVtZW50KSBvZiB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgdGhlIGZvY3VzIG9mIHRoZSBlbnRlciBhbmltYXRpb25cbiAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbigpPX0gZG9uZUNhbGxiYWNrIHRoZSBjYWxsYmFjayBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIG9uY2UgdGhlIGFuaW1hdGlvbiBpcyBjb21wbGV0ZVxuICAgICAgICAqL1xuICAgICAgICBlbnRlciA6IGZ1bmN0aW9uKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCwgZG9uZUNhbGxiYWNrKSB7XG4gICAgICAgICAgdGhpcy5lbmFibGVkKGZhbHNlLCBlbGVtZW50KTtcbiAgICAgICAgICAkZGVsZWdhdGUuZW50ZXIoZWxlbWVudCwgcGFyZW50RWxlbWVudCwgYWZ0ZXJFbGVtZW50KTtcbiAgICAgICAgICAkcm9vdFNjb3BlLiQkcG9zdERpZ2VzdChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGVsZW1lbnQgPSBzdHJpcENvbW1lbnRzRnJvbUVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgICAgICBwZXJmb3JtQW5pbWF0aW9uKCdlbnRlcicsICduZy1lbnRlcicsIGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCwgbm9vcCwgZG9uZUNhbGxiYWNrKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNsZWF2ZVxuICAgICAgICAgKiBAZnVuY3Rpb25cbiAgICAgICAgICpcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAqIFJ1bnMgdGhlIGxlYXZlIGFuaW1hdGlvbiBvcGVyYXRpb24gYW5kLCB1cG9uIGNvbXBsZXRpb24sIHJlbW92ZXMgdGhlIGVsZW1lbnQgZnJvbSB0aGUgRE9NLiBPbmNlXG4gICAgICAgICAqIHRoZSBhbmltYXRpb24gaXMgc3RhcnRlZCwgdGhlIGZvbGxvd2luZyBDU1MgY2xhc3NlcyB3aWxsIGJlIGFkZGVkIGZvciB0aGUgZHVyYXRpb24gb2YgdGhlIGFuaW1hdGlvbjpcbiAgICAgICAgICpcbiAgICAgICAgICogQmVsb3cgaXMgYSBicmVha2Rvd24gb2YgZWFjaCBzdGVwIHRoYXQgb2NjdXJzIGR1cmluZyBsZWF2ZSBhbmltYXRpb246XG4gICAgICAgICAqXG4gICAgICAgICAqIHwgQW5pbWF0aW9uIFN0ZXAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBXaGF0IHRoZSBlbGVtZW50IGNsYXNzIGF0dHJpYnV0ZSBsb29rcyBsaWtlIHxcbiAgICAgICAgICogfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxuICAgICAgICAgKiB8IDEuICRhbmltYXRlLmxlYXZlKC4uLikgaXMgY2FsbGVkICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb25cIiAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAyLiAkYW5pbWF0ZSBydW5zIGFueSBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGVcIiAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMy4gdGhlIC5uZy1sZWF2ZSBjbGFzcyBpcyBhZGRlZCB0byB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWxlYXZlXCIgICAgfFxuICAgICAgICAgKiB8IDQuICRhbmltYXRlIHNjYW5zIHRoZSBlbGVtZW50IHN0eWxlcyB0byBnZXQgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbiBkdXJhdGlvbiBhbmQgZGVsYXkgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1sZWF2ZVwiICAgIHxcbiAgICAgICAgICogfCA1LiAkYW5pbWF0ZSB3YWl0cyBmb3IgMTBtcyAodGhpcyBwZXJmb3JtcyBhIHJlZmxvdykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbGVhdmVcIiAgICB8XG4gICAgICAgICAqIHwgNi4gdGhlIC5uZy1sZWF2ZS1hY3RpdmUgYW5kIC5uZy1hbmltYXRlLWFjdGl2ZSBjbGFzc2VzIGlzIGFkZGVkICh0aGlzIHRyaWdnZXJzIHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24pIHwgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1hbmltYXRlLWFjdGl2ZSBuZy1sZWF2ZSBuZy1sZWF2ZS1hY3RpdmVcIiB8XG4gICAgICAgICAqIHwgNy4gJGFuaW1hdGUgd2FpdHMgZm9yIFggbWlsbGlzZWNvbmRzIGZvciB0aGUgYW5pbWF0aW9uIHRvIGNvbXBsZXRlICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWFuaW1hdGUtYWN0aXZlIG5nLWxlYXZlIG5nLWxlYXZlLWFjdGl2ZVwiIHxcbiAgICAgICAgICogfCA4LiBUaGUgYW5pbWF0aW9uIGVuZHMgYW5kIGFsbCBnZW5lcmF0ZWQgQ1NTIGNsYXNzZXMgYXJlIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudCAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uXCIgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgOS4gVGhlIGVsZW1lbnQgaXMgcmVtb3ZlZCBmcm9tIHRoZSBET00gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAuLi4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAxMC4gVGhlIGRvbmVDYWxsYmFjaygpIGNhbGxiYWNrIGlzIGZpcmVkIChpZiBwcm92aWRlZCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IC4uLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHRoZSBmb2N1cyBvZiB0aGUgbGVhdmUgYW5pbWF0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oKT19IGRvbmVDYWxsYmFjayB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZCBvbmNlIHRoZSBhbmltYXRpb24gaXMgY29tcGxldGVcbiAgICAgICAgKi9cbiAgICAgICAgbGVhdmUgOiBmdW5jdGlvbihlbGVtZW50LCBkb25lQ2FsbGJhY2spIHtcbiAgICAgICAgICBjYW5jZWxDaGlsZEFuaW1hdGlvbnMoZWxlbWVudCk7XG4gICAgICAgICAgdGhpcy5lbmFibGVkKGZhbHNlLCBlbGVtZW50KTtcbiAgICAgICAgICAkcm9vdFNjb3BlLiQkcG9zdERpZ2VzdChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHBlcmZvcm1BbmltYXRpb24oJ2xlYXZlJywgJ25nLWxlYXZlJywgc3RyaXBDb21tZW50c0Zyb21FbGVtZW50KGVsZW1lbnQpLCBudWxsLCBudWxsLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgJGRlbGVnYXRlLmxlYXZlKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSwgZG9uZUNhbGxiYWNrKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNtb3ZlXG4gICAgICAgICAqIEBmdW5jdGlvblxuICAgICAgICAgKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAgICogRmlyZXMgdGhlIG1vdmUgRE9NIG9wZXJhdGlvbi4gSnVzdCBiZWZvcmUgdGhlIGFuaW1hdGlvbiBzdGFydHMsIHRoZSBhbmltYXRlIHNlcnZpY2Ugd2lsbCBlaXRoZXIgYXBwZW5kIGl0IGludG8gdGhlIHBhcmVudEVsZW1lbnQgY29udGFpbmVyIG9yXG4gICAgICAgICAqIGFkZCB0aGUgZWxlbWVudCBkaXJlY3RseSBhZnRlciB0aGUgYWZ0ZXJFbGVtZW50IGVsZW1lbnQgaWYgcHJlc2VudC4gVGhlbiB0aGUgbW92ZSBhbmltYXRpb24gd2lsbCBiZSBydW4uIE9uY2VcbiAgICAgICAgICogdGhlIGFuaW1hdGlvbiBpcyBzdGFydGVkLCB0aGUgZm9sbG93aW5nIENTUyBjbGFzc2VzIHdpbGwgYmUgYWRkZWQgZm9yIHRoZSBkdXJhdGlvbiBvZiB0aGUgYW5pbWF0aW9uOlxuICAgICAgICAgKlxuICAgICAgICAgKiBCZWxvdyBpcyBhIGJyZWFrZG93biBvZiBlYWNoIHN0ZXAgdGhhdCBvY2N1cnMgZHVyaW5nIG1vdmUgYW5pbWF0aW9uOlxuICAgICAgICAgKlxuICAgICAgICAgKiB8IEFuaW1hdGlvbiBTdGVwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgV2hhdCB0aGUgZWxlbWVudCBjbGFzcyBhdHRyaWJ1dGUgbG9va3MgbGlrZSB8XG4gICAgICAgICAqIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbiAgICAgICAgICogfCAxLiAkYW5pbWF0ZS5tb3ZlKC4uLikgaXMgY2FsbGVkICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uXCIgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMi4gZWxlbWVudCBpcyBtb3ZlZCBpbnRvIHRoZSBwYXJlbnRFbGVtZW50IGVsZW1lbnQgb3IgYmVzaWRlIHRoZSBhZnRlckVsZW1lbnQgZWxlbWVudCAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvblwiICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDMuICRhbmltYXRlIHJ1bnMgYW55IEphdmFTY3JpcHQtZGVmaW5lZCBhbmltYXRpb25zIG9uIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZVwiICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA0LiB0aGUgLm5nLW1vdmUgY2xhc3MgaXMgYWRkZWQgdG8gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbW92ZVwiICAgICB8XG4gICAgICAgICAqIHwgNS4gJGFuaW1hdGUgc2NhbnMgdGhlIGVsZW1lbnQgc3R5bGVzIHRvIGdldCB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uIGR1cmF0aW9uIGFuZCBkZWxheSAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLW1vdmVcIiAgICAgfFxuICAgICAgICAgKiB8IDYuICRhbmltYXRlIHdhaXRzIGZvciAxMG1zICh0aGlzIHBlcmZvcm1zIGEgcmVmbG93KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1tb3ZlXCIgICAgIHxcbiAgICAgICAgICogfCA3LiB0aGUgLm5nLW1vdmUtYWN0aXZlIGFuZCAubmctYW5pbWF0ZS1hY3RpdmUgY2xhc3NlcyBpcyBhZGRlZCAodGhpcyB0cmlnZ2VycyB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uKSB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctYW5pbWF0ZS1hY3RpdmUgbmctbW92ZSBuZy1tb3ZlLWFjdGl2ZVwiIHxcbiAgICAgICAgICogfCA4LiAkYW5pbWF0ZSB3YWl0cyBmb3IgWCBtaWxsaXNlY29uZHMgZm9yIHRoZSBhbmltYXRpb24gdG8gY29tcGxldGUgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctYW5pbWF0ZS1hY3RpdmUgbmctbW92ZSBuZy1tb3ZlLWFjdGl2ZVwiIHxcbiAgICAgICAgICogfCA5LiBUaGUgYW5pbWF0aW9uIGVuZHMgYW5kIGFsbCBnZW5lcmF0ZWQgQ1NTIGNsYXNzZXMgYXJlIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudCAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uXCIgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMTAuIFRoZSBkb25lQ2FsbGJhY2soKSBjYWxsYmFjayBpcyBmaXJlZCAoaWYgcHJvdmlkZWQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvblwiICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHRoZSBmb2N1cyBvZiB0aGUgbW92ZSBhbmltYXRpb25cbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBwYXJlbnRFbGVtZW50IHRoZSBwYXJlbnRFbGVtZW50IGVsZW1lbnQgb2YgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHRoZSBmb2N1cyBvZiB0aGUgbW92ZSBhbmltYXRpb25cbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBhZnRlckVsZW1lbnQgdGhlIHNpYmxpbmcgZWxlbWVudCAod2hpY2ggaXMgdGhlIHByZXZpb3VzIGVsZW1lbnQpIG9mIHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSB0aGUgZm9jdXMgb2YgdGhlIG1vdmUgYW5pbWF0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oKT19IGRvbmVDYWxsYmFjayB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZCBvbmNlIHRoZSBhbmltYXRpb24gaXMgY29tcGxldGVcbiAgICAgICAgKi9cbiAgICAgICAgbW92ZSA6IGZ1bmN0aW9uKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCwgZG9uZUNhbGxiYWNrKSB7XG4gICAgICAgICAgY2FuY2VsQ2hpbGRBbmltYXRpb25zKGVsZW1lbnQpO1xuICAgICAgICAgIHRoaXMuZW5hYmxlZChmYWxzZSwgZWxlbWVudCk7XG4gICAgICAgICAgJGRlbGVnYXRlLm1vdmUoZWxlbWVudCwgcGFyZW50RWxlbWVudCwgYWZ0ZXJFbGVtZW50KTtcbiAgICAgICAgICAkcm9vdFNjb3BlLiQkcG9zdERpZ2VzdChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGVsZW1lbnQgPSBzdHJpcENvbW1lbnRzRnJvbUVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgICAgICBwZXJmb3JtQW5pbWF0aW9uKCdtb3ZlJywgJ25nLW1vdmUnLCBlbGVtZW50LCBwYXJlbnRFbGVtZW50LCBhZnRlckVsZW1lbnQsIG5vb3AsIGRvbmVDYWxsYmFjayk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICogQG5hbWUgJGFuaW1hdGUjYWRkQ2xhc3NcbiAgICAgICAgICpcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAqIFRyaWdnZXJzIGEgY3VzdG9tIGFuaW1hdGlvbiBldmVudCBiYXNlZCBvZmYgdGhlIGNsYXNzTmFtZSB2YXJpYWJsZSBhbmQgdGhlbiBhdHRhY2hlcyB0aGUgY2xhc3NOYW1lIHZhbHVlIHRvIHRoZSBlbGVtZW50IGFzIGEgQ1NTIGNsYXNzLlxuICAgICAgICAgKiBVbmxpa2UgdGhlIG90aGVyIGFuaW1hdGlvbiBtZXRob2RzLCB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHdpbGwgc3VmZml4IHRoZSBjbGFzc05hbWUgdmFsdWUgd2l0aCB7QHR5cGUgLWFkZH0gaW4gb3JkZXIgdG8gcHJvdmlkZVxuICAgICAgICAgKiB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHRoZSBzZXR1cCBhbmQgYWN0aXZlIENTUyBjbGFzc2VzIGluIG9yZGVyIHRvIHRyaWdnZXIgdGhlIGFuaW1hdGlvbiAodGhpcyB3aWxsIGJlIHNraXBwZWQgaWYgbm8gQ1NTIHRyYW5zaXRpb25zXG4gICAgICAgICAqIG9yIGtleWZyYW1lcyBhcmUgZGVmaW5lZCBvbiB0aGUgLWFkZCBvciBiYXNlIENTUyBjbGFzcykuXG4gICAgICAgICAqXG4gICAgICAgICAqIEJlbG93IGlzIGEgYnJlYWtkb3duIG9mIGVhY2ggc3RlcCB0aGF0IG9jY3VycyBkdXJpbmcgYWRkQ2xhc3MgYW5pbWF0aW9uOlxuICAgICAgICAgKlxuICAgICAgICAgKiB8IEFuaW1hdGlvbiBTdGVwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBXaGF0IHRoZSBlbGVtZW50IGNsYXNzIGF0dHJpYnV0ZSBsb29rcyBsaWtlIHxcbiAgICAgICAgICogfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XG4gICAgICAgICAqIHwgMS4gJGFuaW1hdGUuYWRkQ2xhc3MoZWxlbWVudCwgJ3N1cGVyJykgaXMgY2FsbGVkICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uXCIgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMi4gJGFuaW1hdGUgcnVucyBhbnkgSmF2YVNjcmlwdC1kZWZpbmVkIGFuaW1hdGlvbnMgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGVcIiAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMy4gdGhlIC5zdXBlci1hZGQgY2xhc3MgYXJlIGFkZGVkIHRvIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgc3VwZXItYWRkXCIgICB8XG4gICAgICAgICAqIHwgNC4gJGFuaW1hdGUgc2NhbnMgdGhlIGVsZW1lbnQgc3R5bGVzIHRvIGdldCB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uIGR1cmF0aW9uIGFuZCBkZWxheSAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgc3VwZXItYWRkXCIgICB8XG4gICAgICAgICAqIHwgNS4gJGFuaW1hdGUgd2FpdHMgZm9yIDEwbXMgKHRoaXMgcGVyZm9ybXMgYSByZWZsb3cpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgc3VwZXItYWRkXCIgICB8XG4gICAgICAgICAqIHwgNi4gdGhlIC5zdXBlciwgLnN1cGVyLWFkZC1hY3RpdmUgYW5kIC5uZy1hbmltYXRlLWFjdGl2ZSBjbGFzc2VzIGFyZSBhZGRlZCAodGhpcyB0cmlnZ2VycyB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uKSB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctYW5pbWF0ZS1hY3RpdmUgc3VwZXIgc3VwZXItYWRkIHN1cGVyLWFkZC1hY3RpdmVcIiAgICAgICAgICB8XG4gICAgICAgICAqIHwgNy4gJGFuaW1hdGUgd2FpdHMgZm9yIFggbWlsbGlzZWNvbmRzIGZvciB0aGUgYW5pbWF0aW9uIHRvIGNvbXBsZXRlICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIHN1cGVyIHN1cGVyLWFkZCBzdXBlci1hZGQtYWN0aXZlXCIgIHxcbiAgICAgICAgICogfCA4LiBUaGUgYW5pbWF0aW9uIGVuZHMgYW5kIGFsbCBnZW5lcmF0ZWQgQ1NTIGNsYXNzZXMgYXJlIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudCAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gc3VwZXJcIiAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA5LiBUaGUgc3VwZXIgY2xhc3MgaXMga2VwdCBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gc3VwZXJcIiAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAxMC4gVGhlIGRvbmVDYWxsYmFjaygpIGNhbGxiYWNrIGlzIGZpcmVkIChpZiBwcm92aWRlZCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gc3VwZXJcIiAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBlbGVtZW50IHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSBhbmltYXRlZFxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NOYW1lIHRoZSBDU1MgY2xhc3MgdGhhdCB3aWxsIGJlIGFkZGVkIHRvIHRoZSBlbGVtZW50IGFuZCB0aGVuIGFuaW1hdGVkXG4gICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oKT19IGRvbmVDYWxsYmFjayB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZCBvbmNlIHRoZSBhbmltYXRpb24gaXMgY29tcGxldGVcbiAgICAgICAgKi9cbiAgICAgICAgYWRkQ2xhc3MgOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmVDYWxsYmFjaykge1xuICAgICAgICAgIGVsZW1lbnQgPSBzdHJpcENvbW1lbnRzRnJvbUVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgICAgcGVyZm9ybUFuaW1hdGlvbignYWRkQ2xhc3MnLCBjbGFzc05hbWUsIGVsZW1lbnQsIG51bGwsIG51bGwsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJGRlbGVnYXRlLmFkZENsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgfSwgZG9uZUNhbGxiYWNrKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNyZW1vdmVDbGFzc1xuICAgICAgICAgKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAgICogVHJpZ2dlcnMgYSBjdXN0b20gYW5pbWF0aW9uIGV2ZW50IGJhc2VkIG9mZiB0aGUgY2xhc3NOYW1lIHZhcmlhYmxlIGFuZCB0aGVuIHJlbW92ZXMgdGhlIENTUyBjbGFzcyBwcm92aWRlZCBieSB0aGUgY2xhc3NOYW1lIHZhbHVlXG4gICAgICAgICAqIGZyb20gdGhlIGVsZW1lbnQuIFVubGlrZSB0aGUgb3RoZXIgYW5pbWF0aW9uIG1ldGhvZHMsIHRoZSBhbmltYXRlIHNlcnZpY2Ugd2lsbCBzdWZmaXggdGhlIGNsYXNzTmFtZSB2YWx1ZSB3aXRoIHtAdHlwZSAtcmVtb3ZlfSBpblxuICAgICAgICAgKiBvcmRlciB0byBwcm92aWRlIHRoZSBhbmltYXRlIHNlcnZpY2UgdGhlIHNldHVwIGFuZCBhY3RpdmUgQ1NTIGNsYXNzZXMgaW4gb3JkZXIgdG8gdHJpZ2dlciB0aGUgYW5pbWF0aW9uICh0aGlzIHdpbGwgYmUgc2tpcHBlZCBpZlxuICAgICAgICAgKiBubyBDU1MgdHJhbnNpdGlvbnMgb3Iga2V5ZnJhbWVzIGFyZSBkZWZpbmVkIG9uIHRoZSAtcmVtb3ZlIG9yIGJhc2UgQ1NTIGNsYXNzZXMpLlxuICAgICAgICAgKlxuICAgICAgICAgKiBCZWxvdyBpcyBhIGJyZWFrZG93biBvZiBlYWNoIHN0ZXAgdGhhdCBvY2N1cnMgZHVyaW5nIHJlbW92ZUNsYXNzIGFuaW1hdGlvbjpcbiAgICAgICAgICpcbiAgICAgICAgICogfCBBbmltYXRpb24gU3RlcCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBXaGF0IHRoZSBlbGVtZW50IGNsYXNzIGF0dHJpYnV0ZSBsb29rcyBsaWtlICAgICB8XG4gICAgICAgICAqIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XG4gICAgICAgICAqIHwgMS4gJGFuaW1hdGUucmVtb3ZlQ2xhc3MoZWxlbWVudCwgJ3N1cGVyJykgaXMgY2FsbGVkICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gc3VwZXJcIiAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAyLiAkYW5pbWF0ZSBydW5zIGFueSBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlciBuZy1hbmltYXRlXCIgICAgICAgfFxuICAgICAgICAgKiB8IDMuIHRoZSAuc3VwZXItcmVtb3ZlIGNsYXNzIGFyZSBhZGRlZCB0byB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIHN1cGVyIG5nLWFuaW1hdGUgc3VwZXItcmVtb3ZlXCJ8XG4gICAgICAgICAqIHwgNC4gJGFuaW1hdGUgc2NhbnMgdGhlIGVsZW1lbnQgc3R5bGVzIHRvIGdldCB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uIGR1cmF0aW9uIGFuZCBkZWxheSAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gc3VwZXIgbmctYW5pbWF0ZSBzdXBlci1yZW1vdmVcIiAgIHxcbiAgICAgICAgICogfCA1LiAkYW5pbWF0ZSB3YWl0cyBmb3IgMTBtcyAodGhpcyBwZXJmb3JtcyBhIHJlZmxvdykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlciBuZy1hbmltYXRlIHN1cGVyLXJlbW92ZVwiICAgfFxuICAgICAgICAgKiB8IDYuIHRoZSAuc3VwZXItcmVtb3ZlLWFjdGl2ZSBhbmQgLm5nLWFuaW1hdGUtYWN0aXZlIGNsYXNzZXMgYXJlIGFkZGVkIGFuZCAuc3VwZXIgaXMgcmVtb3ZlZCAodGhpcyB0cmlnZ2VycyB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uKSB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctYW5pbWF0ZS1hY3RpdmUgc3VwZXItcmVtb3ZlIHN1cGVyLXJlbW92ZS1hY3RpdmVcIiAgICAgICAgICB8XG4gICAgICAgICAqIHwgNy4gJGFuaW1hdGUgd2FpdHMgZm9yIFggbWlsbGlzZWNvbmRzIGZvciB0aGUgYW5pbWF0aW9uIHRvIGNvbXBsZXRlICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1hbmltYXRlLWFjdGl2ZSBzdXBlci1yZW1vdmUgc3VwZXItcmVtb3ZlLWFjdGl2ZVwiICAgfFxuICAgICAgICAgKiB8IDguIFRoZSBhbmltYXRpb24gZW5kcyBhbmQgYWxsIGdlbmVyYXRlZCBDU1MgY2xhc3NlcyBhcmUgcmVtb3ZlZCBmcm9tIHRoZSBlbGVtZW50ICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uXCIgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgOS4gVGhlIGRvbmVDYWxsYmFjaygpIGNhbGxiYWNrIGlzIGZpcmVkIChpZiBwcm92aWRlZCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb25cIiAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICpcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBlbGVtZW50IHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSBhbmltYXRlZFxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NOYW1lIHRoZSBDU1MgY2xhc3MgdGhhdCB3aWxsIGJlIGFuaW1hdGVkIGFuZCB0aGVuIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudFxuICAgICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCk9fSBkb25lQ2FsbGJhY2sgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgb25jZSB0aGUgYW5pbWF0aW9uIGlzIGNvbXBsZXRlXG4gICAgICAgICovXG4gICAgICAgIHJlbW92ZUNsYXNzIDogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lQ2FsbGJhY2spIHtcbiAgICAgICAgICBlbGVtZW50ID0gc3RyaXBDb21tZW50c0Zyb21FbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgIHBlcmZvcm1BbmltYXRpb24oJ3JlbW92ZUNsYXNzJywgY2xhc3NOYW1lLCBlbGVtZW50LCBudWxsLCBudWxsLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRkZWxlZ2F0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpO1xuICAgICAgICAgIH0sIGRvbmVDYWxsYmFjayk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKlxuICAgICAgICAgICAqIEBuZ2RvYyBmdW5jdGlvblxuICAgICAgICAgICAqIEBuYW1lICRhbmltYXRlI3NldENsYXNzXG4gICAgICAgICAgICogQGZ1bmN0aW9uXG4gICAgICAgICAgICogQGRlc2NyaXB0aW9uIEFkZHMgYW5kL29yIHJlbW92ZXMgdGhlIGdpdmVuIENTUyBjbGFzc2VzIHRvIGFuZCBmcm9tIHRoZSBlbGVtZW50LlxuICAgICAgICAgICAqIE9uY2UgY29tcGxldGUsIHRoZSBkb25lKCkgY2FsbGJhY2sgd2lsbCBiZSBmaXJlZCAoaWYgcHJvdmlkZWQpLlxuICAgICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB3aGljaCB3aWxsIGl0J3MgQ1NTIGNsYXNzZXMgY2hhbmdlZFxuICAgICAgICAgICAqICAgcmVtb3ZlZCBmcm9tIGl0XG4gICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGFkZCB0aGUgQ1NTIGNsYXNzZXMgd2hpY2ggd2lsbCBiZSBhZGRlZCB0byB0aGUgZWxlbWVudFxuICAgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZW1vdmUgdGhlIENTUyBjbGFzcyB3aGljaCB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudFxuICAgICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb249fSBkb25lIHRoZSBjYWxsYmFjayBmdW5jdGlvbiAoaWYgcHJvdmlkZWQpIHRoYXQgd2lsbCBiZSBmaXJlZCBhZnRlciB0aGVcbiAgICAgICAgICAgKiAgIENTUyBjbGFzc2VzIGhhdmUgYmVlbiBzZXQgb24gdGhlIGVsZW1lbnRcbiAgICAgICAgICAgKi9cbiAgICAgICAgc2V0Q2xhc3MgOiBmdW5jdGlvbihlbGVtZW50LCBhZGQsIHJlbW92ZSwgZG9uZUNhbGxiYWNrKSB7XG4gICAgICAgICAgZWxlbWVudCA9IHN0cmlwQ29tbWVudHNGcm9tRWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgICBwZXJmb3JtQW5pbWF0aW9uKCdzZXRDbGFzcycsIFthZGQsIHJlbW92ZV0sIGVsZW1lbnQsIG51bGwsIG51bGwsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJGRlbGVnYXRlLnNldENsYXNzKGVsZW1lbnQsIGFkZCwgcmVtb3ZlKTtcbiAgICAgICAgICB9LCBkb25lQ2FsbGJhY2spO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAqIEBuYW1lICRhbmltYXRlI2VuYWJsZWRcbiAgICAgICAgICogQGZ1bmN0aW9uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IHZhbHVlIElmIHByb3ZpZGVkIHRoZW4gc2V0IHRoZSBhbmltYXRpb24gb24gb3Igb2ZmLlxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnQ9fSBlbGVtZW50IElmIHByb3ZpZGVkIHRoZW4gdGhlIGVsZW1lbnQgd2lsbCBiZSB1c2VkIHRvIHJlcHJlc2VudCB0aGUgZW5hYmxlL2Rpc2FibGUgb3BlcmF0aW9uXG4gICAgICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IEN1cnJlbnQgYW5pbWF0aW9uIHN0YXRlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAgICogR2xvYmFsbHkgZW5hYmxlcy9kaXNhYmxlcyBhbmltYXRpb25zLlxuICAgICAgICAgKlxuICAgICAgICAqL1xuICAgICAgICBlbmFibGVkIDogZnVuY3Rpb24odmFsdWUsIGVsZW1lbnQpIHtcbiAgICAgICAgICBzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICBpZih2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGNsZWFudXAoZWxlbWVudCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSkgfHwge307XG4gICAgICAgICAgICAgICAgZGF0YS5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUsIGRhdGEpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICByb290QW5pbWF0ZVN0YXRlLmRpc2FibGVkID0gIXZhbHVlO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgIHZhbHVlID0gIXJvb3RBbmltYXRlU3RhdGUuZGlzYWJsZWQ7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuICEhdmFsdWU7XG4gICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvKlxuICAgICAgICBhbGwgYW5pbWF0aW9ucyBjYWxsIHRoaXMgc2hhcmVkIGFuaW1hdGlvbiB0cmlnZ2VyaW5nIGZ1bmN0aW9uIGludGVybmFsbHkuXG4gICAgICAgIFRoZSBhbmltYXRpb25FdmVudCB2YXJpYWJsZSByZWZlcnMgdG8gdGhlIEphdmFTY3JpcHQgYW5pbWF0aW9uIGV2ZW50IHRoYXQgd2lsbCBiZSB0cmlnZ2VyZWRcbiAgICAgICAgYW5kIHRoZSBjbGFzc05hbWUgdmFsdWUgaXMgdGhlIG5hbWUgb2YgdGhlIGFuaW1hdGlvbiB0aGF0IHdpbGwgYmUgYXBwbGllZCB3aXRoaW4gdGhlXG4gICAgICAgIENTUyBjb2RlLiBFbGVtZW50LCBwYXJlbnRFbGVtZW50IGFuZCBhZnRlckVsZW1lbnQgYXJlIHByb3ZpZGVkIERPTSBlbGVtZW50cyBmb3IgdGhlIGFuaW1hdGlvblxuICAgICAgICBhbmQgdGhlIG9uQ29tcGxldGUgY2FsbGJhY2sgd2lsbCBiZSBmaXJlZCBvbmNlIHRoZSBhbmltYXRpb24gaXMgZnVsbHkgY29tcGxldGUuXG4gICAgICAqL1xuICAgICAgZnVuY3Rpb24gcGVyZm9ybUFuaW1hdGlvbihhbmltYXRpb25FdmVudCwgY2xhc3NOYW1lLCBlbGVtZW50LCBwYXJlbnRFbGVtZW50LCBhZnRlckVsZW1lbnQsIGRvbU9wZXJhdGlvbiwgZG9uZUNhbGxiYWNrKSB7XG5cbiAgICAgICAgdmFyIHJ1bm5lciA9IGFuaW1hdGlvblJ1bm5lcihlbGVtZW50LCBhbmltYXRpb25FdmVudCwgY2xhc3NOYW1lKTtcbiAgICAgICAgaWYoIXJ1bm5lcikge1xuICAgICAgICAgIGZpcmVET01PcGVyYXRpb24oKTtcbiAgICAgICAgICBmaXJlQmVmb3JlQ2FsbGJhY2tBc3luYygpO1xuICAgICAgICAgIGZpcmVBZnRlckNhbGxiYWNrQXN5bmMoKTtcbiAgICAgICAgICBjbG9zZUFuaW1hdGlvbigpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNsYXNzTmFtZSA9IHJ1bm5lci5jbGFzc05hbWU7XG4gICAgICAgIHZhciBlbGVtZW50RXZlbnRzID0gYW5ndWxhci5lbGVtZW50Ll9kYXRhKHJ1bm5lci5ub2RlKTtcbiAgICAgICAgZWxlbWVudEV2ZW50cyA9IGVsZW1lbnRFdmVudHMgJiYgZWxlbWVudEV2ZW50cy5ldmVudHM7XG5cbiAgICAgICAgaWYgKCFwYXJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgcGFyZW50RWxlbWVudCA9IGFmdGVyRWxlbWVudCA/IGFmdGVyRWxlbWVudC5wYXJlbnQoKSA6IGVsZW1lbnQucGFyZW50KCk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbmdBbmltYXRlU3RhdGUgID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpIHx8IHt9O1xuICAgICAgICB2YXIgcnVubmluZ0FuaW1hdGlvbnMgICAgID0gbmdBbmltYXRlU3RhdGUuYWN0aXZlIHx8IHt9O1xuICAgICAgICB2YXIgdG90YWxBY3RpdmVBbmltYXRpb25zID0gbmdBbmltYXRlU3RhdGUudG90YWxBY3RpdmUgfHwgMDtcbiAgICAgICAgdmFyIGxhc3RBbmltYXRpb24gICAgICAgICA9IG5nQW5pbWF0ZVN0YXRlLmxhc3Q7XG5cbiAgICAgICAgLy9vbmx5IGFsbG93IGFuaW1hdGlvbnMgaWYgdGhlIGN1cnJlbnRseSBydW5uaW5nIGFuaW1hdGlvbiBpcyBub3Qgc3RydWN0dXJhbFxuICAgICAgICAvL29yIGlmIHRoZXJlIGlzIG5vIGFuaW1hdGlvbiBydW5uaW5nIGF0IGFsbFxuICAgICAgICB2YXIgc2tpcEFuaW1hdGlvbnMgPSBydW5uZXIuaXNDbGFzc0Jhc2VkID9cbiAgICAgICAgICBuZ0FuaW1hdGVTdGF0ZS5kaXNhYmxlZCB8fCAobGFzdEFuaW1hdGlvbiAmJiAhbGFzdEFuaW1hdGlvbi5pc0NsYXNzQmFzZWQpIDpcbiAgICAgICAgICBmYWxzZTtcblxuICAgICAgICAvL3NraXAgdGhlIGFuaW1hdGlvbiBpZiBhbmltYXRpb25zIGFyZSBkaXNhYmxlZCwgYSBwYXJlbnQgaXMgYWxyZWFkeSBiZWluZyBhbmltYXRlZCxcbiAgICAgICAgLy90aGUgZWxlbWVudCBpcyBub3QgY3VycmVudGx5IGF0dGFjaGVkIHRvIHRoZSBkb2N1bWVudCBib2R5IG9yIHRoZW4gY29tcGxldGVseSBjbG9zZVxuICAgICAgICAvL3RoZSBhbmltYXRpb24gaWYgYW55IG1hdGNoaW5nIGFuaW1hdGlvbnMgYXJlIG5vdCBmb3VuZCBhdCBhbGwuXG4gICAgICAgIC8vTk9URTogSUU4ICsgSUU5IHNob3VsZCBjbG9zZSBwcm9wZXJseSAocnVuIGNsb3NlQW5pbWF0aW9uKCkpIGluIGNhc2UgYW4gYW5pbWF0aW9uIHdhcyBmb3VuZC5cbiAgICAgICAgaWYgKHNraXBBbmltYXRpb25zIHx8IGFuaW1hdGlvbnNEaXNhYmxlZChlbGVtZW50LCBwYXJlbnRFbGVtZW50KSkge1xuICAgICAgICAgIGZpcmVET01PcGVyYXRpb24oKTtcbiAgICAgICAgICBmaXJlQmVmb3JlQ2FsbGJhY2tBc3luYygpO1xuICAgICAgICAgIGZpcmVBZnRlckNhbGxiYWNrQXN5bmMoKTtcbiAgICAgICAgICBjbG9zZUFuaW1hdGlvbigpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBza2lwQW5pbWF0aW9uID0gZmFsc2U7XG4gICAgICAgIGlmKHRvdGFsQWN0aXZlQW5pbWF0aW9ucyA+IDApIHtcbiAgICAgICAgICB2YXIgYW5pbWF0aW9uc1RvQ2FuY2VsID0gW107XG4gICAgICAgICAgaWYoIXJ1bm5lci5pc0NsYXNzQmFzZWQpIHtcbiAgICAgICAgICAgIGlmKGFuaW1hdGlvbkV2ZW50ID09ICdsZWF2ZScgJiYgcnVubmluZ0FuaW1hdGlvbnNbJ25nLWxlYXZlJ10pIHtcbiAgICAgICAgICAgICAgc2tpcEFuaW1hdGlvbiA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAvL2NhbmNlbCBhbGwgYW5pbWF0aW9ucyB3aGVuIGEgc3RydWN0dXJhbCBhbmltYXRpb24gdGFrZXMgcGxhY2VcbiAgICAgICAgICAgICAgZm9yKHZhciBrbGFzcyBpbiBydW5uaW5nQW5pbWF0aW9ucykge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbnNUb0NhbmNlbC5wdXNoKHJ1bm5pbmdBbmltYXRpb25zW2tsYXNzXSk7XG4gICAgICAgICAgICAgICAgY2xlYW51cChlbGVtZW50LCBrbGFzcyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcnVubmluZ0FuaW1hdGlvbnMgPSB7fTtcbiAgICAgICAgICAgICAgdG90YWxBY3RpdmVBbmltYXRpb25zID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYobGFzdEFuaW1hdGlvbi5ldmVudCA9PSAnc2V0Q2xhc3MnKSB7XG4gICAgICAgICAgICBhbmltYXRpb25zVG9DYW5jZWwucHVzaChsYXN0QW5pbWF0aW9uKTtcbiAgICAgICAgICAgIGNsZWFudXAoZWxlbWVudCwgY2xhc3NOYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZihydW5uaW5nQW5pbWF0aW9uc1tjbGFzc05hbWVdKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudCA9IHJ1bm5pbmdBbmltYXRpb25zW2NsYXNzTmFtZV07XG4gICAgICAgICAgICBpZihjdXJyZW50LmV2ZW50ID09IGFuaW1hdGlvbkV2ZW50KSB7XG4gICAgICAgICAgICAgIHNraXBBbmltYXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgYW5pbWF0aW9uc1RvQ2FuY2VsLnB1c2goY3VycmVudCk7XG4gICAgICAgICAgICAgIGNsZWFudXAoZWxlbWVudCwgY2xhc3NOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZihhbmltYXRpb25zVG9DYW5jZWwubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZm9yRWFjaChhbmltYXRpb25zVG9DYW5jZWwsIGZ1bmN0aW9uKG9wZXJhdGlvbikge1xuICAgICAgICAgICAgICBvcGVyYXRpb24uY2FuY2VsKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZihydW5uZXIuaXNDbGFzc0Jhc2VkICYmICFydW5uZXIuaXNTZXRDbGFzc09wZXJhdGlvbiAmJiAhc2tpcEFuaW1hdGlvbikge1xuICAgICAgICAgIHNraXBBbmltYXRpb24gPSAoYW5pbWF0aW9uRXZlbnQgPT0gJ2FkZENsYXNzJykgPT0gZWxlbWVudC5oYXNDbGFzcyhjbGFzc05hbWUpOyAvL29wcG9zaXRlIG9mIFhPUlxuICAgICAgICB9XG5cbiAgICAgICAgaWYoc2tpcEFuaW1hdGlvbikge1xuICAgICAgICAgIGZpcmVCZWZvcmVDYWxsYmFja0FzeW5jKCk7XG4gICAgICAgICAgZmlyZUFmdGVyQ2FsbGJhY2tBc3luYygpO1xuICAgICAgICAgIGZpcmVEb25lQ2FsbGJhY2tBc3luYygpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKGFuaW1hdGlvbkV2ZW50ID09ICdsZWF2ZScpIHtcbiAgICAgICAgICAvL3RoZXJlJ3Mgbm8gbmVlZCB0byBldmVyIHJlbW92ZSB0aGUgbGlzdGVuZXIgc2luY2UgdGhlIGVsZW1lbnRcbiAgICAgICAgICAvL3dpbGwgYmUgcmVtb3ZlZCAoZGVzdHJveWVkKSBhZnRlciB0aGUgbGVhdmUgYW5pbWF0aW9uIGVuZHMgb3JcbiAgICAgICAgICAvL2lzIGNhbmNlbGxlZCBtaWR3YXlcbiAgICAgICAgICBlbGVtZW50Lm9uZSgnJGRlc3Ryb3knLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudCh0aGlzKTtcbiAgICAgICAgICAgIHZhciBzdGF0ZSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKTtcbiAgICAgICAgICAgIGlmKHN0YXRlKSB7XG4gICAgICAgICAgICAgIHZhciBhY3RpdmVMZWF2ZUFuaW1hdGlvbiA9IHN0YXRlLmFjdGl2ZVsnbmctbGVhdmUnXTtcbiAgICAgICAgICAgICAgaWYoYWN0aXZlTGVhdmVBbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICBhY3RpdmVMZWF2ZUFuaW1hdGlvbi5jYW5jZWwoKTtcbiAgICAgICAgICAgICAgICBjbGVhbnVwKGVsZW1lbnQsICduZy1sZWF2ZScpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL3RoZSBuZy1hbmltYXRlIGNsYXNzIGRvZXMgbm90aGluZywgYnV0IGl0J3MgaGVyZSB0byBhbGxvdyBmb3JcbiAgICAgICAgLy9wYXJlbnQgYW5pbWF0aW9ucyB0byBmaW5kIGFuZCBjYW5jZWwgY2hpbGQgYW5pbWF0aW9ucyB3aGVuIG5lZWRlZFxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKE5HX0FOSU1BVEVfQ0xBU1NfTkFNRSk7XG5cbiAgICAgICAgdmFyIGxvY2FsQW5pbWF0aW9uQ291bnQgPSBnbG9iYWxBbmltYXRpb25Db3VudGVyKys7XG4gICAgICAgIHRvdGFsQWN0aXZlQW5pbWF0aW9ucysrO1xuICAgICAgICBydW5uaW5nQW5pbWF0aW9uc1tjbGFzc05hbWVdID0gcnVubmVyO1xuXG4gICAgICAgIGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFLCB7XG4gICAgICAgICAgbGFzdCA6IHJ1bm5lcixcbiAgICAgICAgICBhY3RpdmUgOiBydW5uaW5nQW5pbWF0aW9ucyxcbiAgICAgICAgICBpbmRleCA6IGxvY2FsQW5pbWF0aW9uQ291bnQsXG4gICAgICAgICAgdG90YWxBY3RpdmUgOiB0b3RhbEFjdGl2ZUFuaW1hdGlvbnNcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9maXJzdCB3ZSBydW4gdGhlIGJlZm9yZSBhbmltYXRpb25zIGFuZCB3aGVuIGFsbCBvZiB0aG9zZSBhcmUgY29tcGxldGVcbiAgICAgICAgLy90aGVuIHdlIHBlcmZvcm0gdGhlIERPTSBvcGVyYXRpb24gYW5kIHJ1biB0aGUgbmV4dCBzZXQgb2YgYW5pbWF0aW9uc1xuICAgICAgICBmaXJlQmVmb3JlQ2FsbGJhY2tBc3luYygpO1xuICAgICAgICBydW5uZXIuYmVmb3JlKGZ1bmN0aW9uKGNhbmNlbGxlZCkge1xuICAgICAgICAgIHZhciBkYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpO1xuICAgICAgICAgIGNhbmNlbGxlZCA9IGNhbmNlbGxlZCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIWRhdGEgfHwgIWRhdGEuYWN0aXZlW2NsYXNzTmFtZV0gfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIChydW5uZXIuaXNDbGFzc0Jhc2VkICYmIGRhdGEuYWN0aXZlW2NsYXNzTmFtZV0uZXZlbnQgIT0gYW5pbWF0aW9uRXZlbnQpO1xuXG4gICAgICAgICAgZmlyZURPTU9wZXJhdGlvbigpO1xuICAgICAgICAgIGlmKGNhbmNlbGxlZCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgY2xvc2VBbmltYXRpb24oKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZmlyZUFmdGVyQ2FsbGJhY2tBc3luYygpO1xuICAgICAgICAgICAgcnVubmVyLmFmdGVyKGNsb3NlQW5pbWF0aW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIGZpcmVET01DYWxsYmFjayhhbmltYXRpb25QaGFzZSkge1xuICAgICAgICAgIHZhciBldmVudE5hbWUgPSAnJGFuaW1hdGU6JyArIGFuaW1hdGlvblBoYXNlO1xuICAgICAgICAgIGlmKGVsZW1lbnRFdmVudHMgJiYgZWxlbWVudEV2ZW50c1tldmVudE5hbWVdICYmIGVsZW1lbnRFdmVudHNbZXZlbnROYW1lXS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAkJGFzeW5jQ2FsbGJhY2soZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGVsZW1lbnQudHJpZ2dlckhhbmRsZXIoZXZlbnROYW1lLCB7XG4gICAgICAgICAgICAgICAgZXZlbnQgOiBhbmltYXRpb25FdmVudCxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWUgOiBjbGFzc05hbWVcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBmaXJlQmVmb3JlQ2FsbGJhY2tBc3luYygpIHtcbiAgICAgICAgICBmaXJlRE9NQ2FsbGJhY2soJ2JlZm9yZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZmlyZUFmdGVyQ2FsbGJhY2tBc3luYygpIHtcbiAgICAgICAgICBmaXJlRE9NQ2FsbGJhY2soJ2FmdGVyJyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBmaXJlRG9uZUNhbGxiYWNrQXN5bmMoKSB7XG4gICAgICAgICAgZmlyZURPTUNhbGxiYWNrKCdjbG9zZScpO1xuICAgICAgICAgIGlmKGRvbmVDYWxsYmFjaykge1xuICAgICAgICAgICAgJCRhc3luY0NhbGxiYWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBkb25lQ2FsbGJhY2soKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vaXQgaXMgbGVzcyBjb21wbGljYXRlZCB0byB1c2UgYSBmbGFnIHRoYW4gbWFuYWdpbmcgYW5kIGNhbmNlbGluZ1xuICAgICAgICAvL3RpbWVvdXRzIGNvbnRhaW5pbmcgbXVsdGlwbGUgY2FsbGJhY2tzLlxuICAgICAgICBmdW5jdGlvbiBmaXJlRE9NT3BlcmF0aW9uKCkge1xuICAgICAgICAgIGlmKCFmaXJlRE9NT3BlcmF0aW9uLmhhc0JlZW5SdW4pIHtcbiAgICAgICAgICAgIGZpcmVET01PcGVyYXRpb24uaGFzQmVlblJ1biA9IHRydWU7XG4gICAgICAgICAgICBkb21PcGVyYXRpb24oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjbG9zZUFuaW1hdGlvbigpIHtcbiAgICAgICAgICBpZighY2xvc2VBbmltYXRpb24uaGFzQmVlblJ1bikge1xuICAgICAgICAgICAgY2xvc2VBbmltYXRpb24uaGFzQmVlblJ1biA9IHRydWU7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKTtcbiAgICAgICAgICAgIGlmKGRhdGEpIHtcbiAgICAgICAgICAgICAgLyogb25seSBzdHJ1Y3R1cmFsIGFuaW1hdGlvbnMgd2FpdCBmb3IgcmVmbG93IGJlZm9yZSByZW1vdmluZyBhblxuICAgICAgICAgICAgICAgICBhbmltYXRpb24sIGJ1dCBjbGFzcy1iYXNlZCBhbmltYXRpb25zIGRvbid0LiBBbiBleGFtcGxlIG9mIHRoaXNcbiAgICAgICAgICAgICAgICAgZmFpbGluZyB3b3VsZCBiZSB3aGVuIGEgcGFyZW50IEhUTUwgdGFnIGhhcyBhIG5nLWNsYXNzIGF0dHJpYnV0ZVxuICAgICAgICAgICAgICAgICBjYXVzaW5nIEFMTCBkaXJlY3RpdmVzIGJlbG93IHRvIHNraXAgYW5pbWF0aW9ucyBkdXJpbmcgdGhlIGRpZ2VzdCAqL1xuICAgICAgICAgICAgICBpZihydW5uZXIgJiYgcnVubmVyLmlzQ2xhc3NCYXNlZCkge1xuICAgICAgICAgICAgICAgIGNsZWFudXAoZWxlbWVudCwgY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkJGFzeW5jQ2FsbGJhY2soZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKSB8fCB7fTtcbiAgICAgICAgICAgICAgICAgIGlmKGxvY2FsQW5pbWF0aW9uQ291bnQgPT0gZGF0YS5pbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBjbGVhbnVwKGVsZW1lbnQsIGNsYXNzTmFtZSwgYW5pbWF0aW9uRXZlbnQpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFLCBkYXRhKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmlyZURvbmVDYWxsYmFja0FzeW5jKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGNhbmNlbENoaWxkQW5pbWF0aW9ucyhlbGVtZW50KSB7XG4gICAgICAgIHZhciBub2RlID0gZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpO1xuICAgICAgICBpZiAobm9kZSkge1xuICAgICAgICAgIHZhciBub2RlcyA9IGFuZ3VsYXIuaXNGdW5jdGlvbihub2RlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUpID9cbiAgICAgICAgICAgIG5vZGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShOR19BTklNQVRFX0NMQVNTX05BTUUpIDpcbiAgICAgICAgICAgIG5vZGUucXVlcnlTZWxlY3RvckFsbCgnLicgKyBOR19BTklNQVRFX0NMQVNTX05BTUUpO1xuICAgICAgICAgIGZvckVhY2gobm9kZXMsIGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIGVsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKTtcbiAgICAgICAgICAgIGlmKGRhdGEgJiYgZGF0YS5hY3RpdmUpIHtcbiAgICAgICAgICAgICAgZm9yRWFjaChkYXRhLmFjdGl2ZSwgZnVuY3Rpb24ocnVubmVyKSB7XG4gICAgICAgICAgICAgICAgcnVubmVyLmNhbmNlbCgpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBjbGVhbnVwKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgICAgICBpZihpc01hdGNoaW5nRWxlbWVudChlbGVtZW50LCAkcm9vdEVsZW1lbnQpKSB7XG4gICAgICAgICAgaWYoIXJvb3RBbmltYXRlU3RhdGUuZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHJvb3RBbmltYXRlU3RhdGUucnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgcm9vdEFuaW1hdGVTdGF0ZS5zdHJ1Y3R1cmFsID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYoY2xhc3NOYW1lKSB7XG4gICAgICAgICAgdmFyIGRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSkgfHwge307XG5cbiAgICAgICAgICB2YXIgcmVtb3ZlQW5pbWF0aW9ucyA9IGNsYXNzTmFtZSA9PT0gdHJ1ZTtcbiAgICAgICAgICBpZighcmVtb3ZlQW5pbWF0aW9ucyAmJiBkYXRhLmFjdGl2ZSAmJiBkYXRhLmFjdGl2ZVtjbGFzc05hbWVdKSB7XG4gICAgICAgICAgICBkYXRhLnRvdGFsQWN0aXZlLS07XG4gICAgICAgICAgICBkZWxldGUgZGF0YS5hY3RpdmVbY2xhc3NOYW1lXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZihyZW1vdmVBbmltYXRpb25zIHx8ICFkYXRhLnRvdGFsQWN0aXZlKSB7XG4gICAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKE5HX0FOSU1BVEVfQ0xBU1NfTkFNRSk7XG4gICAgICAgICAgICBlbGVtZW50LnJlbW92ZURhdGEoTkdfQU5JTUFURV9TVEFURSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGlvbnNEaXNhYmxlZChlbGVtZW50LCBwYXJlbnRFbGVtZW50KSB7XG4gICAgICAgIGlmIChyb290QW5pbWF0ZVN0YXRlLmRpc2FibGVkKSByZXR1cm4gdHJ1ZTtcblxuICAgICAgICBpZihpc01hdGNoaW5nRWxlbWVudChlbGVtZW50LCAkcm9vdEVsZW1lbnQpKSB7XG4gICAgICAgICAgcmV0dXJuIHJvb3RBbmltYXRlU3RhdGUuZGlzYWJsZWQgfHwgcm9vdEFuaW1hdGVTdGF0ZS5ydW5uaW5nO1xuICAgICAgICB9XG5cbiAgICAgICAgZG8ge1xuICAgICAgICAgIC8vdGhlIGVsZW1lbnQgZGlkIG5vdCByZWFjaCB0aGUgcm9vdCBlbGVtZW50IHdoaWNoIG1lYW5zIHRoYXQgaXRcbiAgICAgICAgICAvL2lzIG5vdCBhcGFydCBvZiB0aGUgRE9NLiBUaGVyZWZvcmUgdGhlcmUgaXMgbm8gcmVhc29uIHRvIGRvXG4gICAgICAgICAgLy9hbnkgYW5pbWF0aW9ucyBvbiBpdFxuICAgICAgICAgIGlmKHBhcmVudEVsZW1lbnQubGVuZ3RoID09PSAwKSBicmVhaztcblxuICAgICAgICAgIHZhciBpc1Jvb3QgPSBpc01hdGNoaW5nRWxlbWVudChwYXJlbnRFbGVtZW50LCAkcm9vdEVsZW1lbnQpO1xuICAgICAgICAgIHZhciBzdGF0ZSA9IGlzUm9vdCA/IHJvb3RBbmltYXRlU3RhdGUgOiBwYXJlbnRFbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSk7XG4gICAgICAgICAgdmFyIHJlc3VsdCA9IHN0YXRlICYmICghIXN0YXRlLmRpc2FibGVkIHx8IHN0YXRlLnJ1bm5pbmcgfHwgc3RhdGUudG90YWxBY3RpdmUgPiAwKTtcbiAgICAgICAgICBpZihpc1Jvb3QgfHwgcmVzdWx0KSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmKGlzUm9vdCkgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUocGFyZW50RWxlbWVudCA9IHBhcmVudEVsZW1lbnQucGFyZW50KCkpO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1dKTtcblxuICAgICRhbmltYXRlUHJvdmlkZXIucmVnaXN0ZXIoJycsIFsnJHdpbmRvdycsICckc25pZmZlcicsICckdGltZW91dCcsICckJGFuaW1hdGVSZWZsb3cnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oJHdpbmRvdywgICAkc25pZmZlciwgICAkdGltZW91dCwgICAkJGFuaW1hdGVSZWZsb3cpIHtcbiAgICAgIC8vIERldGVjdCBwcm9wZXIgdHJhbnNpdGlvbmVuZC9hbmltYXRpb25lbmQgZXZlbnQgbmFtZXMuXG4gICAgICB2YXIgQ1NTX1BSRUZJWCA9ICcnLCBUUkFOU0lUSU9OX1BST1AsIFRSQU5TSVRJT05FTkRfRVZFTlQsIEFOSU1BVElPTl9QUk9QLCBBTklNQVRJT05FTkRfRVZFTlQ7XG5cbiAgICAgIC8vIElmIHVucHJlZml4ZWQgZXZlbnRzIGFyZSBub3Qgc3VwcG9ydGVkIGJ1dCB3ZWJraXQtcHJlZml4ZWQgYXJlLCB1c2UgdGhlIGxhdHRlci5cbiAgICAgIC8vIE90aGVyd2lzZSwganVzdCB1c2UgVzNDIG5hbWVzLCBicm93c2VycyBub3Qgc3VwcG9ydGluZyB0aGVtIGF0IGFsbCB3aWxsIGp1c3QgaWdub3JlIHRoZW0uXG4gICAgICAvLyBOb3RlOiBDaHJvbWUgaW1wbGVtZW50cyBgd2luZG93Lm9ud2Via2l0YW5pbWF0aW9uZW5kYCBhbmQgZG9lc24ndCBpbXBsZW1lbnQgYHdpbmRvdy5vbmFuaW1hdGlvbmVuZGBcbiAgICAgIC8vIGJ1dCBhdCB0aGUgc2FtZSB0aW1lIGRpc3BhdGNoZXMgdGhlIGBhbmltYXRpb25lbmRgIGV2ZW50IGFuZCBub3QgYHdlYmtpdEFuaW1hdGlvbkVuZGAuXG4gICAgICAvLyBSZWdpc3RlciBib3RoIGV2ZW50cyBpbiBjYXNlIGB3aW5kb3cub25hbmltYXRpb25lbmRgIGlzIG5vdCBzdXBwb3J0ZWQgYmVjYXVzZSBvZiB0aGF0LFxuICAgICAgLy8gZG8gdGhlIHNhbWUgZm9yIGB0cmFuc2l0aW9uZW5kYCBhcyBTYWZhcmkgaXMgbGlrZWx5IHRvIGV4aGliaXQgc2ltaWxhciBiZWhhdmlvci5cbiAgICAgIC8vIEFsc28sIHRoZSBvbmx5IG1vZGVybiBicm93c2VyIHRoYXQgdXNlcyB2ZW5kb3IgcHJlZml4ZXMgZm9yIHRyYW5zaXRpb25zL2tleWZyYW1lcyBpcyB3ZWJraXRcbiAgICAgIC8vIHRoZXJlZm9yZSB0aGVyZSBpcyBubyByZWFzb24gdG8gdGVzdCBhbnltb3JlIGZvciBvdGhlciB2ZW5kb3IgcHJlZml4ZXM6IGh0dHA6Ly9jYW5pdXNlLmNvbS8jc2VhcmNoPXRyYW5zaXRpb25cbiAgICAgIGlmICh3aW5kb3cub250cmFuc2l0aW9uZW5kID09PSB1bmRlZmluZWQgJiYgd2luZG93Lm9ud2Via2l0dHJhbnNpdGlvbmVuZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIENTU19QUkVGSVggPSAnLXdlYmtpdC0nO1xuICAgICAgICBUUkFOU0lUSU9OX1BST1AgPSAnV2Via2l0VHJhbnNpdGlvbic7XG4gICAgICAgIFRSQU5TSVRJT05FTkRfRVZFTlQgPSAnd2Via2l0VHJhbnNpdGlvbkVuZCB0cmFuc2l0aW9uZW5kJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFRSQU5TSVRJT05fUFJPUCA9ICd0cmFuc2l0aW9uJztcbiAgICAgICAgVFJBTlNJVElPTkVORF9FVkVOVCA9ICd0cmFuc2l0aW9uZW5kJztcbiAgICAgIH1cblxuICAgICAgaWYgKHdpbmRvdy5vbmFuaW1hdGlvbmVuZCA9PT0gdW5kZWZpbmVkICYmIHdpbmRvdy5vbndlYmtpdGFuaW1hdGlvbmVuZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIENTU19QUkVGSVggPSAnLXdlYmtpdC0nO1xuICAgICAgICBBTklNQVRJT05fUFJPUCA9ICdXZWJraXRBbmltYXRpb24nO1xuICAgICAgICBBTklNQVRJT05FTkRfRVZFTlQgPSAnd2Via2l0QW5pbWF0aW9uRW5kIGFuaW1hdGlvbmVuZCc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBBTklNQVRJT05fUFJPUCA9ICdhbmltYXRpb24nO1xuICAgICAgICBBTklNQVRJT05FTkRfRVZFTlQgPSAnYW5pbWF0aW9uZW5kJztcbiAgICAgIH1cblxuICAgICAgdmFyIERVUkFUSU9OX0tFWSA9ICdEdXJhdGlvbic7XG4gICAgICB2YXIgUFJPUEVSVFlfS0VZID0gJ1Byb3BlcnR5JztcbiAgICAgIHZhciBERUxBWV9LRVkgPSAnRGVsYXknO1xuICAgICAgdmFyIEFOSU1BVElPTl9JVEVSQVRJT05fQ09VTlRfS0VZID0gJ0l0ZXJhdGlvbkNvdW50JztcbiAgICAgIHZhciBOR19BTklNQVRFX1BBUkVOVF9LRVkgPSAnJCRuZ0FuaW1hdGVLZXknO1xuICAgICAgdmFyIE5HX0FOSU1BVEVfQ1NTX0RBVEFfS0VZID0gJyQkbmdBbmltYXRlQ1NTM0RhdGEnO1xuICAgICAgdmFyIE5HX0FOSU1BVEVfQkxPQ0tfQ0xBU1NfTkFNRSA9ICduZy1hbmltYXRlLWJsb2NrLXRyYW5zaXRpb25zJztcbiAgICAgIHZhciBFTEFQU0VEX1RJTUVfTUFYX0RFQ0lNQUxfUExBQ0VTID0gMztcbiAgICAgIHZhciBDTE9TSU5HX1RJTUVfQlVGRkVSID0gMS41O1xuICAgICAgdmFyIE9ORV9TRUNPTkQgPSAxMDAwO1xuXG4gICAgICB2YXIgbG9va3VwQ2FjaGUgPSB7fTtcbiAgICAgIHZhciBwYXJlbnRDb3VudGVyID0gMDtcbiAgICAgIHZhciBhbmltYXRpb25SZWZsb3dRdWV1ZSA9IFtdO1xuICAgICAgdmFyIGNhbmNlbEFuaW1hdGlvblJlZmxvdztcbiAgICAgIGZ1bmN0aW9uIGFmdGVyUmVmbG93KGVsZW1lbnQsIGNhbGxiYWNrKSB7XG4gICAgICAgIGlmKGNhbmNlbEFuaW1hdGlvblJlZmxvdykge1xuICAgICAgICAgIGNhbmNlbEFuaW1hdGlvblJlZmxvdygpO1xuICAgICAgICB9XG4gICAgICAgIGFuaW1hdGlvblJlZmxvd1F1ZXVlLnB1c2goY2FsbGJhY2spO1xuICAgICAgICBjYW5jZWxBbmltYXRpb25SZWZsb3cgPSAkJGFuaW1hdGVSZWZsb3coZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZm9yRWFjaChhbmltYXRpb25SZWZsb3dRdWV1ZSwgZnVuY3Rpb24oZm4pIHtcbiAgICAgICAgICAgIGZuKCk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBhbmltYXRpb25SZWZsb3dRdWV1ZSA9IFtdO1xuICAgICAgICAgIGNhbmNlbEFuaW1hdGlvblJlZmxvdyA9IG51bGw7XG4gICAgICAgICAgbG9va3VwQ2FjaGUgPSB7fTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHZhciBjbG9zaW5nVGltZXIgPSBudWxsO1xuICAgICAgdmFyIGNsb3NpbmdUaW1lc3RhbXAgPSAwO1xuICAgICAgdmFyIGFuaW1hdGlvbkVsZW1lbnRRdWV1ZSA9IFtdO1xuICAgICAgZnVuY3Rpb24gYW5pbWF0aW9uQ2xvc2VIYW5kbGVyKGVsZW1lbnQsIHRvdGFsVGltZSkge1xuICAgICAgICB2YXIgbm9kZSA9IGV4dHJhY3RFbGVtZW50Tm9kZShlbGVtZW50KTtcbiAgICAgICAgZWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudChub2RlKTtcblxuICAgICAgICAvL3RoaXMgaXRlbSB3aWxsIGJlIGdhcmJhZ2UgY29sbGVjdGVkIGJ5IHRoZSBjbG9zaW5nXG4gICAgICAgIC8vYW5pbWF0aW9uIHRpbWVvdXRcbiAgICAgICAgYW5pbWF0aW9uRWxlbWVudFF1ZXVlLnB1c2goZWxlbWVudCk7XG5cbiAgICAgICAgLy9idXQgaXQgbWF5IG5vdCBuZWVkIHRvIGNhbmNlbCBvdXQgdGhlIGV4aXN0aW5nIHRpbWVvdXRcbiAgICAgICAgLy9pZiB0aGUgdGltZXN0YW1wIGlzIGxlc3MgdGhhbiB0aGUgcHJldmlvdXMgb25lXG4gICAgICAgIHZhciBmdXR1cmVUaW1lc3RhbXAgPSBEYXRlLm5vdygpICsgdG90YWxUaW1lO1xuICAgICAgICBpZihmdXR1cmVUaW1lc3RhbXAgPD0gY2xvc2luZ1RpbWVzdGFtcCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgICR0aW1lb3V0LmNhbmNlbChjbG9zaW5nVGltZXIpO1xuXG4gICAgICAgIGNsb3NpbmdUaW1lc3RhbXAgPSBmdXR1cmVUaW1lc3RhbXA7XG4gICAgICAgIGNsb3NpbmdUaW1lciA9ICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGNsb3NlQWxsQW5pbWF0aW9ucyhhbmltYXRpb25FbGVtZW50UXVldWUpO1xuICAgICAgICAgIGFuaW1hdGlvbkVsZW1lbnRRdWV1ZSA9IFtdO1xuICAgICAgICB9LCB0b3RhbFRpbWUsIGZhbHNlKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gY2xvc2VBbGxBbmltYXRpb25zKGVsZW1lbnRzKSB7XG4gICAgICAgIGZvckVhY2goZWxlbWVudHMsIGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICB2YXIgZWxlbWVudERhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9DU1NfREFUQV9LRVkpO1xuICAgICAgICAgIGlmKGVsZW1lbnREYXRhKSB7XG4gICAgICAgICAgICAoZWxlbWVudERhdGEuY2xvc2VBbmltYXRpb25GbiB8fCBub29wKSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGdldEVsZW1lbnRBbmltYXRpb25EZXRhaWxzKGVsZW1lbnQsIGNhY2hlS2V5KSB7XG4gICAgICAgIHZhciBkYXRhID0gY2FjaGVLZXkgPyBsb29rdXBDYWNoZVtjYWNoZUtleV0gOiBudWxsO1xuICAgICAgICBpZighZGF0YSkge1xuICAgICAgICAgIHZhciB0cmFuc2l0aW9uRHVyYXRpb24gPSAwO1xuICAgICAgICAgIHZhciB0cmFuc2l0aW9uRGVsYXkgPSAwO1xuICAgICAgICAgIHZhciBhbmltYXRpb25EdXJhdGlvbiA9IDA7XG4gICAgICAgICAgdmFyIGFuaW1hdGlvbkRlbGF5ID0gMDtcbiAgICAgICAgICB2YXIgdHJhbnNpdGlvbkRlbGF5U3R5bGU7XG4gICAgICAgICAgdmFyIGFuaW1hdGlvbkRlbGF5U3R5bGU7XG4gICAgICAgICAgdmFyIHRyYW5zaXRpb25EdXJhdGlvblN0eWxlO1xuICAgICAgICAgIHZhciB0cmFuc2l0aW9uUHJvcGVydHlTdHlsZTtcblxuICAgICAgICAgIC8vd2Ugd2FudCBhbGwgdGhlIHN0eWxlcyBkZWZpbmVkIGJlZm9yZSBhbmQgYWZ0ZXJcbiAgICAgICAgICBmb3JFYWNoKGVsZW1lbnQsIGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIGlmIChlbGVtZW50Lm5vZGVUeXBlID09IEVMRU1FTlRfTk9ERSkge1xuICAgICAgICAgICAgICB2YXIgZWxlbWVudFN0eWxlcyA9ICR3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KSB8fCB7fTtcblxuICAgICAgICAgICAgICB0cmFuc2l0aW9uRHVyYXRpb25TdHlsZSA9IGVsZW1lbnRTdHlsZXNbVFJBTlNJVElPTl9QUk9QICsgRFVSQVRJT05fS0VZXTtcblxuICAgICAgICAgICAgICB0cmFuc2l0aW9uRHVyYXRpb24gPSBNYXRoLm1heChwYXJzZU1heFRpbWUodHJhbnNpdGlvbkR1cmF0aW9uU3R5bGUpLCB0cmFuc2l0aW9uRHVyYXRpb24pO1xuXG4gICAgICAgICAgICAgIHRyYW5zaXRpb25Qcm9wZXJ0eVN0eWxlID0gZWxlbWVudFN0eWxlc1tUUkFOU0lUSU9OX1BST1AgKyBQUk9QRVJUWV9LRVldO1xuXG4gICAgICAgICAgICAgIHRyYW5zaXRpb25EZWxheVN0eWxlID0gZWxlbWVudFN0eWxlc1tUUkFOU0lUSU9OX1BST1AgKyBERUxBWV9LRVldO1xuXG4gICAgICAgICAgICAgIHRyYW5zaXRpb25EZWxheSAgPSBNYXRoLm1heChwYXJzZU1heFRpbWUodHJhbnNpdGlvbkRlbGF5U3R5bGUpLCB0cmFuc2l0aW9uRGVsYXkpO1xuXG4gICAgICAgICAgICAgIGFuaW1hdGlvbkRlbGF5U3R5bGUgPSBlbGVtZW50U3R5bGVzW0FOSU1BVElPTl9QUk9QICsgREVMQVlfS0VZXTtcblxuICAgICAgICAgICAgICBhbmltYXRpb25EZWxheSAgID0gTWF0aC5tYXgocGFyc2VNYXhUaW1lKGFuaW1hdGlvbkRlbGF5U3R5bGUpLCBhbmltYXRpb25EZWxheSk7XG5cbiAgICAgICAgICAgICAgdmFyIGFEdXJhdGlvbiAgPSBwYXJzZU1heFRpbWUoZWxlbWVudFN0eWxlc1tBTklNQVRJT05fUFJPUCArIERVUkFUSU9OX0tFWV0pO1xuXG4gICAgICAgICAgICAgIGlmKGFEdXJhdGlvbiA+IDApIHtcbiAgICAgICAgICAgICAgICBhRHVyYXRpb24gKj0gcGFyc2VJbnQoZWxlbWVudFN0eWxlc1tBTklNQVRJT05fUFJPUCArIEFOSU1BVElPTl9JVEVSQVRJT05fQ09VTlRfS0VZXSwgMTApIHx8IDE7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBhbmltYXRpb25EdXJhdGlvbiA9IE1hdGgubWF4KGFEdXJhdGlvbiwgYW5pbWF0aW9uRHVyYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICB0b3RhbCA6IDAsXG4gICAgICAgICAgICB0cmFuc2l0aW9uUHJvcGVydHlTdHlsZTogdHJhbnNpdGlvblByb3BlcnR5U3R5bGUsXG4gICAgICAgICAgICB0cmFuc2l0aW9uRHVyYXRpb25TdHlsZTogdHJhbnNpdGlvbkR1cmF0aW9uU3R5bGUsXG4gICAgICAgICAgICB0cmFuc2l0aW9uRGVsYXlTdHlsZTogdHJhbnNpdGlvbkRlbGF5U3R5bGUsXG4gICAgICAgICAgICB0cmFuc2l0aW9uRGVsYXk6IHRyYW5zaXRpb25EZWxheSxcbiAgICAgICAgICAgIHRyYW5zaXRpb25EdXJhdGlvbjogdHJhbnNpdGlvbkR1cmF0aW9uLFxuICAgICAgICAgICAgYW5pbWF0aW9uRGVsYXlTdHlsZTogYW5pbWF0aW9uRGVsYXlTdHlsZSxcbiAgICAgICAgICAgIGFuaW1hdGlvbkRlbGF5OiBhbmltYXRpb25EZWxheSxcbiAgICAgICAgICAgIGFuaW1hdGlvbkR1cmF0aW9uOiBhbmltYXRpb25EdXJhdGlvblxuICAgICAgICAgIH07XG4gICAgICAgICAgaWYoY2FjaGVLZXkpIHtcbiAgICAgICAgICAgIGxvb2t1cENhY2hlW2NhY2hlS2V5XSA9IGRhdGE7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBwYXJzZU1heFRpbWUoc3RyKSB7XG4gICAgICAgIHZhciBtYXhWYWx1ZSA9IDA7XG4gICAgICAgIHZhciB2YWx1ZXMgPSBhbmd1bGFyLmlzU3RyaW5nKHN0cikgP1xuICAgICAgICAgIHN0ci5zcGxpdCgvXFxzKixcXHMqLykgOlxuICAgICAgICAgIFtdO1xuICAgICAgICBmb3JFYWNoKHZhbHVlcywgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICBtYXhWYWx1ZSA9IE1hdGgubWF4KHBhcnNlRmxvYXQodmFsdWUpIHx8IDAsIG1heFZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBtYXhWYWx1ZTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gZ2V0Q2FjaGVLZXkoZWxlbWVudCkge1xuICAgICAgICB2YXIgcGFyZW50RWxlbWVudCA9IGVsZW1lbnQucGFyZW50KCk7XG4gICAgICAgIHZhciBwYXJlbnRJRCA9IHBhcmVudEVsZW1lbnQuZGF0YShOR19BTklNQVRFX1BBUkVOVF9LRVkpO1xuICAgICAgICBpZighcGFyZW50SUQpIHtcbiAgICAgICAgICBwYXJlbnRFbGVtZW50LmRhdGEoTkdfQU5JTUFURV9QQVJFTlRfS0VZLCArK3BhcmVudENvdW50ZXIpO1xuICAgICAgICAgIHBhcmVudElEID0gcGFyZW50Q291bnRlcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyZW50SUQgKyAnLScgKyBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCkuZ2V0QXR0cmlidXRlKCdjbGFzcycpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBhbmltYXRlU2V0dXAoYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSwgY2FsY3VsYXRpb25EZWNvcmF0b3IpIHtcbiAgICAgICAgdmFyIGNhY2hlS2V5ID0gZ2V0Q2FjaGVLZXkoZWxlbWVudCk7XG4gICAgICAgIHZhciBldmVudENhY2hlS2V5ID0gY2FjaGVLZXkgKyAnICcgKyBjbGFzc05hbWU7XG4gICAgICAgIHZhciBpdGVtSW5kZXggPSBsb29rdXBDYWNoZVtldmVudENhY2hlS2V5XSA/ICsrbG9va3VwQ2FjaGVbZXZlbnRDYWNoZUtleV0udG90YWwgOiAwO1xuXG4gICAgICAgIHZhciBzdGFnZ2VyID0ge307XG4gICAgICAgIGlmKGl0ZW1JbmRleCA+IDApIHtcbiAgICAgICAgICB2YXIgc3RhZ2dlckNsYXNzTmFtZSA9IGNsYXNzTmFtZSArICctc3RhZ2dlcic7XG4gICAgICAgICAgdmFyIHN0YWdnZXJDYWNoZUtleSA9IGNhY2hlS2V5ICsgJyAnICsgc3RhZ2dlckNsYXNzTmFtZTtcbiAgICAgICAgICB2YXIgYXBwbHlDbGFzc2VzID0gIWxvb2t1cENhY2hlW3N0YWdnZXJDYWNoZUtleV07XG5cbiAgICAgICAgICBhcHBseUNsYXNzZXMgJiYgZWxlbWVudC5hZGRDbGFzcyhzdGFnZ2VyQ2xhc3NOYW1lKTtcblxuICAgICAgICAgIHN0YWdnZXIgPSBnZXRFbGVtZW50QW5pbWF0aW9uRGV0YWlscyhlbGVtZW50LCBzdGFnZ2VyQ2FjaGVLZXkpO1xuXG4gICAgICAgICAgYXBwbHlDbGFzc2VzICYmIGVsZW1lbnQucmVtb3ZlQ2xhc3Moc3RhZ2dlckNsYXNzTmFtZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKiB0aGUgYW5pbWF0aW9uIGl0c2VsZiBtYXkgbmVlZCB0byBhZGQvcmVtb3ZlIHNwZWNpYWwgQ1NTIGNsYXNzZXNcbiAgICAgICAgICogYmVmb3JlIGNhbGN1bGF0aW5nIHRoZSBhbm1hdGlvbiBzdHlsZXMgKi9cbiAgICAgICAgY2FsY3VsYXRpb25EZWNvcmF0b3IgPSBjYWxjdWxhdGlvbkRlY29yYXRvciB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZuKSB7IHJldHVybiBmbigpOyB9O1xuXG4gICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoY2xhc3NOYW1lKTtcblxuICAgICAgICB2YXIgZm9ybWVyRGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX0NTU19EQVRBX0tFWSkgfHwge307XG5cbiAgICAgICAgdmFyIHRpbWluZ3MgPSBjYWxjdWxhdGlvbkRlY29yYXRvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gZ2V0RWxlbWVudEFuaW1hdGlvbkRldGFpbHMoZWxlbWVudCwgZXZlbnRDYWNoZUtleSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciB0cmFuc2l0aW9uRHVyYXRpb24gPSB0aW1pbmdzLnRyYW5zaXRpb25EdXJhdGlvbjtcbiAgICAgICAgdmFyIGFuaW1hdGlvbkR1cmF0aW9uID0gdGltaW5ncy5hbmltYXRpb25EdXJhdGlvbjtcbiAgICAgICAgaWYodHJhbnNpdGlvbkR1cmF0aW9uID09PSAwICYmIGFuaW1hdGlvbkR1cmF0aW9uID09PSAwKSB7XG4gICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcyhjbGFzc05hbWUpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGVsZW1lbnQuZGF0YShOR19BTklNQVRFX0NTU19EQVRBX0tFWSwge1xuICAgICAgICAgIHJ1bm5pbmcgOiBmb3JtZXJEYXRhLnJ1bm5pbmcgfHwgMCxcbiAgICAgICAgICBpdGVtSW5kZXggOiBpdGVtSW5kZXgsXG4gICAgICAgICAgc3RhZ2dlciA6IHN0YWdnZXIsXG4gICAgICAgICAgdGltaW5ncyA6IHRpbWluZ3MsXG4gICAgICAgICAgY2xvc2VBbmltYXRpb25GbiA6IG5vb3BcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy90ZW1wb3JhcmlseSBkaXNhYmxlIHRoZSB0cmFuc2l0aW9uIHNvIHRoYXQgdGhlIGVudGVyIHN0eWxlc1xuICAgICAgICAvL2Rvbid0IGFuaW1hdGUgdHdpY2UgKHRoaXMgaXMgaGVyZSB0byBhdm9pZCBhIGJ1ZyBpbiBDaHJvbWUvRkYpLlxuICAgICAgICB2YXIgaXNDdXJyZW50bHlBbmltYXRpbmcgPSBmb3JtZXJEYXRhLnJ1bm5pbmcgPiAwIHx8IGFuaW1hdGlvbkV2ZW50ID09ICdzZXRDbGFzcyc7XG4gICAgICAgIGlmKHRyYW5zaXRpb25EdXJhdGlvbiA+IDApIHtcbiAgICAgICAgICBibG9ja1RyYW5zaXRpb25zKGVsZW1lbnQsIGNsYXNzTmFtZSwgaXNDdXJyZW50bHlBbmltYXRpbmcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9zdGFnZ2VyaW5nIGtleWZyYW1lIGFuaW1hdGlvbnMgd29yayBieSBhZGp1c3RpbmcgdGhlIGBhbmltYXRpb24tZGVsYXlgIENTUyBwcm9wZXJ0eVxuICAgICAgICAvL29uIHRoZSBnaXZlbiBlbGVtZW50LCBob3dldmVyLCB0aGUgZGVsYXkgdmFsdWUgY2FuIG9ubHkgY2FsY3VsYXRlZCBhZnRlciB0aGUgcmVmbG93XG4gICAgICAgIC8vc2luY2UgYnkgdGhhdCB0aW1lICRhbmltYXRlIGtub3dzIGhvdyBtYW55IGVsZW1lbnRzIGFyZSBiZWluZyBhbmltYXRlZC4gVGhlcmVmb3JlLFxuICAgICAgICAvL3VudGlsIHRoZSByZWZsb3cgb2NjdXJzIHRoZSBlbGVtZW50IG5lZWRzIHRvIGJlIGJsb2NrZWQgKHdoZXJlIHRoZSBrZXlmcmFtZSBhbmltYXRpb25cbiAgICAgICAgLy9pcyBzZXQgdG8gYG5vbmUgMHNgKS4gVGhpcyBibG9ja2luZyBtZWNoYW5pc20gc2hvdWxkIG9ubHkgYmUgc2V0IGZvciB3aGVuIGEgc3RhZ2dlclxuICAgICAgICAvL2FuaW1hdGlvbiBpcyBkZXRlY3RlZCBhbmQgd2hlbiB0aGUgZWxlbWVudCBpdGVtIGluZGV4IGlzIGdyZWF0ZXIgdGhhbiAwLlxuICAgICAgICBpZihhbmltYXRpb25EdXJhdGlvbiA+IDAgJiYgc3RhZ2dlci5hbmltYXRpb25EZWxheSA+IDAgJiYgc3RhZ2dlci5hbmltYXRpb25EdXJhdGlvbiA9PT0gMCkge1xuICAgICAgICAgIGJsb2NrS2V5ZnJhbWVBbmltYXRpb25zKGVsZW1lbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGlzU3RydWN0dXJhbEFuaW1hdGlvbihjbGFzc05hbWUpIHtcbiAgICAgICAgcmV0dXJuIGNsYXNzTmFtZSA9PSAnbmctZW50ZXInIHx8IGNsYXNzTmFtZSA9PSAnbmctbW92ZScgfHwgY2xhc3NOYW1lID09ICduZy1sZWF2ZSc7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGJsb2NrVHJhbnNpdGlvbnMoZWxlbWVudCwgY2xhc3NOYW1lLCBpc0FuaW1hdGluZykge1xuICAgICAgICBpZihpc1N0cnVjdHVyYWxBbmltYXRpb24oY2xhc3NOYW1lKSB8fCAhaXNBbmltYXRpbmcpIHtcbiAgICAgICAgICBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCkuc3R5bGVbVFJBTlNJVElPTl9QUk9QICsgUFJPUEVSVFlfS0VZXSA9ICdub25lJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKE5HX0FOSU1BVEVfQkxPQ0tfQ0xBU1NfTkFNRSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYmxvY2tLZXlmcmFtZUFuaW1hdGlvbnMoZWxlbWVudCkge1xuICAgICAgICBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCkuc3R5bGVbQU5JTUFUSU9OX1BST1BdID0gJ25vbmUgMHMnO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiB1bmJsb2NrVHJhbnNpdGlvbnMoZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gICAgICAgIHZhciBwcm9wID0gVFJBTlNJVElPTl9QUk9QICsgUFJPUEVSVFlfS0VZO1xuICAgICAgICB2YXIgbm9kZSA9IGV4dHJhY3RFbGVtZW50Tm9kZShlbGVtZW50KTtcbiAgICAgICAgaWYobm9kZS5zdHlsZVtwcm9wXSAmJiBub2RlLnN0eWxlW3Byb3BdLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBub2RlLnN0eWxlW3Byb3BdID0gJyc7XG4gICAgICAgIH1cbiAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcyhOR19BTklNQVRFX0JMT0NLX0NMQVNTX05BTUUpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiB1bmJsb2NrS2V5ZnJhbWVBbmltYXRpb25zKGVsZW1lbnQpIHtcbiAgICAgICAgdmFyIHByb3AgPSBBTklNQVRJT05fUFJPUDtcbiAgICAgICAgdmFyIG5vZGUgPSBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCk7XG4gICAgICAgIGlmKG5vZGUuc3R5bGVbcHJvcF0gJiYgbm9kZS5zdHlsZVtwcm9wXS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgbm9kZS5zdHlsZVtwcm9wXSA9ICcnO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGVSdW4oYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSwgYWN0aXZlQW5pbWF0aW9uQ29tcGxldGUpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCk7XG4gICAgICAgIHZhciBlbGVtZW50RGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX0NTU19EQVRBX0tFWSk7XG4gICAgICAgIGlmKG5vZGUuZ2V0QXR0cmlidXRlKCdjbGFzcycpLmluZGV4T2YoY2xhc3NOYW1lKSA9PSAtMSB8fCAhZWxlbWVudERhdGEpIHtcbiAgICAgICAgICBhY3RpdmVBbmltYXRpb25Db21wbGV0ZSgpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBhY3RpdmVDbGFzc05hbWUgPSAnJztcbiAgICAgICAgZm9yRWFjaChjbGFzc05hbWUuc3BsaXQoJyAnKSwgZnVuY3Rpb24oa2xhc3MsIGkpIHtcbiAgICAgICAgICBhY3RpdmVDbGFzc05hbWUgKz0gKGkgPiAwID8gJyAnIDogJycpICsga2xhc3MgKyAnLWFjdGl2ZSc7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBzdGFnZ2VyID0gZWxlbWVudERhdGEuc3RhZ2dlcjtcbiAgICAgICAgdmFyIHRpbWluZ3MgPSBlbGVtZW50RGF0YS50aW1pbmdzO1xuICAgICAgICB2YXIgaXRlbUluZGV4ID0gZWxlbWVudERhdGEuaXRlbUluZGV4O1xuICAgICAgICB2YXIgbWF4RHVyYXRpb24gPSBNYXRoLm1heCh0aW1pbmdzLnRyYW5zaXRpb25EdXJhdGlvbiwgdGltaW5ncy5hbmltYXRpb25EdXJhdGlvbik7XG4gICAgICAgIHZhciBtYXhEZWxheSA9IE1hdGgubWF4KHRpbWluZ3MudHJhbnNpdGlvbkRlbGF5LCB0aW1pbmdzLmFuaW1hdGlvbkRlbGF5KTtcbiAgICAgICAgdmFyIG1heERlbGF5VGltZSA9IG1heERlbGF5ICogT05FX1NFQ09ORDtcblxuICAgICAgICB2YXIgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgdmFyIGNzczNBbmltYXRpb25FdmVudHMgPSBBTklNQVRJT05FTkRfRVZFTlQgKyAnICcgKyBUUkFOU0lUSU9ORU5EX0VWRU5UO1xuXG4gICAgICAgIHZhciBzdHlsZSA9ICcnLCBhcHBsaWVkU3R5bGVzID0gW107XG4gICAgICAgIGlmKHRpbWluZ3MudHJhbnNpdGlvbkR1cmF0aW9uID4gMCkge1xuICAgICAgICAgIHZhciBwcm9wZXJ0eVN0eWxlID0gdGltaW5ncy50cmFuc2l0aW9uUHJvcGVydHlTdHlsZTtcbiAgICAgICAgICBpZihwcm9wZXJ0eVN0eWxlLmluZGV4T2YoJ2FsbCcpID09IC0xKSB7XG4gICAgICAgICAgICBzdHlsZSArPSBDU1NfUFJFRklYICsgJ3RyYW5zaXRpb24tcHJvcGVydHk6ICcgKyBwcm9wZXJ0eVN0eWxlICsgJzsnO1xuICAgICAgICAgICAgc3R5bGUgKz0gQ1NTX1BSRUZJWCArICd0cmFuc2l0aW9uLWR1cmF0aW9uOiAnICsgdGltaW5ncy50cmFuc2l0aW9uRHVyYXRpb25TdHlsZSArICc7JztcbiAgICAgICAgICAgIGFwcGxpZWRTdHlsZXMucHVzaChDU1NfUFJFRklYICsgJ3RyYW5zaXRpb24tcHJvcGVydHknKTtcbiAgICAgICAgICAgIGFwcGxpZWRTdHlsZXMucHVzaChDU1NfUFJFRklYICsgJ3RyYW5zaXRpb24tZHVyYXRpb24nKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZihpdGVtSW5kZXggPiAwKSB7XG4gICAgICAgICAgaWYoc3RhZ2dlci50cmFuc2l0aW9uRGVsYXkgPiAwICYmIHN0YWdnZXIudHJhbnNpdGlvbkR1cmF0aW9uID09PSAwKSB7XG4gICAgICAgICAgICB2YXIgZGVsYXlTdHlsZSA9IHRpbWluZ3MudHJhbnNpdGlvbkRlbGF5U3R5bGU7XG4gICAgICAgICAgICBzdHlsZSArPSBDU1NfUFJFRklYICsgJ3RyYW5zaXRpb24tZGVsYXk6ICcgK1xuICAgICAgICAgICAgICAgICAgICAgcHJlcGFyZVN0YWdnZXJEZWxheShkZWxheVN0eWxlLCBzdGFnZ2VyLnRyYW5zaXRpb25EZWxheSwgaXRlbUluZGV4KSArICc7ICc7XG4gICAgICAgICAgICBhcHBsaWVkU3R5bGVzLnB1c2goQ1NTX1BSRUZJWCArICd0cmFuc2l0aW9uLWRlbGF5Jyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYoc3RhZ2dlci5hbmltYXRpb25EZWxheSA+IDAgJiYgc3RhZ2dlci5hbmltYXRpb25EdXJhdGlvbiA9PT0gMCkge1xuICAgICAgICAgICAgc3R5bGUgKz0gQ1NTX1BSRUZJWCArICdhbmltYXRpb24tZGVsYXk6ICcgK1xuICAgICAgICAgICAgICAgICAgICAgcHJlcGFyZVN0YWdnZXJEZWxheSh0aW1pbmdzLmFuaW1hdGlvbkRlbGF5U3R5bGUsIHN0YWdnZXIuYW5pbWF0aW9uRGVsYXksIGl0ZW1JbmRleCkgKyAnOyAnO1xuICAgICAgICAgICAgYXBwbGllZFN0eWxlcy5wdXNoKENTU19QUkVGSVggKyAnYW5pbWF0aW9uLWRlbGF5Jyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYoYXBwbGllZFN0eWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgLy90aGUgZWxlbWVudCBiZWluZyBhbmltYXRlZCBtYXkgc29tZXRpbWVzIGNvbnRhaW4gY29tbWVudCBub2RlcyBpblxuICAgICAgICAgIC8vdGhlIGpxTGl0ZSBvYmplY3QsIHNvIHdlJ3JlIHNhZmUgdG8gdXNlIGEgc2luZ2xlIHZhcmlhYmxlIHRvIGhvdXNlXG4gICAgICAgICAgLy90aGUgc3R5bGVzIHNpbmNlIHRoZXJlIGlzIGFsd2F5cyBvbmx5IG9uZSBlbGVtZW50IGJlaW5nIGFuaW1hdGVkXG4gICAgICAgICAgdmFyIG9sZFN0eWxlID0gbm9kZS5nZXRBdHRyaWJ1dGUoJ3N0eWxlJykgfHwgJyc7XG4gICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgb2xkU3R5bGUgKyAnICcgKyBzdHlsZSk7XG4gICAgICAgIH1cblxuICAgICAgICBlbGVtZW50Lm9uKGNzczNBbmltYXRpb25FdmVudHMsIG9uQW5pbWF0aW9uUHJvZ3Jlc3MpO1xuICAgICAgICBlbGVtZW50LmFkZENsYXNzKGFjdGl2ZUNsYXNzTmFtZSk7XG4gICAgICAgIGVsZW1lbnREYXRhLmNsb3NlQW5pbWF0aW9uRm4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBvbkVuZCgpO1xuICAgICAgICAgIGFjdGl2ZUFuaW1hdGlvbkNvbXBsZXRlKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIHN0YWdnZXJUaW1lICAgICAgID0gaXRlbUluZGV4ICogKE1hdGgubWF4KHN0YWdnZXIuYW5pbWF0aW9uRGVsYXksIHN0YWdnZXIudHJhbnNpdGlvbkRlbGF5KSB8fCAwKTtcbiAgICAgICAgdmFyIGFuaW1hdGlvblRpbWUgICAgID0gKG1heERlbGF5ICsgbWF4RHVyYXRpb24pICogQ0xPU0lOR19USU1FX0JVRkZFUjtcbiAgICAgICAgdmFyIHRvdGFsVGltZSAgICAgICAgID0gKHN0YWdnZXJUaW1lICsgYW5pbWF0aW9uVGltZSkgKiBPTkVfU0VDT05EO1xuXG4gICAgICAgIGVsZW1lbnREYXRhLnJ1bm5pbmcrKztcbiAgICAgICAgYW5pbWF0aW9uQ2xvc2VIYW5kbGVyKGVsZW1lbnQsIHRvdGFsVGltZSk7XG4gICAgICAgIHJldHVybiBvbkVuZDtcblxuICAgICAgICAvLyBUaGlzIHdpbGwgYXV0b21hdGljYWxseSBiZSBjYWxsZWQgYnkgJGFuaW1hdGUgc29cbiAgICAgICAgLy8gdGhlcmUgaXMgbm8gbmVlZCB0byBhdHRhY2ggdGhpcyBpbnRlcm5hbGx5IHRvIHRoZVxuICAgICAgICAvLyB0aW1lb3V0IGRvbmUgbWV0aG9kLlxuICAgICAgICBmdW5jdGlvbiBvbkVuZChjYW5jZWxsZWQpIHtcbiAgICAgICAgICBlbGVtZW50Lm9mZihjc3MzQW5pbWF0aW9uRXZlbnRzLCBvbkFuaW1hdGlvblByb2dyZXNzKTtcbiAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzTmFtZSk7XG4gICAgICAgICAgYW5pbWF0ZUNsb3NlKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgdmFyIG5vZGUgPSBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCk7XG4gICAgICAgICAgZm9yICh2YXIgaSBpbiBhcHBsaWVkU3R5bGVzKSB7XG4gICAgICAgICAgICBub2RlLnN0eWxlLnJlbW92ZVByb3BlcnR5KGFwcGxpZWRTdHlsZXNbaV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIG9uQW5pbWF0aW9uUHJvZ3Jlc3MoZXZlbnQpIHtcbiAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICB2YXIgZXYgPSBldmVudC5vcmlnaW5hbEV2ZW50IHx8IGV2ZW50O1xuICAgICAgICAgIHZhciB0aW1lU3RhbXAgPSBldi4kbWFudWFsVGltZVN0YW1wIHx8IGV2LnRpbWVTdGFtcCB8fCBEYXRlLm5vdygpO1xuXG4gICAgICAgICAgLyogRmlyZWZveCAob3IgcG9zc2libHkganVzdCBHZWNrbykgbGlrZXMgdG8gbm90IHJvdW5kIHZhbHVlcyB1cFxuICAgICAgICAgICAqIHdoZW4gYSBtcyBtZWFzdXJlbWVudCBpcyB1c2VkIGZvciB0aGUgYW5pbWF0aW9uICovXG4gICAgICAgICAgdmFyIGVsYXBzZWRUaW1lID0gcGFyc2VGbG9hdChldi5lbGFwc2VkVGltZS50b0ZpeGVkKEVMQVBTRURfVElNRV9NQVhfREVDSU1BTF9QTEFDRVMpKTtcblxuICAgICAgICAgIC8qICRtYW51YWxUaW1lU3RhbXAgaXMgYSBtb2NrZWQgdGltZVN0YW1wIHZhbHVlIHdoaWNoIGlzIHNldFxuICAgICAgICAgICAqIHdpdGhpbiBicm93c2VyVHJpZ2dlcigpLiBUaGlzIGlzIG9ubHkgaGVyZSBzbyB0aGF0IHRlc3RzIGNhblxuICAgICAgICAgICAqIG1vY2sgYW5pbWF0aW9ucyBwcm9wZXJseS4gUmVhbCBldmVudHMgZmFsbGJhY2sgdG8gZXZlbnQudGltZVN0YW1wLFxuICAgICAgICAgICAqIG9yLCBpZiB0aGV5IGRvbid0LCB0aGVuIGEgdGltZVN0YW1wIGlzIGF1dG9tYXRpY2FsbHkgY3JlYXRlZCBmb3IgdGhlbS5cbiAgICAgICAgICAgKiBXZSdyZSBjaGVja2luZyB0byBzZWUgaWYgdGhlIHRpbWVTdGFtcCBzdXJwYXNzZXMgdGhlIGV4cGVjdGVkIGRlbGF5LFxuICAgICAgICAgICAqIGJ1dCB3ZSdyZSB1c2luZyBlbGFwc2VkVGltZSBpbnN0ZWFkIG9mIHRoZSB0aW1lU3RhbXAgb24gdGhlIDJuZFxuICAgICAgICAgICAqIHByZS1jb25kaXRpb24gc2luY2UgYW5pbWF0aW9ucyBzb21ldGltZXMgY2xvc2Ugb2ZmIGVhcmx5ICovXG4gICAgICAgICAgaWYoTWF0aC5tYXgodGltZVN0YW1wIC0gc3RhcnRUaW1lLCAwKSA+PSBtYXhEZWxheVRpbWUgJiYgZWxhcHNlZFRpbWUgPj0gbWF4RHVyYXRpb24pIHtcbiAgICAgICAgICAgIGFjdGl2ZUFuaW1hdGlvbkNvbXBsZXRlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHByZXBhcmVTdGFnZ2VyRGVsYXkoZGVsYXlTdHlsZSwgc3RhZ2dlckRlbGF5LCBpbmRleCkge1xuICAgICAgICB2YXIgc3R5bGUgPSAnJztcbiAgICAgICAgZm9yRWFjaChkZWxheVN0eWxlLnNwbGl0KCcsJyksIGZ1bmN0aW9uKHZhbCwgaSkge1xuICAgICAgICAgIHN0eWxlICs9IChpID4gMCA/ICcsJyA6ICcnKSArXG4gICAgICAgICAgICAgICAgICAgKGluZGV4ICogc3RhZ2dlckRlbGF5ICsgcGFyc2VJbnQodmFsLCAxMCkpICsgJ3MnO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHN0eWxlO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBhbmltYXRlQmVmb3JlKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIGNhbGN1bGF0aW9uRGVjb3JhdG9yKSB7XG4gICAgICAgIGlmKGFuaW1hdGVTZXR1cChhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lLCBjYWxjdWxhdGlvbkRlY29yYXRvcikpIHtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oY2FuY2VsbGVkKSB7XG4gICAgICAgICAgICBjYW5jZWxsZWQgJiYgYW5pbWF0ZUNsb3NlKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBhbmltYXRlQWZ0ZXIoYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSwgYWZ0ZXJBbmltYXRpb25Db21wbGV0ZSkge1xuICAgICAgICBpZihlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9DU1NfREFUQV9LRVkpKSB7XG4gICAgICAgICAgcmV0dXJuIGFuaW1hdGVSdW4oYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSwgYWZ0ZXJBbmltYXRpb25Db21wbGV0ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYW5pbWF0ZUNsb3NlKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgYWZ0ZXJBbmltYXRpb25Db21wbGV0ZSgpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGUoYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSwgYW5pbWF0aW9uQ29tcGxldGUpIHtcbiAgICAgICAgLy9JZiB0aGUgYW5pbWF0ZVNldHVwIGZ1bmN0aW9uIGRvZXNuJ3QgYm90aGVyIHJldHVybmluZyBhXG4gICAgICAgIC8vY2FuY2VsbGF0aW9uIGZ1bmN0aW9uIHRoZW4gaXQgbWVhbnMgdGhhdCB0aGVyZSBpcyBubyBhbmltYXRpb25cbiAgICAgICAgLy90byBwZXJmb3JtIGF0IGFsbFxuICAgICAgICB2YXIgcHJlUmVmbG93Q2FuY2VsbGF0aW9uID0gYW5pbWF0ZUJlZm9yZShhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lKTtcbiAgICAgICAgaWYoIXByZVJlZmxvd0NhbmNlbGxhdGlvbikge1xuICAgICAgICAgIGFuaW1hdGlvbkNvbXBsZXRlKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9UaGVyZSBhcmUgdHdvIGNhbmNlbGxhdGlvbiBmdW5jdGlvbnM6IG9uZSBpcyBiZWZvcmUgdGhlIGZpcnN0XG4gICAgICAgIC8vcmVmbG93IGFuaW1hdGlvbiBhbmQgdGhlIHNlY29uZCBpcyBkdXJpbmcgdGhlIGFjdGl2ZSBzdGF0ZVxuICAgICAgICAvL2FuaW1hdGlvbi4gVGhlIGZpcnN0IGZ1bmN0aW9uIHdpbGwgdGFrZSBjYXJlIG9mIHJlbW92aW5nIHRoZVxuICAgICAgICAvL2RhdGEgZnJvbSB0aGUgZWxlbWVudCB3aGljaCB3aWxsIG5vdCBtYWtlIHRoZSAybmQgYW5pbWF0aW9uXG4gICAgICAgIC8vaGFwcGVuIGluIHRoZSBmaXJzdCBwbGFjZVxuICAgICAgICB2YXIgY2FuY2VsID0gcHJlUmVmbG93Q2FuY2VsbGF0aW9uO1xuICAgICAgICBhZnRlclJlZmxvdyhlbGVtZW50LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICB1bmJsb2NrVHJhbnNpdGlvbnMoZWxlbWVudCwgY2xhc3NOYW1lKTtcbiAgICAgICAgICB1bmJsb2NrS2V5ZnJhbWVBbmltYXRpb25zKGVsZW1lbnQpO1xuICAgICAgICAgIC8vb25jZSB0aGUgcmVmbG93IGlzIGNvbXBsZXRlIHRoZW4gd2UgcG9pbnQgY2FuY2VsIHRvXG4gICAgICAgICAgLy90aGUgbmV3IGNhbmNlbGxhdGlvbiBmdW5jdGlvbiB3aGljaCB3aWxsIHJlbW92ZSBhbGwgb2YgdGhlXG4gICAgICAgICAgLy9hbmltYXRpb24gcHJvcGVydGllcyBmcm9tIHRoZSBhY3RpdmUgYW5pbWF0aW9uXG4gICAgICAgICAgY2FuY2VsID0gYW5pbWF0ZUFmdGVyKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkNvbXBsZXRlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNhbmNlbGxlZCkge1xuICAgICAgICAgIChjYW5jZWwgfHwgbm9vcCkoY2FuY2VsbGVkKTtcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYW5pbWF0ZUNsb3NlKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKGNsYXNzTmFtZSk7XG4gICAgICAgIHZhciBkYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfQ1NTX0RBVEFfS0VZKTtcbiAgICAgICAgaWYoZGF0YSkge1xuICAgICAgICAgIGlmKGRhdGEucnVubmluZykge1xuICAgICAgICAgICAgZGF0YS5ydW5uaW5nLS07XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmKCFkYXRhLnJ1bm5pbmcgfHwgZGF0YS5ydW5uaW5nID09PSAwKSB7XG4gICAgICAgICAgICBlbGVtZW50LnJlbW92ZURhdGEoTkdfQU5JTUFURV9DU1NfREFUQV9LRVkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBlbnRlciA6IGZ1bmN0aW9uKGVsZW1lbnQsIGFuaW1hdGlvbkNvbXBsZXRlZCkge1xuICAgICAgICAgIHJldHVybiBhbmltYXRlKCdlbnRlcicsIGVsZW1lbnQsICduZy1lbnRlcicsIGFuaW1hdGlvbkNvbXBsZXRlZCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgbGVhdmUgOiBmdW5jdGlvbihlbGVtZW50LCBhbmltYXRpb25Db21wbGV0ZWQpIHtcbiAgICAgICAgICByZXR1cm4gYW5pbWF0ZSgnbGVhdmUnLCBlbGVtZW50LCAnbmctbGVhdmUnLCBhbmltYXRpb25Db21wbGV0ZWQpO1xuICAgICAgICB9LFxuXG4gICAgICAgIG1vdmUgOiBmdW5jdGlvbihlbGVtZW50LCBhbmltYXRpb25Db21wbGV0ZWQpIHtcbiAgICAgICAgICByZXR1cm4gYW5pbWF0ZSgnbW92ZScsIGVsZW1lbnQsICduZy1tb3ZlJywgYW5pbWF0aW9uQ29tcGxldGVkKTtcbiAgICAgICAgfSxcblxuICAgICAgICBiZWZvcmVTZXRDbGFzcyA6IGZ1bmN0aW9uKGVsZW1lbnQsIGFkZCwgcmVtb3ZlLCBhbmltYXRpb25Db21wbGV0ZWQpIHtcbiAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gc3VmZml4Q2xhc3NlcyhyZW1vdmUsICctcmVtb3ZlJykgKyAnICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzdWZmaXhDbGFzc2VzKGFkZCwgJy1hZGQnKTtcbiAgICAgICAgICB2YXIgY2FuY2VsbGF0aW9uTWV0aG9kID0gYW5pbWF0ZUJlZm9yZSgnc2V0Q2xhc3MnLCBlbGVtZW50LCBjbGFzc05hbWUsIGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgICAgICAvKiB3aGVuIGNsYXNzZXMgYXJlIHJlbW92ZWQgZnJvbSBhbiBlbGVtZW50IHRoZW4gdGhlIHRyYW5zaXRpb24gc3R5bGVcbiAgICAgICAgICAgICAqIHRoYXQgaXMgYXBwbGllZCBpcyB0aGUgdHJhbnNpdGlvbiBkZWZpbmVkIG9uIHRoZSBlbGVtZW50IHdpdGhvdXQgdGhlXG4gICAgICAgICAgICAgKiBDU1MgY2xhc3MgYmVpbmcgdGhlcmUuIFRoaXMgaXMgaG93IENTUzMgZnVuY3Rpb25zIG91dHNpZGUgb2YgbmdBbmltYXRlLlxuICAgICAgICAgICAgICogaHR0cDovL3BsbmtyLmNvL2VkaXQvajhPemdUTnhIVGI0bjN6THlqR1c/cD1wcmV2aWV3ICovXG4gICAgICAgICAgICB2YXIga2xhc3MgPSBlbGVtZW50LmF0dHIoJ2NsYXNzJyk7XG4gICAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKHJlbW92ZSk7XG4gICAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKGFkZCk7XG4gICAgICAgICAgICB2YXIgdGltaW5ncyA9IGZuKCk7XG4gICAgICAgICAgICBlbGVtZW50LmF0dHIoJ2NsYXNzJywga2xhc3MpO1xuICAgICAgICAgICAgcmV0dXJuIHRpbWluZ3M7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpZihjYW5jZWxsYXRpb25NZXRob2QpIHtcbiAgICAgICAgICAgIGFmdGVyUmVmbG93KGVsZW1lbnQsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICB1bmJsb2NrVHJhbnNpdGlvbnMoZWxlbWVudCwgY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgdW5ibG9ja0tleWZyYW1lQW5pbWF0aW9ucyhlbGVtZW50KTtcbiAgICAgICAgICAgICAgYW5pbWF0aW9uQ29tcGxldGVkKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBjYW5jZWxsYXRpb25NZXRob2Q7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFuaW1hdGlvbkNvbXBsZXRlZCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGJlZm9yZUFkZENsYXNzIDogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBhbmltYXRpb25Db21wbGV0ZWQpIHtcbiAgICAgICAgICB2YXIgY2FuY2VsbGF0aW9uTWV0aG9kID0gYW5pbWF0ZUJlZm9yZSgnYWRkQ2xhc3MnLCBlbGVtZW50LCBzdWZmaXhDbGFzc2VzKGNsYXNzTmFtZSwgJy1hZGQnKSwgZnVuY3Rpb24oZm4pIHtcblxuICAgICAgICAgICAgLyogd2hlbiBhIENTUyBjbGFzcyBpcyBhZGRlZCB0byBhbiBlbGVtZW50IHRoZW4gdGhlIHRyYW5zaXRpb24gc3R5bGUgdGhhdFxuICAgICAgICAgICAgICogaXMgYXBwbGllZCBpcyB0aGUgdHJhbnNpdGlvbiBkZWZpbmVkIG9uIHRoZSBlbGVtZW50IHdoZW4gdGhlIENTUyBjbGFzc1xuICAgICAgICAgICAgICogaXMgYWRkZWQgYXQgdGhlIHRpbWUgb2YgdGhlIGFuaW1hdGlvbi4gVGhpcyBpcyBob3cgQ1NTMyBmdW5jdGlvbnNcbiAgICAgICAgICAgICAqIG91dHNpZGUgb2YgbmdBbmltYXRlLiAqL1xuICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcyhjbGFzc05hbWUpO1xuICAgICAgICAgICAgdmFyIHRpbWluZ3MgPSBmbigpO1xuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcyhjbGFzc05hbWUpO1xuICAgICAgICAgICAgcmV0dXJuIHRpbWluZ3M7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpZihjYW5jZWxsYXRpb25NZXRob2QpIHtcbiAgICAgICAgICAgIGFmdGVyUmVmbG93KGVsZW1lbnQsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICB1bmJsb2NrVHJhbnNpdGlvbnMoZWxlbWVudCwgY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgdW5ibG9ja0tleWZyYW1lQW5pbWF0aW9ucyhlbGVtZW50KTtcbiAgICAgICAgICAgICAgYW5pbWF0aW9uQ29tcGxldGVkKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBjYW5jZWxsYXRpb25NZXRob2Q7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFuaW1hdGlvbkNvbXBsZXRlZCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldENsYXNzIDogZnVuY3Rpb24oZWxlbWVudCwgYWRkLCByZW1vdmUsIGFuaW1hdGlvbkNvbXBsZXRlZCkge1xuICAgICAgICAgIHJlbW92ZSA9IHN1ZmZpeENsYXNzZXMocmVtb3ZlLCAnLXJlbW92ZScpO1xuICAgICAgICAgIGFkZCA9IHN1ZmZpeENsYXNzZXMoYWRkLCAnLWFkZCcpO1xuICAgICAgICAgIHZhciBjbGFzc05hbWUgPSByZW1vdmUgKyAnICcgKyBhZGQ7XG4gICAgICAgICAgcmV0dXJuIGFuaW1hdGVBZnRlcignc2V0Q2xhc3MnLCBlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkNvbXBsZXRlZCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYWRkQ2xhc3MgOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkNvbXBsZXRlZCkge1xuICAgICAgICAgIHJldHVybiBhbmltYXRlQWZ0ZXIoJ2FkZENsYXNzJywgZWxlbWVudCwgc3VmZml4Q2xhc3NlcyhjbGFzc05hbWUsICctYWRkJyksIGFuaW1hdGlvbkNvbXBsZXRlZCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYmVmb3JlUmVtb3ZlQ2xhc3MgOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkNvbXBsZXRlZCkge1xuICAgICAgICAgIHZhciBjYW5jZWxsYXRpb25NZXRob2QgPSBhbmltYXRlQmVmb3JlKCdyZW1vdmVDbGFzcycsIGVsZW1lbnQsIHN1ZmZpeENsYXNzZXMoY2xhc3NOYW1lLCAnLXJlbW92ZScpLCBmdW5jdGlvbihmbikge1xuICAgICAgICAgICAgLyogd2hlbiBjbGFzc2VzIGFyZSByZW1vdmVkIGZyb20gYW4gZWxlbWVudCB0aGVuIHRoZSB0cmFuc2l0aW9uIHN0eWxlXG4gICAgICAgICAgICAgKiB0aGF0IGlzIGFwcGxpZWQgaXMgdGhlIHRyYW5zaXRpb24gZGVmaW5lZCBvbiB0aGUgZWxlbWVudCB3aXRob3V0IHRoZVxuICAgICAgICAgICAgICogQ1NTIGNsYXNzIGJlaW5nIHRoZXJlLiBUaGlzIGlzIGhvdyBDU1MzIGZ1bmN0aW9ucyBvdXRzaWRlIG9mIG5nQW5pbWF0ZS5cbiAgICAgICAgICAgICAqIGh0dHA6Ly9wbG5rci5jby9lZGl0L2o4T3pnVE54SFRiNG4zekx5akdXP3A9cHJldmlldyAqL1xuICAgICAgICAgICAgdmFyIGtsYXNzID0gZWxlbWVudC5hdHRyKCdjbGFzcycpO1xuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcyhjbGFzc05hbWUpO1xuICAgICAgICAgICAgdmFyIHRpbWluZ3MgPSBmbigpO1xuICAgICAgICAgICAgZWxlbWVudC5hdHRyKCdjbGFzcycsIGtsYXNzKTtcbiAgICAgICAgICAgIHJldHVybiB0aW1pbmdzO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaWYoY2FuY2VsbGF0aW9uTWV0aG9kKSB7XG4gICAgICAgICAgICBhZnRlclJlZmxvdyhlbGVtZW50LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgdW5ibG9ja1RyYW5zaXRpb25zKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgIHVuYmxvY2tLZXlmcmFtZUFuaW1hdGlvbnMoZWxlbWVudCk7XG4gICAgICAgICAgICAgIGFuaW1hdGlvbkNvbXBsZXRlZCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gY2FuY2VsbGF0aW9uTWV0aG9kO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhbmltYXRpb25Db21wbGV0ZWQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW1vdmVDbGFzcyA6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgYW5pbWF0aW9uQ29tcGxldGVkKSB7XG4gICAgICAgICAgcmV0dXJuIGFuaW1hdGVBZnRlcigncmVtb3ZlQ2xhc3MnLCBlbGVtZW50LCBzdWZmaXhDbGFzc2VzKGNsYXNzTmFtZSwgJy1yZW1vdmUnKSwgYW5pbWF0aW9uQ29tcGxldGVkKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgZnVuY3Rpb24gc3VmZml4Q2xhc3NlcyhjbGFzc2VzLCBzdWZmaXgpIHtcbiAgICAgICAgdmFyIGNsYXNzTmFtZSA9ICcnO1xuICAgICAgICBjbGFzc2VzID0gYW5ndWxhci5pc0FycmF5KGNsYXNzZXMpID8gY2xhc3NlcyA6IGNsYXNzZXMuc3BsaXQoL1xccysvKTtcbiAgICAgICAgZm9yRWFjaChjbGFzc2VzLCBmdW5jdGlvbihrbGFzcywgaSkge1xuICAgICAgICAgIGlmKGtsYXNzICYmIGtsYXNzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZSArPSAoaSA+IDAgPyAnICcgOiAnJykgKyBrbGFzcyArIHN1ZmZpeDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2xhc3NOYW1lO1xuICAgICAgfVxuICAgIH1dKTtcbiAgfV0pO1xuXG5cbn0pKHdpbmRvdywgd2luZG93LmFuZ3VsYXIpO1xuIl19
