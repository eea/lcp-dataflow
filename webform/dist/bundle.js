(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
$.noConflict();


	var app = angular.module('LCP', [
        'ui.bootstrap',
        'ngAnimate',
        'ajoslin.promise-tracker',
        'navigation.navigationBlocker',
        'translate.languageChanger',
        'ui.multiselect',
        'tabs.formTabs',
        'ui.errorMapper',
        'monospaced.elastic',
        'ngOrderObjectBy',
        'notifications']);

    app.run(function($rootScope, promiseTracker, $location, tabService) {
        $rootScope.loadingTracker = promiseTracker({});
        tabService.setTabs([
            {"id":"BasicData",            "active" : true},
            {"id":"ListOfPlants",         "active" : false},
            {"id":"PlantDetails",         "active" : false},
            {"id":"EnergyInput",          "active" : false},
            {"id":"TotalEmissionsToAir",  "active" : false},
            {"id":"Desulphurisation",     "active" : false},
            {"id":"UsefulHeat",             "active" : false},
            {"id":"Notes",                "active" : false}]);
    });

    app.config(function (languageChangerProvider) {
        languageChangerProvider.setDefaultLanguage('en');
        languageChangerProvider.setLanguageFilePrefix('lcp-labels-');
        languageChangerProvider.setAvailableLanguages({ "item" :[{
            "code": "bg",
            "label": "Ð‘ÑŠÐ»Ð³Ð°Ñ€ÑÐºÐ¸ (bg)"}, {
            "code": "es",
                "label": "EspaÃ±ol (es)"}, {
            "code": "cs",
                "label": "ÄŒeÅ¡tina (cs)"}, {
            "code": "da",
                "label": "Dansk (da)"}, {
            "code": "de",
                "label": "Deutsch (de)"}, {
            "code": "et",
                "label": "Eesti (et)"}, {
            "code": "el",
                "label": "ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬ (el)"}, {
            "code": "en",
                "label": "English (en)"}, {
            "code": "fr",
                "label": "FranÃ§ais (fr)"}, {
            "code": "hr",
                "label": "Hrvatski (hr)"}, {
            "code": "it",
                "label": "Italiano (it)"}, {
            "code": "lv",
                "label": "LatvieÅ¡u valoda (lv)"}, {
            "code": "lt",
                "label": "LietuviÅ³ kalba (lt)"}, {
            "code": "hu",
                "label": "Magyar (hu)"}, {
            "code": "hr",
                "label": "Hrvatski (hr)"}, {
            "code": "mt",
                "label": "Malti (mt)"}, {
            "code": "nl",
                "label": "Nederlands (nl)"}, {
            "code": "pl",
                "label": "Polski (pl)"}, {
            "code": "pt",
                "label": "PortuguÃªs (pt)"}, {
            "code": "ro",
                "label": "RomÃ¢nÄƒ (ro)"}, {
            "code": "sk",
                "label": "SlovenÄina (sk)"}, {
            "code": "sl",
                "label": "SlovenÅ¡Äina (sl)"}, {
            "code": "fi",
                "label": "Suomi (fi)"}, {
            "code": "sv",
                "label": "Svenska (sv)"}] })
    });

    // request parameters
    var baseUri = getParameterByName('base_uri');
    var fileId = getParameterByName('fileId');
    var envelope = getParameterByName('envelope');
    var sessionId = getParameterByName('sessionid');
    var countryCode = getParameterByName('countrycode');
    countryCode = countryCode === "GB" ? "UK" : countryCode;
    var DD_VOCABULARY_BASE_URI = "https://dd.eionet.europa.eu/vocabulary/";

    app.controller("questionnaire", function ($scope, $rootScope, dataRepository, languageChanger, $sce, $location, $timeout, $anchorScroll, $notification, $http, $filter ,$q) {

     
        $scope.codeList = {};
        $scope.regionsCodelist = {};

		$scope.base = $location.host()+ $location.port() + getParameterByName('base_uri');
        //$scope.availableLanguages = languageChanger.getAvailableLanguages();

        dataRepository.getEmptyInstance().error(function(){alert("Failed to read empty instance XML file.");}).success(function(instance) {
            $scope.emptyInstance = instance;
        });

        dataRepository.getInstance().error(function(){alert("Failed to read instance XML file.");}).success(function(instance) {
            if (!angular.isDefined(instance.LCPQuestionnaire)){
                // add labelLanguage attribute to correct location
                $scope.instance = {};
                $scope.instance.LCPQuestionnaire = {};
                $scope.instance.LCPQuestionnaire['@xmlns:xsi'] = instance.LCPQuestionnaire['@xmlns:xsi'];
                $scope.instance.LCPQuestionnaire['@xsi:noNamespaceSchemaLocation'] = instance.LCPQuestionnaire['@xsi:noNamespaceSchemaLocation'];
                $scope.instance.LCPQuestionnaire['@xml:lang'] = instance.LCPQuestionnaire['@xml:lang'];
                $scope.instance.LCPQuestionnaire.BasicData = instance.LCPQuestionnaire.BasicData;
                $scope.instance.LCPQuestionnaire.ListOfPlants = instance.LCPQuestionnaire.ListOfPlants;

            }
            else {
                $scope.instance = instance;
            }

            if ($scope.instance.LCPQuestionnaire.ListOfPlants && $scope.instance.LCPQuestionnaire.ListOfPlants.Plant) {

                // if therÏƒÏ…Ïƒe is only 1 plant, then convert it to array
                if (!angular.isArray($scope.instance.LCPQuestionnaire.ListOfPlants.Plant)) {
                    $scope.instance.LCPQuestionnaire.ListOfPlants.Plant = [$scope.instance.LCPQuestionnaire.ListOfPlants.Plant];
                }
                // remove the first empty row, if exists
                if ($scope.instance.LCPQuestionnaire.ListOfPlants.Plant.length == 1 &&
                        (!$scope.instance.LCPQuestionnaire.ListOfPlants.Plant[0] ||
                                (!$scope.instance.LCPQuestionnaire.ListOfPlants.Plant[0]['PlantName'] && !$scope.instance.LCPQuestionnaire.ListOfPlants.Plant[0]['PlantId']))){
                    $scope.instance.LCPQuestionnaire.ListOfPlants.Plant = [];

                    // Load predefined country specific plants
                    if( countryCode != null) {
                        var eprtrCountryCode = countryCode === "GB" ? "UK" : countryCode === "GR" ? "EL" : countryCode;
                        // var url = "lcp_plants-" + countryCode + ".json";
                        var url = "http://semantic.eea.europa.eu/sparql?format=application/json&query=";
                        var sparql = " PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>" +
                                    " PREFIX cr: <http://cr.eionet.europa.eu/ontologies/contreg.rdf#> " +
                                    " PREFIX prtr: <http://prtr.ec.europa.eu/rdf/schema.rdf#> " +
                                    " PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>" +
                                    " PREFIX lcpType: <http://semantic.eea.europa.eu/project/lcp_data/lcp_plants.csv/> " +
                                    " PREFIX lcp: <http://semantic.eea.europa.eu/project/lcp_data/lcp_plants.csv#> " +
                                    " SELECT *" +
                                    " WHERE {" +
                                    " {" +
                                        " [] a lcpType:lcpPlant ;" +
                                        " lcp:PlantName ?PlantName;" +
                                        " lcp:MemberState ?MemberState;" +
                                        " lcp:EPRTRNationalId ?EPRTRNationalId;" +
                                        " lcp:Unique_Plant_ID ?PlantId." +

                                        " ?facility a prtr:Facility ;" +
                                        " prtr:facilityName ?facilityName;" +
                                        " prtr:streetName ?streetName;" +
                                        " prtr:postalCode  ?postalCode;" +
                                        " geo:lat ?lat;" +
                                        " geo:long ?long;" +
                                        " prtr:inCountry ?inCountry ;" +
                                        " prtr:latestReport ?latestReport." +
                                        " ?inCountry prtr:code ?EPRTRCountryCode." +
                                        " ?latestReport prtr:nationalID ?EPRTRNationalId;" +
                                        " prtr:forNUTS ?forNUTS;" +
                                        " prtr:reportingYear ?reportingYear." +
                                        " ?forNUTS prtr:code ?regionCode." +
                                        " OPTIONAL { ?facility prtr:buildingNumber ?buildingNumber. }" +
                                        " OPTIONAL { ?facility prtr:city ?city. }" +
                                        " FILTER( ?EPRTRCountryCode= '" + eprtrCountryCode + "' and ?MemberState = '" + countryCode + "' and ?MemberState != 'SK' )" +
                                    " } " +
                                    " UNION" +
                                    " {" +
                                        " ?plant a lcpType:lcpPlant ;" +
                                        " lcp:PlantName ?PlantName;" +
                                        " lcp:MemberState ?MemberState;" +
                                        " lcp:EPRTRNationalId ?EPRTRNationalId;" +
                                        " lcp:Unique_Plant_ID ?PlantId." +
                                        " OPTIONAL {  ?plant lcp:FacilityName ?facilityName. }" +
                                        " OPTIONAL {  ?plant lcp:Longitude ?long. }" +
                                        " OPTIONAL {  ?plant lcp:Latitude ?lat. }" +
                                        " OPTIONAL {  ?plant lcp:Address1 ?streetName. }" +
                                        " OPTIONAL {  ?plant lcp:City ?city. }" +
                                        " OPTIONAL {  ?plant lcp:PostalCode ?postalCode.}" +
                                        " OPTIONAL {  ?plant lcp:Region ?regionCode. }" +
                                        " OPTIONAL {" +
                                            " ?facility a prtr:Facility ;" +
                                            " prtr:inCountry ?inCountry ;" +
                                            " prtr:latestReport ?latestReport." +
                                            " ?latestReport prtr:nationalID ?EPRTRNationalId." +
                                            " ?inCountry prtr:code ?EPRTRCountryCode." +
                                            " FILTER( ?EPRTRCountryCode= '"+ eprtrCountryCode + "'  )" +
                                        " }" +
                                        " FILTER( ?MemberState = '" + countryCode +"' and (!bound(?facility) or  ?MemberState = 'SK' ) ) " +
                                    " }" +
                                 " } ORDER BY ?PlantId ";

                        url = baseUri + '/restProxy?uri=' + encodeURIComponent(url + encodeURIComponent(sparql));
        //                console.log('plants url is:'+url);
                        $http.get(url, {tracker : $rootScope.loadingTracker})
                                .error(function(){alert("Failed to pre-load plants data from E-PRTR database.");})
                                .success(function(eprtrData) {
                                    if (eprtrData.results.bindings.length > 0) {
                                        var plantsDict = {} ;
                                        for (var i= 0; i < eprtrData.results.bindings.length; i++) {
                                            var responsePlant = eprtrData.results.bindings[i];
                                            var plant = null ;
                                            if (   plantsDict[ responsePlant.PlantId.value] && plantsDict [ responsePlant.PlantId.value] > responsePlant.reportingYear.value  ) {
                                                // some plants have reports under different facilities. we keep the for most new reportingYear
                                                continue ;
                                            }
                                            else if ( ! plantsDict[ responsePlant.PlantId.value] ){
                                                $scope.addItem('LCPQuestionnaire.ListOfPlants.Plant');
                                            }

                                            plant = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant[ $scope.instance.LCPQuestionnaire.ListOfPlants.Plant.length - 1 ];
                                            if (!plant.PlantLocation) plant.PlantLocation = {};
                                            if (!plant.GeographicalCoordinate) plant.GeographicalCoordinate = {};

                                            plant.PlantId = responsePlant.PlantId.value ;
                                            plant.PlantName = responsePlant.PlantName.value;
                                            plant.EPRTRNationalId = responsePlant.EPRTRNationalId.value;
                                            plant.PlantLocation.StreetName = responsePlant.streetName.value;
                                            if (!isEmpty(responsePlant.buildingNumber.value)) {
                                                plant.PlantLocation.BuildingNumber = responsePlant.buildingNumber.value;
                                            }
                                            plant.PlantLocation.City = responsePlant.city.value;
                                            plant.PlantLocation.Region = responsePlant.regionCode.value;
                                            plant.PlantLocation.PostalCode = responsePlant.postalCode.value;
                                            plant.GeographicalCoordinate.Longitude = responsePlant.long.value;
                                            plant.GeographicalCoordinate.Latitude = responsePlant.lat.value;
                                            plant.FacilityName = responsePlant.facilityName.value;

                                            plantsDict [plant.PlantId ] = responsePlant.reportingYear.value || 2013;
                                        }
                                        $rootScope.$broadcast('updateFilter');
                                        $notification.info("Info", "Previous EPRTR plants have been pre-loaded.");

                                    }
                                    else {
                                        alert("The system could not find any plant for country " + countryCode);
                                    }
                                });
                    }
                }
            }
            else {
                $scope.instance.LCPQuestionnaire.ListOfPlants = {"Plant" : []};
            }
            if( countryCode != null){

                $scope.countryCodeBoolean =true;
                $scope.instance.LCPQuestionnaire.BasicData.MemberState = countryCode.toUpperCase();
                $scope.memberStateValue = countryCode;
            }

            if( $scope.instance.LCPQuestionnaire.BasicData.MemberState != null ){
                $scope.countryCodeBoolean =true;
                $scope.memberStateValue = $scope.instance.LCPQuestionnaire.BasicData.MemberState;
                $scope.stateValue = $scope.instance.LCPQuestionnaire.BasicData.MemberState;
                $scope.instance.LCPQuestionnaire.BasicData.State = $scope.stateValue;
                $scope.regionsCodelist = dataRepository.loadRegionsCodelist($scope.memberStateValue);
            }

            $scope.$broadcast('instanceReady');
        });

   
        
        $scope.reportingYears = [];
        $scope.reportingYears.push ('2016');
        $scope.plantDetailsOtherSectorFieldsView = {iron_steel:"Iron and Steel",esi:"Electricity production",district_heating:"District heating",chp:"Combined heat and power generation",other:"Other"};

        // new
        $scope.currentListOfPlantsTable = null;
        $scope.selectedListOfPlantsTable = null;
        $scope.translationData = {};
        $rootScope.bulkEditListOfPlants=false;
        //$scope.status = submissionService.getStatus();
        $scope.profileFilled = true;
        $scope.editReference = false;
        $scope.changedReference = "";
        $scope.editUserIdentity = false;
        $scope.changedUserIdentity = "";
        $scope.editCountry = false;
        $scope.changedCountry = "";
        $scope.regionsCodelist = {};
        $scope.regionsCountry = null;
        $scope.isIE9 = $rootScope.isIE9;

        $scope.checkBoxDeleteCommit = false;
        // new end
        //determine ie version, code snippet is taken from: http://msdn.microsoft.com/en-us/library/ms537509%28v=vs.85%29.aspx
        var rv = -1; // Return value assumes failure.
        if (navigator.appName == 'Microsoft Internet Explorer')
        {
            var ua = navigator.userAgent;
            var re  = new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");
            if (re.exec(ua) != null)
                rv = parseFloat( RegExp.$1 );
        }
        //see: http://stackoverflow.com/questions/17907445/how-to-detect-ie11
        else if (navigator.appName == 'Netscape')
        {
            var ua = navigator.userAgent;
            var re  = new RegExp("Trident/.*rv:([0-9]{1,}[\.0-9]{0,})");
            if (re.exec(ua) != null)
                rv = parseFloat( RegExp.$1 );
        }

        $rootScope.ieVersionNumberOutOfCuriosityVariable = rv;
        if (rv > 0 && rv <= 9.0){
            $rootScope.isIE9 = true;
        }else{
            $rootScope.isIE9 = false;
        }
        $rootScope.$watch('isIE9', function(newValue, oldValue) {
            if (!newValue) {
                return;
            } else {
                $scope.isIE9 = $rootScope.isIE9;
            }
        })


        //$scope.countryCodeBoolean =  countryCode != null  ;
        $scope.countryCodeVal =  countryCode;


        dataRepository.loadCodeList();
        dataRepository.loadOldLCPCodeList();
        dataRepository.loadCombustionPlantCodeList();
        dataRepository.loadDerogationValueCodeList();
        dataRepository.loadOtherSolidFuelCodeList();
        dataRepository.loadOtherGasesousFuelCodeList();
        dataRepository.loadMonthValueCodeList();
        $scope.codeList = dataRepository.getCodeList();

       
    
        $scope.conversionLink = "";
        $scope.instanceInfo = {};
        dataRepository.loadInstanceInfo().error(function(){console.log("Failed to readfile info from server.");}).success(function(info) {
            angular.copy(info, $scope.instanceInfo);
            if ($scope.instanceInfo.conversions) {
                var htmlConversionId = $filter('filter')($scope.instanceInfo.conversions, {resultType: 'HTML'})[0].id;
                $scope.conversionLink = $scope.instanceInfo.conversionLink + htmlConversionId;
            }
        })


        // Remove row from ng-repeat.
        $scope.remove = function(array,  rowElement, showMsg){

            ////console.log(rowElement);
            ////console.log(countNonEmptyProperties(rowElement));
            if(showMsg == true){
                if (countNonEmptyProperties(rowElement) > 0) {
                    if (!confirm('Are you sure you want to delete the data in this row?')){
                        return;
                    }
                }
            }
            var index = array.indexOf(rowElement);
            array.splice(index, 1);
            $rootScope.$broadcast('updateFilter');
        };


        // get code list label by code
        $scope.getCodeListLabel = function(codelist, code) {
            //Do not try to get codeList before it actually exists.
            if (!$scope.codeList) {
                return;
            }

            //Escape codelists that are not arrays by default (has only one element)
            // This code can be removed when changes are made to codeList file.
            if (!($scope.codeList.LCPCodelists[codelist].item.length > 0)
                    && $scope.codeList.LCPCodelists[codelist].item.code == code) {
                return $scope.codeList.LCPCodelists[codelist].item.label;
            }

            var retValue;
            for (var i=0 ; i<=$scope.codeList.LCPCodelists[codelist].item.length - 1; i++) {
                if ($scope.codeList.LCPCodelists[codelist].item[i].code == code) {
                    retValue = $scope.codeList.LCPCodelists[codelist].item[i].label;
                    break;
                }
            }
            return retValue;
        };


        $scope.addItem = function(path) {

            var tokens = path.split(".");
            var result = $scope.instance;
            while(tokens.length) {
                result = result[tokens.shift()];
            }
            if (!(result instanceof Array)) {
                result = [];
            }
            // Need to make copy of object otherwise it gets same $$hashkey and it cannot be used in ng-repeat.
            // Other solution would be to get empty instance every time that would be slower.
            var copyOfEmptyInstance = clone($scope.getInstanceByPath('emptyInstance', path));
            result.push(copyOfEmptyInstance);
            return copyOfEmptyInstance;
        };

        $scope.getNextPlantId = function ( plantId_candidate ) {
            //
            var q = $q.defer ();

            var formNextPlantId = 1;
            var newPlantId = null;

            function pad(num, size) {
                var s = num+"";
                while (s.length < size) s = "0" + s;
                return s;
            }

            function checkSDS ( newPlantId ) {
                var url = "http://semantic.eea.europa.eu/sparql?format=application/json&query=";

                var sparql =
                    " PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>" +
                    " PREFIX lcpType: <http://semantic.eea.europa.eu/project/lcp_data/lcp_plants.csv/>" +
                    " PREFIX lcp: <http://semantic.eea.europa.eu/project/lcp_data/lcp_plants.csv#>" +
                    " SELECT *" +
                    " WHERE {" +
                    " ?plant a lcpType:lcpPlant ;" +
                    " lcp:Unique_Plant_ID ?PlantId." +
                    " FILTER ( ?PlantId = '" + newPlantId +"' )" +
                    " }" ;

                url = baseUri + '/restProxy?uri=' + encodeURIComponent(url + encodeURIComponent(sparql));
                $http.get(url, {tracker : $rootScope.loadingTracker})
                            .error(function(){alert("Failed to read data from remote database. Please check your connection."); q.reject();})
                            .success(function(eprtrData) {
                                if (eprtrData.results.bindings.length > 0) { // plandId exists in db
                                    // check against the next increment of plantid
                                    newPlantId =   ($scope.memberStateValue || $scope.instance.LCPQuestionnaire.BasicData.MemberState) + pad( parseInt( newPlantId.slice(2) ) + 1 , 4 ) ;
                                    $scope.getNextPlantId ( newPlantId ) . then ( function ( value ) {
                                        q.resolve ( value ) ;
                                    } ) ;
                                }
                                else { // plantid not reserved. resolve the promise
                                    q.resolve ( newPlantId ) ;
                                }
                });
            }

            if ( plantId_candidate == null )
            { // plantId_candidate == null on the first call of the function
                // we get the max plant id of the current plants on th form
                // and the max plant id from sds
                // then we will check for id collisions and increment by one the id and recheck, until a 'free' plant id is found

                var orderBy = $filter('orderBy');
                var orderedItems = orderBy( $scope.instance.LCPQuestionnaire.ListOfPlants.Plant, "PlantId", true);

                for (var i=0; i < orderedItems.length; i++) {
                            if (!isEmpty(orderedItems[i].PlantId ) && orderedItems[i].PlantId !== "" ) {
                                formNextPlantId = parseInt(orderedItems[i].PlantId.substring(orderedItems[i].PlantId.length - 4 )) + 1;
                                break;
                            }
                }


                // ---- query the sds for the max id
                var url = "http://semantic.eea.europa.eu/sparql?format=application/json&query=";

                var sparql =
                    " PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>" +
                    " PREFIX lcpType: <http://semantic.eea.europa.eu/project/lcp_data/plant_IDs.csv/>" +
                    " PREFIX lcp: <http://semantic.eea.europa.eu/project/lcp_data/plant_IDs.csv#> " +
                    " SELECT *" +
                    " WHERE {" +
                    " [] a lcpType:lcpPlantIds ;" +
                    " lcp:Unique_Plant_ID ?PlantId." +
                    " FILTER ( regex(?PlantId,'" +  ($scope.memberStateValue || $scope.instance.LCPQuestionnaire.BasicData.MemberState) +"') )" +
                    " }  ORDER BY DESC(?PlantId) LIMIT 1 " ;

                url = baseUri + '/restProxy?uri=' + encodeURIComponent(url + encodeURIComponent(sparql));
                $http.get(url, {tracker : $rootScope.loadingTracker})
                            .error(function(){alert("Failed to read data from remote databse. Please check your connection"); q.reject();})
                            .success(function(eprtrData) {
                                var nextId;
                                if ( eprtrData.results.bindings.length > 0 ) {
                                nextId = parseInt( eprtrData.results.bindings[0].PlantId.value.slice(2) ) + 1 ;
                                if ( formNextPlantId > nextId ) nextId = formNextPlantId ;
                            }
                                else nextId = formNextPlantId;

                                    newPlantId =   ($scope.memberStateValue || $scope.instance.LCPQuestionnaire.BasicData.MemberState) +
                                                    pad(  nextId , 4 ) ;
                                    checkSDS ( newPlantId ) ;

                });

            }
            else {
                checkSDS ( plantId_candidate ) ;
            }

            return q.promise ;

        }

        $scope.getMaxPlantId = function() {
            var orderBy = $filter('orderBy');
            var orderedItems = orderBy( $scope.instance.LCPQuestionnaire.ListOfPlants.Plant, "PlantId", true);
            var nextPlantId = 1;
            var newPlantId = null;
            var exists = null;

            for (var i=0; i < orderedItems.length; i++) {
                if (!isEmpty(orderedItems[i].PlantId ) && orderedItems[i].PlantId !== "" ) {
                    nextPlantId = parseInt(orderedItems[i].PlantId.substring(orderedItems[i].PlantId.length - 4 )) + 1;
                    break;
                }
            }
            // format the id : XXNNNN, where XX is the memberstate code and NNNN is a unique integer
            function pad(num, size) {
                var s = num+"";
                while (s.length < size) s = "0" + s;
                return s;
            }

            newPlantId =  ($scope.memberStateValue || $scope.instance.LCPQuestionnaire.BasicData.MemberState) + pad( nextPlantId, 4);

            return newPlantId;
        }

        $rootScope.getInstanceByPath = function(root, identifier) {
            //console.log(root);
            if (!$scope.instance) {
                return null;
            }

            var tokens = root.split(".");
            //console.log(tokens);
            var result = $scope;

            while(tokens.length) {
                result = result[tokens.shift()];
                if (!result) {
                    return null;
                }
            }

            tokens = identifier.split(".");

            while(tokens.length) {
                result = result[tokens.shift()];
            }

            return result;
        };

        $rootScope.getPlantByPath = function(plant, identifier) {
            //console.log(root);
            if (!$scope.instance) {
                return null;
            }

            var result;
            //console.log(tokens);
            if(plant != null){
             result = plant;
            }


            var tokens = identifier.split(".");

            while(tokens.length) {
                result = result[tokens.shift()];
            }

            return result;
        };

        // save instance data.
        $scope.saveInstance = function(){
           
            var plantsList = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant;
            for ( i=0 ; i < plantsList.length; i++) {
             if(plantsList[i].PlantLocation.CountryCode==null || plantsList[i].PlantLocation.CountryCode=="" )
                {
                    plantsList[i].PlantLocation.CountryCode=$scope.instance.LCPQuestionnaire.BasicData.MemberState;
                }
            }

            //$scope.submitted = true;
            var passedTheQas = $scope.runQAtests();
            var formComplete = $scope.isFormComplete();

			dataRepository.saveInstance($scope.instance).error(function(){

                $notification.error("Save", "Data was not saved !");})

            .success(function(response){
                if ( response.code === 0 ) {
                  alert("There was an error during the save operation. Data is not saved.")
                  return;
                }

                if ($scope.appForm.$invalid || ( !formComplete) ) {
                    $notification.info("Save", "Data was saved, but the questionnaire is incomplete.");
                }
                else if (!passedTheQas) {
                    $notification.info("Save", "Data was saved, but the questionnaire did not pass some QAs.");
                }
                else {
                    $notification.success("Save", "Data is saved successfully.");
                }

                $scope.appForm.$setPristine(true);

            });

        };

         $scope.hasArticle31DerogationValue = function(item){
             // check against this value: http://dd.eionet.europa.eu/vocabularyconcept/euregistryonindustrialsites/DerogationValue/Article31/
             if(item.PlantDetails!=null && item.PlantDetails.Derogation!= null){
                 if(item.PlantDetails.Derogation.indexOf("Article31") !== -1) {
                    return true;
                }
                else {
                    return false;
                }
             }
             return false;
         }

         $scope.hasArticle35DerogationValue = function(item){
             // check against this value: http://dd.eionet.europa.eu/vocabularyconcept/euregistryonindustrialsites/DerogationValue/Article35/
             if(item.PlantDetails!=null && item.PlantDetails.Derogation!= null){
                 if(item.PlantDetails.Derogation.indexOf("Article35") !== -1) {
                    return true;
                }
                else {
                    return false;
                }
             }
             return false;
         }


         $scope.addDesulphurizationValuesForEachMonth=function(i,plant){
                 plant.Desulphurisation.push({
                    "MonthValue":$scope.codeList.MonthlyDesulphurisation[i].MonthValue,
                    "DesulphurisationRate": $scope.codeList.MonthlyDesulphurisation[i].DesulphurisationRate,
                    "SulphurContent": $scope.codeList.MonthlyDesulphurisation[i].SulphurContent,
                    "TechnicalJustification": $scope.codeList.MonthlyDesulphurisation[i].TechnicalJustification,
                 })
         }
        $scope.isFormComplete = function () {
            // returns true if the required fields for all plant are filled; false if not ~

            var res = true;
            var plants = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant;
            var plant = null;
            var j = null;

            for ( i=0 ; i < plants.length; i++) {
                plant = plants[i];
                // list of plants
                if ( isEmpty (plant.PlantId) || isEmpty( plant.GeographicalCoordinate.Latitude) || isEmpty ( plant.GeographicalCoordinate.Longitude)   )
                    res = false;

                // plant details
                if ( isEmpty ( plant.PlantDetails.MWth) )
                    res = false;

    

                if (res === false) break;
            }

            return res;


        }


        $scope.runQAtests = function () {

            // conform the instance if needed

            var res = true;
            var plants = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant;

            if (plants.length != $scope.instance.LCPQuestionnaire.BasicData.NumberOfPlants)
                res = false;

            var sectors = {};
            var status  = {};

   //         for (i in $scope.codeList.LCPCodelists.sectors.concepts) {  sectors[ $scope.codeList.LCPCodelists.sectors.concepts[ i ] ['@id'] ] = 1 ; }
            // sectors is a dictionary of valid other sector values

        //    for (i in $scope.codeList.LCPCodelists.status.concepts) {  status[ $scope.codeList.LCPCodelists.status.concepts[ i ] ['@id'] ] = 1 ; }

            var names = {};
            var dublicates = {};
            var refDay = new Date("2003-11-27");

            for ( i=0 ; i < plants.length; i++) {

                // LCP 1.1
                // not refinery

                if ( !plants[i].PlantDetails) continue; // some times a null plant was present at the end of the array

                // coordinates
                if ( plants[i].GeographicalCoordinate.Longitude > 180 || plants[i].GeographicalCoordinate.Longitude < -180)
                    res = false;

                if ( plants[i].GeographicalCoordinate.Latitude > 90 || plants[i].GeographicalCoordinate.Latitude < -90)
                    res = false;
                //
           //     if ( !( plants[i].PlantDetails.Refineries) && ( !( plants[i].PlantDetails.OtherSector  )  || ! (sectors[plants[i].PlantDetails.OtherSector ] )) ){
                    // ^^ checks that if not Refineries, that OtherSector is filled with one of the permitted values(fetched from DD)
            //        res = false;
             //   }

          

                // LCP 2.1 Unequivocal naming of plants
                if ( names[ plants[i].PlantName ] != undefined ) {
                    // dublicate found
                    dublicates[i] = 1;
                    dublicates[ names[ plants [i].PlantName ] ] = 1;
                    //names[$scope.instance.LCPQuestionnaire.ListOfPlants.Plant[i].PlantName ].push(i);
                }
                else
                    names[ plants [i].PlantName] = i;

                // LCP 3.2

                if ( plants[i].PlantDetails.MWth < 50 ){
                    // error
                    res = false;
                }
                else if ( plants[i].PlantDetails.MWth > 10000){
                    // warning
                    console.log(i);
                }

                // LCP 3.4
              
                // LCP 3.5
             
                // LCP 3.6
                // valid dates(if date submitted)
                if ( !$scope.validDateFormat(plants[i].PlantDetails.DateOfStartOfOperation)) {
                        res = false;
                    }
               
           

            }// end for
            if ( JSON.stringify(dublicates) !== "{}") {
                // duplicates holds the plants with same names
                console.log(dublicates);
                res = false;
            }
            if ( res === true )  $scope.conformTheInstance();
            return res;
        }

        $scope.conformTheInstance = function () {

            var plants = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant;
            for (j in plants){

                plant = plants[j];

                delete plant.Delete;

                
                if ( plant.plantDetails!=null && plant.PlantDetails.Refineries !== true ){
                    plant.PlantDetails.Refineries = false;
                }
                if (plant.plantDetails!=null && plant.PlantDetails.Refineries === true ){
                    //plant.PlantDetails.OtherSector = null;
                }
               

            }

        }

        $scope.ifFormIsValidSaveInstance = function(form){
            if (!form.$invalid) {
                $scope.saveInstance();
            }

        }

        $scope.validationOnOff = function() {
            $scope.submitted = !$scope.submitted;
        };

        // save instance data.
        $scope.close = function(){
            if (baseUri == ''){baseUri = "/"};
            var windowLocation = (envelope && envelope.length > 0) ? envelope : baseUri;
            if ($scope.appForm.$dirty){
                if (confirm('You have made changes in the questionnaire! \n\n Do you want to leave without saving the data?')){
                    window.location = windowLocation;
                }
            }
            else {
                ////console.log("Failed to confirm");
                window.location = windowLocation;
            }
        };
        // convert XML to HTML in new window.
        $scope.printPreview = function(){
            dataRepository.saveInstance($scope.instance).success(function(){
				var win = window.open($scope.conversionLink, '_blank');
				win.focus;
			});
        };
        $scope.closeBulkEditListOfPlants = function(form){
            //if (form && form == 'ListOfPlants'){
                //remove empty rows
                for(var i = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant.length - 1; i >= 0; i--){

                    var plant = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant[i];

                    if ( plant.PlantLocation!=null && isEmpty(plant.PlantName)  && isEmpty(plant.EPRTRNationalId) &&
                           isEmpty(plant.PlantLocation.Address1) && isEmpty(plant.PlantLocation.Address2) &&
                           isEmpty(plant.PlantLocation.City) && isEmpty(plant.PlantLocation.Region) && isEmpty(plant.PlantLocation.PostalCode) &&
                           isEmpty(plant.GeographicalCoordinate.Longitude) && isEmpty(plant.GeographicalCoordinate.Latitude) && isEmpty(plant.FacilityName))

                    {
                        $scope.instance.LCPQuestionnaire.ListOfPlants.Plant.splice(i, 1);
                        continue;
                    }
                    // fill in plant IDs

                    if ( isEmpty(plant.PlantId) ) {
                        var promise = $scope.getNextPlantId () ;
                        var newPlant = plant;
                        // using $q promise API, to ask the server first for id collisions.
                        promise.then ( function ( plantid ) {
                            newPlant.PlantId = plantid ;
                        });

                    }
                }
            //}
            $scope.conformTheInstance();
            //
            $rootScope.bulkEditListOfPlants = false;
            $rootScope.$broadcast('updateFilter');
        };
        $scope.openBulkEditListOfPlants = function(form) {
            if (form && form === 'ListOfPlants') {
                $scope.addItem('LCPQuestionnaire.ListOfPlants.Plant');
            }
            if ($scope.instance.LCPQuestionnaire.ListOfPlants.Plant.length === 0) {

                $notification.info("Edit", "Add some plants from List of Plants first.");

            }
            else
            $rootScope.bulkEditListOfPlants = true;
        };

        $scope.windowSearch = window.location.search;

        $scope.getHelpInfo = function(divId) {
            //console.log(divId);
            var infoDiv = document.getElementById(divId);
            //console.log(infoDiv);
            return $sce.trustAsHtml(infoDiv.innerHTML);
        };

        $scope.changeInfoToggle = function(overInfoToggle) {
            $scope.showInfo = overInfoToggle;
        };

        $scope.phoneNumberPattern = /^[ 0-9\(\)\+\-]{7,25}$/;
        $scope.positiveIntegerPattern = /^\d+$/;
        $scope.positiveDecimalNumberPattern = /^\d*\.?\d*$/;
        $scope.binaryNumberPattern= /^(0(\.\d+)?|1(\.0+)?)$/;
        $scope.decimalNumberPattern =/^[+-]?(\d*\.?\d*)$/;
        $scope.dateFormat = /^(19|20)\d\d([-])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$/;

        $scope.websiteAddressPattern = /^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/;
        $scope.percentagePattern = /^100$|^[0-9]{1,2}$|^[0-9]{1,2}\,[0-9]{1,3}$/;
        $scope.longitudeNumberPattern = /^[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)$/;

        $scope.latitudeNumberPattern = /^[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?)$/;

        $scope.isFixedQuestion = function(dataPath) {
            var tokens = dataPath.split('.');
            var lastToken = tokens.pop();
            ////console.log(lastToken);
            ////console.log(lastToken == 'FixedQuestion');
            return (lastToken == 'FixedQuestion');
        }

        $scope.clearSubFormData = function(dataPaths, identifierPath, changeValueTo) {

            var elementCount = 0;
            for (var i = 0; i < dataPaths.length; i++) {
                var formElementInstance = $scope.getInstanceByPath('instance.LCPQuestionnaire', dataPaths[i]);
                elementCount += countNonEmptyProperties(formElementInstance, $scope.isFixedQuestion(dataPaths[i]));
            }

            // Need to get parent path of yes/no question otherwise assigning new value
            // to property does not work.
            var tokens = identifierPath.split('.');

            // Parent property of actual yes/no question
            var subFormInstanceIdentifier = tokens.shift();

            // Parent instance object that contains actual yes/no question property
            var parentInstance = $scope.getInstanceByPath('instance.LCPQuestionnaire', subFormInstanceIdentifier);
            var objectName = tokens.shift();

            var needsToClearData = true;

            if (needsToClearData) {
                // When element count is more than 0 then we have to ask confirmation from user whether to delete the data.
                if (elementCount > 0 && !confirm('When changing answer all data under this sub-form will be lost?')){
                    // toke.shift() extracts yes/no question name.
                    // Assing yes value to question
                    parentInstance[objectName] =  changeValueTo;
                    return;
                } else {
                    for (var i = 0; i < dataPaths.length; i++) {
                        var formElementInstance = $scope.getInstanceByPath('instance.LCPQuestionnaire', dataPaths[i]);

                        // For fields where there is only one field and it can be null. Just ignore it.
                        if (!formElementInstance) {
                            continue;
                        }

                        // This if-else is to differentiate just a string field from array or object.
                        if (formElementInstance instanceof Array || !formElementInstance.length) {
                            clearObject(formElementInstance, $scope.isFixedQuestion(dataPaths[i]));
                        } else {
                            var tokens = dataPaths[i].split('.');
                            var objectIdentifier = tokens.shift();
                            var parentObject = $scope.getInstanceByPath('instance.LCPQuestionnaire', objectIdentifier);
                            parentObject[tokens.shift()] = null;
                        }
                    }
                }
            } else {
                // Do nothing.
            }
        };

        $rootScope.TypeOfCombustionPlantFurtherDetails = false;

        $scope.isTypeOfCombustionPlantOther = function (plant) {
            if (plant.PlantDetails.TypeOfCombustionPlant === 'Others') {
                $rootScope.TypeOfCombustionPlantFurtherDetails = true;
            } else {
                $rootScope.TypeOfCombustionPlantFurtherDetails = false;
            }
        };

      /**  $scope.OtherSolidFuelsSet={OtherSolidFuels: []};
     $scope.OtherSolidFuelsSet.OtherSolidFuels=[{OtherSolidFuel: {"Category": null, "Value": null}}];

  

        $scope.addOtherSolidFuel = function($index){
    $scope.OtherSolidFuelsSet.OtherSolidFuels.push({OtherSolidFuel: {"Category": null, "Value": null}});
        }

**/
      

        //TODO format error message to handle different limits better
        $scope.errorMessages = {
            "required_field" : "This is a required field",
            "unique_abbreviation" : "Please provide a unique abbreviation ",
            "valid_telephone" : "Please enter a valid telephone number (at least 7 digits) ",
            "valid_email" : "Please enter a valid email address ",
            "valid_url" : "Please enter a valid URL ",
            "yes_or_no" : "Please choose yes or no ",
            "number_greater_than_zero" : "Please provide a number greater than 0 ",
            "data_entry_must_be_unique" : "Data entry must be unique ID code ",
            "must_be_less_than" : "Please provide a number less than ",
            "must_be_greater_than" : "Please provide a number greater or equal to ",
            "must_be_percentage" : "Please provide a percentage between 0 and 100 ",
            "whole_number_greater_than_zero" : "Please provide a whole number greater than 0 ",
            "unique_identification_code" : "Please enter a unique identification code ",
            "valid_longitude" : "Please provide a number between -180 and 180",
            "valid_latitude" : "Please provide a number between -90 and 90",
            "positive_decimal" : "Please provide a positive decimal number  ",
            "positive_decimal01" : "Please provide a positive decimal number between 0 and 1",
            "positive_integer" : "Please provide a positive integer ",
            "article_format" : "Please use the edit menu to correct the article format"

        };


        $scope.getErrorMessage = function(errorCode) {
            return $scope.errorMessages[errorCode];
        };

        $scope.showError = function(modelController, errorCode) {
            return modelController.$error[errorCode] && modelController.$invalid
                    && !(errorCode === 'required' && modelController.$error['pattern'] && modelController.$error['pattern'] ==true);// && modelController.$dirty;
        };
        $scope.showErrorIfSubmitted = function(modelController, errorCode, submitted) {
            return submitted && $scope.showError(modelController, errorCode);
        };


        $scope.isGreaterThanZero = function(inputValue) {
            return $scope.submitted == false && ( Number(inputValue) > 0);
        };

        $scope.isPositiveNumber = function(inputValue) {
            var boolean = true ;

            if ( isEmpty (inputValue) ) return false;

            if(!isEmpty(inputValue)  ){
                boolean = $scope.positiveIntegerPattern.test(inputValue);
            }
            return boolean;
        };

        $scope.isPositiveDecimal = function(inputValue) {

            // returns false if empty, or if not decimal(by regex comparison)
            if ( isEmpty (inputValue) ) return false;

            return $scope.positiveDecimalNumberPattern.test(inputValue);

        };
        

        $scope.validDateFormat = function( inputDate){
            // allows empty values for simplicity sake
            if ( isEmpty(inputDate)) return true;
            return $scope.dateFormat.test( inputDate );

        }

        $scope.isDegree = function(inputValue, degrees, submitted) {

            return ($scope.submitted == true && !isEmpty(inputValue) && !(Number(degrees) >= Number(inputValue) && Number(inputValue) >= -Number(degrees)));
        };

        $scope.isRequired = function(inputValue) {
            return  $scope.submitted == true && isEmpty(inputValue);
        };

        $scope.isModalRequired = function(inputValue) {
            var boolean = false;

            if(isEmpty(inputValue)){
                boolean=  true;
            }
            if(inputValue == undefined){
                boolean=  true;

            }
            else{
                if(inputValue.length == 0){
                    boolean=  true;
                }
            }

           /* if(inputValue == null){
                boolean=  true;
            }*/
            return   boolean;


        };


        $scope.checkboxClearInputs = function(plant, checkboxPath, dependingInputs) {
            var tokens1 = checkboxPath.split('.');
            var objectIdentifier1 = tokens1.shift();
            var checkboxObject = $scope.getPlantByPath(plant, objectIdentifier1);
            var property1 = tokens1[tokens1.length-1];
            var checkboxValue = checkboxObject[property1];

            if(checkboxValue == false){
                var inputPathArray = [];
                var isNotEmpty= false;
                var paths = dependingInputs.split(':');

                //Adding checkbox depending inputs to array
                for (var i = 0; i < paths.length; i++) {
                    var tokens2 = paths[i].split('.');
                    var objectIdentifier2 = tokens2.shift();
                    var parentObject = $scope.getPlantByPath(plant, objectIdentifier2);
                    var property = tokens2[tokens2.length-1];
                    var object = parentObject[property];
                    if($scope.positiveDecimalNumberPattern.test(object)){
                        object = object.toString();
                    }
                    //Error handling:  String in numeric field
                    if(object == null){
                        object = "";
                        isNotEmpty = false;
                    }
                    if(object == undefined){
                        object = "";
                        isNotEmpty = true;
                    }
                    inputPathArray.push(object)
                }

                //Is inputs empty
                for (var j = 0; j < inputPathArray.length; j++) {
                    if(inputPathArray[j].length > 0){
                        isNotEmpty = true;
                    }
                }


                if(checkboxValue == false && isNotEmpty){
                    if(confirm("Do you wish to clear data from depending input(s)?")){
                        for (var k = 0; k < paths.length; k++) {
                            var tokens3 = paths[k].split('.');
                            var objectIdentifier3 = tokens3.shift();
                            var parentObject2 = $scope.getPlantByPath(plant, objectIdentifier3);
                            var property2 = tokens3[tokens3.length-1];
                            parentObject2[property2] = "";

                        }
                    }else{
                    //checkbox rollback
                        checkboxObject[property1] = true;
                    }
                    return;
                }
            }
            else{
                var inputPathArray = [];
                var isNotEmpty= false;
                var paths = dependingInputs.split(':');

                //Adding checkbox depending inputs to array
                for (var i = 0; i < paths.length; i++) {
                    var tokens2 = paths[i].split('.');
                    var objectIdentifier2 = tokens2.shift();
                    var parentObject = $scope.getPlantByPath(plant, objectIdentifier2);
                    var property = tokens2[tokens2.length-1];
                    var object = parentObject[property];
                    if($scope.positiveDecimalNumberPattern.test(object)){
                        object = object.toString();
                    }
                    //Error handling:  String in numeric field
                    if(object == undefined){
                        object = "";
                        isNotEmpty = true;
                    }
                    inputPathArray.push(object)
                }

                //Is inputs empty
                for (var j = 0; j < inputPathArray.length; j++) {
                    if(inputPathArray[j].length > 0){
                        isNotEmpty = true;
                    }
                }

                if (tokens1 == 'Refineries' && checkboxValue == true && isNotEmpty){

                    if(confirm("Do you wish to clear data from depending input(s)?")){
                        for (var k = 0; k < paths.length; k++) {
                            var tokens3 = paths[k].split('.');
                            var objectIdentifier3 = tokens3.shift();
                            var parentObject2 = $scope.getPlantByPath(plant, objectIdentifier3);
                            var property2 = tokens3[tokens3.length-1];
                            parentObject2[property2] = "";

                        }
                    }else{
                        //checkbox rollback
                        checkboxObject[property1] = true;
                    }
                    return;
                }
            }
        }    ;

        $scope.isDesulphurizationRateEmpty = function (desulphurisation) {
            if (desulphurisation == null || desulphurisation.Months==null || desulphurisation.Months.Month==null  || desulphurisation.Months.Month.length==1) {
                return true;
            }
            if(desulphurisation.Months.Month.isArray){
            desulphurisation.Months.Month.forEach(function (element) {
                if (element.DesulphurisationRate == null) {
                    return true;
                }
            }, this);
        }
            return false;
        };

        $scope.isSulphurContentEmpty = function (desulphurisation) {
            if (desulphurisation == null || desulphurisation.Months==null || desulphurisation.Months.Month==null  || desulphurisation.Months.Month.length==1) {
                return true;
            }

            if(desulphurisation.Months.Month.isArray){                
            desulphurisation.Months.Month.forEach(function (element) {
                if (element.SulphurContent == null) {
                    return true;
                }

            }, this);
        }
            return false;
        };
        $scope.isTechnicalJustificationEmpty = function (desulphurisation) {
            if (desulphurisation == null || desulphurisation.Months==null || desulphurisation.Months.Month==null  || desulphurisation.Months.Month.length==1) {
                return true;
            }
            if(desulphurisation.Months.Month.isArray){
                
            desulphurisation.Months.Month.forEach(function (element) {

                if (element.TechnicalJustification == null || element.TechnicalJustification == '') {
                    return true;
                }

            }, this);
        }
            return false;
        };
        
    });
    function isEmpty(value){
        // returns true on undefined, empty array, empty string
        if(value === 0){
            return false;
        }
        else{
            return (!value || value === undefined || value.length === 0 || value === "" );
        }
    }



    // get instance data and save instance data
    app.factory('dataRepository', function($rootScope, $http) {
        var codeLists = {};
        //var lcpVocabularySetBaseUri = 'http://test.tripledev.ee/datadict/vocabulary/lcp/';
        //var lcpVocabularySetBaseUri = DD_VOCABULARY_BASE_URI + 'habides/';
     
     
        var EPRTRandlLCPVocabularySetBaseUri = DD_VOCABULARY_BASE_URI + 'EPRTRandLCP/';
        var EPRTRandLCPvocabularies =['CombustionPlantCategoryValue', 'CountryCodeValue', 'EPRTRPollutantCodeValue', 'FuelInputValue',
         'LCPPollutantCodeValue', 'MediumCodeValue', 'MethodClassificationValue', 'MethodCodeValue', 'MonthValue', 
         'OtherGaseousFuelValue', 'OtherSolidFuelValue', 'ReasonValue', 'UnitCodeValue', 'WasteClassificationValue',
          'WasteTreatmentValue'];
        var EPRTRandLCPvocabularyIdentifiersInCode = ['CombustionPlantCategoryValue', 'CountryCodeValue', 'EPRTRPollutantCodeValue', 'FuelInputValue',
         'LCPPollutantCodeValue', 'MediumCodeValue', 'MethodClassificationValue', 'MethodCodeValue', 'MonthValue', 
         'OtherGaseousFuelValue', 'OtherSolidFuelValue', 'ReasonValue', 'UnitCodeValue', 'WasteClassificationValue',
          'WasteTreatmentValue'];
        
      
  var lcpVocabularySetBaseUri = DD_VOCABULARY_BASE_URI + 'lcp/';
        var lcpVocabularies = ['lcpcountries','plantstatus','sectors'];
        var lcpVocabularyIdentifiersInCode = ['countries', 'status', 'sectors'];

        var commonVocabularySetBaseUri = DD_VOCABULARY_BASE_URI + 'common/';

        //define undefined members, i dont know if this is really necessary!!!
        codeLists.LCPCodelists = {};
        codeLists.OldLCPCodelists={};
        codeLists.CombustionPlantCodeLists={};
        codeLists.DerogationValueCodeLists={};
        codeLists.OtherSolidFuelCodeLists={};
        codeLists.OtherGasesousFuelCodeLists={};
        codeLists.MonthValueCodeLists={};
        codeLists.MonthlyDesulphurisation={};

        var regionCodeLists = {};
        for (var i = 0; i < EPRTRandLCPvocabularies.length; i++){
            codeLists.LCPCodelists[EPRTRandLCPvocabularyIdentifiersInCode[i]] = {};
        }
        for (var i = 0; i < lcpVocabularies.length; i++){
            codeLists.OldLCPCodelists[lcpVocabularyIdentifiersInCode[i]] = {};
        }
        return {
            getInstance: function() {
                var url = null;
                if (fileId){
                    url = getWebQUrl("/download/converted_user_file");
                }
				else {
                    url = "lcp-instance-test.json";
				}
                return $http.get(url, {tracker : $rootScope.loadingTracker});
            },
            saveInstance: function (data) {
                var url = getWebQUrl("/saveXml");
                fixUndefined(data);
                return $http.post(url, data, {tracker : $rootScope.loadingTracker});
            },
            getCodeList: function() {
                return codeLists;
            },
            loadCodeList: function(language) {
                //finds file in project folder
                var defaultlanguage = 'en';
                var currentLanguage = !language? defaultlanguage : language;

                for (var i = 0; i < EPRTRandLCPvocabularies.length; i++) {
                    var url = EPRTRandlLCPVocabularySetBaseUri + EPRTRandLCPvocabularies[i] + '/json?lang=' + currentLanguage;

                    if ($rootScope.isIE9 || window.isIE9){
                        url = baseUri + '/restProxy?uri=' + encodeURIComponent(url);
                    }

                    $http.get(url, {tracker: $rootScope.loadingTracker})
                            .error(function(data, status, headers, config){
                                alert("Failed to read code lists. Data = " +  data + ", status = " + status);})
                            .success((function(i){return function (newCodeList) {
                        angular.copy(newCodeList, codeLists.LCPCodelists[EPRTRandLCPvocabularyIdentifiersInCode[i]]);
                        ////console.log("received " + vocabularyIdentifiersInCode[i]);
                    }})(i));
                } 
            }, 
            loadOldLCPCodeList: function(language) {
                //finds file in project folder
                var defaultlanguage = 'en';
                var currentLanguage = !language? defaultlanguage : language;

                for (var i = 0; i < lcpVocabularies.length; i++) {
                    var url = lcpVocabularySetBaseUri + lcpVocabularies[i] + '/json?lang=' + currentLanguage;

                    if ($rootScope.isIE9 || window.isIE9){
                        url = baseUri + '/restProxy?uri=' + encodeURIComponent(url);
                    }

                    $http.get(url, {tracker: $rootScope.loadingTracker})
                            .error(function(data, status, headers, config){
                                alert("Failed to read code lists. Data = " +  data + ", status = " + status);})
                            .success((function(i){return function (newCodeList) {
                                console.log("newCodeList "+newCodeList);
                        angular.copy(newCodeList, codeLists.OldLCPCodelists[lcpVocabularyIdentifiersInCode[i]]);
                        ////console.log("received " + vocabularyIdentifiersInCode[i]);
                    }})(i));
                } 
            }, 
             loadCombustionPlantCodeList: function(language){
                // we do not need the for each of the above loadCodeList method, since in the above , it has to make seperate calls
                // for each vocabulary, whereas we do not have to.
                var defaultlanguage = 'en';
                var currentLanguage = !language? defaultlanguage : language;
                var url = 'http://dd.eionet.europa.eu/vocabulary/EPRTRandLCP/CombustionPlantCategoryValue/json';
                $http.get(url, {tracker: $rootScope.loadingTracker})
                .error(function(data, status, headers, config){
                    alert("Failed to read code lists. Data = " +  data + ", status = " + status);})
                .success( function (newCodeList) {
            angular.copy(newCodeList, codeLists.CombustionPlantCodeLists);
            ////console.log("received " + vocabularyIdentifiersInCode[i]);
                  });
            },
            loadDerogationValueCodeList: function(language){
                // we do not need the for each of the above loadCodeList method, since in the above , it has to make seperate calls
                // for each vocabulary, whereas we do not have to.
                var defaultlanguage = 'en';
                var currentLanguage = !language? defaultlanguage : language;
                var url = 'http://dd.eionet.europa.eu/vocabulary/euregistryonindustrialsites/DerogationValue/json';
                $http.get(url, {tracker: $rootScope.loadingTracker})
                .error(function(data, status, headers, config){
                    alert("Failed to read code lists. Data = " +  data + ", status = " + status);})
                .success( function (newCodeList) {
            angular.copy(newCodeList, codeLists.DerogationValueCodeLists);
            ////console.log("received " + vocabularyIdentifiersInCode[i]);
                  });
            },
            loadOtherSolidFuelCodeList: function(language){
                // we do not need the for each of the above loadCodeList method, since in the above , it has to make seperate calls
                // for each vocabulary, whereas we do not have to.
                var defaultlanguage = 'en';
                var currentLanguage = !language? defaultlanguage : language;
                var url = 'http://dd.eionet.europa.eu/vocabulary/EPRTRandLCP/OtherSolidFuelValue/json';
                $http.get(url, {tracker: $rootScope.loadingTracker})
                .error(function(data, status, headers, config){
                    alert("Failed to read code lists. Data = " +  data + ", status = " + status);})
                .success( function (newCodeList) {
                    //Push "Other" value to the end of the Array
                    var otherElement ={};
                    newCodeList.concepts.forEach(function(element) {
                        if(element['@id']=='Other'){
                            var OtherElementIndex = newCodeList.concepts.indexOf(element);
                            newCodeList.concepts.splice(OtherElementIndex,1);
                             Object.assign(otherElement,element);
                        }
                    }, this);
                    newCodeList.concepts.push(otherElement);
            angular.copy(newCodeList, codeLists.OtherSolidFuelCodeLists);
                  });
            },
            loadOtherGasesousFuelCodeList: function(language){
                // we do not need the for each of the above loadCodeList method, since in the above , it has to make seperate calls
                // for each vocabulary, whereas we do not have to.
                var defaultlanguage = 'en';
                var currentLanguage = !language? defaultlanguage : language;
                var url = 'http://dd.eionet.europa.eu/vocabulary/EPRTRandLCP/OtherGaseousFuelValue/json';
                $http.get(url, {tracker: $rootScope.loadingTracker})
                .error(function(data, status, headers, config){
                    alert("Failed to read code lists. Data = " +  data + ", status = " + status);})
                .success( function (newCodeList) {
                        //Push "Other" value to the end of the Array
                        var otherElement ={};
                        newCodeList.concepts.forEach(function(element) {
                            if(element['@id']=='Other'){
                                var OtherElementIndex = newCodeList.concepts.indexOf(element);
                                newCodeList.concepts.splice(OtherElementIndex,1);
                                 Object.assign(otherElement,element);
                            }
                        }, this);
                        newCodeList.concepts.push(otherElement);
            angular.copy(newCodeList, codeLists.OtherGasesousFuelCodeLists);
            ////console.log("received " + vocabularyIdentifiersInCode[i]);
                  });
            },
            loadMonthValueCodeList: function(language){
                // we do not need the for each of the above loadCodeList method, since in the above , it has to make seperate calls
                // for each vocabulary, whereas we do not have to.
                var defaultlanguage = 'en';
                var currentLanguage = !language? defaultlanguage : language;
                var url = 'http://dd.eionet.europa.eu/vocabulary/EPRTRandLCP/MonthValue/json';
                $http.get(url, {tracker: $rootScope.loadingTracker})
                .error(function(data, status, headers, config){
                    alert("Failed to read code lists. Data = " +  data + ", status = " + status);})
                .success( function (newCodeList) {
            angular.copy(newCodeList, codeLists.MonthValueCodeLists);
            ////console.log("received " + vocabularyIdentifiersInCode[i]);
            angular.forEach(codeLists.MonthValueCodeLists.concepts, function(value, key){
                          codeLists.MonthlyDesulphurisation[key]={
                    "DesulphurisationRate": '',
                    "MonthValue":value.prefLabel[0]['@value'],
                    "SulphurContent": '',
                    "TechnicalJustification": ''
                    };
                });
            });
        },
       
            loadRegionsCodelist: function(country) {
                var url = DD_VOCABULARY_BASE_URI + "common/nuts/json?id=" + country;
                if ($rootScope.isIE9 || window.isIE9){
                    url = baseUri + '/restProxy?uri=' + encodeURIComponent(url);
                }
                //console.log(url);
                $http.get(url, {tracker: $rootScope.loadingTracker})
                        .error(function(data, status, headers, config){alert("Failed to read regions code lists.");})
                        .success(function (newCodeList) {
                            angular.copy(newCodeList, regionCodeLists);
                            if(regionCodeLists.concepts.length == 0){
                                var url = DD_VOCABULARY_BASE_URI + "lcp/lcpcountries/json?id=" + country;
                                if ($rootScope.isIE9 || window.isIE9){
                                    url = baseUri + '/restProxy?uri=' + encodeURIComponent(url);
                                }
                                $http.get(url, {tracker: $rootScope.loadingTracker})
                                    .error(function(data, status, headers, config){alert("Failed to read regions code lists.");})
                                    .success(function (plantDetailsOtherSectorFieldsViewnewCodeList) {
                                    angular.copy(newCodeList, regionCodeLists);
                                });
                            }
                        });
                return regionCodeLists;
            },
            getEmptyInstance: function() {
                var url = 'lcp-instance-empty.xml?format=json';
                return $http.get(url, {tracker : $rootScope.loadingTracker});
            },
            loadInstanceInfo: function (data) {
                var url = getWebQUrl("/file/info");
                return $http.get(url, data, {tracker : $rootScope.loadingTracker});
            }
        }
    });

    // new
    app.filter('offset', function() {
        return function(input, start) {
            if (!input || !(input instanceof Array)) {
                return;
            }
            start = parseInt(start, 10);
            return input.slice(start);
        };
    });

  /**  app.filter('formatDerogation', function () {
        return function (x) {
            var result = "";
            if (x != null &&x.isArray) {
                x.forEach(function (entry) {
                    result += entry;
                    result += '\n';
                });
            }
            return result;
        };
    });
     **/
    app.controller('ModalCtrl', function ($scope, $rootScope, $modal, $http) {
        //saves Main form validation stage
        $scope.mainFormSubmitted = $scope.submitted;
        $scope.plant;
        $scope.originalPlant;

        $scope.submitted = false;
        $scope.editBoolean = false;
        /*$scope.edit = function (plant){
            $scope.editBoolean = true;
            $scope.plant= plant;
            $scope.open('lg');
        }*/
        $scope.add = function (){
            $scope.submitted = false;
            $scope.editBoolean = false;
            $scope.plant = null;
            $scope.open('lg');
        }
        $rootScope.$watch('selectedPlant', function(newValue, oldValue) {
            if (newValue && newValue != null ){
                $scope.submitted = true;
                $scope.editBoolean = true;
                $scope.originalPlant =  newValue;
                $scope.plant = angular.copy(newValue);
                $rootScope.selectedPlant = null;
                $scope.open('lg', $rootScope.modalPageCaseId);
            }
        });
        $scope.openAdd = function(){
            
            $rootScope.modalPageCaseId = "ListOfPlants";
            $rootScope.selectedPlant = null;
            $scope.open('lg','ListOfPlants');
        }
        $scope.loadDataFromEPRTR = function(plant) {
            console.log('loadDataFromEPRTR function invoked');
            var countryCode = $scope.instance.LCPQuestionnaire.BasicData.MemberState;
            if (countryCode && countryCode.length == 2 && plant ) {

                var eprtrCountryCode = countryCode === "GB" ? "UK" : countryCode === "GR" ? "EL" : countryCode;

                var url = "http://semantic.eea.europa.eu/sparql?format=application/json&query=";
                var sparql = "PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> " +
                        " PREFIX cr: <http://cr.eionet.europa.eu/ontologies/contreg.rdf#> " +
                        " PREFIX prtr: <http://prtr.ec.europa.eu/rdf/schema.rdf#> " +
                        " PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> " +
                        " SELECT ?countryCode ?NationalID ?facilityID ?facilityName ?streetName ?buildingNumber ?postalCode ?city ?lat ?long ?reportingYear" +
                        " WHERE { ?facility a prtr:Facility ; " +
                        " prtr:facilityID ?facilityID ; " +
                        " prtr:facilityName ?facilityName ; " +
                        " prtr:streetName ?streetName; " +
                        "prtr:buildingNumber  ?buildingNumber ; "+
                        " prtr:postalCode  ?postalCode ; " +
                        " prtr:city ?city ; " +
                        " geo:lat ?lat ; " +
                        " geo:long ?long ; " +
                        " prtr:latestReport ?latestreport ;" +
                        " prtr:inCountry ?inCountry . " +
                        " ?inCountry prtr:code ?countryCode . " +
                        " ?latestreport prtr:nationalID ?NationalID ;" +
                        " prtr:reportingYear ?reportingYear." +
                        " FILTER (?countryCode = '" + eprtrCountryCode + "' and UCASE(?NationalID) = UCASE('" + plant.EPRTRNationalId + "' ) ) } ORDER BY DESC(?reportingYear) LIMIT 1";
                url = baseUri + '/restProxy?uri=' + encodeURIComponent(url + encodeURIComponent(sparql));
                console.log('url for sparql eprtr data is:'+url);
                $http.get(url, {tracker : $rootScope.loadingTracker})
                        .error(function(){alert("Failed to read data from E-PRTR.");})
                        .success(function(eprtrData) {
                            if (eprtrData.results.bindings.length > 0) {
                            var facility = eprtrData.results.bindings[0];
                            if (confirm("The system found the following facility: " + facility.facilityName.value + ", " + facility.streetName.value + ", " + facility.postalCode.value +
                                    ", "  + facility.city.value + ". \n\n Do you want to use the data on plant level?" )) {
                                    if (!plant.PlantLocation) plant.PlantLocation = {};
                                    if (!plant.GeographicalCoordinate) plant.GeographicalCoordinate = {};
                                    plant.PlantLocation.StreetName = facility.streetName.value;
                                    if (!isEmpty(facility.buildingNumber.value)) {
                                        plant.PlantLocation.BuildingNumber += " " + facility.buildingNumber.value;
                                    }
                                    plant.PlantLocation.City =facility.city.value;
                                    plant.PlantLocation.PostalCode = facility.postalCode.value;
                                    plant.PlantLocation.BuildingNumber = facility.buildingNumber.value;
                                    plant.GeographicalCoordinate.Longitude = facility.long.value;
                                    plant.GeographicalCoordinate.Latitude = facility.lat.value;
                                    plant.FacilityName = facility.facilityName.value;
                               }
                            }
                            else {
                                alert("The system could not find any facility with NationalID=" + plant.EPRTRNationalId);
                            }
                        });
            }
            else {
                alert("Member state is not selected on Basic Data form!");
            }
        };
        //edit(
        $scope.open = function (size,modalPageId) {
            //console.log(modalPageId);
            //console.log($rootScope.modalPageCaseId== undefined);
            //console.log($rootScope.modalPageCaseId=="ListOfPlants");
            //console.log($rootScope.modalPageCaseId=="PlantDetails");
            var modalInstance;
            //For adding new plant
            if(modalPageId == undefined){
 //               if ( $scope.instance.LCPQuestionnaire.BasicData.MemberState!=null )
//{               
                modalInstance = $modal.open({

                    templateUrl: 'ListOfPlantModalContent.html',
                    controller: 'ListOfPlantsModalInstanceCtrl',
                    size: size,
                    scope: $scope,
                    windowClass: 'app-modal-window',
                    resolve: {
                        plant: function () {
                            return  $scope.plant;
                        }
                    }

                });
            //   }else{
             //      alert("Please fill in the Member State from Basic Info first.");
             //      return;
             //  }
               
            }
            //For editing plant
            if(modalPageId == "ListOfPlants"){
                modalInstance = $modal.open({

                    templateUrl: 'ListOfPlantModalContent.html',
                    controller: 'ListOfPlantsModalInstanceCtrl',
                    size: size,
                    scope: $scope,
                    windowClass: 'app-modal-window',
                    resolve: {
                        plant: function () {
                            return  $scope.plant;
                        }
                    }

                });
            }
            if(modalPageId == "PlantDetails"){
                 modalInstance = $modal.open({

                    templateUrl: 'PlantDetailsModalContent.html',
                    controller: 'PlantDetailsModalInstanceCtrl',
                    size: size,
                    scope: $scope,
                    windowClass: 'app-modal-window',
                    resolve: {
                        plant: function () {
                            return  $scope.plant;
                        }
                    }

                });
            }
            if(modalPageId=="TotalEmissionsToAir"){
                modalInstance = $modal.open({

                    templateUrl: 'TotalEmissionsToAirModalContent.html',
                    controller: 'TotalEmissionsToAirModalInstanceCtrl',
                    size: size,
                    scope: $scope,
                    windowClass: 'app-modal-window',
                    resolve: {
                        plant: function () {
                            return  $scope.plant;
                        }
                    }

                });
            }
            if(modalPageId=="EnergyInput"){
                modalInstance = $modal.open({

                    templateUrl: 'EnergyInputModalContent.html',
                    controller: 'EnergyInputModalInstanceCtrl',
                    size: size,
                    scope: $scope,
                    windowClass: 'app-modal-window',
                    resolve: {
                        plant: function () {
                            return  $scope.plant;
                        }
                    }

                });
            }
            if(modalPageId=="Desulphurisation"){
                modalInstance = $modal.open({

                    templateUrl: 'DesulphurisationModalContent.html',
                    controller: 'DesulphurisationModalInstanceCtrl',
                    size: size,
                    scope: $scope,
                    windowClass: 'app-modal-window',
                    resolve: {
                        plant: function () {
                            return  $scope.plant;
                        }
                    }

                });
            }
            if(modalPageId=="UsefulHeat"){
                modalInstance = $modal.open({

                    templateUrl: 'UsefulHeatModalContent.html',
                    controller: 'UsefulHeatModalInstanceCtrl',
                    size: size,
                    scope: $scope,
                    windowClass: 'app-modal-window',
                    resolve: {
                        plant: function () {
                            return  $scope.plant;
                        }
                    }

                });
            }

            modalInstance.result.then(function (selectedItem) {
                $scope.selected = selectedItem;
            }, function () {
                //$log.info('Modal dismissed at: ' + new Date());
            });
        };
    });

    app.controller('ListOfPlantsModalInstanceCtrl', function ($rootScope, $scope, $modalInstance, plant,dataRepository) {
        var edit = false;


        if(plant != undefined){
            edit = true;
        }

        if (JSON.stringify( $scope.regionsCodelist ) === "{}")  {

            if ( $scope.instance.LCPQuestionnaire.BasicData.MemberState )
                $scope.regionsCodelist = dataRepository.loadRegionsCodelist($scope.instance.LCPQuestionnaire.BasicData.MemberState);
            else {
                alert("Please fill in the Member State from Basic Info first.");
                $scope.submitted = $scope.mainFormSubmitted;
             //   $modalInstance.dismiss('cancel');
                $modalInstance.close();
            }
        }

        $scope.ok = function (plant) {

            $scope.submitted = true;
            if(plant != undefined){
                if(plant.PlantName != null && plant.GeographicalCoordinate.Longitude != null &&
                        (180 >= plant.GeographicalCoordinate.Longitude && plant.GeographicalCoordinate.Longitude >= -180)  &&
                        plant.GeographicalCoordinate.Latitude != null && (90 >= plant.GeographicalCoordinate.Latitude && plant.GeographicalCoordinate.Latitude >= -90)){
                    if(!edit){

                        if ( plant.PlantLocation == null ) plant.PlantLocation = {} ;

                        var lastPlant = $scope.addItem('LCPQuestionnaire.ListOfPlants.Plant');
                        var promise = $scope.getNextPlantId () ;
                        // using $q promise API, to ask the server first for id collisions.
                        promise.then ( function ( plantid ) {

                            lastPlant.PlantId = plantid ;
                            lastPlant.PlantName =  plant.PlantName;
                            lastPlant.EPRTRNationalId =  plant.EPRTRNationalId;
                            lastPlant.PlantLocation.StreetName =  plant.PlantLocation.StreetName;
                         //   lastPlant.PlantLocation.Address2 =  plant.PlantLocation.Address2;
                            lastPlant.PlantLocation.City =  plant.PlantLocation.City;
                            lastPlant.PlantLocation.Region =  plant.PlantLocation.Region;
                            lastPlant.PlantLocation.PostalCode =  plant.PlantLocation.PostalCode;
                            lastPlant.PlantLocation.BuildingNumber =  plant.PlantLocation.BuildingNumber;
                            lastPlant.PlantLocation.CountryCode =  $scope.instance.LCPQuestionnaire.BasicData.MemberState;
                            lastPlant.GeographicalCoordinate.Longitude =  plant.GeographicalCoordinate.Longitude;
                            lastPlant.GeographicalCoordinate.Latitude =  plant.GeographicalCoordinate.Latitude;
                            lastPlant.FacilityName =  plant.FacilityName;
                            lastPlant.Comments =  plant.Comments;

                            $rootScope.$broadcast('updateFilter');

                            //load Main form validation stage
                            $scope.submitted = $scope.mainFormSubmitted;
                            $scope.saveInstance();
                             $modalInstance.close(plant);

                        })

                    }
                    else{
                        var lastPlant = $scope.originalPlant;
                        lastPlant.PlantName =  plant.PlantName;
                        lastPlant.EPRTRNationalId =  plant.EPRTRNationalId;
                        lastPlant.PlantLocation.StreetName =  plant.PlantLocation.StreetName;
                        //lastPlant.PlantLocation.Address2 =  plant.PlantLocation.Address2;
                        lastPlant.PlantLocation.City =  plant.PlantLocation.City;
                        lastPlant.PlantLocation.Region =  plant.PlantLocation.Region;
                        lastPlant.PlantLocation.BuildingNumber =  plant.PlantLocation.BuildingNumber;
                        lastPlant.PlantLocation.PostalCode =  plant.PlantLocation.PostalCode;
                        lastPlant.PlantLocation.CountryCode = $scope.instance.LCPQuestionnaire.BasicData.MemberState;
                        lastPlant.GeographicalCoordinate.Longitude =  plant.GeographicalCoordinate.Longitude;
                        lastPlant.GeographicalCoordinate.Latitude =  plant.GeographicalCoordinate.Latitude;
                        lastPlant.FacilityName =  plant.FacilityName;
                        lastPlant.Comments =  plant.Comments;

                        $rootScope.$broadcast('updateFilter');

                        //load Main form validation stage
                        $scope.submitted = $scope.mainFormSubmitted;
                            $scope.saveInstance();
                                             $modalInstance.close(plant);


                     }

                } else{
                     $scope.submitted = true;
                     alert("Please fill in all mandatory fields!");
                 }
            } else{
                 $scope.submitted = true;
                 alert("Please fill in all mandatory fields!");
             }

        };
        $scope.saveAndAdd =  function(plant){
            $scope.ok(plant);
            saveInstance();
        }
        $scope.cancel = function () {
            //load Main form validation stage
            $scope.submitted = $scope.mainFormSubmitted;
            $modalInstance.dismiss('cancel');
        };
    });
    app.controller('PlantDetailsModalInstanceCtrl', function ($rootScope, $filter, $scope, $modalInstance, plant) {
        $scope.ok = function (plant) {
            if (!$scope.modalPlantDetails.$invalid) {
                var lastPlant = $scope.originalPlant;
                lastPlant.PlantDetails.MWth =  plant.PlantDetails.MWth;
                lastPlant.PlantDetails.DateOfStartOfOperation =  plant.PlantDetails.DateOfStartOfOperation;
                lastPlant.PlantDetails.Refineries =  $filter('lowercase')(plant.PlantDetails.Refineries);
                lastPlant.PlantDetails.OtherSector =  plant.PlantDetails.OtherSector;
                lastPlant.PlantDetails.OperatingHours =  plant.PlantDetails.OperatingHours;                
                lastPlant.PlantDetails.Comments =  plant.PlantDetails.Comments;
                
                lastPlant.PlantDetails.TypeOfCombustionPlant = plant.PlantDetails.TypeOfCombustionPlant;
                lastPlant.PlantDetails.TypeOfCombustionPlantFurtherDetails = plant.PlantDetails.TypeOfCombustionPlantFurtherDetails;
                lastPlant.PlantDetails.Derogation = plant.PlantDetails.Derogation;
    

                $rootScope.$broadcast('updateFilter');

                //load Main form validation stage
                $scope.submitted = $scope.mainFormSubmitted;
                $scope.modalPlantDetails.$setPristine(true);
                $modalInstance.close(plant);
            }
            else{
                $scope.submitted = true;
                alert("Please fill in all mandatory fields! ");
            }


        }

        $scope.cancel = function () {
            //load Main form validation stage
            $scope.submitted = $scope.mainFormSubmitted;
            $modalInstance.dismiss('cancel');
        };
    });

    app.controller('TotalEmissionsToAirModalInstanceCtrl', function ($rootScope, $scope, $modalInstance, plant) {

        $scope.ok = function (plant) {
            if (!$scope.modalTotalEmissionsToAir.$invalid) {
                var lastPlant = $scope.originalPlant;

                lastPlant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.SO2 =  plant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.SO2;
                lastPlant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.NOx =  plant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.NOx;
                lastPlant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.TSP =  plant.EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.TSP;

                $rootScope.$broadcast('updateFilter');

                //load Main form validation stage
                $scope.submitted = $scope.mainFormSubmitted;
                $scope.modalTotalEmissionsToAir.$setPristine(true);
                $modalInstance.close(plant);
            }
            else{
                $scope.submitted = true;
                alert("Please fill in all mandatory fields! ");
            }


        }

        $scope.cancel = function () {
            //load Main form validation stage
            $scope.submitted = $scope.mainFormSubmitted;
            $modalInstance.dismiss('cancel');
        };
    });
app.controller('EnergyInputModalInstanceCtrl', function ($rootScope, $scope, $modalInstance, plant) {

    $scope.addOtherSolidFuel = function(){
     plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.OtherSolidFuel.push({"Category": null, "Value": null});
        }
        $scope.addOtherGas = function(){
            plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.OtherGas.push({"Category": null, "Value": null});
               }

        $scope.removeOtherSolidFuel = function(index){
            plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.OtherSolidFuel.splice(index,1);
        }
        $scope.removeOtherGas = function(index){
            plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.OtherGas.splice(index,1);
        }
  if(plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels==null || plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.OtherSolidFuel==null  
  || plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.OtherSolidFuel.constructor === Object || plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.OtherSolidFuel==1) {
    plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.OtherSolidFuel=[];
    plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.OtherSolidFuel.push({"Category": null, "Value": null});
    
  }
  if(plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases==null || plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.OtherGas==null  
    || plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.OtherGas.constructor === Object || plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.OtherGas==1) {
      plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.OtherGas=[];
      plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.OtherGas.push({"Category": null, "Value": null});
      
    }

                



        $scope.ok = function (plant) {
            if (!$scope.modalEnergyInput.$invalid) {
                var lastPlant = $scope.originalPlant;

                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Biomass =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Biomass;
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Biomass =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Biomass;  
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Coal =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Coal;      
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Lignite =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Lignite;      
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Peat =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.Peat;      
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels;
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.LiquidFuels =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.LiquidFuels;
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.NaturalGas =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.NaturalGas;
                lastPlant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases =  plant.EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases;

                $rootScope.$broadcast('updateFilter');

                //load Main form validation stage
                $scope.submitted = $scope.mainFormSubmitted;
                $scope.modalEnergyInput.$setPristine(true);
                $modalInstance.close(plant);
            }
            else{
                $scope.submitted = true;
                alert("Please fill in all mandatory fields! ");
            }


        }

        $scope.cancel = function () {
            //load Main form validation stage
            $scope.submitted = $scope.mainFormSubmitted;
            $modalInstance.dismiss('cancel');
        };
    });

    
            app.controller('DesulphurisationModalInstanceCtrl', function ($rootScope, $scope, $modalInstance, plant) {

                //We check if Month is an array and if not initialize it as an array in order to then fill it below.
                if(plant.Desulphurisation.Months==null || plant.Desulphurisation.Months.Month==null  || plant.Desulphurisation.Months.Month.constructor === Object || plant.Desulphurisation.Months.Month.length==1) {
                    plant.Desulphurisation.Months.Month=[];
                //If Months Empty , initialize them before the modal
                angular.forEach($scope.codeList.MonthlyDesulphurisation, function (value, key) {
                    if (plant.Desulphurisation.Months.Month[key]==null){
                         plant.Desulphurisation.Months.Month.push({
                                "MonthValue": value.MonthValue,
                                "DesulphurisationRate": null,
                                "SulphurContent": null,
                                "TechnicalJustification": null
                            });
                    }

                })
                }
               

                $scope.ok = function (plant) {
                    if (!$scope.modalDesulphurisation.$invalid) {
                        var lastPlant = $scope.originalPlant;
                        angular.forEach($scope.codeList.MonthlyDesulphurisation, function (value, key) {
                     /**       plant.Desulphurisation.Months.Month.push({
                                "MonthValue": value.MonthValue,
                                "DesulphurisationRate": value.DesulphurisationRate,
                                "SulphurContent": value.SulphurContent,
                                "TechnicalJustification": value.TechnicalJustification
                            });
                        **/
                        })

                        lastPlant.Desulphurisation = plant.Desulphurisation;
                        $rootScope.$broadcast('updateFilter');
                        //load Main form validation stage
                        $scope.submitted = $scope.mainFormSubmitted;
                        $scope.modalDesulphurisation.$setPristine(true);
                        $modalInstance.close(plant);

                    }
                    else {
                        $scope.submitted = true;
                        alert("Please fill in all mandatory fields! ");
                    }


                }

                $scope.cancel = function () {
                    //load Main form validation stage
                    $scope.submitted = $scope.mainFormSubmitted;
                    $modalInstance.dismiss('cancel');
                };
            });

            app.controller('UsefulHeatModalInstanceCtrl', function ($rootScope, $scope, $modalInstance, plant) {
                
                        $scope.ok = function (plant) {
                            if (!$scope.modalUsefulHeat.$invalid) {
                                var lastPlant = $scope.originalPlant;
                
                                lastPlant.UsefulHeat.UsefulHeatProportion =  plant.UsefulHeat.UsefulHeatProportion;
                              
                                $rootScope.$broadcast('updateFilter');
                
                                //load Main form validation stage
                                $scope.submitted = $scope.mainFormSubmitted;
                                $scope.modalUsefulHeat.$setPristine(true);
                                $modalInstance.close(plant);
                            }
                            else{
                                $scope.submitted = true;
                                alert("Please fill in all mandatory fields! ");
                            }
                
                
                        }
                
                        $scope.cancel = function () {
                            //load Main form validation stage
                            $scope.submitted = $scope.mainFormSubmitted;
                            $modalInstance.dismiss('cancel');
                        };
                    });

  
    app.filter('true_false', function() {
        return function(text, length, end) {
            if (text && (text === true || text === 'TRUE')) {
                return 'Yes';
            }
            return 'No';
        }
    });

    app.controller("PaginationCtrl", function($scope, $filter, $rootScope, $modal) {



        var orderBy = $filter('orderBy');
        /*
            if (!angular.isArray($scope.instance.LCPQuestionnaire.ListOfPlants)){
                $scope.instance.LCPQuestionnaire.ListOfPlants = [$scope.instance.LCPQuestionnaire.ListOfPlants];
            }
        */


        $scope.itemsPerPage = 50;
        $scope.currentPage = 0;
        $scope.maxPages = 15;
        $scope.searchText = "";
        $scope.filteredItems = [];
        $scope.predicateAttribute = 'PlantId';
        $scope.showMessage = false;
        $scope.predicate = function(item) {
            return item[$scope.predicateAttribute];
        }
        $scope.reverse = false;



        $scope.order = function(attribute, order) {
            $scope.predicateAttribute = attribute;
            $scope.reverse = order;
            $scope.filteredItems = orderBy($scope.filteredItems, $scope.predicate, $scope.reverse);
        };

        $scope.$on('instanceReady', function(event, data) {

            $scope.filteredItems = $scope.getFilteredItems();
        });

        $scope.$on('updateFilter', function(event, data) {

            $scope.filteredItems = $scope.getFilteredItems();
            $scope.order($scope.predicateAttribute, $scope.reverse);
        });

        $scope.range = function() {
            if (!$scope.instance) {
                return;
            }

            var rangeSize = ($scope.pageCount() >= $scope.MaxPages)? $scope.MaxPages : $scope.pageCount()+1;
            var ret = [];
            var start;

            start = $scope.currentPage;
            if ( start > $scope.pageCount()-rangeSize ) {
                start = $scope.pageCount()-rangeSize+1;
            }

            for (var i=start; i<start+rangeSize; i++) {
                ret.push(i);
            }
            return ret;
        };

        $scope.prevPage = function() {
            if ($scope.currentPage > 0) {
                $scope.currentPage--;
            }
        };

        $scope.prevPageDisabled = function() {
            return $scope.currentPage === 0 ? "disabled" : "";
        };

        $scope.getFilteredItems = function() {
            if (!$scope.instance) {
                return;
            }
            return $filter('filter')($scope.instance.LCPQuestionnaire.ListOfPlants.Plant, $scope.searchText);
        }

        $scope.refreshItems = function() {
            ////console.log("Filter changed. Getting new items...");
            $scope.filteredItems = $scope.getFilteredItems();
        };

        $scope.$watch('searchText', function(newValue, oldValue) {
            ////console.log("Filter changed. Getting new items...");
            $scope.filteredItems = $scope.getFilteredItems();
            if(newValue != oldValue){
                $scope.setPage(0);
            }
        });

        $scope.pageCount = function() {
            if (!$scope.instance || !$scope.filteredItems) {
                return;
            }

            var items = $scope.filteredItems;
            var count = Math.ceil(items.length/$scope.itemsPerPage)-1;
            return count;
        };

        $scope.nextPage = function() {
            if ($scope.currentPage < $scope.pageCount()) {
                $scope.currentPage++;
            }
        };

        $scope.nextPageDisabled = function() {
            return $scope.currentPage === $scope.pageCount() ? "disabled" : "";
        };

        $scope.setPage = function(n) {
            $scope.currentPage = n;
        };
        $scope.deleteSelected = function(selectedItems){
            var i;
            for (i = 0; i < selectedItems.length; ++i) {
                if(selectedItems[i].Delete != undefined){
                    if(selectedItems[i].Delete == true){
                        if ((countNonEmptyProperties(selectedItems[i]) > 0) && $scope.showMessage == false) {
                            if (!confirm('Are you sure you want to delete the selected rows?')){
                                $scope.showMessage = false;
                                return;
                                                                                        }
                            else{
                                $scope.showMessage = true;
                                }
                        }
                        $scope.remove($scope.instance.LCPQuestionnaire.ListOfPlants.Plant, selectedItems[i], false);
                    }
                }

            }

            $scope.showMessage = false;
            $rootScope.$broadcast('updateFilter');
        }
        $scope.edit = function (plant, modalPageId) {
            //$rootScope.$broadcast('editPlant', plant);
            $rootScope.selectedPlant = plant;
            $rootScope.modalPageCaseId = modalPageId;
/*
            var modalInstance = $modal.open({
                templateUrl: 'ListOfPlantModalContent.html',
                controller: 'ListOfPlantsModalInstanceCtrl',
                size: 'lg',
                scope: $scope,
                windowClass: 'app-modal-window',
                resolve: {
                    plant: function () {
                        return  plant;
                    }
                }
            });
            */
        };

        //orderObjectBy pagination
        //$scope.plantObjects = $scope.instance.LCPQuestionnaire.ListOfPlants.Plant;
        $scope.criteria = 'PlantName';
        $scope.direction = false;
        $scope.setCriteria = function(criteria) {
            if ($scope.criteria === criteria) {
                $scope.direction = !$scope.direction;
            } else {
                $scope.criteria = criteria;
                $scope.direction  = false;
            }
        }
    });


    // new end

    function getWebQUrl(path){
        var url = baseUri + path;
        url += "?fileId=" + fileId;
        if (sessionId && sessionId != null) {
            url += "&sessionid=" + sessionId;
        }
        return url;
    }
    // helper function for getting query string parameter values. AngularJS solution $location.search() doesn't work in IE8.
    function getParameterByName(name) {
        var searchArr = window.location.search.split('?');
        var search = '?' + searchArr[searchArr.length - 1];
        var match = new RegExp('[?&]' + name + '=([^&]*)').exec(search);
        return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
    };

    function getHandsontableColHeaders(form) {
        if (form == 'ListOfPlants'){
            return ["Plant Name", "Plant Id", "E-PRTR national ID", "Street Name ", "City", "Region", "Postal code","Country Code","Building Number", "Longitude", "Latitude", "Facility name", "Comments"]
        }
        else if (form == 'PlantDetails'){
            return ["Plant name", "Plant ID", "MWth","Type of Combustion Plant", "Date of start of operation", "Refineries",  "Other Sector", "Operating Hours", "Derogation", "Comments"]
        }
        else if (form == 'EnergyInput'){
            return ["Plant name", "Plant ID", "Biomass (TJ)","Coal","Lignite","Peat", "Other solid fuels (TJ) Category","Other solid fuels (TJ) Value" , "Liquid fuels (TJ)", "Natural gas (TJ)", "Other gases (TJ) Category","Other gases (TJ) Value", "SO2 (t)", "NOx (t)", "Dust (t)"]
        }
        else if (form == 'TotalEmissionsToAir'){
            return ["Plant name", "Plant ID", "SO2 (t)", "NOx (t)", "TSP (t)"]
        }
        else if (form == 'Desulphurisation'){
            return ["Desulphurisation Rate", "Sulphur Content", "Technical Justification", "Month"]
        }
        else if (form == 'UsefulHeat'){
            return ["Plant name", "Plant ID","UsefulHeat Proportion"]
        }
        else {
            //default is the first table
            return ["Plant Name", "Plant Id", "E-PRTR national ID", "Address 1", "Address 2", "City", "Region", "Postal code", "Longitude", "Latitude", "Facility name"]
        }
    }
	app.directive('uiHandsontable', function () {
	return {
		restrict: 'A',
		scope: {
			data: '=',
            status: '=',
            formname: '='
		},
		replace: true,
		link: function (scope, elem, attrs) {
            scope.$watch('status', function(newValue, oldValue) {
                // console.log('watch:' + newValue + '; form=' + scope.formname);
                if(newValue == true && angular.isArray(scope.data)){
                    elem.handsontable('loadData', scope.data);
                }
            });
            //console.log(scope.formname);
            var data = scope.data;
            var formname = scope.formname;
            var container = elem;

            elem.handsontable({
			    data: data,
                    contextMenu:false,// ['row_above', 'row_below', 'remove_row'],
				rowHeaders: false,
                columnSorting: false,
                stretchH: 'all',
                fixedColumnsLeft: 2,
                minSpareRows: 0, // formname === 'ListOfPlants' ? 1 : 0,
            //    minRows:0,
                minSpareCols: 0,
                //maxRows: formname === 'ListOfPlants' ? 200 : data.length,
                //maxCols: data.numberOfColumns,
                colHeaders: getHandsontableColHeaders(formname),
      /**          modifyRow: function(row){
                    var ht = container.handsontable('getInstance');
                 //   var rowsNeeded = data.length - ht.countEmptyRows();
               //     console.log('rowIndex:'+row);
               if(row!=0){
                    var data = this.getData(row);
                    console.log("rowData"+data);
               }
                  //  for (var index = 0; index < rowsNeeded; index++) {
                  //  elem.handsontable('alter', 'insert_row');
                   // }
                 },
                 **/
                columns:
                        (formname === 'ListOfPlants' ?
                            [
                                {data: "PlantName"}, {data: "PlantId"},
                                {data: "EPRTRNationalId"},
                                {data: "PlantLocation.StreetName"},
                                  {data: "PlantLocation.City"}, {data: "PlantLocation.Region"}, {data: "PlantLocation.PostalCode"},{data: "PlantLocation.CountryCode"},{data: "PlantLocation.BuildingNumber"},
                                {data: "GeographicalCoordinate.Longitude", type: 'numeric', format: '0.[00000]'},
                                 {data: "GeographicalCoordinate.Latitude", type: 'numeric', format: '0.[00000]'},
                                {data: "FacilityName"},{data: "Comments"}
                            ]
                    : formname == 'PlantDetails' ?
                            [
                                {data: "PlantName", readOnly: true}, {data: "PlantId", readOnly: true},
                                {data: "PlantDetails.MWth"},
                                {data: "PlantDetails.TypeOfCombustionPlant"},
                                {data: "PlantDetails.DateOfStartOfOperation"},                                
                                {data: "PlantDetails.Refineries", type: 'checkbox'}, {data: "PlantDetails.OtherSector", type: 'dropdown', source: [{iron_steel:"iron_steel"}, "esi", "district_heating", "chp", "other"]},
                                {data: "PlantDetails.OperatingHours", type: 'numeric'},
                                {data: "PlantDetails.Derogation"},                                
                                {data: "PlantDetails.Comments"}
                            ]
                   : formname == 'EnergyInput' ?
                            [
                                {data: "PlantName", readOnly: true}, {data: "PlantId", readOnly: true},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.Biomass", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.Coal", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.Lignite", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.Peat", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.Category"},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherSolidFuels.Value", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.LiquidFuels", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.NaturalGas", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.Category"},
                                {data: "EnergyInputAndTotalEmissionsToAir.EnergyInput.OtherGases.Value", type: 'numeric', format: '0.[00000]'},

                            ]         
                    : formname == 'TotalEmissionsToAir' ?
                            [
                                {data: "PlantName", readOnly: true}, {data: "PlantId", readOnly: true},
                                {data: "EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.SO2", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.NOx", type: 'numeric', format: '0.[00000]'},
                                {data: "EnergyInputAndTotalEmissionsToAir.TotalEmissionsToAir.TSP", type: 'numeric', format: '0.[00000]'}
                            ]
                    : formname == 'Desulphurisation' ?
                           [
                                {data: "PlantName", readOnly: true}, {data: "PlantId", readOnly: true},
                                {data: "Desulphurisation.DesulphurisationRate", type: 'numeric', format: '0.[00000]'},
                                {data: "Desulphurisation.SulphurContent", type: 'numeric', format: '0.[00000]'},
                                {data: "Desulphurisation.TechnicalJustification" }
                            ]
                    : formname == 'UsefulHeat' ?
                            [
                                {data: "PlantName", readOnly: true}, {data: "PlantId", readOnly: true},
                                {data: "UsefulHeat.UsefulHeatProportion", type: 'numeric', format: '0.[00000]'},
                            ]
                   
                    :[]),
                    onSelection: function (row, col, row2, col2) {
                        var meta = container.handsontable('getCellMeta', row2, col2);
                        if (meta.readOnly) {
                            container.handsontable('updateSettings', {fillHandle: false});
                        }
                        else {
                            container.handsontable('updateSettings', {fillHandle: true});
                        }
                    },
                cells: function (row, col, prop) {
                    var cellProperties = {};
                    if (conditionalReadonlyFields.indexOf(prop) >= 0) {
                        this.renderer = numericConditionalreadOnlyRenderer;
                    }
                    return cellProperties;
                }
        });
    }
	}
});
    var conditionalReadonlyFields = ["PlantDetails.CapacityAddedMW", "PlantDetails.CapacityAffectedMW", "PlantDetails.OtherSector", "PlantDetails.GasTurbineThermalInput",
        "PlantDetails.BoilerThermalInput", "PlantDetails.GasEngineThermalInput", "PlantDetails.DieselEngineTurbineThermalInput", "PlantDetails.DieselEngineTurbineThermalInput",
        "PlantDetails.OtherTypeOfCombustion", "PlantDetails.OtherThermalInput",
        "OptOutsAndNERP.CapacityOptedOutMW", "OptOutsAndNERP.HoursOperated",
        "LcpArt15.OperatingHours", "LcpArt15.ElvSO2",
        "LcpArt15.NotaBeneElvSO2", "LcpArt15.DesulphurisationRate", "LcpArt15.SInput",
        "LcpArt15.AnnexVI_A_Footnote2_OperatingHours", "LcpArt15.ElvNOx",
        "LcpArt15.VolatileContents", "LcpArt15.AnnexVI_A_Footnote3_ElvNOx"]
    function numericConditionalreadOnlyRenderer(instance, td, row, col, prop, value, cellProperties) {

        if (prop === "PlantDetails.OtherTypeOfCombustion") {
            Handsontable.renderers.TextRenderer.apply(this, arguments);
        }
        else if (prop === "PlantDetails.OtherSector") {
            Handsontable.renderers.AutocompleteRenderer.apply(this, arguments);
        }
        else {
            Handsontable.renderers.NumericRenderer.apply(this, arguments);
        }
        var colIndex = (
                (prop === "PlantDetails.OtherThermalInput" || prop ===  "OptOutsAndNERP.HoursOperated"
                                || prop === "LcpArt15.ElvSO2" || prop ===  "LcpArt15.DesulphurisationRate"
                                || prop === "LcpArt15.ElvNOx" || prop ===  "LcpArt15.AnnexVI_A_Footnote3_ElvNOx")
                                ? col - 2 : (prop === "LcpArt15.SInput") ? col - 3 : col - 1);
        var booleanValue = prop === "PlantDetails.OtherSector" ? false : true;
        var checkboxValue = instance.getDataAtCell(row, colIndex) === null || instance.getDataAtCell(row, colIndex) === '' ? false : instance.getDataAtCell(row, colIndex);
        if (checkboxValue != booleanValue ) {
            cellProperties.readOnly = true;
            td.style.background = '#EEE';
        }
    }
 
},{}],2:[function(require,module,exports){
/*
 * angular-elastic v2.3.3
 * (c) 2014 Monospaced http://monospaced.com
 * License: MIT
 */

angular.module('monospaced.elastic', [])

  .constant('msdElasticConfig', {
    append: ''
  })

  .directive('msdElastic', ['$timeout', '$window', 'msdElasticConfig', function($timeout, $window, config) {
    'use strict';

    return {
      require: 'ngModel',
      restrict: 'A, C',
      link: function(scope, element, attrs, ngModel) {

        // cache a reference to the DOM element
        var ta = element[0],
            $ta = element;

        // ensure the element is a textarea, and browser is capable
        if (ta.nodeName !== 'TEXTAREA' || !$window.getComputedStyle) {
          return;
        }

        // set these properties before measuring dimensions
        $ta.css({
          'overflow': 'hidden',
          'overflow-y': 'hidden',
          'word-wrap': 'break-word'
        });

        // force text reflow
        var text = ta.value;
        ta.value = '';
        ta.value = text;

        var appendText = attrs.msdElastic || config.append,
            append = appendText === '\\n' ? '\n' : appendText,
            $win = angular.element($window),
            mirrorStyle = 'position: absolute; top: -999px; right: auto; bottom: auto; left: 0 ;' +
                          'overflow: hidden; -webkit-box-sizing: content-box;' +
                          '-moz-box-sizing: content-box; box-sizing: content-box;' +
                          'min-height: 0 !important; height: 0 !important; padding: 0;' +
                          'word-wrap: break-word; border: 0;',
            $mirror = angular.element('<textarea tabindex="-1" ' +
                                      'style="' + mirrorStyle + '"/>').data('elastic', true),
            mirror = $mirror[0],
            taStyle = getComputedStyle(ta),
            resize = taStyle.getPropertyValue('resize'),
            borderBox = taStyle.getPropertyValue('box-sizing') === 'border-box' ||
                        taStyle.getPropertyValue('-moz-box-sizing') === 'border-box' ||
                        taStyle.getPropertyValue('-webkit-box-sizing') === 'border-box',
            boxOuter = !borderBox ? {width: 0, height: 0} : {
                          width:  parseInt(taStyle.getPropertyValue('border-right-width'), 10) +
                                  parseInt(taStyle.getPropertyValue('padding-right'), 10) +
                                  parseInt(taStyle.getPropertyValue('padding-left'), 10) +
                                  parseInt(taStyle.getPropertyValue('border-left-width'), 10),
                          height: parseInt(taStyle.getPropertyValue('border-top-width'), 10) +
                                  parseInt(taStyle.getPropertyValue('padding-top'), 10) +
                                  parseInt(taStyle.getPropertyValue('padding-bottom'), 10) +
                                  parseInt(taStyle.getPropertyValue('border-bottom-width'), 10)
                        },
            minHeightValue = parseInt(taStyle.getPropertyValue('min-height'), 10),
            heightValue = parseInt(taStyle.getPropertyValue('height'), 10),
            minHeight = Math.max(minHeightValue, heightValue) - boxOuter.height,
            maxHeight = parseInt(taStyle.getPropertyValue('max-height'), 10),
            mirrored,
            active,
            copyStyle = ['font-family',
                         'font-size',
                         'font-weight',
                         'font-style',
                         'letter-spacing',
                         'line-height',
                         'text-transform',
                         'word-spacing',
                         'text-indent'];

        // exit if elastic already applied (or is the mirror element)
        if ($ta.data('elastic')) {
          return;
        }

        // Opera returns max-height of -1 if not set
        maxHeight = maxHeight && maxHeight > 0 ? maxHeight : 9e4;

        // append mirror to the DOM
        if (mirror.parentNode !== document.body) {
          angular.element(document.body).append(mirror);
        }

        // set resize and apply elastic
        $ta.css({
          'resize': (resize === 'none' || resize === 'vertical') ? 'none' : 'horizontal'
        }).data('elastic', true);

        /*
         * methods
         */

        function initMirror() {
          mirrored = ta;
          // copy the essential styles from the textarea to the mirror
          taStyle = getComputedStyle(ta);
          angular.forEach(copyStyle, function(val) {
            mirrorStyle += val + ':' + taStyle.getPropertyValue(val) + ';';
          });
          mirror.setAttribute('style', mirrorStyle);
        }

        function adjust() {
          var taHeight,
              mirrorHeight,
              width,
              overflow;

          if (mirrored !== ta) {
            initMirror();
          }

          // active flag prevents actions in function from calling adjust again
          if (!active) {
            active = true;

            mirror.value = ta.value + append; // optional whitespace to improve animation
            mirror.style.overflowY = ta.style.overflowY;

            taHeight = ta.style.height === '' ? 'auto' : parseInt(ta.style.height, 10);

            // update mirror width in case the textarea width has changed
            width = parseInt(getComputedStyle(ta).getPropertyValue('width'), 10) - boxOuter.width;
            mirror.style.width = width + 'px';

            mirrorHeight = mirror.scrollHeight;

            if (mirrorHeight > maxHeight) {
              mirrorHeight = maxHeight;
              overflow = 'scroll';
            } else if (mirrorHeight < minHeight) {
              mirrorHeight = minHeight;
            }
            mirrorHeight += boxOuter.height;

            ta.style.overflowY = overflow || 'hidden';

            if (taHeight !== mirrorHeight) {
              ta.style.height = mirrorHeight + 'px';
              scope.$emit('elastic:resize', $ta);
            }

            // small delay to prevent an infinite loop
            $timeout(function() {
              active = false;
            }, 1);

          }
        }

        function forceAdjust() {
          active = false;
          adjust();
        }

        /*
         * initialise
         */

        // listen
        if ('onpropertychange' in ta && 'oninput' in ta) {
          // IE9
          ta['oninput'] = ta.onkeyup = adjust;
        } else {
          ta['oninput'] = adjust;
        }

        $win.bind('resize', forceAdjust);

        scope.$watch(function() {
          return ngModel.$modelValue;
        }, function(newValue) {
          forceAdjust();
        });

        scope.$on('elastic:adjust', function() {
          forceAdjust();
        });

        $timeout(adjust);

        /*
         * destroy
         */

        scope.$on('$destroy', function() {
          $mirror.remove();
          $win.unbind('resize', forceAdjust);
        });
      }
    };

  }]);

},{}],3:[function(require,module,exports){
/*
 AngularJS v1.2.16
 (c) 2010-2014 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(O,U,s){'use strict';function t(b){return function(){var a=arguments[0],c,a="["+(b?b+":":"")+a+"] http://errors.angularjs.org/1.2.16/"+(b?b+"/":"")+a;for(c=1;c<arguments.length;c++)a=a+(1==c?"?":"&")+"p"+(c-1)+"="+encodeURIComponent("function"==typeof arguments[c]?arguments[c].toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof arguments[c]?"undefined":"string"!=typeof arguments[c]?JSON.stringify(arguments[c]):arguments[c]);return Error(a)}}function ab(b){if(null==b||Ca(b))return!1;
var a=b.length;return 1===b.nodeType&&a?!0:w(b)||M(b)||0===a||"number"===typeof a&&0<a&&a-1 in b}function q(b,a,c){var d;if(b)if(P(b))for(d in b)"prototype"==d||("length"==d||"name"==d||b.hasOwnProperty&&!b.hasOwnProperty(d))||a.call(c,b[d],d);else if(b.forEach&&b.forEach!==q)b.forEach(a,c);else if(ab(b))for(d=0;d<b.length;d++)a.call(c,b[d],d);else for(d in b)b.hasOwnProperty(d)&&a.call(c,b[d],d);return b}function Qb(b){var a=[],c;for(c in b)b.hasOwnProperty(c)&&a.push(c);return a.sort()}function Sc(b,
a,c){for(var d=Qb(b),e=0;e<d.length;e++)a.call(c,b[d[e]],d[e]);return d}function Rb(b){return function(a,c){b(c,a)}}function bb(){for(var b=ka.length,a;b;){b--;a=ka[b].charCodeAt(0);if(57==a)return ka[b]="A",ka.join("");if(90==a)ka[b]="0";else return ka[b]=String.fromCharCode(a+1),ka.join("")}ka.unshift("0");return ka.join("")}function Sb(b,a){a?b.$$hashKey=a:delete b.$$hashKey}function D(b){var a=b.$$hashKey;q(arguments,function(a){a!==b&&q(a,function(a,c){b[c]=a})});Sb(b,a);return b}function Y(b){return parseInt(b,
10)}function Tb(b,a){return D(new (D(function(){},{prototype:b})),a)}function C(){}function Da(b){return b}function aa(b){return function(){return b}}function E(b){return"undefined"===typeof b}function B(b){return"undefined"!==typeof b}function X(b){return null!=b&&"object"===typeof b}function w(b){return"string"===typeof b}function vb(b){return"number"===typeof b}function Na(b){return"[object Date]"===wa.call(b)}function M(b){return"[object Array]"===wa.call(b)}function P(b){return"function"===typeof b}
function cb(b){return"[object RegExp]"===wa.call(b)}function Ca(b){return b&&b.document&&b.location&&b.alert&&b.setInterval}function Tc(b){return!(!b||!(b.nodeName||b.prop&&b.attr&&b.find))}function Uc(b,a,c){var d=[];q(b,function(b,g,f){d.push(a.call(c,b,g,f))});return d}function db(b,a){if(b.indexOf)return b.indexOf(a);for(var c=0;c<b.length;c++)if(a===b[c])return c;return-1}function Oa(b,a){var c=db(b,a);0<=c&&b.splice(c,1);return a}function ba(b,a){if(Ca(b)||b&&b.$evalAsync&&b.$watch)throw Pa("cpws");
if(a){if(b===a)throw Pa("cpi");if(M(b))for(var c=a.length=0;c<b.length;c++)a.push(ba(b[c]));else{c=a.$$hashKey;q(a,function(b,c){delete a[c]});for(var d in b)a[d]=ba(b[d]);Sb(a,c)}}else(a=b)&&(M(b)?a=ba(b,[]):Na(b)?a=new Date(b.getTime()):cb(b)?a=RegExp(b.source):X(b)&&(a=ba(b,{})));return a}function Ub(b,a){a=a||{};for(var c in b)!b.hasOwnProperty(c)||"$"===c.charAt(0)&&"$"===c.charAt(1)||(a[c]=b[c]);return a}function xa(b,a){if(b===a)return!0;if(null===b||null===a)return!1;if(b!==b&&a!==a)return!0;
var c=typeof b,d;if(c==typeof a&&"object"==c)if(M(b)){if(!M(a))return!1;if((c=b.length)==a.length){for(d=0;d<c;d++)if(!xa(b[d],a[d]))return!1;return!0}}else{if(Na(b))return Na(a)&&b.getTime()==a.getTime();if(cb(b)&&cb(a))return b.toString()==a.toString();if(b&&b.$evalAsync&&b.$watch||a&&a.$evalAsync&&a.$watch||Ca(b)||Ca(a)||M(a))return!1;c={};for(d in b)if("$"!==d.charAt(0)&&!P(b[d])){if(!xa(b[d],a[d]))return!1;c[d]=!0}for(d in a)if(!c.hasOwnProperty(d)&&"$"!==d.charAt(0)&&a[d]!==s&&!P(a[d]))return!1;
return!0}return!1}function Vb(){return U.securityPolicy&&U.securityPolicy.isActive||U.querySelector&&!(!U.querySelector("[ng-csp]")&&!U.querySelector("[data-ng-csp]"))}function eb(b,a){var c=2<arguments.length?ya.call(arguments,2):[];return!P(a)||a instanceof RegExp?a:c.length?function(){return arguments.length?a.apply(b,c.concat(ya.call(arguments,0))):a.apply(b,c)}:function(){return arguments.length?a.apply(b,arguments):a.call(b)}}function Vc(b,a){var c=a;"string"===typeof b&&"$"===b.charAt(0)?c=
s:Ca(a)?c="$WINDOW":a&&U===a?c="$DOCUMENT":a&&(a.$evalAsync&&a.$watch)&&(c="$SCOPE");return c}function qa(b,a){return"undefined"===typeof b?s:JSON.stringify(b,Vc,a?"  ":null)}function Wb(b){return w(b)?JSON.parse(b):b}function Qa(b){"function"===typeof b?b=!0:b&&0!==b.length?(b=K(""+b),b=!("f"==b||"0"==b||"false"==b||"no"==b||"n"==b||"[]"==b)):b=!1;return b}function ha(b){b=y(b).clone();try{b.empty()}catch(a){}var c=y("<div>").append(b).html();try{return 3===b[0].nodeType?K(c):c.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,
function(a,b){return"<"+K(b)})}catch(d){return K(c)}}function Xb(b){try{return decodeURIComponent(b)}catch(a){}}function Yb(b){var a={},c,d;q((b||"").split("&"),function(b){b&&(c=b.split("="),d=Xb(c[0]),B(d)&&(b=B(c[1])?Xb(c[1]):!0,a[d]?M(a[d])?a[d].push(b):a[d]=[a[d],b]:a[d]=b))});return a}function Zb(b){var a=[];q(b,function(b,d){M(b)?q(b,function(b){a.push(za(d,!0)+(!0===b?"":"="+za(b,!0)))}):a.push(za(d,!0)+(!0===b?"":"="+za(b,!0)))});return a.length?a.join("&"):""}function wb(b){return za(b,
!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function za(b,a){return encodeURIComponent(b).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,a?"%20":"+")}function Wc(b,a){function c(a){a&&d.push(a)}var d=[b],e,g,f=["ng:app","ng-app","x-ng-app","data-ng-app"],h=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;q(f,function(a){f[a]=!0;c(U.getElementById(a));a=a.replace(":","\\:");b.querySelectorAll&&(q(b.querySelectorAll("."+a),c),q(b.querySelectorAll("."+
a+"\\:"),c),q(b.querySelectorAll("["+a+"]"),c))});q(d,function(a){if(!e){var b=h.exec(" "+a.className+" ");b?(e=a,g=(b[2]||"").replace(/\s+/g,",")):q(a.attributes,function(b){!e&&f[b.name]&&(e=a,g=b.value)})}});e&&a(e,g?[g]:[])}function $b(b,a){var c=function(){b=y(b);if(b.injector()){var c=b[0]===U?"document":ha(b);throw Pa("btstrpd",c);}a=a||[];a.unshift(["$provide",function(a){a.value("$rootElement",b)}]);a.unshift("ng");c=ac(a);c.invoke(["$rootScope","$rootElement","$compile","$injector","$animate",
function(a,b,c,d,e){a.$apply(function(){b.data("$injector",d);c(b)(a)})}]);return c},d=/^NG_DEFER_BOOTSTRAP!/;if(O&&!d.test(O.name))return c();O.name=O.name.replace(d,"");Ea.resumeBootstrap=function(b){q(b,function(b){a.push(b)});c()}}function fb(b,a){a=a||"_";return b.replace(Xc,function(b,d){return(d?a:"")+b.toLowerCase()})}function xb(b,a,c){if(!b)throw Pa("areq",a||"?",c||"required");return b}function Ra(b,a,c){c&&M(b)&&(b=b[b.length-1]);xb(P(b),a,"not a function, got "+(b&&"object"==typeof b?
b.constructor.name||"Object":typeof b));return b}function Aa(b,a){if("hasOwnProperty"===b)throw Pa("badname",a);}function bc(b,a,c){if(!a)return b;a=a.split(".");for(var d,e=b,g=a.length,f=0;f<g;f++)d=a[f],b&&(b=(e=b)[d]);return!c&&P(b)?eb(e,b):b}function yb(b){var a=b[0];b=b[b.length-1];if(a===b)return y(a);var c=[a];do{a=a.nextSibling;if(!a)break;c.push(a)}while(a!==b);return y(c)}function Yc(b){var a=t("$injector"),c=t("ng");b=b.angular||(b.angular={});b.$$minErr=b.$$minErr||t;return b.module||
(b.module=function(){var b={};return function(e,g,f){if("hasOwnProperty"===e)throw c("badname","module");g&&b.hasOwnProperty(e)&&(b[e]=null);return b[e]||(b[e]=function(){function b(a,d,e){return function(){c[e||"push"]([a,d,arguments]);return n}}if(!g)throw a("nomod",e);var c=[],d=[],m=b("$injector","invoke"),n={_invokeQueue:c,_runBlocks:d,requires:g,name:e,provider:b("$provide","provider"),factory:b("$provide","factory"),service:b("$provide","service"),value:b("$provide","value"),constant:b("$provide",
"constant","unshift"),animation:b("$animateProvider","register"),filter:b("$filterProvider","register"),controller:b("$controllerProvider","register"),directive:b("$compileProvider","directive"),config:m,run:function(a){d.push(a);return this}};f&&m(f);return n}())}}())}function Zc(b){D(b,{bootstrap:$b,copy:ba,extend:D,equals:xa,element:y,forEach:q,injector:ac,noop:C,bind:eb,toJson:qa,fromJson:Wb,identity:Da,isUndefined:E,isDefined:B,isString:w,isFunction:P,isObject:X,isNumber:vb,isElement:Tc,isArray:M,
version:$c,isDate:Na,lowercase:K,uppercase:Fa,callbacks:{counter:0},$$minErr:t,$$csp:Vb});Sa=Yc(O);try{Sa("ngLocale")}catch(a){Sa("ngLocale",[]).provider("$locale",ad)}Sa("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:bd});a.provider("$compile",cc).directive({a:cd,input:dc,textarea:dc,form:dd,script:ed,select:fd,style:gd,option:hd,ngBind:id,ngBindHtml:jd,ngBindTemplate:kd,ngClass:ld,ngClassEven:md,ngClassOdd:nd,ngCloak:od,ngController:pd,ngForm:qd,ngHide:rd,ngIf:sd,ngInclude:td,
ngInit:ud,ngNonBindable:vd,ngPluralize:wd,ngRepeat:xd,ngShow:yd,ngStyle:zd,ngSwitch:Ad,ngSwitchWhen:Bd,ngSwitchDefault:Cd,ngOptions:Dd,ngTransclude:Ed,ngModel:Fd,ngList:Gd,ngChange:Hd,required:ec,ngRequired:ec,ngValue:Id}).directive({ngInclude:Jd}).directive(zb).directive(fc);a.provider({$anchorScroll:Kd,$animate:Ld,$browser:Md,$cacheFactory:Nd,$controller:Od,$document:Pd,$exceptionHandler:Qd,$filter:gc,$interpolate:Rd,$interval:Sd,$http:Td,$httpBackend:Ud,$location:Vd,$log:Wd,$parse:Xd,$rootScope:Yd,
$q:Zd,$sce:$d,$sceDelegate:ae,$sniffer:be,$templateCache:ce,$timeout:de,$window:ee,$$rAF:fe,$$asyncCallback:ge})}])}function Ta(b){return b.replace(he,function(a,b,d,e){return e?d.toUpperCase():d}).replace(ie,"Moz$1")}function Ab(b,a,c,d){function e(b){var e=c&&b?[this.filter(b)]:[this],l=a,k,m,n,p,r,z;if(!d||null!=b)for(;e.length;)for(k=e.shift(),m=0,n=k.length;m<n;m++)for(p=y(k[m]),l?p.triggerHandler("$destroy"):l=!l,r=0,p=(z=p.children()).length;r<p;r++)e.push(Ga(z[r]));return g.apply(this,arguments)}
var g=Ga.fn[b],g=g.$original||g;e.$original=g;Ga.fn[b]=e}function N(b){if(b instanceof N)return b;w(b)&&(b=ca(b));if(!(this instanceof N)){if(w(b)&&"<"!=b.charAt(0))throw Bb("nosel");return new N(b)}if(w(b)){var a=b;b=U;var c;if(c=je.exec(a))b=[b.createElement(c[1])];else{var d=b,e;b=d.createDocumentFragment();c=[];if(Cb.test(a)){d=b.appendChild(d.createElement("div"));e=(ke.exec(a)||["",""])[1].toLowerCase();e=ea[e]||ea._default;d.innerHTML="<div>&#160;</div>"+e[1]+a.replace(le,"<$1></$2>")+e[2];
d.removeChild(d.firstChild);for(a=e[0];a--;)d=d.lastChild;a=0;for(e=d.childNodes.length;a<e;++a)c.push(d.childNodes[a]);d=b.firstChild;d.textContent=""}else c.push(d.createTextNode(a));b.textContent="";b.innerHTML="";b=c}Db(this,b);y(U.createDocumentFragment()).append(this)}else Db(this,b)}function Eb(b){return b.cloneNode(!0)}function Ha(b){hc(b);var a=0;for(b=b.childNodes||[];a<b.length;a++)Ha(b[a])}function ic(b,a,c,d){if(B(d))throw Bb("offargs");var e=la(b,"events");la(b,"handle")&&(E(a)?q(e,
function(a,c){Fb(b,c,a);delete e[c]}):q(a.split(" "),function(a){E(c)?(Fb(b,a,e[a]),delete e[a]):Oa(e[a]||[],c)}))}function hc(b,a){var c=b[gb],d=Ua[c];d&&(a?delete Ua[c].data[a]:(d.handle&&(d.events.$destroy&&d.handle({},"$destroy"),ic(b)),delete Ua[c],b[gb]=s))}function la(b,a,c){var d=b[gb],d=Ua[d||-1];if(B(c))d||(b[gb]=d=++me,d=Ua[d]={}),d[a]=c;else return d&&d[a]}function jc(b,a,c){var d=la(b,"data"),e=B(c),g=!e&&B(a),f=g&&!X(a);d||f||la(b,"data",d={});if(e)d[a]=c;else if(g){if(f)return d&&d[a];
D(d,a)}else return d}function Gb(b,a){return b.getAttribute?-1<(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+a+" "):!1}function hb(b,a){a&&b.setAttribute&&q(a.split(" "),function(a){b.setAttribute("class",ca((" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+ca(a)+" "," ")))})}function ib(b,a){if(a&&b.setAttribute){var c=(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");q(a.split(" "),function(a){a=ca(a);-1===c.indexOf(" "+a+" ")&&
(c+=a+" ")});b.setAttribute("class",ca(c))}}function Db(b,a){if(a){a=a.nodeName||!B(a.length)||Ca(a)?[a]:a;for(var c=0;c<a.length;c++)b.push(a[c])}}function kc(b,a){return jb(b,"$"+(a||"ngController")+"Controller")}function jb(b,a,c){b=y(b);9==b[0].nodeType&&(b=b.find("html"));for(a=M(a)?a:[a];b.length;){for(var d=b[0],e=0,g=a.length;e<g;e++)if((c=b.data(a[e]))!==s)return c;b=y(d.parentNode||11===d.nodeType&&d.host)}}function lc(b){for(var a=0,c=b.childNodes;a<c.length;a++)Ha(c[a]);for(;b.firstChild;)b.removeChild(b.firstChild)}
function mc(b,a){var c=kb[a.toLowerCase()];return c&&nc[b.nodeName]&&c}function ne(b,a){var c=function(c,e){c.preventDefault||(c.preventDefault=function(){c.returnValue=!1});c.stopPropagation||(c.stopPropagation=function(){c.cancelBubble=!0});c.target||(c.target=c.srcElement||U);if(E(c.defaultPrevented)){var g=c.preventDefault;c.preventDefault=function(){c.defaultPrevented=!0;g.call(c)};c.defaultPrevented=!1}c.isDefaultPrevented=function(){return c.defaultPrevented||!1===c.returnValue};var f=Ub(a[e||
c.type]||[]);q(f,function(a){a.call(b,c)});8>=S?(c.preventDefault=null,c.stopPropagation=null,c.isDefaultPrevented=null):(delete c.preventDefault,delete c.stopPropagation,delete c.isDefaultPrevented)};c.elem=b;return c}function Ia(b){var a=typeof b,c;"object"==a&&null!==b?"function"==typeof(c=b.$$hashKey)?c=b.$$hashKey():c===s&&(c=b.$$hashKey=bb()):c=b;return a+":"+c}function Va(b){q(b,this.put,this)}function oc(b){var a,c;"function"==typeof b?(a=b.$inject)||(a=[],b.length&&(c=b.toString().replace(oe,
""),c=c.match(pe),q(c[1].split(qe),function(b){b.replace(re,function(b,c,d){a.push(d)})})),b.$inject=a):M(b)?(c=b.length-1,Ra(b[c],"fn"),a=b.slice(0,c)):Ra(b,"fn",!0);return a}function ac(b){function a(a){return function(b,c){if(X(b))q(b,Rb(a));else return a(b,c)}}function c(a,b){Aa(a,"service");if(P(b)||M(b))b=n.instantiate(b);if(!b.$get)throw Wa("pget",a);return m[a+h]=b}function d(a,b){return c(a,{$get:b})}function e(a){var b=[],c,d,g,h;q(a,function(a){if(!k.get(a)){k.put(a,!0);try{if(w(a))for(c=
Sa(a),b=b.concat(e(c.requires)).concat(c._runBlocks),d=c._invokeQueue,g=0,h=d.length;g<h;g++){var f=d[g],l=n.get(f[0]);l[f[1]].apply(l,f[2])}else P(a)?b.push(n.invoke(a)):M(a)?b.push(n.invoke(a)):Ra(a,"module")}catch(m){throw M(a)&&(a=a[a.length-1]),m.message&&(m.stack&&-1==m.stack.indexOf(m.message))&&(m=m.message+"\n"+m.stack),Wa("modulerr",a,m.stack||m.message||m);}}});return b}function g(a,b){function c(d){if(a.hasOwnProperty(d)){if(a[d]===f)throw Wa("cdep",l.join(" <- "));return a[d]}try{return l.unshift(d),
a[d]=f,a[d]=b(d)}catch(e){throw a[d]===f&&delete a[d],e;}finally{l.shift()}}function d(a,b,e){var g=[],h=oc(a),f,l,k;l=0;for(f=h.length;l<f;l++){k=h[l];if("string"!==typeof k)throw Wa("itkn",k);g.push(e&&e.hasOwnProperty(k)?e[k]:c(k))}a.$inject||(a=a[f]);return a.apply(b,g)}return{invoke:d,instantiate:function(a,b){var c=function(){},e;c.prototype=(M(a)?a[a.length-1]:a).prototype;c=new c;e=d(a,c,b);return X(e)||P(e)?e:c},get:c,annotate:oc,has:function(b){return m.hasOwnProperty(b+h)||a.hasOwnProperty(b)}}}
var f={},h="Provider",l=[],k=new Va,m={$provide:{provider:a(c),factory:a(d),service:a(function(a,b){return d(a,["$injector",function(a){return a.instantiate(b)}])}),value:a(function(a,b){return d(a,aa(b))}),constant:a(function(a,b){Aa(a,"constant");m[a]=b;p[a]=b}),decorator:function(a,b){var c=n.get(a+h),d=c.$get;c.$get=function(){var a=r.invoke(d,c);return r.invoke(b,null,{$delegate:a})}}}},n=m.$injector=g(m,function(){throw Wa("unpr",l.join(" <- "));}),p={},r=p.$injector=g(p,function(a){a=n.get(a+
h);return r.invoke(a.$get,a)});q(e(b),function(a){r.invoke(a||C)});return r}function Kd(){var b=!0;this.disableAutoScrolling=function(){b=!1};this.$get=["$window","$location","$rootScope",function(a,c,d){function e(a){var b=null;q(a,function(a){b||"a"!==K(a.nodeName)||(b=a)});return b}function g(){var b=c.hash(),d;b?(d=f.getElementById(b))?d.scrollIntoView():(d=e(f.getElementsByName(b)))?d.scrollIntoView():"top"===b&&a.scrollTo(0,0):a.scrollTo(0,0)}var f=a.document;b&&d.$watch(function(){return c.hash()},
function(){d.$evalAsync(g)});return g}]}function ge(){this.$get=["$$rAF","$timeout",function(b,a){return b.supported?function(a){return b(a)}:function(b){return a(b,0,!1)}}]}function se(b,a,c,d){function e(a){try{a.apply(null,ya.call(arguments,1))}finally{if(z--,0===z)for(;u.length;)try{u.pop()()}catch(b){c.error(b)}}}function g(a,b){(function T(){q(F,function(a){a()});v=b(T,a)})()}function f(){x=null;J!=h.url()&&(J=h.url(),q(ma,function(a){a(h.url())}))}var h=this,l=a[0],k=b.location,m=b.history,
n=b.setTimeout,p=b.clearTimeout,r={};h.isMock=!1;var z=0,u=[];h.$$completeOutstandingRequest=e;h.$$incOutstandingRequestCount=function(){z++};h.notifyWhenNoOutstandingRequests=function(a){q(F,function(a){a()});0===z?a():u.push(a)};var F=[],v;h.addPollFn=function(a){E(v)&&g(100,n);F.push(a);return a};var J=k.href,A=a.find("base"),x=null;h.url=function(a,c){k!==b.location&&(k=b.location);m!==b.history&&(m=b.history);if(a){if(J!=a)return J=a,d.history?c?m.replaceState(null,"",a):(m.pushState(null,"",
a),A.attr("href",A.attr("href"))):(x=a,c?k.replace(a):k.href=a),h}else return x||k.href.replace(/%27/g,"'")};var ma=[],L=!1;h.onUrlChange=function(a){if(!L){if(d.history)y(b).on("popstate",f);if(d.hashchange)y(b).on("hashchange",f);else h.addPollFn(f);L=!0}ma.push(a);return a};h.baseHref=function(){var a=A.attr("href");return a?a.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var Q={},da="",H=h.baseHref();h.cookies=function(a,b){var d,e,g,h;if(a)b===s?l.cookie=escape(a)+"=;path="+H+";expires=Thu, 01 Jan 1970 00:00:00 GMT":
w(b)&&(d=(l.cookie=escape(a)+"="+escape(b)+";path="+H).length+1,4096<d&&c.warn("Cookie '"+a+"' possibly not set or overflowed because it was too large ("+d+" > 4096 bytes)!"));else{if(l.cookie!==da)for(da=l.cookie,d=da.split("; "),Q={},g=0;g<d.length;g++)e=d[g],h=e.indexOf("="),0<h&&(a=unescape(e.substring(0,h)),Q[a]===s&&(Q[a]=unescape(e.substring(h+1))));return Q}};h.defer=function(a,b){var c;z++;c=n(function(){delete r[c];e(a)},b||0);r[c]=!0;return c};h.defer.cancel=function(a){return r[a]?(delete r[a],
p(a),e(C),!0):!1}}function Md(){this.$get=["$window","$log","$sniffer","$document",function(b,a,c,d){return new se(b,d,a,c)}]}function Nd(){this.$get=function(){function b(b,d){function e(a){a!=n&&(p?p==a&&(p=a.n):p=a,g(a.n,a.p),g(a,n),n=a,n.n=null)}function g(a,b){a!=b&&(a&&(a.p=b),b&&(b.n=a))}if(b in a)throw t("$cacheFactory")("iid",b);var f=0,h=D({},d,{id:b}),l={},k=d&&d.capacity||Number.MAX_VALUE,m={},n=null,p=null;return a[b]={put:function(a,b){if(k<Number.MAX_VALUE){var c=m[a]||(m[a]={key:a});
e(c)}if(!E(b))return a in l||f++,l[a]=b,f>k&&this.remove(p.key),b},get:function(a){if(k<Number.MAX_VALUE){var b=m[a];if(!b)return;e(b)}return l[a]},remove:function(a){if(k<Number.MAX_VALUE){var b=m[a];if(!b)return;b==n&&(n=b.p);b==p&&(p=b.n);g(b.n,b.p);delete m[a]}delete l[a];f--},removeAll:function(){l={};f=0;m={};n=p=null},destroy:function(){m=h=l=null;delete a[b]},info:function(){return D({},h,{size:f})}}}var a={};b.info=function(){var b={};q(a,function(a,e){b[e]=a.info()});return b};b.get=function(b){return a[b]};
return b}}function ce(){this.$get=["$cacheFactory",function(b){return b("templates")}]}function cc(b,a){var c={},d="Directive",e=/^\s*directive\:\s*([\d\w\-_]+)\s+(.*)$/,g=/(([\d\w\-_]+)(?:\:([^;]+))?;?)/,f=/^(on[a-z]+|formaction)$/;this.directive=function l(a,e){Aa(a,"directive");w(a)?(xb(e,"directiveFactory"),c.hasOwnProperty(a)||(c[a]=[],b.factory(a+d,["$injector","$exceptionHandler",function(b,d){var e=[];q(c[a],function(c,g){try{var f=b.invoke(c);P(f)?f={compile:aa(f)}:!f.compile&&f.link&&(f.compile=
aa(f.link));f.priority=f.priority||0;f.index=g;f.name=f.name||a;f.require=f.require||f.controller&&f.name;f.restrict=f.restrict||"A";e.push(f)}catch(l){d(l)}});return e}])),c[a].push(e)):q(a,Rb(l));return this};this.aHrefSanitizationWhitelist=function(b){return B(b)?(a.aHrefSanitizationWhitelist(b),this):a.aHrefSanitizationWhitelist()};this.imgSrcSanitizationWhitelist=function(b){return B(b)?(a.imgSrcSanitizationWhitelist(b),this):a.imgSrcSanitizationWhitelist()};this.$get=["$injector","$interpolate",
"$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(a,b,m,n,p,r,z,u,F,v,J,A){function x(a,b,c,d,e){a instanceof y||(a=y(a));q(a,function(b,c){3==b.nodeType&&b.nodeValue.match(/\S+/)&&(a[c]=y(b).wrap("<span></span>").parent()[0])});var g=L(a,b,a,c,d,e);ma(a,"ng-scope");return function(b,c,d){xb(b,"scope");var e=c?Ja.clone.call(a):a;q(d,function(a,b){e.data("$"+b+"Controller",a)});d=0;for(var f=e.length;d<f;d++){var l=
e[d].nodeType;1!==l&&9!==l||e.eq(d).data("$scope",b)}c&&c(e,b);g&&g(b,e,e);return e}}function ma(a,b){try{a.addClass(b)}catch(c){}}function L(a,b,c,d,e,g){function f(a,c,d,e){var g,k,m,r,n,p,z;g=c.length;var I=Array(g);for(n=0;n<g;n++)I[n]=c[n];z=n=0;for(p=l.length;n<p;z++)k=I[z],c=l[n++],g=l[n++],m=y(k),c?(c.scope?(r=a.$new(),m.data("$scope",r)):r=a,(m=c.transclude)||!e&&b?c(g,r,k,d,Q(a,m||b)):c(g,r,k,d,e)):g&&g(a,k.childNodes,s,e)}for(var l=[],k,m,r,n,p=0;p<a.length;p++)k=new Hb,m=da(a[p],[],k,
0===p?d:s,e),(g=m.length?ia(m,a[p],k,b,c,null,[],[],g):null)&&g.scope&&ma(y(a[p]),"ng-scope"),k=g&&g.terminal||!(r=a[p].childNodes)||!r.length?null:L(r,g?g.transclude:b),l.push(g,k),n=n||g||k,g=null;return n?f:null}function Q(a,b){return function(c,d,e){var g=!1;c||(c=a.$new(),g=c.$$transcluded=!0);d=b(c,d,e);if(g)d.on("$destroy",eb(c,c.$destroy));return d}}function da(a,b,c,d,f){var k=c.$attr,l;switch(a.nodeType){case 1:T(b,na(Ka(a).toLowerCase()),"E",d,f);var m,r,n;l=a.attributes;for(var p=0,z=
l&&l.length;p<z;p++){var u=!1,F=!1;m=l[p];if(!S||8<=S||m.specified){r=m.name;n=na(r);W.test(n)&&(r=fb(n.substr(6),"-"));var J=n.replace(/(Start|End)$/,"");n===J+"Start"&&(u=r,F=r.substr(0,r.length-5)+"end",r=r.substr(0,r.length-6));n=na(r.toLowerCase());k[n]=r;c[n]=m=ca(m.value);mc(a,n)&&(c[n]=!0);N(a,b,m,n);T(b,n,"A",d,f,u,F)}}a=a.className;if(w(a)&&""!==a)for(;l=g.exec(a);)n=na(l[2]),T(b,n,"C",d,f)&&(c[n]=ca(l[3])),a=a.substr(l.index+l[0].length);break;case 3:t(b,a.nodeValue);break;case 8:try{if(l=
e.exec(a.nodeValue))n=na(l[1]),T(b,n,"M",d,f)&&(c[n]=ca(l[2]))}catch(x){}}b.sort(E);return b}function H(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b)){do{if(!a)throw ja("uterdir",b,c);1==a.nodeType&&(a.hasAttribute(b)&&e++,a.hasAttribute(c)&&e--);d.push(a);a=a.nextSibling}while(0<e)}else d.push(a);return y(d)}function R(a,b,c){return function(d,e,g,f,l){e=H(e[0],b,c);return a(d,e,g,f,l)}}function ia(a,c,d,e,g,f,l,n,p){function u(a,b,c,d){if(a){c&&(a=R(a,c,d));a.require=G.require;if(Q===
G||G.$$isolateScope)a=qc(a,{isolateScope:!0});l.push(a)}if(b){c&&(b=R(b,c,d));b.require=G.require;if(Q===G||G.$$isolateScope)b=qc(b,{isolateScope:!0});n.push(b)}}function F(a,b,c){var d,e="data",g=!1;if(w(a)){for(;"^"==(d=a.charAt(0))||"?"==d;)a=a.substr(1),"^"==d&&(e="inheritedData"),g=g||"?"==d;d=null;c&&"data"===e&&(d=c[a]);d=d||b[e]("$"+a+"Controller");if(!d&&!g)throw ja("ctreq",a,t);}else M(a)&&(d=[],q(a,function(a){d.push(F(a,b,c))}));return d}function J(a,e,g,f,p){function u(a,b){var c;2>arguments.length&&
(b=a,a=s);D&&(c=lb);return p(a,b,c)}var I,x,v,A,R,H,lb={},da;I=c===g?d:Ub(d,new Hb(y(g),d.$attr));x=I.$$element;if(Q){var T=/^\s*([@=&])(\??)\s*(\w*)\s*$/;f=y(g);H=e.$new(!0);ia&&ia===Q.$$originalDirective?f.data("$isolateScope",H):f.data("$isolateScopeNoTemplate",H);ma(f,"ng-isolate-scope");q(Q.scope,function(a,c){var d=a.match(T)||[],g=d[3]||c,f="?"==d[2],d=d[1],l,m,n,p;H.$$isolateBindings[c]=d+g;switch(d){case "@":I.$observe(g,function(a){H[c]=a});I.$$observers[g].$$scope=e;I[g]&&(H[c]=b(I[g])(e));
break;case "=":if(f&&!I[g])break;m=r(I[g]);p=m.literal?xa:function(a,b){return a===b};n=m.assign||function(){l=H[c]=m(e);throw ja("nonassign",I[g],Q.name);};l=H[c]=m(e);H.$watch(function(){var a=m(e);p(a,H[c])||(p(a,l)?n(e,a=H[c]):H[c]=a);return l=a},null,m.literal);break;case "&":m=r(I[g]);H[c]=function(a){return m(e,a)};break;default:throw ja("iscp",Q.name,c,a);}})}da=p&&u;L&&q(L,function(a){var b={$scope:a===Q||a.$$isolateScope?H:e,$element:x,$attrs:I,$transclude:da},c;R=a.controller;"@"==R&&(R=
I[a.name]);c=z(R,b);lb[a.name]=c;D||x.data("$"+a.name+"Controller",c);a.controllerAs&&(b.$scope[a.controllerAs]=c)});f=0;for(v=l.length;f<v;f++)try{A=l[f],A(A.isolateScope?H:e,x,I,A.require&&F(A.require,x,lb),da)}catch(G){m(G,ha(x))}f=e;Q&&(Q.template||null===Q.templateUrl)&&(f=H);a&&a(f,g.childNodes,s,p);for(f=n.length-1;0<=f;f--)try{A=n[f],A(A.isolateScope?H:e,x,I,A.require&&F(A.require,x,lb),da)}catch(B){m(B,ha(x))}}p=p||{};for(var v=-Number.MAX_VALUE,A,L=p.controllerDirectives,Q=p.newIsolateScopeDirective,
ia=p.templateDirective,T=p.nonTlbTranscludeDirective,E=!1,D=p.hasElementTranscludeDirective,Z=d.$$element=y(c),G,t,V,Xa=e,O,N=0,S=a.length;N<S;N++){G=a[N];var ra=G.$$start,W=G.$$end;ra&&(Z=H(c,ra,W));V=s;if(v>G.priority)break;if(V=G.scope)A=A||G,G.templateUrl||(K("new/isolated scope",Q,G,Z),X(V)&&(Q=G));t=G.name;!G.templateUrl&&G.controller&&(V=G.controller,L=L||{},K("'"+t+"' controller",L[t],G,Z),L[t]=G);if(V=G.transclude)E=!0,G.$$tlb||(K("transclusion",T,G,Z),T=G),"element"==V?(D=!0,v=G.priority,
V=H(c,ra,W),Z=d.$$element=y(U.createComment(" "+t+": "+d[t]+" ")),c=Z[0],mb(g,y(ya.call(V,0)),c),Xa=x(V,e,v,f&&f.name,{nonTlbTranscludeDirective:T})):(V=y(Eb(c)).contents(),Z.empty(),Xa=x(V,e));if(G.template)if(K("template",ia,G,Z),ia=G,V=P(G.template)?G.template(Z,d):G.template,V=Y(V),G.replace){f=G;V=Cb.test(V)?y(V):[];c=V[0];if(1!=V.length||1!==c.nodeType)throw ja("tplrt",t,"");mb(g,Z,c);S={$attr:{}};V=da(c,[],S);var $=a.splice(N+1,a.length-(N+1));Q&&pc(V);a=a.concat(V).concat($);B(d,S);S=a.length}else Z.html(V);
if(G.templateUrl)K("template",ia,G,Z),ia=G,G.replace&&(f=G),J=C(a.splice(N,a.length-N),Z,d,g,Xa,l,n,{controllerDirectives:L,newIsolateScopeDirective:Q,templateDirective:ia,nonTlbTranscludeDirective:T}),S=a.length;else if(G.compile)try{O=G.compile(Z,d,Xa),P(O)?u(null,O,ra,W):O&&u(O.pre,O.post,ra,W)}catch(aa){m(aa,ha(Z))}G.terminal&&(J.terminal=!0,v=Math.max(v,G.priority))}J.scope=A&&!0===A.scope;J.transclude=E&&Xa;p.hasElementTranscludeDirective=D;return J}function pc(a){for(var b=0,c=a.length;b<c;b++)a[b]=
Tb(a[b],{$$isolateScope:!0})}function T(b,e,g,f,k,n,r){if(e===k)return null;k=null;if(c.hasOwnProperty(e)){var p;e=a.get(e+d);for(var z=0,u=e.length;z<u;z++)try{p=e[z],(f===s||f>p.priority)&&-1!=p.restrict.indexOf(g)&&(n&&(p=Tb(p,{$$start:n,$$end:r})),b.push(p),k=p)}catch(F){m(F)}}return k}function B(a,b){var c=b.$attr,d=a.$attr,e=a.$$element;q(a,function(d,e){"$"!=e.charAt(0)&&(b[e]&&(d+=("style"===e?";":" ")+b[e]),a.$set(e,d,!0,c[e]))});q(b,function(b,g){"class"==g?(ma(e,b),a["class"]=(a["class"]?
a["class"]+" ":"")+b):"style"==g?(e.attr("style",e.attr("style")+";"+b),a.style=(a.style?a.style+";":"")+b):"$"==g.charAt(0)||a.hasOwnProperty(g)||(a[g]=b,d[g]=c[g])})}function C(a,b,c,d,e,g,f,l){var k=[],m,r,z=b[0],u=a.shift(),F=D({},u,{templateUrl:null,transclude:null,replace:null,$$originalDirective:u}),x=P(u.templateUrl)?u.templateUrl(b,c):u.templateUrl;b.empty();n.get(v.getTrustedResourceUrl(x),{cache:p}).success(function(n){var p,J;n=Y(n);if(u.replace){n=Cb.test(n)?y(n):[];p=n[0];if(1!=n.length||
1!==p.nodeType)throw ja("tplrt",u.name,x);n={$attr:{}};mb(d,b,p);var v=da(p,[],n);X(u.scope)&&pc(v);a=v.concat(a);B(c,n)}else p=z,b.html(n);a.unshift(F);m=ia(a,p,c,e,b,u,g,f,l);q(d,function(a,c){a==p&&(d[c]=b[0])});for(r=L(b[0].childNodes,e);k.length;){n=k.shift();J=k.shift();var A=k.shift(),R=k.shift(),v=b[0];if(J!==z){var H=J.className;l.hasElementTranscludeDirective&&u.replace||(v=Eb(p));mb(A,y(J),v);ma(y(v),H)}J=m.transclude?Q(n,m.transclude):R;m(r,n,v,d,J)}k=null}).error(function(a,b,c,d){throw ja("tpload",
d.url);});return function(a,b,c,d,e){k?(k.push(b),k.push(c),k.push(d),k.push(e)):m(r,b,c,d,e)}}function E(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function K(a,b,c,d){if(b)throw ja("multidir",b.name,c.name,a,ha(d));}function t(a,c){var d=b(c,!0);d&&a.push({priority:0,compile:aa(function(a,b){var c=b.parent(),e=c.data("$binding")||[];e.push(d);ma(c.data("$binding",e),"ng-binding");a.$watch(d,function(a){b[0].nodeValue=a})})})}function O(a,b){if("srcdoc"==
b)return v.HTML;var c=Ka(a);if("xlinkHref"==b||"FORM"==c&&"action"==b||"IMG"!=c&&("src"==b||"ngSrc"==b))return v.RESOURCE_URL}function N(a,c,d,e){var g=b(d,!0);if(g){if("multiple"===e&&"SELECT"===Ka(a))throw ja("selmulti",ha(a));c.push({priority:100,compile:function(){return{pre:function(c,d,l){d=l.$$observers||(l.$$observers={});if(f.test(e))throw ja("nodomevents");if(g=b(l[e],!0,O(a,e)))l[e]=g(c),(d[e]||(d[e]=[])).$$inter=!0,(l.$$observers&&l.$$observers[e].$$scope||c).$watch(g,function(a,b){"class"===
e&&a!=b?l.$updateClass(a,b):l.$set(e,a)})}}}})}}function mb(a,b,c){var d=b[0],e=b.length,g=d.parentNode,f,l;if(a)for(f=0,l=a.length;f<l;f++)if(a[f]==d){a[f++]=c;l=f+e-1;for(var k=a.length;f<k;f++,l++)l<k?a[f]=a[l]:delete a[f];a.length-=e-1;break}g&&g.replaceChild(c,d);a=U.createDocumentFragment();a.appendChild(d);c[y.expando]=d[y.expando];d=1;for(e=b.length;d<e;d++)g=b[d],y(g).remove(),a.appendChild(g),delete b[d];b[0]=c;b.length=1}function qc(a,b){return D(function(){return a.apply(null,arguments)},
a,b)}var Hb=function(a,b){this.$$element=a;this.$attr=b||{}};Hb.prototype={$normalize:na,$addClass:function(a){a&&0<a.length&&J.addClass(this.$$element,a)},$removeClass:function(a){a&&0<a.length&&J.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=rc(a,b),d=rc(b,a);0===c.length?J.removeClass(this.$$element,d):0===d.length?J.addClass(this.$$element,c):J.setClass(this.$$element,c,d)},$set:function(a,b,c,d){var e=mc(this.$$element[0],a);e&&(this.$$element.prop(a,b),d=e);this[a]=b;d?this.$attr[a]=
d:(d=this.$attr[a])||(this.$attr[a]=d=fb(a,"-"));e=Ka(this.$$element);if("A"===e&&"href"===a||"IMG"===e&&"src"===a)this[a]=b=A(b,"src"===a);!1!==c&&(null===b||b===s?this.$$element.removeAttr(d):this.$$element.attr(d,b));(c=this.$$observers)&&q(c[a],function(a){try{a(b)}catch(c){m(c)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers={}),e=d[a]||(d[a]=[]);e.push(b);u.$evalAsync(function(){e.$$inter||b(c[a])});return b}};var Z=b.startSymbol(),ra=b.endSymbol(),Y="{{"==Z||"}}"==ra?
Da:function(a){return a.replace(/\{\{/g,Z).replace(/}}/g,ra)},W=/^ngAttr[A-Z]/;return x}]}function na(b){return Ta(b.replace(te,""))}function rc(b,a){var c="",d=b.split(/\s+/),e=a.split(/\s+/),g=0;a:for(;g<d.length;g++){for(var f=d[g],h=0;h<e.length;h++)if(f==e[h])continue a;c+=(0<c.length?" ":"")+f}return c}function Od(){var b={},a=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(a,d){Aa(a,"controller");X(a)?D(b,a):b[a]=d};this.$get=["$injector","$window",function(c,d){return function(e,g){var f,
h,l;w(e)&&(f=e.match(a),h=f[1],l=f[3],e=b.hasOwnProperty(h)?b[h]:bc(g.$scope,h,!0)||bc(d,h,!0),Ra(e,h,!0));f=c.instantiate(e,g);if(l){if(!g||"object"!=typeof g.$scope)throw t("$controller")("noscp",h||e.name,l);g.$scope[l]=f}return f}}]}function Pd(){this.$get=["$window",function(b){return y(b.document)}]}function Qd(){this.$get=["$log",function(b){return function(a,c){b.error.apply(b,arguments)}}]}function sc(b){var a={},c,d,e;if(!b)return a;q(b.split("\n"),function(b){e=b.indexOf(":");c=K(ca(b.substr(0,
e)));d=ca(b.substr(e+1));c&&(a[c]=a[c]?a[c]+(", "+d):d)});return a}function tc(b){var a=X(b)?b:s;return function(c){a||(a=sc(b));return c?a[K(c)]||null:a}}function uc(b,a,c){if(P(c))return c(b,a);q(c,function(c){b=c(b,a)});return b}function Td(){var b=/^\s*(\[|\{[^\{])/,a=/[\}\]]\s*$/,c=/^\)\]\}',?\n/,d={"Content-Type":"application/json;charset=utf-8"},e=this.defaults={transformResponse:[function(d){w(d)&&(d=d.replace(c,""),b.test(d)&&a.test(d)&&(d=Wb(d)));return d}],transformRequest:[function(a){return X(a)&&
"[object File]"!==wa.call(a)&&"[object Blob]"!==wa.call(a)?qa(a):a}],headers:{common:{Accept:"application/json, text/plain, */*"},post:ba(d),put:ba(d),patch:ba(d)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},g=this.interceptors=[],f=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function(a,b,c,d,n,p){function r(a){function c(a){var b=D({},a,{data:uc(a.data,a.headers,d.transformResponse)});return 200<=a.status&&300>a.status?
b:n.reject(b)}var d={method:"get",transformRequest:e.transformRequest,transformResponse:e.transformResponse},g=function(a){function b(a){var c;q(a,function(b,d){P(b)&&(c=b(),null!=c?a[d]=c:delete a[d])})}var c=e.headers,d=D({},a.headers),g,f,c=D({},c.common,c[K(a.method)]);b(c);b(d);a:for(g in c){a=K(g);for(f in d)if(K(f)===a)continue a;d[g]=c[g]}return d}(a);D(d,a);d.headers=g;d.method=Fa(d.method);(a=Ib(d.url)?b.cookies()[d.xsrfCookieName||e.xsrfCookieName]:s)&&(g[d.xsrfHeaderName||e.xsrfHeaderName]=
a);var f=[function(a){g=a.headers;var b=uc(a.data,tc(g),a.transformRequest);E(a.data)&&q(g,function(a,b){"content-type"===K(b)&&delete g[b]});E(a.withCredentials)&&!E(e.withCredentials)&&(a.withCredentials=e.withCredentials);return z(a,b,g).then(c,c)},s],h=n.when(d);for(q(v,function(a){(a.request||a.requestError)&&f.unshift(a.request,a.requestError);(a.response||a.responseError)&&f.push(a.response,a.responseError)});f.length;){a=f.shift();var k=f.shift(),h=h.then(a,k)}h.success=function(a){h.then(function(b){a(b.data,
b.status,b.headers,d)});return h};h.error=function(a){h.then(null,function(b){a(b.data,b.status,b.headers,d)});return h};return h}function z(b,c,g){function f(a,b,c,e){v&&(200<=a&&300>a?v.put(s,[a,b,sc(c),e]):v.remove(s));l(b,a,c,e);d.$$phase||d.$apply()}function l(a,c,d,e){c=Math.max(c,0);(200<=c&&300>c?p.resolve:p.reject)({data:a,status:c,headers:tc(d),config:b,statusText:e})}function k(){var a=db(r.pendingRequests,b);-1!==a&&r.pendingRequests.splice(a,1)}var p=n.defer(),z=p.promise,v,q,s=u(b.url,
b.params);r.pendingRequests.push(b);z.then(k,k);(b.cache||e.cache)&&(!1!==b.cache&&"GET"==b.method)&&(v=X(b.cache)?b.cache:X(e.cache)?e.cache:F);if(v)if(q=v.get(s),B(q)){if(q.then)return q.then(k,k),q;M(q)?l(q[1],q[0],ba(q[2]),q[3]):l(q,200,{},"OK")}else v.put(s,z);E(q)&&a(b.method,s,c,f,g,b.timeout,b.withCredentials,b.responseType);return z}function u(a,b){if(!b)return a;var c=[];Sc(b,function(a,b){null===a||E(a)||(M(a)||(a=[a]),q(a,function(a){X(a)&&(a=qa(a));c.push(za(b)+"="+za(a))}))});0<c.length&&
(a+=(-1==a.indexOf("?")?"?":"&")+c.join("&"));return a}var F=c("$http"),v=[];q(g,function(a){v.unshift(w(a)?p.get(a):p.invoke(a))});q(f,function(a,b){var c=w(a)?p.get(a):p.invoke(a);v.splice(b,0,{response:function(a){return c(n.when(a))},responseError:function(a){return c(n.reject(a))}})});r.pendingRequests=[];(function(a){q(arguments,function(a){r[a]=function(b,c){return r(D(c||{},{method:a,url:b}))}})})("get","delete","head","jsonp");(function(a){q(arguments,function(a){r[a]=function(b,c,d){return r(D(d||
{},{method:a,url:b,data:c}))}})})("post","put");r.defaults=e;return r}]}function ue(b){if(8>=S&&(!b.match(/^(get|post|head|put|delete|options)$/i)||!O.XMLHttpRequest))return new O.ActiveXObject("Microsoft.XMLHTTP");if(O.XMLHttpRequest)return new O.XMLHttpRequest;throw t("$httpBackend")("noxhr");}function Ud(){this.$get=["$browser","$window","$document",function(b,a,c){return ve(b,ue,b.defer,a.angular.callbacks,c[0])}]}function ve(b,a,c,d,e){function g(a,b){var c=e.createElement("script"),d=function(){c.onreadystatechange=
c.onload=c.onerror=null;e.body.removeChild(c);b&&b()};c.type="text/javascript";c.src=a;S&&8>=S?c.onreadystatechange=function(){/loaded|complete/.test(c.readyState)&&d()}:c.onload=c.onerror=function(){d()};e.body.appendChild(c);return d}var f=-1;return function(e,l,k,m,n,p,r,z){function u(){v=f;A&&A();x&&x.abort()}function F(a,d,e,g,f){L&&c.cancel(L);A=x=null;0===d&&(d=e?200:"file"==sa(l).protocol?404:0);a(1223===d?204:d,e,g,f||"");b.$$completeOutstandingRequest(C)}var v;b.$$incOutstandingRequestCount();
l=l||b.url();if("jsonp"==K(e)){var J="_"+(d.counter++).toString(36);d[J]=function(a){d[J].data=a};var A=g(l.replace("JSON_CALLBACK","angular.callbacks."+J),function(){d[J].data?F(m,200,d[J].data):F(m,v||-2);d[J]=Ea.noop})}else{var x=a(e);x.open(e,l,!0);q(n,function(a,b){B(a)&&x.setRequestHeader(b,a)});x.onreadystatechange=function(){if(x&&4==x.readyState){var a=null,b=null;v!==f&&(a=x.getAllResponseHeaders(),b="response"in x?x.response:x.responseText);F(m,v||x.status,b,a,x.statusText||"")}};r&&(x.withCredentials=
!0);if(z)try{x.responseType=z}catch(s){if("json"!==z)throw s;}x.send(k||null)}if(0<p)var L=c(u,p);else p&&p.then&&p.then(u)}}function Rd(){var b="{{",a="}}";this.startSymbol=function(a){return a?(b=a,this):b};this.endSymbol=function(b){return b?(a=b,this):a};this.$get=["$parse","$exceptionHandler","$sce",function(c,d,e){function g(g,k,m){for(var n,p,r=0,z=[],u=g.length,F=!1,v=[];r<u;)-1!=(n=g.indexOf(b,r))&&-1!=(p=g.indexOf(a,n+f))?(r!=n&&z.push(g.substring(r,n)),z.push(r=c(F=g.substring(n+f,p))),
r.exp=F,r=p+h,F=!0):(r!=u&&z.push(g.substring(r)),r=u);(u=z.length)||(z.push(""),u=1);if(m&&1<z.length)throw vc("noconcat",g);if(!k||F)return v.length=u,r=function(a){try{for(var b=0,c=u,f;b<c;b++)"function"==typeof(f=z[b])&&(f=f(a),f=m?e.getTrusted(m,f):e.valueOf(f),null===f||E(f)?f="":"string"!=typeof f&&(f=qa(f))),v[b]=f;return v.join("")}catch(h){a=vc("interr",g,h.toString()),d(a)}},r.exp=g,r.parts=z,r}var f=b.length,h=a.length;g.startSymbol=function(){return b};g.endSymbol=function(){return a};
return g}]}function Sd(){this.$get=["$rootScope","$window","$q",function(b,a,c){function d(d,f,h,l){var k=a.setInterval,m=a.clearInterval,n=c.defer(),p=n.promise,r=0,z=B(l)&&!l;h=B(h)?h:0;p.then(null,null,d);p.$$intervalId=k(function(){n.notify(r++);0<h&&r>=h&&(n.resolve(r),m(p.$$intervalId),delete e[p.$$intervalId]);z||b.$apply()},f);e[p.$$intervalId]=n;return p}var e={};d.cancel=function(a){return a&&a.$$intervalId in e?(e[a.$$intervalId].reject("canceled"),clearInterval(a.$$intervalId),delete e[a.$$intervalId],
!0):!1};return d}]}function ad(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"\u00a4",posSuf:"",negPre:"(\u00a4",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January February March April May June July August September October November December".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(b){return 1===b?"one":"other"}}}}function wc(b){b=b.split("/");for(var a=b.length;a--;)b[a]=wb(b[a]);return b.join("/")}function xc(b,a,c){b=sa(b,c);a.$$protocol=
b.protocol;a.$$host=b.hostname;a.$$port=Y(b.port)||we[b.protocol]||null}function yc(b,a,c){var d="/"!==b.charAt(0);d&&(b="/"+b);b=sa(b,c);a.$$path=decodeURIComponent(d&&"/"===b.pathname.charAt(0)?b.pathname.substring(1):b.pathname);a.$$search=Yb(b.search);a.$$hash=decodeURIComponent(b.hash);a.$$path&&"/"!=a.$$path.charAt(0)&&(a.$$path="/"+a.$$path)}function oa(b,a){if(0===a.indexOf(b))return a.substr(b.length)}function Ya(b){var a=b.indexOf("#");return-1==a?b:b.substr(0,a)}function Jb(b){return b.substr(0,
Ya(b).lastIndexOf("/")+1)}function zc(b,a){this.$$html5=!0;a=a||"";var c=Jb(b);xc(b,this,b);this.$$parse=function(a){var e=oa(c,a);if(!w(e))throw Kb("ipthprfx",a,c);yc(e,this,b);this.$$path||(this.$$path="/");this.$$compose()};this.$$compose=function(){var a=Zb(this.$$search),b=this.$$hash?"#"+wb(this.$$hash):"";this.$$url=wc(this.$$path)+(a?"?"+a:"")+b;this.$$absUrl=c+this.$$url.substr(1)};this.$$rewrite=function(d){var e;if((e=oa(b,d))!==s)return d=e,(e=oa(a,e))!==s?c+(oa("/",e)||e):b+d;if((e=oa(c,
d))!==s)return c+e;if(c==d+"/")return c}}function Lb(b,a){var c=Jb(b);xc(b,this,b);this.$$parse=function(d){var e=oa(b,d)||oa(c,d),e="#"==e.charAt(0)?oa(a,e):this.$$html5?e:"";if(!w(e))throw Kb("ihshprfx",d,a);yc(e,this,b);d=this.$$path;var g=/^\/?.*?:(\/.*)/;0===e.indexOf(b)&&(e=e.replace(b,""));g.exec(e)||(d=(e=g.exec(d))?e[1]:d);this.$$path=d;this.$$compose()};this.$$compose=function(){var c=Zb(this.$$search),e=this.$$hash?"#"+wb(this.$$hash):"";this.$$url=wc(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=
b+(this.$$url?a+this.$$url:"")};this.$$rewrite=function(a){if(Ya(b)==Ya(a))return a}}function Ac(b,a){this.$$html5=!0;Lb.apply(this,arguments);var c=Jb(b);this.$$rewrite=function(d){var e;if(b==Ya(d))return d;if(e=oa(c,d))return b+a+e;if(c===d+"/")return c}}function nb(b){return function(){return this[b]}}function Bc(b,a){return function(c){if(E(c))return this[b];this[b]=a(c);this.$$compose();return this}}function Vd(){var b="",a=!1;this.hashPrefix=function(a){return B(a)?(b=a,this):b};this.html5Mode=
function(b){return B(b)?(a=b,this):a};this.$get=["$rootScope","$browser","$sniffer","$rootElement",function(c,d,e,g){function f(a){c.$broadcast("$locationChangeSuccess",h.absUrl(),a)}var h,l=d.baseHref(),k=d.url();a?(l=k.substring(0,k.indexOf("/",k.indexOf("//")+2))+(l||"/"),e=e.history?zc:Ac):(l=Ya(k),e=Lb);h=new e(l,"#"+b);h.$$parse(h.$$rewrite(k));g.on("click",function(a){if(!a.ctrlKey&&!a.metaKey&&2!=a.which){for(var b=y(a.target);"a"!==K(b[0].nodeName);)if(b[0]===g[0]||!(b=b.parent())[0])return;
var e=b.prop("href");X(e)&&"[object SVGAnimatedString]"===e.toString()&&(e=sa(e.animVal).href);var f=h.$$rewrite(e);e&&(!b.attr("target")&&f&&!a.isDefaultPrevented())&&(a.preventDefault(),f!=d.url()&&(h.$$parse(f),c.$apply(),O.angular["ff-684208-preventDefault"]=!0))}});h.absUrl()!=k&&d.url(h.absUrl(),!0);d.onUrlChange(function(a){h.absUrl()!=a&&(c.$evalAsync(function(){var b=h.absUrl();h.$$parse(a);c.$broadcast("$locationChangeStart",a,b).defaultPrevented?(h.$$parse(b),d.url(b)):f(b)}),c.$$phase||
c.$digest())});var m=0;c.$watch(function(){var a=d.url(),b=h.$$replace;m&&a==h.absUrl()||(m++,c.$evalAsync(function(){c.$broadcast("$locationChangeStart",h.absUrl(),a).defaultPrevented?h.$$parse(a):(d.url(h.absUrl(),b),f(a))}));h.$$replace=!1;return m});return h}]}function Wd(){var b=!0,a=this;this.debugEnabled=function(a){return B(a)?(b=a,this):b};this.$get=["$window",function(c){function d(a){a instanceof Error&&(a.stack?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:
a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line));return a}function e(a){var b=c.console||{},e=b[a]||b.log||C;a=!1;try{a=!!e.apply}catch(l){}return a?function(){var a=[];q(arguments,function(b){a.push(d(b))});return e.apply(b,a)}:function(a,b){e(a,null==b?"":b)}}return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){b&&c.apply(a,arguments)}}()}}]}function fa(b,a){if("constructor"===b)throw Ba("isecfld",a);return b}function Za(b,
a){if(b){if(b.constructor===b)throw Ba("isecfn",a);if(b.document&&b.location&&b.alert&&b.setInterval)throw Ba("isecwindow",a);if(b.children&&(b.nodeName||b.prop&&b.attr&&b.find))throw Ba("isecdom",a);}return b}function ob(b,a,c,d,e){e=e||{};a=a.split(".");for(var g,f=0;1<a.length;f++){g=fa(a.shift(),d);var h=b[g];h||(h={},b[g]=h);b=h;b.then&&e.unwrapPromises&&(ta(d),"$$v"in b||function(a){a.then(function(b){a.$$v=b})}(b),b.$$v===s&&(b.$$v={}),b=b.$$v)}g=fa(a.shift(),d);return b[g]=c}function Cc(b,
a,c,d,e,g,f){fa(b,g);fa(a,g);fa(c,g);fa(d,g);fa(e,g);return f.unwrapPromises?function(f,l){var k=l&&l.hasOwnProperty(b)?l:f,m;if(null==k)return k;(k=k[b])&&k.then&&(ta(g),"$$v"in k||(m=k,m.$$v=s,m.then(function(a){m.$$v=a})),k=k.$$v);if(!a)return k;if(null==k)return s;(k=k[a])&&k.then&&(ta(g),"$$v"in k||(m=k,m.$$v=s,m.then(function(a){m.$$v=a})),k=k.$$v);if(!c)return k;if(null==k)return s;(k=k[c])&&k.then&&(ta(g),"$$v"in k||(m=k,m.$$v=s,m.then(function(a){m.$$v=a})),k=k.$$v);if(!d)return k;if(null==
k)return s;(k=k[d])&&k.then&&(ta(g),"$$v"in k||(m=k,m.$$v=s,m.then(function(a){m.$$v=a})),k=k.$$v);if(!e)return k;if(null==k)return s;(k=k[e])&&k.then&&(ta(g),"$$v"in k||(m=k,m.$$v=s,m.then(function(a){m.$$v=a})),k=k.$$v);return k}:function(g,f){var k=f&&f.hasOwnProperty(b)?f:g;if(null==k)return k;k=k[b];if(!a)return k;if(null==k)return s;k=k[a];if(!c)return k;if(null==k)return s;k=k[c];if(!d)return k;if(null==k)return s;k=k[d];return e?null==k?s:k=k[e]:k}}function xe(b,a){fa(b,a);return function(a,
d){return null==a?s:(d&&d.hasOwnProperty(b)?d:a)[b]}}function ye(b,a,c){fa(b,c);fa(a,c);return function(c,e){if(null==c)return s;c=(e&&e.hasOwnProperty(b)?e:c)[b];return null==c?s:c[a]}}function Dc(b,a,c){if(Mb.hasOwnProperty(b))return Mb[b];var d=b.split("."),e=d.length,g;if(a.unwrapPromises||1!==e)if(a.unwrapPromises||2!==e)if(a.csp)g=6>e?Cc(d[0],d[1],d[2],d[3],d[4],c,a):function(b,g){var f=0,h;do h=Cc(d[f++],d[f++],d[f++],d[f++],d[f++],c,a)(b,g),g=s,b=h;while(f<e);return h};else{var f="var p;\n";
q(d,function(b,d){fa(b,c);f+="if(s == null) return undefined;\ns="+(d?"s":'((k&&k.hasOwnProperty("'+b+'"))?k:s)')+'["'+b+'"];\n'+(a.unwrapPromises?'if (s && s.then) {\n pw("'+c.replace(/(["\r\n])/g,"\\$1")+'");\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v=v;});\n}\n s=s.$$v\n}\n':"")});var f=f+"return s;",h=new Function("s","k","pw",f);h.toString=aa(f);g=a.unwrapPromises?function(a,b){return h(a,b,ta)}:h}else g=ye(d[0],d[1],c);else g=xe(d[0],c);"hasOwnProperty"!==
b&&(Mb[b]=g);return g}function Xd(){var b={},a={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0};this.unwrapPromises=function(b){return B(b)?(a.unwrapPromises=!!b,this):a.unwrapPromises};this.logPromiseWarnings=function(b){return B(b)?(a.logPromiseWarnings=b,this):a.logPromiseWarnings};this.$get=["$filter","$sniffer","$log",function(c,d,e){a.csp=d.csp;ta=function(b){a.logPromiseWarnings&&!Ec.hasOwnProperty(b)&&(Ec[b]=!0,e.warn("[$parse] Promise found in the expression `"+b+"`. Automatic unwrapping of promises in Angular expressions is deprecated."))};
return function(d){var e;switch(typeof d){case "string":if(b.hasOwnProperty(d))return b[d];e=new Nb(a);e=(new $a(e,c,a)).parse(d,!1);"hasOwnProperty"!==d&&(b[d]=e);return e;case "function":return d;default:return C}}}]}function Zd(){this.$get=["$rootScope","$exceptionHandler",function(b,a){return ze(function(a){b.$evalAsync(a)},a)}]}function ze(b,a){function c(a){return a}function d(a){return f(a)}var e=function(){var f=[],k,m;return m={resolve:function(a){if(f){var c=f;f=s;k=g(a);c.length&&b(function(){for(var a,
b=0,d=c.length;b<d;b++)a=c[b],k.then(a[0],a[1],a[2])})}},reject:function(a){m.resolve(h(a))},notify:function(a){if(f){var c=f;f.length&&b(function(){for(var b,d=0,e=c.length;d<e;d++)b=c[d],b[2](a)})}},promise:{then:function(b,g,h){var m=e(),u=function(d){try{m.resolve((P(b)?b:c)(d))}catch(e){m.reject(e),a(e)}},F=function(b){try{m.resolve((P(g)?g:d)(b))}catch(c){m.reject(c),a(c)}},v=function(b){try{m.notify((P(h)?h:c)(b))}catch(d){a(d)}};f?f.push([u,F,v]):k.then(u,F,v);return m.promise},"catch":function(a){return this.then(null,
a)},"finally":function(a){function b(a,c){var d=e();c?d.resolve(a):d.reject(a);return d.promise}function d(e,g){var f=null;try{f=(a||c)()}catch(h){return b(h,!1)}return f&&P(f.then)?f.then(function(){return b(e,g)},function(a){return b(a,!1)}):b(e,g)}return this.then(function(a){return d(a,!0)},function(a){return d(a,!1)})}}}},g=function(a){return a&&P(a.then)?a:{then:function(c){var d=e();b(function(){d.resolve(c(a))});return d.promise}}},f=function(a){var b=e();b.reject(a);return b.promise},h=function(c){return{then:function(g,
f){var h=e();b(function(){try{h.resolve((P(f)?f:d)(c))}catch(b){h.reject(b),a(b)}});return h.promise}}};return{defer:e,reject:f,when:function(h,k,m,n){var p=e(),r,z=function(b){try{return(P(k)?k:c)(b)}catch(d){return a(d),f(d)}},u=function(b){try{return(P(m)?m:d)(b)}catch(c){return a(c),f(c)}},F=function(b){try{return(P(n)?n:c)(b)}catch(d){a(d)}};b(function(){g(h).then(function(a){r||(r=!0,p.resolve(g(a).then(z,u,F)))},function(a){r||(r=!0,p.resolve(u(a)))},function(a){r||p.notify(F(a))})});return p.promise},
all:function(a){var b=e(),c=0,d=M(a)?[]:{};q(a,function(a,e){c++;g(a).then(function(a){d.hasOwnProperty(e)||(d[e]=a,--c||b.resolve(d))},function(a){d.hasOwnProperty(e)||b.reject(a)})});0===c&&b.resolve(d);return b.promise}}}function fe(){this.$get=["$window","$timeout",function(b,a){var c=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame,d=b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.mozCancelAnimationFrame||b.webkitCancelRequestAnimationFrame,e=!!c,g=e?
function(a){var b=c(a);return function(){d(b)}}:function(b){var c=a(b,16.66,!1);return function(){a.cancel(c)}};g.supported=e;return g}]}function Yd(){var b=10,a=t("$rootScope"),c=null;this.digestTtl=function(a){arguments.length&&(b=a);return b};this.$get=["$injector","$exceptionHandler","$parse","$browser",function(d,e,g,f){function h(){this.$id=bb();this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null;this["this"]=this.$root=this;
this.$$destroyed=!1;this.$$asyncQueue=[];this.$$postDigestQueue=[];this.$$listeners={};this.$$listenerCount={};this.$$isolateBindings={}}function l(b){if(p.$$phase)throw a("inprog",p.$$phase);p.$$phase=b}function k(a,b){var c=g(a);Ra(c,b);return c}function m(a,b,c){do a.$$listenerCount[c]-=b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c];while(a=a.$parent)}function n(){}h.prototype={constructor:h,$new:function(a){a?(a=new h,a.$root=this.$root,a.$$asyncQueue=this.$$asyncQueue,a.$$postDigestQueue=
this.$$postDigestQueue):(a=function(){},a.prototype=this,a=new a,a.$id=bb());a["this"]=a;a.$$listeners={};a.$$listenerCount={};a.$parent=this;a.$$watchers=a.$$nextSibling=a.$$childHead=a.$$childTail=null;a.$$prevSibling=this.$$childTail;this.$$childHead?this.$$childTail=this.$$childTail.$$nextSibling=a:this.$$childHead=this.$$childTail=a;return a},$watch:function(a,b,d){var e=k(a,"watch"),g=this.$$watchers,f={fn:b,last:n,get:e,exp:a,eq:!!d};c=null;if(!P(b)){var h=k(b||C,"listener");f.fn=function(a,
b,c){h(c)}}if("string"==typeof a&&e.constant){var l=f.fn;f.fn=function(a,b,c){l.call(this,a,b,c);Oa(g,f)}}g||(g=this.$$watchers=[]);g.unshift(f);return function(){Oa(g,f);c=null}},$watchCollection:function(a,b){var c=this,d,e,f,h=1<b.length,l=0,k=g(a),m=[],n={},p=!0,q=0;return this.$watch(function(){d=k(c);var a,b;if(X(d))if(ab(d))for(e!==m&&(e=m,q=e.length=0,l++),a=d.length,q!==a&&(l++,e.length=q=a),b=0;b<a;b++)e[b]!==e[b]&&d[b]!==d[b]||e[b]===d[b]||(l++,e[b]=d[b]);else{e!==n&&(e=n={},q=0,l++);a=
0;for(b in d)d.hasOwnProperty(b)&&(a++,e.hasOwnProperty(b)?e[b]!==d[b]&&(l++,e[b]=d[b]):(q++,e[b]=d[b],l++));if(q>a)for(b in l++,e)e.hasOwnProperty(b)&&!d.hasOwnProperty(b)&&(q--,delete e[b])}else e!==d&&(e=d,l++);return l},function(){p?(p=!1,b(d,d,c)):b(d,f,c);if(h)if(X(d))if(ab(d)){f=Array(d.length);for(var a=0;a<d.length;a++)f[a]=d[a]}else for(a in f={},d)Fc.call(d,a)&&(f[a]=d[a]);else f=d})},$digest:function(){var d,g,f,h,k=this.$$asyncQueue,m=this.$$postDigestQueue,q,x,s=b,L,Q=[],y,H,R;l("$digest");
c=null;do{x=!1;for(L=this;k.length;){try{R=k.shift(),R.scope.$eval(R.expression)}catch(B){p.$$phase=null,e(B)}c=null}a:do{if(h=L.$$watchers)for(q=h.length;q--;)try{if(d=h[q])if((g=d.get(L))!==(f=d.last)&&!(d.eq?xa(g,f):"number"==typeof g&&"number"==typeof f&&isNaN(g)&&isNaN(f)))x=!0,c=d,d.last=d.eq?ba(g):g,d.fn(g,f===n?g:f,L),5>s&&(y=4-s,Q[y]||(Q[y]=[]),H=P(d.exp)?"fn: "+(d.exp.name||d.exp.toString()):d.exp,H+="; newVal: "+qa(g)+"; oldVal: "+qa(f),Q[y].push(H));else if(d===c){x=!1;break a}}catch(w){p.$$phase=
null,e(w)}if(!(h=L.$$childHead||L!==this&&L.$$nextSibling))for(;L!==this&&!(h=L.$$nextSibling);)L=L.$parent}while(L=h);if((x||k.length)&&!s--)throw p.$$phase=null,a("infdig",b,qa(Q));}while(x||k.length);for(p.$$phase=null;m.length;)try{m.shift()()}catch(T){e(T)}},$destroy:function(){if(!this.$$destroyed){var a=this.$parent;this.$broadcast("$destroy");this.$$destroyed=!0;this!==p&&(q(this.$$listenerCount,eb(null,m,this)),a.$$childHead==this&&(a.$$childHead=this.$$nextSibling),a.$$childTail==this&&
(a.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=null,this.$$listeners={},this.$$watchers=this.$$asyncQueue=this.$$postDigestQueue=[],this.$destroy=this.$digest=this.$apply=C,this.$on=this.$watch=function(){return C})}},$eval:function(a,b){return g(a)(this,b)},$evalAsync:function(a){p.$$phase||
p.$$asyncQueue.length||f.defer(function(){p.$$asyncQueue.length&&p.$digest()});this.$$asyncQueue.push({scope:this,expression:a})},$$postDigest:function(a){this.$$postDigestQueue.push(a)},$apply:function(a){try{return l("$apply"),this.$eval(a)}catch(b){e(b)}finally{p.$$phase=null;try{p.$digest()}catch(c){throw e(c),c;}}},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]);c.push(b);var d=this;do d.$$listenerCount[a]||(d.$$listenerCount[a]=0),d.$$listenerCount[a]++;while(d=d.$parent);
var e=this;return function(){c[db(c,b)]=null;m(e,1,a)}},$emit:function(a,b){var c=[],d,g=this,f=!1,h={name:a,targetScope:g,stopPropagation:function(){f=!0},preventDefault:function(){h.defaultPrevented=!0},defaultPrevented:!1},l=[h].concat(ya.call(arguments,1)),k,m;do{d=g.$$listeners[a]||c;h.currentScope=g;k=0;for(m=d.length;k<m;k++)if(d[k])try{d[k].apply(null,l)}catch(n){e(n)}else d.splice(k,1),k--,m--;if(f)break;g=g.$parent}while(g);return h},$broadcast:function(a,b){for(var c=this,d=this,g={name:a,
targetScope:this,preventDefault:function(){g.defaultPrevented=!0},defaultPrevented:!1},f=[g].concat(ya.call(arguments,1)),h,k;c=d;){g.currentScope=c;d=c.$$listeners[a]||[];h=0;for(k=d.length;h<k;h++)if(d[h])try{d[h].apply(null,f)}catch(l){e(l)}else d.splice(h,1),h--,k--;if(!(d=c.$$listenerCount[a]&&c.$$childHead||c!==this&&c.$$nextSibling))for(;c!==this&&!(d=c.$$nextSibling);)c=c.$parent}return g}};var p=new h;return p}]}function bd(){var b=/^\s*(https?|ftp|mailto|tel|file):/,a=/^\s*(https?|ftp|file):|data:image\//;
this.aHrefSanitizationWhitelist=function(a){return B(a)?(b=a,this):b};this.imgSrcSanitizationWhitelist=function(b){return B(b)?(a=b,this):a};this.$get=function(){return function(c,d){var e=d?a:b,g;if(!S||8<=S)if(g=sa(c).href,""!==g&&!g.match(e))return"unsafe:"+g;return c}}}function Ae(b){if("self"===b)return b;if(w(b)){if(-1<b.indexOf("***"))throw ua("iwcard",b);b=b.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08").replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*");return RegExp("^"+
b+"$")}if(cb(b))return RegExp("^"+b.source+"$");throw ua("imatcher");}function Gc(b){var a=[];B(b)&&q(b,function(b){a.push(Ae(b))});return a}function ae(){this.SCE_CONTEXTS=ga;var b=["self"],a=[];this.resourceUrlWhitelist=function(a){arguments.length&&(b=Gc(a));return b};this.resourceUrlBlacklist=function(b){arguments.length&&(a=Gc(b));return a};this.$get=["$injector",function(c){function d(a){var b=function(a){this.$$unwrapTrustedValue=function(){return a}};a&&(b.prototype=new a);b.prototype.valueOf=
function(){return this.$$unwrapTrustedValue()};b.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()};return b}var e=function(a){throw ua("unsafe");};c.has("$sanitize")&&(e=c.get("$sanitize"));var g=d(),f={};f[ga.HTML]=d(g);f[ga.CSS]=d(g);f[ga.URL]=d(g);f[ga.JS]=d(g);f[ga.RESOURCE_URL]=d(f[ga.URL]);return{trustAs:function(a,b){var c=f.hasOwnProperty(a)?f[a]:null;if(!c)throw ua("icontext",a,b);if(null===b||b===s||""===b)return b;if("string"!==typeof b)throw ua("itype",a);return new c(b)},
getTrusted:function(c,d){if(null===d||d===s||""===d)return d;var g=f.hasOwnProperty(c)?f[c]:null;if(g&&d instanceof g)return d.$$unwrapTrustedValue();if(c===ga.RESOURCE_URL){var g=sa(d.toString()),m,n,p=!1;m=0;for(n=b.length;m<n;m++)if("self"===b[m]?Ib(g):b[m].exec(g.href)){p=!0;break}if(p)for(m=0,n=a.length;m<n;m++)if("self"===a[m]?Ib(g):a[m].exec(g.href)){p=!1;break}if(p)return d;throw ua("insecurl",d.toString());}if(c===ga.HTML)return e(d);throw ua("unsafe");},valueOf:function(a){return a instanceof
g?a.$$unwrapTrustedValue():a}}}]}function $d(){var b=!0;this.enabled=function(a){arguments.length&&(b=!!a);return b};this.$get=["$parse","$sniffer","$sceDelegate",function(a,c,d){if(b&&c.msie&&8>c.msieDocumentMode)throw ua("iequirks");var e=ba(ga);e.isEnabled=function(){return b};e.trustAs=d.trustAs;e.getTrusted=d.getTrusted;e.valueOf=d.valueOf;b||(e.trustAs=e.getTrusted=function(a,b){return b},e.valueOf=Da);e.parseAs=function(b,c){var d=a(c);return d.literal&&d.constant?d:function(a,c){return e.getTrusted(b,
d(a,c))}};var g=e.parseAs,f=e.getTrusted,h=e.trustAs;q(ga,function(a,b){var c=K(b);e[Ta("parse_as_"+c)]=function(b){return g(a,b)};e[Ta("get_trusted_"+c)]=function(b){return f(a,b)};e[Ta("trust_as_"+c)]=function(b){return h(a,b)}});return e}]}function be(){this.$get=["$window","$document",function(b,a){var c={},d=Y((/android (\d+)/.exec(K((b.navigator||{}).userAgent))||[])[1]),e=/Boxee/i.test((b.navigator||{}).userAgent),g=a[0]||{},f=g.documentMode,h,l=/^(Moz|webkit|O|ms)(?=[A-Z])/,k=g.body&&g.body.style,
m=!1,n=!1;if(k){for(var p in k)if(m=l.exec(p)){h=m[0];h=h.substr(0,1).toUpperCase()+h.substr(1);break}h||(h="WebkitOpacity"in k&&"webkit");m=!!("transition"in k||h+"Transition"in k);n=!!("animation"in k||h+"Animation"in k);!d||m&&n||(m=w(g.body.style.webkitTransition),n=w(g.body.style.webkitAnimation))}return{history:!(!b.history||!b.history.pushState||4>d||e),hashchange:"onhashchange"in b&&(!f||7<f),hasEvent:function(a){if("input"==a&&9==S)return!1;if(E(c[a])){var b=g.createElement("div");c[a]="on"+
a in b}return c[a]},csp:Vb(),vendorPrefix:h,transitions:m,animations:n,android:d,msie:S,msieDocumentMode:f}}]}function de(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function(b,a,c,d){function e(e,h,l){var k=c.defer(),m=k.promise,n=B(l)&&!l;h=a.defer(function(){try{k.resolve(e())}catch(a){k.reject(a),d(a)}finally{delete g[m.$$timeoutId]}n||b.$apply()},h);m.$$timeoutId=h;g[h]=k;return m}var g={};e.cancel=function(b){return b&&b.$$timeoutId in g?(g[b.$$timeoutId].reject("canceled"),
delete g[b.$$timeoutId],a.defer.cancel(b.$$timeoutId)):!1};return e}]}function sa(b,a){var c=b;S&&(W.setAttribute("href",c),c=W.href);W.setAttribute("href",c);return{href:W.href,protocol:W.protocol?W.protocol.replace(/:$/,""):"",host:W.host,search:W.search?W.search.replace(/^\?/,""):"",hash:W.hash?W.hash.replace(/^#/,""):"",hostname:W.hostname,port:W.port,pathname:"/"===W.pathname.charAt(0)?W.pathname:"/"+W.pathname}}function Ib(b){b=w(b)?sa(b):b;return b.protocol===Hc.protocol&&b.host===Hc.host}
function ee(){this.$get=aa(O)}function gc(b){function a(d,e){if(X(d)){var g={};q(d,function(b,c){g[c]=a(c,b)});return g}return b.factory(d+c,e)}var c="Filter";this.register=a;this.$get=["$injector",function(a){return function(b){return a.get(b+c)}}];a("currency",Ic);a("date",Jc);a("filter",Be);a("json",Ce);a("limitTo",De);a("lowercase",Ee);a("number",Kc);a("orderBy",Lc);a("uppercase",Fe)}function Be(){return function(b,a,c){if(!M(b))return b;var d=typeof c,e=[];e.check=function(a){for(var b=0;b<e.length;b++)if(!e[b](a))return!1;
return!0};"function"!==d&&(c="boolean"===d&&c?function(a,b){return Ea.equals(a,b)}:function(a,b){if(a&&b&&"object"===typeof a&&"object"===typeof b){for(var d in a)if("$"!==d.charAt(0)&&Fc.call(a,d)&&c(a[d],b[d]))return!0;return!1}b=(""+b).toLowerCase();return-1<(""+a).toLowerCase().indexOf(b)});var g=function(a,b){if("string"==typeof b&&"!"===b.charAt(0))return!g(a,b.substr(1));switch(typeof a){case "boolean":case "number":case "string":return c(a,b);case "object":switch(typeof b){case "object":return c(a,
b);default:for(var d in a)if("$"!==d.charAt(0)&&g(a[d],b))return!0}return!1;case "array":for(d=0;d<a.length;d++)if(g(a[d],b))return!0;return!1;default:return!1}};switch(typeof a){case "boolean":case "number":case "string":a={$:a};case "object":for(var f in a)(function(b){"undefined"!=typeof a[b]&&e.push(function(c){return g("$"==b?c:c&&c[b],a[b])})})(f);break;case "function":e.push(a);break;default:return b}d=[];for(f=0;f<b.length;f++){var h=b[f];e.check(h)&&d.push(h)}return d}}function Ic(b){var a=
b.NUMBER_FORMATS;return function(b,d){E(d)&&(d=a.CURRENCY_SYM);return Mc(b,a.PATTERNS[1],a.GROUP_SEP,a.DECIMAL_SEP,2).replace(/\u00A4/g,d)}}function Kc(b){var a=b.NUMBER_FORMATS;return function(b,d){return Mc(b,a.PATTERNS[0],a.GROUP_SEP,a.DECIMAL_SEP,d)}}function Mc(b,a,c,d,e){if(null==b||!isFinite(b)||X(b))return"";var g=0>b;b=Math.abs(b);var f=b+"",h="",l=[],k=!1;if(-1!==f.indexOf("e")){var m=f.match(/([\d\.]+)e(-?)(\d+)/);m&&"-"==m[2]&&m[3]>e+1?f="0":(h=f,k=!0)}if(k)0<e&&(-1<b&&1>b)&&(h=b.toFixed(e));
else{f=(f.split(Nc)[1]||"").length;E(e)&&(e=Math.min(Math.max(a.minFrac,f),a.maxFrac));f=Math.pow(10,e);b=Math.round(b*f)/f;b=(""+b).split(Nc);f=b[0];b=b[1]||"";var m=0,n=a.lgSize,p=a.gSize;if(f.length>=n+p)for(m=f.length-n,k=0;k<m;k++)0===(m-k)%p&&0!==k&&(h+=c),h+=f.charAt(k);for(k=m;k<f.length;k++)0===(f.length-k)%n&&0!==k&&(h+=c),h+=f.charAt(k);for(;b.length<e;)b+="0";e&&"0"!==e&&(h+=d+b.substr(0,e))}l.push(g?a.negPre:a.posPre);l.push(h);l.push(g?a.negSuf:a.posSuf);return l.join("")}function Ob(b,
a,c){var d="";0>b&&(d="-",b=-b);for(b=""+b;b.length<a;)b="0"+b;c&&(b=b.substr(b.length-a));return d+b}function $(b,a,c,d){c=c||0;return function(e){e=e["get"+b]();if(0<c||e>-c)e+=c;0===e&&-12==c&&(e=12);return Ob(e,a,d)}}function pb(b,a){return function(c,d){var e=c["get"+b](),g=Fa(a?"SHORT"+b:b);return d[g][e]}}function Jc(b){function a(a){var b;if(b=a.match(c)){a=new Date(0);var g=0,f=0,h=b[8]?a.setUTCFullYear:a.setFullYear,l=b[8]?a.setUTCHours:a.setHours;b[9]&&(g=Y(b[9]+b[10]),f=Y(b[9]+b[11]));
h.call(a,Y(b[1]),Y(b[2])-1,Y(b[3]));g=Y(b[4]||0)-g;f=Y(b[5]||0)-f;h=Y(b[6]||0);b=Math.round(1E3*parseFloat("0."+(b[7]||0)));l.call(a,g,f,h,b)}return a}var c=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(c,e){var g="",f=[],h,l;e=e||"mediumDate";e=b.DATETIME_FORMATS[e]||e;w(c)&&(c=Ge.test(c)?Y(c):a(c));vb(c)&&(c=new Date(c));if(!Na(c))return c;for(;e;)(l=He.exec(e))?(f=f.concat(ya.call(l,1)),e=f.pop()):(f.push(e),e=null);q(f,function(a){h=
Ie[a];g+=h?h(c,b.DATETIME_FORMATS):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return g}}function Ce(){return function(b){return qa(b,!0)}}function De(){return function(b,a){if(!M(b)&&!w(b))return b;a=Y(a);if(w(b))return a?0<=a?b.slice(0,a):b.slice(a,b.length):"";var c=[],d,e;a>b.length?a=b.length:a<-b.length&&(a=-b.length);0<a?(d=0,e=a):(d=b.length+a,e=b.length);for(;d<e;d++)c.push(b[d]);return c}}function Lc(b){return function(a,c,d){function e(a,b){return Qa(b)?function(b,c){return a(c,b)}:a}
function g(a,b){var c=typeof a,d=typeof b;return c==d?("string"==c&&(a=a.toLowerCase(),b=b.toLowerCase()),a===b?0:a<b?-1:1):c<d?-1:1}if(!M(a)||!c)return a;c=M(c)?c:[c];c=Uc(c,function(a){var c=!1,d=a||Da;if(w(a)){if("+"==a.charAt(0)||"-"==a.charAt(0))c="-"==a.charAt(0),a=a.substring(1);d=b(a);if(d.constant){var f=d();return e(function(a,b){return g(a[f],b[f])},c)}}return e(function(a,b){return g(d(a),d(b))},c)});for(var f=[],h=0;h<a.length;h++)f.push(a[h]);return f.sort(e(function(a,b){for(var d=
0;d<c.length;d++){var e=c[d](a,b);if(0!==e)return e}return 0},d))}}function va(b){P(b)&&(b={link:b});b.restrict=b.restrict||"AC";return aa(b)}function Oc(b,a,c,d){function e(a,c){c=c?"-"+fb(c,"-"):"";d.removeClass(b,(a?qb:rb)+c);d.addClass(b,(a?rb:qb)+c)}var g=this,f=b.parent().controller("form")||sb,h=0,l=g.$error={},k=[];g.$name=a.name||a.ngForm;g.$dirty=!1;g.$pristine=!0;g.$valid=!0;g.$invalid=!1;f.$addControl(g);b.addClass(La);e(!0);g.$addControl=function(a){Aa(a.$name,"input");k.push(a);a.$name&&
(g[a.$name]=a)};g.$removeControl=function(a){a.$name&&g[a.$name]===a&&delete g[a.$name];q(l,function(b,c){g.$setValidity(c,!0,a)});Oa(k,a)};g.$setValidity=function(a,b,c){var d=l[a];if(b)d&&(Oa(d,c),d.length||(h--,h||(e(b),g.$valid=!0,g.$invalid=!1),l[a]=!1,e(!0,a),f.$setValidity(a,!0,g)));else{h||e(b);if(d){if(-1!=db(d,c))return}else l[a]=d=[],h++,e(!1,a),f.$setValidity(a,!1,g);d.push(c);g.$valid=!1;g.$invalid=!0}};g.$setDirty=function(){d.removeClass(b,La);d.addClass(b,tb);g.$dirty=!0;g.$pristine=
!1;f.$setDirty()};g.$setPristine=function(){d.removeClass(b,tb);d.addClass(b,La);g.$dirty=!1;g.$pristine=!0;q(k,function(a){a.$setPristine()})}}function pa(b,a,c,d){b.$setValidity(a,c);return c?d:s}function Je(b,a,c){var d=c.prop("validity");X(d)&&b.$parsers.push(function(c){if(b.$error[a]||!(d.badInput||d.customError||d.typeMismatch)||d.valueMissing)return c;b.$setValidity(a,!1)})}function ub(b,a,c,d,e,g){var f=a.prop("validity");if(!e.android){var h=!1;a.on("compositionstart",function(a){h=!0});
a.on("compositionend",function(){h=!1;l()})}var l=function(){if(!h){var e=a.val();Qa(c.ngTrim||"T")&&(e=ca(e));if(d.$viewValue!==e||f&&""===e&&!f.valueMissing)b.$$phase?d.$setViewValue(e):b.$apply(function(){d.$setViewValue(e)})}};if(e.hasEvent("input"))a.on("input",l);else{var k,m=function(){k||(k=g.defer(function(){l();k=null}))};a.on("keydown",function(a){a=a.keyCode;91===a||(15<a&&19>a||37<=a&&40>=a)||m()});if(e.hasEvent("paste"))a.on("paste cut",m)}a.on("change",l);d.$render=function(){a.val(d.$isEmpty(d.$viewValue)?
"":d.$viewValue)};var n=c.ngPattern;n&&((e=n.match(/^\/(.*)\/([gim]*)$/))?(n=RegExp(e[1],e[2]),e=function(a){return pa(d,"pattern",d.$isEmpty(a)||n.test(a),a)}):e=function(c){var e=b.$eval(n);if(!e||!e.test)throw t("ngPattern")("noregexp",n,e,ha(a));return pa(d,"pattern",d.$isEmpty(c)||e.test(c),c)},d.$formatters.push(e),d.$parsers.push(e));if(c.ngMinlength){var p=Y(c.ngMinlength);e=function(a){return pa(d,"minlength",d.$isEmpty(a)||a.length>=p,a)};d.$parsers.push(e);d.$formatters.push(e)}if(c.ngMaxlength){var r=
Y(c.ngMaxlength);e=function(a){return pa(d,"maxlength",d.$isEmpty(a)||a.length<=r,a)};d.$parsers.push(e);d.$formatters.push(e)}}function Pb(b,a){b="ngClass"+b;return["$animate",function(c){function d(a,b){var c=[],d=0;a:for(;d<a.length;d++){for(var e=a[d],m=0;m<b.length;m++)if(e==b[m])continue a;c.push(e)}return c}function e(a){if(!M(a)){if(w(a))return a.split(" ");if(X(a)){var b=[];q(a,function(a,c){a&&b.push(c)});return b}}return a}return{restrict:"AC",link:function(g,f,h){function l(a,b){var c=
f.data("$classCounts")||{},d=[];q(a,function(a){if(0<b||c[a])c[a]=(c[a]||0)+b,c[a]===+(0<b)&&d.push(a)});f.data("$classCounts",c);return d.join(" ")}function k(b){if(!0===a||g.$index%2===a){var k=e(b||[]);if(!m){var r=l(k,1);h.$addClass(r)}else if(!xa(b,m)){var q=e(m),r=d(k,q),k=d(q,k),k=l(k,-1),r=l(r,1);0===r.length?c.removeClass(f,k):0===k.length?c.addClass(f,r):c.setClass(f,r,k)}}m=ba(b)}var m;g.$watch(h[b],k,!0);h.$observe("class",function(a){k(g.$eval(h[b]))});"ngClass"!==b&&g.$watch("$index",
function(c,d){var f=c&1;if(f!==d&1){var k=e(g.$eval(h[b]));f===a?(f=l(k,1),h.$addClass(f)):(f=l(k,-1),h.$removeClass(f))}})}}}]}var K=function(b){return w(b)?b.toLowerCase():b},Fc=Object.prototype.hasOwnProperty,Fa=function(b){return w(b)?b.toUpperCase():b},S,y,Ga,ya=[].slice,Ke=[].push,wa=Object.prototype.toString,Pa=t("ng"),Ea=O.angular||(O.angular={}),Sa,Ka,ka=["0","0","0"];S=Y((/msie (\d+)/.exec(K(navigator.userAgent))||[])[1]);isNaN(S)&&(S=Y((/trident\/.*; rv:(\d+)/.exec(K(navigator.userAgent))||
[])[1]));C.$inject=[];Da.$inject=[];var ca=function(){return String.prototype.trim?function(b){return w(b)?b.trim():b}:function(b){return w(b)?b.replace(/^\s\s*/,"").replace(/\s\s*$/,""):b}}();Ka=9>S?function(b){b=b.nodeName?b:b[0];return b.scopeName&&"HTML"!=b.scopeName?Fa(b.scopeName+":"+b.nodeName):b.nodeName}:function(b){return b.nodeName?b.nodeName:b[0].nodeName};var Xc=/[A-Z]/g,$c={full:"1.2.16",major:1,minor:2,dot:16,codeName:"badger-enumeration"},Ua=N.cache={},gb=N.expando="ng-"+(new Date).getTime(),
me=1,Pc=O.document.addEventListener?function(b,a,c){b.addEventListener(a,c,!1)}:function(b,a,c){b.attachEvent("on"+a,c)},Fb=O.document.removeEventListener?function(b,a,c){b.removeEventListener(a,c,!1)}:function(b,a,c){b.detachEvent("on"+a,c)};N._data=function(b){return this.cache[b[this.expando]]||{}};var he=/([\:\-\_]+(.))/g,ie=/^moz([A-Z])/,Bb=t("jqLite"),je=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Cb=/<|&#?\w+;/,ke=/<([\w:]+)/,le=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ea=
{option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ea.optgroup=ea.option;ea.tbody=ea.tfoot=ea.colgroup=ea.caption=ea.thead;ea.th=ea.td;var Ja=N.prototype={ready:function(b){function a(){c||(c=!0,b())}var c=!1;"complete"===U.readyState?setTimeout(a):(this.on("DOMContentLoaded",a),N(O).on("load",a))},toString:function(){var b=
[];q(this,function(a){b.push(""+a)});return"["+b.join(", ")+"]"},eq:function(b){return 0<=b?y(this[b]):y(this[this.length+b])},length:0,push:Ke,sort:[].sort,splice:[].splice},kb={};q("multiple selected checked disabled readOnly required open".split(" "),function(b){kb[K(b)]=b});var nc={};q("input select option textarea button form details".split(" "),function(b){nc[Fa(b)]=!0});q({data:jc,inheritedData:jb,scope:function(b){return y(b).data("$scope")||jb(b.parentNode||b,["$isolateScope","$scope"])},
isolateScope:function(b){return y(b).data("$isolateScope")||y(b).data("$isolateScopeNoTemplate")},controller:kc,injector:function(b){return jb(b,"$injector")},removeAttr:function(b,a){b.removeAttribute(a)},hasClass:Gb,css:function(b,a,c){a=Ta(a);if(B(c))b.style[a]=c;else{var d;8>=S&&(d=b.currentStyle&&b.currentStyle[a],""===d&&(d="auto"));d=d||b.style[a];8>=S&&(d=""===d?s:d);return d}},attr:function(b,a,c){var d=K(a);if(kb[d])if(B(c))c?(b[a]=!0,b.setAttribute(a,d)):(b[a]=!1,b.removeAttribute(d));
else return b[a]||(b.attributes.getNamedItem(a)||C).specified?d:s;else if(B(c))b.setAttribute(a,c);else if(b.getAttribute)return b=b.getAttribute(a,2),null===b?s:b},prop:function(b,a,c){if(B(c))b[a]=c;else return b[a]},text:function(){function b(b,d){var e=a[b.nodeType];if(E(d))return e?b[e]:"";b[e]=d}var a=[];9>S?(a[1]="innerText",a[3]="nodeValue"):a[1]=a[3]="textContent";b.$dv="";return b}(),val:function(b,a){if(E(a)){if("SELECT"===Ka(b)&&b.multiple){var c=[];q(b.options,function(a){a.selected&&
c.push(a.value||a.text)});return 0===c.length?null:c}return b.value}b.value=a},html:function(b,a){if(E(a))return b.innerHTML;for(var c=0,d=b.childNodes;c<d.length;c++)Ha(d[c]);b.innerHTML=a},empty:lc},function(b,a){N.prototype[a]=function(a,d){var e,g;if(b!==lc&&(2==b.length&&b!==Gb&&b!==kc?a:d)===s){if(X(a)){for(e=0;e<this.length;e++)if(b===jc)b(this[e],a);else for(g in a)b(this[e],g,a[g]);return this}e=b.$dv;g=e===s?Math.min(this.length,1):this.length;for(var f=0;f<g;f++){var h=b(this[f],a,d);e=
e?e+h:h}return e}for(e=0;e<this.length;e++)b(this[e],a,d);return this}});q({removeData:hc,dealoc:Ha,on:function a(c,d,e,g){if(B(g))throw Bb("onargs");var f=la(c,"events"),h=la(c,"handle");f||la(c,"events",f={});h||la(c,"handle",h=ne(c,f));q(d.split(" "),function(d){var g=f[d];if(!g){if("mouseenter"==d||"mouseleave"==d){var m=U.body.contains||U.body.compareDocumentPosition?function(a,c){var d=9===a.nodeType?a.documentElement:a,e=c&&c.parentNode;return a===e||!!(e&&1===e.nodeType&&(d.contains?d.contains(e):
a.compareDocumentPosition&&a.compareDocumentPosition(e)&16))}:function(a,c){if(c)for(;c=c.parentNode;)if(c===a)return!0;return!1};f[d]=[];a(c,{mouseleave:"mouseout",mouseenter:"mouseover"}[d],function(a){var c=a.relatedTarget;c&&(c===this||m(this,c))||h(a,d)})}else Pc(c,d,h),f[d]=[];g=f[d]}g.push(e)})},off:ic,one:function(a,c,d){a=y(a);a.on(c,function g(){a.off(c,d);a.off(c,g)});a.on(c,d)},replaceWith:function(a,c){var d,e=a.parentNode;Ha(a);q(new N(c),function(c){d?e.insertBefore(c,d.nextSibling):
e.replaceChild(c,a);d=c})},children:function(a){var c=[];q(a.childNodes,function(a){1===a.nodeType&&c.push(a)});return c},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,c){q(new N(c),function(c){1!==a.nodeType&&11!==a.nodeType||a.appendChild(c)})},prepend:function(a,c){if(1===a.nodeType){var d=a.firstChild;q(new N(c),function(c){a.insertBefore(c,d)})}},wrap:function(a,c){c=y(c)[0];var d=a.parentNode;d&&d.replaceChild(c,a);c.appendChild(a)},remove:function(a){Ha(a);
var c=a.parentNode;c&&c.removeChild(a)},after:function(a,c){var d=a,e=a.parentNode;q(new N(c),function(a){e.insertBefore(a,d.nextSibling);d=a})},addClass:ib,removeClass:hb,toggleClass:function(a,c,d){c&&q(c.split(" "),function(c){var g=d;E(g)&&(g=!Gb(a,c));(g?ib:hb)(a,c)})},parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},next:function(a){if(a.nextElementSibling)return a.nextElementSibling;for(a=a.nextSibling;null!=a&&1!==a.nodeType;)a=a.nextSibling;return a},find:function(a,c){return a.getElementsByTagName?
a.getElementsByTagName(c):[]},clone:Eb,triggerHandler:function(a,c,d){c=(la(a,"events")||{})[c];d=d||[];var e=[{preventDefault:C,stopPropagation:C}];q(c,function(c){c.apply(a,e.concat(d))})}},function(a,c){N.prototype[c]=function(c,e,g){for(var f,h=0;h<this.length;h++)E(f)?(f=a(this[h],c,e,g),B(f)&&(f=y(f))):Db(f,a(this[h],c,e,g));return B(f)?f:this};N.prototype.bind=N.prototype.on;N.prototype.unbind=N.prototype.off});Va.prototype={put:function(a,c){this[Ia(a)]=c},get:function(a){return this[Ia(a)]},
remove:function(a){var c=this[a=Ia(a)];delete this[a];return c}};var pe=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,qe=/,/,re=/^\s*(_?)(\S+?)\1\s*$/,oe=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,Wa=t("$injector"),Le=t("$animate"),Ld=["$provide",function(a){this.$$selectors={};this.register=function(c,d){var e=c+"-animation";if(c&&"."!=c.charAt(0))throw Le("notcsel",c);this.$$selectors[c.substr(1)]=e;a.factory(e,d)};this.classNameFilter=function(a){1===arguments.length&&(this.$$classNameFilter=a instanceof RegExp?
a:null);return this.$$classNameFilter};this.$get=["$timeout","$$asyncCallback",function(a,d){return{enter:function(a,c,f,h){f?f.after(a):(c&&c[0]||(c=f.parent()),c.append(a));h&&d(h)},leave:function(a,c){a.remove();c&&d(c)},move:function(a,c,d,h){this.enter(a,c,d,h)},addClass:function(a,c,f){c=w(c)?c:M(c)?c.join(" "):"";q(a,function(a){ib(a,c)});f&&d(f)},removeClass:function(a,c,f){c=w(c)?c:M(c)?c.join(" "):"";q(a,function(a){hb(a,c)});f&&d(f)},setClass:function(a,c,f,h){q(a,function(a){ib(a,c);hb(a,
f)});h&&d(h)},enabled:C}}]}],ja=t("$compile");cc.$inject=["$provide","$$sanitizeUriProvider"];var te=/^(x[\:\-_]|data[\:\-_])/i,vc=t("$interpolate"),Me=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,we={http:80,https:443,ftp:21},Kb=t("$location");Ac.prototype=Lb.prototype=zc.prototype={$$html5:!1,$$replace:!1,absUrl:nb("$$absUrl"),url:function(a,c){if(E(a))return this.$$url;var d=Me.exec(a);d[1]&&this.path(decodeURIComponent(d[1]));(d[2]||d[1])&&this.search(d[3]||"");this.hash(d[5]||"",c);return this},protocol:nb("$$protocol"),
host:nb("$$host"),port:nb("$$port"),path:Bc("$$path",function(a){return"/"==a.charAt(0)?a:"/"+a}),search:function(a,c){switch(arguments.length){case 0:return this.$$search;case 1:if(w(a))this.$$search=Yb(a);else if(X(a))this.$$search=a;else throw Kb("isrcharg");break;default:E(c)||null===c?delete this.$$search[a]:this.$$search[a]=c}this.$$compose();return this},hash:Bc("$$hash",Da),replace:function(){this.$$replace=!0;return this}};var Ba=t("$parse"),Ec={},ta,Ma={"null":function(){return null},"true":function(){return!0},
"false":function(){return!1},undefined:C,"+":function(a,c,d,e){d=d(a,c);e=e(a,c);return B(d)?B(e)?d+e:d:B(e)?e:s},"-":function(a,c,d,e){d=d(a,c);e=e(a,c);return(B(d)?d:0)-(B(e)?e:0)},"*":function(a,c,d,e){return d(a,c)*e(a,c)},"/":function(a,c,d,e){return d(a,c)/e(a,c)},"%":function(a,c,d,e){return d(a,c)%e(a,c)},"^":function(a,c,d,e){return d(a,c)^e(a,c)},"=":C,"===":function(a,c,d,e){return d(a,c)===e(a,c)},"!==":function(a,c,d,e){return d(a,c)!==e(a,c)},"==":function(a,c,d,e){return d(a,c)==e(a,
c)},"!=":function(a,c,d,e){return d(a,c)!=e(a,c)},"<":function(a,c,d,e){return d(a,c)<e(a,c)},">":function(a,c,d,e){return d(a,c)>e(a,c)},"<=":function(a,c,d,e){return d(a,c)<=e(a,c)},">=":function(a,c,d,e){return d(a,c)>=e(a,c)},"&&":function(a,c,d,e){return d(a,c)&&e(a,c)},"||":function(a,c,d,e){return d(a,c)||e(a,c)},"&":function(a,c,d,e){return d(a,c)&e(a,c)},"|":function(a,c,d,e){return e(a,c)(a,c,d(a,c))},"!":function(a,c,d){return!d(a,c)}},Ne={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},
Nb=function(a){this.options=a};Nb.prototype={constructor:Nb,lex:function(a){this.text=a;this.index=0;this.ch=s;this.lastCh=":";this.tokens=[];var c;for(a=[];this.index<this.text.length;){this.ch=this.text.charAt(this.index);if(this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent(),this.was("{,")&&("{"===a[0]&&(c=this.tokens[this.tokens.length-1]))&&(c.json=-1===c.text.indexOf("."));
else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch,json:this.was(":[,")&&this.is("{[")||this.is("}]:,")}),this.is("{[")&&a.unshift(this.ch),this.is("}]")&&a.shift(),this.index++;else if(this.isWhitespace(this.ch)){this.index++;continue}else{var d=this.ch+this.peek(),e=d+this.peek(2),g=Ma[this.ch],f=Ma[d],h=Ma[e];h?(this.tokens.push({index:this.index,text:e,fn:h}),this.index+=3):f?(this.tokens.push({index:this.index,text:d,fn:f}),this.index+=2):g?(this.tokens.push({index:this.index,
text:this.ch,fn:g,json:this.was("[,:")&&this.is("+-")}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(a){return-1!==a.indexOf(this.ch)},was:function(a){return-1!==a.indexOf(this.lastCh)},peek:function(a){a=a||1;return this.index+a<this.text.length?this.text.charAt(this.index+a):!1},isNumber:function(a){return"0"<=a&&"9">=a},isWhitespace:function(a){return" "===a||"\r"===a||"\t"===a||"\n"===a||"\v"===a||"\u00a0"===
a},isIdent:function(a){return"a"<=a&&"z">=a||"A"<=a&&"Z">=a||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,c,d){d=d||this.index;c=B(c)?"s "+c+"-"+this.index+" ["+this.text.substring(c,d)+"]":" "+d;throw Ba("lexerr",a,c,this.text);},readNumber:function(){for(var a="",c=this.index;this.index<this.text.length;){var d=K(this.text.charAt(this.index));if("."==d||this.isNumber(d))a+=d;else{var e=this.peek();if("e"==d&&this.isExpOperator(e))a+=
d;else if(this.isExpOperator(d)&&e&&this.isNumber(e)&&"e"==a.charAt(a.length-1))a+=d;else if(!this.isExpOperator(d)||e&&this.isNumber(e)||"e"!=a.charAt(a.length-1))break;else this.throwError("Invalid exponent")}this.index++}a*=1;this.tokens.push({index:c,text:a,json:!0,fn:function(){return a}})},readIdent:function(){for(var a=this,c="",d=this.index,e,g,f,h;this.index<this.text.length;){h=this.text.charAt(this.index);if("."===h||this.isIdent(h)||this.isNumber(h))"."===h&&(e=this.index),c+=h;else break;
this.index++}if(e)for(g=this.index;g<this.text.length;){h=this.text.charAt(g);if("("===h){f=c.substr(e-d+1);c=c.substr(0,e-d);this.index=g;break}if(this.isWhitespace(h))g++;else break}d={index:d,text:c};if(Ma.hasOwnProperty(c))d.fn=Ma[c],d.json=Ma[c];else{var l=Dc(c,this.options,this.text);d.fn=D(function(a,c){return l(a,c)},{assign:function(d,e){return ob(d,c,e,a.text,a.options)}})}this.tokens.push(d);f&&(this.tokens.push({index:e,text:".",json:!1}),this.tokens.push({index:e+1,text:f,json:!1}))},
readString:function(a){var c=this.index;this.index++;for(var d="",e=a,g=!1;this.index<this.text.length;){var f=this.text.charAt(this.index),e=e+f;if(g)"u"===f?(f=this.text.substring(this.index+1,this.index+5),f.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+f+"]"),this.index+=4,d+=String.fromCharCode(parseInt(f,16))):d=(g=Ne[f])?d+g:d+f,g=!1;else if("\\"===f)g=!0;else{if(f===a){this.index++;this.tokens.push({index:c,text:e,string:d,json:!0,fn:function(){return d}});return}d+=
f}this.index++}this.throwError("Unterminated quote",c)}};var $a=function(a,c,d){this.lexer=a;this.$filter=c;this.options=d};$a.ZERO=D(function(){return 0},{constant:!0});$a.prototype={constructor:$a,parse:function(a,c){this.text=a;this.json=c;this.tokens=this.lexer.lex(a);c&&(this.assignment=this.logicalOR,this.functionCall=this.fieldAccess=this.objectIndex=this.filterChain=function(){this.throwError("is not valid json",{text:a,index:0})});var d=c?this.primary():this.statements();0!==this.tokens.length&&
this.throwError("is an unexpected token",this.tokens[0]);d.literal=!!d.literal;d.constant=!!d.constant;return d},primary:function(){var a;if(this.expect("("))a=this.filterChain(),this.consume(")");else if(this.expect("["))a=this.arrayDeclaration();else if(this.expect("{"))a=this.object();else{var c=this.expect();(a=c.fn)||this.throwError("not a primary expression",c);c.json&&(a.constant=!0,a.literal=!0)}for(var d;c=this.expect("(","[",".");)"("===c.text?(a=this.functionCall(a,d),d=null):"["===c.text?
(d=a,a=this.objectIndex(a)):"."===c.text?(d=a,a=this.fieldAccess(a)):this.throwError("IMPOSSIBLE");return a},throwError:function(a,c){throw Ba("syntax",c.text,a,c.index+1,this.text,this.text.substring(c.index));},peekToken:function(){if(0===this.tokens.length)throw Ba("ueoe",this.text);return this.tokens[0]},peek:function(a,c,d,e){if(0<this.tokens.length){var g=this.tokens[0],f=g.text;if(f===a||f===c||f===d||f===e||!(a||c||d||e))return g}return!1},expect:function(a,c,d,e){return(a=this.peek(a,c,d,
e))?(this.json&&!a.json&&this.throwError("is not valid json",a),this.tokens.shift(),a):!1},consume:function(a){this.expect(a)||this.throwError("is unexpected, expecting ["+a+"]",this.peek())},unaryFn:function(a,c){return D(function(d,e){return a(d,e,c)},{constant:c.constant})},ternaryFn:function(a,c,d){return D(function(e,g){return a(e,g)?c(e,g):d(e,g)},{constant:a.constant&&c.constant&&d.constant})},binaryFn:function(a,c,d){return D(function(e,g){return c(e,g,a,d)},{constant:a.constant&&d.constant})},
statements:function(){for(var a=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&a.push(this.filterChain()),!this.expect(";"))return 1===a.length?a[0]:function(c,d){for(var e,g=0;g<a.length;g++){var f=a[g];f&&(e=f(c,d))}return e}},filterChain:function(){for(var a=this.expression(),c;;)if(c=this.expect("|"))a=this.binaryFn(a,c.fn,this.filter());else return a},filter:function(){for(var a=this.expect(),c=this.$filter(a.text),d=[];;)if(a=this.expect(":"))d.push(this.expression());else{var e=
function(a,e,h){h=[h];for(var l=0;l<d.length;l++)h.push(d[l](a,e));return c.apply(a,h)};return function(){return e}}},expression:function(){return this.assignment()},assignment:function(){var a=this.ternary(),c,d;return(d=this.expect("="))?(a.assign||this.throwError("implies assignment but ["+this.text.substring(0,d.index)+"] can not be assigned to",d),c=this.ternary(),function(d,g){return a.assign(d,c(d,g),g)}):a},ternary:function(){var a=this.logicalOR(),c,d;if(this.expect("?")){c=this.ternary();
if(d=this.expect(":"))return this.ternaryFn(a,c,this.ternary());this.throwError("expected :",d)}else return a},logicalOR:function(){for(var a=this.logicalAND(),c;;)if(c=this.expect("||"))a=this.binaryFn(a,c.fn,this.logicalAND());else return a},logicalAND:function(){var a=this.equality(),c;if(c=this.expect("&&"))a=this.binaryFn(a,c.fn,this.logicalAND());return a},equality:function(){var a=this.relational(),c;if(c=this.expect("==","!=","===","!=="))a=this.binaryFn(a,c.fn,this.equality());return a},
relational:function(){var a=this.additive(),c;if(c=this.expect("<",">","<=",">="))a=this.binaryFn(a,c.fn,this.relational());return a},additive:function(){for(var a=this.multiplicative(),c;c=this.expect("+","-");)a=this.binaryFn(a,c.fn,this.multiplicative());return a},multiplicative:function(){for(var a=this.unary(),c;c=this.expect("*","/","%");)a=this.binaryFn(a,c.fn,this.unary());return a},unary:function(){var a;return this.expect("+")?this.primary():(a=this.expect("-"))?this.binaryFn($a.ZERO,a.fn,
this.unary()):(a=this.expect("!"))?this.unaryFn(a.fn,this.unary()):this.primary()},fieldAccess:function(a){var c=this,d=this.expect().text,e=Dc(d,this.options,this.text);return D(function(c,d,h){return e(h||a(c,d))},{assign:function(e,f,h){return ob(a(e,h),d,f,c.text,c.options)}})},objectIndex:function(a){var c=this,d=this.expression();this.consume("]");return D(function(e,g){var f=a(e,g),h=d(e,g),l;if(!f)return s;(f=Za(f[h],c.text))&&(f.then&&c.options.unwrapPromises)&&(l=f,"$$v"in f||(l.$$v=s,l.then(function(a){l.$$v=
a})),f=f.$$v);return f},{assign:function(e,g,f){var h=d(e,f);return Za(a(e,f),c.text)[h]=g}})},functionCall:function(a,c){var d=[];if(")"!==this.peekToken().text){do d.push(this.expression());while(this.expect(","))}this.consume(")");var e=this;return function(g,f){for(var h=[],l=c?c(g,f):g,k=0;k<d.length;k++)h.push(d[k](g,f));k=a(g,f,l)||C;Za(l,e.text);Za(k,e.text);h=k.apply?k.apply(l,h):k(h[0],h[1],h[2],h[3],h[4]);return Za(h,e.text)}},arrayDeclaration:function(){var a=[],c=!0;if("]"!==this.peekToken().text){do{if(this.peek("]"))break;
var d=this.expression();a.push(d);d.constant||(c=!1)}while(this.expect(","))}this.consume("]");return D(function(c,d){for(var f=[],h=0;h<a.length;h++)f.push(a[h](c,d));return f},{literal:!0,constant:c})},object:function(){var a=[],c=!0;if("}"!==this.peekToken().text){do{if(this.peek("}"))break;var d=this.expect(),d=d.string||d.text;this.consume(":");var e=this.expression();a.push({key:d,value:e});e.constant||(c=!1)}while(this.expect(","))}this.consume("}");return D(function(c,d){for(var e={},l=0;l<
a.length;l++){var k=a[l];e[k.key]=k.value(c,d)}return e},{literal:!0,constant:c})}};var Mb={},ua=t("$sce"),ga={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},W=U.createElement("a"),Hc=sa(O.location.href,!0);gc.$inject=["$provide"];Ic.$inject=["$locale"];Kc.$inject=["$locale"];var Nc=".",Ie={yyyy:$("FullYear",4),yy:$("FullYear",2,0,!0),y:$("FullYear",1),MMMM:pb("Month"),MMM:pb("Month",!0),MM:$("Month",2,1),M:$("Month",1,1),dd:$("Date",2),d:$("Date",1),HH:$("Hours",2),H:$("Hours",
1),hh:$("Hours",2,-12),h:$("Hours",1,-12),mm:$("Minutes",2),m:$("Minutes",1),ss:$("Seconds",2),s:$("Seconds",1),sss:$("Milliseconds",3),EEEE:pb("Day"),EEE:pb("Day",!0),a:function(a,c){return 12>a.getHours()?c.AMPMS[0]:c.AMPMS[1]},Z:function(a){a=-1*a.getTimezoneOffset();return a=(0<=a?"+":"")+(Ob(Math[0<a?"floor":"ceil"](a/60),2)+Ob(Math.abs(a%60),2))}},He=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,Ge=/^\-?\d+$/;Jc.$inject=["$locale"];var Ee=aa(K),Fe=aa(Fa);Lc.$inject=
["$parse"];var cd=aa({restrict:"E",compile:function(a,c){8>=S&&(c.href||c.name||c.$set("href",""),a.append(U.createComment("IE fix")));if(!c.href&&!c.xlinkHref&&!c.name)return function(a,c){var g="[object SVGAnimatedString]"===wa.call(c.prop("href"))?"xlink:href":"href";c.on("click",function(a){c.attr(g)||a.preventDefault()})}}}),zb={};q(kb,function(a,c){if("multiple"!=a){var d=na("ng-"+c);zb[d]=function(){return{priority:100,link:function(a,g,f){a.$watch(f[d],function(a){f.$set(c,!!a)})}}}}});q(["src",
"srcset","href"],function(a){var c=na("ng-"+a);zb[c]=function(){return{priority:99,link:function(d,e,g){var f=a,h=a;"href"===a&&"[object SVGAnimatedString]"===wa.call(e.prop("href"))&&(h="xlinkHref",g.$attr[h]="xlink:href",f=null);g.$observe(c,function(a){a&&(g.$set(h,a),S&&f&&e.prop(f,g[h]))})}}}});var sb={$addControl:C,$removeControl:C,$setValidity:C,$setDirty:C,$setPristine:C};Oc.$inject=["$element","$attrs","$scope","$animate"];var Qc=function(a){return["$timeout",function(c){return{name:"form",
restrict:a?"EAC":"E",controller:Oc,compile:function(){return{pre:function(a,e,g,f){if(!g.action){var h=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};Pc(e[0],"submit",h);e.on("$destroy",function(){c(function(){Fb(e[0],"submit",h)},0,!1)})}var l=e.parent().controller("form"),k=g.name||g.ngForm;k&&ob(a,k,f,k);if(l)e.on("$destroy",function(){l.$removeControl(f);k&&ob(a,k,s,k);D(f,sb)})}}}}}]},dd=Qc(),qd=Qc(!0),Oe=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,
Pe=/^[a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9-]+(\.[a-z0-9-]+)*$/i,Qe=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,Rc={text:ub,number:function(a,c,d,e,g,f){ub(a,c,d,e,g,f);e.$parsers.push(function(a){var c=e.$isEmpty(a);if(c||Qe.test(a))return e.$setValidity("number",!0),""===a?null:c?a:parseFloat(a);e.$setValidity("number",!1);return s});Je(e,"number",c);e.$formatters.push(function(a){return e.$isEmpty(a)?"":""+a});d.min&&(a=function(a){var c=parseFloat(d.min);return pa(e,"min",e.$isEmpty(a)||a>=c,a)},e.$parsers.push(a),
e.$formatters.push(a));d.max&&(a=function(a){var c=parseFloat(d.max);return pa(e,"max",e.$isEmpty(a)||a<=c,a)},e.$parsers.push(a),e.$formatters.push(a));e.$formatters.push(function(a){return pa(e,"number",e.$isEmpty(a)||vb(a),a)})},url:function(a,c,d,e,g,f){ub(a,c,d,e,g,f);a=function(a){return pa(e,"url",e.$isEmpty(a)||Oe.test(a),a)};e.$formatters.push(a);e.$parsers.push(a)},email:function(a,c,d,e,g,f){ub(a,c,d,e,g,f);a=function(a){return pa(e,"email",e.$isEmpty(a)||Pe.test(a),a)};e.$formatters.push(a);
e.$parsers.push(a)},radio:function(a,c,d,e){E(d.name)&&c.attr("name",bb());c.on("click",function(){c[0].checked&&a.$apply(function(){e.$setViewValue(d.value)})});e.$render=function(){c[0].checked=d.value==e.$viewValue};d.$observe("value",e.$render)},checkbox:function(a,c,d,e){var g=d.ngTrueValue,f=d.ngFalseValue;w(g)||(g=!0);w(f)||(f=!1);c.on("click",function(){a.$apply(function(){e.$setViewValue(c[0].checked)})});e.$render=function(){c[0].checked=e.$viewValue};e.$isEmpty=function(a){return a!==g};
e.$formatters.push(function(a){return a===g});e.$parsers.push(function(a){return a?g:f})},hidden:C,button:C,submit:C,reset:C,file:C},dc=["$browser","$sniffer",function(a,c){return{restrict:"E",require:"?ngModel",link:function(d,e,g,f){f&&(Rc[K(g.type)]||Rc.text)(d,e,g,f,c,a)}}}],rb="ng-valid",qb="ng-invalid",La="ng-pristine",tb="ng-dirty",Re=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate",function(a,c,d,e,g,f){function h(a,c){c=c?"-"+fb(c,"-"):"";f.removeClass(e,(a?qb:rb)+c);
f.addClass(e,(a?rb:qb)+c)}this.$modelValue=this.$viewValue=Number.NaN;this.$parsers=[];this.$formatters=[];this.$viewChangeListeners=[];this.$pristine=!0;this.$dirty=!1;this.$valid=!0;this.$invalid=!1;this.$name=d.name;var l=g(d.ngModel),k=l.assign;if(!k)throw t("ngModel")("nonassign",d.ngModel,ha(e));this.$render=C;this.$isEmpty=function(a){return E(a)||""===a||null===a||a!==a};var m=e.inheritedData("$formController")||sb,n=0,p=this.$error={};e.addClass(La);h(!0);this.$setValidity=function(a,c){p[a]!==
!c&&(c?(p[a]&&n--,n||(h(!0),this.$valid=!0,this.$invalid=!1)):(h(!1),this.$invalid=!0,this.$valid=!1,n++),p[a]=!c,h(c,a),m.$setValidity(a,c,this))};this.$setPristine=function(){this.$dirty=!1;this.$pristine=!0;f.removeClass(e,tb);f.addClass(e,La)};this.$setViewValue=function(d){this.$viewValue=d;this.$pristine&&(this.$dirty=!0,this.$pristine=!1,f.removeClass(e,La),f.addClass(e,tb),m.$setDirty());q(this.$parsers,function(a){d=a(d)});this.$modelValue!==d&&(this.$modelValue=d,k(a,d),q(this.$viewChangeListeners,
function(a){try{a()}catch(d){c(d)}}))};var r=this;a.$watch(function(){var c=l(a);if(r.$modelValue!==c){var d=r.$formatters,e=d.length;for(r.$modelValue=c;e--;)c=d[e](c);r.$viewValue!==c&&(r.$viewValue=c,r.$render())}return c})}],Fd=function(){return{require:["ngModel","^?form"],controller:Re,link:function(a,c,d,e){var g=e[0],f=e[1]||sb;f.$addControl(g);a.$on("$destroy",function(){f.$removeControl(g)})}}},Hd=aa({require:"ngModel",link:function(a,c,d,e){e.$viewChangeListeners.push(function(){a.$eval(d.ngChange)})}}),
ec=function(){return{require:"?ngModel",link:function(a,c,d,e){if(e){d.required=!0;var g=function(a){if(d.required&&e.$isEmpty(a))e.$setValidity("required",!1);else return e.$setValidity("required",!0),a};e.$formatters.push(g);e.$parsers.unshift(g);d.$observe("required",function(){g(e.$viewValue)})}}}},Gd=function(){return{require:"ngModel",link:function(a,c,d,e){var g=(a=/\/(.*)\//.exec(d.ngList))&&RegExp(a[1])||d.ngList||",";e.$parsers.push(function(a){if(!E(a)){var c=[];a&&q(a.split(g),function(a){a&&
c.push(ca(a))});return c}});e.$formatters.push(function(a){return M(a)?a.join(", "):s});e.$isEmpty=function(a){return!a||!a.length}}}},Se=/^(true|false|\d+)$/,Id=function(){return{priority:100,compile:function(a,c){return Se.test(c.ngValue)?function(a,c,g){g.$set("value",a.$eval(g.ngValue))}:function(a,c,g){a.$watch(g.ngValue,function(a){g.$set("value",a)})}}}},id=va(function(a,c,d){c.addClass("ng-binding").data("$binding",d.ngBind);a.$watch(d.ngBind,function(a){c.text(a==s?"":a)})}),kd=["$interpolate",
function(a){return function(c,d,e){c=a(d.attr(e.$attr.ngBindTemplate));d.addClass("ng-binding").data("$binding",c);e.$observe("ngBindTemplate",function(a){d.text(a)})}}],jd=["$sce","$parse",function(a,c){return function(d,e,g){e.addClass("ng-binding").data("$binding",g.ngBindHtml);var f=c(g.ngBindHtml);d.$watch(function(){return(f(d)||"").toString()},function(c){e.html(a.getTrustedHtml(f(d))||"")})}}],ld=Pb("",!0),nd=Pb("Odd",0),md=Pb("Even",1),od=va({compile:function(a,c){c.$set("ngCloak",s);a.removeClass("ng-cloak")}}),
pd=[function(){return{scope:!0,controller:"@",priority:500}}],fc={};q("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(a){var c=na("ng-"+a);fc[c]=["$parse",function(d){return{compile:function(e,g){var f=d(g[c]);return function(c,d,e){d.on(K(a),function(a){c.$apply(function(){f(c,{$event:a})})})}}}}]});var sd=["$animate",function(a){return{transclude:"element",priority:600,terminal:!0,restrict:"A",
$$tlb:!0,link:function(c,d,e,g,f){var h,l,k;c.$watch(e.ngIf,function(g){Qa(g)?l||(l=c.$new(),f(l,function(c){c[c.length++]=U.createComment(" end ngIf: "+e.ngIf+" ");h={clone:c};a.enter(c,d.parent(),d)})):(k&&(k.remove(),k=null),l&&(l.$destroy(),l=null),h&&(k=yb(h.clone),a.leave(k,function(){k=null}),h=null))})}}}],td=["$http","$templateCache","$anchorScroll","$animate","$sce",function(a,c,d,e,g){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:Ea.noop,compile:function(f,
h){var l=h.ngInclude||h.src,k=h.onload||"",m=h.autoscroll;return function(f,h,q,s,u){var F=0,v,y,A,x=function(){y&&(y.remove(),y=null);v&&(v.$destroy(),v=null);A&&(e.leave(A,function(){y=null}),y=A,A=null)};f.$watch(g.parseAsResourceUrl(l),function(g){var l=function(){!B(m)||m&&!f.$eval(m)||d()},q=++F;g?(a.get(g,{cache:c}).success(function(a){if(q===F){var c=f.$new();s.template=a;a=u(c,function(a){x();e.enter(a,null,h,l)});v=c;A=a;v.$emit("$includeContentLoaded");f.$eval(k)}}).error(function(){q===
F&&x()}),f.$emit("$includeContentRequested")):(x(),s.template=null)})}}}}],Jd=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(c,d,e,g){d.html(g.template);a(d.contents())(c)}}}],ud=va({priority:450,compile:function(){return{pre:function(a,c,d){a.$eval(d.ngInit)}}}}),vd=va({terminal:!0,priority:1E3}),wd=["$locale","$interpolate",function(a,c){var d=/{}/g;return{restrict:"EA",link:function(e,g,f){var h=f.count,l=f.$attr.when&&g.attr(f.$attr.when),k=f.offset||
0,m=e.$eval(l)||{},n={},p=c.startSymbol(),r=c.endSymbol(),s=/^when(Minus)?(.+)$/;q(f,function(a,c){s.test(c)&&(m[K(c.replace("when","").replace("Minus","-"))]=g.attr(f.$attr[c]))});q(m,function(a,e){n[e]=c(a.replace(d,p+h+"-"+k+r))});e.$watch(function(){var c=parseFloat(e.$eval(h));if(isNaN(c))return"";c in m||(c=a.pluralCat(c-k));return n[c](e,g,!0)},function(a){g.text(a)})}}}],xd=["$parse","$animate",function(a,c){var d=t("ngRepeat");return{transclude:"element",priority:1E3,terminal:!0,$$tlb:!0,
link:function(e,g,f,h,l){var k=f.ngRepeat,m=k.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),n,p,r,s,u,F,v={$id:Ia};if(!m)throw d("iexp",k);f=m[1];h=m[2];(m=m[3])?(n=a(m),p=function(a,c,d){F&&(v[F]=a);v[u]=c;v.$index=d;return n(e,v)}):(r=function(a,c){return Ia(c)},s=function(a){return a});m=f.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/);if(!m)throw d("iidexp",f);u=m[3]||m[1];F=m[2];var B={};e.$watchCollection(h,function(a){var f,h,m=g[0],n,v={},H,R,w,C,T,t,
E=[];if(ab(a))T=a,n=p||r;else{n=p||s;T=[];for(w in a)a.hasOwnProperty(w)&&"$"!=w.charAt(0)&&T.push(w);T.sort()}H=T.length;h=E.length=T.length;for(f=0;f<h;f++)if(w=a===T?f:T[f],C=a[w],C=n(w,C,f),Aa(C,"`track by` id"),B.hasOwnProperty(C))t=B[C],delete B[C],v[C]=t,E[f]=t;else{if(v.hasOwnProperty(C))throw q(E,function(a){a&&a.scope&&(B[a.id]=a)}),d("dupes",k,C);E[f]={id:C};v[C]=!1}for(w in B)B.hasOwnProperty(w)&&(t=B[w],f=yb(t.clone),c.leave(f),q(f,function(a){a.$$NG_REMOVED=!0}),t.scope.$destroy());
f=0;for(h=T.length;f<h;f++){w=a===T?f:T[f];C=a[w];t=E[f];E[f-1]&&(m=E[f-1].clone[E[f-1].clone.length-1]);if(t.scope){R=t.scope;n=m;do n=n.nextSibling;while(n&&n.$$NG_REMOVED);t.clone[0]!=n&&c.move(yb(t.clone),null,y(m));m=t.clone[t.clone.length-1]}else R=e.$new();R[u]=C;F&&(R[F]=w);R.$index=f;R.$first=0===f;R.$last=f===H-1;R.$middle=!(R.$first||R.$last);R.$odd=!(R.$even=0===(f&1));t.scope||l(R,function(a){a[a.length++]=U.createComment(" end ngRepeat: "+k+" ");c.enter(a,null,y(m));m=a;t.scope=R;t.clone=
a;v[t.id]=t})}B=v})}}}],yd=["$animate",function(a){return function(c,d,e){c.$watch(e.ngShow,function(c){a[Qa(c)?"removeClass":"addClass"](d,"ng-hide")})}}],rd=["$animate",function(a){return function(c,d,e){c.$watch(e.ngHide,function(c){a[Qa(c)?"addClass":"removeClass"](d,"ng-hide")})}}],zd=va(function(a,c,d){a.$watch(d.ngStyle,function(a,d){d&&a!==d&&q(d,function(a,d){c.css(d,"")});a&&c.css(a)},!0)}),Ad=["$animate",function(a){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases=
{}}],link:function(c,d,e,g){var f,h,l,k=[];c.$watch(e.ngSwitch||e.on,function(d){var n,p=k.length;if(0<p){if(l){for(n=0;n<p;n++)l[n].remove();l=null}l=[];for(n=0;n<p;n++){var r=h[n];k[n].$destroy();l[n]=r;a.leave(r,function(){l.splice(n,1);0===l.length&&(l=null)})}}h=[];k=[];if(f=g.cases["!"+d]||g.cases["?"])c.$eval(e.change),q(f,function(d){var e=c.$new();k.push(e);d.transclude(e,function(c){var e=d.element;h.push(c);a.enter(c,e.parent(),e)})})})}}}],Bd=va({transclude:"element",priority:800,require:"^ngSwitch",
link:function(a,c,d,e,g){e.cases["!"+d.ngSwitchWhen]=e.cases["!"+d.ngSwitchWhen]||[];e.cases["!"+d.ngSwitchWhen].push({transclude:g,element:c})}}),Cd=va({transclude:"element",priority:800,require:"^ngSwitch",link:function(a,c,d,e,g){e.cases["?"]=e.cases["?"]||[];e.cases["?"].push({transclude:g,element:c})}}),Ed=va({link:function(a,c,d,e,g){if(!g)throw t("ngTransclude")("orphan",ha(c));g(function(a){c.empty();c.append(a)})}}),ed=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(c,
d){"text/ng-template"==d.type&&a.put(d.id,c[0].text)}}}],Te=t("ngOptions"),Dd=aa({terminal:!0}),fd=["$compile","$parse",function(a,c){var d=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,e={$setViewValue:C};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(a,c,d){var l=this,k={},m=e,n;l.databound=
d.ngModel;l.init=function(a,c,d){m=a;n=d};l.addOption=function(c){Aa(c,'"option value"');k[c]=!0;m.$viewValue==c&&(a.val(c),n.parent()&&n.remove())};l.removeOption=function(a){this.hasOption(a)&&(delete k[a],m.$viewValue==a&&this.renderUnknownOption(a))};l.renderUnknownOption=function(c){c="? "+Ia(c)+" ?";n.val(c);a.prepend(n);a.val(c);n.prop("selected",!0)};l.hasOption=function(a){return k.hasOwnProperty(a)};c.$on("$destroy",function(){l.renderUnknownOption=C})}],link:function(e,f,h,l){function k(a,
c,d,e){d.$render=function(){var a=d.$viewValue;e.hasOption(a)?(A.parent()&&A.remove(),c.val(a),""===a&&w.prop("selected",!0)):E(a)&&w?c.val(""):e.renderUnknownOption(a)};c.on("change",function(){a.$apply(function(){A.parent()&&A.remove();d.$setViewValue(c.val())})})}function m(a,c,d){var e;d.$render=function(){var a=new Va(d.$viewValue);q(c.find("option"),function(c){c.selected=B(a.get(c.value))})};a.$watch(function(){xa(e,d.$viewValue)||(e=ba(d.$viewValue),d.$render())});c.on("change",function(){a.$apply(function(){var a=
[];q(c.find("option"),function(c){c.selected&&a.push(c.value)});d.$setViewValue(a)})})}function n(e,f,g){function h(){var a={"":[]},c=[""],d,k,s,t,z;t=g.$modelValue;z=y(e)||[];var E=n?Qb(z):z,F,I,A;I={};s=!1;var D,H;if(r)if(w&&M(t))for(s=new Va([]),A=0;A<t.length;A++)I[m]=t[A],s.put(w(e,I),t[A]);else s=new Va(t);for(A=0;F=E.length,A<F;A++){k=A;if(n){k=E[A];if("$"===k.charAt(0))continue;I[n]=k}I[m]=z[k];d=p(e,I)||"";(k=a[d])||(k=a[d]=[],c.push(d));r?d=B(s.remove(w?w(e,I):q(e,I))):(w?(d={},d[m]=t,d=
w(e,d)===w(e,I)):d=t===q(e,I),s=s||d);D=l(e,I);D=B(D)?D:"";k.push({id:w?w(e,I):n?E[A]:A,label:D,selected:d})}r||(u||null===t?a[""].unshift({id:"",label:"",selected:!s}):s||a[""].unshift({id:"?",label:"",selected:!0}));I=0;for(E=c.length;I<E;I++){d=c[I];k=a[d];x.length<=I?(t={element:C.clone().attr("label",d),label:k.label},z=[t],x.push(z),f.append(t.element)):(z=x[I],t=z[0],t.label!=d&&t.element.attr("label",t.label=d));D=null;A=0;for(F=k.length;A<F;A++)s=k[A],(d=z[A+1])?(D=d.element,d.label!==s.label&&
D.text(d.label=s.label),d.id!==s.id&&D.val(d.id=s.id),d.selected!==s.selected&&D.prop("selected",d.selected=s.selected)):(""===s.id&&u?H=u:(H=v.clone()).val(s.id).attr("selected",s.selected).text(s.label),z.push({element:H,label:s.label,id:s.id,selected:s.selected}),D?D.after(H):t.element.append(H),D=H);for(A++;z.length>A;)z.pop().element.remove()}for(;x.length>I;)x.pop()[0].element.remove()}var k;if(!(k=t.match(d)))throw Te("iexp",t,ha(f));var l=c(k[2]||k[1]),m=k[4]||k[6],n=k[5],p=c(k[3]||""),q=
c(k[2]?k[1]:m),y=c(k[7]),w=k[8]?c(k[8]):null,x=[[{element:f,label:""}]];u&&(a(u)(e),u.removeClass("ng-scope"),u.remove());f.empty();f.on("change",function(){e.$apply(function(){var a,c=y(e)||[],d={},h,k,l,p,t,v,u;if(r)for(k=[],p=0,v=x.length;p<v;p++)for(a=x[p],l=1,t=a.length;l<t;l++){if((h=a[l].element)[0].selected){h=h.val();n&&(d[n]=h);if(w)for(u=0;u<c.length&&(d[m]=c[u],w(e,d)!=h);u++);else d[m]=c[h];k.push(q(e,d))}}else{h=f.val();if("?"==h)k=s;else if(""===h)k=null;else if(w)for(u=0;u<c.length;u++){if(d[m]=
c[u],w(e,d)==h){k=q(e,d);break}}else d[m]=c[h],n&&(d[n]=h),k=q(e,d);1<x[0].length&&x[0][1].id!==h&&(x[0][1].selected=!1)}g.$setViewValue(k)})});g.$render=h;e.$watch(h)}if(l[1]){var p=l[0];l=l[1];var r=h.multiple,t=h.ngOptions,u=!1,w,v=y(U.createElement("option")),C=y(U.createElement("optgroup")),A=v.clone();h=0;for(var x=f.children(),D=x.length;h<D;h++)if(""===x[h].value){w=u=x.eq(h);break}p.init(l,u,A);r&&(l.$isEmpty=function(a){return!a||0===a.length});t?n(e,f,l):r?m(e,f,l):k(e,f,l,p)}}}}],hd=["$interpolate",
function(a){var c={addOption:C,removeOption:C};return{restrict:"E",priority:100,compile:function(d,e){if(E(e.value)){var g=a(d.text(),!0);g||e.$set("value",d.text())}return function(a,d,e){var k=d.parent(),m=k.data("$selectController")||k.parent().data("$selectController");m&&m.databound?d.prop("selected",!1):m=c;g?a.$watch(g,function(a,c){e.$set("value",a);a!==c&&m.removeOption(c);m.addOption(a)}):m.addOption(e.value);d.on("$destroy",function(){m.removeOption(e.value)})}}}}],gd=aa({restrict:"E",
terminal:!0});O.angular.bootstrap?console.log("WARNING: Tried to load angular more than once."):((Ga=O.jQuery)?(y=Ga,D(Ga.fn,{scope:Ja.scope,isolateScope:Ja.isolateScope,controller:Ja.controller,injector:Ja.injector,inheritedData:Ja.inheritedData}),Ab("remove",!0,!0,!1),Ab("empty",!1,!1,!1),Ab("html",!1,!1,!0)):y=N,Ea.element=y,Zc(Ea),y(U).ready(function(){Wc(U,$b)}))})(window,document);!angular.$$csp()&&angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}</style>');


},{}],4:[function(require,module,exports){
require("./angular/angular.min.js");
require("angular-animate");
require("./libs/ui-bootstrap-tpls-0.11.2.min.js");
require("./libs/angular-translate.js");
require("./libs/angular-translate-loader-static-files.js");
require("./libs/promise-tracker.js");
require("./libs/promise-tracker-http-interceptor.js");
require("./multiselect/multiselect.js");
require("./navigation-blocker/navigation-blocker.js");
require("./language-changer/language-changer.js");
require("./tabs/form-tabs.js");
require("./utils/utils.js");
require("./error-mapper/error-mapper.js");
require("./angular-elastic/elastic.js");
require("./order-object-by/ng-order-object-by.js");
require("./notification/notification.js");
require("./libs/ui-handsontable.js");
require("./libs/numeral.de-de.js");
require("./angular-app.js");
},{"./angular-app.js":1,"./angular-elastic/elastic.js":2,"./angular/angular.min.js":3,"./error-mapper/error-mapper.js":5,"./language-changer/language-changer.js":6,"./libs/angular-translate-loader-static-files.js":7,"./libs/angular-translate.js":8,"./libs/numeral.de-de.js":9,"./libs/promise-tracker-http-interceptor.js":10,"./libs/promise-tracker.js":11,"./libs/ui-bootstrap-tpls-0.11.2.min.js":12,"./libs/ui-handsontable.js":13,"./multiselect/multiselect.js":14,"./navigation-blocker/navigation-blocker.js":15,"./notification/notification.js":16,"./order-object-by/ng-order-object-by.js":17,"./tabs/form-tabs.js":18,"./utils/utils.js":19,"angular-animate":20}],5:[function(require,module,exports){
/**
 * Created by argoaava on 13.05.14.
 */

angular.module('ui.errorMapper', [])
    .service('errorMapperService', function() {
        this.errorMappings = {
            "required" : "This is a required field",
            "pattern_decimal" : "Please provide a number greater than 0",
            "pattern_integer" : "Please provide a whole number greater than 0",
            "pattern_telephone" : "Please enter a valid telephone number (at least 7 digits)",
            "pattern_email" : "Please enter a valid email address",
            "pattern_url" : "Please enter a valid URL",
            "pattern_longitude" : "Please enter number between -180 and 180 ",
            "pattern_latitude" : "Please enter number between -90 and 90"};

        this.getErrorMappings = function() {
            return this.errorMappings;
        }

        this.addErrorMapping = function(key, message) {
            this.errorMappings[key] = message;
        }

        this.setErrorMappings = function(errorMappings) {
            this.errorMappings = errorMappings;
        }
    })
    .controller("ErrorController", function ($scope, errorMapperService) {

        $scope.errorMappings = errorMapperService.getErrorMappings();
        $scope.showCurrentError = false;

        $scope.getErrorMessage = function(errorCode) {
            return $scope.errorMappings[errorCode];
        };

        $scope.getController = function(attributes) {
            if (!attributes.watchView) {
                return null;
            }
            var tokens = attributes.watchView.split(".");
            var result = $scope;
            while(tokens.length) {
                result = result[tokens.shift()];
                if (!result) {
                    return null;
                }
            }
            return result;
        };

        $scope.parseErrors = function(ctrl, attributes) {
            var fieldNameIdentifier = !attributes.watchView? attributes.errorMapper : attributes.watchView;
            var nameTokens = fieldNameIdentifier.split('.');
            var name = nameTokens[1];

            var fieldController = !ctrl[name]? $scope.getController(attributes) : ctrl[name];
            if (!fieldController) {
                if (!attributes.radioButtonValues) {
                    throw Error("input field controller not found for " + attributes.errorMapper);
                } else {
                    var radioButtonValues = JSON.parse(attributes.radioButtonValues);
                    $scope.showCurrentError = !radioButtonValues.value && $scope.submitted && radioButtonValues.required;
                    $scope.currentErrorCode = 'required';
                    return;
                }
            }

            var controllerErrors = fieldController.$error;
            if ( !attributes.errorsToShow) return;
            var errorsToShowAsArray = JSON.parse(attributes.errorsToShow);

            for (var i = 0; i < errorsToShowAsArray.length; i++) {
                var splitErrorString = errorsToShowAsArray[i].split('_');
                var strippedErrorString = splitErrorString[0];
                if (controllerErrors[strippedErrorString]) {
                    $scope.showCurrentError = $scope.showError(fieldController, strippedErrorString);
                    $scope.currentErrorCode = errorsToShowAsArray[i];
                    break;
                } else {
                    $scope.showCurrentError = false;
                }
            }
        }

        $scope.showError = function(modelController, errorCode) {
            return ($scope.submitted || modelController.$dirty) && modelController.$error[errorCode] && modelController.$invalid;
        };
    })

    // Error mapper directive to simplify showing errors for input fields and get rid of some
    // boilerplate code.
    //
    // Usage:
    //
    // <input name="Money" ng-model="instance.MMRArticle17Questionnaire.Table1.Money" type="text"
    //      ng-pattern="decimalNumberPattern" required/>
    // <div class="invalid-msg" td-error-mapper watch-elements='["Table1.OtherDescription"]'
    //      watch-view="Form.InputName" errors-to-show='["required", "pattern_decimal"]'></div>
    // ...
    // Where <div> with 'td-error-mapper' attribute is used as error div and all functionality is applied.
    //
    // Configuration parameters:
    // td-error-mapper - identifier for error mapper and scope parameter watcher e.g td-error-mapper="userName". Whenever
    //                   $scope.userName changes it is picked up by mapper and correct error is shown when identified.
    // watch-view      - Used to watch view value of the field. Useful for watching number fields etc. when actual scope
    //                   value does not change on invalid field value.
    //                   Should be used as {FormName}.{InputName} so InputName can be extracted to get correct controller.
    // watch-elements  - Array of string that is parsed and registered for watching. Whenever 'Table1.OtherDescription'
    //                   changes then parse function is called and correct errors show for current input.
    // errors-to-show  - Errors to be shown as array. This string is parsed and errors are shown in the same order
    //                   as array. Names can be used for different kind of messages as follows e.g "pattern_decimal"
    //                   means error type is pattern and message type decimal. First part is extracted used together with
    //                   angular ng-pattern directive to get correct result.
    .directive('errorMapper',function () {
        return {
            restrict: 'A',
            require: '?^form',
            scope: true,
            controller: 'ErrorController',
            template: '<span ng-show=\"showCurrentError\">{{getErrorMessage(currentErrorCode)}}</span>',
            link: function(scope, element, attrs, ctrl) {
                if (!attrs.watchView) {
                    scope.$watch(attrs.errorMapper, function() {
                        scope.parseErrors(ctrl, attrs);
                    });
                } else {
                    scope.$watch(attrs.watchView + ".$viewValue", function() {
                        scope.parseErrors(ctrl, attrs);
                    });
                }

                scope.$watch('submitted', function() {
                    scope.parseErrors(ctrl, attrs);
                });

                //For watching other values that this error depends on
                if (attrs.watchElements) {
                    var watchArray = JSON.parse(attrs.watchElements);
                    for (var i = 0; i < watchArray.length; i++) {
                        scope.$watch(watchArray[i] + ".$viewValue", function() {
                            scope.parseErrors(ctrl, attrs);
                        });
                    }
                }

            }
        }
    })
},{}],6:[function(require,module,exports){
/**
 * Created by argoaava on 22.04.14.
 */

// Module that provides language changing functionality to webform.
//
// Module needs configuration and <div td-language-changer></div> or <td-language-changer/> tags.
// td-language-changer component is replaced with language select input that is configured to use
// pre-configured values.
//
// Example configuration of languageChanger
//
// app.config(["languageChangerProvider", function(languageChangerProvider) {
//    languageChangerProvider.setDefaultLanguage('en');
//    languageChangerProvider.setLanguageFilePrefix('en-labels-');
//    languageChangerProvider.setAvailableLanguages({"item" :[{
//        "code": "bg",
//        "label": "Български (bg)"}, {
//        "code": "cs",
//        "label": "čeština (cs)"}, {
//        "code": "hr",
//        "label": "Hrvatski (hr)"}, {
//        "code": "da",
//        "label": "Dansk (da)"}, {
//        "code": "nl",
//        "label": "Nederlands (nl)"}, {
//        "code": "el",
//        "label": "ελληνικά (el)"}, {
//        "code": "en",
//        "label": "English (en)"}, {
//        "code": "et",
//        "label": "Eesti (et)"}, {
//        "code": "fi",
//        "label": "Suomi (fi)"}, {
//        "code": "fr",
//        "label": "Français (fr)"}, {
//        "code": "de",
//        "label": "Deutsch (de)"}, {
//        "code": "hu",
//        "label": "Magyar (hu)"}, {
//        "code": "is",
//        "label": "Íslenska (is)"}, {
//        "code": "it",
//        "label": "Italiano (it)"}, {
//        "code": "lv",
//        "label": "Latviešu (lv)"}, {
//        "code": "lt",
//        "label": "Lietuvių (lt)"}, {
//        "code": "mt",
//        "label": "Malti (mt)"}, {
//        "code": "no",
//        "label": "Norsk (no)"}, {
//        "code": "pl",
//        "label": "Polski (pl)"}, {
//        "code": "pt",
//        "label": "Português (pt)"}, {
//        "code": "ro",
//        "label": "Română (ro)"}, {
//        "code": "sk",
//        "label": "Slovenčina (sk)"}, {
//        "code": "sl",
//        "label": "Slovenščina (sl)"}, {
//        "code": "es",
//        "label": "Español (es)"}, {
//        "code": "sv",
//        "label": "Svenska (sv)"}, {
//        "code": "tr",
//        "label": "Türkçe (tr)"}]})
//}]);


angular.module('translate.languageChanger', ['pascalprecht.translate'])
    .factory('customLoader', function ($rootScope, $http, $q, languageChanger) {
        return function (options) {
            var deferred = $q.defer();

            if (!languageChanger.getLanguageFilePrefix()) {
                throw new Error("Language file prefix must be defined when using languageChanger component.");
            }

            var languageUrl = languageChanger.getLanguageFilePrefix() + options.key + '.xml?format=json';

            $http({
                method:'GET',
                url: languageUrl
            }, {tracker : $rootScope.loadingTracker})
                .success(function (data) {
                    deferred.resolve(data.labels);
                    //alert('label-' + options.key + '.json' +' success');
                }).error(function () {
                    deferred.reject(options.key);
                    //alert('label-' + options.key + '.json' +' error');

                });
            //alert(options.key);
            return deferred.promise;
        }
    })

    .provider('languageChanger', function languageChangerProvider() {

        this.currentLanguage = 'en';
        this.availableLanguages = [];
        this.languageFilePrefix = '';

        this.setDefaultLanguage = function(defaultLanguage) {
            this.currentLanguage = defaultLanguage;
        };

        this.setLanguageFilePrefix = function(prefix) {
            this.languageFilePrefix = prefix;
        };

        this.setAvailableLanguages = function(availableLanguages) {
            this.availableLanguages = availableLanguages;
        };

        this.$get = function() {
            var availableLanguages = this.availableLanguages;
            var currentLanguage = this.currentLanguage;
            var prefix = this.languageFilePrefix;
            return {
                getLanguage : function() {return currentLanguage;},
                setLanguage : function(newLanguage) {currentLanguage = newLanguage;},
                getAvailableLanguages : function() {return availableLanguages;},
                getLanguageFilePrefix : function() {return prefix;}
            }
        };
    })

    .config( function ($translateProvider) {
        $translateProvider.useLoader('customLoader', {});
        // load 'en' table on startup
        $translateProvider.preferredLanguage('en');
    })

    .controller('LanguageCtrl', ['$scope', '$rootScope', '$translate', 'languageChanger', 'dataRepository', function ($scope, $rootScope, $translate, languageChanger, dataRepository) {

        $scope.currentLanguage = languageChanger.getLanguage();
        $scope.availableLanguages = languageChanger.getAvailableLanguages();

        $scope.changeLang = function () {
            languageChanger.setLanguage($scope.currentLanguage)
            $translate.use(languageChanger.getLanguage());
            dataRepository.loadCodeList(languageChanger.getLanguage());
            if (languageChanger.getLanguage() != $rootScope.currentLanguage) {
                $rootScope.currentLanguage = languageChanger.getLanguage()
            }
        };
        $rootScope.$watch('currentLanguage', function(newValue, oldValue) {
            if (!newValue) {
                return;
            } else {
                if (!oldValue || (languageChanger.getLanguage() != $rootScope.currentLanguage)) {
                    $scope.currentLanguage = $rootScope.currentLanguage;
                    $scope.changeLang();
                }
            }
        })
    }])

    .directive("languageChanger", function () {
        return {
            restrict: 'A',
            controller: 'LanguageCtrl',
            template: "<div ng-show=\"availableLanguages.item.length > 0\" class=\"span2\" ng-controller=\"LanguageCtrl\" style=\"float: right;\"><select name=\"FormLanguage\" class=\"input-medium\" ng-model=\"currentLanguage\" ng-options=\"language.code as language.label for language in availableLanguages.item\" ng-change=\"changeLang()\"></select></div>"
        }
    })

},{}],7:[function(require,module,exports){
angular.module('pascalprecht.translate').factory('$translateStaticFilesLoader', [
  '$q',
  '$http',
  function ($q, $http) {
    return function (options) {
      if (!options || (!angular.isString(options.prefix) || !angular.isString(options.suffix))) {
        throw new Error('Couldn\'t load static files, no prefix or suffix specified!');
      }
      var deferred = $q.defer();
      $http({
        url: [
          options.prefix,
          options.key,
          options.suffix
        ].join(''),
        method: 'GET',
        params: ''
      }).success(function (data) {
        deferred.resolve(data);
      }).error(function (data) {
        deferred.reject(options.key);
      });
      return deferred.promise;
    };
  }
]);
},{}],8:[function(require,module,exports){
angular.module('pascalprecht.translate', ['ng']).run([
  '$translate',
  function ($translate) {
    var key = $translate.storageKey(), storage = $translate.storage();
    if (storage) {
      if (!storage.get(key)) {
        if (angular.isString($translate.preferredLanguage())) {
          $translate.use($translate.preferredLanguage());
        } else {
          storage.set(key, $translate.use());
        }
      } else {
        $translate.use(storage.get(key));
      }
    } else if (angular.isString($translate.preferredLanguage())) {
      $translate.use($translate.preferredLanguage());
    }
  }
]);
angular.module('pascalprecht.translate').provider('$translate', [
  '$STORAGE_KEY',
  function ($STORAGE_KEY) {
    var $translationTable = {}, $preferredLanguage, $availableLanguageKeys = [], $languageKeyAliases, $fallbackLanguage, $fallbackWasString, $uses, $nextLang, $storageFactory, $storageKey = $STORAGE_KEY, $storagePrefix, $missingTranslationHandlerFactory, $interpolationFactory, $interpolatorFactories = [], $interpolationSanitizationStrategy = false, $loaderFactory, $cloakClassName = 'translate-cloak', $loaderOptions, $notFoundIndicatorLeft, $notFoundIndicatorRight, $postCompilingEnabled = false, NESTED_OBJECT_DELIMITER = '.';
    var getLocale = function () {
      var nav = window.navigator;
      return (nav.language || nav.browserLanguage || nav.systemLanguage || nav.userLanguage || '').split('-').join('_');
    };
    var negotiateLocale = function (preferred) {
      var avail = [], locale = angular.lowercase(preferred), i = 0, n = $availableLanguageKeys.length;
      for (; i < n; i++) {
        avail.push(angular.lowercase($availableLanguageKeys[i]));
      }
      if (avail.indexOf(locale) > -1) {
        return locale;
      }
      if ($languageKeyAliases) {
        if ($languageKeyAliases[preferred]) {
          var alias = $languageKeyAliases[preferred];
          if (avail.indexOf(angular.lowercase(alias)) > -1) {
            return alias;
          }
        }
      }
      var parts = preferred.split('_');
      if (parts.length > 1 && avail.indexOf(angular.lowercase(parts[0])) > 1) {
        return parts[0];
      }
    };
    var translations = function (langKey, translationTable) {
      if (!langKey && !translationTable) {
        return $translationTable;
      }
      if (langKey && !translationTable) {
        if (angular.isString(langKey)) {
          return $translationTable[langKey];
        }
      } else {
        if (!angular.isObject($translationTable[langKey])) {
          $translationTable[langKey] = {};
        }
        angular.extend($translationTable[langKey], flatObject(translationTable));
      }
      return this;
    };
    this.translations = translations;
    this.cloakClassName = function (name) {
      if (!name) {
        return $cloakClassName;
      }
      $cloakClassName = name;
      return this;
    };
    var flatObject = function (data, path, result, prevKey) {
      var key, keyWithPath, keyWithShortPath, val;
      if (!path) {
        path = [];
      }
      if (!result) {
        result = {};
      }
      for (key in data) {
        if (!data.hasOwnProperty(key)) {
          continue;
        }
        val = data[key];
        if (angular.isObject(val)) {
          flatObject(val, path.concat(key), result, key);
        } else {
          keyWithPath = path.length ? '' + path.join(NESTED_OBJECT_DELIMITER) + NESTED_OBJECT_DELIMITER + key : key;
          if (path.length && key === prevKey) {
            keyWithShortPath = '' + path.join(NESTED_OBJECT_DELIMITER);
            result[keyWithShortPath] = '@:' + keyWithPath;
          }
          result[keyWithPath] = val;
        }
      }
      return result;
    };
    this.addInterpolation = function (factory) {
      $interpolatorFactories.push(factory);
      return this;
    };
    this.useMessageFormatInterpolation = function () {
      return this.useInterpolation('$translateMessageFormatInterpolation');
    };
    this.useInterpolation = function (factory) {
      $interpolationFactory = factory;
      return this;
    };
    this.useSanitizeValueStrategy = function (value) {
      $interpolationSanitizationStrategy = value;
      return this;
    };
    this.preferredLanguage = function (langKey) {
      if (langKey) {
        $preferredLanguage = langKey;
        return this;
      }
      return $preferredLanguage;
    };
    this.translationNotFoundIndicator = function (indicator) {
      this.translationNotFoundIndicatorLeft(indicator);
      this.translationNotFoundIndicatorRight(indicator);
      return this;
    };
    this.translationNotFoundIndicatorLeft = function (indicator) {
      if (!indicator) {
        return $notFoundIndicatorLeft;
      }
      $notFoundIndicatorLeft = indicator;
      return this;
    };
    this.translationNotFoundIndicatorRight = function (indicator) {
      if (!indicator) {
        return $notFoundIndicatorRight;
      }
      $notFoundIndicatorRight = indicator;
      return this;
    };
    this.fallbackLanguage = function (langKey) {
      fallbackStack(langKey);
      return this;
    };
    var fallbackStack = function (langKey) {
      if (langKey) {
        if (angular.isString(langKey)) {
          $fallbackWasString = true;
          $fallbackLanguage = [langKey];
        } else if (angular.isArray(langKey)) {
          $fallbackWasString = false;
          $fallbackLanguage = langKey;
        }
        if (angular.isString($preferredLanguage)) {
          $fallbackLanguage.push($preferredLanguage);
        }
        return this;
      } else {
        if ($fallbackWasString) {
          return $fallbackLanguage[0];
        } else {
          return $fallbackLanguage;
        }
      }
    };
    this.use = function (langKey) {
      if (langKey) {
        if (!$translationTable[langKey] && !$loaderFactory) {
          throw new Error('$translateProvider couldn\'t find translationTable for langKey: \'' + langKey + '\'');
        }
        $uses = langKey;
        return this;
      }
      return $uses;
    };
    var storageKey = function (key) {
      if (!key) {
        if ($storagePrefix) {
          return $storagePrefix + $storageKey;
        }
        return $storageKey;
      }
      $storageKey = key;
    };
    this.storageKey = storageKey;
    this.useUrlLoader = function (url) {
      return this.useLoader('$translateUrlLoader', { url: url });
    };
    this.useStaticFilesLoader = function (options) {
      return this.useLoader('$translateStaticFilesLoader', options);
    };
    this.useLoader = function (loaderFactory, options) {
      $loaderFactory = loaderFactory;
      $loaderOptions = options || {};
      return this;
    };
    this.useLocalStorage = function () {
      return this.useStorage('$translateLocalStorage');
    };
    this.useCookieStorage = function () {
      return this.useStorage('$translateCookieStorage');
    };
    this.useStorage = function (storageFactory) {
      $storageFactory = storageFactory;
      return this;
    };
    this.storagePrefix = function (prefix) {
      if (!prefix) {
        return prefix;
      }
      $storagePrefix = prefix;
      return this;
    };
    this.useMissingTranslationHandlerLog = function () {
      return this.useMissingTranslationHandler('$translateMissingTranslationHandlerLog');
    };
    this.useMissingTranslationHandler = function (factory) {
      $missingTranslationHandlerFactory = factory;
      return this;
    };
    this.usePostCompiling = function (value) {
      $postCompilingEnabled = !!value;
      return this;
    };
    this.determinePreferredLanguage = function (fn) {
      var locale = fn && angular.isFunction(fn) ? fn() : getLocale();
      if (!$availableLanguageKeys.length) {
        $preferredLanguage = locale;
        return this;
      } else {
        $preferredLanguage = negotiateLocale(locale);
      }
    };
    this.registerAvailableLanguageKeys = function (languageKeys, aliases) {
      if (languageKeys) {
        $availableLanguageKeys = languageKeys;
        if (aliases) {
          $languageKeyAliases = aliases;
        }
        return this;
      }
      return $availableLanguageKeys;
    };
    this.$get = [
      '$log',
      '$injector',
      '$rootScope',
      '$q',
      function ($log, $injector, $rootScope, $q) {
        var Storage, defaultInterpolator = $injector.get($interpolationFactory || '$translateDefaultInterpolation'), pendingLoader = false, interpolatorHashMap = {}, langPromises = {}, fallbackIndex, startFallbackIteration;
        var $translate = function (translationId, interpolateParams, interpolationId) {
          var deferred = $q.defer();
          translationId = translationId.trim();
          var promiseToWaitFor = function () {
              var promise = $preferredLanguage ? langPromises[$preferredLanguage] : langPromises[$uses];
              fallbackIndex = 0;
              if ($storageFactory && !promise) {
                var langKey = Storage.get($storageKey);
                promise = langPromises[langKey];
                if ($fallbackLanguage && $fallbackLanguage.length) {
                  var index = indexOf($fallbackLanguage, langKey);
                  fallbackIndex = index > -1 ? index += 1 : 0;
                  $fallbackLanguage.push($preferredLanguage);
                }
              }
              return promise;
            }();
          if (!promiseToWaitFor) {
            determineTranslation(translationId, interpolateParams, interpolationId).then(deferred.resolve, deferred.reject);
          } else {
            promiseToWaitFor.then(function () {
              determineTranslation(translationId, interpolateParams, interpolationId).then(deferred.resolve, deferred.reject);
            }, deferred.reject);
          }
          return deferred.promise;
        };
        var indexOf = function (array, searchElement) {
          for (var i = 0, len = array.length; i < len; i++) {
            if (array[i] === searchElement) {
              return i;
            }
          }
          return -1;
        };
        var applyNotFoundIndicators = function (translationId) {
          if ($notFoundIndicatorLeft) {
            translationId = [
              $notFoundIndicatorLeft,
              translationId
            ].join(' ');
          }
          if ($notFoundIndicatorRight) {
            translationId = [
              translationId,
              $notFoundIndicatorRight
            ].join(' ');
          }
          return translationId;
        };
        var useLanguage = function (key) {
          $uses = key;
          $rootScope.$emit('$translateChangeSuccess');
          if ($storageFactory) {
            Storage.set($translate.storageKey(), $uses);
          }
          defaultInterpolator.setLocale($uses);
          angular.forEach(interpolatorHashMap, function (interpolator, id) {
            interpolatorHashMap[id].setLocale($uses);
          });
          $rootScope.$emit('$translateChangeEnd');
        };
        var loadAsync = function (key) {
          if (!key) {
            throw 'No language key specified for loading.';
          }
          var deferred = $q.defer();
          $rootScope.$emit('$translateLoadingStart');
          pendingLoader = true;
          $injector.get($loaderFactory)(angular.extend($loaderOptions, { key: key })).then(function (data) {
            var translationTable = {};
            $rootScope.$emit('$translateLoadingSuccess');
            if (angular.isArray(data)) {
              angular.forEach(data, function (table) {
                angular.extend(translationTable, flatObject(table));
              });
            } else {
              angular.extend(translationTable, flatObject(data));
            }
            pendingLoader = false;
            deferred.resolve({
              key: key,
              table: translationTable
            });
            $rootScope.$emit('$translateLoadingEnd');
          }, function (key) {
            $rootScope.$emit('$translateLoadingError');
            deferred.reject(key);
            $rootScope.$emit('$translateLoadingEnd');
          });
          return deferred.promise;
        };
        if ($storageFactory) {
          Storage = $injector.get($storageFactory);
          if (!Storage.get || !Storage.set) {
            throw new Error('Couldn\'t use storage \'' + $storageFactory + '\', missing get() or set() method!');
          }
        }
        if (angular.isFunction(defaultInterpolator.useSanitizeValueStrategy)) {
          defaultInterpolator.useSanitizeValueStrategy($interpolationSanitizationStrategy);
        }
        if ($interpolatorFactories.length) {
          angular.forEach($interpolatorFactories, function (interpolatorFactory) {
            var interpolator = $injector.get(interpolatorFactory);
            interpolator.setLocale($preferredLanguage || $uses);
            if (angular.isFunction(interpolator.useSanitizeValueStrategy)) {
              interpolator.useSanitizeValueStrategy($interpolationSanitizationStrategy);
            }
            interpolatorHashMap[interpolator.getInterpolationIdentifier()] = interpolator;
          });
        }
        var getTranslationTable = function (langKey) {
          var deferred = $q.defer();
          if ($translationTable.hasOwnProperty(langKey)) {
            deferred.resolve($translationTable[langKey]);
            return deferred.promise;
          } else {
            langPromises[langKey].then(function (data) {
              translations(data.key, data.table);
              deferred.resolve(data.table);
            }, deferred.reject);
          }
          return deferred.promise;
        };
        var getFallbackTranslation = function (langKey, translationId, interpolateParams, Interpolator) {
          var deferred = $q.defer();
          getTranslationTable(langKey).then(function (translationTable) {
            if (translationTable.hasOwnProperty(translationId)) {
              Interpolator.setLocale(langKey);
              deferred.resolve(Interpolator.interpolate(translationTable[translationId], interpolateParams));
              Interpolator.setLocale($uses);
            } else {
              deferred.reject();
            }
          }, deferred.reject);
          return deferred.promise;
        };
        var getFallbackTranslationInstant = function (langKey, translationId, interpolateParams, Interpolator) {
          var result, translationTable = $translationTable[langKey];
          if (translationTable.hasOwnProperty(translationId)) {
            Interpolator.setLocale(langKey);
            result = Interpolator.interpolate(translationTable[translationId], interpolateParams);
            Interpolator.setLocale($uses);
          }
          return result;
        };
        var resolveForFallbackLanguage = function (fallbackLanguageIndex, translationId, interpolateParams, Interpolator) {
          var deferred = $q.defer();
          if (fallbackLanguageIndex < $fallbackLanguage.length) {
            var langKey = $fallbackLanguage[fallbackLanguageIndex];
            getFallbackTranslation(langKey, translationId, interpolateParams, Interpolator).then(function (translation) {
              deferred.resolve(translation);
            }, function () {
              var nextFallbackLanguagePromise = resolveForFallbackLanguage(fallbackLanguageIndex + 1, translationId, interpolateParams, Interpolator);
              deferred.resolve(nextFallbackLanguagePromise);
            });
          } else {
            deferred.resolve(translationId);
          }
          return deferred.promise;
        };
        var resolveForFallbackLanguageInstant = function (fallbackLanguageIndex, translationId, interpolateParams, Interpolator) {
          var result;
          if (fallbackLanguageIndex < $fallbackLanguage.length) {
            var langKey = $fallbackLanguage[fallbackLanguageIndex];
            result = getFallbackTranslationInstant(langKey, translationId, interpolateParams, Interpolator);
            if (!result) {
              result = resolveForFallbackLanguageInstant(fallbackLanguageIndex + 1, translationId, interpolateParams, Interpolator);
            }
          }
          return result;
        };
        var fallbackTranslation = function (translationId, interpolateParams, Interpolator) {
          return resolveForFallbackLanguage(startFallbackIteration > 0 ? startFallbackIteration : fallbackIndex, translationId, interpolateParams, Interpolator);
        };
        var fallbackTranslationInstant = function (translationId, interpolateParams, Interpolator) {
          return resolveForFallbackLanguageInstant(startFallbackIteration > 0 ? startFallbackIteration : fallbackIndex, translationId, interpolateParams, Interpolator);
        };
        var determineTranslation = function (translationId, interpolateParams, interpolationId) {
          var deferred = $q.defer();
          var table = $uses ? $translationTable[$uses] : $translationTable, Interpolator = interpolationId ? interpolatorHashMap[interpolationId] : defaultInterpolator;
          if (table && table.hasOwnProperty(translationId)) {
            var translation = table[translationId];
            if (translation.substr(0, 2) === '@:') {
              $translate(translation.substr(2), interpolateParams, interpolationId).then(deferred.resolve, deferred.reject);
            } else {
              deferred.resolve(Interpolator.interpolate(translation, interpolateParams));
            }
          } else {
            if ($missingTranslationHandlerFactory && !pendingLoader) {
              $injector.get($missingTranslationHandlerFactory)(translationId, $uses);
            }
            if ($uses && $fallbackLanguage && $fallbackLanguage.length) {
              fallbackTranslation(translationId, interpolateParams, Interpolator).then(function (translation) {
                deferred.resolve(translation);
              }, function (_translationId) {
                deferred.reject(applyNotFoundIndicators(_translationId));
              });
            } else {
              deferred.reject(applyNotFoundIndicators(translationId));
            }
          }
          return deferred.promise;
        };
        var determineTranslationInstant = function (translationId, interpolateParams, interpolationId) {
          var result, table = $uses ? $translationTable[$uses] : $translationTable, Interpolator = interpolationId ? interpolatorHashMap[interpolationId] : defaultInterpolator;
          if (table && table.hasOwnProperty(translationId)) {
            var translation = table[translationId];
            if (translation.substr(0, 2) === '@:') {
              result = determineTranslationInstant(translation.substr(2), interpolateParams, interpolationId);
            } else {
              result = Interpolator.interpolate(translation, interpolateParams);
            }
          } else {
            if ($missingTranslationHandlerFactory && !pendingLoader) {
              $injector.get($missingTranslationHandlerFactory)(translationId, $uses);
            }
            if ($uses && $fallbackLanguage && $fallbackLanguage.length) {
              fallbackIndex = 0;
              result = fallbackTranslationInstant(translationId, interpolateParams, Interpolator);
            } else {
              result = applyNotFoundIndicators(translationId);
            }
          }
          return result;
        };
        $translate.preferredLanguage = function () {
          return $preferredLanguage;
        };
        $translate.cloakClassName = function () {
          return $cloakClassName;
        };
        $translate.fallbackLanguage = function (langKey) {
          if (langKey !== undefined && langKey !== null) {
            fallbackStack(langKey);
            if ($loaderFactory) {
              if ($fallbackLanguage && $fallbackLanguage.length) {
                for (var i = 0, len = $fallbackLanguage.length; i < len; i++) {
                  if (!langPromises[$fallbackLanguage[i]]) {
                    langPromises[$fallbackLanguage[i]] = loadAsync($fallbackLanguage[i]);
                  }
                }
              }
            }
            $translate.use($translate.use());
          }
          if ($fallbackWasString) {
            return $fallbackLanguage[0];
          } else {
            return $fallbackLanguage;
          }
        };
        $translate.useFallbackLanguage = function (langKey) {
          if (langKey !== undefined && langKey !== null) {
            if (!langKey) {
              startFallbackIteration = 0;
            } else {
              var langKeyPosition = indexOf($fallbackLanguage, langKey);
              if (langKeyPosition > -1) {
                startFallbackIteration = langKeyPosition;
              }
            }
          }
        };
        $translate.proposedLanguage = function () {
          return $nextLang;
        };
        $translate.storage = function () {
          return Storage;
        };
        $translate.use = function (key) {
          if (!key) {
            return $uses;
          }
          var deferred = $q.defer();
          $rootScope.$emit('$translateChangeStart');
          if (!$translationTable[key] && $loaderFactory) {
            $nextLang = key;
            langPromises[key] = loadAsync(key).then(function (translation) {
              translations(translation.key, translation.table);
              deferred.resolve(translation.key);
              if ($nextLang === key) {
                useLanguage(translation.key);
                $nextLang = undefined;
              }
            }, function (key) {
              $nextLang = undefined;
              $rootScope.$emit('$translateChangeError');
              deferred.reject(key);
              $rootScope.$emit('$translateChangeEnd');
            });
          } else {
            deferred.resolve(key);
            useLanguage(key);
          }
          return deferred.promise;
        };
        $translate.storageKey = function () {
          return storageKey();
        };
        $translate.isPostCompilingEnabled = function () {
          return $postCompilingEnabled;
        };
        $translate.refresh = function (langKey) {
          if (!$loaderFactory) {
            throw new Error('Couldn\'t refresh translation table, no loader registered!');
          }
          var deferred = $q.defer();
          function resolve() {
            deferred.resolve();
            $rootScope.$emit('$translateRefreshEnd');
          }
          function reject() {
            deferred.reject();
            $rootScope.$emit('$translateRefreshEnd');
          }
          $rootScope.$emit('$translateRefreshStart');
          if (!langKey) {
            var tables = [];
            if ($fallbackLanguage && $fallbackLanguage.length) {
              for (var i = 0, len = $fallbackLanguage.length; i < len; i++) {
                tables.push(loadAsync($fallbackLanguage[i]));
              }
            }
            if ($uses) {
              tables.push(loadAsync($uses));
            }
            $q.all(tables).then(function (tableData) {
              angular.forEach(tableData, function (data) {
                if ($translationTable[data.key]) {
                  delete $translationTable[data.key];
                }
                translations(data.key, data.table);
              });
              if ($uses) {
                useLanguage($uses);
              }
              resolve();
            });
          } else if ($translationTable[langKey]) {
            loadAsync(langKey).then(function (data) {
              translations(data.key, data.table);
              if (langKey === $uses) {
                useLanguage($uses);
              }
              resolve();
            }, reject);
          } else {
            reject();
          }
          return deferred.promise;
        };
        $translate.instant = function (translationId, interpolateParams, interpolationId) {
          if (typeof translationId === 'undefined' || translationId === '') {
            return translationId;
          }
          translationId = translationId.trim();
          var result, possibleLangKeys = [];
          if ($preferredLanguage) {
            possibleLangKeys.push($preferredLanguage);
          }
          if ($uses) {
            possibleLangKeys.push($uses);
          }
          if ($fallbackLanguage && $fallbackLanguage.length) {
            possibleLangKeys = possibleLangKeys.concat($fallbackLanguage);
          }
          for (var i = 0, c = possibleLangKeys.length; i < c; i++) {
            var possibleLangKey = possibleLangKeys[i];
            if ($translationTable[possibleLangKey]) {
              if ($translationTable[possibleLangKey][translationId]) {
                result = determineTranslationInstant(translationId, interpolateParams, interpolationId);
              }
            }
            if (typeof result !== 'undefined') {
              break;
            }
          }
          if (!result) {
            result = translationId;
            if ($missingTranslationHandlerFactory && !pendingLoader) {
              $injector.get($missingTranslationHandlerFactory)(translationId, $uses);
            }
          }
          return result;
        };
        if ($loaderFactory) {
          if (angular.equals($translationTable, {})) {
            $translate.use($translate.use());
          }
          if ($fallbackLanguage && $fallbackLanguage.length) {
            for (var i = 0, len = $fallbackLanguage.length; i < len; i++) {
              langPromises[$fallbackLanguage[i]] = loadAsync($fallbackLanguage[i]);
            }
          }
        }
        return $translate;
      }
    ];
  }
]);
angular.module('pascalprecht.translate').factory('$translateDefaultInterpolation', [
  '$interpolate',
  function ($interpolate) {
    var $translateInterpolator = {}, $locale, $identifier = 'default', $sanitizeValueStrategy = null, sanitizeValueStrategies = {
        escaped: function (params) {
          var result = {};
          for (var key in params) {
            if (params.hasOwnProperty(key)) {
              result[key] = angular.element('<div></div>').text(params[key]).html();
            }
          }
          return result;
        }
      };
    var sanitizeParams = function (params) {
      var result;
      if (angular.isFunction(sanitizeValueStrategies[$sanitizeValueStrategy])) {
        result = sanitizeValueStrategies[$sanitizeValueStrategy](params);
      } else {
        result = params;
      }
      return result;
    };
    $translateInterpolator.setLocale = function (locale) {
      $locale = locale;
    };
    $translateInterpolator.getInterpolationIdentifier = function () {
      return $identifier;
    };
    $translateInterpolator.useSanitizeValueStrategy = function (value) {
      $sanitizeValueStrategy = value;
      return this;
    };
    $translateInterpolator.interpolate = function (string, interpolateParams) {
      if ($sanitizeValueStrategy) {
        interpolateParams = sanitizeParams(interpolateParams);
      }
      return $interpolate(string)(interpolateParams);
    };
    return $translateInterpolator;
  }
]);
angular.module('pascalprecht.translate').constant('$STORAGE_KEY', 'NG_TRANSLATE_LANG_KEY');
angular.module('pascalprecht.translate').directive('translate', [
  '$translate',
  '$q',
  '$interpolate',
  '$compile',
  '$parse',
  '$rootScope',
  function ($translate, $q, $interpolate, $compile, $parse, $rootScope) {
    return {
      restrict: 'AE',
      scope: true,
      compile: function (tElement, tAttr) {
        var translateValuesExist = tAttr.translateValues ? tAttr.translateValues : undefined;
        var translateInterpolation = tAttr.translateInterpolation ? tAttr.translateInterpolation : undefined;
        var translateValueExist = tElement[0].outerHTML.match(/translate-value-+/i);
        return function linkFn(scope, iElement, iAttr) {
          scope.interpolateParams = {};
          iAttr.$observe('translate', function (translationId) {
            if (angular.equals(translationId, '') || !angular.isDefined(translationId)) {
              scope.translationId = $interpolate(iElement.text().replace(/^\s+|\s+$/g, ''))(scope.$parent);
            } else {
              scope.translationId = translationId;
            }
          });
          if (translateValuesExist) {
            iAttr.$observe('translateValues', function (interpolateParams) {
              if (interpolateParams) {
                scope.$parent.$watch(function () {
                  angular.extend(scope.interpolateParams, $parse(interpolateParams)(scope.$parent));
                });
              }
            });
          }
          if (translateValueExist) {
            var fn = function (attrName) {
              iAttr.$observe(attrName, function (value) {
                scope.interpolateParams[angular.lowercase(attrName.substr(14))] = value;
              });
            };
            for (var attr in iAttr) {
              if (iAttr.hasOwnProperty(attr) && attr.substr(0, 14) === 'translateValue' && attr !== 'translateValues') {
                fn(attr);
              }
            }
          }
          var applyElementContent = function (value, scope) {
            iElement.html(value);
            var globallyEnabled = $translate.isPostCompilingEnabled();
            var locallyDefined = typeof tAttr.translateCompile !== 'undefined';
            var locallyEnabled = locallyDefined && tAttr.translateCompile !== 'false';
            if (globallyEnabled && !locallyDefined || locallyEnabled) {
              $compile(iElement.contents())(scope);
            }
          };
          var updateTranslationFn = function () {
              if (!translateValuesExist && !translateValueExist) {
                return function () {
                  var unwatch = scope.$watch('translationId', function (value) {
                      if (scope.translationId && value) {
                        $translate(value, {}, translateInterpolation).then(function (translation) {
                          applyElementContent(translation, scope);
                          unwatch();
                        }, function (translationId) {
                          applyElementContent(translationId, scope);
                          unwatch();
                        });
                      }
                    }, true);
                };
              } else {
                return function () {
                  scope.$watch('interpolateParams', function (value) {
                    if (scope.translationId && value) {
                      $translate(scope.translationId, value, translateInterpolation).then(function (translation) {
                        applyElementContent(translation, scope);
                      }, function (translationId) {
                        applyElementContent(translationId, scope);
                      });
                    }
                  }, true);
                };
              }
            }();
          var unbind = $rootScope.$on('$translateChangeSuccess', updateTranslationFn);
          updateTranslationFn();
          scope.$on('$destroy', unbind);
        };
      }
    };
  }
]);
angular.module('pascalprecht.translate').directive('translateCloak', [
  '$rootScope',
  '$translate',
  function ($rootScope, $translate) {
    return {
      compile: function (tElement) {
        $rootScope.$on('$translateLoadingSuccess', function () {
          tElement.removeClass($translate.cloakClassName());
        });
        tElement.addClass($translate.cloakClassName());
      }
    };
  }
]);
angular.module('pascalprecht.translate').filter('translate', [
  '$parse',
  '$translate',
  function ($parse, $translate) {
    return function (translationId, interpolateParams, interpolation) {
      if (!angular.isObject(interpolateParams)) {
        interpolateParams = $parse(interpolateParams)();
      }
      return $translate.instant(translationId, interpolateParams, interpolation);
    };
  }
]);
},{}],9:[function(require,module,exports){
/*! 
 * numeral.js language configuration
 * language : German (de) – generally useful in Germany, Austria, Luxembourg, Belgium
 * author : Marco Krage : https://github.com/sinky
 */
(function () {
    var language = {
        delimiters: {
            thousands: ' ',
            decimal: ','
        },
        abbreviations: {
            thousand: 'k',
            million: 'm',
            billion: 'b',
            trillion: 't'
        },
        ordinal: function (number) {
            return '.';
        },
        currency: {
            symbol: '€'
        }
    };

    // Node
    if (typeof module !== 'undefined' && module.exports) {
        module.exports = language;
    }
    // Browser
    if (typeof window !== 'undefined' && this.numeral && this.numeral.language) {
        this.numeral.language('de', language);
        this.numeral.language('de-de', language);
    }
}());
},{}],10:[function(require,module,exports){
/*
 * promise-tracker - v2.0.1 - 2014-04-11
 * http://github.com/ajoslin/angular-promise-tracker
 * Created by Andy Joslin; Licensed under Public Domain
 */

(function() {

angular.module('ajoslin.promise-tracker')
.config(['$httpProvider', function($httpProvider) {
  $httpProvider.interceptors.push(['$q', 'promiseTracker', function($q, promiseTracker) {
    return {
      request: function(config) {
        if (config.tracker) {
          if (!angular.isArray(config.tracker)) {
            config.tracker = [config.tracker];
          }
          config.$promiseTrackerDeferred = config.$promiseTrackerDeferred || [];

          angular.forEach(config.tracker, function(tracker) {
            var deferred = tracker.createPromise();
            config.$promiseTrackerDeferred.push(deferred);
          });
        }
        return $q.when(config);
      },
      response: function(response) {
        if (response.config && response.config.$promiseTrackerDeferred) {
          angular.forEach(response.config.$promiseTrackerDeferred, function(deferred) {
            deferred.resolve(response);
          });
        }
        return $q.when(response);
      },
      responseError: function(response) {
        if (response.config && response.config.$promiseTrackerDeferred) {
          angular.forEach(response.config.$promiseTrackerDeferred, function(deferred) {
            deferred.reject(response);
          });
        }
        return $q.reject(response);
      }
    };
  }]);
}]);

}());
},{}],11:[function(require,module,exports){
/*
 * promise-tracker - v2.0.1 - 2014-04-11
 * http://github.com/ajoslin/angular-promise-tracker
 * Created by Andy Joslin; Licensed under Public Domain
 */

(function() {

angular.module('ajoslin.promise-tracker', [])

.provider('promiseTracker', function() {
  var trackers = {};

  this.$get = ['$q', '$timeout', function($q, $timeout) {
    function cancelTimeout(promise) {
      if (promise) {
        $timeout.cancel(promise);
      }
    }

    return function PromiseTracker(options) {
      //do new if user doesn't
      if (!(this instanceof PromiseTracker)) {
        return new PromiseTracker(options);
      }

      options = options || {};

      //Array of promises being tracked
      var tracked = [];
      var self = this;

      //Allow an optional "minimum duration" that the tracker has to stay active for.
      var minDuration = options.minDuration;
      //Allow a delay that will stop the tracker from activating until that time is reached
      var activationDelay = options.activationDelay;

      var minDurationPromise;
      var activationDelayPromise;

      self.active = function() {
        //Even if we have a promise in our tracker, we aren't active until delay is elapsed
        if (activationDelayPromise) {
          return false;
        }
        return tracked.length > 0;
      };

      self.tracking = function() {
        //Even if we aren't active, we could still have a promise in our tracker
        return tracked.length > 0;
      };

      self.destroy = self.cancel = function() {
        minDurationPromise = cancelTimeout(minDurationPromise);
        activationDelayPromise = cancelTimeout(activationDelayPromise);
        for (var i=tracked.length-1; i>=0; i--) {
          tracked[i].resolve();
        }
        tracked.length = 0;
      };

      //Create a promise that will make our tracker active until it is resolved.
      // @return deferred - our deferred object that is being tracked
      self.createPromise = function() {
        var deferred = $q.defer();
        tracked.push(deferred);

        //If the tracker was just inactive and this the first in the list of
        //promises, we reset our delay and minDuration
        //again.
        if (tracked.length === 1) {
          if (activationDelay) {
            activationDelayPromise = $timeout(function() {
              activationDelayPromise = cancelTimeout(activationDelayPromise);
              startMinDuration();
            }, activationDelay);
          } else {
            startMinDuration();
          }
        }

        deferred.promise.then(onDone(false), onDone(true));

        return deferred;

        function startMinDuration() {
          if (minDuration) {
            minDurationPromise = $timeout(angular.noop, minDuration);
          }
        }

        //Create a callback for when this promise is done. It will remove our
        //tracked promise from the array if once minDuration is complete
        function onDone(isError) {
          return function(value) {
            (minDurationPromise || $q.when()).then(function() {
              var index = tracked.indexOf(deferred);
              tracked.splice(index, 1);

              //If this is the last promise, cleanup the timeouts
              //for activationDelay
              if (tracked.length === 0) {
                activationDelayPromise = cancelTimeout(activationDelayPromise);
              }
            });
          };
        }
      };

      self.addPromise = function(promise) {
        var then = promise && (promise.then || promise.$then ||
                               (promise.$promise && promise.$promise.then));
        if (!then) {
          throw new Error("promiseTracker#addPromise expects a promise object!");
        }
        var deferred = self.createPromise();

        //When given promise is done, resolve our created promise
        //Allow $then for angular-resource objects
        then(function success(value) {
          deferred.resolve(value);
          return value;
        }, function error(value) {
          deferred.reject(value);
          return $q.reject(value);
        });

        return deferred;
      };
    };
  }];
});

}());

},{}],12:[function(require,module,exports){
/*
 * angular-ui-bootstrap
 * http://angular-ui.github.io/bootstrap/

 * Version: 0.11.2 - 2014-09-26
 * License: MIT
 */
angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tpls",["template/accordion/accordion-group.html","template/accordion/accordion.html","template/alert/alert.html","template/carousel/carousel.html","template/carousel/slide.html","template/datepicker/datepicker.html","template/datepicker/day.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html","template/modal/backdrop.html","template/modal/window.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/popover/popover.html","template/progressbar/bar.html","template/progressbar/progress.html","template/progressbar/progressbar.html","template/rating/rating.html","template/tabs/tab.html","template/tabs/tabset.html","template/timepicker/timepicker.html","template/typeahead/typeahead-match.html","template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(a,b,c){function d(a){for(var b in a)if(void 0!==f.style[b])return a[b]}var e=function(d,f,g){g=g||{};var h=a.defer(),i=e[g.animation?"animationEndEventName":"transitionEndEventName"],j=function(){c.$apply(function(){d.unbind(i,j),h.resolve(d)})};return i&&d.bind(i,j),b(function(){angular.isString(f)?d.addClass(f):angular.isFunction(f)?f(d):angular.isObject(f)&&d.css(f),i||h.resolve(d)}),h.promise.cancel=function(){i&&d.unbind(i,j),h.reject("Transition cancelled")},h.promise},f=document.createElement("trans"),g={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},h={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return e.transitionEndEventName=d(g),e.animationEndEventName=d(h),e}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function(a){return{link:function(b,c,d){function e(b){function d(){j===e&&(j=void 0)}var e=a(c,b);return j&&j.cancel(),j=e,e.then(d,d),e}function f(){k?(k=!1,g()):(c.removeClass("collapse").addClass("collapsing"),e({height:c[0].scrollHeight+"px"}).then(g))}function g(){c.removeClass("collapsing"),c.addClass("collapse in"),c.css({height:"auto"})}function h(){if(k)k=!1,i(),c.css({height:0});else{c.css({height:c[0].scrollHeight+"px"});{c[0].offsetWidth}c.removeClass("collapse in").addClass("collapsing"),e({height:0}).then(i)}}function i(){c.removeClass("collapsing"),c.addClass("collapse")}var j,k=!0;b.$watch(d.collapse,function(a){a?h():f()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function(a,b,c){this.groups=[],this.closeOthers=function(d){var e=angular.isDefined(b.closeOthers)?a.$eval(b.closeOthers):c.closeOthers;e&&angular.forEach(this.groups,function(a){a!==d&&(a.isOpen=!1)})},this.addGroup=function(a){var b=this;this.groups.push(a),a.$on("$destroy",function(){b.removeGroup(a)})},this.removeGroup=function(a){var b=this.groups.indexOf(a);-1!==b&&this.groups.splice(b,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(a){this.heading=a}},link:function(a,b,c,d){d.addGroup(a),a.$watch("isOpen",function(b){b&&d.closeOthers(a)}),a.toggleOpen=function(){a.isDisabled||(a.isOpen=!a.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(a,b,c,d,e){d.setHeading(e(a,function(){}))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(a,b,c,d){a.$watch(function(){return d[c.accordionTransclude]},function(a){a&&(b.html(""),b.append(a))})}}}),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function(a,b){a.closeable="close"in b}]).directive("alert",function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(a,b,c){b.addClass("ng-binding").data("$binding",c.bindHtmlUnsafe),a.$watch(c.bindHtmlUnsafe,function(a){b.html(a||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(a){this.activeClass=a.activeClass||"active",this.toggleEvent=a.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(a,b,c,d){var e=d[0],f=d[1];f.$render=function(){b.toggleClass(e.activeClass,angular.equals(f.$modelValue,a.$eval(c.btnRadio)))},b.bind(e.toggleEvent,function(){var d=b.hasClass(e.activeClass);(!d||angular.isDefined(c.uncheckable))&&a.$apply(function(){f.$setViewValue(d?null:a.$eval(c.btnRadio)),f.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(a,b,c,d){function e(){return g(c.btnCheckboxTrue,!0)}function f(){return g(c.btnCheckboxFalse,!1)}function g(b,c){var d=a.$eval(b);return angular.isDefined(d)?d:c}var h=d[0],i=d[1];i.$render=function(){b.toggleClass(h.activeClass,angular.equals(i.$modelValue,e()))},b.bind(h.toggleEvent,function(){a.$apply(function(){i.$setViewValue(b.hasClass(h.activeClass)?f():e()),i.$render()})})}}}),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition",function(a,b,c){function d(){e();var c=+a.interval;!isNaN(c)&&c>=0&&(g=b(f,c))}function e(){g&&(b.cancel(g),g=null)}function f(){h?(a.next(),d()):a.pause()}var g,h,i=this,j=i.slides=a.slides=[],k=-1;i.currentSlide=null;var l=!1;i.select=a.select=function(e,f){function g(){if(!l){if(i.currentSlide&&angular.isString(f)&&!a.noTransition&&e.$element){e.$element.addClass(f);{e.$element[0].offsetWidth}angular.forEach(j,function(a){angular.extend(a,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(e,{direction:f,active:!0,entering:!0}),angular.extend(i.currentSlide||{},{direction:f,leaving:!0}),a.$currentTransition=c(e.$element,{}),function(b,c){a.$currentTransition.then(function(){h(b,c)},function(){h(b,c)})}(e,i.currentSlide)}else h(e,i.currentSlide);i.currentSlide=e,k=m,d()}}function h(b,c){angular.extend(b,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(c||{},{direction:"",active:!1,leaving:!1,entering:!1}),a.$currentTransition=null}var m=j.indexOf(e);void 0===f&&(f=m>k?"next":"prev"),e&&e!==i.currentSlide&&(a.$currentTransition?(a.$currentTransition.cancel(),b(g)):g())},a.$on("$destroy",function(){l=!0}),i.indexOfSlide=function(a){return j.indexOf(a)},a.next=function(){var b=(k+1)%j.length;return a.$currentTransition?void 0:i.select(j[b],"next")},a.prev=function(){var b=0>k-1?j.length-1:k-1;return a.$currentTransition?void 0:i.select(j[b],"prev")},a.isActive=function(a){return i.currentSlide===a},a.$watch("interval",d),a.$on("$destroy",e),a.play=function(){h||(h=!0,d())},a.pause=function(){a.noPause||(h=!1,e())},i.addSlide=function(b,c){b.$element=c,j.push(b),1===j.length||b.active?(i.select(j[j.length-1]),1==j.length&&a.play()):b.active=!1},i.removeSlide=function(a){var b=j.indexOf(a);j.splice(b,1),j.length>0&&a.active?i.select(b>=j.length?j[b-1]:j[b]):k>b&&k--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?"},link:function(a,b,c,d){d.addSlide(a,b),a.$on("$destroy",function(){d.removeSlide(a)}),a.$watch("active",function(b){b&&d.select(a)})}}}),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function(a,b){function c(a){var c=[],d=a.split("");return angular.forEach(e,function(b,e){var f=a.indexOf(e);if(f>-1){a=a.split(""),d[f]="("+b.regex+")",a[f]="$";for(var g=f+1,h=f+e.length;h>g;g++)d[g]="",a[g]="$";a=a.join(""),c.push({index:f,apply:b.apply})}}),{regex:new RegExp("^"+d.join("")+"$"),map:b(c,"index")}}function d(a,b,c){return 1===b&&c>28?29===c&&(a%4===0&&a%100!==0||a%400===0):3===b||5===b||8===b||10===b?31>c:!0}this.parsers={};var e={yyyy:{regex:"\\d{4}",apply:function(a){this.year=+a}},yy:{regex:"\\d{2}",apply:function(a){this.year=+a+2e3}},y:{regex:"\\d{1,4}",apply:function(a){this.year=+a}},MMMM:{regex:a.DATETIME_FORMATS.MONTH.join("|"),apply:function(b){this.month=a.DATETIME_FORMATS.MONTH.indexOf(b)}},MMM:{regex:a.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(b){this.month=a.DATETIME_FORMATS.SHORTMONTH.indexOf(b)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(a){this.month=a-1}},M:{regex:"[1-9]|1[0-2]",apply:function(a){this.month=a-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a}},EEEE:{regex:a.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:a.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(b,e){if(!angular.isString(b)||!e)return b;e=a.DATETIME_FORMATS[e]||e,this.parsers[e]||(this.parsers[e]=c(e));var f=this.parsers[e],g=f.regex,h=f.map,i=b.match(g);if(i&&i.length){for(var j,k={year:1900,month:0,date:1,hours:0},l=1,m=i.length;m>l;l++){var n=h[l-1];n.apply&&n.apply.call(k,i[l])}return d(k.year,k.month,k.date)&&(j=new Date(k.year,k.month,k.date,k.hours)),j}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function(a,b){function c(a,c){return a.currentStyle?a.currentStyle[c]:b.getComputedStyle?b.getComputedStyle(a)[c]:a.style[c]}function d(a){return"static"===(c(a,"position")||"static")}var e=function(b){for(var c=a[0],e=b.offsetParent||c;e&&e!==c&&d(e);)e=e.offsetParent;return e||c};return{position:function(b){var c=this.offset(b),d={top:0,left:0},f=e(b[0]);f!=a[0]&&(d=this.offset(angular.element(f)),d.top+=f.clientTop-f.scrollTop,d.left+=f.clientLeft-f.scrollLeft);var g=b[0].getBoundingClientRect();return{width:g.width||b.prop("offsetWidth"),height:g.height||b.prop("offsetHeight"),top:c.top-d.top,left:c.left-d.left}},offset:function(c){var d=c[0].getBoundingClientRect();return{width:d.width||c.prop("offsetWidth"),height:d.height||c.prop("offsetHeight"),top:d.top+(b.pageYOffset||a[0].documentElement.scrollTop),left:d.left+(b.pageXOffset||a[0].documentElement.scrollLeft)}},positionElements:function(a,b,c,d){var e,f,g,h,i=c.split("-"),j=i[0],k=i[1]||"center";e=d?this.offset(a):this.position(a),f=b.prop("offsetWidth"),g=b.prop("offsetHeight");var l={center:function(){return e.left+e.width/2-f/2},left:function(){return e.left},right:function(){return e.left+e.width}},m={center:function(){return e.top+e.height/2-g/2},top:function(){return e.top},bottom:function(){return e.top+e.height}};switch(j){case"right":h={top:m[k](),left:l[j]()};break;case"left":h={top:m[k](),left:e.left-f};break;case"bottom":h={top:m[j](),left:l[k]()};break;default:h={top:e.top-g,left:l[k]()}}return h}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function(a,b,c,d,e,f,g,h){var i=this,j={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange"],function(c,e){i[c]=angular.isDefined(b[c])?8>e?d(b[c])(a.$parent):a.$parent.$eval(b[c]):h[c]}),angular.forEach(["minDate","maxDate"],function(d){b[d]?a.$parent.$watch(c(b[d]),function(a){i[d]=a?new Date(a):null,i.refreshView()}):i[d]=h[d]?new Date(h[d]):null}),a.datepickerMode=a.datepickerMode||h.datepickerMode,a.uniqueId="datepicker-"+a.$id+"-"+Math.floor(1e4*Math.random()),this.activeDate=angular.isDefined(b.initDate)?a.$parent.$eval(b.initDate):new Date,a.isActive=function(b){return 0===i.compare(b.date,i.activeDate)?(a.activeDateId=b.uid,!0):!1},this.init=function(a){j=a,j.$render=function(){i.render()}},this.render=function(){if(j.$modelValue){var a=new Date(j.$modelValue),b=!isNaN(a);b?this.activeDate=a:f.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),j.$setValidity("date",b)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var a=j.$modelValue?new Date(j.$modelValue):null;j.$setValidity("date-disabled",!a||this.element&&!this.isDisabled(a))}},this.createDateObject=function(a,b){var c=j.$modelValue?new Date(j.$modelValue):null;return{date:a,label:g(a,b),selected:c&&0===this.compare(a,c),disabled:this.isDisabled(a),current:0===this.compare(a,new Date)}},this.isDisabled=function(c){return this.minDate&&this.compare(c,this.minDate)<0||this.maxDate&&this.compare(c,this.maxDate)>0||b.dateDisabled&&a.dateDisabled({date:c,mode:a.datepickerMode})},this.split=function(a,b){for(var c=[];a.length>0;)c.push(a.splice(0,b));return c},a.select=function(b){if(a.datepickerMode===i.minMode){var c=j.$modelValue?new Date(j.$modelValue):new Date(0,0,0,0,0,0,0);c.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),j.$setViewValue(c),j.$render()}else i.activeDate=b,a.datepickerMode=i.modes[i.modes.indexOf(a.datepickerMode)-1]},a.move=function(a){var b=i.activeDate.getFullYear()+a*(i.step.years||0),c=i.activeDate.getMonth()+a*(i.step.months||0);i.activeDate.setFullYear(b,c,1),i.refreshView()},a.toggleMode=function(b){b=b||1,a.datepickerMode===i.maxMode&&1===b||a.datepickerMode===i.minMode&&-1===b||(a.datepickerMode=i.modes[i.modes.indexOf(a.datepickerMode)+b])},a.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var k=function(){e(function(){i.element[0].focus()},0,!1)};a.$on("datepicker.focus",k),a.keydown=function(b){var c=a.keys[b.which];if(c&&!b.shiftKey&&!b.altKey)if(b.preventDefault(),b.stopPropagation(),"enter"===c||"space"===c){if(i.isDisabled(i.activeDate))return;a.select(i.activeDate),k()}else!b.ctrlKey||"up"!==c&&"down"!==c?(i.handleKeyDown(c,b),i.refreshView()):(a.toggleMode("up"===c?1:-1),k())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f)}}}).directive("daypicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(b,c,d,e){function f(a,b){return 1!==b||a%4!==0||a%100===0&&a%400!==0?i[b]:29}function g(a,b){var c=new Array(b),d=new Date(a),e=0;for(d.setHours(12);b>e;)c[e++]=new Date(d),d.setDate(d.getDate()+1);return c}function h(a){var b=new Date(a);b.setDate(b.getDate()+4-(b.getDay()||7));var c=b.getTime();return b.setMonth(0),b.setDate(1),Math.floor(Math.round((c-b)/864e5)/7)+1}b.showWeeks=e.showWeeks,e.step={months:1},e.element=c;var i=[31,28,31,30,31,30,31,31,30,31,30,31];e._refreshView=function(){var c=e.activeDate.getFullYear(),d=e.activeDate.getMonth(),f=new Date(c,d,1),i=e.startingDay-f.getDay(),j=i>0?7-i:-i,k=new Date(f);j>0&&k.setDate(-j+1);for(var l=g(k,42),m=0;42>m;m++)l[m]=angular.extend(e.createDateObject(l[m],e.formatDay),{secondary:l[m].getMonth()!==d,uid:b.uniqueId+"-"+m});b.labels=new Array(7);for(var n=0;7>n;n++)b.labels[n]={abbr:a(l[n].date,e.formatDayHeader),full:a(l[n].date,"EEEE")};if(b.title=a(e.activeDate,e.formatDayTitle),b.rows=e.split(l,7),b.showWeeks){b.weekNumbers=[];for(var o=h(b.rows[0][0].date),p=b.rows.length;b.weekNumbers.push(o++)<p;);}},e.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth(),a.getDate())-new Date(b.getFullYear(),b.getMonth(),b.getDate())},e.handleKeyDown=function(a){var b=e.activeDate.getDate();if("left"===a)b-=1;else if("up"===a)b-=7;else if("right"===a)b+=1;else if("down"===a)b+=7;else if("pageup"===a||"pagedown"===a){var c=e.activeDate.getMonth()+("pageup"===a?-1:1);e.activeDate.setMonth(c,1),b=Math.min(f(e.activeDate.getFullYear(),e.activeDate.getMonth()),b)}else"home"===a?b=1:"end"===a&&(b=f(e.activeDate.getFullYear(),e.activeDate.getMonth()));e.activeDate.setDate(b)},e.refreshView()}}}]).directive("monthpicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(b,c,d,e){e.step={years:1},e.element=c,e._refreshView=function(){for(var c=new Array(12),d=e.activeDate.getFullYear(),f=0;12>f;f++)c[f]=angular.extend(e.createDateObject(new Date(d,f,1),e.formatMonth),{uid:b.uniqueId+"-"+f});b.title=a(e.activeDate,e.formatMonthTitle),b.rows=e.split(c,3)},e.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth())-new Date(b.getFullYear(),b.getMonth())},e.handleKeyDown=function(a){var b=e.activeDate.getMonth();if("left"===a)b-=1;else if("up"===a)b-=3;else if("right"===a)b+=1;else if("down"===a)b+=3;else if("pageup"===a||"pagedown"===a){var c=e.activeDate.getFullYear()+("pageup"===a?-1:1);e.activeDate.setFullYear(c)}else"home"===a?b=0:"end"===a&&(b=11);e.activeDate.setMonth(b)},e.refreshView()}}}]).directive("yearpicker",["dateFilter",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(a,b,c,d){function e(a){return parseInt((a-1)/f,10)*f+1}var f=d.yearRange;d.step={years:f},d.element=b,d._refreshView=function(){for(var b=new Array(f),c=0,g=e(d.activeDate.getFullYear());f>c;c++)b[c]=angular.extend(d.createDateObject(new Date(g+c,0,1),d.formatYear),{uid:a.uniqueId+"-"+c});a.title=[b[0].label,b[f-1].label].join(" - "),a.rows=d.split(b,5)},d.compare=function(a,b){return a.getFullYear()-b.getFullYear()},d.handleKeyDown=function(a){var b=d.activeDate.getFullYear();"left"===a?b-=1:"up"===a?b-=5:"right"===a?b+=1:"down"===a?b+=5:"pageup"===a||"pagedown"===a?b+=("pageup"===a?-1:1)*d.step.years:"home"===a?b=e(d.activeDate.getFullYear()):"end"===a&&(b=e(d.activeDate.getFullYear())+f-1),d.activeDate.setFullYear(b)},d.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function(a,b,c,d,e,f,g){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(h,i,j,k){function l(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function m(a){if(a){if(angular.isDate(a)&&!isNaN(a))return k.$setValidity("date",!0),a;if(angular.isString(a)){var b=f.parse(a,n)||new Date(a);return isNaN(b)?void k.$setValidity("date",!1):(k.$setValidity("date",!0),b)}return void k.$setValidity("date",!1)}return k.$setValidity("date",!0),null}var n,o=angular.isDefined(j.closeOnDateSelection)?h.$parent.$eval(j.closeOnDateSelection):g.closeOnDateSelection,p=angular.isDefined(j.datepickerAppendToBody)?h.$parent.$eval(j.datepickerAppendToBody):g.appendToBody;h.showButtonBar=angular.isDefined(j.showButtonBar)?h.$parent.$eval(j.showButtonBar):g.showButtonBar,h.getText=function(a){return h[a+"Text"]||g[a+"Text"]},j.$observe("datepickerPopup",function(a){n=a||g.datepickerPopup,k.$render()});var q=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");q.attr({"ng-model":"date","ng-change":"dateSelection()"});var r=angular.element(q.children()[0]);j.datepickerOptions&&angular.forEach(h.$parent.$eval(j.datepickerOptions),function(a,b){r.attr(l(b),a)}),h.watchData={},angular.forEach(["minDate","maxDate","datepickerMode"],function(a){if(j[a]){var c=b(j[a]);if(h.$parent.$watch(c,function(b){h.watchData[a]=b}),r.attr(l(a),"watchData."+a),"datepickerMode"===a){var d=c.assign;h.$watch("watchData."+a,function(a,b){a!==b&&d(h.$parent,a)})}}}),j.dateDisabled&&r.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),k.$parsers.unshift(m),h.dateSelection=function(a){angular.isDefined(a)&&(h.date=a),k.$setViewValue(h.date),k.$render(),o&&(h.isOpen=!1,i[0].focus())},i.bind("input change keyup",function(){h.$apply(function(){h.date=k.$modelValue})}),k.$render=function(){var a=k.$viewValue?e(k.$viewValue,n):"";i.val(a),h.date=m(k.$modelValue)};var s=function(a){h.isOpen&&a.target!==i[0]&&h.$apply(function(){h.isOpen=!1})},t=function(a){h.keydown(a)};i.bind("keydown",t),h.keydown=function(a){27===a.which?(a.preventDefault(),a.stopPropagation(),h.close()):40!==a.which||h.isOpen||(h.isOpen=!0)},h.$watch("isOpen",function(a){a?(h.$broadcast("datepicker.focus"),h.position=p?d.offset(i):d.position(i),h.position.top=h.position.top+i.prop("offsetHeight"),c.bind("click",s)):c.unbind("click",s)}),h.select=function(a){if("today"===a){var b=new Date;angular.isDate(k.$modelValue)?(a=new Date(k.$modelValue),a.setFullYear(b.getFullYear(),b.getMonth(),b.getDate())):a=new Date(b.setHours(0,0,0,0))}h.dateSelection(a)},h.close=function(){h.isOpen=!1,i[0].focus()};var u=a(q)(h);q.remove(),p?c.find("body").append(u):i.after(u),h.$on("$destroy",function(){u.remove(),i.unbind("keydown",t),c.unbind("click",s)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(a,b){b.bind("click",function(a){a.preventDefault(),a.stopPropagation()})}}}),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function(a){var b=null;this.open=function(e){b||(a.bind("click",c),a.bind("keydown",d)),b&&b!==e&&(b.isOpen=!1),b=e},this.close=function(e){b===e&&(b=null,a.unbind("click",c),a.unbind("keydown",d))};var c=function(a){var c=b.getToggleElement();a&&c&&c[0].contains(a.target)||b.$apply(function(){b.isOpen=!1})},d=function(a){27===a.which&&(b.focusToggleElement(),c())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function(a,b,c,d,e,f){var g,h=this,i=a.$new(),j=d.openClass,k=angular.noop,l=b.onToggle?c(b.onToggle):angular.noop;this.init=function(d){h.$element=d,b.isOpen&&(g=c(b.isOpen),k=g.assign,a.$watch(g,function(a){i.isOpen=!!a}))},this.toggle=function(a){return i.isOpen=arguments.length?!!a:!i.isOpen},this.isOpen=function(){return i.isOpen},i.getToggleElement=function(){return h.toggleElement},i.focusToggleElement=function(){h.toggleElement&&h.toggleElement[0].focus()},i.$watch("isOpen",function(b,c){f[b?"addClass":"removeClass"](h.$element,j),b?(i.focusToggleElement(),e.open(i)):e.close(i),k(a,b),angular.isDefined(b)&&b!==c&&l(a,{open:!!b})}),a.$on("$locationChangeSuccess",function(){i.isOpen=!1}),a.$on("$destroy",function(){i.$destroy()})}]).directive("dropdown",function(){return{restrict:"CA",controller:"DropdownController",link:function(a,b,c,d){d.init(b)}}}).directive("dropdownToggle",function(){return{restrict:"CA",require:"?^dropdown",link:function(a,b,c,d){if(d){d.toggleElement=b;var e=function(e){e.preventDefault(),b.hasClass("disabled")||c.disabled||a.$apply(function(){d.toggle()})};b.bind("click",e),b.attr({"aria-haspopup":!0,"aria-expanded":!1}),a.$watch(d.isOpen,function(a){b.attr("aria-expanded",!!a)}),a.$on("$destroy",function(){b.unbind("click",e)})}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var a=[];return{add:function(b,c){a.push({key:b,value:c})},get:function(b){for(var c=0;c<a.length;c++)if(b==a[c].key)return a[c]},keys:function(){for(var b=[],c=0;c<a.length;c++)b.push(a[c].key);return b},top:function(){return a[a.length-1]},remove:function(b){for(var c=-1,d=0;d<a.length;d++)if(b==a[d].key){c=d;break}return a.splice(c,1)[0]},removeTop:function(){return a.splice(a.length-1,1)[0]},length:function(){return a.length}}}}}).directive("modalBackdrop",["$timeout",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(b,c,d){b.backdropClass=d.backdropClass||"",b.animate=!1,a(function(){b.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function(a,b){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(a,b){return b.templateUrl||"template/modal/window.html"},link:function(c,d,e){d.addClass(e.windowClass||""),c.size=e.size,b(function(){c.animate=!0,d[0].querySelectorAll("[autofocus]").length||d[0].focus()}),c.close=function(b){var c=a.getTop();c&&c.value.backdrop&&"static"!=c.value.backdrop&&b.target===b.currentTarget&&(b.preventDefault(),b.stopPropagation(),a.dismiss(c.key,"backdrop click"))}}}}]).directive("modalTransclude",function(){return{link:function(a,b,c,d,e){e(a.$parent,function(a){b.empty(),b.append(a)})}}}).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function(a,b,c,d,e,f){function g(){for(var a=-1,b=n.keys(),c=0;c<b.length;c++)n.get(b[c]).value.backdrop&&(a=c);return a}function h(a){var b=c.find("body").eq(0),d=n.get(a).value;n.remove(a),j(d.modalDomEl,d.modalScope,300,function(){d.modalScope.$destroy(),b.toggleClass(m,n.length()>0),i()})}function i(){if(k&&-1==g()){var a=l;j(k,l,150,function(){a.$destroy(),a=null}),k=void 0,l=void 0}}function j(c,d,e,f){function g(){g.done||(g.done=!0,c.remove(),f&&f())}d.animate=!1;var h=a.transitionEndEventName;if(h){var i=b(g,e);c.bind(h,function(){b.cancel(i),g(),d.$apply()})}else b(g)}var k,l,m="modal-open",n=f.createNew(),o={};return e.$watch(g,function(a){l&&(l.index=a)}),c.bind("keydown",function(a){var b;27===a.which&&(b=n.top(),b&&b.value.keyboard&&(a.preventDefault(),e.$apply(function(){o.dismiss(b.key,"escape key press")})))}),o.open=function(a,b){n.add(a,{deferred:b.deferred,modalScope:b.scope,backdrop:b.backdrop,keyboard:b.keyboard});var f=c.find("body").eq(0),h=g();if(h>=0&&!k){l=e.$new(!0),l.index=h;var i=angular.element("<div modal-backdrop></div>");i.attr("backdrop-class",b.backdropClass),k=d(i)(l),f.append(k)}var j=angular.element("<div modal-window></div>");j.attr({"template-url":b.windowTemplateUrl,"window-class":b.windowClass,size:b.size,index:n.length()-1,animate:"animate"}).html(b.content);var o=d(j)(b.scope);n.top().value.modalDomEl=o,f.append(o),f.addClass(m)},o.close=function(a,b){var c=n.get(a);c&&(c.value.deferred.resolve(b),h(a))},o.dismiss=function(a,b){var c=n.get(a);c&&(c.value.deferred.reject(b),h(a))},o.dismissAll=function(a){for(var b=this.getTop();b;)this.dismiss(b.key,a),b=this.getTop()},o.getTop=function(){return n.top()},o}]).provider("$modal",function(){var a={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(b,c,d,e,f,g,h){function i(a){return a.template?d.when(a.template):e.get(angular.isFunction(a.templateUrl)?a.templateUrl():a.templateUrl,{cache:f}).then(function(a){return a.data})}function j(a){var c=[];return angular.forEach(a,function(a){(angular.isFunction(a)||angular.isArray(a))&&c.push(d.when(b.invoke(a)))}),c}var k={};return k.open=function(b){var e=d.defer(),f=d.defer(),k={result:e.promise,opened:f.promise,close:function(a){h.close(k,a)},dismiss:function(a){h.dismiss(k,a)}};if(b=angular.extend({},a.options,b),b.resolve=b.resolve||{},!b.template&&!b.templateUrl)throw new Error("One of template or templateUrl options is required.");var l=d.all([i(b)].concat(j(b.resolve)));return l.then(function(a){var d=(b.scope||c).$new();d.$close=k.close,d.$dismiss=k.dismiss;var f,i={},j=1;b.controller&&(i.$scope=d,i.$modalInstance=k,angular.forEach(b.resolve,function(b,c){i[c]=a[j++]}),f=g(b.controller,i),b.controllerAs&&(d[b.controllerAs]=f)),h.open(k,{scope:d,deferred:e,content:a[0],backdrop:b.backdrop,keyboard:b.keyboard,backdropClass:b.backdropClass,windowClass:b.windowClass,windowTemplateUrl:b.windowTemplateUrl,size:b.size})},function(a){e.reject(a)}),l.then(function(){f.resolve(!0)},function(){f.reject(!1)}),k},k}]};return a}),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function(a,b,c){var d=this,e={$setViewValue:angular.noop},f=b.numPages?c(b.numPages).assign:angular.noop;this.init=function(f,g){e=f,this.config=g,e.$render=function(){d.render()},b.itemsPerPage?a.$parent.$watch(c(b.itemsPerPage),function(b){d.itemsPerPage=parseInt(b,10),a.totalPages=d.calculateTotalPages()}):this.itemsPerPage=g.itemsPerPage},this.calculateTotalPages=function(){var b=this.itemsPerPage<1?1:Math.ceil(a.totalItems/this.itemsPerPage);return Math.max(b||0,1)},this.render=function(){a.page=parseInt(e.$viewValue,10)||1},a.selectPage=function(b){a.page!==b&&b>0&&b<=a.totalPages&&(e.$setViewValue(b),e.$render())},a.getText=function(b){return a[b+"Text"]||d.config[b+"Text"]},a.noPrevious=function(){return 1===a.page},a.noNext=function(){return a.page===a.totalPages},a.$watch("totalItems",function(){a.totalPages=d.calculateTotalPages()}),a.$watch("totalPages",function(b){f(a.$parent,b),a.page>b?a.selectPage(b):e.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function(a,b){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(c,d,e,f){function g(a,b,c){return{number:a,text:b,active:c}}function h(a,b){var c=[],d=1,e=b,f=angular.isDefined(k)&&b>k;f&&(l?(d=Math.max(a-Math.floor(k/2),1),e=d+k-1,e>b&&(e=b,d=e-k+1)):(d=(Math.ceil(a/k)-1)*k+1,e=Math.min(d+k-1,b)));for(var h=d;e>=h;h++){var i=g(h,h,h===a);c.push(i)}if(f&&!l){if(d>1){var j=g(d-1,"...",!1);c.unshift(j)}if(b>e){var m=g(e+1,"...",!1);c.push(m)}}return c}var i=f[0],j=f[1];if(j){var k=angular.isDefined(e.maxSize)?c.$parent.$eval(e.maxSize):b.maxSize,l=angular.isDefined(e.rotate)?c.$parent.$eval(e.rotate):b.rotate;c.boundaryLinks=angular.isDefined(e.boundaryLinks)?c.$parent.$eval(e.boundaryLinks):b.boundaryLinks,c.directionLinks=angular.isDefined(e.directionLinks)?c.$parent.$eval(e.directionLinks):b.directionLinks,i.init(j,b),e.maxSize&&c.$parent.$watch(a(e.maxSize),function(a){k=parseInt(a,10),i.render()
});var m=i.render;i.render=function(){m(),c.page>0&&c.page<=c.totalPages&&(c.pages=h(c.page,c.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:"« Previous",nextText:"Next »",align:!0}).directive("pager",["pagerConfig",function(a){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(b,c,d,e){var f=e[0],g=e[1];g&&(b.align=angular.isDefined(d.align)?b.$parent.$eval(d.align):a.align,f.init(g,a))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function a(a){var b=/[A-Z]/g,c="-";return a.replace(b,function(a,b){return(b?c:"")+a.toLowerCase()})}var b={placement:"top",animation:!0,popupDelay:0},c={mouseenter:"mouseleave",click:"click",focus:"blur"},d={};this.options=function(a){angular.extend(d,a)},this.setTriggers=function(a){angular.extend(c,a)},this.$get=["$window","$compile","$timeout","$parse","$document","$position","$interpolate",function(e,f,g,h,i,j,k){return function(e,l,m){function n(a){var b=a||o.trigger||m,d=c[b]||b;return{show:b,hide:d}}var o=angular.extend({},b,d),p=a(e),q=k.startSymbol(),r=k.endSymbol(),s="<div "+p+'-popup title="'+q+"tt_title"+r+'" content="'+q+"tt_content"+r+'" placement="'+q+"tt_placement"+r+'" animation="tt_animation" is-open="tt_isOpen"></div>';return{restrict:"EA",scope:!0,compile:function(){var a=f(s);return function(b,c,d){function f(){b.tt_isOpen?m():k()}function k(){(!y||b.$eval(d[l+"Enable"]))&&(b.tt_popupDelay?v||(v=g(p,b.tt_popupDelay,!1),v.then(function(a){a()})):p()())}function m(){b.$apply(function(){q()})}function p(){return v=null,u&&(g.cancel(u),u=null),b.tt_content?(r(),t.css({top:0,left:0,display:"block"}),w?i.find("body").append(t):c.after(t),z(),b.tt_isOpen=!0,b.$digest(),z):angular.noop}function q(){b.tt_isOpen=!1,g.cancel(v),v=null,b.tt_animation?u||(u=g(s,500)):s()}function r(){t&&s(),t=a(b,function(){}),b.$digest()}function s(){u=null,t&&(t.remove(),t=null)}var t,u,v,w=angular.isDefined(o.appendToBody)?o.appendToBody:!1,x=n(void 0),y=angular.isDefined(d[l+"Enable"]),z=function(){var a=j.positionElements(c,t,b.tt_placement,w);a.top+="px",a.left+="px",t.css(a)};b.tt_isOpen=!1,d.$observe(e,function(a){b.tt_content=a,!a&&b.tt_isOpen&&q()}),d.$observe(l+"Title",function(a){b.tt_title=a}),d.$observe(l+"Placement",function(a){b.tt_placement=angular.isDefined(a)?a:o.placement}),d.$observe(l+"PopupDelay",function(a){var c=parseInt(a,10);b.tt_popupDelay=isNaN(c)?o.popupDelay:c});var A=function(){c.unbind(x.show,k),c.unbind(x.hide,m)};d.$observe(l+"Trigger",function(a){A(),x=n(a),x.show===x.hide?c.bind(x.show,f):(c.bind(x.show,k),c.bind(x.hide,m))});var B=b.$eval(d[l+"Animation"]);b.tt_animation=angular.isDefined(B)?!!B:o.animation,d.$observe(l+"AppendToBody",function(a){w=angular.isDefined(a)?h(a)(b):w}),w&&b.$on("$locationChangeSuccess",function(){b.tt_isOpen&&q()}),b.$on("$destroy",function(){g.cancel(u),g.cancel(v),A(),s()})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function(a){return a("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function(a){return a("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function(a){return a("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function(a,b,c){var d=this,e=angular.isDefined(b.animate)?a.$parent.$eval(b.animate):c.animate;this.bars=[],a.max=angular.isDefined(b.max)?a.$parent.$eval(b.max):c.max,this.addBar=function(b,c){e||c.css({transition:"none"}),this.bars.push(b),b.$watch("value",function(c){b.percent=+(100*c/a.max).toFixed(2)}),b.$on("$destroy",function(){c=null,d.removeBar(b)})},this.removeBar=function(a){this.bars.splice(this.bars.indexOf(a),1)}}]).directive("progress",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}}).directive("bar",function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(a,b,c,d){d.addBar(a,b)}}}).directive("progressbar",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(a,b,c,d){d.addBar(a,angular.element(b.children()[0]))}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function(a,b,c){var d={$setViewValue:angular.noop};this.init=function(e){d=e,d.$render=this.render,this.stateOn=angular.isDefined(b.stateOn)?a.$parent.$eval(b.stateOn):c.stateOn,this.stateOff=angular.isDefined(b.stateOff)?a.$parent.$eval(b.stateOff):c.stateOff;var f=angular.isDefined(b.ratingStates)?a.$parent.$eval(b.ratingStates):new Array(angular.isDefined(b.max)?a.$parent.$eval(b.max):c.max);a.range=this.buildTemplateObjects(f)},this.buildTemplateObjects=function(a){for(var b=0,c=a.length;c>b;b++)a[b]=angular.extend({index:b},{stateOn:this.stateOn,stateOff:this.stateOff},a[b]);return a},a.rate=function(b){!a.readonly&&b>=0&&b<=a.range.length&&(d.$setViewValue(b),d.$render())},a.enter=function(b){a.readonly||(a.value=b),a.onHover({value:b})},a.reset=function(){a.value=d.$viewValue,a.onLeave()},a.onKeydown=function(b){/(37|38|39|40)/.test(b.which)&&(b.preventDefault(),b.stopPropagation(),a.rate(a.value+(38===b.which||39===b.which?1:-1)))},this.render=function(){a.value=d.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f)}}}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function(a){var b=this,c=b.tabs=a.tabs=[];b.select=function(a){angular.forEach(c,function(b){b.active&&b!==a&&(b.active=!1,b.onDeselect())}),a.active=!0,a.onSelect()},b.addTab=function(a){c.push(a),1===c.length?a.active=!0:a.active&&b.select(a)},b.removeTab=function(a){var d=c.indexOf(a);if(a.active&&c.length>1){var e=d==c.length-1?d-1:d+1;b.select(c[e])}c.splice(d,1)}}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(a,b,c){a.vertical=angular.isDefined(c.vertical)?a.$parent.$eval(c.vertical):!1,a.justified=angular.isDefined(c.justified)?a.$parent.$eval(c.justified):!1}}}).directive("tab",["$parse",function(a){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(b,c,d){return function(b,c,e,f){b.$watch("active",function(a){a&&f.select(b)}),b.disabled=!1,e.disabled&&b.$parent.$watch(a(e.disabled),function(a){b.disabled=!!a}),b.select=function(){b.disabled||(b.active=!0)},f.addTab(b),b.$on("$destroy",function(){f.removeTab(b)}),b.$transcludeFn=d}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(a,b){a.$watch("headingElement",function(a){a&&(b.html(""),b.append(a))})}}}]).directive("tabContentTransclude",function(){function a(a){return a.tagName&&(a.hasAttribute("tab-heading")||a.hasAttribute("data-tab-heading")||"tab-heading"===a.tagName.toLowerCase()||"data-tab-heading"===a.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(b,c,d){var e=b.$eval(d.tabContentTransclude);e.$transcludeFn(e.$parent,function(b){angular.forEach(b,function(b){a(b)?e.headingElement=b:c.append(b)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function(a,b,c,d,e,f){function g(){var b=parseInt(a.hours,10),c=a.showMeridian?b>0&&13>b:b>=0&&24>b;return c?(a.showMeridian&&(12===b&&(b=0),a.meridian===p[1]&&(b+=12)),b):void 0}function h(){var b=parseInt(a.minutes,10);return b>=0&&60>b?b:void 0}function i(a){return angular.isDefined(a)&&a.toString().length<2?"0"+a:a}function j(a){k(),o.$setViewValue(new Date(n)),l(a)}function k(){o.$setValidity("time",!0),a.invalidHours=!1,a.invalidMinutes=!1}function l(b){var c=n.getHours(),d=n.getMinutes();a.showMeridian&&(c=0===c||12===c?12:c%12),a.hours="h"===b?c:i(c),a.minutes="m"===b?d:i(d),a.meridian=n.getHours()<12?p[0]:p[1]}function m(a){var b=new Date(n.getTime()+6e4*a);n.setHours(b.getHours(),b.getMinutes()),j()}var n=new Date,o={$setViewValue:angular.noop},p=angular.isDefined(b.meridians)?a.$parent.$eval(b.meridians):f.meridians||e.DATETIME_FORMATS.AMPMS;this.init=function(c,d){o=c,o.$render=this.render;var e=d.eq(0),g=d.eq(1),h=angular.isDefined(b.mousewheel)?a.$parent.$eval(b.mousewheel):f.mousewheel;h&&this.setupMousewheelEvents(e,g),a.readonlyInput=angular.isDefined(b.readonlyInput)?a.$parent.$eval(b.readonlyInput):f.readonlyInput,this.setupInputEvents(e,g)};var q=f.hourStep;b.hourStep&&a.$parent.$watch(c(b.hourStep),function(a){q=parseInt(a,10)});var r=f.minuteStep;b.minuteStep&&a.$parent.$watch(c(b.minuteStep),function(a){r=parseInt(a,10)}),a.showMeridian=f.showMeridian,b.showMeridian&&a.$parent.$watch(c(b.showMeridian),function(b){if(a.showMeridian=!!b,o.$error.time){var c=g(),d=h();angular.isDefined(c)&&angular.isDefined(d)&&(n.setHours(c),j())}else l()}),this.setupMousewheelEvents=function(b,c){var d=function(a){a.originalEvent&&(a=a.originalEvent);var b=a.wheelDelta?a.wheelDelta:-a.deltaY;return a.detail||b>0};b.bind("mousewheel wheel",function(b){a.$apply(d(b)?a.incrementHours():a.decrementHours()),b.preventDefault()}),c.bind("mousewheel wheel",function(b){a.$apply(d(b)?a.incrementMinutes():a.decrementMinutes()),b.preventDefault()})},this.setupInputEvents=function(b,c){if(a.readonlyInput)return a.updateHours=angular.noop,void(a.updateMinutes=angular.noop);var d=function(b,c){o.$setViewValue(null),o.$setValidity("time",!1),angular.isDefined(b)&&(a.invalidHours=b),angular.isDefined(c)&&(a.invalidMinutes=c)};a.updateHours=function(){var a=g();angular.isDefined(a)?(n.setHours(a),j("h")):d(!0)},b.bind("blur",function(){!a.invalidHours&&a.hours<10&&a.$apply(function(){a.hours=i(a.hours)})}),a.updateMinutes=function(){var a=h();angular.isDefined(a)?(n.setMinutes(a),j("m")):d(void 0,!0)},c.bind("blur",function(){!a.invalidMinutes&&a.minutes<10&&a.$apply(function(){a.minutes=i(a.minutes)})})},this.render=function(){var a=o.$modelValue?new Date(o.$modelValue):null;isNaN(a)?(o.$setValidity("time",!1),d.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(a&&(n=a),k(),l())},a.incrementHours=function(){m(60*q)},a.decrementHours=function(){m(60*-q)},a.incrementMinutes=function(){m(r)},a.decrementMinutes=function(){m(-r)},a.toggleMeridian=function(){m(720*(n.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f,b.find("input"))}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function(a){var b=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(c){var d=c.match(b);if(!d)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+c+'".');return{itemName:d[3],source:a(d[4]),viewMapper:a(d[2]||d[1]),modelMapper:a(d[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function(a,b,c,d,e,f,g){var h=[9,13,27,38,40];return{require:"ngModel",link:function(i,j,k,l){var m,n=i.$eval(k.typeaheadMinLength)||1,o=i.$eval(k.typeaheadWaitMs)||0,p=i.$eval(k.typeaheadEditable)!==!1,q=b(k.typeaheadLoading).assign||angular.noop,r=b(k.typeaheadOnSelect),s=k.typeaheadInputFormatter?b(k.typeaheadInputFormatter):void 0,t=k.typeaheadAppendToBody?i.$eval(k.typeaheadAppendToBody):!1,u=b(k.ngModel).assign,v=g.parse(k.typeahead),w=i.$new();i.$on("$destroy",function(){w.$destroy()});var x="typeahead-"+w.$id+"-"+Math.floor(1e4*Math.random());j.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":x});var y=angular.element("<div typeahead-popup></div>");y.attr({id:x,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(k.typeaheadTemplateUrl)&&y.attr("template-url",k.typeaheadTemplateUrl);var z=function(){w.matches=[],w.activeIdx=-1,j.attr("aria-expanded",!1)},A=function(a){return x+"-option-"+a};w.$watch("activeIdx",function(a){0>a?j.removeAttr("aria-activedescendant"):j.attr("aria-activedescendant",A(a))});var B=function(a){var b={$viewValue:a};q(i,!0),c.when(v.source(i,b)).then(function(c){var d=a===l.$viewValue;if(d&&m)if(c.length>0){w.activeIdx=0,w.matches.length=0;for(var e=0;e<c.length;e++)b[v.itemName]=c[e],w.matches.push({id:A(e),label:v.viewMapper(w,b),model:c[e]});w.query=a,w.position=t?f.offset(j):f.position(j),w.position.top=w.position.top+j.prop("offsetHeight"),j.attr("aria-expanded",!0)}else z();d&&q(i,!1)},function(){z(),q(i,!1)})};z(),w.query=void 0;var C,D=function(a){C=d(function(){B(a)},o)},E=function(){C&&d.cancel(C)};l.$parsers.unshift(function(a){return m=!0,a&&a.length>=n?o>0?(E(),D(a)):B(a):(q(i,!1),E(),z()),p?a:a?void l.$setValidity("editable",!1):(l.$setValidity("editable",!0),a)}),l.$formatters.push(function(a){var b,c,d={};return s?(d.$model=a,s(i,d)):(d[v.itemName]=a,b=v.viewMapper(i,d),d[v.itemName]=void 0,c=v.viewMapper(i,d),b!==c?b:a)}),w.select=function(a){var b,c,e={};e[v.itemName]=c=w.matches[a].model,b=v.modelMapper(i,e),u(i,b),l.$setValidity("editable",!0),r(i,{$item:c,$model:b,$label:v.viewMapper(i,e)}),z(),d(function(){j[0].focus()},0,!1)},j.bind("keydown",function(a){0!==w.matches.length&&-1!==h.indexOf(a.which)&&(a.preventDefault(),40===a.which?(w.activeIdx=(w.activeIdx+1)%w.matches.length,w.$digest()):38===a.which?(w.activeIdx=(w.activeIdx?w.activeIdx:w.matches.length)-1,w.$digest()):13===a.which||9===a.which?w.$apply(function(){w.select(w.activeIdx)}):27===a.which&&(a.stopPropagation(),z(),w.$digest()))}),j.bind("blur",function(){m=!1});var F=function(a){j[0]!==a.target&&(z(),w.$digest())};e.bind("click",F),i.$on("$destroy",function(){e.unbind("click",F)});var G=a(y)(w);t?e.find("body").append(G):j.after(G)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(a,b,c){a.templateUrl=c.templateUrl,a.isOpen=function(){return a.matches.length>0},a.isActive=function(b){return a.active==b},a.selectActive=function(b){a.active=b},a.selectMatch=function(b){a.select({activeIdx:b})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function(a,b,c,d){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(e,f,g){var h=d(g.templateUrl)(e.$parent)||"template/typeahead/typeahead-match.html";a.get(h,{cache:b}).success(function(a){f.replaceWith(c(a.trim())(e))})}}}]).filter("typeaheadHighlight",function(){function a(a){return a.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(b,c){return c?(""+b).replace(new RegExp(a(c),"gi"),"<strong>$&</strong>"):b}}),angular.module("template/accordion/accordion-group.html",[]).run(["$templateCache",function(a){a.put("template/accordion/accordion-group.html",'<div class="panel panel-default">\n  <div class="panel-heading">\n    <h4 class="panel-title">\n      <a class="accordion-toggle" ng-click="toggleOpen()" accordion-transclude="heading"><span ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></a>\n    </h4>\n  </div>\n  <div class="panel-collapse" collapse="!isOpen">\n	  <div class="panel-body" ng-transclude></div>\n  </div>\n</div>')}]),angular.module("template/accordion/accordion.html",[]).run(["$templateCache",function(a){a.put("template/accordion/accordion.html",'<div class="panel-group" ng-transclude></div>')}]),angular.module("template/alert/alert.html",[]).run(["$templateCache",function(a){a.put("template/alert/alert.html",'<div class="alert" ng-class="[\'alert-\' + (type || \'warning\'), closeable ? \'alert-dismissable\' : null]" role="alert">\n    <button ng-show="closeable" type="button" class="close" ng-click="close()">\n        <span aria-hidden="true">&times;</span>\n        <span class="sr-only">Close</span>\n    </button>\n    <div ng-transclude></div>\n</div>\n')}]),angular.module("template/carousel/carousel.html",[]).run(["$templateCache",function(a){a.put("template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel" ng-swipe-right="prev()" ng-swipe-left="next()">\n    <ol class="carousel-indicators" ng-show="slides.length > 1">\n        <li ng-repeat="slide in slides track by $index" ng-class="{active: isActive(slide)}" ng-click="select(slide)"></li>\n    </ol>\n    <div class="carousel-inner" ng-transclude></div>\n    <a class="left carousel-control" ng-click="prev()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-left"></span></a>\n    <a class="right carousel-control" ng-click="next()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-right"></span></a>\n</div>\n')}]),angular.module("template/carousel/slide.html",[]).run(["$templateCache",function(a){a.put("template/carousel/slide.html","<div ng-class=\"{\n    'active': leaving || (active && !entering),\n    'prev': (next || active) && direction=='prev',\n    'next': (next || active) && direction=='next',\n    'right': direction=='prev',\n    'left': direction=='next'\n  }\" class=\"item text-center\" ng-transclude></div>\n")}]),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <daypicker ng-switch-when="day" tabindex="0"></daypicker>\n  <monthpicker ng-switch-when="month" tabindex="0"></monthpicker>\n  <yearpicker ng-switch-when="year" tabindex="0"></yearpicker>\n</div>')}]),angular.module("template/datepicker/day.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/day.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{5 + showWeeks}}"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-show="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-show="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/month.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/month.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/popup.html",'<ul class="dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)">\n	<li ng-transclude></li>\n	<li ng-if="showButtonBar" style="padding:10px 9px 2px">\n		<span class="btn-group">\n			<button type="button" class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'current\') }}</button>\n			<button type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n		</span>\n		<button type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText(\'close\') }}</button>\n	</li>\n</ul>\n')}]),angular.module("template/datepicker/year.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/year.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="3"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/modal/backdrop.html",[]).run(["$templateCache",function(a){a.put("template/modal/backdrop.html",'<div class="modal-backdrop fade {{ backdropClass }}"\n     ng-class="{in: animate}"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("template/modal/window.html",[]).run(["$templateCache",function(a){a.put("template/modal/window.html",'<div tabindex="-1" role="dialog" class="modal fade" ng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)">\n    <div class="modal-dialog" ng-class="{\'modal-sm\': size == \'sm\', \'modal-lg\': size == \'lg\'}"><div class="modal-content" modal-transclude></div></div>\n</div>')}]),angular.module("template/pagination/pager.html",[]).run(["$templateCache",function(a){a.put("template/pagination/pager.html",'<ul class="pager">\n  <li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n</ul>')}]),angular.module("template/pagination/pagination.html",[]).run(["$templateCache",function(a){a.put("template/pagination/pagination.html",'<ul class="pagination">\n  <li ng-if="boundaryLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(1)">{{getText(\'first\')}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-repeat="page in pages track by $index" ng-class="{active: page.active}"><a href ng-click="selectPage(page.number)">{{page.text}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n  <li ng-if="boundaryLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(totalPages)">{{getText(\'last\')}}</a></li>\n</ul>')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function(a){a.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function(a){a.put("template/tooltip/tooltip-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/popover/popover.html",[]).run(["$templateCache",function(a){a.put("template/popover/popover.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>\n      <div class="popover-content" ng-bind="content"></div>\n  </div>\n</div>\n')}]),angular.module("template/progressbar/bar.html",[]).run(["$templateCache",function(a){a.put("template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>')}]),angular.module("template/progressbar/progress.html",[]).run(["$templateCache",function(a){a.put("template/progressbar/progress.html",'<div class="progress" ng-transclude></div>')}]),angular.module("template/progressbar/progressbar.html",[]).run(["$templateCache",function(a){a.put("template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>\n</div>')}]),angular.module("template/rating/rating.html",[]).run(["$templateCache",function(a){a.put("template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}">\n    <i ng-repeat="r in range track by $index" ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')">\n        <span class="sr-only">({{ $index < value ? \'*\' : \' \' }})</span>\n    </i>\n</span>')}]),angular.module("template/tabs/tab.html",[]).run(["$templateCache",function(a){a.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}">\n  <a ng-click="select()" tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("template/tabs/tabset.html",[]).run(["$templateCache",function(a){a.put("template/tabs/tabset.html",'<div>\n  <ul class="nav nav-{{type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n  <div class="tab-content">\n    <div class="tab-pane" \n         ng-repeat="tab in tabs" \n         ng-class="{active: tab.active}"\n         tab-content-transclude="tab">\n    </div>\n  </div>\n</div>\n')}]),angular.module("template/timepicker/timepicker.html",[]).run(["$templateCache",function(a){a.put("template/timepicker/timepicker.html",'<table>\n	<tbody>\n		<tr class="text-center">\n			<td><a ng-click="incrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="incrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n		<tr>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidHours}">\n				<input type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-mousewheel="incrementHours()" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td>:</td>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidMinutes}">\n				<input type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td>\n		</tr>\n		<tr class="text-center">\n			<td><a ng-click="decrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="decrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n	</tbody>\n</table>\n')}]),angular.module("template/typeahead/typeahead-match.html",[]).run(["$templateCache",function(a){a.put("template/typeahead/typeahead-match.html",'<a tabindex="-1" bind-html-unsafe="match.label | typeaheadHighlight:query"></a>')
}]),angular.module("template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function(a){a.put("template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-show="isOpen()" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index)" role="option" id="{{match.id}}">\n        <div typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>\n    </li>\n</ul>\n')}]);
},{}],13:[function(require,module,exports){
/**
 * Created by kasperen on 18.09.14.
 */
angular.module('ui.handsontable', [])
    .service('handsontableSrvc', function() {
    })
    .controller("HandsonController", function ($scope) {
		/*
		$scope.data = instance.LCPQuestionnaire.listOfPlants;
		$scope.data = [
			{
				"delete": false,
				"plantName": "1",
				"plantId": "",
				"eprtrNationalId": "",
				"address1": "",
				"address2": "",
				"city": "",
				"region": "",
				"postalCode": "",
				"longitude": "",
				"latitude": ""
			},
			{
				"delete": false,
				"plantName": "2",
				"plantId": null,
				"eprtrNationalId": null,
				"address1": null,
				"address2": null,
				"city": null,
				"region": null,
				"postalCode": null,
				"longitude": null,
				"latitude": null
			}
		];
		*/
	})
	.directive('uiHandsontable', function () {
		return {
			restrict: 'A',
			scope: {
				data: '='
			},
			replace: true,
			link: function (scope, elem, attrs) {
				elem.handsontable({
				data: scope.data,
                contextMenu: true,
				rowHeaders: true,
				minSpareRows: 1,
                colHeaders: ["Delete", "Plant Name", "Plant Id", "E-PRTR national ID", "Address 1", "Address 2", "City", "Region", "Postal code", "Longitude", "Latitude"],
                columns: [
                    {
                        data: "delete",
                        type: "checkbox"
                    },
                    {
                        data: "plantName"
                    },
                    {
                        data: "plantId",
                        type: 'numeric'
                    },
                    {
                        data: "eprtrNationalId",
                        type: 'numeric'
                    },
                    {
                        data: "address1"
                    },
                    {
                        data: "address2"
                    },
                    {
                        data: "city"
                    },
                    {
                        data: "region"
                    },
                    {
                        data: "postalCode",
                        type: 'numeric'
                    },
                    {
                        data: "longitude",
                        type: 'numeric',
                        format: '000.000'
                    },
                    {
                        data: "latitude",
                        type: 'numeric',
                        format: '000.000'
                    }
                ]
            })
        }
    }
	})
},{}],14:[function(require,module,exports){
// Module that provides multiselect box to webform from json-ld format.
//
// Usage Example:
// <div multiselect class="multiselect" name="TypeOfUse" multiple="true"
//      ng-model="row.TypeOfUse"
//      options="annex1Concept['@id'] as annex1Concept.prefLabel[0]['@value'] for annex1Concept in codeList.LCPCodelists.Annex1Activities.concepts"
//      change="selected()" required></div>
//
// Note! options instead of ng-options is used.
angular.module('ui.multiselect', [
        'multiselect.tpl.html'
    ])

    //from bootstrap-ui typeahead parser
    .factory('optionParser', ['$parse', function ($parse) {

        //                      00000111000000000000022200000000000000003333333333333330000000000044000
        var TYPEAHEAD_REGEXP = /^\s*(.*?)(?:\s+as\s+(.*?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+(.*)$/;

        return {
            parse: function (input) {

                var match = input.match(TYPEAHEAD_REGEXP), modelMapper, viewMapper, source;
                if (!match) {
                    throw new Error(
                        "Expected typeahead specification in form of '_modelValue_ (as _label_)? for _item_ in _collection_'" +
                            " but got '" + input + "'.");
                }

                return {
                    itemName: match[3],
                    source: $parse(match[4]),
                    viewMapper: $parse(match[2] || match[1]),
                    modelMapper: $parse(match[1])
                };
            }
        };
    }])

    .directive('multiselect', ['$parse', '$document', '$compile', '$interpolate', 'optionParser',

        function ($parse, $document, $compile, $interpolate, optionParser) {
            return {
                restrict: 'AE',
                require: 'ngModel',
                link: function (originalScope, element, attrs, modelCtrl) {

                    var exp = attrs.options,
                        parsedResult = optionParser.parse(exp),
                        isMultiple = (attrs.multiple === "true") ? true : false,
                        showCheckAll = (attrs.showcheckall === "true") ? true : false,
                        showFilter = (attrs.showfilter === "true") ? true : false,
                        required = false,
                        scope = originalScope.$new(),
                        changeHandler = attrs.change || angular.noop;

                    scope.groups = [];
                    scope.header = 'Select';
                    scope.multiple = isMultiple;
                    scope.disabled = false;
                    scope.showCheckAll = showCheckAll;
                    scope.showFilter = showFilter;

                    originalScope.$on('$destroy', function () {
                        scope.$destroy();
                    });

                    var popUpEl = angular.element('<multiselect-popup></multiselect-popup>');

                    //required validator
                    if (attrs.required || attrs.ngRequired) {
                        required = true;
                    }
                    attrs.$observe('required', function(newVal) {
                        required = newVal;
                    });

                    //watch disabled state
                    scope.$watch(function () {
                        return $parse(attrs.disabled)(originalScope);
                    }, function (newVal) {
                        scope.disabled = newVal;
                    });

                    //watch single/multiple state for dynamically change single to multiple
                    scope.$watch(function () {
                        return $parse(attrs.multiple)(originalScope);
                    }, function (newVal) {
                        isMultiple = newVal || false;
                    });

                    //watch option changes for options that are populated dynamically
                    scope.$watch(function () {
                        return parsedResult.source(originalScope);
                    }, function (newVal) {
                        if (angular.isDefined(newVal))
                            parseModel();
                    }, true);

                    //watch model change
                    scope.$watch(function () {
                        return modelCtrl.$modelValue;
                    }, function (newVal, oldVal) {
                        //when directive initialize, newVal usually undefined. Also, if model value already set in the controller
                        //for preselected list then we need to mark checked in our scope item. But we don't want to do this every time
                        //model changes. We need to do this only if it is done outside directive scope, from controller, for example.
                        if (angular.isDefined(newVal)) {
                            markChecked(newVal);
                         //   scope.$eval(changeHandler);
                        }
                        getHeaderText();
                        modelCtrl.$setValidity('required', scope.valid());
                    }, true);

                    function parseModel() {
                        scope.groups.length = 0;
                        var model = parsedResult.source(originalScope);
                        var groupIndex = 0;
                        var groupIdIndexMap = {};
                        var defaultGroup = [];
                        defaultGroup.items = [];
                        if(!angular.isDefined(model)) return;

                        for (var i = 0; i < model.length; i++) {
                            if (angular.isDefined(model[i].narrower) && model[i].narrower.length > 0){
                                //now we have groups
                                scope.groups[groupIndex] = { "name" : model[i].prefLabel[0]['@value'], "items" : []};
                                groupIdIndexMap[model[i]['@id']] = groupIndex;
                                groupIndex++;
                                continue;
                            }

                            var group = defaultGroup; //if there is no group or group cannot be found, then add it to default group
                            if (angular.isDefined(model[i].broader) && model[i].broader.length == 1 && angular.isDefined(groupIdIndexMap[model[i].broader[0]['@id']])) {
                                //now we have a sub element
                                group = scope.groups[groupIdIndexMap[model[i].broader[0]['@id']]];
                            }

                            var local = {};
                            local[parsedResult.itemName] = model[i];
                            var checked = false;
                            if (modelCtrl.$modelValue) {
                                //TODO what is this modelCtrl and modelValue
                                if(!(modelCtrl.$modelValue instanceof Array) && model[i]['@id'] === modelCtrl.$modelValue) {
                                    checked = true;
                                } else if((modelCtrl.$modelValue instanceof Array) && contains(modelCtrl.$modelValue, model[i]['@id'])) {
                                    checked = true;
                                }
                            }

                            group.items.push({
                                label: parsedResult.viewMapper(local),
                                model: model[i]['@id'],
                                checked: checked
                            });
                        }

                        // now add default group
                        scope.groups[groupIndex] = defaultGroup;
                    } //end of function parseModel

                    function contains(array, needle) {
                        for (var i = 0; i < array.length; i++){
                            if (array[i] == needle) {
                                return true;
                            }
                        }
                        return false;
                    }

                    parseModel();

                    element.append($compile(popUpEl)(scope));

                    function getHeaderText() {
                        var defaultHeader = 'Select';

                        if (!modelCtrl.$modelValue) return scope.header = attrs.msHeader || defaultHeader;

                        if (modelCtrl.$modelValue && modelCtrl.$modelValue instanceof Array) {
                            if (attrs.msSelected) {
                                scope.header = $interpolate(attrs.msSelected)(scope);
                            } else {
                                scope.header = modelCtrl.$modelValue[0] != ''? modelCtrl.$modelValue.length + ' ' + 'selected' : defaultHeader;
                            }

                        } else if(modelCtrl.$modelValue && typeof 0){
                            scope.header = '1 selected';
                        } else {
                            var local = {};
                            local[parsedResult.itemName] = modelCtrl.$modelValue;
                            scope.header = parsedResult.viewMapper(local);
                        }
                    }

                    function is_empty(obj) {
                        if (!obj) return true;
                        if (obj.length && obj.length > 0) return false;
                        for (var prop in obj) if (obj[prop]) return false;
                        return true;
                    };

                    scope.valid = function validModel() {
                        if(!required) return true;
                        var value = modelCtrl.$modelValue;
                        return (angular.isArray(value) && value.length > 0) || (!angular.isArray(value) && value != null);
                    };

                    function selectSingle(item) {
                        if (item.checked) {
                            scope.uncheckAll();
                        } else {
                            scope.uncheckAll();
                            item.checked = !item.checked;
                        }
                        setModelValue(false);
                    }

                    function selectMultiple(item) {
                        item.checked = !item.checked;
                        setModelValue(true);
                    }

                    function setModelValue(isMultiple) {
                        var value;

                        if (isMultiple) {
                            value = [];
                            angular.forEach(scope.groups, function (group) {
                                angular.forEach(group.items, function (item) {
                                    if (item.checked){
                                        value.push(item.model);
                                    }
                                })
                            })
                        } else {
                            angular.forEach(scope.groups, function (group) {
                                angular.forEach(group.items, function (item) {
                                    if (item.checked) {
                                        value = item.model;
                                        return false;
                                    }
                                })
                            })
                        }
                        modelCtrl.$setViewValue(value);
                    }

                    function markChecked(newVal) {
                        if (!angular.isArray(newVal)) {
                            if (!!newVal && typeof newVal !== "string") {
                                newVal = newVal.toString();
                            }
                            angular.forEach(scope.groups, function (group) {
                                angular.forEach(group.items, function (item) {
                                    if (angular.equals(item.model, newVal)) {
                                        item.checked = true;
                                        return false;
                                    }
                                })
                            });
                        } else {
                            angular.forEach(scope.groups, function (group) {
                                angular.forEach(group.items, function (item) {
                                    item.checked = false;
                                    angular.forEach(newVal, function (i) {
                                        if (!!i && typeof i !== "string") {
                                            i = i.toString();
                                        }
                                        if (angular.equals(item.model, i)) {
                                            item.checked = true;
                                        }
                                    });
                                })
                            });
                        }
                    }

                    scope.checkAll = function () {
                        if (!isMultiple) return;
                        angular.forEach(scope.groups, function (group) {
                            angular.forEach(group.items, function (item) {
                                item.checked = true;
                            })
                        });
                        setModelValue(true);
                    };

                    scope.uncheckAll = function () {
                        angular.forEach(scope.groups, function (group) {
                            angular.forEach(group.items, function (item) {
                                item.checked = false;
                            })
                        });
                        setModelValue(true);
                    };

                    scope.select = function (item) {
                        if (isMultiple === false) {
                            selectSingle(item);
                            scope.toggleSelect();
                        } else {
                            selectMultiple(item);
                        }
                    }
                }
            };
        }])

    .directive('multiselectPopup', ['$document', function ($document) {
        return {
            restrict: 'AE',
            scope: false,
            replace: true,
            templateUrl: 'multiselect.tpl.html',
            link: function (scope, element, attrs) {

                scope.isVisible = false;

                scope.toggleSelect = function () {
                    if (element.hasClass('open')) {
                        element.removeClass('open');
                        $document.unbind('click', clickHandler);
                    } else {
                        element.addClass('open');
                        $document.bind('click', clickHandler);
                        //scope.focus();
                    }
                };

                function clickHandler(event) {
                    if (elementMatchesAnyInArray(event.target, element.find(event.target.tagName)))
                        return;
                    element.removeClass('open');
                    $document.unbind('click', clickHandler);
                    scope.$apply();
                }

//                scope.focus = function focus(){
//                    var searchBox = element.find('input')[0];
//                    searchBox.focus();
//                }

                var elementMatchesAnyInArray = function (element, elementArray) {
                    for (var i = 0; i < elementArray.length; i++)
                        if (element == elementArray[i])
                            return true;
                    return false;
                }
            }
        }
    }]);

angular.module('multiselect.tpl.html', [])

    .run(['$templateCache', function($templateCache) {
        $templateCache.put('multiselect.tpl.html',

            "<div class=\"dropdown\">\n" +
                "  <button type=\"button\" class=\"btn btn-default\" ng-click=\"toggleSelect()\" ng-disabled=\"disabled\" ng-class=\"{'error': !valid()}\">\n" +
                "    {{header}} <span class=\"caret\"></span>\n" +
                "  </button>\n" +
                "  <ul class=\"dropdown-menu\">\n" +
                "    <li ng-show=\"showFilter\">\n" +
                "      <input class=\"form-control input-sm\" type=\"text\" ng-model=\"searchText.label\" autofocus=\"autofocus\" placeholder=\"Filter\" />\n" +
                "    </li>\n" +
                "    <li ng-show=\"multiple && showCheckAll\" role=\"presentation\" class=\"\">\n" +
                "      <button class=\"btn btn-link btn-xs\" ng-click=\"checkAll()\" type=\"button\"><i class=\"icon-ok\"></i> Check all</button>\n" +
                "      <button class=\"btn btn-link btn-xs\" ng-click=\"uncheckAll()\" type=\"button\"><i class=\"icon-remove\"></i> Uncheck all</button>\n" +
                "    </li>\n" +
                "    <div ng-repeat=\"i in groups\">\n" +
                "       <div>\n" +
                "           <h5>{{i.name}}</h5>"+
                "       </div>\n" +
                "       <div class=\"dropdown-container\" ng-repeat=\"j in i.items | filter:searchText\">\n" +
                "           <a ng-click=\"select(j); focus()\">\n" +
                "               <i ng-class=\"{'icon-ok': j.checked, 'icon-empty': !j.checked}\"></i> {{j.label}}</a>\n" +
                "       </div>\n" +
                "    </div>\n" +
                "  </ul>\n" +
                "</div>");
    }]);

},{}],15:[function(require,module,exports){
/**
 * Created by argoaava on 22.04.14.
 */

// Module that provides functionality to ask confirmation from user when
// form has changed and user tries to leave page without saving.
//
// Usage example:
//
// <div ng-form="appForm" novalidate class="css-form" ng-class="{ 'submitted' : submitted }" td-navigation-blocker-form>
//
// 'td-navigation-blocker-form' must be specified as attribute for the form that confirmation functionality
// must apply to.

//FIXME should be able to make it so that rootScope is not used.
angular.module('navigation.navigationBlocker', [])
    .run(['$rootScope', '$location', function ($rootScope, $location) {
        var _preventNavigation = false;
        var _preventNavigationUrl = null;

        $rootScope.allowNavigation = function() {
            _preventNavigation = false;
        };

        $rootScope.preventNavigation = function() {
            _preventNavigation = true;
            _preventNavigationUrl = $location.absUrl();
        }

        $rootScope.$on('$locationChangeStart', function (event, newUrl, oldUrl) {
            // Allow navigation if our old url wasn't where we prevented navigation from
            if (_preventNavigationUrl != oldUrl || _preventNavigationUrl == null) {
                $rootScope.allowNavigation();
                return;
            }

            if (_preventNavigation && !confirm("You have unsaved changes, do you want to continue?")) {
                event.preventDefault();
            }
            else {
                $rootScope.allowNavigation();
            }
        });

        // Take care of preventing navigation out of our angular app
        window.onbeforeunload = function() {
            // Use the same data that we've set in our angular app
            if (_preventNavigation && $location.absUrl() == _preventNavigationUrl) {
                return "You have unsaved changes, do you want to continue?";
            }
        }
    }])

    .directive("blockFormNavigation", function () {
        return {
            restrict: 'A',
            require: ['^form'],
            link: function (scope, element, attrs, formController) {
                scope.$watch(attrs.ngForm + '.$dirty', function (dirty) {
                    if (dirty) {
                        scope.$root.preventNavigation();
                    } else {
                        scope.$root.allowNavigation();
                    }
                });
            }
        }
    })



},{}],16:[function(require,module,exports){
'use strict';
//  Service for creating notifications.
//  Origin: https://github.com/DerekRies/Angular-Notifications
//
//  Dependencies:
//      It use Bootstrab component:  http://getbootstrap.com/components/

//  Installation:
//      1. Add script file:
//          <script src="notification.js"></script>
//
//      2. Add css to your webform:
//          <link rel="stylesheet" href="notification.css"/>
//
//      3. Add notifications module as a dependency of your app module:
//          e.g angular.module('ngcomponentsApp', ['notifications'])
//
//      4. Add a div to your body tag somewhere and give it a
//          notifications directive specifying its position like so:
//              <div notifications="bottom right"></div>
//
// Usage Example:
//      You can use these methods with the following
//      line of code (userData parameter is optional, currently title is not used):
//
//    $notification.info(title, content, userData);
//    $notification.warning(title, content, userData);
//    $notification.error("Save", "Data is not saved !");
//    $notification.success("Save", "Data is saved successfully.");
//
angular.module('notifications', []).
    factory('$notification', ['$timeout',function($timeout){

        //console.log('notification service online');
        var notifications = JSON.parse(localStorage.getItem('$notifications')) || [],
            queue = [];

        var settings = {
            info: { duration: 5000, enabled: true },
            warning: { duration: 5000, enabled: true },
            error: { duration: 5000, enabled: true },
            success: { duration: 5000, enabled: true },
            progress: { duration: 0, enabled: true },
            custom: { duration: 35000, enabled: true },
            details: true,
            localStorage: false,
            html5Mode: false,
            html5DefaultIcon: 'icon.png'
        };

        function html5Notify(icon, title, content, ondisplay, onclose){
            if(window.webkitNotifications.checkPermission() === 0){
                if(!icon){
                    icon = 'favicon.ico';
                }
                var noti = window.webkitNotifications.createNotification(icon, title, content);
                if(typeof ondisplay === 'function'){
                    noti.ondisplay = ondisplay;
                }
                if(typeof onclose === 'function'){
                    noti.onclose = onclose;
                }
                noti.show();
            }
            else {
                settings.html5Mode = false;
            }
        }


        return {

            /* ========== SETTINGS RELATED METHODS =============*/

            disableHtml5Mode: function(){
                settings.html5Mode = false;
            },

            disableType: function(notificationType){
                settings[notificationType].enabled = false;
            },

            enableHtml5Mode: function(){
                // settings.html5Mode = true;
                settings.html5Mode = this.requestHtml5ModePermissions();
            },

            enableType: function(notificationType){
                settings[notificationType].enabled = true;
            },

            getSettings: function(){
                return settings;
            },

            toggleType: function(notificationType){
                settings[notificationType].enabled = !settings[notificationType].enabled;
            },

            toggleHtml5Mode: function(){
                settings.html5Mode = !settings.html5Mode;
            },

            requestHtml5ModePermissions: function(){
                if (window.webkitNotifications){
                    //console.log('notifications are available');
                    if (window.webkitNotifications.checkPermission() === 0) {
                        return true;
                    }
                    else{
                        window.webkitNotifications.requestPermission(function(){
                            if(window.webkitNotifications.checkPermission() === 0){
                                settings.html5Mode = true;
                            }
                            else{
                                settings.html5Mode = false;
                            }
                        });
                        return false;
                    }
                }
                else{
                    //console.log('notifications are not supported');
                    return false;
                }
            },


            /* ============ QUERYING RELATED METHODS ============*/

            getAll: function(){
                // Returns all notifications that are currently stored
                return notifications;
            },

            getQueue: function(){
                return queue;
            },

            /* ============== NOTIFICATION METHODS ==============*/

            info: function(title, content, userData){
                //console.log(title, content);
                return this.awesomeNotify('info','info-sign', title, content, userData);
            },

            error: function(title, content, userData){
                return this.awesomeNotify('error', 'remove-sign', title, content, userData);
            },

            success: function(title, content, userData){
                return this.awesomeNotify('success', 'ok-sign', title, content, userData);
            },

            warning: function(title, content, userData){
                return this.awesomeNotify('warning', 'exclamation-sign', title, content, userData);
            },

            awesomeNotify: function(type, icon, title, content, userData){
                /**
                 * Supposed to wrap the makeNotification method for drawing icons using font-awesome
                 * rather than an image.
                 *
                 * Need to find out how I'm going to make the API take either an image
                 * resource, or a font-awesome icon and then display either of them.
                 * Also should probably provide some bits of color, could do the coloring
                 * through classes.
                 */
                // image = '<i class="icon-' + image + '"></i>';
                return this.makeNotification(type, false, icon, title, content, userData);
            },

            notify: function(image, title, content, userData){
                // Wraps the makeNotification method for displaying notifications with images
                // rather than icons
                return this.makeNotification('custom', image, true, title, content, userData);
            },

            makeNotification: function(type, image, icon, title, content, userData){
                var notification = {
                    'type': type,
                    'image': image,
                    'icon': icon,
                    'title': title,
                    'content': content,
                    'timestamp': +new Date(),
                    'userData': userData
                };
                notifications.push(notification);

                if(settings.html5Mode){
                    html5Notify(image, title, content, function(){
                        //console.log("inner on display function");
                    }, function(){
                        //console.log("inner on close function");
                    });
                }
                else{
                    queue.push(notification);
                    $timeout(function removeFromQueueTimeout(){
                        queue.splice(queue.indexOf(notification), 1);
                    }, settings[type].duration);

                }

                this.save();
                return notification;
            },


            /* ============ PERSISTENCE METHODS ============ */

            save: function(){
                // Save all the notifications into localStorage
                // console.log(JSON);
                if(settings.localStorage){
                    localStorage.setItem('$notifications', JSON.stringify(notifications));
                }
                // console.log(localStorage.getItem('$notifications'));
            },

            restore: function(){
                // Load all notifications from localStorage
            },

            clear: function(){
                notifications = [];
                this.save();
            }

        };
    }]).
    directive('notifications', ['$notification', '$compile', function($notification, $compile){
        /**
         *
         * It should also parse the arguments passed to it that specify
         * its position on the screen like "bottom right" and apply those
         * positions as a class to the container element
         *
         * Finally, the directive should have its own controller for
         * handling all of the notifications from the notification service
         */
        //console.log('this is a new directive');
        var html =
            '<div class="dr-notification-wrapper" ng-repeat="noti in queue">' +
                '<div class="dr-notification-close-btn" ng-click="removeNotification(noti)">' +
                    '<i class="glyphicon glyphicon-remove"></i>' +
                '</div>' +
                '<div class="dr-notification noti-back-ground-{{noti.type}}">' +
                    '<div class="dr-notification-image dr-notification-type-{{noti.type}}" ng-switch on="noti.image">' +
                        '<i class="glyphicon glyphicon-{{noti.icon}}" ng-switch-when="false"></i>' +
                        '<img ng-src="{{noti.image}}" ng-switch-default />' +
                    '</div>' +
                    '<div class="dr-notification-content">' +
                        /*'<h3 class="dr-notification-title">{{noti.title}}</h3>' + */
                        '<p class="dr-notification-text">{{noti.content}}</p>' +
                    '</div>' +
                '</div>' +
            '</div>';


        function link(scope, element, attrs){
            var position = attrs.notifications;
            position = position.split(' ');
            element.addClass('dr-notification-container');
            for(var i = 0; i < position.length ; i++){
                element.addClass(position[i]);
            }
        }


        return {
            restrict: 'A',
            scope: {},
            template: html,
            link: link,
            controller: ['$scope', function NotificationsCtrl( $scope ){
                $scope.queue = $notification.getQueue();

                $scope.removeNotification = function(noti){
                    $scope.queue.splice($scope.queue.indexOf(noti), 1);
                };
            }
            ]

        };
    }]);
},{}],17:[function(require,module,exports){
'use strict';

(
    function(angular) {
        return angular
            .module('ngOrderObjectBy', [])
            .filter('orderObjectBy', function() {
                return function (items, field, reverse) {
                    var filtered = [];
                    angular.forEach(items, function(item) {
                        filtered.push(item);
                    });
                    function index(obj, i) {
                        return obj[i];
                    }
                    filtered.sort(function (a, b) {
                        var comparator;
                        var reducedA = field.split('.').reduce(index, a);
                        var reducedB = field.split('.').reduce(index, b);
                        if (reducedA === reducedB) {
                            comparator = 0;
                        } else {
                            comparator = (reducedA > reducedB ? 1 : -1);
                        }
                        return comparator;
                    });
                    if (reverse) {
                        filtered.reverse();
                    }
                    return filtered;
                };
            });
    }
    )(angular);
},{}],18:[function(require,module,exports){
/**
 * Created by argoaava on 13.05.14.
 */


// Module that contains functionality for tab navigation. User must fill 'tabService' with
// available tabs as follows:
//
// app.run(function($rootScope, promiseTracker, $location, tabService) {
//      tabService.setTabs([
//          {"id":"Table1","active" : true},
//          {"id":"Table2","active" : false},
//          {"id":"Table3","active" : false},
//          {"id":"Table4","active" : false},
//          {"id":"Table5","active" : false}]);
// });
//
// then 'TabController' must be set to elements that want to interact with
// tabService.
//
// <ul tabset ng-cloak ng-controller="TabController">
//      <div ng-class="{'invalidTab' : isInvalidTab('Table1')}">
//          <li tab heading="Table 1" active="tabs[getTabIndex('Table1')].active">
//          </li>
//      </div>
// </ul>
//
// or
//
// <div class="animate-show" ng-show="showMenu" style="float:right" ng-controller="TabController">
//      <input type="button" ng-click="previousTab()" value="Prev" class="btn btn-default btn-primary" ng-disabled="getActiveTabIndex() == 0">
//      <input type="button" ng-click="nextTab()" value="Next" class="btn btn-default btn-primary" ng-disabled="getActiveTabIndex() == (tabs.length - 1)"/>
// </div>
//
angular.module('tabs.formTabs', [])
    .service('tabService', function() {
        this.tabs = [];

        this.getTabs = function() {
            return this.tabs;
        }

        this.setTabs = function(tabs) {
            this.tabs = tabs;
        }
    })
    .controller("TabController", function ($scope, $rootScope, $location, $timeout, $anchorScroll, tabService) {
        

        if (tabService.getTabs().length == 0) {
            throw Error("You must configure tabService");
        }

        $scope.tabs = tabService.tabs;

        $scope.goto = function (tab, id){
            for (var i = 0; i < $scope.tabs.length; i++) {
                if ($scope.tabs[i].id == tab) {
                    $scope.tabs[i].active = true;
                } else {
                    $scope.tabs[i].active = false;
                }
            }

            var old = $location.hash();
            $timeout(function() {
                $location.hash(id);
                $anchorScroll();
                $location.hash(old);
            }, 200);
        };

        $scope.getActiveTabIndex = function() {
            for (var i = 0; i < $scope.tabs.length; i++) {
                if ($scope.tabs[i].active == true) {
                    return i;
                }
            }
            return 0;
        };

        $scope.getTabIndex = function(tabId) {
            for (var i = 0; i < $scope.tabs.length; i++) {
                if ($scope.tabs[i].id == tabId) {
                    return i;
                }
            }
            return -1;
        };

        $scope.nextTab = function(){
            var activeTabIndex = $scope.getActiveTabIndex();
            var nextTab = (activeTabIndex + 1 <= $scope.tabs.length)? activeTabIndex+1 : activeTabIndex;
            $scope.goto($scope.tabs[nextTab].id, 'beginning');
        };

        $scope.previousTab = function(){
            var activeTabIndex = $scope.getActiveTabIndex();
            var previousTab = (activeTabIndex - 1 >= 0)? activeTabIndex - 1 : activeTabIndex;
            $scope.goto($scope.tabs[previousTab].id, 'beginning');
        };

        $scope.isInvalidTab = function(tabId) {
            return $scope.submitted && $scope.appForm[tabId].$invalid;
        };
    })
},{}],19:[function(require,module,exports){
/**
 * Created by argoaava on 13.05.14.
 */

//Checks if array is empty.
window.isEmptyArray = function(array) {
    if (!(array instanceof Array)) {
        throw Error("Element not array");
    }

    for (var i = 0; i < array.length; i++) {
        if (!array[i]) {
            continue;
        } else {
            return false;
        }
    }
    return true;
}

// Counts all properties of an object or array.
// Reduces the count by one when object is considered fixed question
// in this case first element of object is prefilled and must not be counted.
window.countNonEmptyProperties = function(objectOrArray, isFixedQuestion) {
    var count = 0;

    if (!(objectOrArray instanceof Array)) {
        count = countObjectProperties(objectOrArray);
    } else {
        for (var i = 0; i < objectOrArray.length; i++) {
            var objectCount = countObjectProperties(objectOrArray[i]);

            if (isFixedQuestion) {
                objectCount -= 1;
            }

            count += objectCount;
        }
    }
    return count;
};

// Counts only
window.countObjectProperties = function(object) {
    var count = 0;

    //For primitives
    if (!(typeof object === 'object') &&
        !(typeof object === 'array')) {
            return 1;
    }

    for (var i in object) {
        if (object.hasOwnProperty(i)
            && !!object[i]
            && (i != '$$hashKey')) {

            if (typeof object[i] === 'object') {
                var objectElementCount = countNonEmptyProperties(object[i]);
                count += objectElementCount;
            } else {
                count++;
            }
        }
    }
    return count;
};

// Clears object or array data. When object is array all other elements except
// first are deleted.
window.clearObject = function(object, keepFirst) {
    if (!(object instanceof Array)) {

        var indexCounter = 0;
        for (var i in object) {
            if (object.hasOwnProperty(i)) {
                if (indexCounter == 0 && keepFirst) {
                } else {
                    object[i] = null;
                }
            }
            indexCounter++;
        }
    } else {
        clearArray(object, keepFirst);
    }

}

// Deletes all other array elements expect first one and
// clears all data from first element.
window.clearArray =function(array, keepRow) {
    for (var i = array.length; i > 0; i--) {
        if (keepRow) {
            clearObject(array[i], keepRow);
        } else {
            array.splice(i, 1);
        }
    }
    clearObject(array[0], keepRow);

    // For arrays that contain primitives. Last element must be
    // left but has to be empty so element is still present after
    // conversion to xml.
    if (!(array[0] instanceof Object)) {
        array[0] = "";
        return;
    }
}

//Clone object.
window.clone = function(obj) {
    // Handle the 3 simple types, and null or undefined
    if (null == obj || "object" != typeof obj) return obj;

    // Handle Date
    if (obj instanceof Date) {
        var copy = new Date();
        copy.setTime(obj.getTime());
        return copy;
    }

    // Handle Array
    if (obj instanceof Array) {
        var copy = [];
        for (var i = 0, len = obj.length; i < len; i++) {
            copy[i] = clone(obj[i]);
        }
        return copy;
    }

    // Handle Object
    if (obj instanceof Object) {
        var copy = {};
        for (var attr in obj) {
            if (obj.hasOwnProperty(attr)) copy[attr] = clone(obj[attr]);
        }
        return copy;
    }

    throw new Error("Unable to copy obj! Its type isn't supported.");
}

// Function is used before saving JSON object back to XML file. When deleting field on the form
// angular sets it to undefined which breaks the order of elements if converted to XML.
window.fixUndefined = function(obj) {
    var isArray = obj instanceof Array;
    for (var j in obj) {
        if (obj.hasOwnProperty(j)) {
            if (typeof(obj[j]) == "object") {
                fixUndefined(obj[j]);
            } else if(!isArray && j != '$$hashkey') {
                if (typeof obj[j] == 'undefined') {
                    obj[j] = null;
                }
            }
        }
    }
}

// helper function for getting query string parameter values. AngularJS solution $location.search() doesn't work in IE8.
window.getParameterByName = function(name) {
    // FIXME - WebQ instance param is not escaped
    var searchArr = window.location.search.split('?');
    var search = '?' + searchArr[searchArr.length - 1];
    var match = new RegExp('[?&]' + name + '=([^&]*)').exec(search);
    return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
};
},{}],20:[function(require,module,exports){
/**
 * @license AngularJS v1.2.16
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
(function(window, angular, undefined) {'use strict';

/* jshint maxlen: false */

/**
 * @ngdoc module
 * @name ngAnimate
 * @description
 *
 * # ngAnimate
 *
 * The `ngAnimate` module provides support for JavaScript, CSS3 transition and CSS3 keyframe animation hooks within existing core and custom directives.
 *
 *
 * <div doc-module-components="ngAnimate"></div>
 *
 * # Usage
 *
 * To see animations in action, all that is required is to define the appropriate CSS classes
 * or to register a JavaScript animation via the myModule.animation() function. The directives that support animation automatically are:
 * `ngRepeat`, `ngInclude`, `ngIf`, `ngSwitch`, `ngShow`, `ngHide`, `ngView` and `ngClass`. Custom directives can take advantage of animation
 * by using the `$animate` service.
 *
 * Below is a more detailed breakdown of the supported animation events provided by pre-existing ng directives:
 *
 * | Directive                                                 | Supported Animations                               |
 * |---------------------------------------------------------- |----------------------------------------------------|
 * | {@link ng.directive:ngRepeat#usage_animations ngRepeat}         | enter, leave and move                              |
 * | {@link ngRoute.directive:ngView#usage_animations ngView}        | enter and leave                                    |
 * | {@link ng.directive:ngInclude#usage_animations ngInclude}       | enter and leave                                    |
 * | {@link ng.directive:ngSwitch#usage_animations ngSwitch}         | enter and leave                                    |
 * | {@link ng.directive:ngIf#usage_animations ngIf}                 | enter and leave                                    |
 * | {@link ng.directive:ngClass#usage_animations ngClass}           | add and remove                                     |
 * | {@link ng.directive:ngShow#usage_animations ngShow & ngHide}    | add and remove (the ng-hide class value)           |
 * | {@link ng.directive:form#usage_animations form}                 | add and remove (dirty, pristine, valid, invalid & all other validations)                |
 * | {@link ng.directive:ngModel#usage_animations ngModel}           | add and remove (dirty, pristine, valid, invalid & all other validations)                |
 *
 * You can find out more information about animations upon visiting each directive page.
 *
 * Below is an example of how to apply animations to a directive that supports animation hooks:
 *
 * ```html
 * <style type="text/css">
 * .slide.ng-enter, .slide.ng-leave {
 *   -webkit-transition:0.5s linear all;
 *   transition:0.5s linear all;
 * }
 *
 * .slide.ng-enter { }        /&#42; starting animations for enter &#42;/
 * .slide.ng-enter-active { } /&#42; terminal animations for enter &#42;/
 * .slide.ng-leave { }        /&#42; starting animations for leave &#42;/
 * .slide.ng-leave-active { } /&#42; terminal animations for leave &#42;/
 * </style>
 *
 * <!--
 * the animate service will automatically add .ng-enter and .ng-leave to the element
 * to trigger the CSS transition/animations
 * -->
 * <ANY class="slide" ng-include="..."></ANY>
 * ```
 *
 * Keep in mind that if an animation is running, any child elements cannot be animated until the parent element's
 * animation has completed.
 *
 * <h2>CSS-defined Animations</h2>
 * The animate service will automatically apply two CSS classes to the animated element and these two CSS classes
 * are designed to contain the start and end CSS styling. Both CSS transitions and keyframe animations are supported
 * and can be used to play along with this naming structure.
 *
 * The following code below demonstrates how to perform animations using **CSS transitions** with Angular:
 *
 * ```html
 * <style type="text/css">
 * /&#42;
 *  The animate class is apart of the element and the ng-enter class
 *  is attached to the element once the enter animation event is triggered
 * &#42;/
 * .reveal-animation.ng-enter {
 *  -webkit-transition: 1s linear all; /&#42; Safari/Chrome &#42;/
 *  transition: 1s linear all; /&#42; All other modern browsers and IE10+ &#42;/
 *
 *  /&#42; The animation preparation code &#42;/
 *  opacity: 0;
 * }
 *
 * /&#42;
 *  Keep in mind that you want to combine both CSS
 *  classes together to avoid any CSS-specificity
 *  conflicts
 * &#42;/
 * .reveal-animation.ng-enter.ng-enter-active {
 *  /&#42; The animation code itself &#42;/
 *  opacity: 1;
 * }
 * </style>
 *
 * <div class="view-container">
 *   <div ng-view class="reveal-animation"></div>
 * </div>
 * ```
 *
 * The following code below demonstrates how to perform animations using **CSS animations** with Angular:
 *
 * ```html
 * <style type="text/css">
 * .reveal-animation.ng-enter {
 *   -webkit-animation: enter_sequence 1s linear; /&#42; Safari/Chrome &#42;/
 *   animation: enter_sequence 1s linear; /&#42; IE10+ and Future Browsers &#42;/
 * }
 * @-webkit-keyframes enter_sequence {
 *   from { opacity:0; }
 *   to { opacity:1; }
 * }
 * @keyframes enter_sequence {
 *   from { opacity:0; }
 *   to { opacity:1; }
 * }
 * </style>
 *
 * <div class="view-container">
 *   <div ng-view class="reveal-animation"></div>
 * </div>
 * ```
 *
 * Both CSS3 animations and transitions can be used together and the animate service will figure out the correct duration and delay timing.
 *
 * Upon DOM mutation, the event class is added first (something like `ng-enter`), then the browser prepares itself to add
 * the active class (in this case `ng-enter-active`) which then triggers the animation. The animation module will automatically
 * detect the CSS code to determine when the animation ends. Once the animation is over then both CSS classes will be
 * removed from the DOM. If a browser does not support CSS transitions or CSS animations then the animation will start and end
 * immediately resulting in a DOM element that is at its final state. This final state is when the DOM element
 * has no CSS transition/animation classes applied to it.
 *
 * <h3>CSS Staggering Animations</h3>
 * A Staggering animation is a collection of animations that are issued with a slight delay in between each successive operation resulting in a
 * curtain-like effect. The ngAnimate module, as of 1.2.0, supports staggering animations and the stagger effect can be
 * performed by creating a **ng-EVENT-stagger** CSS class and attaching that class to the base CSS class used for
 * the animation. The style property expected within the stagger class can either be a **transition-delay** or an
 * **animation-delay** property (or both if your animation contains both transitions and keyframe animations).
 *
 * ```css
 * .my-animation.ng-enter {
 *   /&#42; standard transition code &#42;/
 *   -webkit-transition: 1s linear all;
 *   transition: 1s linear all;
 *   opacity:0;
 * }
 * .my-animation.ng-enter-stagger {
 *   /&#42; this will have a 100ms delay between each successive leave animation &#42;/
 *   -webkit-transition-delay: 0.1s;
 *   transition-delay: 0.1s;
 *
 *   /&#42; in case the stagger doesn't work then these two values
 *    must be set to 0 to avoid an accidental CSS inheritance &#42;/
 *   -webkit-transition-duration: 0s;
 *   transition-duration: 0s;
 * }
 * .my-animation.ng-enter.ng-enter-active {
 *   /&#42; standard transition styles &#42;/
 *   opacity:1;
 * }
 * ```
 *
 * Staggering animations work by default in ngRepeat (so long as the CSS class is defined). Outside of ngRepeat, to use staggering animations
 * on your own, they can be triggered by firing multiple calls to the same event on $animate. However, the restrictions surrounding this
 * are that each of the elements must have the same CSS className value as well as the same parent element. A stagger operation
 * will also be reset if more than 10ms has passed after the last animation has been fired.
 *
 * The following code will issue the **ng-leave-stagger** event on the element provided:
 *
 * ```js
 * var kids = parent.children();
 *
 * $animate.leave(kids[0]); //stagger index=0
 * $animate.leave(kids[1]); //stagger index=1
 * $animate.leave(kids[2]); //stagger index=2
 * $animate.leave(kids[3]); //stagger index=3
 * $animate.leave(kids[4]); //stagger index=4
 *
 * $timeout(function() {
 *   //stagger has reset itself
 *   $animate.leave(kids[5]); //stagger index=0
 *   $animate.leave(kids[6]); //stagger index=1
 * }, 100, false);
 * ```
 *
 * Stagger animations are currently only supported within CSS-defined animations.
 *
 * <h2>JavaScript-defined Animations</h2>
 * In the event that you do not want to use CSS3 transitions or CSS3 animations or if you wish to offer animations on browsers that do not
 * yet support CSS transitions/animations, then you can make use of JavaScript animations defined inside of your AngularJS module.
 *
 * ```js
 * //!annotate="YourApp" Your AngularJS Module|Replace this or ngModule with the module that you used to define your application.
 * var ngModule = angular.module('YourApp', ['ngAnimate']);
 * ngModule.animation('.my-crazy-animation', function() {
 *   return {
 *     enter: function(element, done) {
 *       //run the animation here and call done when the animation is complete
 *       return function(cancelled) {
 *         //this (optional) function will be called when the animation
 *         //completes or when the animation is cancelled (the cancelled
 *         //flag will be set to true if cancelled).
 *       };
 *     },
 *     leave: function(element, done) { },
 *     move: function(element, done) { },
 *
 *     //animation that can be triggered before the class is added
 *     beforeAddClass: function(element, className, done) { },
 *
 *     //animation that can be triggered after the class is added
 *     addClass: function(element, className, done) { },
 *
 *     //animation that can be triggered before the class is removed
 *     beforeRemoveClass: function(element, className, done) { },
 *
 *     //animation that can be triggered after the class is removed
 *     removeClass: function(element, className, done) { }
 *   };
 * });
 * ```
 *
 * JavaScript-defined animations are created with a CSS-like class selector and a collection of events which are set to run
 * a javascript callback function. When an animation is triggered, $animate will look for a matching animation which fits
 * the element's CSS class attribute value and then run the matching animation event function (if found).
 * In other words, if the CSS classes present on the animated element match any of the JavaScript animations then the callback function will
 * be executed. It should be also noted that only simple, single class selectors are allowed (compound class selectors are not supported).
 *
 * Within a JavaScript animation, an object containing various event callback animation functions is expected to be returned.
 * As explained above, these callbacks are triggered based on the animation event. Therefore if an enter animation is run,
 * and the JavaScript animation is found, then the enter callback will handle that animation (in addition to the CSS keyframe animation
 * or transition code that is defined via a stylesheet).
 *
 */

angular.module('ngAnimate', ['ng'])

  /**
   * @ngdoc provider
   * @name $animateProvider
   * @description
   *
   * The `$animateProvider` allows developers to register JavaScript animation event handlers directly inside of a module.
   * When an animation is triggered, the $animate service will query the $animate service to find any animations that match
   * the provided name value.
   *
   * Requires the {@link ngAnimate `ngAnimate`} module to be installed.
   *
   * Please visit the {@link ngAnimate `ngAnimate`} module overview page learn more about how to use animations in your application.
   *
   */

  //this private service is only used within CSS-enabled animations
  //IE8 + IE9 do not support rAF natively, but that is fine since they
  //also don't support transitions and keyframes which means that the code
  //below will never be used by the two browsers.
  .factory('$$animateReflow', ['$$rAF', '$document', function($$rAF, $document) {
    var bod = $document[0].body;
    return function(fn) {
      //the returned function acts as the cancellation function
      return $$rAF(function() {
        //the line below will force the browser to perform a repaint
        //so that all the animated elements within the animation frame
        //will be properly updated and drawn on screen. This is
        //required to perform multi-class CSS based animations with
        //Firefox. DO NOT REMOVE THIS LINE.
        var a = bod.offsetWidth + 1;
        fn();
      });
    };
  }])

  .config(['$provide', '$animateProvider', function($provide, $animateProvider) {
    var noop = angular.noop;
    var forEach = angular.forEach;
    var selectors = $animateProvider.$$selectors;

    var ELEMENT_NODE = 1;
    var NG_ANIMATE_STATE = '$$ngAnimateState';
    var NG_ANIMATE_CLASS_NAME = 'ng-animate';
    var rootAnimateState = {running: true};

    function extractElementNode(element) {
      for(var i = 0; i < element.length; i++) {
        var elm = element[i];
        if(elm.nodeType == ELEMENT_NODE) {
          return elm;
        }
      }
    }

    function stripCommentsFromElement(element) {
      return angular.element(extractElementNode(element));
    }

    function isMatchingElement(elm1, elm2) {
      return extractElementNode(elm1) == extractElementNode(elm2);
    }

    $provide.decorator('$animate', ['$delegate', '$injector', '$sniffer', '$rootElement', '$$asyncCallback', '$rootScope', '$document',
                            function($delegate,   $injector,   $sniffer,   $rootElement,   $$asyncCallback,    $rootScope,   $document) {

      var globalAnimationCounter = 0;
      $rootElement.data(NG_ANIMATE_STATE, rootAnimateState);

      // disable animations during bootstrap, but once we bootstrapped, wait again
      // for another digest until enabling animations. The reason why we digest twice
      // is because all structural animations (enter, leave and move) all perform a
      // post digest operation before animating. If we only wait for a single digest
      // to pass then the structural animation would render its animation on page load.
      // (which is what we're trying to avoid when the application first boots up.)
      $rootScope.$$postDigest(function() {
        $rootScope.$$postDigest(function() {
          rootAnimateState.running = false;
        });
      });

      var classNameFilter = $animateProvider.classNameFilter();
      var isAnimatableClassName = !classNameFilter
              ? function() { return true; }
              : function(className) {
                return classNameFilter.test(className);
              };

      function lookup(name) {
        if (name) {
          var matches = [],
              flagMap = {},
              classes = name.substr(1).split('.');

          //the empty string value is the default animation
          //operation which performs CSS transition and keyframe
          //animations sniffing. This is always included for each
          //element animation procedure if the browser supports
          //transitions and/or keyframe animations. The default
          //animation is added to the top of the list to prevent
          //any previous animations from affecting the element styling
          //prior to the element being animated.
          if ($sniffer.transitions || $sniffer.animations) {
            matches.push($injector.get(selectors['']));
          }

          for(var i=0; i < classes.length; i++) {
            var klass = classes[i],
                selectorFactoryName = selectors[klass];
            if(selectorFactoryName && !flagMap[klass]) {
              matches.push($injector.get(selectorFactoryName));
              flagMap[klass] = true;
            }
          }
          return matches;
        }
      }

      function animationRunner(element, animationEvent, className) {
        //transcluded directives may sometimes fire an animation using only comment nodes
        //best to catch this early on to prevent any animation operations from occurring
        var node = element[0];
        if(!node) {
          return;
        }

        var isSetClassOperation = animationEvent == 'setClass';
        var isClassBased = isSetClassOperation ||
                           animationEvent == 'addClass' ||
                           animationEvent == 'removeClass';

        var classNameAdd, classNameRemove;
        if(angular.isArray(className)) {
          classNameAdd = className[0];
          classNameRemove = className[1];
          className = classNameAdd + ' ' + classNameRemove;
        }

        var currentClassName = element.attr('class');
        var classes = currentClassName + ' ' + className;
        if(!isAnimatableClassName(classes)) {
          return;
        }

        var beforeComplete = noop,
            beforeCancel = [],
            before = [],
            afterComplete = noop,
            afterCancel = [],
            after = [];

        var animationLookup = (' ' + classes).replace(/\s+/g,'.');
        forEach(lookup(animationLookup), function(animationFactory) {
          var created = registerAnimation(animationFactory, animationEvent);
          if(!created && isSetClassOperation) {
            registerAnimation(animationFactory, 'addClass');
            registerAnimation(animationFactory, 'removeClass');
          }
        });

        function registerAnimation(animationFactory, event) {
          var afterFn = animationFactory[event];
          var beforeFn = animationFactory['before' + event.charAt(0).toUpperCase() + event.substr(1)];
          if(afterFn || beforeFn) {
            if(event == 'leave') {
              beforeFn = afterFn;
              //when set as null then animation knows to skip this phase
              afterFn = null;
            }
            after.push({
              event : event, fn : afterFn
            });
            before.push({
              event : event, fn : beforeFn
            });
            return true;
          }
        }

        function run(fns, cancellations, allCompleteFn) {
          var animations = [];
          forEach(fns, function(animation) {
            animation.fn && animations.push(animation);
          });

          var count = 0;
          function afterAnimationComplete(index) {
            if(cancellations) {
              (cancellations[index] || noop)();
              if(++count < animations.length) return;
              cancellations = null;
            }
            allCompleteFn();
          }

          //The code below adds directly to the array in order to work with
          //both sync and async animations. Sync animations are when the done()
          //operation is called right away. DO NOT REFACTOR!
          forEach(animations, function(animation, index) {
            var progress = function() {
              afterAnimationComplete(index);
            };
            switch(animation.event) {
              case 'setClass':
                cancellations.push(animation.fn(element, classNameAdd, classNameRemove, progress));
                break;
              case 'addClass':
                cancellations.push(animation.fn(element, classNameAdd || className,     progress));
                break;
              case 'removeClass':
                cancellations.push(animation.fn(element, classNameRemove || className,  progress));
                break;
              default:
                cancellations.push(animation.fn(element, progress));
                break;
            }
          });

          if(cancellations && cancellations.length === 0) {
            allCompleteFn();
          }
        }

        return {
          node : node,
          event : animationEvent,
          className : className,
          isClassBased : isClassBased,
          isSetClassOperation : isSetClassOperation,
          before : function(allCompleteFn) {
            beforeComplete = allCompleteFn;
            run(before, beforeCancel, function() {
              beforeComplete = noop;
              allCompleteFn();
            });
          },
          after : function(allCompleteFn) {
            afterComplete = allCompleteFn;
            run(after, afterCancel, function() {
              afterComplete = noop;
              allCompleteFn();
            });
          },
          cancel : function() {
            if(beforeCancel) {
              forEach(beforeCancel, function(cancelFn) {
                (cancelFn || noop)(true);
              });
              beforeComplete(true);
            }
            if(afterCancel) {
              forEach(afterCancel, function(cancelFn) {
                (cancelFn || noop)(true);
              });
              afterComplete(true);
            }
          }
        };
      }

      /**
       * @ngdoc service
       * @name $animate
       * @function
       *
       * @description
       * The `$animate` service provides animation detection support while performing DOM operations (enter, leave and move) as well as during addClass and removeClass operations.
       * When any of these operations are run, the $animate service
       * will examine any JavaScript-defined animations (which are defined by using the $animateProvider provider object)
       * as well as any CSS-defined animations against the CSS classes present on the element once the DOM operation is run.
       *
       * The `$animate` service is used behind the scenes with pre-existing directives and animation with these directives
       * will work out of the box without any extra configuration.
       *
       * Requires the {@link ngAnimate `ngAnimate`} module to be installed.
       *
       * Please visit the {@link ngAnimate `ngAnimate`} module overview page learn more about how to use animations in your application.
       *
       */
      return {
        /**
         * @ngdoc method
         * @name $animate#enter
         * @function
         *
         * @description
         * Appends the element to the parentElement element that resides in the document and then runs the enter animation. Once
         * the animation is started, the following CSS classes will be present on the element for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during enter animation:
         *
         * | Animation Step                                                                               | What the element class attribute looks like |
         * |----------------------------------------------------------------------------------------------|---------------------------------------------|
         * | 1. $animate.enter(...) is called                                                             | class="my-animation"                        |
         * | 2. element is inserted into the parentElement element or beside the afterElement element     | class="my-animation"                        |
         * | 3. $animate runs any JavaScript-defined animations on the element                            | class="my-animation ng-animate"             |
         * | 4. the .ng-enter class is added to the element                                               | class="my-animation ng-animate ng-enter"    |
         * | 5. $animate scans the element styles to get the CSS transition/animation duration and delay  | class="my-animation ng-animate ng-enter"    |
         * | 6. $animate waits for 10ms (this performs a reflow)                                          | class="my-animation ng-animate ng-enter"    |
         * | 7. the .ng-enter-active and .ng-animate-active classes are added (this triggers the CSS transition/animation) | class="my-animation ng-animate ng-animate-active ng-enter ng-enter-active" |
         * | 8. $animate waits for X milliseconds for the animation to complete                           | class="my-animation ng-animate ng-animate-active ng-enter ng-enter-active" |
         * | 9. The animation ends and all generated CSS classes are removed from the element             | class="my-animation"                        |
         * | 10. The doneCallback() callback is fired (if provided)                                       | class="my-animation"                        |
         *
         * @param {DOMElement} element the element that will be the focus of the enter animation
         * @param {DOMElement} parentElement the parent element of the element that will be the focus of the enter animation
         * @param {DOMElement} afterElement the sibling element (which is the previous element) of the element that will be the focus of the enter animation
         * @param {function()=} doneCallback the callback function that will be called once the animation is complete
        */
        enter : function(element, parentElement, afterElement, doneCallback) {
          this.enabled(false, element);
          $delegate.enter(element, parentElement, afterElement);
          $rootScope.$$postDigest(function() {
            element = stripCommentsFromElement(element);
            performAnimation('enter', 'ng-enter', element, parentElement, afterElement, noop, doneCallback);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#leave
         * @function
         *
         * @description
         * Runs the leave animation operation and, upon completion, removes the element from the DOM. Once
         * the animation is started, the following CSS classes will be added for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during leave animation:
         *
         * | Animation Step                                                                               | What the element class attribute looks like |
         * |----------------------------------------------------------------------------------------------|---------------------------------------------|
         * | 1. $animate.leave(...) is called                                                             | class="my-animation"                        |
         * | 2. $animate runs any JavaScript-defined animations on the element                            | class="my-animation ng-animate"             |
         * | 3. the .ng-leave class is added to the element                                               | class="my-animation ng-animate ng-leave"    |
         * | 4. $animate scans the element styles to get the CSS transition/animation duration and delay  | class="my-animation ng-animate ng-leave"    |
         * | 5. $animate waits for 10ms (this performs a reflow)                                          | class="my-animation ng-animate ng-leave"    |
         * | 6. the .ng-leave-active and .ng-animate-active classes is added (this triggers the CSS transition/animation) | class="my-animation ng-animate ng-animate-active ng-leave ng-leave-active" |
         * | 7. $animate waits for X milliseconds for the animation to complete                           | class="my-animation ng-animate ng-animate-active ng-leave ng-leave-active" |
         * | 8. The animation ends and all generated CSS classes are removed from the element             | class="my-animation"                        |
         * | 9. The element is removed from the DOM                                                       | ...                                         |
         * | 10. The doneCallback() callback is fired (if provided)                                       | ...                                         |
         *
         * @param {DOMElement} element the element that will be the focus of the leave animation
         * @param {function()=} doneCallback the callback function that will be called once the animation is complete
        */
        leave : function(element, doneCallback) {
          cancelChildAnimations(element);
          this.enabled(false, element);
          $rootScope.$$postDigest(function() {
            performAnimation('leave', 'ng-leave', stripCommentsFromElement(element), null, null, function() {
              $delegate.leave(element);
            }, doneCallback);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#move
         * @function
         *
         * @description
         * Fires the move DOM operation. Just before the animation starts, the animate service will either append it into the parentElement container or
         * add the element directly after the afterElement element if present. Then the move animation will be run. Once
         * the animation is started, the following CSS classes will be added for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during move animation:
         *
         * | Animation Step                                                                               | What the element class attribute looks like |
         * |----------------------------------------------------------------------------------------------|---------------------------------------------|
         * | 1. $animate.move(...) is called                                                              | class="my-animation"                        |
         * | 2. element is moved into the parentElement element or beside the afterElement element        | class="my-animation"                        |
         * | 3. $animate runs any JavaScript-defined animations on the element                            | class="my-animation ng-animate"             |
         * | 4. the .ng-move class is added to the element                                                | class="my-animation ng-animate ng-move"     |
         * | 5. $animate scans the element styles to get the CSS transition/animation duration and delay  | class="my-animation ng-animate ng-move"     |
         * | 6. $animate waits for 10ms (this performs a reflow)                                          | class="my-animation ng-animate ng-move"     |
         * | 7. the .ng-move-active and .ng-animate-active classes is added (this triggers the CSS transition/animation) | class="my-animation ng-animate ng-animate-active ng-move ng-move-active" |
         * | 8. $animate waits for X milliseconds for the animation to complete                           | class="my-animation ng-animate ng-animate-active ng-move ng-move-active" |
         * | 9. The animation ends and all generated CSS classes are removed from the element             | class="my-animation"                        |
         * | 10. The doneCallback() callback is fired (if provided)                                       | class="my-animation"                        |
         *
         * @param {DOMElement} element the element that will be the focus of the move animation
         * @param {DOMElement} parentElement the parentElement element of the element that will be the focus of the move animation
         * @param {DOMElement} afterElement the sibling element (which is the previous element) of the element that will be the focus of the move animation
         * @param {function()=} doneCallback the callback function that will be called once the animation is complete
        */
        move : function(element, parentElement, afterElement, doneCallback) {
          cancelChildAnimations(element);
          this.enabled(false, element);
          $delegate.move(element, parentElement, afterElement);
          $rootScope.$$postDigest(function() {
            element = stripCommentsFromElement(element);
            performAnimation('move', 'ng-move', element, parentElement, afterElement, noop, doneCallback);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#addClass
         *
         * @description
         * Triggers a custom animation event based off the className variable and then attaches the className value to the element as a CSS class.
         * Unlike the other animation methods, the animate service will suffix the className value with {@type -add} in order to provide
         * the animate service the setup and active CSS classes in order to trigger the animation (this will be skipped if no CSS transitions
         * or keyframes are defined on the -add or base CSS class).
         *
         * Below is a breakdown of each step that occurs during addClass animation:
         *
         * | Animation Step                                                                                 | What the element class attribute looks like |
         * |------------------------------------------------------------------------------------------------|---------------------------------------------|
         * | 1. $animate.addClass(element, 'super') is called                                               | class="my-animation"                        |
         * | 2. $animate runs any JavaScript-defined animations on the element                              | class="my-animation ng-animate"             |
         * | 3. the .super-add class are added to the element                                               | class="my-animation ng-animate super-add"   |
         * | 4. $animate scans the element styles to get the CSS transition/animation duration and delay    | class="my-animation ng-animate super-add"   |
         * | 5. $animate waits for 10ms (this performs a reflow)                                            | class="my-animation ng-animate super-add"   |
         * | 6. the .super, .super-add-active and .ng-animate-active classes are added (this triggers the CSS transition/animation) | class="my-animation ng-animate ng-animate-active super super-add super-add-active"          |
         * | 7. $animate waits for X milliseconds for the animation to complete                             | class="my-animation super super-add super-add-active"  |
         * | 8. The animation ends and all generated CSS classes are removed from the element               | class="my-animation super"                  |
         * | 9. The super class is kept on the element                                                      | class="my-animation super"                  |
         * | 10. The doneCallback() callback is fired (if provided)                                         | class="my-animation super"                  |
         *
         * @param {DOMElement} element the element that will be animated
         * @param {string} className the CSS class that will be added to the element and then animated
         * @param {function()=} doneCallback the callback function that will be called once the animation is complete
        */
        addClass : function(element, className, doneCallback) {
          element = stripCommentsFromElement(element);
          performAnimation('addClass', className, element, null, null, function() {
            $delegate.addClass(element, className);
          }, doneCallback);
        },

        /**
         * @ngdoc method
         * @name $animate#removeClass
         *
         * @description
         * Triggers a custom animation event based off the className variable and then removes the CSS class provided by the className value
         * from the element. Unlike the other animation methods, the animate service will suffix the className value with {@type -remove} in
         * order to provide the animate service the setup and active CSS classes in order to trigger the animation (this will be skipped if
         * no CSS transitions or keyframes are defined on the -remove or base CSS classes).
         *
         * Below is a breakdown of each step that occurs during removeClass animation:
         *
         * | Animation Step                                                                                | What the element class attribute looks like     |
         * |-----------------------------------------------------------------------------------------------|---------------------------------------------|
         * | 1. $animate.removeClass(element, 'super') is called                                           | class="my-animation super"                  |
         * | 2. $animate runs any JavaScript-defined animations on the element                             | class="my-animation super ng-animate"       |
         * | 3. the .super-remove class are added to the element                                           | class="my-animation super ng-animate super-remove"|
         * | 4. $animate scans the element styles to get the CSS transition/animation duration and delay   | class="my-animation super ng-animate super-remove"   |
         * | 5. $animate waits for 10ms (this performs a reflow)                                           | class="my-animation super ng-animate super-remove"   |
         * | 6. the .super-remove-active and .ng-animate-active classes are added and .super is removed (this triggers the CSS transition/animation) | class="my-animation ng-animate ng-animate-active super-remove super-remove-active"          |
         * | 7. $animate waits for X milliseconds for the animation to complete                            | class="my-animation ng-animate ng-animate-active super-remove super-remove-active"   |
         * | 8. The animation ends and all generated CSS classes are removed from the element              | class="my-animation"                        |
         * | 9. The doneCallback() callback is fired (if provided)                                         | class="my-animation"                        |
         *
         *
         * @param {DOMElement} element the element that will be animated
         * @param {string} className the CSS class that will be animated and then removed from the element
         * @param {function()=} doneCallback the callback function that will be called once the animation is complete
        */
        removeClass : function(element, className, doneCallback) {
          element = stripCommentsFromElement(element);
          performAnimation('removeClass', className, element, null, null, function() {
            $delegate.removeClass(element, className);
          }, doneCallback);
        },

          /**
           *
           * @ngdoc function
           * @name $animate#setClass
           * @function
           * @description Adds and/or removes the given CSS classes to and from the element.
           * Once complete, the done() callback will be fired (if provided).
           * @param {DOMElement} element the element which will it's CSS classes changed
           *   removed from it
           * @param {string} add the CSS classes which will be added to the element
           * @param {string} remove the CSS class which will be removed from the element
           * @param {Function=} done the callback function (if provided) that will be fired after the
           *   CSS classes have been set on the element
           */
        setClass : function(element, add, remove, doneCallback) {
          element = stripCommentsFromElement(element);
          performAnimation('setClass', [add, remove], element, null, null, function() {
            $delegate.setClass(element, add, remove);
          }, doneCallback);
        },

        /**
         * @ngdoc method
         * @name $animate#enabled
         * @function
         *
         * @param {boolean=} value If provided then set the animation on or off.
         * @param {DOMElement=} element If provided then the element will be used to represent the enable/disable operation
         * @return {boolean} Current animation state.
         *
         * @description
         * Globally enables/disables animations.
         *
        */
        enabled : function(value, element) {
          switch(arguments.length) {
            case 2:
              if(value) {
                cleanup(element);
              } else {
                var data = element.data(NG_ANIMATE_STATE) || {};
                data.disabled = true;
                element.data(NG_ANIMATE_STATE, data);
              }
            break;

            case 1:
              rootAnimateState.disabled = !value;
            break;

            default:
              value = !rootAnimateState.disabled;
            break;
          }
          return !!value;
         }
      };

      /*
        all animations call this shared animation triggering function internally.
        The animationEvent variable refers to the JavaScript animation event that will be triggered
        and the className value is the name of the animation that will be applied within the
        CSS code. Element, parentElement and afterElement are provided DOM elements for the animation
        and the onComplete callback will be fired once the animation is fully complete.
      */
      function performAnimation(animationEvent, className, element, parentElement, afterElement, domOperation, doneCallback) {

        var runner = animationRunner(element, animationEvent, className);
        if(!runner) {
          fireDOMOperation();
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          closeAnimation();
          return;
        }

        className = runner.className;
        var elementEvents = angular.element._data(runner.node);
        elementEvents = elementEvents && elementEvents.events;

        if (!parentElement) {
          parentElement = afterElement ? afterElement.parent() : element.parent();
        }

        var ngAnimateState  = element.data(NG_ANIMATE_STATE) || {};
        var runningAnimations     = ngAnimateState.active || {};
        var totalActiveAnimations = ngAnimateState.totalActive || 0;
        var lastAnimation         = ngAnimateState.last;

        //only allow animations if the currently running animation is not structural
        //or if there is no animation running at all
        var skipAnimations = runner.isClassBased ?
          ngAnimateState.disabled || (lastAnimation && !lastAnimation.isClassBased) :
          false;

        //skip the animation if animations are disabled, a parent is already being animated,
        //the element is not currently attached to the document body or then completely close
        //the animation if any matching animations are not found at all.
        //NOTE: IE8 + IE9 should close properly (run closeAnimation()) in case an animation was found.
        if (skipAnimations || animationsDisabled(element, parentElement)) {
          fireDOMOperation();
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          closeAnimation();
          return;
        }

        var skipAnimation = false;
        if(totalActiveAnimations > 0) {
          var animationsToCancel = [];
          if(!runner.isClassBased) {
            if(animationEvent == 'leave' && runningAnimations['ng-leave']) {
              skipAnimation = true;
            } else {
              //cancel all animations when a structural animation takes place
              for(var klass in runningAnimations) {
                animationsToCancel.push(runningAnimations[klass]);
                cleanup(element, klass);
              }
              runningAnimations = {};
              totalActiveAnimations = 0;
            }
          } else if(lastAnimation.event == 'setClass') {
            animationsToCancel.push(lastAnimation);
            cleanup(element, className);
          }
          else if(runningAnimations[className]) {
            var current = runningAnimations[className];
            if(current.event == animationEvent) {
              skipAnimation = true;
            } else {
              animationsToCancel.push(current);
              cleanup(element, className);
            }
          }

          if(animationsToCancel.length > 0) {
            forEach(animationsToCancel, function(operation) {
              operation.cancel();
            });
          }
        }

        if(runner.isClassBased && !runner.isSetClassOperation && !skipAnimation) {
          skipAnimation = (animationEvent == 'addClass') == element.hasClass(className); //opposite of XOR
        }

        if(skipAnimation) {
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          fireDoneCallbackAsync();
          return;
        }

        if(animationEvent == 'leave') {
          //there's no need to ever remove the listener since the element
          //will be removed (destroyed) after the leave animation ends or
          //is cancelled midway
          element.one('$destroy', function(e) {
            var element = angular.element(this);
            var state = element.data(NG_ANIMATE_STATE);
            if(state) {
              var activeLeaveAnimation = state.active['ng-leave'];
              if(activeLeaveAnimation) {
                activeLeaveAnimation.cancel();
                cleanup(element, 'ng-leave');
              }
            }
          });
        }

        //the ng-animate class does nothing, but it's here to allow for
        //parent animations to find and cancel child animations when needed
        element.addClass(NG_ANIMATE_CLASS_NAME);

        var localAnimationCount = globalAnimationCounter++;
        totalActiveAnimations++;
        runningAnimations[className] = runner;

        element.data(NG_ANIMATE_STATE, {
          last : runner,
          active : runningAnimations,
          index : localAnimationCount,
          totalActive : totalActiveAnimations
        });

        //first we run the before animations and when all of those are complete
        //then we perform the DOM operation and run the next set of animations
        fireBeforeCallbackAsync();
        runner.before(function(cancelled) {
          var data = element.data(NG_ANIMATE_STATE);
          cancelled = cancelled ||
                        !data || !data.active[className] ||
                        (runner.isClassBased && data.active[className].event != animationEvent);

          fireDOMOperation();
          if(cancelled === true) {
            closeAnimation();
          } else {
            fireAfterCallbackAsync();
            runner.after(closeAnimation);
          }
        });

        function fireDOMCallback(animationPhase) {
          var eventName = '$animate:' + animationPhase;
          if(elementEvents && elementEvents[eventName] && elementEvents[eventName].length > 0) {
            $$asyncCallback(function() {
              element.triggerHandler(eventName, {
                event : animationEvent,
                className : className
              });
            });
          }
        }

        function fireBeforeCallbackAsync() {
          fireDOMCallback('before');
        }

        function fireAfterCallbackAsync() {
          fireDOMCallback('after');
        }

        function fireDoneCallbackAsync() {
          fireDOMCallback('close');
          if(doneCallback) {
            $$asyncCallback(function() {
              doneCallback();
            });
          }
        }

        //it is less complicated to use a flag than managing and canceling
        //timeouts containing multiple callbacks.
        function fireDOMOperation() {
          if(!fireDOMOperation.hasBeenRun) {
            fireDOMOperation.hasBeenRun = true;
            domOperation();
          }
        }

        function closeAnimation() {
          if(!closeAnimation.hasBeenRun) {
            closeAnimation.hasBeenRun = true;
            var data = element.data(NG_ANIMATE_STATE);
            if(data) {
              /* only structural animations wait for reflow before removing an
                 animation, but class-based animations don't. An example of this
                 failing would be when a parent HTML tag has a ng-class attribute
                 causing ALL directives below to skip animations during the digest */
              if(runner && runner.isClassBased) {
                cleanup(element, className);
              } else {
                $$asyncCallback(function() {
                  var data = element.data(NG_ANIMATE_STATE) || {};
                  if(localAnimationCount == data.index) {
                    cleanup(element, className, animationEvent);
                  }
                });
                element.data(NG_ANIMATE_STATE, data);
              }
            }
            fireDoneCallbackAsync();
          }
        }
      }

      function cancelChildAnimations(element) {
        var node = extractElementNode(element);
        if (node) {
          var nodes = angular.isFunction(node.getElementsByClassName) ?
            node.getElementsByClassName(NG_ANIMATE_CLASS_NAME) :
            node.querySelectorAll('.' + NG_ANIMATE_CLASS_NAME);
          forEach(nodes, function(element) {
            element = angular.element(element);
            var data = element.data(NG_ANIMATE_STATE);
            if(data && data.active) {
              forEach(data.active, function(runner) {
                runner.cancel();
              });
            }
          });
        }
      }

      function cleanup(element, className) {
        if(isMatchingElement(element, $rootElement)) {
          if(!rootAnimateState.disabled) {
            rootAnimateState.running = false;
            rootAnimateState.structural = false;
          }
        } else if(className) {
          var data = element.data(NG_ANIMATE_STATE) || {};

          var removeAnimations = className === true;
          if(!removeAnimations && data.active && data.active[className]) {
            data.totalActive--;
            delete data.active[className];
          }

          if(removeAnimations || !data.totalActive) {
            element.removeClass(NG_ANIMATE_CLASS_NAME);
            element.removeData(NG_ANIMATE_STATE);
          }
        }
      }

      function animationsDisabled(element, parentElement) {
        if (rootAnimateState.disabled) return true;

        if(isMatchingElement(element, $rootElement)) {
          return rootAnimateState.disabled || rootAnimateState.running;
        }

        do {
          //the element did not reach the root element which means that it
          //is not apart of the DOM. Therefore there is no reason to do
          //any animations on it
          if(parentElement.length === 0) break;

          var isRoot = isMatchingElement(parentElement, $rootElement);
          var state = isRoot ? rootAnimateState : parentElement.data(NG_ANIMATE_STATE);
          var result = state && (!!state.disabled || state.running || state.totalActive > 0);
          if(isRoot || result) {
            return result;
          }

          if(isRoot) return true;
        }
        while(parentElement = parentElement.parent());

        return true;
      }
    }]);

    $animateProvider.register('', ['$window', '$sniffer', '$timeout', '$$animateReflow',
                           function($window,   $sniffer,   $timeout,   $$animateReflow) {
      // Detect proper transitionend/animationend event names.
      var CSS_PREFIX = '', TRANSITION_PROP, TRANSITIONEND_EVENT, ANIMATION_PROP, ANIMATIONEND_EVENT;

      // If unprefixed events are not supported but webkit-prefixed are, use the latter.
      // Otherwise, just use W3C names, browsers not supporting them at all will just ignore them.
      // Note: Chrome implements `window.onwebkitanimationend` and doesn't implement `window.onanimationend`
      // but at the same time dispatches the `animationend` event and not `webkitAnimationEnd`.
      // Register both events in case `window.onanimationend` is not supported because of that,
      // do the same for `transitionend` as Safari is likely to exhibit similar behavior.
      // Also, the only modern browser that uses vendor prefixes for transitions/keyframes is webkit
      // therefore there is no reason to test anymore for other vendor prefixes: http://caniuse.com/#search=transition
      if (window.ontransitionend === undefined && window.onwebkittransitionend !== undefined) {
        CSS_PREFIX = '-webkit-';
        TRANSITION_PROP = 'WebkitTransition';
        TRANSITIONEND_EVENT = 'webkitTransitionEnd transitionend';
      } else {
        TRANSITION_PROP = 'transition';
        TRANSITIONEND_EVENT = 'transitionend';
      }

      if (window.onanimationend === undefined && window.onwebkitanimationend !== undefined) {
        CSS_PREFIX = '-webkit-';
        ANIMATION_PROP = 'WebkitAnimation';
        ANIMATIONEND_EVENT = 'webkitAnimationEnd animationend';
      } else {
        ANIMATION_PROP = 'animation';
        ANIMATIONEND_EVENT = 'animationend';
      }

      var DURATION_KEY = 'Duration';
      var PROPERTY_KEY = 'Property';
      var DELAY_KEY = 'Delay';
      var ANIMATION_ITERATION_COUNT_KEY = 'IterationCount';
      var NG_ANIMATE_PARENT_KEY = '$$ngAnimateKey';
      var NG_ANIMATE_CSS_DATA_KEY = '$$ngAnimateCSS3Data';
      var NG_ANIMATE_BLOCK_CLASS_NAME = 'ng-animate-block-transitions';
      var ELAPSED_TIME_MAX_DECIMAL_PLACES = 3;
      var CLOSING_TIME_BUFFER = 1.5;
      var ONE_SECOND = 1000;

      var lookupCache = {};
      var parentCounter = 0;
      var animationReflowQueue = [];
      var cancelAnimationReflow;
      function afterReflow(element, callback) {
        if(cancelAnimationReflow) {
          cancelAnimationReflow();
        }
        animationReflowQueue.push(callback);
        cancelAnimationReflow = $$animateReflow(function() {
          forEach(animationReflowQueue, function(fn) {
            fn();
          });

          animationReflowQueue = [];
          cancelAnimationReflow = null;
          lookupCache = {};
        });
      }

      var closingTimer = null;
      var closingTimestamp = 0;
      var animationElementQueue = [];
      function animationCloseHandler(element, totalTime) {
        var node = extractElementNode(element);
        element = angular.element(node);

        //this item will be garbage collected by the closing
        //animation timeout
        animationElementQueue.push(element);

        //but it may not need to cancel out the existing timeout
        //if the timestamp is less than the previous one
        var futureTimestamp = Date.now() + totalTime;
        if(futureTimestamp <= closingTimestamp) {
          return;
        }

        $timeout.cancel(closingTimer);

        closingTimestamp = futureTimestamp;
        closingTimer = $timeout(function() {
          closeAllAnimations(animationElementQueue);
          animationElementQueue = [];
        }, totalTime, false);
      }

      function closeAllAnimations(elements) {
        forEach(elements, function(element) {
          var elementData = element.data(NG_ANIMATE_CSS_DATA_KEY);
          if(elementData) {
            (elementData.closeAnimationFn || noop)();
          }
        });
      }

      function getElementAnimationDetails(element, cacheKey) {
        var data = cacheKey ? lookupCache[cacheKey] : null;
        if(!data) {
          var transitionDuration = 0;
          var transitionDelay = 0;
          var animationDuration = 0;
          var animationDelay = 0;
          var transitionDelayStyle;
          var animationDelayStyle;
          var transitionDurationStyle;
          var transitionPropertyStyle;

          //we want all the styles defined before and after
          forEach(element, function(element) {
            if (element.nodeType == ELEMENT_NODE) {
              var elementStyles = $window.getComputedStyle(element) || {};

              transitionDurationStyle = elementStyles[TRANSITION_PROP + DURATION_KEY];

              transitionDuration = Math.max(parseMaxTime(transitionDurationStyle), transitionDuration);

              transitionPropertyStyle = elementStyles[TRANSITION_PROP + PROPERTY_KEY];

              transitionDelayStyle = elementStyles[TRANSITION_PROP + DELAY_KEY];

              transitionDelay  = Math.max(parseMaxTime(transitionDelayStyle), transitionDelay);

              animationDelayStyle = elementStyles[ANIMATION_PROP + DELAY_KEY];

              animationDelay   = Math.max(parseMaxTime(animationDelayStyle), animationDelay);

              var aDuration  = parseMaxTime(elementStyles[ANIMATION_PROP + DURATION_KEY]);

              if(aDuration > 0) {
                aDuration *= parseInt(elementStyles[ANIMATION_PROP + ANIMATION_ITERATION_COUNT_KEY], 10) || 1;
              }

              animationDuration = Math.max(aDuration, animationDuration);
            }
          });
          data = {
            total : 0,
            transitionPropertyStyle: transitionPropertyStyle,
            transitionDurationStyle: transitionDurationStyle,
            transitionDelayStyle: transitionDelayStyle,
            transitionDelay: transitionDelay,
            transitionDuration: transitionDuration,
            animationDelayStyle: animationDelayStyle,
            animationDelay: animationDelay,
            animationDuration: animationDuration
          };
          if(cacheKey) {
            lookupCache[cacheKey] = data;
          }
        }
        return data;
      }

      function parseMaxTime(str) {
        var maxValue = 0;
        var values = angular.isString(str) ?
          str.split(/\s*,\s*/) :
          [];
        forEach(values, function(value) {
          maxValue = Math.max(parseFloat(value) || 0, maxValue);
        });
        return maxValue;
      }

      function getCacheKey(element) {
        var parentElement = element.parent();
        var parentID = parentElement.data(NG_ANIMATE_PARENT_KEY);
        if(!parentID) {
          parentElement.data(NG_ANIMATE_PARENT_KEY, ++parentCounter);
          parentID = parentCounter;
        }
        return parentID + '-' + extractElementNode(element).getAttribute('class');
      }

      function animateSetup(animationEvent, element, className, calculationDecorator) {
        var cacheKey = getCacheKey(element);
        var eventCacheKey = cacheKey + ' ' + className;
        var itemIndex = lookupCache[eventCacheKey] ? ++lookupCache[eventCacheKey].total : 0;

        var stagger = {};
        if(itemIndex > 0) {
          var staggerClassName = className + '-stagger';
          var staggerCacheKey = cacheKey + ' ' + staggerClassName;
          var applyClasses = !lookupCache[staggerCacheKey];

          applyClasses && element.addClass(staggerClassName);

          stagger = getElementAnimationDetails(element, staggerCacheKey);

          applyClasses && element.removeClass(staggerClassName);
        }

        /* the animation itself may need to add/remove special CSS classes
         * before calculating the anmation styles */
        calculationDecorator = calculationDecorator ||
                               function(fn) { return fn(); };

        element.addClass(className);

        var formerData = element.data(NG_ANIMATE_CSS_DATA_KEY) || {};

        var timings = calculationDecorator(function() {
          return getElementAnimationDetails(element, eventCacheKey);
        });

        var transitionDuration = timings.transitionDuration;
        var animationDuration = timings.animationDuration;
        if(transitionDuration === 0 && animationDuration === 0) {
          element.removeClass(className);
          return false;
        }

        element.data(NG_ANIMATE_CSS_DATA_KEY, {
          running : formerData.running || 0,
          itemIndex : itemIndex,
          stagger : stagger,
          timings : timings,
          closeAnimationFn : noop
        });

        //temporarily disable the transition so that the enter styles
        //don't animate twice (this is here to avoid a bug in Chrome/FF).
        var isCurrentlyAnimating = formerData.running > 0 || animationEvent == 'setClass';
        if(transitionDuration > 0) {
          blockTransitions(element, className, isCurrentlyAnimating);
        }

        //staggering keyframe animations work by adjusting the `animation-delay` CSS property
        //on the given element, however, the delay value can only calculated after the reflow
        //since by that time $animate knows how many elements are being animated. Therefore,
        //until the reflow occurs the element needs to be blocked (where the keyframe animation
        //is set to `none 0s`). This blocking mechanism should only be set for when a stagger
        //animation is detected and when the element item index is greater than 0.
        if(animationDuration > 0 && stagger.animationDelay > 0 && stagger.animationDuration === 0) {
          blockKeyframeAnimations(element);
        }

        return true;
      }

      function isStructuralAnimation(className) {
        return className == 'ng-enter' || className == 'ng-move' || className == 'ng-leave';
      }

      function blockTransitions(element, className, isAnimating) {
        if(isStructuralAnimation(className) || !isAnimating) {
          extractElementNode(element).style[TRANSITION_PROP + PROPERTY_KEY] = 'none';
        } else {
          element.addClass(NG_ANIMATE_BLOCK_CLASS_NAME);
        }
      }

      function blockKeyframeAnimations(element) {
        extractElementNode(element).style[ANIMATION_PROP] = 'none 0s';
      }

      function unblockTransitions(element, className) {
        var prop = TRANSITION_PROP + PROPERTY_KEY;
        var node = extractElementNode(element);
        if(node.style[prop] && node.style[prop].length > 0) {
          node.style[prop] = '';
        }
        element.removeClass(NG_ANIMATE_BLOCK_CLASS_NAME);
      }

      function unblockKeyframeAnimations(element) {
        var prop = ANIMATION_PROP;
        var node = extractElementNode(element);
        if(node.style[prop] && node.style[prop].length > 0) {
          node.style[prop] = '';
        }
      }

      function animateRun(animationEvent, element, className, activeAnimationComplete) {
        var node = extractElementNode(element);
        var elementData = element.data(NG_ANIMATE_CSS_DATA_KEY);
        if(node.getAttribute('class').indexOf(className) == -1 || !elementData) {
          activeAnimationComplete();
          return;
        }

        var activeClassName = '';
        forEach(className.split(' '), function(klass, i) {
          activeClassName += (i > 0 ? ' ' : '') + klass + '-active';
        });

        var stagger = elementData.stagger;
        var timings = elementData.timings;
        var itemIndex = elementData.itemIndex;
        var maxDuration = Math.max(timings.transitionDuration, timings.animationDuration);
        var maxDelay = Math.max(timings.transitionDelay, timings.animationDelay);
        var maxDelayTime = maxDelay * ONE_SECOND;

        var startTime = Date.now();
        var css3AnimationEvents = ANIMATIONEND_EVENT + ' ' + TRANSITIONEND_EVENT;

        var style = '', appliedStyles = [];
        if(timings.transitionDuration > 0) {
          var propertyStyle = timings.transitionPropertyStyle;
          if(propertyStyle.indexOf('all') == -1) {
            style += CSS_PREFIX + 'transition-property: ' + propertyStyle + ';';
            style += CSS_PREFIX + 'transition-duration: ' + timings.transitionDurationStyle + ';';
            appliedStyles.push(CSS_PREFIX + 'transition-property');
            appliedStyles.push(CSS_PREFIX + 'transition-duration');
          }
        }

        if(itemIndex > 0) {
          if(stagger.transitionDelay > 0 && stagger.transitionDuration === 0) {
            var delayStyle = timings.transitionDelayStyle;
            style += CSS_PREFIX + 'transition-delay: ' +
                     prepareStaggerDelay(delayStyle, stagger.transitionDelay, itemIndex) + '; ';
            appliedStyles.push(CSS_PREFIX + 'transition-delay');
          }

          if(stagger.animationDelay > 0 && stagger.animationDuration === 0) {
            style += CSS_PREFIX + 'animation-delay: ' +
                     prepareStaggerDelay(timings.animationDelayStyle, stagger.animationDelay, itemIndex) + '; ';
            appliedStyles.push(CSS_PREFIX + 'animation-delay');
          }
        }

        if(appliedStyles.length > 0) {
          //the element being animated may sometimes contain comment nodes in
          //the jqLite object, so we're safe to use a single variable to house
          //the styles since there is always only one element being animated
          var oldStyle = node.getAttribute('style') || '';
          node.setAttribute('style', oldStyle + ' ' + style);
        }

        element.on(css3AnimationEvents, onAnimationProgress);
        element.addClass(activeClassName);
        elementData.closeAnimationFn = function() {
          onEnd();
          activeAnimationComplete();
        };

        var staggerTime       = itemIndex * (Math.max(stagger.animationDelay, stagger.transitionDelay) || 0);
        var animationTime     = (maxDelay + maxDuration) * CLOSING_TIME_BUFFER;
        var totalTime         = (staggerTime + animationTime) * ONE_SECOND;

        elementData.running++;
        animationCloseHandler(element, totalTime);
        return onEnd;

        // This will automatically be called by $animate so
        // there is no need to attach this internally to the
        // timeout done method.
        function onEnd(cancelled) {
          element.off(css3AnimationEvents, onAnimationProgress);
          element.removeClass(activeClassName);
          animateClose(element, className);
          var node = extractElementNode(element);
          for (var i in appliedStyles) {
            node.style.removeProperty(appliedStyles[i]);
          }
        }

        function onAnimationProgress(event) {
          event.stopPropagation();
          var ev = event.originalEvent || event;
          var timeStamp = ev.$manualTimeStamp || ev.timeStamp || Date.now();

          /* Firefox (or possibly just Gecko) likes to not round values up
           * when a ms measurement is used for the animation */
          var elapsedTime = parseFloat(ev.elapsedTime.toFixed(ELAPSED_TIME_MAX_DECIMAL_PLACES));

          /* $manualTimeStamp is a mocked timeStamp value which is set
           * within browserTrigger(). This is only here so that tests can
           * mock animations properly. Real events fallback to event.timeStamp,
           * or, if they don't, then a timeStamp is automatically created for them.
           * We're checking to see if the timeStamp surpasses the expected delay,
           * but we're using elapsedTime instead of the timeStamp on the 2nd
           * pre-condition since animations sometimes close off early */
          if(Math.max(timeStamp - startTime, 0) >= maxDelayTime && elapsedTime >= maxDuration) {
            activeAnimationComplete();
          }
        }
      }

      function prepareStaggerDelay(delayStyle, staggerDelay, index) {
        var style = '';
        forEach(delayStyle.split(','), function(val, i) {
          style += (i > 0 ? ',' : '') +
                   (index * staggerDelay + parseInt(val, 10)) + 's';
        });
        return style;
      }

      function animateBefore(animationEvent, element, className, calculationDecorator) {
        if(animateSetup(animationEvent, element, className, calculationDecorator)) {
          return function(cancelled) {
            cancelled && animateClose(element, className);
          };
        }
      }

      function animateAfter(animationEvent, element, className, afterAnimationComplete) {
        if(element.data(NG_ANIMATE_CSS_DATA_KEY)) {
          return animateRun(animationEvent, element, className, afterAnimationComplete);
        } else {
          animateClose(element, className);
          afterAnimationComplete();
        }
      }

      function animate(animationEvent, element, className, animationComplete) {
        //If the animateSetup function doesn't bother returning a
        //cancellation function then it means that there is no animation
        //to perform at all
        var preReflowCancellation = animateBefore(animationEvent, element, className);
        if(!preReflowCancellation) {
          animationComplete();
          return;
        }

        //There are two cancellation functions: one is before the first
        //reflow animation and the second is during the active state
        //animation. The first function will take care of removing the
        //data from the element which will not make the 2nd animation
        //happen in the first place
        var cancel = preReflowCancellation;
        afterReflow(element, function() {
          unblockTransitions(element, className);
          unblockKeyframeAnimations(element);
          //once the reflow is complete then we point cancel to
          //the new cancellation function which will remove all of the
          //animation properties from the active animation
          cancel = animateAfter(animationEvent, element, className, animationComplete);
        });

        return function(cancelled) {
          (cancel || noop)(cancelled);
        };
      }

      function animateClose(element, className) {
        element.removeClass(className);
        var data = element.data(NG_ANIMATE_CSS_DATA_KEY);
        if(data) {
          if(data.running) {
            data.running--;
          }
          if(!data.running || data.running === 0) {
            element.removeData(NG_ANIMATE_CSS_DATA_KEY);
          }
        }
      }

      return {
        enter : function(element, animationCompleted) {
          return animate('enter', element, 'ng-enter', animationCompleted);
        },

        leave : function(element, animationCompleted) {
          return animate('leave', element, 'ng-leave', animationCompleted);
        },

        move : function(element, animationCompleted) {
          return animate('move', element, 'ng-move', animationCompleted);
        },

        beforeSetClass : function(element, add, remove, animationCompleted) {
          var className = suffixClasses(remove, '-remove') + ' ' +
                          suffixClasses(add, '-add');
          var cancellationMethod = animateBefore('setClass', element, className, function(fn) {
            /* when classes are removed from an element then the transition style
             * that is applied is the transition defined on the element without the
             * CSS class being there. This is how CSS3 functions outside of ngAnimate.
             * http://plnkr.co/edit/j8OzgTNxHTb4n3zLyjGW?p=preview */
            var klass = element.attr('class');
            element.removeClass(remove);
            element.addClass(add);
            var timings = fn();
            element.attr('class', klass);
            return timings;
          });

          if(cancellationMethod) {
            afterReflow(element, function() {
              unblockTransitions(element, className);
              unblockKeyframeAnimations(element);
              animationCompleted();
            });
            return cancellationMethod;
          }
          animationCompleted();
        },

        beforeAddClass : function(element, className, animationCompleted) {
          var cancellationMethod = animateBefore('addClass', element, suffixClasses(className, '-add'), function(fn) {

            /* when a CSS class is added to an element then the transition style that
             * is applied is the transition defined on the element when the CSS class
             * is added at the time of the animation. This is how CSS3 functions
             * outside of ngAnimate. */
            element.addClass(className);
            var timings = fn();
            element.removeClass(className);
            return timings;
          });

          if(cancellationMethod) {
            afterReflow(element, function() {
              unblockTransitions(element, className);
              unblockKeyframeAnimations(element);
              animationCompleted();
            });
            return cancellationMethod;
          }
          animationCompleted();
        },

        setClass : function(element, add, remove, animationCompleted) {
          remove = suffixClasses(remove, '-remove');
          add = suffixClasses(add, '-add');
          var className = remove + ' ' + add;
          return animateAfter('setClass', element, className, animationCompleted);
        },

        addClass : function(element, className, animationCompleted) {
          return animateAfter('addClass', element, suffixClasses(className, '-add'), animationCompleted);
        },

        beforeRemoveClass : function(element, className, animationCompleted) {
          var cancellationMethod = animateBefore('removeClass', element, suffixClasses(className, '-remove'), function(fn) {
            /* when classes are removed from an element then the transition style
             * that is applied is the transition defined on the element without the
             * CSS class being there. This is how CSS3 functions outside of ngAnimate.
             * http://plnkr.co/edit/j8OzgTNxHTb4n3zLyjGW?p=preview */
            var klass = element.attr('class');
            element.removeClass(className);
            var timings = fn();
            element.attr('class', klass);
            return timings;
          });

          if(cancellationMethod) {
            afterReflow(element, function() {
              unblockTransitions(element, className);
              unblockKeyframeAnimations(element);
              animationCompleted();
            });
            return cancellationMethod;
          }
          animationCompleted();
        },

        removeClass : function(element, className, animationCompleted) {
          return animateAfter('removeClass', element, suffixClasses(className, '-remove'), animationCompleted);
        }
      };

      function suffixClasses(classes, suffix) {
        var className = '';
        classes = angular.isArray(classes) ? classes : classes.split(/\s+/);
        forEach(classes, function(klass, i) {
          if(klass && klass.length > 0) {
            className += (i > 0 ? ' ' : '') + klass + suffix;
          }
        });
        return className;
      }
    }]);
  }]);


})(window, window.angular);

},{}]},{},[4])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9hbmd1bGFyLWFwcC5qcyIsImpzL2FuZ3VsYXItZWxhc3RpYy9lbGFzdGljLmpzIiwianMvYW5ndWxhci9hbmd1bGFyLm1pbi5qcyIsImpzL2Jyb3dzZXJpZnktYXBwLmpzIiwianMvZXJyb3ItbWFwcGVyL2Vycm9yLW1hcHBlci5qcyIsImpzL2xhbmd1YWdlLWNoYW5nZXIvbGFuZ3VhZ2UtY2hhbmdlci5qcyIsImpzL2xpYnMvYW5ndWxhci10cmFuc2xhdGUtbG9hZGVyLXN0YXRpYy1maWxlcy5qcyIsImpzL2xpYnMvYW5ndWxhci10cmFuc2xhdGUuanMiLCJqcy9saWJzL251bWVyYWwuZGUtZGUuanMiLCJqcy9saWJzL3Byb21pc2UtdHJhY2tlci1odHRwLWludGVyY2VwdG9yLmpzIiwianMvbGlicy9wcm9taXNlLXRyYWNrZXIuanMiLCJqcy9saWJzL3VpLWJvb3RzdHJhcC10cGxzLTAuMTEuMi5taW4uanMiLCJqcy9saWJzL3VpLWhhbmRzb250YWJsZS5qcyIsImpzL211bHRpc2VsZWN0L211bHRpc2VsZWN0LmpzIiwianMvbmF2aWdhdGlvbi1ibG9ja2VyL25hdmlnYXRpb24tYmxvY2tlci5qcyIsImpzL25vdGlmaWNhdGlvbi9ub3RpZmljYXRpb24uanMiLCJqcy9vcmRlci1vYmplY3QtYnkvbmctb3JkZXItb2JqZWN0LWJ5LmpzIiwianMvdGFicy9mb3JtLXRhYnMuanMiLCJqcy91dGlscy91dGlscy5qcyIsIm5vZGVfbW9kdWxlcy9hbmd1bGFyLWFuaW1hdGUvYW5ndWxhci1hbmltYXRlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzk1RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNySkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeHlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOVhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOVJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJC5ub0NvbmZsaWN0KCk7XG5cblxuXHR2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ0xDUCcsIFtcbiAgICAgICAgJ3VpLmJvb3RzdHJhcCcsXG4gICAgICAgICduZ0FuaW1hdGUnLFxuICAgICAgICAnYWpvc2xpbi5wcm9taXNlLXRyYWNrZXInLFxuICAgICAgICAnbmF2aWdhdGlvbi5uYXZpZ2F0aW9uQmxvY2tlcicsXG4gICAgICAgICd0cmFuc2xhdGUubGFuZ3VhZ2VDaGFuZ2VyJyxcbiAgICAgICAgJ3VpLm11bHRpc2VsZWN0JyxcbiAgICAgICAgJ3RhYnMuZm9ybVRhYnMnLFxuICAgICAgICAndWkuZXJyb3JNYXBwZXInLFxuICAgICAgICAnbW9ub3NwYWNlZC5lbGFzdGljJyxcbiAgICAgICAgJ25nT3JkZXJPYmplY3RCeScsXG4gICAgICAgICdub3RpZmljYXRpb25zJ10pO1xuXG4gICAgYXBwLnJ1bihmdW5jdGlvbigkcm9vdFNjb3BlLCBwcm9taXNlVHJhY2tlciwgJGxvY2F0aW9uLCB0YWJTZXJ2aWNlKSB7XG4gICAgICAgICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXIgPSBwcm9taXNlVHJhY2tlcih7fSk7XG4gICAgICAgIHRhYlNlcnZpY2Uuc2V0VGFicyhbXG4gICAgICAgICAgICB7XCJpZFwiOlwiQmFzaWNEYXRhXCIsICAgICAgICAgICAgXCJhY3RpdmVcIiA6IHRydWV9LFxuICAgICAgICAgICAge1wiaWRcIjpcIkxpc3RPZlBsYW50c1wiLCAgICAgICAgIFwiYWN0aXZlXCIgOiBmYWxzZX0sXG4gICAgICAgICAgICB7XCJpZFwiOlwiUGxhbnREZXRhaWxzXCIsICAgICAgICAgXCJhY3RpdmVcIiA6IGZhbHNlfSxcbiAgICAgICAgICAgIHtcImlkXCI6XCJFbmVyZ3lJbnB1dFwiLCAgICAgICAgICBcImFjdGl2ZVwiIDogZmFsc2V9LFxuICAgICAgICAgICAge1wiaWRcIjpcIlRvdGFsRW1pc3Npb25zVG9BaXJcIiwgIFwiYWN0aXZlXCIgOiBmYWxzZX0sXG4gICAgICAgICAgICB7XCJpZFwiOlwiRGVzdWxwaHVyaXNhdGlvblwiLCAgICAgXCJhY3RpdmVcIiA6IGZhbHNlfSxcbiAgICAgICAgICAgIHtcImlkXCI6XCJVc2VmdWxIZWF0XCIsICAgICAgICAgICAgIFwiYWN0aXZlXCIgOiBmYWxzZX0sXG4gICAgICAgICAgICB7XCJpZFwiOlwiTm90ZXNcIiwgICAgICAgICAgICAgICAgXCJhY3RpdmVcIiA6IGZhbHNlfV0pO1xuICAgIH0pO1xuXG4gICAgYXBwLmNvbmZpZyhmdW5jdGlvbiAobGFuZ3VhZ2VDaGFuZ2VyUHJvdmlkZXIpIHtcbiAgICAgICAgbGFuZ3VhZ2VDaGFuZ2VyUHJvdmlkZXIuc2V0RGVmYXVsdExhbmd1YWdlKCdlbicpO1xuICAgICAgICBsYW5ndWFnZUNoYW5nZXJQcm92aWRlci5zZXRMYW5ndWFnZUZpbGVQcmVmaXgoJ2xjcC1sYWJlbHMtJyk7XG4gICAgICAgIGxhbmd1YWdlQ2hhbmdlclByb3ZpZGVyLnNldEF2YWlsYWJsZUxhbmd1YWdlcyh7IFwiaXRlbVwiIDpbe1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwiYmdcIixcbiAgICAgICAgICAgIFwibGFiZWxcIjogXCLDkOKAmMORxaDDkMK7w5DCs8OQwrDDkeKCrMORwoHDkMK6w5DCuCAoYmcpXCJ9LCB7XG4gICAgICAgICAgICBcImNvZGVcIjogXCJlc1wiLFxuICAgICAgICAgICAgICAgIFwibGFiZWxcIjogXCJFc3Bhw4PCsW9sIChlcylcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcImNzXCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIsOExZJlw4XCoXRpbmEgKGNzKVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwiZGFcIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiRGFuc2sgKGRhKVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwiZGVcIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiRGV1dHNjaCAoZGUpXCJ9LCB7XG4gICAgICAgICAgICBcImNvZGVcIjogXCJldFwiLFxuICAgICAgICAgICAgICAgIFwibGFiZWxcIjogXCJFZXN0aSAoZXQpXCJ9LCB7XG4gICAgICAgICAgICBcImNvZGVcIjogXCJlbFwiLFxuICAgICAgICAgICAgICAgIFwibGFiZWxcIjogXCLDjsK1w47Cu8OOwrvDjsK3w47CvcOOwrnDjsK6w47CrCAoZWwpXCJ9LCB7XG4gICAgICAgICAgICBcImNvZGVcIjogXCJlblwiLFxuICAgICAgICAgICAgICAgIFwibGFiZWxcIjogXCJFbmdsaXNoIChlbilcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcImZyXCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIkZyYW7Dg8KnYWlzIChmcilcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcImhyXCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIkhydmF0c2tpIChocilcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcIml0XCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIkl0YWxpYW5vIChpdClcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcImx2XCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIkxhdHZpZcOFwqF1IHZhbG9kYSAobHYpXCJ9LCB7XG4gICAgICAgICAgICBcImNvZGVcIjogXCJsdFwiLFxuICAgICAgICAgICAgICAgIFwibGFiZWxcIjogXCJMaWV0dXZpw4XCsyBrYWxiYSAobHQpXCJ9LCB7XG4gICAgICAgICAgICBcImNvZGVcIjogXCJodVwiLFxuICAgICAgICAgICAgICAgIFwibGFiZWxcIjogXCJNYWd5YXIgKGh1KVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwiaHJcIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiSHJ2YXRza2kgKGhyKVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwibXRcIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiTWFsdGkgKG10KVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwibmxcIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiTmVkZXJsYW5kcyAobmwpXCJ9LCB7XG4gICAgICAgICAgICBcImNvZGVcIjogXCJwbFwiLFxuICAgICAgICAgICAgICAgIFwibGFiZWxcIjogXCJQb2xza2kgKHBsKVwifSwge1xuICAgICAgICAgICAgXCJjb2RlXCI6IFwicHRcIixcbiAgICAgICAgICAgICAgICBcImxhYmVsXCI6IFwiUG9ydHVndcODwqpzIChwdClcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcInJvXCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIlJvbcODwqJuw4TGkiAocm8pXCJ9LCB7XG4gICAgICAgICAgICBcImNvZGVcIjogXCJza1wiLFxuICAgICAgICAgICAgICAgIFwibGFiZWxcIjogXCJTbG92ZW7DhMKNaW5hIChzaylcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcInNsXCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIlNsb3ZlbsOFwqHDhMKNaW5hIChzbClcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcImZpXCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIlN1b21pIChmaSlcIn0sIHtcbiAgICAgICAgICAgIFwiY29kZVwiOiBcInN2XCIsXG4gICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcIlN2ZW5za2EgKHN2KVwifV0gfSlcbiAgICB9KTtcblxuICAgIC8vIHJlcXVlc3QgcGFyYW1ldGVyc1xuICAgIHZhciBiYXNlVXJpID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdiYXNlX3VyaScpO1xuICAgIHZhciBmaWxlSWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2ZpbGVJZCcpO1xuICAgIHZhciBlbnZlbG9wZSA9IGdldFBhcmFtZXRlckJ5TmFtZSgnZW52ZWxvcGUnKTtcbiAgICB2YXIgc2Vzc2lvbklkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdzZXNzaW9uaWQnKTtcbiAgICB2YXIgY291bnRyeUNvZGUgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2NvdW50cnljb2RlJyk7XG4gICAgY291bnRyeUNvZGUgPSBjb3VudHJ5Q29kZSA9PT0gXCJHQlwiID8gXCJVS1wiIDogY291bnRyeUNvZGU7XG4gICAgdmFyIEREX1ZPQ0FCVUxBUllfQkFTRV9VUkkgPSBcImh0dHBzOi8vZGQuZWlvbmV0LmV1cm9wYS5ldS92b2NhYnVsYXJ5L1wiO1xuXG4gICAgYXBwLmNvbnRyb2xsZXIoXCJxdWVzdGlvbm5haXJlXCIsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsIGRhdGFSZXBvc2l0b3J5LCBsYW5ndWFnZUNoYW5nZXIsICRzY2UsICRsb2NhdGlvbiwgJHRpbWVvdXQsICRhbmNob3JTY3JvbGwsICRub3RpZmljYXRpb24sICRodHRwLCAkZmlsdGVyICwkcSkge1xuXG4gICAgIFxuICAgICAgICAkc2NvcGUuY29kZUxpc3QgPSB7fTtcbiAgICAgICAgJHNjb3BlLnJlZ2lvbnNDb2RlbGlzdCA9IHt9O1xuXG5cdFx0JHNjb3BlLmJhc2UgPSAkbG9jYXRpb24uaG9zdCgpKyAkbG9jYXRpb24ucG9ydCgpICsgZ2V0UGFyYW1ldGVyQnlOYW1lKCdiYXNlX3VyaScpO1xuICAgICAgICAvLyRzY29wZS5hdmFpbGFibGVMYW5ndWFnZXMgPSBsYW5ndWFnZUNoYW5nZXIuZ2V0QXZhaWxhYmxlTGFuZ3VhZ2VzKCk7XG5cbiAgICAgICAgZGF0YVJlcG9zaXRvcnkuZ2V0RW1wdHlJbnN0YW5jZSgpLmVycm9yKGZ1bmN0aW9uKCl7YWxlcnQoXCJGYWlsZWQgdG8gcmVhZCBlbXB0eSBpbnN0YW5jZSBYTUwgZmlsZS5cIik7fSkuc3VjY2VzcyhmdW5jdGlvbihpbnN0YW5jZSkge1xuICAgICAgICAgICAgJHNjb3BlLmVtcHR5SW5zdGFuY2UgPSBpbnN0YW5jZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGF0YVJlcG9zaXRvcnkuZ2V0SW5zdGFuY2UoKS5lcnJvcihmdW5jdGlvbigpe2FsZXJ0KFwiRmFpbGVkIHRvIHJlYWQgaW5zdGFuY2UgWE1MIGZpbGUuXCIpO30pLnN1Y2Nlc3MoZnVuY3Rpb24oaW5zdGFuY2UpIHtcbiAgICAgICAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQoaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZSkpe1xuICAgICAgICAgICAgICAgIC8vIGFkZCBsYWJlbExhbmd1YWdlIGF0dHJpYnV0ZSB0byBjb3JyZWN0IGxvY2F0aW9uXG4gICAgICAgICAgICAgICAgJHNjb3BlLmluc3RhbmNlID0ge307XG4gICAgICAgICAgICAgICAgJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUgPSB7fTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZVsnQHhtbG5zOnhzaSddID0gaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZVsnQHhtbG5zOnhzaSddO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlWydAeHNpOm5vTmFtZXNwYWNlU2NoZW1hTG9jYXRpb24nXSA9IGluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmVbJ0B4c2k6bm9OYW1lc3BhY2VTY2hlbWFMb2NhdGlvbiddO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlWydAeG1sOmxhbmcnXSA9IGluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmVbJ0B4bWw6bGFuZyddO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkJhc2ljRGF0YSA9IGluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuQmFzaWNEYXRhO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cyA9IGluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW5zdGFuY2UgPSBpbnN0YW5jZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cyAmJiAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQpIHtcblxuICAgICAgICAgICAgICAgIC8vIGlmIHRoZXLDj8aSw4/igKbDj8aSZSBpcyBvbmx5IDEgcGxhbnQsIHRoZW4gY29udmVydCBpdCB0byBhcnJheVxuICAgICAgICAgICAgICAgIGlmICghYW5ndWxhci5pc0FycmF5KCRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50ID0gWyRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgZmlyc3QgZW1wdHkgcm93LCBpZiBleGlzdHNcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50Lmxlbmd0aCA9PSAxICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAoISRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudFswXSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoISRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudFswXVsnUGxhbnROYW1lJ10gJiYgISRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudFswXVsnUGxhbnRJZCddKSkpe1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBMb2FkIHByZWRlZmluZWQgY291bnRyeSBzcGVjaWZpYyBwbGFudHNcbiAgICAgICAgICAgICAgICAgICAgaWYoIGNvdW50cnlDb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcHJ0ckNvdW50cnlDb2RlID0gY291bnRyeUNvZGUgPT09IFwiR0JcIiA/IFwiVUtcIiA6IGNvdW50cnlDb2RlID09PSBcIkdSXCIgPyBcIkVMXCIgOiBjb3VudHJ5Q29kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHZhciB1cmwgPSBcImxjcF9wbGFudHMtXCIgKyBjb3VudHJ5Q29kZSArIFwiLmpzb25cIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBcImh0dHA6Ly9zZW1hbnRpYy5lZWEuZXVyb3BhLmV1L3NwYXJxbD9mb3JtYXQ9YXBwbGljYXRpb24vanNvbiZxdWVyeT1cIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzcGFycWwgPSBcIiBQUkVGSVggcmRmczogPGh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDEvcmRmLXNjaGVtYSM+XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIGNyOiA8aHR0cDovL2NyLmVpb25ldC5ldXJvcGEuZXUvb250b2xvZ2llcy9jb250cmVnLnJkZiM+IFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIFBSRUZJWCBwcnRyOiA8aHR0cDovL3BydHIuZWMuZXVyb3BhLmV1L3JkZi9zY2hlbWEucmRmIz4gXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIGdlbzogPGh0dHA6Ly93d3cudzMub3JnLzIwMDMvMDEvZ2VvL3dnczg0X3BvcyM+XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIGxjcFR5cGU6IDxodHRwOi8vc2VtYW50aWMuZWVhLmV1cm9wYS5ldS9wcm9qZWN0L2xjcF9kYXRhL2xjcF9wbGFudHMuY3N2Lz4gXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIGxjcDogPGh0dHA6Ly9zZW1hbnRpYy5lZWEuZXVyb3BhLmV1L3Byb2plY3QvbGNwX2RhdGEvbGNwX3BsYW50cy5jc3YjPiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBTRUxFQ1QgKlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIFdIRVJFIHtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiB7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIFtdIGEgbGNwVHlwZTpsY3BQbGFudCA7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIGxjcDpQbGFudE5hbWUgP1BsYW50TmFtZTtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgbGNwOk1lbWJlclN0YXRlID9NZW1iZXJTdGF0ZTtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgbGNwOkVQUlRSTmF0aW9uYWxJZCA/RVBSVFJOYXRpb25hbElkO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBsY3A6VW5pcXVlX1BsYW50X0lEID9QbGFudElkLlwiICtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiID9mYWNpbGl0eSBhIHBydHI6RmFjaWxpdHkgO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBwcnRyOmZhY2lsaXR5TmFtZSA/ZmFjaWxpdHlOYW1lO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBwcnRyOnN0cmVldE5hbWUgP3N0cmVldE5hbWU7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIHBydHI6cG9zdGFsQ29kZSAgP3Bvc3RhbENvZGU7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIGdlbzpsYXQgP2xhdDtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgZ2VvOmxvbmcgP2xvbmc7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIHBydHI6aW5Db3VudHJ5ID9pbkNvdW50cnkgO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBwcnRyOmxhdGVzdFJlcG9ydCA/bGF0ZXN0UmVwb3J0LlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiA/aW5Db3VudHJ5IHBydHI6Y29kZSA/RVBSVFJDb3VudHJ5Q29kZS5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgP2xhdGVzdFJlcG9ydCBwcnRyOm5hdGlvbmFsSUQgP0VQUlRSTmF0aW9uYWxJZDtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgcHJ0cjpmb3JOVVRTID9mb3JOVVRTO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBwcnRyOnJlcG9ydGluZ1llYXIgP3JlcG9ydGluZ1llYXIuXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiID9mb3JOVVRTIHBydHI6Y29kZSA/cmVnaW9uQ29kZS5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgT1BUSU9OQUwgeyA/ZmFjaWxpdHkgcHJ0cjpidWlsZGluZ051bWJlciA/YnVpbGRpbmdOdW1iZXIuIH1cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgT1BUSU9OQUwgeyA/ZmFjaWxpdHkgcHJ0cjpjaXR5ID9jaXR5LiB9XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIEZJTFRFUiggP0VQUlRSQ291bnRyeUNvZGU9ICdcIiArIGVwcnRyQ291bnRyeUNvZGUgKyBcIicgYW5kID9NZW1iZXJTdGF0ZSA9ICdcIiArIGNvdW50cnlDb2RlICsgXCInIGFuZCA/TWVtYmVyU3RhdGUgIT0gJ1NLJyApXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgfSBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBVTklPTlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIHtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgP3BsYW50IGEgbGNwVHlwZTpsY3BQbGFudCA7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIGxjcDpQbGFudE5hbWUgP1BsYW50TmFtZTtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgbGNwOk1lbWJlclN0YXRlID9NZW1iZXJTdGF0ZTtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgbGNwOkVQUlRSTmF0aW9uYWxJZCA/RVBSVFJOYXRpb25hbElkO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBsY3A6VW5pcXVlX1BsYW50X0lEID9QbGFudElkLlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBPUFRJT05BTCB7ICA/cGxhbnQgbGNwOkZhY2lsaXR5TmFtZSA/ZmFjaWxpdHlOYW1lLiB9XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIE9QVElPTkFMIHsgID9wbGFudCBsY3A6TG9uZ2l0dWRlID9sb25nLiB9XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIE9QVElPTkFMIHsgID9wbGFudCBsY3A6TGF0aXR1ZGUgP2xhdC4gfVwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBPUFRJT05BTCB7ICA/cGxhbnQgbGNwOkFkZHJlc3MxID9zdHJlZXROYW1lLiB9XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIE9QVElPTkFMIHsgID9wbGFudCBsY3A6Q2l0eSA/Y2l0eS4gfVwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBPUFRJT05BTCB7ICA/cGxhbnQgbGNwOlBvc3RhbENvZGUgP3Bvc3RhbENvZGUufVwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBPUFRJT05BTCB7ICA/cGxhbnQgbGNwOlJlZ2lvbiA/cmVnaW9uQ29kZS4gfVwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiBPUFRJT05BTCB7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiA/ZmFjaWxpdHkgYSBwcnRyOkZhY2lsaXR5IDtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIHBydHI6aW5Db3VudHJ5ID9pbkNvdW50cnkgO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgcHJ0cjpsYXRlc3RSZXBvcnQgP2xhdGVzdFJlcG9ydC5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiID9sYXRlc3RSZXBvcnQgcHJ0cjpuYXRpb25hbElEID9FUFJUUk5hdGlvbmFsSWQuXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiA/aW5Db3VudHJ5IHBydHI6Y29kZSA/RVBSVFJDb3VudHJ5Q29kZS5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIEZJTFRFUiggP0VQUlRSQ291bnRyeUNvZGU9ICdcIisgZXBydHJDb3VudHJ5Q29kZSArIFwiJyAgKVwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiB9XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIEZJTFRFUiggP01lbWJlclN0YXRlID0gJ1wiICsgY291bnRyeUNvZGUgK1wiJyBhbmQgKCFib3VuZCg/ZmFjaWxpdHkpIG9yICA/TWVtYmVyU3RhdGUgPSAnU0snICkgKSBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiB9XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgfSBPUkRFUiBCWSA/UGxhbnRJZCBcIjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gYmFzZVVyaSArICcvcmVzdFByb3h5P3VyaT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCArIGVuY29kZVVSSUNvbXBvbmVudChzcGFycWwpKTtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3BsYW50cyB1cmwgaXM6Jyt1cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCwge3RyYWNrZXIgOiAkcm9vdFNjb3BlLmxvYWRpbmdUcmFja2VyfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKCl7YWxlcnQoXCJGYWlsZWQgdG8gcHJlLWxvYWQgcGxhbnRzIGRhdGEgZnJvbSBFLVBSVFIgZGF0YWJhc2UuXCIpO30pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGVwcnRyRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVwcnRyRGF0YS5yZXN1bHRzLmJpbmRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGxhbnRzRGljdCA9IHt9IDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpPSAwOyBpIDwgZXBydHJEYXRhLnJlc3VsdHMuYmluZGluZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlUGxhbnQgPSBlcHJ0ckRhdGEucmVzdWx0cy5iaW5kaW5nc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsYW50ID0gbnVsbCA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggICBwbGFudHNEaWN0WyByZXNwb25zZVBsYW50LlBsYW50SWQudmFsdWVdICYmIHBsYW50c0RpY3QgWyByZXNwb25zZVBsYW50LlBsYW50SWQudmFsdWVdID4gcmVzcG9uc2VQbGFudC5yZXBvcnRpbmdZZWFyLnZhbHVlICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNvbWUgcGxhbnRzIGhhdmUgcmVwb3J0cyB1bmRlciBkaWZmZXJlbnQgZmFjaWxpdGllcy4gd2Uga2VlcCB0aGUgZm9yIG1vc3QgbmV3IHJlcG9ydGluZ1llYXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICggISBwbGFudHNEaWN0WyByZXNwb25zZVBsYW50LlBsYW50SWQudmFsdWVdICl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWRkSXRlbSgnTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50ID0gJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50WyAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQubGVuZ3RoIC0gMSBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBsYW50LlBsYW50TG9jYXRpb24pIHBsYW50LlBsYW50TG9jYXRpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlKSBwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlID0ge307XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuUGxhbnRJZCA9IHJlc3BvbnNlUGxhbnQuUGxhbnRJZC52YWx1ZSA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50TmFtZSA9IHJlc3BvbnNlUGxhbnQuUGxhbnROYW1lLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFudC5FUFJUUk5hdGlvbmFsSWQgPSByZXNwb25zZVBsYW50LkVQUlRSTmF0aW9uYWxJZC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuUGxhbnRMb2NhdGlvbi5TdHJlZXROYW1lID0gcmVzcG9uc2VQbGFudC5zdHJlZXROYW1lLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRW1wdHkocmVzcG9uc2VQbGFudC5idWlsZGluZ051bWJlci52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50TG9jYXRpb24uQnVpbGRpbmdOdW1iZXIgPSByZXNwb25zZVBsYW50LmJ1aWxkaW5nTnVtYmVyLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50TG9jYXRpb24uQ2l0eSA9IHJlc3BvbnNlUGxhbnQuY2l0eS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuUGxhbnRMb2NhdGlvbi5SZWdpb24gPSByZXNwb25zZVBsYW50LnJlZ2lvbkNvZGUudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50TG9jYXRpb24uUG9zdGFsQ29kZSA9IHJlc3BvbnNlUGxhbnQucG9zdGFsQ29kZS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5Mb25naXR1ZGUgPSByZXNwb25zZVBsYW50LmxvbmcudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTGF0aXR1ZGUgPSByZXNwb25zZVBsYW50LmxhdC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuRmFjaWxpdHlOYW1lID0gcmVzcG9uc2VQbGFudC5mYWNpbGl0eU5hbWUudmFsdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnRzRGljdCBbcGxhbnQuUGxhbnRJZCBdID0gcmVzcG9uc2VQbGFudC5yZXBvcnRpbmdZZWFyLnZhbHVlIHx8IDIwMTM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgndXBkYXRlRmlsdGVyJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG5vdGlmaWNhdGlvbi5pbmZvKFwiSW5mb1wiLCBcIlByZXZpb3VzIEVQUlRSIHBsYW50cyBoYXZlIGJlZW4gcHJlLWxvYWRlZC5cIik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiVGhlIHN5c3RlbSBjb3VsZCBub3QgZmluZCBhbnkgcGxhbnQgZm9yIGNvdW50cnkgXCIgKyBjb3VudHJ5Q29kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzID0ge1wiUGxhbnRcIiA6IFtdfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKCBjb3VudHJ5Q29kZSAhPSBudWxsKXtcblxuICAgICAgICAgICAgICAgICRzY29wZS5jb3VudHJ5Q29kZUJvb2xlYW4gPXRydWU7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuQmFzaWNEYXRhLk1lbWJlclN0YXRlID0gY291bnRyeUNvZGUudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubWVtYmVyU3RhdGVWYWx1ZSA9IGNvdW50cnlDb2RlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiggJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuQmFzaWNEYXRhLk1lbWJlclN0YXRlICE9IG51bGwgKXtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY291bnRyeUNvZGVCb29sZWFuID10cnVlO1xuICAgICAgICAgICAgICAgICRzY29wZS5tZW1iZXJTdGF0ZVZhbHVlID0gJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuQmFzaWNEYXRhLk1lbWJlclN0YXRlO1xuICAgICAgICAgICAgICAgICRzY29wZS5zdGF0ZVZhbHVlID0gJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuQmFzaWNEYXRhLk1lbWJlclN0YXRlO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkJhc2ljRGF0YS5TdGF0ZSA9ICRzY29wZS5zdGF0ZVZhbHVlO1xuICAgICAgICAgICAgICAgICRzY29wZS5yZWdpb25zQ29kZWxpc3QgPSBkYXRhUmVwb3NpdG9yeS5sb2FkUmVnaW9uc0NvZGVsaXN0KCRzY29wZS5tZW1iZXJTdGF0ZVZhbHVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ2luc3RhbmNlUmVhZHknKTtcbiAgICAgICAgfSk7XG5cbiAgIFxuICAgICAgICBcbiAgICAgICAgJHNjb3BlLnJlcG9ydGluZ1llYXJzID0gW107XG4gICAgICAgICRzY29wZS5yZXBvcnRpbmdZZWFycy5wdXNoICgnMjAxNicpO1xuICAgICAgICAkc2NvcGUucGxhbnREZXRhaWxzT3RoZXJTZWN0b3JGaWVsZHNWaWV3ID0ge2lyb25fc3RlZWw6XCJJcm9uIGFuZCBTdGVlbFwiLGVzaTpcIkVsZWN0cmljaXR5IHByb2R1Y3Rpb25cIixkaXN0cmljdF9oZWF0aW5nOlwiRGlzdHJpY3QgaGVhdGluZ1wiLGNocDpcIkNvbWJpbmVkIGhlYXQgYW5kIHBvd2VyIGdlbmVyYXRpb25cIixvdGhlcjpcIk90aGVyXCJ9O1xuXG4gICAgICAgIC8vIG5ld1xuICAgICAgICAkc2NvcGUuY3VycmVudExpc3RPZlBsYW50c1RhYmxlID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLnNlbGVjdGVkTGlzdE9mUGxhbnRzVGFibGUgPSBudWxsO1xuICAgICAgICAkc2NvcGUudHJhbnNsYXRpb25EYXRhID0ge307XG4gICAgICAgICRyb290U2NvcGUuYnVsa0VkaXRMaXN0T2ZQbGFudHM9ZmFsc2U7XG4gICAgICAgIC8vJHNjb3BlLnN0YXR1cyA9IHN1Ym1pc3Npb25TZXJ2aWNlLmdldFN0YXR1cygpO1xuICAgICAgICAkc2NvcGUucHJvZmlsZUZpbGxlZCA9IHRydWU7XG4gICAgICAgICRzY29wZS5lZGl0UmVmZXJlbmNlID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5jaGFuZ2VkUmVmZXJlbmNlID0gXCJcIjtcbiAgICAgICAgJHNjb3BlLmVkaXRVc2VySWRlbnRpdHkgPSBmYWxzZTtcbiAgICAgICAgJHNjb3BlLmNoYW5nZWRVc2VySWRlbnRpdHkgPSBcIlwiO1xuICAgICAgICAkc2NvcGUuZWRpdENvdW50cnkgPSBmYWxzZTtcbiAgICAgICAgJHNjb3BlLmNoYW5nZWRDb3VudHJ5ID0gXCJcIjtcbiAgICAgICAgJHNjb3BlLnJlZ2lvbnNDb2RlbGlzdCA9IHt9O1xuICAgICAgICAkc2NvcGUucmVnaW9uc0NvdW50cnkgPSBudWxsO1xuICAgICAgICAkc2NvcGUuaXNJRTkgPSAkcm9vdFNjb3BlLmlzSUU5O1xuXG4gICAgICAgICRzY29wZS5jaGVja0JveERlbGV0ZUNvbW1pdCA9IGZhbHNlO1xuICAgICAgICAvLyBuZXcgZW5kXG4gICAgICAgIC8vZGV0ZXJtaW5lIGllIHZlcnNpb24sIGNvZGUgc25pcHBldCBpcyB0YWtlbiBmcm9tOiBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvbXM1Mzc1MDklMjh2PXZzLjg1JTI5LmFzcHhcbiAgICAgICAgdmFyIHJ2ID0gLTE7IC8vIFJldHVybiB2YWx1ZSBhc3N1bWVzIGZhaWx1cmUuXG4gICAgICAgIGlmIChuYXZpZ2F0b3IuYXBwTmFtZSA9PSAnTWljcm9zb2Z0IEludGVybmV0IEV4cGxvcmVyJylcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIHVhID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcbiAgICAgICAgICAgIHZhciByZSAgPSBuZXcgUmVnRXhwKFwiTVNJRSAoWzAtOV17MSx9W1xcLjAtOV17MCx9KVwiKTtcbiAgICAgICAgICAgIGlmIChyZS5leGVjKHVhKSAhPSBudWxsKVxuICAgICAgICAgICAgICAgIHJ2ID0gcGFyc2VGbG9hdCggUmVnRXhwLiQxICk7XG4gICAgICAgIH1cbiAgICAgICAgLy9zZWU6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTc5MDc0NDUvaG93LXRvLWRldGVjdC1pZTExXG4gICAgICAgIGVsc2UgaWYgKG5hdmlnYXRvci5hcHBOYW1lID09ICdOZXRzY2FwZScpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciB1YSA9IG5hdmlnYXRvci51c2VyQWdlbnQ7XG4gICAgICAgICAgICB2YXIgcmUgID0gbmV3IFJlZ0V4cChcIlRyaWRlbnQvLipydjooWzAtOV17MSx9W1xcLjAtOV17MCx9KVwiKTtcbiAgICAgICAgICAgIGlmIChyZS5leGVjKHVhKSAhPSBudWxsKVxuICAgICAgICAgICAgICAgIHJ2ID0gcGFyc2VGbG9hdCggUmVnRXhwLiQxICk7XG4gICAgICAgIH1cblxuICAgICAgICAkcm9vdFNjb3BlLmllVmVyc2lvbk51bWJlck91dE9mQ3VyaW9zaXR5VmFyaWFibGUgPSBydjtcbiAgICAgICAgaWYgKHJ2ID4gMCAmJiBydiA8PSA5LjApe1xuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0lFOSA9IHRydWU7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0lFOSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgICRyb290U2NvcGUuJHdhdGNoKCdpc0lFOScsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICAgICAgaWYgKCFuZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmlzSUU5ID0gJHJvb3RTY29wZS5pc0lFOTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuXG4gICAgICAgIC8vJHNjb3BlLmNvdW50cnlDb2RlQm9vbGVhbiA9ICBjb3VudHJ5Q29kZSAhPSBudWxsICA7XG4gICAgICAgICRzY29wZS5jb3VudHJ5Q29kZVZhbCA9ICBjb3VudHJ5Q29kZTtcblxuXG4gICAgICAgIGRhdGFSZXBvc2l0b3J5LmxvYWRDb2RlTGlzdCgpO1xuICAgICAgICBkYXRhUmVwb3NpdG9yeS5sb2FkT2xkTENQQ29kZUxpc3QoKTtcbiAgICAgICAgZGF0YVJlcG9zaXRvcnkubG9hZENvbWJ1c3Rpb25QbGFudENvZGVMaXN0KCk7XG4gICAgICAgIGRhdGFSZXBvc2l0b3J5LmxvYWREZXJvZ2F0aW9uVmFsdWVDb2RlTGlzdCgpO1xuICAgICAgICBkYXRhUmVwb3NpdG9yeS5sb2FkT3RoZXJTb2xpZEZ1ZWxDb2RlTGlzdCgpO1xuICAgICAgICBkYXRhUmVwb3NpdG9yeS5sb2FkT3RoZXJHYXNlc291c0Z1ZWxDb2RlTGlzdCgpO1xuICAgICAgICBkYXRhUmVwb3NpdG9yeS5sb2FkTW9udGhWYWx1ZUNvZGVMaXN0KCk7XG4gICAgICAgICRzY29wZS5jb2RlTGlzdCA9IGRhdGFSZXBvc2l0b3J5LmdldENvZGVMaXN0KCk7XG5cbiAgICAgICBcbiAgICBcbiAgICAgICAgJHNjb3BlLmNvbnZlcnNpb25MaW5rID0gXCJcIjtcbiAgICAgICAgJHNjb3BlLmluc3RhbmNlSW5mbyA9IHt9O1xuICAgICAgICBkYXRhUmVwb3NpdG9yeS5sb2FkSW5zdGFuY2VJbmZvKCkuZXJyb3IoZnVuY3Rpb24oKXtjb25zb2xlLmxvZyhcIkZhaWxlZCB0byByZWFkZmlsZSBpbmZvIGZyb20gc2VydmVyLlwiKTt9KS5zdWNjZXNzKGZ1bmN0aW9uKGluZm8pIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuY29weShpbmZvLCAkc2NvcGUuaW5zdGFuY2VJbmZvKTtcbiAgICAgICAgICAgIGlmICgkc2NvcGUuaW5zdGFuY2VJbmZvLmNvbnZlcnNpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGh0bWxDb252ZXJzaW9uSWQgPSAkZmlsdGVyKCdmaWx0ZXInKSgkc2NvcGUuaW5zdGFuY2VJbmZvLmNvbnZlcnNpb25zLCB7cmVzdWx0VHlwZTogJ0hUTUwnfSlbMF0uaWQ7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbnZlcnNpb25MaW5rID0gJHNjb3BlLmluc3RhbmNlSW5mby5jb252ZXJzaW9uTGluayArIGh0bWxDb252ZXJzaW9uSWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cblxuICAgICAgICAvLyBSZW1vdmUgcm93IGZyb20gbmctcmVwZWF0LlxuICAgICAgICAkc2NvcGUucmVtb3ZlID0gZnVuY3Rpb24oYXJyYXksICByb3dFbGVtZW50LCBzaG93TXNnKXtcblxuICAgICAgICAgICAgLy8vL2NvbnNvbGUubG9nKHJvd0VsZW1lbnQpO1xuICAgICAgICAgICAgLy8vL2NvbnNvbGUubG9nKGNvdW50Tm9uRW1wdHlQcm9wZXJ0aWVzKHJvd0VsZW1lbnQpKTtcbiAgICAgICAgICAgIGlmKHNob3dNc2cgPT0gdHJ1ZSl7XG4gICAgICAgICAgICAgICAgaWYgKGNvdW50Tm9uRW1wdHlQcm9wZXJ0aWVzKHJvd0VsZW1lbnQpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhlIGRhdGEgaW4gdGhpcyByb3c/Jykpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGluZGV4ID0gYXJyYXkuaW5kZXhPZihyb3dFbGVtZW50KTtcbiAgICAgICAgICAgIGFycmF5LnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZUZpbHRlcicpO1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgLy8gZ2V0IGNvZGUgbGlzdCBsYWJlbCBieSBjb2RlXG4gICAgICAgICRzY29wZS5nZXRDb2RlTGlzdExhYmVsID0gZnVuY3Rpb24oY29kZWxpc3QsIGNvZGUpIHtcbiAgICAgICAgICAgIC8vRG8gbm90IHRyeSB0byBnZXQgY29kZUxpc3QgYmVmb3JlIGl0IGFjdHVhbGx5IGV4aXN0cy5cbiAgICAgICAgICAgIGlmICghJHNjb3BlLmNvZGVMaXN0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL0VzY2FwZSBjb2RlbGlzdHMgdGhhdCBhcmUgbm90IGFycmF5cyBieSBkZWZhdWx0IChoYXMgb25seSBvbmUgZWxlbWVudClcbiAgICAgICAgICAgIC8vIFRoaXMgY29kZSBjYW4gYmUgcmVtb3ZlZCB3aGVuIGNoYW5nZXMgYXJlIG1hZGUgdG8gY29kZUxpc3QgZmlsZS5cbiAgICAgICAgICAgIGlmICghKCRzY29wZS5jb2RlTGlzdC5MQ1BDb2RlbGlzdHNbY29kZWxpc3RdLml0ZW0ubGVuZ3RoID4gMClcbiAgICAgICAgICAgICAgICAgICAgJiYgJHNjb3BlLmNvZGVMaXN0LkxDUENvZGVsaXN0c1tjb2RlbGlzdF0uaXRlbS5jb2RlID09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLmNvZGVMaXN0LkxDUENvZGVsaXN0c1tjb2RlbGlzdF0uaXRlbS5sYWJlbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHJldFZhbHVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaT0wIDsgaTw9JHNjb3BlLmNvZGVMaXN0LkxDUENvZGVsaXN0c1tjb2RlbGlzdF0uaXRlbS5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNvZGVMaXN0LkxDUENvZGVsaXN0c1tjb2RlbGlzdF0uaXRlbVtpXS5jb2RlID09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0VmFsdWUgPSAkc2NvcGUuY29kZUxpc3QuTENQQ29kZWxpc3RzW2NvZGVsaXN0XS5pdGVtW2ldLmxhYmVsO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0VmFsdWU7XG4gICAgICAgIH07XG5cblxuICAgICAgICAkc2NvcGUuYWRkSXRlbSA9IGZ1bmN0aW9uKHBhdGgpIHtcblxuICAgICAgICAgICAgdmFyIHRva2VucyA9IHBhdGguc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9ICRzY29wZS5pbnN0YW5jZTtcbiAgICAgICAgICAgIHdoaWxlKHRva2Vucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHRbdG9rZW5zLnNoaWZ0KCldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEocmVzdWx0IGluc3RhbmNlb2YgQXJyYXkpKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBOZWVkIHRvIG1ha2UgY29weSBvZiBvYmplY3Qgb3RoZXJ3aXNlIGl0IGdldHMgc2FtZSAkJGhhc2hrZXkgYW5kIGl0IGNhbm5vdCBiZSB1c2VkIGluIG5nLXJlcGVhdC5cbiAgICAgICAgICAgIC8vIE90aGVyIHNvbHV0aW9uIHdvdWxkIGJlIHRvIGdldCBlbXB0eSBpbnN0YW5jZSBldmVyeSB0aW1lIHRoYXQgd291bGQgYmUgc2xvd2VyLlxuICAgICAgICAgICAgdmFyIGNvcHlPZkVtcHR5SW5zdGFuY2UgPSBjbG9uZSgkc2NvcGUuZ2V0SW5zdGFuY2VCeVBhdGgoJ2VtcHR5SW5zdGFuY2UnLCBwYXRoKSk7XG4gICAgICAgICAgICByZXN1bHQucHVzaChjb3B5T2ZFbXB0eUluc3RhbmNlKTtcbiAgICAgICAgICAgIHJldHVybiBjb3B5T2ZFbXB0eUluc3RhbmNlO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5nZXROZXh0UGxhbnRJZCA9IGZ1bmN0aW9uICggcGxhbnRJZF9jYW5kaWRhdGUgKSB7XG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgdmFyIHEgPSAkcS5kZWZlciAoKTtcblxuICAgICAgICAgICAgdmFyIGZvcm1OZXh0UGxhbnRJZCA9IDE7XG4gICAgICAgICAgICB2YXIgbmV3UGxhbnRJZCA9IG51bGw7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHBhZChudW0sIHNpemUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcyA9IG51bStcIlwiO1xuICAgICAgICAgICAgICAgIHdoaWxlIChzLmxlbmd0aCA8IHNpemUpIHMgPSBcIjBcIiArIHM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrU0RTICggbmV3UGxhbnRJZCApIHtcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gXCJodHRwOi8vc2VtYW50aWMuZWVhLmV1cm9wYS5ldS9zcGFycWw/Zm9ybWF0PWFwcGxpY2F0aW9uL2pzb24mcXVlcnk9XCI7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3BhcnFsID1cbiAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIHJkZnM6IDxodHRwOi8vd3d3LnczLm9yZy8yMDAwLzAxL3JkZi1zY2hlbWEjPlwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIGxjcFR5cGU6IDxodHRwOi8vc2VtYW50aWMuZWVhLmV1cm9wYS5ldS9wcm9qZWN0L2xjcF9kYXRhL2xjcF9wbGFudHMuY3N2Lz5cIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIFBSRUZJWCBsY3A6IDxodHRwOi8vc2VtYW50aWMuZWVhLmV1cm9wYS5ldS9wcm9qZWN0L2xjcF9kYXRhL2xjcF9wbGFudHMuY3N2Iz5cIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIFNFTEVDVCAqXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiBXSEVSRSB7XCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiA/cGxhbnQgYSBsY3BUeXBlOmxjcFBsYW50IDtcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIGxjcDpVbmlxdWVfUGxhbnRfSUQgP1BsYW50SWQuXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiBGSUxURVIgKCA/UGxhbnRJZCA9ICdcIiArIG5ld1BsYW50SWQgK1wiJyApXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiB9XCIgO1xuXG4gICAgICAgICAgICAgICAgdXJsID0gYmFzZVVyaSArICcvcmVzdFByb3h5P3VyaT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCArIGVuY29kZVVSSUNvbXBvbmVudChzcGFycWwpKTtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsLCB7dHJhY2tlciA6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbigpe2FsZXJ0KFwiRmFpbGVkIHRvIHJlYWQgZGF0YSBmcm9tIHJlbW90ZSBkYXRhYmFzZS4gUGxlYXNlIGNoZWNrIHlvdXIgY29ubmVjdGlvbi5cIik7IHEucmVqZWN0KCk7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihlcHJ0ckRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVwcnRyRGF0YS5yZXN1bHRzLmJpbmRpbmdzLmxlbmd0aCA+IDApIHsgLy8gcGxhbmRJZCBleGlzdHMgaW4gZGJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGFnYWluc3QgdGhlIG5leHQgaW5jcmVtZW50IG9mIHBsYW50aWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1BsYW50SWQgPSAgICgkc2NvcGUubWVtYmVyU3RhdGVWYWx1ZSB8fCAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5CYXNpY0RhdGEuTWVtYmVyU3RhdGUpICsgcGFkKCBwYXJzZUludCggbmV3UGxhbnRJZC5zbGljZSgyKSApICsgMSAsIDQgKSA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0TmV4dFBsYW50SWQgKCBuZXdQbGFudElkICkgLiB0aGVuICggZnVuY3Rpb24gKCB2YWx1ZSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxLnJlc29sdmUgKCB2YWx1ZSApIDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKSA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7IC8vIHBsYW50aWQgbm90IHJlc2VydmVkLiByZXNvbHZlIHRoZSBwcm9taXNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxLnJlc29sdmUgKCBuZXdQbGFudElkICkgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICggcGxhbnRJZF9jYW5kaWRhdGUgPT0gbnVsbCApXG4gICAgICAgICAgICB7IC8vIHBsYW50SWRfY2FuZGlkYXRlID09IG51bGwgb24gdGhlIGZpcnN0IGNhbGwgb2YgdGhlIGZ1bmN0aW9uXG4gICAgICAgICAgICAgICAgLy8gd2UgZ2V0IHRoZSBtYXggcGxhbnQgaWQgb2YgdGhlIGN1cnJlbnQgcGxhbnRzIG9uIHRoIGZvcm1cbiAgICAgICAgICAgICAgICAvLyBhbmQgdGhlIG1heCBwbGFudCBpZCBmcm9tIHNkc1xuICAgICAgICAgICAgICAgIC8vIHRoZW4gd2Ugd2lsbCBjaGVjayBmb3IgaWQgY29sbGlzaW9ucyBhbmQgaW5jcmVtZW50IGJ5IG9uZSB0aGUgaWQgYW5kIHJlY2hlY2ssIHVudGlsIGEgJ2ZyZWUnIHBsYW50IGlkIGlzIGZvdW5kXG5cbiAgICAgICAgICAgICAgICB2YXIgb3JkZXJCeSA9ICRmaWx0ZXIoJ29yZGVyQnknKTtcbiAgICAgICAgICAgICAgICB2YXIgb3JkZXJlZEl0ZW1zID0gb3JkZXJCeSggJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50LCBcIlBsYW50SWRcIiwgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTA7IGkgPCBvcmRlcmVkSXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRW1wdHkob3JkZXJlZEl0ZW1zW2ldLlBsYW50SWQgKSAmJiBvcmRlcmVkSXRlbXNbaV0uUGxhbnRJZCAhPT0gXCJcIiApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybU5leHRQbGFudElkID0gcGFyc2VJbnQob3JkZXJlZEl0ZW1zW2ldLlBsYW50SWQuc3Vic3RyaW5nKG9yZGVyZWRJdGVtc1tpXS5QbGFudElkLmxlbmd0aCAtIDQgKSkgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAvLyAtLS0tIHF1ZXJ5IHRoZSBzZHMgZm9yIHRoZSBtYXggaWRcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gXCJodHRwOi8vc2VtYW50aWMuZWVhLmV1cm9wYS5ldS9zcGFycWw/Zm9ybWF0PWFwcGxpY2F0aW9uL2pzb24mcXVlcnk9XCI7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3BhcnFsID1cbiAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIHJkZnM6IDxodHRwOi8vd3d3LnczLm9yZy8yMDAwLzAxL3JkZi1zY2hlbWEjPlwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIGxjcFR5cGU6IDxodHRwOi8vc2VtYW50aWMuZWVhLmV1cm9wYS5ldS9wcm9qZWN0L2xjcF9kYXRhL3BsYW50X0lEcy5jc3YvPlwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIGxjcDogPGh0dHA6Ly9zZW1hbnRpYy5lZWEuZXVyb3BhLmV1L3Byb2plY3QvbGNwX2RhdGEvcGxhbnRfSURzLmNzdiM+IFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIgU0VMRUNUICpcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIFdIRVJFIHtcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIFtdIGEgbGNwVHlwZTpsY3BQbGFudElkcyA7XCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiBsY3A6VW5pcXVlX1BsYW50X0lEID9QbGFudElkLlwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIgRklMVEVSICggcmVnZXgoP1BsYW50SWQsJ1wiICsgICgkc2NvcGUubWVtYmVyU3RhdGVWYWx1ZSB8fCAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5CYXNpY0RhdGEuTWVtYmVyU3RhdGUpICtcIicpIClcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIH0gIE9SREVSIEJZIERFU0MoP1BsYW50SWQpIExJTUlUIDEgXCIgO1xuXG4gICAgICAgICAgICAgICAgdXJsID0gYmFzZVVyaSArICcvcmVzdFByb3h5P3VyaT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCArIGVuY29kZVVSSUNvbXBvbmVudChzcGFycWwpKTtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsLCB7dHJhY2tlciA6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbigpe2FsZXJ0KFwiRmFpbGVkIHRvIHJlYWQgZGF0YSBmcm9tIHJlbW90ZSBkYXRhYnNlLiBQbGVhc2UgY2hlY2sgeW91ciBjb25uZWN0aW9uXCIpOyBxLnJlamVjdCgpO30pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZXBydHJEYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXh0SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggZXBydHJEYXRhLnJlc3VsdHMuYmluZGluZ3MubGVuZ3RoID4gMCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dElkID0gcGFyc2VJbnQoIGVwcnRyRGF0YS5yZXN1bHRzLmJpbmRpbmdzWzBdLlBsYW50SWQudmFsdWUuc2xpY2UoMikgKSArIDEgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGZvcm1OZXh0UGxhbnRJZCA+IG5leHRJZCApIG5leHRJZCA9IGZvcm1OZXh0UGxhbnRJZCA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIG5leHRJZCA9IGZvcm1OZXh0UGxhbnRJZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3UGxhbnRJZCA9ICAgKCRzY29wZS5tZW1iZXJTdGF0ZVZhbHVlIHx8ICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkJhc2ljRGF0YS5NZW1iZXJTdGF0ZSkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZCggIG5leHRJZCAsIDQgKSA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja1NEUyAoIG5ld1BsYW50SWQgKSA7XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY2hlY2tTRFMgKCBwbGFudElkX2NhbmRpZGF0ZSApIDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHEucHJvbWlzZSA7XG5cbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5nZXRNYXhQbGFudElkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgb3JkZXJCeSA9ICRmaWx0ZXIoJ29yZGVyQnknKTtcbiAgICAgICAgICAgIHZhciBvcmRlcmVkSXRlbXMgPSBvcmRlckJ5KCAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQsIFwiUGxhbnRJZFwiLCB0cnVlKTtcbiAgICAgICAgICAgIHZhciBuZXh0UGxhbnRJZCA9IDE7XG4gICAgICAgICAgICB2YXIgbmV3UGxhbnRJZCA9IG51bGw7XG4gICAgICAgICAgICB2YXIgZXhpc3RzID0gbnVsbDtcblxuICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpIDwgb3JkZXJlZEl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc0VtcHR5KG9yZGVyZWRJdGVtc1tpXS5QbGFudElkICkgJiYgb3JkZXJlZEl0ZW1zW2ldLlBsYW50SWQgIT09IFwiXCIgKSB7XG4gICAgICAgICAgICAgICAgICAgIG5leHRQbGFudElkID0gcGFyc2VJbnQob3JkZXJlZEl0ZW1zW2ldLlBsYW50SWQuc3Vic3RyaW5nKG9yZGVyZWRJdGVtc1tpXS5QbGFudElkLmxlbmd0aCAtIDQgKSkgKyAxO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBmb3JtYXQgdGhlIGlkIDogWFhOTk5OLCB3aGVyZSBYWCBpcyB0aGUgbWVtYmVyc3RhdGUgY29kZSBhbmQgTk5OTiBpcyBhIHVuaXF1ZSBpbnRlZ2VyXG4gICAgICAgICAgICBmdW5jdGlvbiBwYWQobnVtLCBzaXplKSB7XG4gICAgICAgICAgICAgICAgdmFyIHMgPSBudW0rXCJcIjtcbiAgICAgICAgICAgICAgICB3aGlsZSAocy5sZW5ndGggPCBzaXplKSBzID0gXCIwXCIgKyBzO1xuICAgICAgICAgICAgICAgIHJldHVybiBzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBuZXdQbGFudElkID0gICgkc2NvcGUubWVtYmVyU3RhdGVWYWx1ZSB8fCAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5CYXNpY0RhdGEuTWVtYmVyU3RhdGUpICsgcGFkKCBuZXh0UGxhbnRJZCwgNCk7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXdQbGFudElkO1xuICAgICAgICB9XG5cbiAgICAgICAgJHJvb3RTY29wZS5nZXRJbnN0YW5jZUJ5UGF0aCA9IGZ1bmN0aW9uKHJvb3QsIGlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2cocm9vdCk7XG4gICAgICAgICAgICBpZiAoISRzY29wZS5pbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdG9rZW5zID0gcm9vdC5zcGxpdChcIi5cIik7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRva2Vucyk7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gJHNjb3BlO1xuXG4gICAgICAgICAgICB3aGlsZSh0b2tlbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0W3Rva2Vucy5zaGlmdCgpXTtcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRva2VucyA9IGlkZW50aWZpZXIuc3BsaXQoXCIuXCIpO1xuXG4gICAgICAgICAgICB3aGlsZSh0b2tlbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0W3Rva2Vucy5zaGlmdCgpXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcblxuICAgICAgICAkcm9vdFNjb3BlLmdldFBsYW50QnlQYXRoID0gZnVuY3Rpb24ocGxhbnQsIGlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2cocm9vdCk7XG4gICAgICAgICAgICBpZiAoISRzY29wZS5pbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh0b2tlbnMpO1xuICAgICAgICAgICAgaWYocGxhbnQgIT0gbnVsbCl7XG4gICAgICAgICAgICAgcmVzdWx0ID0gcGxhbnQ7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgdmFyIHRva2VucyA9IGlkZW50aWZpZXIuc3BsaXQoXCIuXCIpO1xuXG4gICAgICAgICAgICB3aGlsZSh0b2tlbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0W3Rva2Vucy5zaGlmdCgpXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzYXZlIGluc3RhbmNlIGRhdGEuXG4gICAgICAgICRzY29wZS5zYXZlSW5zdGFuY2UgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBwbGFudHNMaXN0ID0gJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50O1xuICAgICAgICAgICAgZm9yICggaT0wIDsgaSA8IHBsYW50c0xpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICBpZihwbGFudHNMaXN0W2ldLlBsYW50TG9jYXRpb24uQ291bnRyeUNvZGU9PW51bGwgfHwgcGxhbnRzTGlzdFtpXS5QbGFudExvY2F0aW9uLkNvdW50cnlDb2RlPT1cIlwiIClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHBsYW50c0xpc3RbaV0uUGxhbnRMb2NhdGlvbi5Db3VudHJ5Q29kZT0kc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5CYXNpY0RhdGEuTWVtYmVyU3RhdGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHBhc3NlZFRoZVFhcyA9ICRzY29wZS5ydW5RQXRlc3RzKCk7XG4gICAgICAgICAgICB2YXIgZm9ybUNvbXBsZXRlID0gJHNjb3BlLmlzRm9ybUNvbXBsZXRlKCk7XG5cblx0XHRcdGRhdGFSZXBvc2l0b3J5LnNhdmVJbnN0YW5jZSgkc2NvcGUuaW5zdGFuY2UpLmVycm9yKGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICAkbm90aWZpY2F0aW9uLmVycm9yKFwiU2F2ZVwiLCBcIkRhdGEgd2FzIG5vdCBzYXZlZCAhXCIpO30pXG5cbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgICAgICBpZiAoIHJlc3BvbnNlLmNvZGUgPT09IDAgKSB7XG4gICAgICAgICAgICAgICAgICBhbGVydChcIlRoZXJlIHdhcyBhbiBlcnJvciBkdXJpbmcgdGhlIHNhdmUgb3BlcmF0aW9uLiBEYXRhIGlzIG5vdCBzYXZlZC5cIilcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmFwcEZvcm0uJGludmFsaWQgfHwgKCAhZm9ybUNvbXBsZXRlKSApIHtcbiAgICAgICAgICAgICAgICAgICAgJG5vdGlmaWNhdGlvbi5pbmZvKFwiU2F2ZVwiLCBcIkRhdGEgd2FzIHNhdmVkLCBidXQgdGhlIHF1ZXN0aW9ubmFpcmUgaXMgaW5jb21wbGV0ZS5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFwYXNzZWRUaGVRYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgJG5vdGlmaWNhdGlvbi5pbmZvKFwiU2F2ZVwiLCBcIkRhdGEgd2FzIHNhdmVkLCBidXQgdGhlIHF1ZXN0aW9ubmFpcmUgZGlkIG5vdCBwYXNzIHNvbWUgUUFzLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRub3RpZmljYXRpb24uc3VjY2VzcyhcIlNhdmVcIiwgXCJEYXRhIGlzIHNhdmVkIHN1Y2Nlc3NmdWxseS5cIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFwcEZvcm0uJHNldFByaXN0aW5lKHRydWUpO1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9O1xuXG4gICAgICAgICAkc2NvcGUuaGFzQXJ0aWNsZTMxRGVyb2dhdGlvblZhbHVlID0gZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgICAgICAgLy8gY2hlY2sgYWdhaW5zdCB0aGlzIHZhbHVlOiBodHRwOi8vZGQuZWlvbmV0LmV1cm9wYS5ldS92b2NhYnVsYXJ5Y29uY2VwdC9ldXJlZ2lzdHJ5b25pbmR1c3RyaWFsc2l0ZXMvRGVyb2dhdGlvblZhbHVlL0FydGljbGUzMS9cbiAgICAgICAgICAgICBpZihpdGVtLlBsYW50RGV0YWlscyE9bnVsbCAmJiBpdGVtLlBsYW50RGV0YWlscy5EZXJvZ2F0aW9uIT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgIGlmKGl0ZW0uUGxhbnREZXRhaWxzLkRlcm9nYXRpb24uaW5kZXhPZihcIkFydGljbGUzMVwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICB9XG5cbiAgICAgICAgICRzY29wZS5oYXNBcnRpY2xlMzVEZXJvZ2F0aW9uVmFsdWUgPSBmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgICAgICAvLyBjaGVjayBhZ2FpbnN0IHRoaXMgdmFsdWU6IGh0dHA6Ly9kZC5laW9uZXQuZXVyb3BhLmV1L3ZvY2FidWxhcnljb25jZXB0L2V1cmVnaXN0cnlvbmluZHVzdHJpYWxzaXRlcy9EZXJvZ2F0aW9uVmFsdWUvQXJ0aWNsZTM1L1xuICAgICAgICAgICAgIGlmKGl0ZW0uUGxhbnREZXRhaWxzIT1udWxsICYmIGl0ZW0uUGxhbnREZXRhaWxzLkRlcm9nYXRpb24hPSBudWxsKXtcbiAgICAgICAgICAgICAgICAgaWYoaXRlbS5QbGFudERldGFpbHMuRGVyb2dhdGlvbi5pbmRleE9mKFwiQXJ0aWNsZTM1XCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgfVxuICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgIH1cblxuXG4gICAgICAgICAkc2NvcGUuYWRkRGVzdWxwaHVyaXphdGlvblZhbHVlc0ZvckVhY2hNb250aD1mdW5jdGlvbihpLHBsYW50KXtcbiAgICAgICAgICAgICAgICAgcGxhbnQuRGVzdWxwaHVyaXNhdGlvbi5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgXCJNb250aFZhbHVlXCI6JHNjb3BlLmNvZGVMaXN0Lk1vbnRobHlEZXN1bHBodXJpc2F0aW9uW2ldLk1vbnRoVmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIFwiRGVzdWxwaHVyaXNhdGlvblJhdGVcIjogJHNjb3BlLmNvZGVMaXN0Lk1vbnRobHlEZXN1bHBodXJpc2F0aW9uW2ldLkRlc3VscGh1cmlzYXRpb25SYXRlLFxuICAgICAgICAgICAgICAgICAgICBcIlN1bHBodXJDb250ZW50XCI6ICRzY29wZS5jb2RlTGlzdC5Nb250aGx5RGVzdWxwaHVyaXNhdGlvbltpXS5TdWxwaHVyQ29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgXCJUZWNobmljYWxKdXN0aWZpY2F0aW9uXCI6ICRzY29wZS5jb2RlTGlzdC5Nb250aGx5RGVzdWxwaHVyaXNhdGlvbltpXS5UZWNobmljYWxKdXN0aWZpY2F0aW9uLFxuICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgfVxuICAgICAgICAkc2NvcGUuaXNGb3JtQ29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyByZXR1cm5zIHRydWUgaWYgdGhlIHJlcXVpcmVkIGZpZWxkcyBmb3IgYWxsIHBsYW50IGFyZSBmaWxsZWQ7IGZhbHNlIGlmIG5vdCB+XG5cbiAgICAgICAgICAgIHZhciByZXMgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHBsYW50cyA9ICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudDtcbiAgICAgICAgICAgIHZhciBwbGFudCA9IG51bGw7XG4gICAgICAgICAgICB2YXIgaiA9IG51bGw7XG5cbiAgICAgICAgICAgIGZvciAoIGk9MCA7IGkgPCBwbGFudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBwbGFudCA9IHBsYW50c1tpXTtcbiAgICAgICAgICAgICAgICAvLyBsaXN0IG9mIHBsYW50c1xuICAgICAgICAgICAgICAgIGlmICggaXNFbXB0eSAocGxhbnQuUGxhbnRJZCkgfHwgaXNFbXB0eSggcGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5MYXRpdHVkZSkgfHwgaXNFbXB0eSAoIHBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTG9uZ2l0dWRlKSAgIClcbiAgICAgICAgICAgICAgICAgICAgcmVzID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAvLyBwbGFudCBkZXRhaWxzXG4gICAgICAgICAgICAgICAgaWYgKCBpc0VtcHR5ICggcGxhbnQuUGxhbnREZXRhaWxzLk1XdGgpIClcbiAgICAgICAgICAgICAgICAgICAgcmVzID0gZmFsc2U7XG5cbiAgICBcblxuICAgICAgICAgICAgICAgIGlmIChyZXMgPT09IGZhbHNlKSBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlcztcblxuXG4gICAgICAgIH1cblxuXG4gICAgICAgICRzY29wZS5ydW5RQXRlc3RzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAvLyBjb25mb3JtIHRoZSBpbnN0YW5jZSBpZiBuZWVkZWRcblxuICAgICAgICAgICAgdmFyIHJlcyA9IHRydWU7XG4gICAgICAgICAgICB2YXIgcGxhbnRzID0gJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50O1xuXG4gICAgICAgICAgICBpZiAocGxhbnRzLmxlbmd0aCAhPSAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5CYXNpY0RhdGEuTnVtYmVyT2ZQbGFudHMpXG4gICAgICAgICAgICAgICAgcmVzID0gZmFsc2U7XG5cbiAgICAgICAgICAgIHZhciBzZWN0b3JzID0ge307XG4gICAgICAgICAgICB2YXIgc3RhdHVzICA9IHt9O1xuXG4gICAvLyAgICAgICAgIGZvciAoaSBpbiAkc2NvcGUuY29kZUxpc3QuTENQQ29kZWxpc3RzLnNlY3RvcnMuY29uY2VwdHMpIHsgIHNlY3RvcnNbICRzY29wZS5jb2RlTGlzdC5MQ1BDb2RlbGlzdHMuc2VjdG9ycy5jb25jZXB0c1sgaSBdIFsnQGlkJ10gXSA9IDEgOyB9XG4gICAgICAgICAgICAvLyBzZWN0b3JzIGlzIGEgZGljdGlvbmFyeSBvZiB2YWxpZCBvdGhlciBzZWN0b3IgdmFsdWVzXG5cbiAgICAgICAgLy8gICAgZm9yIChpIGluICRzY29wZS5jb2RlTGlzdC5MQ1BDb2RlbGlzdHMuc3RhdHVzLmNvbmNlcHRzKSB7ICBzdGF0dXNbICRzY29wZS5jb2RlTGlzdC5MQ1BDb2RlbGlzdHMuc3RhdHVzLmNvbmNlcHRzWyBpIF0gWydAaWQnXSBdID0gMSA7IH1cblxuICAgICAgICAgICAgdmFyIG5hbWVzID0ge307XG4gICAgICAgICAgICB2YXIgZHVibGljYXRlcyA9IHt9O1xuICAgICAgICAgICAgdmFyIHJlZkRheSA9IG5ldyBEYXRlKFwiMjAwMy0xMS0yN1wiKTtcblxuICAgICAgICAgICAgZm9yICggaT0wIDsgaSA8IHBsYW50cy5sZW5ndGg7IGkrKykge1xuXG4gICAgICAgICAgICAgICAgLy8gTENQIDEuMVxuICAgICAgICAgICAgICAgIC8vIG5vdCByZWZpbmVyeVxuXG4gICAgICAgICAgICAgICAgaWYgKCAhcGxhbnRzW2ldLlBsYW50RGV0YWlscykgY29udGludWU7IC8vIHNvbWUgdGltZXMgYSBudWxsIHBsYW50IHdhcyBwcmVzZW50IGF0IHRoZSBlbmQgb2YgdGhlIGFycmF5XG5cbiAgICAgICAgICAgICAgICAvLyBjb29yZGluYXRlc1xuICAgICAgICAgICAgICAgIGlmICggcGxhbnRzW2ldLkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTG9uZ2l0dWRlID4gMTgwIHx8IHBsYW50c1tpXS5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxvbmdpdHVkZSA8IC0xODApXG4gICAgICAgICAgICAgICAgICAgIHJlcyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgaWYgKCBwbGFudHNbaV0uR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5MYXRpdHVkZSA+IDkwIHx8IHBsYW50c1tpXS5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxhdGl0dWRlIDwgLTkwKVxuICAgICAgICAgICAgICAgICAgICByZXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAvLyAgICAgaWYgKCAhKCBwbGFudHNbaV0uUGxhbnREZXRhaWxzLlJlZmluZXJpZXMpICYmICggISggcGxhbnRzW2ldLlBsYW50RGV0YWlscy5PdGhlclNlY3RvciAgKSAgfHwgISAoc2VjdG9yc1twbGFudHNbaV0uUGxhbnREZXRhaWxzLk90aGVyU2VjdG9yIF0gKSkgKXtcbiAgICAgICAgICAgICAgICAgICAgLy8gXl4gY2hlY2tzIHRoYXQgaWYgbm90IFJlZmluZXJpZXMsIHRoYXQgT3RoZXJTZWN0b3IgaXMgZmlsbGVkIHdpdGggb25lIG9mIHRoZSBwZXJtaXR0ZWQgdmFsdWVzKGZldGNoZWQgZnJvbSBERClcbiAgICAgICAgICAgIC8vICAgICAgICByZXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAvLyAgIH1cblxuICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgLy8gTENQIDIuMSBVbmVxdWl2b2NhbCBuYW1pbmcgb2YgcGxhbnRzXG4gICAgICAgICAgICAgICAgaWYgKCBuYW1lc1sgcGxhbnRzW2ldLlBsYW50TmFtZSBdICE9IHVuZGVmaW5lZCApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZHVibGljYXRlIGZvdW5kXG4gICAgICAgICAgICAgICAgICAgIGR1YmxpY2F0ZXNbaV0gPSAxO1xuICAgICAgICAgICAgICAgICAgICBkdWJsaWNhdGVzWyBuYW1lc1sgcGxhbnRzIFtpXS5QbGFudE5hbWUgXSBdID0gMTtcbiAgICAgICAgICAgICAgICAgICAgLy9uYW1lc1skc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnRbaV0uUGxhbnROYW1lIF0ucHVzaChpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBuYW1lc1sgcGxhbnRzIFtpXS5QbGFudE5hbWVdID0gaTtcblxuICAgICAgICAgICAgICAgIC8vIExDUCAzLjJcblxuICAgICAgICAgICAgICAgIGlmICggcGxhbnRzW2ldLlBsYW50RGV0YWlscy5NV3RoIDwgNTAgKXtcbiAgICAgICAgICAgICAgICAgICAgLy8gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgcmVzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCBwbGFudHNbaV0uUGxhbnREZXRhaWxzLk1XdGggPiAxMDAwMCl7XG4gICAgICAgICAgICAgICAgICAgIC8vIHdhcm5pbmdcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coaSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gTENQIDMuNFxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBMQ1AgMy41XG4gICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTENQIDMuNlxuICAgICAgICAgICAgICAgIC8vIHZhbGlkIGRhdGVzKGlmIGRhdGUgc3VibWl0dGVkKVxuICAgICAgICAgICAgICAgIGlmICggISRzY29wZS52YWxpZERhdGVGb3JtYXQocGxhbnRzW2ldLlBsYW50RGV0YWlscy5EYXRlT2ZTdGFydE9mT3BlcmF0aW9uKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICBcblxuICAgICAgICAgICAgfS8vIGVuZCBmb3JcbiAgICAgICAgICAgIGlmICggSlNPTi5zdHJpbmdpZnkoZHVibGljYXRlcykgIT09IFwie31cIikge1xuICAgICAgICAgICAgICAgIC8vIGR1cGxpY2F0ZXMgaG9sZHMgdGhlIHBsYW50cyB3aXRoIHNhbWUgbmFtZXNcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkdWJsaWNhdGVzKTtcbiAgICAgICAgICAgICAgICByZXMgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICggcmVzID09PSB0cnVlICkgICRzY29wZS5jb25mb3JtVGhlSW5zdGFuY2UoKTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuY29uZm9ybVRoZUluc3RhbmNlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICB2YXIgcGxhbnRzID0gJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50O1xuICAgICAgICAgICAgZm9yIChqIGluIHBsYW50cyl7XG5cbiAgICAgICAgICAgICAgICBwbGFudCA9IHBsYW50c1tqXTtcblxuICAgICAgICAgICAgICAgIGRlbGV0ZSBwbGFudC5EZWxldGU7XG5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoIHBsYW50LnBsYW50RGV0YWlscyE9bnVsbCAmJiBwbGFudC5QbGFudERldGFpbHMuUmVmaW5lcmllcyAhPT0gdHJ1ZSApe1xuICAgICAgICAgICAgICAgICAgICBwbGFudC5QbGFudERldGFpbHMuUmVmaW5lcmllcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocGxhbnQucGxhbnREZXRhaWxzIT1udWxsICYmIHBsYW50LlBsYW50RGV0YWlscy5SZWZpbmVyaWVzID09PSB0cnVlICl7XG4gICAgICAgICAgICAgICAgICAgIC8vcGxhbnQuUGxhbnREZXRhaWxzLk90aGVyU2VjdG9yID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuaWZGb3JtSXNWYWxpZFNhdmVJbnN0YW5jZSA9IGZ1bmN0aW9uKGZvcm0pe1xuICAgICAgICAgICAgaWYgKCFmb3JtLiRpbnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNhdmVJbnN0YW5jZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUudmFsaWRhdGlvbk9uT2ZmID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gISRzY29wZS5zdWJtaXR0ZWQ7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc2F2ZSBpbnN0YW5jZSBkYXRhLlxuICAgICAgICAkc2NvcGUuY2xvc2UgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgaWYgKGJhc2VVcmkgPT0gJycpe2Jhc2VVcmkgPSBcIi9cIn07XG4gICAgICAgICAgICB2YXIgd2luZG93TG9jYXRpb24gPSAoZW52ZWxvcGUgJiYgZW52ZWxvcGUubGVuZ3RoID4gMCkgPyBlbnZlbG9wZSA6IGJhc2VVcmk7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmFwcEZvcm0uJGRpcnR5KXtcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlybSgnWW91IGhhdmUgbWFkZSBjaGFuZ2VzIGluIHRoZSBxdWVzdGlvbm5haXJlISBcXG5cXG4gRG8geW91IHdhbnQgdG8gbGVhdmUgd2l0aG91dCBzYXZpbmcgdGhlIGRhdGE/Jykpe1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSB3aW5kb3dMb2NhdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLy8vY29uc29sZS5sb2coXCJGYWlsZWQgdG8gY29uZmlybVwiKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSB3aW5kb3dMb2NhdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy8gY29udmVydCBYTUwgdG8gSFRNTCBpbiBuZXcgd2luZG93LlxuICAgICAgICAkc2NvcGUucHJpbnRQcmV2aWV3ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGRhdGFSZXBvc2l0b3J5LnNhdmVJbnN0YW5jZSgkc2NvcGUuaW5zdGFuY2UpLnN1Y2Nlc3MoZnVuY3Rpb24oKXtcblx0XHRcdFx0dmFyIHdpbiA9IHdpbmRvdy5vcGVuKCRzY29wZS5jb252ZXJzaW9uTGluaywgJ19ibGFuaycpO1xuXHRcdFx0XHR3aW4uZm9jdXM7XG5cdFx0XHR9KTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmNsb3NlQnVsa0VkaXRMaXN0T2ZQbGFudHMgPSBmdW5jdGlvbihmb3JtKXtcbiAgICAgICAgICAgIC8vaWYgKGZvcm0gJiYgZm9ybSA9PSAnTGlzdE9mUGxhbnRzJyl7XG4gICAgICAgICAgICAgICAgLy9yZW1vdmUgZW1wdHkgcm93c1xuICAgICAgICAgICAgICAgIGZvcih2YXIgaSA9ICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudC5sZW5ndGggLSAxOyBpID49IDA7IGktLSl7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBsYW50ID0gJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50W2ldO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICggcGxhbnQuUGxhbnRMb2NhdGlvbiE9bnVsbCAmJiBpc0VtcHR5KHBsYW50LlBsYW50TmFtZSkgICYmIGlzRW1wdHkocGxhbnQuRVBSVFJOYXRpb25hbElkKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNFbXB0eShwbGFudC5QbGFudExvY2F0aW9uLkFkZHJlc3MxKSAmJiBpc0VtcHR5KHBsYW50LlBsYW50TG9jYXRpb24uQWRkcmVzczIpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBpc0VtcHR5KHBsYW50LlBsYW50TG9jYXRpb24uQ2l0eSkgJiYgaXNFbXB0eShwbGFudC5QbGFudExvY2F0aW9uLlJlZ2lvbikgJiYgaXNFbXB0eShwbGFudC5QbGFudExvY2F0aW9uLlBvc3RhbENvZGUpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBpc0VtcHR5KHBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTG9uZ2l0dWRlKSAmJiBpc0VtcHR5KHBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTGF0aXR1ZGUpICYmIGlzRW1wdHkocGxhbnQuRmFjaWxpdHlOYW1lKSlcblxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gZmlsbCBpbiBwbGFudCBJRHNcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIGlzRW1wdHkocGxhbnQuUGxhbnRJZCkgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9ICRzY29wZS5nZXROZXh0UGxhbnRJZCAoKSA7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3UGxhbnQgPSBwbGFudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVzaW5nICRxIHByb21pc2UgQVBJLCB0byBhc2sgdGhlIHNlcnZlciBmaXJzdCBmb3IgaWQgY29sbGlzaW9ucy5cbiAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2UudGhlbiAoIGZ1bmN0aW9uICggcGxhbnRpZCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdQbGFudC5QbGFudElkID0gcGxhbnRpZCA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy99XG4gICAgICAgICAgICAkc2NvcGUuY29uZm9ybVRoZUluc3RhbmNlKCk7XG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgJHJvb3RTY29wZS5idWxrRWRpdExpc3RPZlBsYW50cyA9IGZhbHNlO1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVGaWx0ZXInKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLm9wZW5CdWxrRWRpdExpc3RPZlBsYW50cyA9IGZ1bmN0aW9uKGZvcm0pIHtcbiAgICAgICAgICAgIGlmIChmb3JtICYmIGZvcm0gPT09ICdMaXN0T2ZQbGFudHMnKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmFkZEl0ZW0oJ0xDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50Lmxlbmd0aCA9PT0gMCkge1xuXG4gICAgICAgICAgICAgICAgJG5vdGlmaWNhdGlvbi5pbmZvKFwiRWRpdFwiLCBcIkFkZCBzb21lIHBsYW50cyBmcm9tIExpc3Qgb2YgUGxhbnRzIGZpcnN0LlwiKTtcblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgJHJvb3RTY29wZS5idWxrRWRpdExpc3RPZlBsYW50cyA9IHRydWU7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLndpbmRvd1NlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7XG5cbiAgICAgICAgJHNjb3BlLmdldEhlbHBJbmZvID0gZnVuY3Rpb24oZGl2SWQpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGl2SWQpO1xuICAgICAgICAgICAgdmFyIGluZm9EaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkaXZJZCk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGluZm9EaXYpO1xuICAgICAgICAgICAgcmV0dXJuICRzY2UudHJ1c3RBc0h0bWwoaW5mb0Rpdi5pbm5lckhUTUwpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5jaGFuZ2VJbmZvVG9nZ2xlID0gZnVuY3Rpb24ob3ZlckluZm9Ub2dnbGUpIHtcbiAgICAgICAgICAgICRzY29wZS5zaG93SW5mbyA9IG92ZXJJbmZvVG9nZ2xlO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5waG9uZU51bWJlclBhdHRlcm4gPSAvXlsgMC05XFwoXFwpXFwrXFwtXXs3LDI1fSQvO1xuICAgICAgICAkc2NvcGUucG9zaXRpdmVJbnRlZ2VyUGF0dGVybiA9IC9eXFxkKyQvO1xuICAgICAgICAkc2NvcGUucG9zaXRpdmVEZWNpbWFsTnVtYmVyUGF0dGVybiA9IC9eXFxkKlxcLj9cXGQqJC87XG4gICAgICAgICRzY29wZS5iaW5hcnlOdW1iZXJQYXR0ZXJuPSAvXigwKFxcLlxcZCspP3wxKFxcLjArKT8pJC87XG4gICAgICAgICRzY29wZS5kZWNpbWFsTnVtYmVyUGF0dGVybiA9L15bKy1dPyhcXGQqXFwuP1xcZCopJC87XG4gICAgICAgICRzY29wZS5kYXRlRm9ybWF0ID0gL14oMTl8MjApXFxkXFxkKFstXSkoMFsxLTldfDFbMDEyXSlcXDIoMFsxLTldfFsxMl1bMC05XXwzWzAxXSkkLztcblxuICAgICAgICAkc2NvcGUud2Vic2l0ZUFkZHJlc3NQYXR0ZXJuID0gL14oaHR0cHM/OlxcL1xcLyk/KFtcXGRhLXpcXC4tXSspXFwuKFthLXpcXC5dezIsNn0pKFtcXC9cXHcgXFwuLV0qKSpcXC8/JC87XG4gICAgICAgICRzY29wZS5wZXJjZW50YWdlUGF0dGVybiA9IC9eMTAwJHxeWzAtOV17MSwyfSR8XlswLTldezEsMn1cXCxbMC05XXsxLDN9JC87XG4gICAgICAgICRzY29wZS5sb25naXR1ZGVOdW1iZXJQYXR0ZXJuID0gL15bLStdPygxODAoXFwuMCspP3woKDFbMC03XVxcZCl8KFsxLTldP1xcZCkpKFxcLlxcZCspPykkLztcblxuICAgICAgICAkc2NvcGUubGF0aXR1ZGVOdW1iZXJQYXR0ZXJuID0gL15bLStdPyhbMS04XT9cXGQoXFwuXFxkKyk/fDkwKFxcLjArKT8pJC87XG5cbiAgICAgICAgJHNjb3BlLmlzRml4ZWRRdWVzdGlvbiA9IGZ1bmN0aW9uKGRhdGFQYXRoKSB7XG4gICAgICAgICAgICB2YXIgdG9rZW5zID0gZGF0YVBhdGguc3BsaXQoJy4nKTtcbiAgICAgICAgICAgIHZhciBsYXN0VG9rZW4gPSB0b2tlbnMucG9wKCk7XG4gICAgICAgICAgICAvLy8vY29uc29sZS5sb2cobGFzdFRva2VuKTtcbiAgICAgICAgICAgIC8vLy9jb25zb2xlLmxvZyhsYXN0VG9rZW4gPT0gJ0ZpeGVkUXVlc3Rpb24nKTtcbiAgICAgICAgICAgIHJldHVybiAobGFzdFRva2VuID09ICdGaXhlZFF1ZXN0aW9uJyk7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuY2xlYXJTdWJGb3JtRGF0YSA9IGZ1bmN0aW9uKGRhdGFQYXRocywgaWRlbnRpZmllclBhdGgsIGNoYW5nZVZhbHVlVG8pIHtcblxuICAgICAgICAgICAgdmFyIGVsZW1lbnRDb3VudCA9IDA7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGFQYXRocy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBmb3JtRWxlbWVudEluc3RhbmNlID0gJHNjb3BlLmdldEluc3RhbmNlQnlQYXRoKCdpbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlJywgZGF0YVBhdGhzW2ldKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50Q291bnQgKz0gY291bnROb25FbXB0eVByb3BlcnRpZXMoZm9ybUVsZW1lbnRJbnN0YW5jZSwgJHNjb3BlLmlzRml4ZWRRdWVzdGlvbihkYXRhUGF0aHNbaV0pKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTmVlZCB0byBnZXQgcGFyZW50IHBhdGggb2YgeWVzL25vIHF1ZXN0aW9uIG90aGVyd2lzZSBhc3NpZ25pbmcgbmV3IHZhbHVlXG4gICAgICAgICAgICAvLyB0byBwcm9wZXJ0eSBkb2VzIG5vdCB3b3JrLlxuICAgICAgICAgICAgdmFyIHRva2VucyA9IGlkZW50aWZpZXJQYXRoLnNwbGl0KCcuJyk7XG5cbiAgICAgICAgICAgIC8vIFBhcmVudCBwcm9wZXJ0eSBvZiBhY3R1YWwgeWVzL25vIHF1ZXN0aW9uXG4gICAgICAgICAgICB2YXIgc3ViRm9ybUluc3RhbmNlSWRlbnRpZmllciA9IHRva2Vucy5zaGlmdCgpO1xuXG4gICAgICAgICAgICAvLyBQYXJlbnQgaW5zdGFuY2Ugb2JqZWN0IHRoYXQgY29udGFpbnMgYWN0dWFsIHllcy9ubyBxdWVzdGlvbiBwcm9wZXJ0eVxuICAgICAgICAgICAgdmFyIHBhcmVudEluc3RhbmNlID0gJHNjb3BlLmdldEluc3RhbmNlQnlQYXRoKCdpbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlJywgc3ViRm9ybUluc3RhbmNlSWRlbnRpZmllcik7XG4gICAgICAgICAgICB2YXIgb2JqZWN0TmFtZSA9IHRva2Vucy5zaGlmdCgpO1xuXG4gICAgICAgICAgICB2YXIgbmVlZHNUb0NsZWFyRGF0YSA9IHRydWU7XG5cbiAgICAgICAgICAgIGlmIChuZWVkc1RvQ2xlYXJEYXRhKSB7XG4gICAgICAgICAgICAgICAgLy8gV2hlbiBlbGVtZW50IGNvdW50IGlzIG1vcmUgdGhhbiAwIHRoZW4gd2UgaGF2ZSB0byBhc2sgY29uZmlybWF0aW9uIGZyb20gdXNlciB3aGV0aGVyIHRvIGRlbGV0ZSB0aGUgZGF0YS5cbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudENvdW50ID4gMCAmJiAhY29uZmlybSgnV2hlbiBjaGFuZ2luZyBhbnN3ZXIgYWxsIGRhdGEgdW5kZXIgdGhpcyBzdWItZm9ybSB3aWxsIGJlIGxvc3Q/Jykpe1xuICAgICAgICAgICAgICAgICAgICAvLyB0b2tlLnNoaWZ0KCkgZXh0cmFjdHMgeWVzL25vIHF1ZXN0aW9uIG5hbWUuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFzc2luZyB5ZXMgdmFsdWUgdG8gcXVlc3Rpb25cbiAgICAgICAgICAgICAgICAgICAgcGFyZW50SW5zdGFuY2Vbb2JqZWN0TmFtZV0gPSAgY2hhbmdlVmFsdWVUbztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YVBhdGhzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm9ybUVsZW1lbnRJbnN0YW5jZSA9ICRzY29wZS5nZXRJbnN0YW5jZUJ5UGF0aCgnaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZScsIGRhdGFQYXRoc1tpXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBmaWVsZHMgd2hlcmUgdGhlcmUgaXMgb25seSBvbmUgZmllbGQgYW5kIGl0IGNhbiBiZSBudWxsLiBKdXN0IGlnbm9yZSBpdC5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZm9ybUVsZW1lbnRJbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlmLWVsc2UgaXMgdG8gZGlmZmVyZW50aWF0ZSBqdXN0IGEgc3RyaW5nIGZpZWxkIGZyb20gYXJyYXkgb3Igb2JqZWN0LlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvcm1FbGVtZW50SW5zdGFuY2UgaW5zdGFuY2VvZiBBcnJheSB8fCAhZm9ybUVsZW1lbnRJbnN0YW5jZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhck9iamVjdChmb3JtRWxlbWVudEluc3RhbmNlLCAkc2NvcGUuaXNGaXhlZFF1ZXN0aW9uKGRhdGFQYXRoc1tpXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9rZW5zID0gZGF0YVBhdGhzW2ldLnNwbGl0KCcuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iamVjdElkZW50aWZpZXIgPSB0b2tlbnMuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50T2JqZWN0ID0gJHNjb3BlLmdldEluc3RhbmNlQnlQYXRoKCdpbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlJywgb2JqZWN0SWRlbnRpZmllcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50T2JqZWN0W3Rva2Vucy5zaGlmdCgpXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIERvIG5vdGhpbmcuXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgJHJvb3RTY29wZS5UeXBlT2ZDb21idXN0aW9uUGxhbnRGdXJ0aGVyRGV0YWlscyA9IGZhbHNlO1xuXG4gICAgICAgICRzY29wZS5pc1R5cGVPZkNvbWJ1c3Rpb25QbGFudE90aGVyID0gZnVuY3Rpb24gKHBsYW50KSB7XG4gICAgICAgICAgICBpZiAocGxhbnQuUGxhbnREZXRhaWxzLlR5cGVPZkNvbWJ1c3Rpb25QbGFudCA9PT0gJ090aGVycycpIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLlR5cGVPZkNvbWJ1c3Rpb25QbGFudEZ1cnRoZXJEZXRhaWxzID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5UeXBlT2ZDb21idXN0aW9uUGxhbnRGdXJ0aGVyRGV0YWlscyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAvKiogICRzY29wZS5PdGhlclNvbGlkRnVlbHNTZXQ9e090aGVyU29saWRGdWVsczogW119O1xuICAgICAkc2NvcGUuT3RoZXJTb2xpZEZ1ZWxzU2V0Lk90aGVyU29saWRGdWVscz1be090aGVyU29saWRGdWVsOiB7XCJDYXRlZ29yeVwiOiBudWxsLCBcIlZhbHVlXCI6IG51bGx9fV07XG5cbiAgXG5cbiAgICAgICAgJHNjb3BlLmFkZE90aGVyU29saWRGdWVsID0gZnVuY3Rpb24oJGluZGV4KXtcbiAgICAkc2NvcGUuT3RoZXJTb2xpZEZ1ZWxzU2V0Lk90aGVyU29saWRGdWVscy5wdXNoKHtPdGhlclNvbGlkRnVlbDoge1wiQ2F0ZWdvcnlcIjogbnVsbCwgXCJWYWx1ZVwiOiBudWxsfX0pO1xuICAgICAgICB9XG5cbioqL1xuICAgICAgXG5cbiAgICAgICAgLy9UT0RPIGZvcm1hdCBlcnJvciBtZXNzYWdlIHRvIGhhbmRsZSBkaWZmZXJlbnQgbGltaXRzIGJldHRlclxuICAgICAgICAkc2NvcGUuZXJyb3JNZXNzYWdlcyA9IHtcbiAgICAgICAgICAgIFwicmVxdWlyZWRfZmllbGRcIiA6IFwiVGhpcyBpcyBhIHJlcXVpcmVkIGZpZWxkXCIsXG4gICAgICAgICAgICBcInVuaXF1ZV9hYmJyZXZpYXRpb25cIiA6IFwiUGxlYXNlIHByb3ZpZGUgYSB1bmlxdWUgYWJicmV2aWF0aW9uIFwiLFxuICAgICAgICAgICAgXCJ2YWxpZF90ZWxlcGhvbmVcIiA6IFwiUGxlYXNlIGVudGVyIGEgdmFsaWQgdGVsZXBob25lIG51bWJlciAoYXQgbGVhc3QgNyBkaWdpdHMpIFwiLFxuICAgICAgICAgICAgXCJ2YWxpZF9lbWFpbFwiIDogXCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzIFwiLFxuICAgICAgICAgICAgXCJ2YWxpZF91cmxcIiA6IFwiUGxlYXNlIGVudGVyIGEgdmFsaWQgVVJMIFwiLFxuICAgICAgICAgICAgXCJ5ZXNfb3Jfbm9cIiA6IFwiUGxlYXNlIGNob29zZSB5ZXMgb3Igbm8gXCIsXG4gICAgICAgICAgICBcIm51bWJlcl9ncmVhdGVyX3RoYW5femVyb1wiIDogXCJQbGVhc2UgcHJvdmlkZSBhIG51bWJlciBncmVhdGVyIHRoYW4gMCBcIixcbiAgICAgICAgICAgIFwiZGF0YV9lbnRyeV9tdXN0X2JlX3VuaXF1ZVwiIDogXCJEYXRhIGVudHJ5IG11c3QgYmUgdW5pcXVlIElEIGNvZGUgXCIsXG4gICAgICAgICAgICBcIm11c3RfYmVfbGVzc190aGFuXCIgOiBcIlBsZWFzZSBwcm92aWRlIGEgbnVtYmVyIGxlc3MgdGhhbiBcIixcbiAgICAgICAgICAgIFwibXVzdF9iZV9ncmVhdGVyX3RoYW5cIiA6IFwiUGxlYXNlIHByb3ZpZGUgYSBudW1iZXIgZ3JlYXRlciBvciBlcXVhbCB0byBcIixcbiAgICAgICAgICAgIFwibXVzdF9iZV9wZXJjZW50YWdlXCIgOiBcIlBsZWFzZSBwcm92aWRlIGEgcGVyY2VudGFnZSBiZXR3ZWVuIDAgYW5kIDEwMCBcIixcbiAgICAgICAgICAgIFwid2hvbGVfbnVtYmVyX2dyZWF0ZXJfdGhhbl96ZXJvXCIgOiBcIlBsZWFzZSBwcm92aWRlIGEgd2hvbGUgbnVtYmVyIGdyZWF0ZXIgdGhhbiAwIFwiLFxuICAgICAgICAgICAgXCJ1bmlxdWVfaWRlbnRpZmljYXRpb25fY29kZVwiIDogXCJQbGVhc2UgZW50ZXIgYSB1bmlxdWUgaWRlbnRpZmljYXRpb24gY29kZSBcIixcbiAgICAgICAgICAgIFwidmFsaWRfbG9uZ2l0dWRlXCIgOiBcIlBsZWFzZSBwcm92aWRlIGEgbnVtYmVyIGJldHdlZW4gLTE4MCBhbmQgMTgwXCIsXG4gICAgICAgICAgICBcInZhbGlkX2xhdGl0dWRlXCIgOiBcIlBsZWFzZSBwcm92aWRlIGEgbnVtYmVyIGJldHdlZW4gLTkwIGFuZCA5MFwiLFxuICAgICAgICAgICAgXCJwb3NpdGl2ZV9kZWNpbWFsXCIgOiBcIlBsZWFzZSBwcm92aWRlIGEgcG9zaXRpdmUgZGVjaW1hbCBudW1iZXIgIFwiLFxuICAgICAgICAgICAgXCJwb3NpdGl2ZV9kZWNpbWFsMDFcIiA6IFwiUGxlYXNlIHByb3ZpZGUgYSBwb3NpdGl2ZSBkZWNpbWFsIG51bWJlciBiZXR3ZWVuIDAgYW5kIDFcIixcbiAgICAgICAgICAgIFwicG9zaXRpdmVfaW50ZWdlclwiIDogXCJQbGVhc2UgcHJvdmlkZSBhIHBvc2l0aXZlIGludGVnZXIgXCIsXG4gICAgICAgICAgICBcImFydGljbGVfZm9ybWF0XCIgOiBcIlBsZWFzZSB1c2UgdGhlIGVkaXQgbWVudSB0byBjb3JyZWN0IHRoZSBhcnRpY2xlIGZvcm1hdFwiXG5cbiAgICAgICAgfTtcblxuXG4gICAgICAgICRzY29wZS5nZXRFcnJvck1lc3NhZ2UgPSBmdW5jdGlvbihlcnJvckNvZGUpIHtcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUuZXJyb3JNZXNzYWdlc1tlcnJvckNvZGVdO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5zaG93RXJyb3IgPSBmdW5jdGlvbihtb2RlbENvbnRyb2xsZXIsIGVycm9yQ29kZSkge1xuICAgICAgICAgICAgcmV0dXJuIG1vZGVsQ29udHJvbGxlci4kZXJyb3JbZXJyb3JDb2RlXSAmJiBtb2RlbENvbnRyb2xsZXIuJGludmFsaWRcbiAgICAgICAgICAgICAgICAgICAgJiYgIShlcnJvckNvZGUgPT09ICdyZXF1aXJlZCcgJiYgbW9kZWxDb250cm9sbGVyLiRlcnJvclsncGF0dGVybiddICYmIG1vZGVsQ29udHJvbGxlci4kZXJyb3JbJ3BhdHRlcm4nXSA9PXRydWUpOy8vICYmIG1vZGVsQ29udHJvbGxlci4kZGlydHk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5zaG93RXJyb3JJZlN1Ym1pdHRlZCA9IGZ1bmN0aW9uKG1vZGVsQ29udHJvbGxlciwgZXJyb3JDb2RlLCBzdWJtaXR0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBzdWJtaXR0ZWQgJiYgJHNjb3BlLnNob3dFcnJvcihtb2RlbENvbnRyb2xsZXIsIGVycm9yQ29kZSk7XG4gICAgICAgIH07XG5cblxuICAgICAgICAkc2NvcGUuaXNHcmVhdGVyVGhhblplcm8gPSBmdW5jdGlvbihpbnB1dFZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLnN1Ym1pdHRlZCA9PSBmYWxzZSAmJiAoIE51bWJlcihpbnB1dFZhbHVlKSA+IDApO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5pc1Bvc2l0aXZlTnVtYmVyID0gZnVuY3Rpb24oaW5wdXRWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIGJvb2xlYW4gPSB0cnVlIDtcblxuICAgICAgICAgICAgaWYgKCBpc0VtcHR5IChpbnB1dFZhbHVlKSApIHJldHVybiBmYWxzZTtcblxuICAgICAgICAgICAgaWYoIWlzRW1wdHkoaW5wdXRWYWx1ZSkgICl7XG4gICAgICAgICAgICAgICAgYm9vbGVhbiA9ICRzY29wZS5wb3NpdGl2ZUludGVnZXJQYXR0ZXJuLnRlc3QoaW5wdXRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYm9vbGVhbjtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuaXNQb3NpdGl2ZURlY2ltYWwgPSBmdW5jdGlvbihpbnB1dFZhbHVlKSB7XG5cbiAgICAgICAgICAgIC8vIHJldHVybnMgZmFsc2UgaWYgZW1wdHksIG9yIGlmIG5vdCBkZWNpbWFsKGJ5IHJlZ2V4IGNvbXBhcmlzb24pXG4gICAgICAgICAgICBpZiAoIGlzRW1wdHkgKGlucHV0VmFsdWUpICkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLnBvc2l0aXZlRGVjaW1hbE51bWJlclBhdHRlcm4udGVzdChpbnB1dFZhbHVlKTtcblxuICAgICAgICB9O1xuICAgICAgICBcblxuICAgICAgICAkc2NvcGUudmFsaWREYXRlRm9ybWF0ID0gZnVuY3Rpb24oIGlucHV0RGF0ZSl7XG4gICAgICAgICAgICAvLyBhbGxvd3MgZW1wdHkgdmFsdWVzIGZvciBzaW1wbGljaXR5IHNha2VcbiAgICAgICAgICAgIGlmICggaXNFbXB0eShpbnB1dERhdGUpKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUuZGF0ZUZvcm1hdC50ZXN0KCBpbnB1dERhdGUgKTtcblxuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLmlzRGVncmVlID0gZnVuY3Rpb24oaW5wdXRWYWx1ZSwgZGVncmVlcywgc3VibWl0dGVkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiAoJHNjb3BlLnN1Ym1pdHRlZCA9PSB0cnVlICYmICFpc0VtcHR5KGlucHV0VmFsdWUpICYmICEoTnVtYmVyKGRlZ3JlZXMpID49IE51bWJlcihpbnB1dFZhbHVlKSAmJiBOdW1iZXIoaW5wdXRWYWx1ZSkgPj0gLU51bWJlcihkZWdyZWVzKSkpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5pc1JlcXVpcmVkID0gZnVuY3Rpb24oaW5wdXRWYWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuICAkc2NvcGUuc3VibWl0dGVkID09IHRydWUgJiYgaXNFbXB0eShpbnB1dFZhbHVlKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuaXNNb2RhbFJlcXVpcmVkID0gZnVuY3Rpb24oaW5wdXRWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIGJvb2xlYW4gPSBmYWxzZTtcblxuICAgICAgICAgICAgaWYoaXNFbXB0eShpbnB1dFZhbHVlKSl7XG4gICAgICAgICAgICAgICAgYm9vbGVhbj0gIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihpbnB1dFZhbHVlID09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgYm9vbGVhbj0gIHRydWU7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgaWYoaW5wdXRWYWx1ZS5sZW5ndGggPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgIGJvb2xlYW49ICB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAvKiBpZihpbnB1dFZhbHVlID09IG51bGwpe1xuICAgICAgICAgICAgICAgIGJvb2xlYW49ICB0cnVlO1xuICAgICAgICAgICAgfSovXG4gICAgICAgICAgICByZXR1cm4gICBib29sZWFuO1xuXG5cbiAgICAgICAgfTtcblxuXG4gICAgICAgICRzY29wZS5jaGVja2JveENsZWFySW5wdXRzID0gZnVuY3Rpb24ocGxhbnQsIGNoZWNrYm94UGF0aCwgZGVwZW5kaW5nSW5wdXRzKSB7XG4gICAgICAgICAgICB2YXIgdG9rZW5zMSA9IGNoZWNrYm94UGF0aC5zcGxpdCgnLicpO1xuICAgICAgICAgICAgdmFyIG9iamVjdElkZW50aWZpZXIxID0gdG9rZW5zMS5zaGlmdCgpO1xuICAgICAgICAgICAgdmFyIGNoZWNrYm94T2JqZWN0ID0gJHNjb3BlLmdldFBsYW50QnlQYXRoKHBsYW50LCBvYmplY3RJZGVudGlmaWVyMSk7XG4gICAgICAgICAgICB2YXIgcHJvcGVydHkxID0gdG9rZW5zMVt0b2tlbnMxLmxlbmd0aC0xXTtcbiAgICAgICAgICAgIHZhciBjaGVja2JveFZhbHVlID0gY2hlY2tib3hPYmplY3RbcHJvcGVydHkxXTtcblxuICAgICAgICAgICAgaWYoY2hlY2tib3hWYWx1ZSA9PSBmYWxzZSl7XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0UGF0aEFycmF5ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGlzTm90RW1wdHk9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IGRlcGVuZGluZ0lucHV0cy5zcGxpdCgnOicpO1xuXG4gICAgICAgICAgICAgICAgLy9BZGRpbmcgY2hlY2tib3ggZGVwZW5kaW5nIGlucHV0cyB0byBhcnJheVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGF0aHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRva2VuczIgPSBwYXRoc1tpXS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0SWRlbnRpZmllcjIgPSB0b2tlbnMyLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnRPYmplY3QgPSAkc2NvcGUuZ2V0UGxhbnRCeVBhdGgocGxhbnQsIG9iamVjdElkZW50aWZpZXIyKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BlcnR5ID0gdG9rZW5zMlt0b2tlbnMyLmxlbmd0aC0xXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9iamVjdCA9IHBhcmVudE9iamVjdFtwcm9wZXJ0eV07XG4gICAgICAgICAgICAgICAgICAgIGlmKCRzY29wZS5wb3NpdGl2ZURlY2ltYWxOdW1iZXJQYXR0ZXJuLnRlc3Qob2JqZWN0KSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QgPSBvYmplY3QudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL0Vycm9yIGhhbmRsaW5nOiAgU3RyaW5nIGluIG51bWVyaWMgZmllbGRcbiAgICAgICAgICAgICAgICAgICAgaWYob2JqZWN0ID09IG51bGwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzTm90RW1wdHkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZihvYmplY3QgPT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc05vdEVtcHR5ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpbnB1dFBhdGhBcnJheS5wdXNoKG9iamVjdClcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL0lzIGlucHV0cyBlbXB0eVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaW5wdXRQYXRoQXJyYXkubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYoaW5wdXRQYXRoQXJyYXlbal0ubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc05vdEVtcHR5ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgaWYoY2hlY2tib3hWYWx1ZSA9PSBmYWxzZSAmJiBpc05vdEVtcHR5KXtcbiAgICAgICAgICAgICAgICAgICAgaWYoY29uZmlybShcIkRvIHlvdSB3aXNoIHRvIGNsZWFyIGRhdGEgZnJvbSBkZXBlbmRpbmcgaW5wdXQocyk/XCIpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcGF0aHMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9rZW5zMyA9IHBhdGhzW2tdLnNwbGl0KCcuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iamVjdElkZW50aWZpZXIzID0gdG9rZW5zMy5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnRPYmplY3QyID0gJHNjb3BlLmdldFBsYW50QnlQYXRoKHBsYW50LCBvYmplY3RJZGVudGlmaWVyMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BlcnR5MiA9IHRva2VuczNbdG9rZW5zMy5sZW5ndGgtMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50T2JqZWN0Mltwcm9wZXJ0eTJdID0gXCJcIjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgLy9jaGVja2JveCByb2xsYmFja1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tib3hPYmplY3RbcHJvcGVydHkxXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0UGF0aEFycmF5ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGlzTm90RW1wdHk9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IGRlcGVuZGluZ0lucHV0cy5zcGxpdCgnOicpO1xuXG4gICAgICAgICAgICAgICAgLy9BZGRpbmcgY2hlY2tib3ggZGVwZW5kaW5nIGlucHV0cyB0byBhcnJheVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGF0aHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRva2VuczIgPSBwYXRoc1tpXS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0SWRlbnRpZmllcjIgPSB0b2tlbnMyLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnRPYmplY3QgPSAkc2NvcGUuZ2V0UGxhbnRCeVBhdGgocGxhbnQsIG9iamVjdElkZW50aWZpZXIyKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BlcnR5ID0gdG9rZW5zMlt0b2tlbnMyLmxlbmd0aC0xXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9iamVjdCA9IHBhcmVudE9iamVjdFtwcm9wZXJ0eV07XG4gICAgICAgICAgICAgICAgICAgIGlmKCRzY29wZS5wb3NpdGl2ZURlY2ltYWxOdW1iZXJQYXR0ZXJuLnRlc3Qob2JqZWN0KSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QgPSBvYmplY3QudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL0Vycm9yIGhhbmRsaW5nOiAgU3RyaW5nIGluIG51bWVyaWMgZmllbGRcbiAgICAgICAgICAgICAgICAgICAgaWYob2JqZWN0ID09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNOb3RFbXB0eSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaW5wdXRQYXRoQXJyYXkucHVzaChvYmplY3QpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9JcyBpbnB1dHMgZW1wdHlcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGlucHV0UGF0aEFycmF5Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKGlucHV0UGF0aEFycmF5W2pdLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNOb3RFbXB0eSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodG9rZW5zMSA9PSAnUmVmaW5lcmllcycgJiYgY2hlY2tib3hWYWx1ZSA9PSB0cnVlICYmIGlzTm90RW1wdHkpe1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKGNvbmZpcm0oXCJEbyB5b3Ugd2lzaCB0byBjbGVhciBkYXRhIGZyb20gZGVwZW5kaW5nIGlucHV0KHMpP1wiKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBhdGhzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRva2VuczMgPSBwYXRoc1trXS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmplY3RJZGVudGlmaWVyMyA9IHRva2VuczMuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50T2JqZWN0MiA9ICRzY29wZS5nZXRQbGFudEJ5UGF0aChwbGFudCwgb2JqZWN0SWRlbnRpZmllcjMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9wZXJ0eTIgPSB0b2tlbnMzW3Rva2VuczMubGVuZ3RoLTFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudE9iamVjdDJbcHJvcGVydHkyXSA9IFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NoZWNrYm94IHJvbGxiYWNrXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja2JveE9iamVjdFtwcm9wZXJ0eTFdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9ICAgIDtcblxuICAgICAgICAkc2NvcGUuaXNEZXN1bHBodXJpemF0aW9uUmF0ZUVtcHR5ID0gZnVuY3Rpb24gKGRlc3VscGh1cmlzYXRpb24pIHtcbiAgICAgICAgICAgIGlmIChkZXN1bHBodXJpc2F0aW9uID09IG51bGwgfHwgZGVzdWxwaHVyaXNhdGlvbi5Nb250aHM9PW51bGwgfHwgZGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGg9PW51bGwgIHx8IGRlc3VscGh1cmlzYXRpb24uTW9udGhzLk1vbnRoLmxlbmd0aD09MSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoZGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGguaXNBcnJheSl7XG4gICAgICAgICAgICBkZXN1bHBodXJpc2F0aW9uLk1vbnRocy5Nb250aC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuRGVzdWxwaHVyaXNhdGlvblJhdGUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5pc1N1bHBodXJDb250ZW50RW1wdHkgPSBmdW5jdGlvbiAoZGVzdWxwaHVyaXNhdGlvbikge1xuICAgICAgICAgICAgaWYgKGRlc3VscGh1cmlzYXRpb24gPT0gbnVsbCB8fCBkZXN1bHBodXJpc2F0aW9uLk1vbnRocz09bnVsbCB8fCBkZXN1bHBodXJpc2F0aW9uLk1vbnRocy5Nb250aD09bnVsbCAgfHwgZGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGgubGVuZ3RoPT0xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKGRlc3VscGh1cmlzYXRpb24uTW9udGhzLk1vbnRoLmlzQXJyYXkpeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGRlc3VscGh1cmlzYXRpb24uTW9udGhzLk1vbnRoLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5TdWxwaHVyQ29udGVudCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmlzVGVjaG5pY2FsSnVzdGlmaWNhdGlvbkVtcHR5ID0gZnVuY3Rpb24gKGRlc3VscGh1cmlzYXRpb24pIHtcbiAgICAgICAgICAgIGlmIChkZXN1bHBodXJpc2F0aW9uID09IG51bGwgfHwgZGVzdWxwaHVyaXNhdGlvbi5Nb250aHM9PW51bGwgfHwgZGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGg9PW51bGwgIHx8IGRlc3VscGh1cmlzYXRpb24uTW9udGhzLk1vbnRoLmxlbmd0aD09MSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoZGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGguaXNBcnJheSl7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBkZXN1bHBodXJpc2F0aW9uLk1vbnRocy5Nb250aC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5UZWNobmljYWxKdXN0aWZpY2F0aW9uID09IG51bGwgfHwgZWxlbWVudC5UZWNobmljYWxKdXN0aWZpY2F0aW9uID09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgfSk7XG4gICAgZnVuY3Rpb24gaXNFbXB0eSh2YWx1ZSl7XG4gICAgICAgIC8vIHJldHVybnMgdHJ1ZSBvbiB1bmRlZmluZWQsIGVtcHR5IGFycmF5LCBlbXB0eSBzdHJpbmdcbiAgICAgICAgaWYodmFsdWUgPT09IDApe1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICByZXR1cm4gKCF2YWx1ZSB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlLmxlbmd0aCA9PT0gMCB8fCB2YWx1ZSA9PT0gXCJcIiApO1xuICAgICAgICB9XG4gICAgfVxuXG5cblxuICAgIC8vIGdldCBpbnN0YW5jZSBkYXRhIGFuZCBzYXZlIGluc3RhbmNlIGRhdGFcbiAgICBhcHAuZmFjdG9yeSgnZGF0YVJlcG9zaXRvcnknLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkaHR0cCkge1xuICAgICAgICB2YXIgY29kZUxpc3RzID0ge307XG4gICAgICAgIC8vdmFyIGxjcFZvY2FidWxhcnlTZXRCYXNlVXJpID0gJ2h0dHA6Ly90ZXN0LnRyaXBsZWRldi5lZS9kYXRhZGljdC92b2NhYnVsYXJ5L2xjcC8nO1xuICAgICAgICAvL3ZhciBsY3BWb2NhYnVsYXJ5U2V0QmFzZVVyaSA9IEREX1ZPQ0FCVUxBUllfQkFTRV9VUkkgKyAnaGFiaWRlcy8nO1xuICAgICBcbiAgICAgXG4gICAgICAgIHZhciBFUFJUUmFuZGxMQ1BWb2NhYnVsYXJ5U2V0QmFzZVVyaSA9IEREX1ZPQ0FCVUxBUllfQkFTRV9VUkkgKyAnRVBSVFJhbmRMQ1AvJztcbiAgICAgICAgdmFyIEVQUlRSYW5kTENQdm9jYWJ1bGFyaWVzID1bJ0NvbWJ1c3Rpb25QbGFudENhdGVnb3J5VmFsdWUnLCAnQ291bnRyeUNvZGVWYWx1ZScsICdFUFJUUlBvbGx1dGFudENvZGVWYWx1ZScsICdGdWVsSW5wdXRWYWx1ZScsXG4gICAgICAgICAnTENQUG9sbHV0YW50Q29kZVZhbHVlJywgJ01lZGl1bUNvZGVWYWx1ZScsICdNZXRob2RDbGFzc2lmaWNhdGlvblZhbHVlJywgJ01ldGhvZENvZGVWYWx1ZScsICdNb250aFZhbHVlJywgXG4gICAgICAgICAnT3RoZXJHYXNlb3VzRnVlbFZhbHVlJywgJ090aGVyU29saWRGdWVsVmFsdWUnLCAnUmVhc29uVmFsdWUnLCAnVW5pdENvZGVWYWx1ZScsICdXYXN0ZUNsYXNzaWZpY2F0aW9uVmFsdWUnLFxuICAgICAgICAgICdXYXN0ZVRyZWF0bWVudFZhbHVlJ107XG4gICAgICAgIHZhciBFUFJUUmFuZExDUHZvY2FidWxhcnlJZGVudGlmaWVyc0luQ29kZSA9IFsnQ29tYnVzdGlvblBsYW50Q2F0ZWdvcnlWYWx1ZScsICdDb3VudHJ5Q29kZVZhbHVlJywgJ0VQUlRSUG9sbHV0YW50Q29kZVZhbHVlJywgJ0Z1ZWxJbnB1dFZhbHVlJyxcbiAgICAgICAgICdMQ1BQb2xsdXRhbnRDb2RlVmFsdWUnLCAnTWVkaXVtQ29kZVZhbHVlJywgJ01ldGhvZENsYXNzaWZpY2F0aW9uVmFsdWUnLCAnTWV0aG9kQ29kZVZhbHVlJywgJ01vbnRoVmFsdWUnLCBcbiAgICAgICAgICdPdGhlckdhc2VvdXNGdWVsVmFsdWUnLCAnT3RoZXJTb2xpZEZ1ZWxWYWx1ZScsICdSZWFzb25WYWx1ZScsICdVbml0Q29kZVZhbHVlJywgJ1dhc3RlQ2xhc3NpZmljYXRpb25WYWx1ZScsXG4gICAgICAgICAgJ1dhc3RlVHJlYXRtZW50VmFsdWUnXTtcbiAgICAgICAgXG4gICAgICBcbiAgdmFyIGxjcFZvY2FidWxhcnlTZXRCYXNlVXJpID0gRERfVk9DQUJVTEFSWV9CQVNFX1VSSSArICdsY3AvJztcbiAgICAgICAgdmFyIGxjcFZvY2FidWxhcmllcyA9IFsnbGNwY291bnRyaWVzJywncGxhbnRzdGF0dXMnLCdzZWN0b3JzJ107XG4gICAgICAgIHZhciBsY3BWb2NhYnVsYXJ5SWRlbnRpZmllcnNJbkNvZGUgPSBbJ2NvdW50cmllcycsICdzdGF0dXMnLCAnc2VjdG9ycyddO1xuXG4gICAgICAgIHZhciBjb21tb25Wb2NhYnVsYXJ5U2V0QmFzZVVyaSA9IEREX1ZPQ0FCVUxBUllfQkFTRV9VUkkgKyAnY29tbW9uLyc7XG5cbiAgICAgICAgLy9kZWZpbmUgdW5kZWZpbmVkIG1lbWJlcnMsIGkgZG9udCBrbm93IGlmIHRoaXMgaXMgcmVhbGx5IG5lY2Vzc2FyeSEhIVxuICAgICAgICBjb2RlTGlzdHMuTENQQ29kZWxpc3RzID0ge307XG4gICAgICAgIGNvZGVMaXN0cy5PbGRMQ1BDb2RlbGlzdHM9e307XG4gICAgICAgIGNvZGVMaXN0cy5Db21idXN0aW9uUGxhbnRDb2RlTGlzdHM9e307XG4gICAgICAgIGNvZGVMaXN0cy5EZXJvZ2F0aW9uVmFsdWVDb2RlTGlzdHM9e307XG4gICAgICAgIGNvZGVMaXN0cy5PdGhlclNvbGlkRnVlbENvZGVMaXN0cz17fTtcbiAgICAgICAgY29kZUxpc3RzLk90aGVyR2FzZXNvdXNGdWVsQ29kZUxpc3RzPXt9O1xuICAgICAgICBjb2RlTGlzdHMuTW9udGhWYWx1ZUNvZGVMaXN0cz17fTtcbiAgICAgICAgY29kZUxpc3RzLk1vbnRobHlEZXN1bHBodXJpc2F0aW9uPXt9O1xuXG4gICAgICAgIHZhciByZWdpb25Db2RlTGlzdHMgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBFUFJUUmFuZExDUHZvY2FidWxhcmllcy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICBjb2RlTGlzdHMuTENQQ29kZWxpc3RzW0VQUlRSYW5kTENQdm9jYWJ1bGFyeUlkZW50aWZpZXJzSW5Db2RlW2ldXSA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGNwVm9jYWJ1bGFyaWVzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGNvZGVMaXN0cy5PbGRMQ1BDb2RlbGlzdHNbbGNwVm9jYWJ1bGFyeUlkZW50aWZpZXJzSW5Db2RlW2ldXSA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRJbnN0YW5jZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGVJZCl7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IGdldFdlYlFVcmwoXCIvZG93bmxvYWQvY29udmVydGVkX3VzZXJfZmlsZVwiKTtcbiAgICAgICAgICAgICAgICB9XG5cdFx0XHRcdGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB1cmwgPSBcImxjcC1pbnN0YW5jZS10ZXN0Lmpzb25cIjtcblx0XHRcdFx0fVxuICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQodXJsLCB7dHJhY2tlciA6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzYXZlSW5zdGFuY2U6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IGdldFdlYlFVcmwoXCIvc2F2ZVhtbFwiKTtcbiAgICAgICAgICAgICAgICBmaXhVbmRlZmluZWQoZGF0YSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QodXJsLCBkYXRhLCB7dHJhY2tlciA6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRDb2RlTGlzdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvZGVMaXN0cztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsb2FkQ29kZUxpc3Q6IGZ1bmN0aW9uKGxhbmd1YWdlKSB7XG4gICAgICAgICAgICAgICAgLy9maW5kcyBmaWxlIGluIHByb2plY3QgZm9sZGVyXG4gICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRsYW5ndWFnZSA9ICdlbic7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRMYW5ndWFnZSA9ICFsYW5ndWFnZT8gZGVmYXVsdGxhbmd1YWdlIDogbGFuZ3VhZ2U7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEVQUlRSYW5kTENQdm9jYWJ1bGFyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBFUFJUUmFuZGxMQ1BWb2NhYnVsYXJ5U2V0QmFzZVVyaSArIEVQUlRSYW5kTENQdm9jYWJ1bGFyaWVzW2ldICsgJy9qc29uP2xhbmc9JyArIGN1cnJlbnRMYW5ndWFnZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5pc0lFOSB8fCB3aW5kb3cuaXNJRTkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gYmFzZVVyaSArICcvcmVzdFByb3h5P3VyaT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsLCB7dHJhY2tlcjogJHJvb3RTY29wZS5sb2FkaW5nVHJhY2tlcn0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJGYWlsZWQgdG8gcmVhZCBjb2RlIGxpc3RzLiBEYXRhID0gXCIgKyAgZGF0YSArIFwiLCBzdGF0dXMgPSBcIiArIHN0YXR1cyk7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcygoZnVuY3Rpb24oaSl7cmV0dXJuIGZ1bmN0aW9uIChuZXdDb2RlTGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5jb3B5KG5ld0NvZGVMaXN0LCBjb2RlTGlzdHMuTENQQ29kZWxpc3RzW0VQUlRSYW5kTENQdm9jYWJ1bGFyeUlkZW50aWZpZXJzSW5Db2RlW2ldXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLy8vY29uc29sZS5sb2coXCJyZWNlaXZlZCBcIiArIHZvY2FidWxhcnlJZGVudGlmaWVyc0luQ29kZVtpXSk7XG4gICAgICAgICAgICAgICAgICAgIH19KShpKSk7XG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIH0sIFxuICAgICAgICAgICAgbG9hZE9sZExDUENvZGVMaXN0OiBmdW5jdGlvbihsYW5ndWFnZSkge1xuICAgICAgICAgICAgICAgIC8vZmluZHMgZmlsZSBpbiBwcm9qZWN0IGZvbGRlclxuICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0bGFuZ3VhZ2UgPSAnZW4nO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TGFuZ3VhZ2UgPSAhbGFuZ3VhZ2U/IGRlZmF1bHRsYW5ndWFnZSA6IGxhbmd1YWdlO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsY3BWb2NhYnVsYXJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IGxjcFZvY2FidWxhcnlTZXRCYXNlVXJpICsgbGNwVm9jYWJ1bGFyaWVzW2ldICsgJy9qc29uP2xhbmc9JyArIGN1cnJlbnRMYW5ndWFnZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5pc0lFOSB8fCB3aW5kb3cuaXNJRTkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gYmFzZVVyaSArICcvcmVzdFByb3h5P3VyaT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsLCB7dHJhY2tlcjogJHJvb3RTY29wZS5sb2FkaW5nVHJhY2tlcn0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJGYWlsZWQgdG8gcmVhZCBjb2RlIGxpc3RzLiBEYXRhID0gXCIgKyAgZGF0YSArIFwiLCBzdGF0dXMgPSBcIiArIHN0YXR1cyk7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcygoZnVuY3Rpb24oaSl7cmV0dXJuIGZ1bmN0aW9uIChuZXdDb2RlTGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5ld0NvZGVMaXN0IFwiK25ld0NvZGVMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuY29weShuZXdDb2RlTGlzdCwgY29kZUxpc3RzLk9sZExDUENvZGVsaXN0c1tsY3BWb2NhYnVsYXJ5SWRlbnRpZmllcnNJbkNvZGVbaV1dKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vLy9jb25zb2xlLmxvZyhcInJlY2VpdmVkIFwiICsgdm9jYWJ1bGFyeUlkZW50aWZpZXJzSW5Db2RlW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfX0pKGkpKTtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgfSwgXG4gICAgICAgICAgICAgbG9hZENvbWJ1c3Rpb25QbGFudENvZGVMaXN0OiBmdW5jdGlvbihsYW5ndWFnZSl7XG4gICAgICAgICAgICAgICAgLy8gd2UgZG8gbm90IG5lZWQgdGhlIGZvciBlYWNoIG9mIHRoZSBhYm92ZSBsb2FkQ29kZUxpc3QgbWV0aG9kLCBzaW5jZSBpbiB0aGUgYWJvdmUgLCBpdCBoYXMgdG8gbWFrZSBzZXBlcmF0ZSBjYWxsc1xuICAgICAgICAgICAgICAgIC8vIGZvciBlYWNoIHZvY2FidWxhcnksIHdoZXJlYXMgd2UgZG8gbm90IGhhdmUgdG8uXG4gICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRsYW5ndWFnZSA9ICdlbic7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRMYW5ndWFnZSA9ICFsYW5ndWFnZT8gZGVmYXVsdGxhbmd1YWdlIDogbGFuZ3VhZ2U7XG4gICAgICAgICAgICAgICAgdmFyIHVybCA9ICdodHRwOi8vZGQuZWlvbmV0LmV1cm9wYS5ldS92b2NhYnVsYXJ5L0VQUlRSYW5kTENQL0NvbWJ1c3Rpb25QbGFudENhdGVnb3J5VmFsdWUvanNvbic7XG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCwge3RyYWNrZXI6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyl7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiRmFpbGVkIHRvIHJlYWQgY29kZSBsaXN0cy4gRGF0YSA9IFwiICsgIGRhdGEgKyBcIiwgc3RhdHVzID0gXCIgKyBzdGF0dXMpO30pXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoIGZ1bmN0aW9uIChuZXdDb2RlTGlzdCkge1xuICAgICAgICAgICAgYW5ndWxhci5jb3B5KG5ld0NvZGVMaXN0LCBjb2RlTGlzdHMuQ29tYnVzdGlvblBsYW50Q29kZUxpc3RzKTtcbiAgICAgICAgICAgIC8vLy9jb25zb2xlLmxvZyhcInJlY2VpdmVkIFwiICsgdm9jYWJ1bGFyeUlkZW50aWZpZXJzSW5Db2RlW2ldKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxvYWREZXJvZ2F0aW9uVmFsdWVDb2RlTGlzdDogZnVuY3Rpb24obGFuZ3VhZ2Upe1xuICAgICAgICAgICAgICAgIC8vIHdlIGRvIG5vdCBuZWVkIHRoZSBmb3IgZWFjaCBvZiB0aGUgYWJvdmUgbG9hZENvZGVMaXN0IG1ldGhvZCwgc2luY2UgaW4gdGhlIGFib3ZlICwgaXQgaGFzIHRvIG1ha2Ugc2VwZXJhdGUgY2FsbHNcbiAgICAgICAgICAgICAgICAvLyBmb3IgZWFjaCB2b2NhYnVsYXJ5LCB3aGVyZWFzIHdlIGRvIG5vdCBoYXZlIHRvLlxuICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0bGFuZ3VhZ2UgPSAnZW4nO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TGFuZ3VhZ2UgPSAhbGFuZ3VhZ2U/IGRlZmF1bHRsYW5ndWFnZSA6IGxhbmd1YWdlO1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPSAnaHR0cDovL2RkLmVpb25ldC5ldXJvcGEuZXUvdm9jYWJ1bGFyeS9ldXJlZ2lzdHJ5b25pbmR1c3RyaWFsc2l0ZXMvRGVyb2dhdGlvblZhbHVlL2pzb24nO1xuICAgICAgICAgICAgICAgICRodHRwLmdldCh1cmwsIHt0cmFja2VyOiAkcm9vdFNjb3BlLmxvYWRpbmdUcmFja2VyfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe1xuICAgICAgICAgICAgICAgICAgICBhbGVydChcIkZhaWxlZCB0byByZWFkIGNvZGUgbGlzdHMuIERhdGEgPSBcIiArICBkYXRhICsgXCIsIHN0YXR1cyA9IFwiICsgc3RhdHVzKTt9KVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKCBmdW5jdGlvbiAobmV3Q29kZUxpc3QpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuY29weShuZXdDb2RlTGlzdCwgY29kZUxpc3RzLkRlcm9nYXRpb25WYWx1ZUNvZGVMaXN0cyk7XG4gICAgICAgICAgICAvLy8vY29uc29sZS5sb2coXCJyZWNlaXZlZCBcIiArIHZvY2FidWxhcnlJZGVudGlmaWVyc0luQ29kZVtpXSk7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsb2FkT3RoZXJTb2xpZEZ1ZWxDb2RlTGlzdDogZnVuY3Rpb24obGFuZ3VhZ2Upe1xuICAgICAgICAgICAgICAgIC8vIHdlIGRvIG5vdCBuZWVkIHRoZSBmb3IgZWFjaCBvZiB0aGUgYWJvdmUgbG9hZENvZGVMaXN0IG1ldGhvZCwgc2luY2UgaW4gdGhlIGFib3ZlICwgaXQgaGFzIHRvIG1ha2Ugc2VwZXJhdGUgY2FsbHNcbiAgICAgICAgICAgICAgICAvLyBmb3IgZWFjaCB2b2NhYnVsYXJ5LCB3aGVyZWFzIHdlIGRvIG5vdCBoYXZlIHRvLlxuICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0bGFuZ3VhZ2UgPSAnZW4nO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TGFuZ3VhZ2UgPSAhbGFuZ3VhZ2U/IGRlZmF1bHRsYW5ndWFnZSA6IGxhbmd1YWdlO1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPSAnaHR0cDovL2RkLmVpb25ldC5ldXJvcGEuZXUvdm9jYWJ1bGFyeS9FUFJUUmFuZExDUC9PdGhlclNvbGlkRnVlbFZhbHVlL2pzb24nO1xuICAgICAgICAgICAgICAgICRodHRwLmdldCh1cmwsIHt0cmFja2VyOiAkcm9vdFNjb3BlLmxvYWRpbmdUcmFja2VyfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe1xuICAgICAgICAgICAgICAgICAgICBhbGVydChcIkZhaWxlZCB0byByZWFkIGNvZGUgbGlzdHMuIERhdGEgPSBcIiArICBkYXRhICsgXCIsIHN0YXR1cyA9IFwiICsgc3RhdHVzKTt9KVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKCBmdW5jdGlvbiAobmV3Q29kZUxpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9QdXNoIFwiT3RoZXJcIiB2YWx1ZSB0byB0aGUgZW5kIG9mIHRoZSBBcnJheVxuICAgICAgICAgICAgICAgICAgICB2YXIgb3RoZXJFbGVtZW50ID17fTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q29kZUxpc3QuY29uY2VwdHMuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihlbGVtZW50WydAaWQnXT09J090aGVyJyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIE90aGVyRWxlbWVudEluZGV4ID0gbmV3Q29kZUxpc3QuY29uY2VwdHMuaW5kZXhPZihlbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDb2RlTGlzdC5jb25jZXB0cy5zcGxpY2UoT3RoZXJFbGVtZW50SW5kZXgsMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ob3RoZXJFbGVtZW50LGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q29kZUxpc3QuY29uY2VwdHMucHVzaChvdGhlckVsZW1lbnQpO1xuICAgICAgICAgICAgYW5ndWxhci5jb3B5KG5ld0NvZGVMaXN0LCBjb2RlTGlzdHMuT3RoZXJTb2xpZEZ1ZWxDb2RlTGlzdHMpO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbG9hZE90aGVyR2FzZXNvdXNGdWVsQ29kZUxpc3Q6IGZ1bmN0aW9uKGxhbmd1YWdlKXtcbiAgICAgICAgICAgICAgICAvLyB3ZSBkbyBub3QgbmVlZCB0aGUgZm9yIGVhY2ggb2YgdGhlIGFib3ZlIGxvYWRDb2RlTGlzdCBtZXRob2QsIHNpbmNlIGluIHRoZSBhYm92ZSAsIGl0IGhhcyB0byBtYWtlIHNlcGVyYXRlIGNhbGxzXG4gICAgICAgICAgICAgICAgLy8gZm9yIGVhY2ggdm9jYWJ1bGFyeSwgd2hlcmVhcyB3ZSBkbyBub3QgaGF2ZSB0by5cbiAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdGxhbmd1YWdlID0gJ2VuJztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudExhbmd1YWdlID0gIWxhbmd1YWdlPyBkZWZhdWx0bGFuZ3VhZ2UgOiBsYW5ndWFnZTtcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gJ2h0dHA6Ly9kZC5laW9uZXQuZXVyb3BhLmV1L3ZvY2FidWxhcnkvRVBSVFJhbmRMQ1AvT3RoZXJHYXNlb3VzRnVlbFZhbHVlL2pzb24nO1xuICAgICAgICAgICAgICAgICRodHRwLmdldCh1cmwsIHt0cmFja2VyOiAkcm9vdFNjb3BlLmxvYWRpbmdUcmFja2VyfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe1xuICAgICAgICAgICAgICAgICAgICBhbGVydChcIkZhaWxlZCB0byByZWFkIGNvZGUgbGlzdHMuIERhdGEgPSBcIiArICBkYXRhICsgXCIsIHN0YXR1cyA9IFwiICsgc3RhdHVzKTt9KVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKCBmdW5jdGlvbiAobmV3Q29kZUxpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vUHVzaCBcIk90aGVyXCIgdmFsdWUgdG8gdGhlIGVuZCBvZiB0aGUgQXJyYXlcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdGhlckVsZW1lbnQgPXt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q29kZUxpc3QuY29uY2VwdHMuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZWxlbWVudFsnQGlkJ109PSdPdGhlcicpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgT3RoZXJFbGVtZW50SW5kZXggPSBuZXdDb2RlTGlzdC5jb25jZXB0cy5pbmRleE9mKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDb2RlTGlzdC5jb25jZXB0cy5zcGxpY2UoT3RoZXJFbGVtZW50SW5kZXgsMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKG90aGVyRWxlbWVudCxlbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvZGVMaXN0LmNvbmNlcHRzLnB1c2gob3RoZXJFbGVtZW50KTtcbiAgICAgICAgICAgIGFuZ3VsYXIuY29weShuZXdDb2RlTGlzdCwgY29kZUxpc3RzLk90aGVyR2FzZXNvdXNGdWVsQ29kZUxpc3RzKTtcbiAgICAgICAgICAgIC8vLy9jb25zb2xlLmxvZyhcInJlY2VpdmVkIFwiICsgdm9jYWJ1bGFyeUlkZW50aWZpZXJzSW5Db2RlW2ldKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxvYWRNb250aFZhbHVlQ29kZUxpc3Q6IGZ1bmN0aW9uKGxhbmd1YWdlKXtcbiAgICAgICAgICAgICAgICAvLyB3ZSBkbyBub3QgbmVlZCB0aGUgZm9yIGVhY2ggb2YgdGhlIGFib3ZlIGxvYWRDb2RlTGlzdCBtZXRob2QsIHNpbmNlIGluIHRoZSBhYm92ZSAsIGl0IGhhcyB0byBtYWtlIHNlcGVyYXRlIGNhbGxzXG4gICAgICAgICAgICAgICAgLy8gZm9yIGVhY2ggdm9jYWJ1bGFyeSwgd2hlcmVhcyB3ZSBkbyBub3QgaGF2ZSB0by5cbiAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdGxhbmd1YWdlID0gJ2VuJztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudExhbmd1YWdlID0gIWxhbmd1YWdlPyBkZWZhdWx0bGFuZ3VhZ2UgOiBsYW5ndWFnZTtcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gJ2h0dHA6Ly9kZC5laW9uZXQuZXVyb3BhLmV1L3ZvY2FidWxhcnkvRVBSVFJhbmRMQ1AvTW9udGhWYWx1ZS9qc29uJztcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsLCB7dHJhY2tlcjogJHJvb3RTY29wZS5sb2FkaW5nVHJhY2tlcn0pXG4gICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJGYWlsZWQgdG8gcmVhZCBjb2RlIGxpc3RzLiBEYXRhID0gXCIgKyAgZGF0YSArIFwiLCBzdGF0dXMgPSBcIiArIHN0YXR1cyk7fSlcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyggZnVuY3Rpb24gKG5ld0NvZGVMaXN0KSB7XG4gICAgICAgICAgICBhbmd1bGFyLmNvcHkobmV3Q29kZUxpc3QsIGNvZGVMaXN0cy5Nb250aFZhbHVlQ29kZUxpc3RzKTtcbiAgICAgICAgICAgIC8vLy9jb25zb2xlLmxvZyhcInJlY2VpdmVkIFwiICsgdm9jYWJ1bGFyeUlkZW50aWZpZXJzSW5Db2RlW2ldKTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChjb2RlTGlzdHMuTW9udGhWYWx1ZUNvZGVMaXN0cy5jb25jZXB0cywgZnVuY3Rpb24odmFsdWUsIGtleSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGVMaXN0cy5Nb250aGx5RGVzdWxwaHVyaXNhdGlvbltrZXldPXtcbiAgICAgICAgICAgICAgICAgICAgXCJEZXN1bHBodXJpc2F0aW9uUmF0ZVwiOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgXCJNb250aFZhbHVlXCI6dmFsdWUucHJlZkxhYmVsWzBdWydAdmFsdWUnXSxcbiAgICAgICAgICAgICAgICAgICAgXCJTdWxwaHVyQ29udGVudFwiOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgXCJUZWNobmljYWxKdXN0aWZpY2F0aW9uXCI6ICcnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICBcbiAgICAgICAgICAgIGxvYWRSZWdpb25zQ29kZWxpc3Q6IGZ1bmN0aW9uKGNvdW50cnkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gRERfVk9DQUJVTEFSWV9CQVNFX1VSSSArIFwiY29tbW9uL251dHMvanNvbj9pZD1cIiArIGNvdW50cnk7XG4gICAgICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuaXNJRTkgfHwgd2luZG93LmlzSUU5KXtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gYmFzZVVyaSArICcvcmVzdFByb3h5P3VyaT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2codXJsKTtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsLCB7dHJhY2tlcjogJHJvb3RTY29wZS5sb2FkaW5nVHJhY2tlcn0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe2FsZXJ0KFwiRmFpbGVkIHRvIHJlYWQgcmVnaW9ucyBjb2RlIGxpc3RzLlwiKTt9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKG5ld0NvZGVMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5jb3B5KG5ld0NvZGVMaXN0LCByZWdpb25Db2RlTGlzdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlZ2lvbkNvZGVMaXN0cy5jb25jZXB0cy5sZW5ndGggPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBERF9WT0NBQlVMQVJZX0JBU0VfVVJJICsgXCJsY3AvbGNwY291bnRyaWVzL2pzb24/aWQ9XCIgKyBjb3VudHJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5pc0lFOSB8fCB3aW5kb3cuaXNJRTkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gYmFzZVVyaSArICcvcmVzdFByb3h5P3VyaT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCwge3RyYWNrZXI6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKXthbGVydChcIkZhaWxlZCB0byByZWFkIHJlZ2lvbnMgY29kZSBsaXN0cy5cIik7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChwbGFudERldGFpbHNPdGhlclNlY3RvckZpZWxkc1ZpZXduZXdDb2RlTGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5jb3B5KG5ld0NvZGVMaXN0LCByZWdpb25Db2RlTGlzdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVnaW9uQ29kZUxpc3RzO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldEVtcHR5SW5zdGFuY2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPSAnbGNwLWluc3RhbmNlLWVtcHR5LnhtbD9mb3JtYXQ9anNvbic7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCh1cmwsIHt0cmFja2VyIDogJHJvb3RTY29wZS5sb2FkaW5nVHJhY2tlcn0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxvYWRJbnN0YW5jZUluZm86IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IGdldFdlYlFVcmwoXCIvZmlsZS9pbmZvXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQodXJsLCBkYXRhLCB7dHJhY2tlciA6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gbmV3XG4gICAgYXBwLmZpbHRlcignb2Zmc2V0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCwgc3RhcnQpIHtcbiAgICAgICAgICAgIGlmICghaW5wdXQgfHwgIShpbnB1dCBpbnN0YW5jZW9mIEFycmF5KSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN0YXJ0ID0gcGFyc2VJbnQoc3RhcnQsIDEwKTtcbiAgICAgICAgICAgIHJldHVybiBpbnB1dC5zbGljZShzdGFydCk7XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgLyoqICBhcHAuZmlsdGVyKCdmb3JtYXREZXJvZ2F0aW9uJywgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBcIlwiO1xuICAgICAgICAgICAgaWYgKHggIT0gbnVsbCAmJnguaXNBcnJheSkge1xuICAgICAgICAgICAgICAgIHguZm9yRWFjaChmdW5jdGlvbiAoZW50cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGVudHJ5O1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ1xcbic7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgIH0pO1xuICAgICAqKi9cbiAgICBhcHAuY29udHJvbGxlcignTW9kYWxDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgJG1vZGFsLCAkaHR0cCkge1xuICAgICAgICAvL3NhdmVzIE1haW4gZm9ybSB2YWxpZGF0aW9uIHN0YWdlXG4gICAgICAgICRzY29wZS5tYWluRm9ybVN1Ym1pdHRlZCA9ICRzY29wZS5zdWJtaXR0ZWQ7XG4gICAgICAgICRzY29wZS5wbGFudDtcbiAgICAgICAgJHNjb3BlLm9yaWdpbmFsUGxhbnQ7XG5cbiAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUuZWRpdEJvb2xlYW4gPSBmYWxzZTtcbiAgICAgICAgLyokc2NvcGUuZWRpdCA9IGZ1bmN0aW9uIChwbGFudCl7XG4gICAgICAgICAgICAkc2NvcGUuZWRpdEJvb2xlYW4gPSB0cnVlO1xuICAgICAgICAgICAgJHNjb3BlLnBsYW50PSBwbGFudDtcbiAgICAgICAgICAgICRzY29wZS5vcGVuKCdsZycpO1xuICAgICAgICB9Ki9cbiAgICAgICAgJHNjb3BlLmFkZCA9IGZ1bmN0aW9uICgpe1xuICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgJHNjb3BlLmVkaXRCb29sZWFuID0gZmFsc2U7XG4gICAgICAgICAgICAkc2NvcGUucGxhbnQgPSBudWxsO1xuICAgICAgICAgICAgJHNjb3BlLm9wZW4oJ2xnJyk7XG4gICAgICAgIH1cbiAgICAgICAgJHJvb3RTY29wZS4kd2F0Y2goJ3NlbGVjdGVkUGxhbnQnLCBmdW5jdGlvbihuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChuZXdWYWx1ZSAmJiBuZXdWYWx1ZSAhPSBudWxsICl7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRCb29sZWFuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUub3JpZ2luYWxQbGFudCA9ICBuZXdWYWx1ZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGxhbnQgPSBhbmd1bGFyLmNvcHkobmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2VsZWN0ZWRQbGFudCA9IG51bGw7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm9wZW4oJ2xnJywgJHJvb3RTY29wZS5tb2RhbFBhZ2VDYXNlSWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLm9wZW5BZGQgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkcm9vdFNjb3BlLm1vZGFsUGFnZUNhc2VJZCA9IFwiTGlzdE9mUGxhbnRzXCI7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLnNlbGVjdGVkUGxhbnQgPSBudWxsO1xuICAgICAgICAgICAgJHNjb3BlLm9wZW4oJ2xnJywnTGlzdE9mUGxhbnRzJyk7XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLmxvYWREYXRhRnJvbUVQUlRSID0gZnVuY3Rpb24ocGxhbnQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsb2FkRGF0YUZyb21FUFJUUiBmdW5jdGlvbiBpbnZva2VkJyk7XG4gICAgICAgICAgICB2YXIgY291bnRyeUNvZGUgPSAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5CYXNpY0RhdGEuTWVtYmVyU3RhdGU7XG4gICAgICAgICAgICBpZiAoY291bnRyeUNvZGUgJiYgY291bnRyeUNvZGUubGVuZ3RoID09IDIgJiYgcGxhbnQgKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgZXBydHJDb3VudHJ5Q29kZSA9IGNvdW50cnlDb2RlID09PSBcIkdCXCIgPyBcIlVLXCIgOiBjb3VudHJ5Q29kZSA9PT0gXCJHUlwiID8gXCJFTFwiIDogY291bnRyeUNvZGU7XG5cbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gXCJodHRwOi8vc2VtYW50aWMuZWVhLmV1cm9wYS5ldS9zcGFycWw/Zm9ybWF0PWFwcGxpY2F0aW9uL2pzb24mcXVlcnk9XCI7XG4gICAgICAgICAgICAgICAgdmFyIHNwYXJxbCA9IFwiUFJFRklYIHJkZnM6IDxodHRwOi8vd3d3LnczLm9yZy8yMDAwLzAxL3JkZi1zY2hlbWEjPiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiBQUkVGSVggY3I6IDxodHRwOi8vY3IuZWlvbmV0LmV1cm9wYS5ldS9vbnRvbG9naWVzL2NvbnRyZWcucmRmIz4gXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIgUFJFRklYIHBydHI6IDxodHRwOi8vcHJ0ci5lYy5ldXJvcGEuZXUvcmRmL3NjaGVtYS5yZGYjPiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiBQUkVGSVggZ2VvOiA8aHR0cDovL3d3dy53My5vcmcvMjAwMy8wMS9nZW8vd2dzODRfcG9zIz4gXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIgU0VMRUNUID9jb3VudHJ5Q29kZSA/TmF0aW9uYWxJRCA/ZmFjaWxpdHlJRCA/ZmFjaWxpdHlOYW1lID9zdHJlZXROYW1lID9idWlsZGluZ051bWJlciA/cG9zdGFsQ29kZSA/Y2l0eSA/bGF0ID9sb25nID9yZXBvcnRpbmdZZWFyXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIgV0hFUkUgeyA/ZmFjaWxpdHkgYSBwcnRyOkZhY2lsaXR5IDsgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIgcHJ0cjpmYWNpbGl0eUlEID9mYWNpbGl0eUlEIDsgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIgcHJ0cjpmYWNpbGl0eU5hbWUgP2ZhY2lsaXR5TmFtZSA7IFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiIHBydHI6c3RyZWV0TmFtZSA/c3RyZWV0TmFtZTsgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcnRyOmJ1aWxkaW5nTnVtYmVyICA/YnVpbGRpbmdOdW1iZXIgOyBcIitcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiIHBydHI6cG9zdGFsQ29kZSAgP3Bvc3RhbENvZGUgOyBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiBwcnRyOmNpdHkgP2NpdHkgOyBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiBnZW86bGF0ID9sYXQgOyBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiBnZW86bG9uZyA/bG9uZyA7IFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiIHBydHI6bGF0ZXN0UmVwb3J0ID9sYXRlc3RyZXBvcnQgO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiIHBydHI6aW5Db3VudHJ5ID9pbkNvdW50cnkgLiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiA/aW5Db3VudHJ5IHBydHI6Y29kZSA/Y291bnRyeUNvZGUgLiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiA/bGF0ZXN0cmVwb3J0IHBydHI6bmF0aW9uYWxJRCA/TmF0aW9uYWxJRCA7XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIgcHJ0cjpyZXBvcnRpbmdZZWFyID9yZXBvcnRpbmdZZWFyLlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiIEZJTFRFUiAoP2NvdW50cnlDb2RlID0gJ1wiICsgZXBydHJDb3VudHJ5Q29kZSArIFwiJyBhbmQgVUNBU0UoP05hdGlvbmFsSUQpID0gVUNBU0UoJ1wiICsgcGxhbnQuRVBSVFJOYXRpb25hbElkICsgXCInICkgKSB9IE9SREVSIEJZIERFU0MoP3JlcG9ydGluZ1llYXIpIExJTUlUIDFcIjtcbiAgICAgICAgICAgICAgICB1cmwgPSBiYXNlVXJpICsgJy9yZXN0UHJveHk/dXJpPScgKyBlbmNvZGVVUklDb21wb25lbnQodXJsICsgZW5jb2RlVVJJQ29tcG9uZW50KHNwYXJxbCkpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1cmwgZm9yIHNwYXJxbCBlcHJ0ciBkYXRhIGlzOicrdXJsKTtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQodXJsLCB7dHJhY2tlciA6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKCl7YWxlcnQoXCJGYWlsZWQgdG8gcmVhZCBkYXRhIGZyb20gRS1QUlRSLlwiKTt9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZXBydHJEYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVwcnRyRGF0YS5yZXN1bHRzLmJpbmRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFjaWxpdHkgPSBlcHJ0ckRhdGEucmVzdWx0cy5iaW5kaW5nc1swXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlybShcIlRoZSBzeXN0ZW0gZm91bmQgdGhlIGZvbGxvd2luZyBmYWNpbGl0eTogXCIgKyBmYWNpbGl0eS5mYWNpbGl0eU5hbWUudmFsdWUgKyBcIiwgXCIgKyBmYWNpbGl0eS5zdHJlZXROYW1lLnZhbHVlICsgXCIsIFwiICsgZmFjaWxpdHkucG9zdGFsQ29kZS52YWx1ZSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiwgXCIgICsgZmFjaWxpdHkuY2l0eS52YWx1ZSArIFwiLiBcXG5cXG4gRG8geW91IHdhbnQgdG8gdXNlIHRoZSBkYXRhIG9uIHBsYW50IGxldmVsP1wiICkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcGxhbnQuUGxhbnRMb2NhdGlvbikgcGxhbnQuUGxhbnRMb2NhdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlKSBwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFudC5QbGFudExvY2F0aW9uLlN0cmVldE5hbWUgPSBmYWNpbGl0eS5zdHJlZXROYW1lLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0VtcHR5KGZhY2lsaXR5LmJ1aWxkaW5nTnVtYmVyLnZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50TG9jYXRpb24uQnVpbGRpbmdOdW1iZXIgKz0gXCIgXCIgKyBmYWNpbGl0eS5idWlsZGluZ051bWJlci52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50TG9jYXRpb24uQ2l0eSA9ZmFjaWxpdHkuY2l0eS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50LlBsYW50TG9jYXRpb24uUG9zdGFsQ29kZSA9IGZhY2lsaXR5LnBvc3RhbENvZGUudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFudC5QbGFudExvY2F0aW9uLkJ1aWxkaW5nTnVtYmVyID0gZmFjaWxpdHkuYnVpbGRpbmdOdW1iZXIudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxvbmdpdHVkZSA9IGZhY2lsaXR5LmxvbmcudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxhdGl0dWRlID0gZmFjaWxpdHkubGF0LnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuRmFjaWxpdHlOYW1lID0gZmFjaWxpdHkuZmFjaWxpdHlOYW1lLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiVGhlIHN5c3RlbSBjb3VsZCBub3QgZmluZCBhbnkgZmFjaWxpdHkgd2l0aCBOYXRpb25hbElEPVwiICsgcGxhbnQuRVBSVFJOYXRpb25hbElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGFsZXJ0KFwiTWVtYmVyIHN0YXRlIGlzIG5vdCBzZWxlY3RlZCBvbiBCYXNpYyBEYXRhIGZvcm0hXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvL2VkaXQoXG4gICAgICAgICRzY29wZS5vcGVuID0gZnVuY3Rpb24gKHNpemUsbW9kYWxQYWdlSWQpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2cobW9kYWxQYWdlSWQpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygkcm9vdFNjb3BlLm1vZGFsUGFnZUNhc2VJZD09IHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCRyb290U2NvcGUubW9kYWxQYWdlQ2FzZUlkPT1cIkxpc3RPZlBsYW50c1wiKTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJHJvb3RTY29wZS5tb2RhbFBhZ2VDYXNlSWQ9PVwiUGxhbnREZXRhaWxzXCIpO1xuICAgICAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2U7XG4gICAgICAgICAgICAvL0ZvciBhZGRpbmcgbmV3IHBsYW50XG4gICAgICAgICAgICBpZihtb2RhbFBhZ2VJZCA9PSB1bmRlZmluZWQpe1xuIC8vICAgICAgICAgICAgICAgaWYgKCAkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5CYXNpY0RhdGEuTWVtYmVyU3RhdGUhPW51bGwgKVxuLy97ICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZSA9ICRtb2RhbC5vcGVuKHtcblxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ0xpc3RPZlBsYW50TW9kYWxDb250ZW50Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTGlzdE9mUGxhbnRzTW9kYWxJbnN0YW5jZUN0cmwnLFxuICAgICAgICAgICAgICAgICAgICBzaXplOiBzaXplLFxuICAgICAgICAgICAgICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICB3aW5kb3dDbGFzczogJ2FwcC1tb2RhbC13aW5kb3cnLFxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFudDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAgJHNjb3BlLnBsYW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vICAgfWVsc2V7XG4gICAgICAgICAgICAgLy8gICAgICBhbGVydChcIlBsZWFzZSBmaWxsIGluIHRoZSBNZW1iZXIgU3RhdGUgZnJvbSBCYXNpYyBJbmZvIGZpcnN0LlwiKTtcbiAgICAgICAgICAgICAvLyAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAvLyAgfVxuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL0ZvciBlZGl0aW5nIHBsYW50XG4gICAgICAgICAgICBpZihtb2RhbFBhZ2VJZCA9PSBcIkxpc3RPZlBsYW50c1wiKXtcbiAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlID0gJG1vZGFsLm9wZW4oe1xuXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnTGlzdE9mUGxhbnRNb2RhbENvbnRlbnQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMaXN0T2ZQbGFudHNNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd0NsYXNzOiAnYXBwLW1vZGFsLXdpbmRvdycsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAkc2NvcGUucGxhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobW9kYWxQYWdlSWQgPT0gXCJQbGFudERldGFpbHNcIil7XG4gICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2UgPSAkbW9kYWwub3Blbih7XG5cbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdQbGFudERldGFpbHNNb2RhbENvbnRlbnQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQbGFudERldGFpbHNNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd0NsYXNzOiAnYXBwLW1vZGFsLXdpbmRvdycsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAkc2NvcGUucGxhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobW9kYWxQYWdlSWQ9PVwiVG90YWxFbWlzc2lvbnNUb0FpclwiKXtcbiAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlID0gJG1vZGFsLm9wZW4oe1xuXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnVG90YWxFbWlzc2lvbnNUb0Fpck1vZGFsQ29udGVudC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1RvdGFsRW1pc3Npb25zVG9BaXJNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd0NsYXNzOiAnYXBwLW1vZGFsLXdpbmRvdycsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAkc2NvcGUucGxhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobW9kYWxQYWdlSWQ9PVwiRW5lcmd5SW5wdXRcIil7XG4gICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZSA9ICRtb2RhbC5vcGVuKHtcblxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ0VuZXJneUlucHV0TW9kYWxDb250ZW50Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRW5lcmd5SW5wdXRNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd0NsYXNzOiAnYXBwLW1vZGFsLXdpbmRvdycsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAkc2NvcGUucGxhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobW9kYWxQYWdlSWQ9PVwiRGVzdWxwaHVyaXNhdGlvblwiKXtcbiAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlID0gJG1vZGFsLm9wZW4oe1xuXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnRGVzdWxwaHVyaXNhdGlvbk1vZGFsQ29udGVudC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rlc3VscGh1cmlzYXRpb25Nb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd0NsYXNzOiAnYXBwLW1vZGFsLXdpbmRvdycsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAkc2NvcGUucGxhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobW9kYWxQYWdlSWQ9PVwiVXNlZnVsSGVhdFwiKXtcbiAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlID0gJG1vZGFsLm9wZW4oe1xuXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnVXNlZnVsSGVhdE1vZGFsQ29udGVudC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1VzZWZ1bEhlYXRNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd0NsYXNzOiAnYXBwLW1vZGFsLXdpbmRvdycsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAkc2NvcGUucGxhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtb2RhbEluc3RhbmNlLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChzZWxlY3RlZEl0ZW0pIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSBzZWxlY3RlZEl0ZW07XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8kbG9nLmluZm8oJ01vZGFsIGRpc21pc3NlZCBhdDogJyArIG5ldyBEYXRlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICBhcHAuY29udHJvbGxlcignTGlzdE9mUGxhbnRzTW9kYWxJbnN0YW5jZUN0cmwnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHNjb3BlLCAkbW9kYWxJbnN0YW5jZSwgcGxhbnQsZGF0YVJlcG9zaXRvcnkpIHtcbiAgICAgICAgdmFyIGVkaXQgPSBmYWxzZTtcblxuXG4gICAgICAgIGlmKHBsYW50ICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICBlZGl0ID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChKU09OLnN0cmluZ2lmeSggJHNjb3BlLnJlZ2lvbnNDb2RlbGlzdCApID09PSBcInt9XCIpICB7XG5cbiAgICAgICAgICAgIGlmICggJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuQmFzaWNEYXRhLk1lbWJlclN0YXRlIClcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVnaW9uc0NvZGVsaXN0ID0gZGF0YVJlcG9zaXRvcnkubG9hZFJlZ2lvbnNDb2RlbGlzdCgkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5CYXNpY0RhdGEuTWVtYmVyU3RhdGUpO1xuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYWxlcnQoXCJQbGVhc2UgZmlsbCBpbiB0aGUgTWVtYmVyIFN0YXRlIGZyb20gQmFzaWMgSW5mbyBmaXJzdC5cIik7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9ICRzY29wZS5tYWluRm9ybVN1Ym1pdHRlZDtcbiAgICAgICAgICAgICAvLyAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xuICAgICAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUub2sgPSBmdW5jdGlvbiAocGxhbnQpIHtcblxuICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICBpZihwbGFudCAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgIGlmKHBsYW50LlBsYW50TmFtZSAhPSBudWxsICYmIHBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTG9uZ2l0dWRlICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICgxODAgPj0gcGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5Mb25naXR1ZGUgJiYgcGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5Mb25naXR1ZGUgPj0gLTE4MCkgICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFudC5HZW9ncmFwaGljYWxDb29yZGluYXRlLkxhdGl0dWRlICE9IG51bGwgJiYgKDkwID49IHBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTGF0aXR1ZGUgJiYgcGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5MYXRpdHVkZSA+PSAtOTApKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoIWVkaXQpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIHBsYW50LlBsYW50TG9jYXRpb24gPT0gbnVsbCApIHBsYW50LlBsYW50TG9jYXRpb24gPSB7fSA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYXN0UGxhbnQgPSAkc2NvcGUuYWRkSXRlbSgnTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gJHNjb3BlLmdldE5leHRQbGFudElkICgpIDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVzaW5nICRxIHByb21pc2UgQVBJLCB0byBhc2sgdGhlIHNlcnZlciBmaXJzdCBmb3IgaWQgY29sbGlzaW9ucy5cbiAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2UudGhlbiAoIGZ1bmN0aW9uICggcGxhbnRpZCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudElkID0gcGxhbnRpZCA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50LlBsYW50TmFtZSA9ICBwbGFudC5QbGFudE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50LkVQUlRSTmF0aW9uYWxJZCA9ICBwbGFudC5FUFJUUk5hdGlvbmFsSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50LlBsYW50TG9jYXRpb24uU3RyZWV0TmFtZSA9ICBwbGFudC5QbGFudExvY2F0aW9uLlN0cmVldE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBsYXN0UGxhbnQuUGxhbnRMb2NhdGlvbi5BZGRyZXNzMiA9ICBwbGFudC5QbGFudExvY2F0aW9uLkFkZHJlc3MyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudExvY2F0aW9uLkNpdHkgPSAgcGxhbnQuUGxhbnRMb2NhdGlvbi5DaXR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudExvY2F0aW9uLlJlZ2lvbiA9ICBwbGFudC5QbGFudExvY2F0aW9uLlJlZ2lvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuUGxhbnRMb2NhdGlvbi5Qb3N0YWxDb2RlID0gIHBsYW50LlBsYW50TG9jYXRpb24uUG9zdGFsQ29kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuUGxhbnRMb2NhdGlvbi5CdWlsZGluZ051bWJlciA9ICBwbGFudC5QbGFudExvY2F0aW9uLkJ1aWxkaW5nTnVtYmVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudExvY2F0aW9uLkNvdW50cnlDb2RlID0gICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkJhc2ljRGF0YS5NZW1iZXJTdGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5Mb25naXR1ZGUgPSAgcGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5Mb25naXR1ZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTGF0aXR1ZGUgPSAgcGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5MYXRpdHVkZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuRmFjaWxpdHlOYW1lID0gIHBsYW50LkZhY2lsaXR5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuQ29tbWVudHMgPSAgcGxhbnQuQ29tbWVudHM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZUZpbHRlcicpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9sb2FkIE1haW4gZm9ybSB2YWxpZGF0aW9uIHN0YWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9ICRzY29wZS5tYWluRm9ybVN1Ym1pdHRlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2F2ZUluc3RhbmNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKHBsYW50KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFzdFBsYW50ID0gJHNjb3BlLm9yaWdpbmFsUGxhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuUGxhbnROYW1lID0gIHBsYW50LlBsYW50TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5FUFJUUk5hdGlvbmFsSWQgPSAgcGxhbnQuRVBSVFJOYXRpb25hbElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50LlBsYW50TG9jYXRpb24uU3RyZWV0TmFtZSA9ICBwbGFudC5QbGFudExvY2F0aW9uLlN0cmVldE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2xhc3RQbGFudC5QbGFudExvY2F0aW9uLkFkZHJlc3MyID0gIHBsYW50LlBsYW50TG9jYXRpb24uQWRkcmVzczI7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuUGxhbnRMb2NhdGlvbi5DaXR5ID0gIHBsYW50LlBsYW50TG9jYXRpb24uQ2l0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudExvY2F0aW9uLlJlZ2lvbiA9ICBwbGFudC5QbGFudExvY2F0aW9uLlJlZ2lvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudExvY2F0aW9uLkJ1aWxkaW5nTnVtYmVyID0gIHBsYW50LlBsYW50TG9jYXRpb24uQnVpbGRpbmdOdW1iZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuUGxhbnRMb2NhdGlvbi5Qb3N0YWxDb2RlID0gIHBsYW50LlBsYW50TG9jYXRpb24uUG9zdGFsQ29kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudExvY2F0aW9uLkNvdW50cnlDb2RlID0gJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuQmFzaWNEYXRhLk1lbWJlclN0YXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTG9uZ2l0dWRlID0gIHBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTG9uZ2l0dWRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50Lkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTGF0aXR1ZGUgPSAgcGxhbnQuR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5MYXRpdHVkZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5GYWNpbGl0eU5hbWUgPSAgcGxhbnQuRmFjaWxpdHlOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBsYW50LkNvbW1lbnRzID0gIHBsYW50LkNvbW1lbnRzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZUZpbHRlcicpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2xvYWQgTWFpbiBmb3JtIHZhbGlkYXRpb24gc3RhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSAkc2NvcGUubWFpbkZvcm1TdWJtaXR0ZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNhdmVJbnN0YW5jZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UocGxhbnQpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0gZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJQbGVhc2UgZmlsbCBpbiBhbGwgbWFuZGF0b3J5IGZpZWxkcyFcIik7XG4gICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZXtcbiAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgIGFsZXJ0KFwiUGxlYXNlIGZpbGwgaW4gYWxsIG1hbmRhdG9yeSBmaWVsZHMhXCIpO1xuICAgICAgICAgICAgIH1cblxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc2F2ZUFuZEFkZCA9ICBmdW5jdGlvbihwbGFudCl7XG4gICAgICAgICAgICAkc2NvcGUub2socGxhbnQpO1xuICAgICAgICAgICAgc2F2ZUluc3RhbmNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vbG9hZCBNYWluIGZvcm0gdmFsaWRhdGlvbiBzdGFnZVxuICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9ICRzY29wZS5tYWluRm9ybVN1Ym1pdHRlZDtcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xuICAgICAgICB9O1xuICAgIH0pO1xuICAgIGFwcC5jb250cm9sbGVyKCdQbGFudERldGFpbHNNb2RhbEluc3RhbmNlQ3RybCcsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkZmlsdGVyLCAkc2NvcGUsICRtb2RhbEluc3RhbmNlLCBwbGFudCkge1xuICAgICAgICAkc2NvcGUub2sgPSBmdW5jdGlvbiAocGxhbnQpIHtcbiAgICAgICAgICAgIGlmICghJHNjb3BlLm1vZGFsUGxhbnREZXRhaWxzLiRpbnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxhc3RQbGFudCA9ICRzY29wZS5vcmlnaW5hbFBsYW50O1xuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudERldGFpbHMuTVd0aCA9ICBwbGFudC5QbGFudERldGFpbHMuTVd0aDtcbiAgICAgICAgICAgICAgICBsYXN0UGxhbnQuUGxhbnREZXRhaWxzLkRhdGVPZlN0YXJ0T2ZPcGVyYXRpb24gPSAgcGxhbnQuUGxhbnREZXRhaWxzLkRhdGVPZlN0YXJ0T2ZPcGVyYXRpb247XG4gICAgICAgICAgICAgICAgbGFzdFBsYW50LlBsYW50RGV0YWlscy5SZWZpbmVyaWVzID0gICRmaWx0ZXIoJ2xvd2VyY2FzZScpKHBsYW50LlBsYW50RGV0YWlscy5SZWZpbmVyaWVzKTtcbiAgICAgICAgICAgICAgICBsYXN0UGxhbnQuUGxhbnREZXRhaWxzLk90aGVyU2VjdG9yID0gIHBsYW50LlBsYW50RGV0YWlscy5PdGhlclNlY3RvcjtcbiAgICAgICAgICAgICAgICBsYXN0UGxhbnQuUGxhbnREZXRhaWxzLk9wZXJhdGluZ0hvdXJzID0gIHBsYW50LlBsYW50RGV0YWlscy5PcGVyYXRpbmdIb3VyczsgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbGFzdFBsYW50LlBsYW50RGV0YWlscy5Db21tZW50cyA9ICBwbGFudC5QbGFudERldGFpbHMuQ29tbWVudHM7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbGFzdFBsYW50LlBsYW50RGV0YWlscy5UeXBlT2ZDb21idXN0aW9uUGxhbnQgPSBwbGFudC5QbGFudERldGFpbHMuVHlwZU9mQ29tYnVzdGlvblBsYW50O1xuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5QbGFudERldGFpbHMuVHlwZU9mQ29tYnVzdGlvblBsYW50RnVydGhlckRldGFpbHMgPSBwbGFudC5QbGFudERldGFpbHMuVHlwZU9mQ29tYnVzdGlvblBsYW50RnVydGhlckRldGFpbHM7XG4gICAgICAgICAgICAgICAgbGFzdFBsYW50LlBsYW50RGV0YWlscy5EZXJvZ2F0aW9uID0gcGxhbnQuUGxhbnREZXRhaWxzLkRlcm9nYXRpb247XG4gICAgXG5cbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZUZpbHRlcicpO1xuXG4gICAgICAgICAgICAgICAgLy9sb2FkIE1haW4gZm9ybSB2YWxpZGF0aW9uIHN0YWdlXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9ICRzY29wZS5tYWluRm9ybVN1Ym1pdHRlZDtcbiAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWxQbGFudERldGFpbHMuJHNldFByaXN0aW5lKHRydWUpO1xuICAgICAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKHBsYW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYWxlcnQoXCJQbGVhc2UgZmlsbCBpbiBhbGwgbWFuZGF0b3J5IGZpZWxkcyEgXCIpO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvL2xvYWQgTWFpbiBmb3JtIHZhbGlkYXRpb24gc3RhZ2VcbiAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSAkc2NvcGUubWFpbkZvcm1TdWJtaXR0ZWQ7XG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbiAgICAgICAgfTtcbiAgICB9KTtcblxuICAgIGFwcC5jb250cm9sbGVyKCdUb3RhbEVtaXNzaW9uc1RvQWlyTW9kYWxJbnN0YW5jZUN0cmwnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHNjb3BlLCAkbW9kYWxJbnN0YW5jZSwgcGxhbnQpIHtcblxuICAgICAgICAkc2NvcGUub2sgPSBmdW5jdGlvbiAocGxhbnQpIHtcbiAgICAgICAgICAgIGlmICghJHNjb3BlLm1vZGFsVG90YWxFbWlzc2lvbnNUb0Fpci4kaW52YWxpZCkge1xuICAgICAgICAgICAgICAgIHZhciBsYXN0UGxhbnQgPSAkc2NvcGUub3JpZ2luYWxQbGFudDtcblxuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuVG90YWxFbWlzc2lvbnNUb0Fpci5TTzIgPSAgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLlRvdGFsRW1pc3Npb25zVG9BaXIuU08yO1xuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuVG90YWxFbWlzc2lvbnNUb0Fpci5OT3ggPSAgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLlRvdGFsRW1pc3Npb25zVG9BaXIuTk94O1xuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuVG90YWxFbWlzc2lvbnNUb0Fpci5UU1AgPSAgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLlRvdGFsRW1pc3Npb25zVG9BaXIuVFNQO1xuXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVGaWx0ZXInKTtcblxuICAgICAgICAgICAgICAgIC8vbG9hZCBNYWluIGZvcm0gdmFsaWRhdGlvbiBzdGFnZVxuICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSAkc2NvcGUubWFpbkZvcm1TdWJtaXR0ZWQ7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm1vZGFsVG90YWxFbWlzc2lvbnNUb0Fpci4kc2V0UHJpc3RpbmUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UocGxhbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBhbGVydChcIlBsZWFzZSBmaWxsIGluIGFsbCBtYW5kYXRvcnkgZmllbGRzISBcIik7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vbG9hZCBNYWluIGZvcm0gdmFsaWRhdGlvbiBzdGFnZVxuICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9ICRzY29wZS5tYWluRm9ybVN1Ym1pdHRlZDtcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xuICAgICAgICB9O1xuICAgIH0pO1xuYXBwLmNvbnRyb2xsZXIoJ0VuZXJneUlucHV0TW9kYWxJbnN0YW5jZUN0cmwnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHNjb3BlLCAkbW9kYWxJbnN0YW5jZSwgcGxhbnQpIHtcblxuICAgICRzY29wZS5hZGRPdGhlclNvbGlkRnVlbCA9IGZ1bmN0aW9uKCl7XG4gICAgIHBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5PdGhlclNvbGlkRnVlbHMuT3RoZXJTb2xpZEZ1ZWwucHVzaCh7XCJDYXRlZ29yeVwiOiBudWxsLCBcIlZhbHVlXCI6IG51bGx9KTtcbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUuYWRkT3RoZXJHYXMgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk90aGVyR2FzZXMuT3RoZXJHYXMucHVzaCh7XCJDYXRlZ29yeVwiOiBudWxsLCBcIlZhbHVlXCI6IG51bGx9KTtcbiAgICAgICAgICAgICAgIH1cblxuICAgICAgICAkc2NvcGUucmVtb3ZlT3RoZXJTb2xpZEZ1ZWwgPSBmdW5jdGlvbihpbmRleCl7XG4gICAgICAgICAgICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuT3RoZXJTb2xpZEZ1ZWxzLk90aGVyU29saWRGdWVsLnNwbGljZShpbmRleCwxKTtcbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUucmVtb3ZlT3RoZXJHYXMgPSBmdW5jdGlvbihpbmRleCl7XG4gICAgICAgICAgICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuT3RoZXJHYXNlcy5PdGhlckdhcy5zcGxpY2UoaW5kZXgsMSk7XG4gICAgICAgIH1cbiAgaWYocGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk90aGVyU29saWRGdWVscz09bnVsbCB8fCBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuT3RoZXJTb2xpZEZ1ZWxzLk90aGVyU29saWRGdWVsPT1udWxsICBcbiAgfHwgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk90aGVyU29saWRGdWVscy5PdGhlclNvbGlkRnVlbC5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0IHx8IHBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5PdGhlclNvbGlkRnVlbHMuT3RoZXJTb2xpZEZ1ZWw9PTEpIHtcbiAgICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuT3RoZXJTb2xpZEZ1ZWxzLk90aGVyU29saWRGdWVsPVtdO1xuICAgIHBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5PdGhlclNvbGlkRnVlbHMuT3RoZXJTb2xpZEZ1ZWwucHVzaCh7XCJDYXRlZ29yeVwiOiBudWxsLCBcIlZhbHVlXCI6IG51bGx9KTtcbiAgICBcbiAgfVxuICBpZihwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuT3RoZXJHYXNlcz09bnVsbCB8fCBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuT3RoZXJHYXNlcy5PdGhlckdhcz09bnVsbCAgXG4gICAgfHwgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk90aGVyR2FzZXMuT3RoZXJHYXMuY29uc3RydWN0b3IgPT09IE9iamVjdCB8fCBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuT3RoZXJHYXNlcy5PdGhlckdhcz09MSkge1xuICAgICAgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk90aGVyR2FzZXMuT3RoZXJHYXM9W107XG4gICAgICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuT3RoZXJHYXNlcy5PdGhlckdhcy5wdXNoKHtcIkNhdGVnb3J5XCI6IG51bGwsIFwiVmFsdWVcIjogbnVsbH0pO1xuICAgICAgXG4gICAgfVxuXG4gICAgICAgICAgICAgICAgXG5cblxuXG4gICAgICAgICRzY29wZS5vayA9IGZ1bmN0aW9uIChwbGFudCkge1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUubW9kYWxFbmVyZ3lJbnB1dC4kaW52YWxpZCkge1xuICAgICAgICAgICAgICAgIHZhciBsYXN0UGxhbnQgPSAkc2NvcGUub3JpZ2luYWxQbGFudDtcblxuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuQmlvbWFzcyA9ICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuQmlvbWFzcztcbiAgICAgICAgICAgICAgICBsYXN0UGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0LkJpb21hc3MgPSAgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0LkJpb21hc3M7ICBcbiAgICAgICAgICAgICAgICBsYXN0UGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0LkNvYWwgPSAgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0LkNvYWw7ICAgICAgXG4gICAgICAgICAgICAgICAgbGFzdFBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5MaWduaXRlID0gIHBsYW50LkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5MaWduaXRlOyAgICAgIFxuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuUGVhdCA9ICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuUGVhdDsgICAgICBcbiAgICAgICAgICAgICAgICBsYXN0UGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk90aGVyU29saWRGdWVscyA9ICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuT3RoZXJTb2xpZEZ1ZWxzO1xuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuTGlxdWlkRnVlbHMgPSAgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0LkxpcXVpZEZ1ZWxzO1xuICAgICAgICAgICAgICAgIGxhc3RQbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuTmF0dXJhbEdhcyA9ICBwbGFudC5FbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuTmF0dXJhbEdhcztcbiAgICAgICAgICAgICAgICBsYXN0UGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk90aGVyR2FzZXMgPSAgcGxhbnQuRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0Lk90aGVyR2FzZXM7XG5cbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZUZpbHRlcicpO1xuXG4gICAgICAgICAgICAgICAgLy9sb2FkIE1haW4gZm9ybSB2YWxpZGF0aW9uIHN0YWdlXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9ICRzY29wZS5tYWluRm9ybVN1Ym1pdHRlZDtcbiAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWxFbmVyZ3lJbnB1dC4kc2V0UHJpc3RpbmUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UocGxhbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBhbGVydChcIlBsZWFzZSBmaWxsIGluIGFsbCBtYW5kYXRvcnkgZmllbGRzISBcIik7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vbG9hZCBNYWluIGZvcm0gdmFsaWRhdGlvbiBzdGFnZVxuICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdHRlZCA9ICRzY29wZS5tYWluRm9ybVN1Ym1pdHRlZDtcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xuICAgICAgICB9O1xuICAgIH0pO1xuXG4gICAgXG4gICAgICAgICAgICBhcHAuY29udHJvbGxlcignRGVzdWxwaHVyaXNhdGlvbk1vZGFsSW5zdGFuY2VDdHJsJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRzY29wZSwgJG1vZGFsSW5zdGFuY2UsIHBsYW50KSB7XG5cbiAgICAgICAgICAgICAgICAvL1dlIGNoZWNrIGlmIE1vbnRoIGlzIGFuIGFycmF5IGFuZCBpZiBub3QgaW5pdGlhbGl6ZSBpdCBhcyBhbiBhcnJheSBpbiBvcmRlciB0byB0aGVuIGZpbGwgaXQgYmVsb3cuXG4gICAgICAgICAgICAgICAgaWYocGxhbnQuRGVzdWxwaHVyaXNhdGlvbi5Nb250aHM9PW51bGwgfHwgcGxhbnQuRGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGg9PW51bGwgIHx8IHBsYW50LkRlc3VscGh1cmlzYXRpb24uTW9udGhzLk1vbnRoLmNvbnN0cnVjdG9yID09PSBPYmplY3QgfHwgcGxhbnQuRGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGgubGVuZ3RoPT0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHBsYW50LkRlc3VscGh1cmlzYXRpb24uTW9udGhzLk1vbnRoPVtdO1xuICAgICAgICAgICAgICAgIC8vSWYgTW9udGhzIEVtcHR5ICwgaW5pdGlhbGl6ZSB0aGVtIGJlZm9yZSB0aGUgbW9kYWxcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLmNvZGVMaXN0Lk1vbnRobHlEZXN1bHBodXJpc2F0aW9uLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocGxhbnQuRGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGhba2V5XT09bnVsbCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgcGxhbnQuRGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGgucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTW9udGhWYWx1ZVwiOiB2YWx1ZS5Nb250aFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkRlc3VscGh1cmlzYXRpb25SYXRlXCI6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiU3VscGh1ckNvbnRlbnRcIjogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJUZWNobmljYWxKdXN0aWZpY2F0aW9uXCI6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICRzY29wZS5vayA9IGZ1bmN0aW9uIChwbGFudCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoISRzY29wZS5tb2RhbERlc3VscGh1cmlzYXRpb24uJGludmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYXN0UGxhbnQgPSAkc2NvcGUub3JpZ2luYWxQbGFudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuY29kZUxpc3QuTW9udGhseURlc3VscGh1cmlzYXRpb24sIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAvKiogICAgICAgcGxhbnQuRGVzdWxwaHVyaXNhdGlvbi5Nb250aHMuTW9udGgucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTW9udGhWYWx1ZVwiOiB2YWx1ZS5Nb250aFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkRlc3VscGh1cmlzYXRpb25SYXRlXCI6IHZhbHVlLkRlc3VscGh1cmlzYXRpb25SYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlN1bHBodXJDb250ZW50XCI6IHZhbHVlLlN1bHBodXJDb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRlY2huaWNhbEp1c3RpZmljYXRpb25cIjogdmFsdWUuVGVjaG5pY2FsSnVzdGlmaWNhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgKiovXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0UGxhbnQuRGVzdWxwaHVyaXNhdGlvbiA9IHBsYW50LkRlc3VscGh1cmlzYXRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3VwZGF0ZUZpbHRlcicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9sb2FkIE1haW4gZm9ybSB2YWxpZGF0aW9uIHN0YWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gJHNjb3BlLm1haW5Gb3JtU3VibWl0dGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vZGFsRGVzdWxwaHVyaXNhdGlvbi4kc2V0UHJpc3RpbmUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZShwbGFudCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJQbGVhc2UgZmlsbCBpbiBhbGwgbWFuZGF0b3J5IGZpZWxkcyEgXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vbG9hZCBNYWluIGZvcm0gdmFsaWRhdGlvbiBzdGFnZVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gJHNjb3BlLm1haW5Gb3JtU3VibWl0dGVkO1xuICAgICAgICAgICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGFwcC5jb250cm9sbGVyKCdVc2VmdWxIZWF0TW9kYWxJbnN0YW5jZUN0cmwnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHNjb3BlLCAkbW9kYWxJbnN0YW5jZSwgcGxhbnQpIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5vayA9IGZ1bmN0aW9uIChwbGFudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHNjb3BlLm1vZGFsVXNlZnVsSGVhdC4kaW52YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFzdFBsYW50ID0gJHNjb3BlLm9yaWdpbmFsUGxhbnQ7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQbGFudC5Vc2VmdWxIZWF0LlVzZWZ1bEhlYXRQcm9wb3J0aW9uID0gIHBsYW50LlVzZWZ1bEhlYXQuVXNlZnVsSGVhdFByb3BvcnRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVGaWx0ZXInKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9sb2FkIE1haW4gZm9ybSB2YWxpZGF0aW9uIHN0YWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSAkc2NvcGUubWFpbkZvcm1TdWJtaXR0ZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tb2RhbFVzZWZ1bEhlYXQuJHNldFByaXN0aW5lKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZShwbGFudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydChcIlBsZWFzZSBmaWxsIGluIGFsbCBtYW5kYXRvcnkgZmllbGRzISBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2xvYWQgTWFpbiBmb3JtIHZhbGlkYXRpb24gc3RhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gJHNjb3BlLm1haW5Gb3JtU3VibWl0dGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgXG4gICAgYXBwLmZpbHRlcigndHJ1ZV9mYWxzZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odGV4dCwgbGVuZ3RoLCBlbmQpIHtcbiAgICAgICAgICAgIGlmICh0ZXh0ICYmICh0ZXh0ID09PSB0cnVlIHx8IHRleHQgPT09ICdUUlVFJykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1llcyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJ05vJztcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgYXBwLmNvbnRyb2xsZXIoXCJQYWdpbmF0aW9uQ3RybFwiLCBmdW5jdGlvbigkc2NvcGUsICRmaWx0ZXIsICRyb290U2NvcGUsICRtb2RhbCkge1xuXG5cblxuICAgICAgICB2YXIgb3JkZXJCeSA9ICRmaWx0ZXIoJ29yZGVyQnknKTtcbiAgICAgICAgLypcbiAgICAgICAgICAgIGlmICghYW5ndWxhci5pc0FycmF5KCRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cykpe1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cyA9IFskc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHNdO1xuICAgICAgICAgICAgfVxuICAgICAgICAqL1xuXG5cbiAgICAgICAgJHNjb3BlLml0ZW1zUGVyUGFnZSA9IDUwO1xuICAgICAgICAkc2NvcGUuY3VycmVudFBhZ2UgPSAwO1xuICAgICAgICAkc2NvcGUubWF4UGFnZXMgPSAxNTtcbiAgICAgICAgJHNjb3BlLnNlYXJjaFRleHQgPSBcIlwiO1xuICAgICAgICAkc2NvcGUuZmlsdGVyZWRJdGVtcyA9IFtdO1xuICAgICAgICAkc2NvcGUucHJlZGljYXRlQXR0cmlidXRlID0gJ1BsYW50SWQnO1xuICAgICAgICAkc2NvcGUuc2hvd01lc3NhZ2UgPSBmYWxzZTtcbiAgICAgICAgJHNjb3BlLnByZWRpY2F0ZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgIHJldHVybiBpdGVtWyRzY29wZS5wcmVkaWNhdGVBdHRyaWJ1dGVdO1xuICAgICAgICB9XG4gICAgICAgICRzY29wZS5yZXZlcnNlID0gZmFsc2U7XG5cblxuXG4gICAgICAgICRzY29wZS5vcmRlciA9IGZ1bmN0aW9uKGF0dHJpYnV0ZSwgb3JkZXIpIHtcbiAgICAgICAgICAgICRzY29wZS5wcmVkaWNhdGVBdHRyaWJ1dGUgPSBhdHRyaWJ1dGU7XG4gICAgICAgICAgICAkc2NvcGUucmV2ZXJzZSA9IG9yZGVyO1xuICAgICAgICAgICAgJHNjb3BlLmZpbHRlcmVkSXRlbXMgPSBvcmRlckJ5KCRzY29wZS5maWx0ZXJlZEl0ZW1zLCAkc2NvcGUucHJlZGljYXRlLCAkc2NvcGUucmV2ZXJzZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLiRvbignaW5zdGFuY2VSZWFkeScsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XG5cbiAgICAgICAgICAgICRzY29wZS5maWx0ZXJlZEl0ZW1zID0gJHNjb3BlLmdldEZpbHRlcmVkSXRlbXMoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiRvbigndXBkYXRlRmlsdGVyJywgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcblxuICAgICAgICAgICAgJHNjb3BlLmZpbHRlcmVkSXRlbXMgPSAkc2NvcGUuZ2V0RmlsdGVyZWRJdGVtcygpO1xuICAgICAgICAgICAgJHNjb3BlLm9yZGVyKCRzY29wZS5wcmVkaWNhdGVBdHRyaWJ1dGUsICRzY29wZS5yZXZlcnNlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLnJhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoISRzY29wZS5pbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHJhbmdlU2l6ZSA9ICgkc2NvcGUucGFnZUNvdW50KCkgPj0gJHNjb3BlLk1heFBhZ2VzKT8gJHNjb3BlLk1heFBhZ2VzIDogJHNjb3BlLnBhZ2VDb3VudCgpKzE7XG4gICAgICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgICAgICB2YXIgc3RhcnQ7XG5cbiAgICAgICAgICAgIHN0YXJ0ID0gJHNjb3BlLmN1cnJlbnRQYWdlO1xuICAgICAgICAgICAgaWYgKCBzdGFydCA+ICRzY29wZS5wYWdlQ291bnQoKS1yYW5nZVNpemUgKSB7XG4gICAgICAgICAgICAgICAgc3RhcnQgPSAkc2NvcGUucGFnZUNvdW50KCktcmFuZ2VTaXplKzE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAodmFyIGk9c3RhcnQ7IGk8c3RhcnQrcmFuZ2VTaXplOyBpKyspIHtcbiAgICAgICAgICAgICAgICByZXQucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnByZXZQYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmN1cnJlbnRQYWdlID4gMCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50UGFnZS0tO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5wcmV2UGFnZURpc2FibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLmN1cnJlbnRQYWdlID09PSAwID8gXCJkaXNhYmxlZFwiIDogXCJcIjtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuZ2V0RmlsdGVyZWRJdGVtcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUuaW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJGZpbHRlcignZmlsdGVyJykoJHNjb3BlLmluc3RhbmNlLkxDUFF1ZXN0aW9ubmFpcmUuTGlzdE9mUGxhbnRzLlBsYW50LCAkc2NvcGUuc2VhcmNoVGV4dCk7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUucmVmcmVzaEl0ZW1zID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLy8vY29uc29sZS5sb2coXCJGaWx0ZXIgY2hhbmdlZC4gR2V0dGluZyBuZXcgaXRlbXMuLi5cIik7XG4gICAgICAgICAgICAkc2NvcGUuZmlsdGVyZWRJdGVtcyA9ICRzY29wZS5nZXRGaWx0ZXJlZEl0ZW1zKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCgnc2VhcmNoVGV4dCcsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICAgICAgLy8vL2NvbnNvbGUubG9nKFwiRmlsdGVyIGNoYW5nZWQuIEdldHRpbmcgbmV3IGl0ZW1zLi4uXCIpO1xuICAgICAgICAgICAgJHNjb3BlLmZpbHRlcmVkSXRlbXMgPSAkc2NvcGUuZ2V0RmlsdGVyZWRJdGVtcygpO1xuICAgICAgICAgICAgaWYobmV3VmFsdWUgIT0gb2xkVmFsdWUpe1xuICAgICAgICAgICAgICAgICRzY29wZS5zZXRQYWdlKDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUucGFnZUNvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoISRzY29wZS5pbnN0YW5jZSB8fCAhJHNjb3BlLmZpbHRlcmVkSXRlbXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBpdGVtcyA9ICRzY29wZS5maWx0ZXJlZEl0ZW1zO1xuICAgICAgICAgICAgdmFyIGNvdW50ID0gTWF0aC5jZWlsKGl0ZW1zLmxlbmd0aC8kc2NvcGUuaXRlbXNQZXJQYWdlKS0xO1xuICAgICAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5uZXh0UGFnZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5jdXJyZW50UGFnZSA8ICRzY29wZS5wYWdlQ291bnQoKSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50UGFnZSsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5uZXh0UGFnZURpc2FibGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLmN1cnJlbnRQYWdlID09PSAkc2NvcGUucGFnZUNvdW50KCkgPyBcImRpc2FibGVkXCIgOiBcIlwiO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5zZXRQYWdlID0gZnVuY3Rpb24obikge1xuICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRQYWdlID0gbjtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmRlbGV0ZVNlbGVjdGVkID0gZnVuY3Rpb24oc2VsZWN0ZWRJdGVtcyl7XG4gICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzZWxlY3RlZEl0ZW1zLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgaWYoc2VsZWN0ZWRJdGVtc1tpXS5EZWxldGUgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoc2VsZWN0ZWRJdGVtc1tpXS5EZWxldGUgPT0gdHJ1ZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGNvdW50Tm9uRW1wdHlQcm9wZXJ0aWVzKHNlbGVjdGVkSXRlbXNbaV0pID4gMCkgJiYgJHNjb3BlLnNob3dNZXNzYWdlID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoZSBzZWxlY3RlZCByb3dzPycpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dNZXNzYWdlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dNZXNzYWdlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlbW92ZSgkc2NvcGUuaW5zdGFuY2UuTENQUXVlc3Rpb25uYWlyZS5MaXN0T2ZQbGFudHMuUGxhbnQsIHNlbGVjdGVkSXRlbXNbaV0sIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuc2hvd01lc3NhZ2UgPSBmYWxzZTtcbiAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgndXBkYXRlRmlsdGVyJyk7XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLmVkaXQgPSBmdW5jdGlvbiAocGxhbnQsIG1vZGFsUGFnZUlkKSB7XG4gICAgICAgICAgICAvLyRyb290U2NvcGUuJGJyb2FkY2FzdCgnZWRpdFBsYW50JywgcGxhbnQpO1xuICAgICAgICAgICAgJHJvb3RTY29wZS5zZWxlY3RlZFBsYW50ID0gcGxhbnQ7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLm1vZGFsUGFnZUNhc2VJZCA9IG1vZGFsUGFnZUlkO1xuLypcbiAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJG1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnTGlzdE9mUGxhbnRNb2RhbENvbnRlbnQuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0xpc3RPZlBsYW50c01vZGFsSW5zdGFuY2VDdHJsJyxcbiAgICAgICAgICAgICAgICBzaXplOiAnbGcnLFxuICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgd2luZG93Q2xhc3M6ICdhcHAtbW9kYWwtd2luZG93JyxcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgIHBsYW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIHBsYW50O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAqL1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vb3JkZXJPYmplY3RCeSBwYWdpbmF0aW9uXG4gICAgICAgIC8vJHNjb3BlLnBsYW50T2JqZWN0cyA9ICRzY29wZS5pbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLkxpc3RPZlBsYW50cy5QbGFudDtcbiAgICAgICAgJHNjb3BlLmNyaXRlcmlhID0gJ1BsYW50TmFtZSc7XG4gICAgICAgICRzY29wZS5kaXJlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgJHNjb3BlLnNldENyaXRlcmlhID0gZnVuY3Rpb24oY3JpdGVyaWEpIHtcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY3JpdGVyaWEgPT09IGNyaXRlcmlhKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRpcmVjdGlvbiA9ICEkc2NvcGUuZGlyZWN0aW9uO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3JpdGVyaWEgPSBjcml0ZXJpYTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGlyZWN0aW9uICA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cblxuICAgIC8vIG5ldyBlbmRcblxuICAgIGZ1bmN0aW9uIGdldFdlYlFVcmwocGF0aCl7XG4gICAgICAgIHZhciB1cmwgPSBiYXNlVXJpICsgcGF0aDtcbiAgICAgICAgdXJsICs9IFwiP2ZpbGVJZD1cIiArIGZpbGVJZDtcbiAgICAgICAgaWYgKHNlc3Npb25JZCAmJiBzZXNzaW9uSWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgdXJsICs9IFwiJnNlc3Npb25pZD1cIiArIHNlc3Npb25JZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdXJsO1xuICAgIH1cbiAgICAvLyBoZWxwZXIgZnVuY3Rpb24gZm9yIGdldHRpbmcgcXVlcnkgc3RyaW5nIHBhcmFtZXRlciB2YWx1ZXMuIEFuZ3VsYXJKUyBzb2x1dGlvbiAkbG9jYXRpb24uc2VhcmNoKCkgZG9lc24ndCB3b3JrIGluIElFOC5cbiAgICBmdW5jdGlvbiBnZXRQYXJhbWV0ZXJCeU5hbWUobmFtZSkge1xuICAgICAgICB2YXIgc2VhcmNoQXJyID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zcGxpdCgnPycpO1xuICAgICAgICB2YXIgc2VhcmNoID0gJz8nICsgc2VhcmNoQXJyW3NlYXJjaEFyci5sZW5ndGggLSAxXTtcbiAgICAgICAgdmFyIG1hdGNoID0gbmV3IFJlZ0V4cCgnWz8mXScgKyBuYW1lICsgJz0oW14mXSopJykuZXhlYyhzZWFyY2gpO1xuICAgICAgICByZXR1cm4gbWF0Y2ggJiYgZGVjb2RlVVJJQ29tcG9uZW50KG1hdGNoWzFdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gZ2V0SGFuZHNvbnRhYmxlQ29sSGVhZGVycyhmb3JtKSB7XG4gICAgICAgIGlmIChmb3JtID09ICdMaXN0T2ZQbGFudHMnKXtcbiAgICAgICAgICAgIHJldHVybiBbXCJQbGFudCBOYW1lXCIsIFwiUGxhbnQgSWRcIiwgXCJFLVBSVFIgbmF0aW9uYWwgSURcIiwgXCJTdHJlZXQgTmFtZSBcIiwgXCJDaXR5XCIsIFwiUmVnaW9uXCIsIFwiUG9zdGFsIGNvZGVcIixcIkNvdW50cnkgQ29kZVwiLFwiQnVpbGRpbmcgTnVtYmVyXCIsIFwiTG9uZ2l0dWRlXCIsIFwiTGF0aXR1ZGVcIiwgXCJGYWNpbGl0eSBuYW1lXCIsIFwiQ29tbWVudHNcIl1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChmb3JtID09ICdQbGFudERldGFpbHMnKXtcbiAgICAgICAgICAgIHJldHVybiBbXCJQbGFudCBuYW1lXCIsIFwiUGxhbnQgSURcIiwgXCJNV3RoXCIsXCJUeXBlIG9mIENvbWJ1c3Rpb24gUGxhbnRcIiwgXCJEYXRlIG9mIHN0YXJ0IG9mIG9wZXJhdGlvblwiLCBcIlJlZmluZXJpZXNcIiwgIFwiT3RoZXIgU2VjdG9yXCIsIFwiT3BlcmF0aW5nIEhvdXJzXCIsIFwiRGVyb2dhdGlvblwiLCBcIkNvbW1lbnRzXCJdXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZm9ybSA9PSAnRW5lcmd5SW5wdXQnKXtcbiAgICAgICAgICAgIHJldHVybiBbXCJQbGFudCBuYW1lXCIsIFwiUGxhbnQgSURcIiwgXCJCaW9tYXNzIChUSilcIixcIkNvYWxcIixcIkxpZ25pdGVcIixcIlBlYXRcIiwgXCJPdGhlciBzb2xpZCBmdWVscyAoVEopIENhdGVnb3J5XCIsXCJPdGhlciBzb2xpZCBmdWVscyAoVEopIFZhbHVlXCIgLCBcIkxpcXVpZCBmdWVscyAoVEopXCIsIFwiTmF0dXJhbCBnYXMgKFRKKVwiLCBcIk90aGVyIGdhc2VzIChUSikgQ2F0ZWdvcnlcIixcIk90aGVyIGdhc2VzIChUSikgVmFsdWVcIiwgXCJTTzIgKHQpXCIsIFwiTk94ICh0KVwiLCBcIkR1c3QgKHQpXCJdXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZm9ybSA9PSAnVG90YWxFbWlzc2lvbnNUb0Fpcicpe1xuICAgICAgICAgICAgcmV0dXJuIFtcIlBsYW50IG5hbWVcIiwgXCJQbGFudCBJRFwiLCBcIlNPMiAodClcIiwgXCJOT3ggKHQpXCIsIFwiVFNQICh0KVwiXVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGZvcm0gPT0gJ0Rlc3VscGh1cmlzYXRpb24nKXtcbiAgICAgICAgICAgIHJldHVybiBbXCJEZXN1bHBodXJpc2F0aW9uIFJhdGVcIiwgXCJTdWxwaHVyIENvbnRlbnRcIiwgXCJUZWNobmljYWwgSnVzdGlmaWNhdGlvblwiLCBcIk1vbnRoXCJdXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZm9ybSA9PSAnVXNlZnVsSGVhdCcpe1xuICAgICAgICAgICAgcmV0dXJuIFtcIlBsYW50IG5hbWVcIiwgXCJQbGFudCBJRFwiLFwiVXNlZnVsSGVhdCBQcm9wb3J0aW9uXCJdXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL2RlZmF1bHQgaXMgdGhlIGZpcnN0IHRhYmxlXG4gICAgICAgICAgICByZXR1cm4gW1wiUGxhbnQgTmFtZVwiLCBcIlBsYW50IElkXCIsIFwiRS1QUlRSIG5hdGlvbmFsIElEXCIsIFwiQWRkcmVzcyAxXCIsIFwiQWRkcmVzcyAyXCIsIFwiQ2l0eVwiLCBcIlJlZ2lvblwiLCBcIlBvc3RhbCBjb2RlXCIsIFwiTG9uZ2l0dWRlXCIsIFwiTGF0aXR1ZGVcIiwgXCJGYWNpbGl0eSBuYW1lXCJdXG4gICAgICAgIH1cbiAgICB9XG5cdGFwcC5kaXJlY3RpdmUoJ3VpSGFuZHNvbnRhYmxlJywgZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4ge1xuXHRcdHJlc3RyaWN0OiAnQScsXG5cdFx0c2NvcGU6IHtcblx0XHRcdGRhdGE6ICc9JyxcbiAgICAgICAgICAgIHN0YXR1czogJz0nLFxuICAgICAgICAgICAgZm9ybW5hbWU6ICc9J1xuXHRcdH0sXG5cdFx0cmVwbGFjZTogdHJ1ZSxcblx0XHRsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHJzKSB7XG4gICAgICAgICAgICBzY29wZS4kd2F0Y2goJ3N0YXR1cycsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCd3YXRjaDonICsgbmV3VmFsdWUgKyAnOyBmb3JtPScgKyBzY29wZS5mb3JtbmFtZSk7XG4gICAgICAgICAgICAgICAgaWYobmV3VmFsdWUgPT0gdHJ1ZSAmJiBhbmd1bGFyLmlzQXJyYXkoc2NvcGUuZGF0YSkpe1xuICAgICAgICAgICAgICAgICAgICBlbGVtLmhhbmRzb250YWJsZSgnbG9hZERhdGEnLCBzY29wZS5kYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coc2NvcGUuZm9ybW5hbWUpO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBzY29wZS5kYXRhO1xuICAgICAgICAgICAgdmFyIGZvcm1uYW1lID0gc2NvcGUuZm9ybW5hbWU7XG4gICAgICAgICAgICB2YXIgY29udGFpbmVyID0gZWxlbTtcblxuICAgICAgICAgICAgZWxlbS5oYW5kc29udGFibGUoe1xuXHRcdFx0ICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRNZW51OmZhbHNlLC8vIFsncm93X2Fib3ZlJywgJ3Jvd19iZWxvdycsICdyZW1vdmVfcm93J10sXG5cdFx0XHRcdHJvd0hlYWRlcnM6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNvbHVtblNvcnRpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHN0cmV0Y2hIOiAnYWxsJyxcbiAgICAgICAgICAgICAgICBmaXhlZENvbHVtbnNMZWZ0OiAyLFxuICAgICAgICAgICAgICAgIG1pblNwYXJlUm93czogMCwgLy8gZm9ybW5hbWUgPT09ICdMaXN0T2ZQbGFudHMnID8gMSA6IDAsXG4gICAgICAgICAgICAvLyAgICBtaW5Sb3dzOjAsXG4gICAgICAgICAgICAgICAgbWluU3BhcmVDb2xzOiAwLFxuICAgICAgICAgICAgICAgIC8vbWF4Um93czogZm9ybW5hbWUgPT09ICdMaXN0T2ZQbGFudHMnID8gMjAwIDogZGF0YS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgLy9tYXhDb2xzOiBkYXRhLm51bWJlck9mQ29sdW1ucyxcbiAgICAgICAgICAgICAgICBjb2xIZWFkZXJzOiBnZXRIYW5kc29udGFibGVDb2xIZWFkZXJzKGZvcm1uYW1lKSxcbiAgICAgIC8qKiAgICAgICAgICBtb2RpZnlSb3c6IGZ1bmN0aW9uKHJvdyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBodCA9IGNvbnRhaW5lci5oYW5kc29udGFibGUoJ2dldEluc3RhbmNlJyk7XG4gICAgICAgICAgICAgICAgIC8vICAgdmFyIHJvd3NOZWVkZWQgPSBkYXRhLmxlbmd0aCAtIGh0LmNvdW50RW1wdHlSb3dzKCk7XG4gICAgICAgICAgICAgICAvLyAgICAgY29uc29sZS5sb2coJ3Jvd0luZGV4Oicrcm93KTtcbiAgICAgICAgICAgICAgIGlmKHJvdyE9MCl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5nZXREYXRhKHJvdyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicm93RGF0YVwiK2RhdGEpO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgLy8gIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCByb3dzTmVlZGVkOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAvLyAgZWxlbS5oYW5kc29udGFibGUoJ2FsdGVyJywgJ2luc2VydF9yb3cnKTtcbiAgICAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICoqL1xuICAgICAgICAgICAgICAgIGNvbHVtbnM6XG4gICAgICAgICAgICAgICAgICAgICAgICAoZm9ybW5hbWUgPT09ICdMaXN0T2ZQbGFudHMnID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIlBsYW50TmFtZVwifSwge2RhdGE6IFwiUGxhbnRJZFwifSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRVBSVFJOYXRpb25hbElkXCJ9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJQbGFudExvY2F0aW9uLlN0cmVldE5hbWVcIn0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiUGxhbnRMb2NhdGlvbi5DaXR5XCJ9LCB7ZGF0YTogXCJQbGFudExvY2F0aW9uLlJlZ2lvblwifSwge2RhdGE6IFwiUGxhbnRMb2NhdGlvbi5Qb3N0YWxDb2RlXCJ9LHtkYXRhOiBcIlBsYW50TG9jYXRpb24uQ291bnRyeUNvZGVcIn0se2RhdGE6IFwiUGxhbnRMb2NhdGlvbi5CdWlsZGluZ051bWJlclwifSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiR2VvZ3JhcGhpY2FsQ29vcmRpbmF0ZS5Mb25naXR1ZGVcIiwgdHlwZTogJ251bWVyaWMnLCBmb3JtYXQ6ICcwLlswMDAwMF0nfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIkdlb2dyYXBoaWNhbENvb3JkaW5hdGUuTGF0aXR1ZGVcIiwgdHlwZTogJ251bWVyaWMnLCBmb3JtYXQ6ICcwLlswMDAwMF0nfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRmFjaWxpdHlOYW1lXCJ9LHtkYXRhOiBcIkNvbW1lbnRzXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICA6IGZvcm1uYW1lID09ICdQbGFudERldGFpbHMnID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIlBsYW50TmFtZVwiLCByZWFkT25seTogdHJ1ZX0sIHtkYXRhOiBcIlBsYW50SWRcIiwgcmVhZE9ubHk6IHRydWV9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJQbGFudERldGFpbHMuTVd0aFwifSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiUGxhbnREZXRhaWxzLlR5cGVPZkNvbWJ1c3Rpb25QbGFudFwifSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiUGxhbnREZXRhaWxzLkRhdGVPZlN0YXJ0T2ZPcGVyYXRpb25cIn0sICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiUGxhbnREZXRhaWxzLlJlZmluZXJpZXNcIiwgdHlwZTogJ2NoZWNrYm94J30sIHtkYXRhOiBcIlBsYW50RGV0YWlscy5PdGhlclNlY3RvclwiLCB0eXBlOiAnZHJvcGRvd24nLCBzb3VyY2U6IFt7aXJvbl9zdGVlbDpcImlyb25fc3RlZWxcIn0sIFwiZXNpXCIsIFwiZGlzdHJpY3RfaGVhdGluZ1wiLCBcImNocFwiLCBcIm90aGVyXCJdfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiUGxhbnREZXRhaWxzLk9wZXJhdGluZ0hvdXJzXCIsIHR5cGU6ICdudW1lcmljJ30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIlBsYW50RGV0YWlscy5EZXJvZ2F0aW9uXCJ9LCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIlBsYW50RGV0YWlscy5Db21tZW50c1wifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICA6IGZvcm1uYW1lID09ICdFbmVyZ3lJbnB1dCcgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiUGxhbnROYW1lXCIsIHJlYWRPbmx5OiB0cnVlfSwge2RhdGE6IFwiUGxhbnRJZFwiLCByZWFkT25seTogdHJ1ZX0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5CaW9tYXNzXCIsIHR5cGU6ICdudW1lcmljJywgZm9ybWF0OiAnMC5bMDAwMDBdJ30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5Db2FsXCIsIHR5cGU6ICdudW1lcmljJywgZm9ybWF0OiAnMC5bMDAwMDBdJ30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5MaWduaXRlXCIsIHR5cGU6ICdudW1lcmljJywgZm9ybWF0OiAnMC5bMDAwMDBdJ30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5QZWF0XCIsIHR5cGU6ICdudW1lcmljJywgZm9ybWF0OiAnMC5bMDAwMDBdJ30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5PdGhlclNvbGlkRnVlbHMuQ2F0ZWdvcnlcIn0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5PdGhlclNvbGlkRnVlbHMuVmFsdWVcIiwgdHlwZTogJ251bWVyaWMnLCBmb3JtYXQ6ICcwLlswMDAwMF0nfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLkVuZXJneUlucHV0LkxpcXVpZEZ1ZWxzXCIsIHR5cGU6ICdudW1lcmljJywgZm9ybWF0OiAnMC5bMDAwMDBdJ30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5OYXR1cmFsR2FzXCIsIHR5cGU6ICdudW1lcmljJywgZm9ybWF0OiAnMC5bMDAwMDBdJ30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5FbmVyZ3lJbnB1dC5PdGhlckdhc2VzLkNhdGVnb3J5XCJ9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJFbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuRW5lcmd5SW5wdXQuT3RoZXJHYXNlcy5WYWx1ZVwiLCB0eXBlOiAnbnVtZXJpYycsIGZvcm1hdDogJzAuWzAwMDAwXSd9LFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICA6IGZvcm1uYW1lID09ICdUb3RhbEVtaXNzaW9uc1RvQWlyJyA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJQbGFudE5hbWVcIiwgcmVhZE9ubHk6IHRydWV9LCB7ZGF0YTogXCJQbGFudElkXCIsIHJlYWRPbmx5OiB0cnVlfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRW5lcmd5SW5wdXRBbmRUb3RhbEVtaXNzaW9uc1RvQWlyLlRvdGFsRW1pc3Npb25zVG9BaXIuU08yXCIsIHR5cGU6ICdudW1lcmljJywgZm9ybWF0OiAnMC5bMDAwMDBdJ30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIkVuZXJneUlucHV0QW5kVG90YWxFbWlzc2lvbnNUb0Fpci5Ub3RhbEVtaXNzaW9uc1RvQWlyLk5PeFwiLCB0eXBlOiAnbnVtZXJpYycsIGZvcm1hdDogJzAuWzAwMDAwXSd9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJFbmVyZ3lJbnB1dEFuZFRvdGFsRW1pc3Npb25zVG9BaXIuVG90YWxFbWlzc2lvbnNUb0Fpci5UU1BcIiwgdHlwZTogJ251bWVyaWMnLCBmb3JtYXQ6ICcwLlswMDAwMF0nfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgOiBmb3JtbmFtZSA9PSAnRGVzdWxwaHVyaXNhdGlvbicgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJQbGFudE5hbWVcIiwgcmVhZE9ubHk6IHRydWV9LCB7ZGF0YTogXCJQbGFudElkXCIsIHJlYWRPbmx5OiB0cnVlfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2RhdGE6IFwiRGVzdWxwaHVyaXNhdGlvbi5EZXN1bHBodXJpc2F0aW9uUmF0ZVwiLCB0eXBlOiAnbnVtZXJpYycsIGZvcm1hdDogJzAuWzAwMDAwXSd9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJEZXN1bHBodXJpc2F0aW9uLlN1bHBodXJDb250ZW50XCIsIHR5cGU6ICdudW1lcmljJywgZm9ybWF0OiAnMC5bMDAwMDBdJ30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIkRlc3VscGh1cmlzYXRpb24uVGVjaG5pY2FsSnVzdGlmaWNhdGlvblwiIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIDogZm9ybW5hbWUgPT0gJ1VzZWZ1bEhlYXQnID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtkYXRhOiBcIlBsYW50TmFtZVwiLCByZWFkT25seTogdHJ1ZX0sIHtkYXRhOiBcIlBsYW50SWRcIiwgcmVhZE9ubHk6IHRydWV9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGF0YTogXCJVc2VmdWxIZWF0LlVzZWZ1bEhlYXRQcm9wb3J0aW9uXCIsIHR5cGU6ICdudW1lcmljJywgZm9ybWF0OiAnMC5bMDAwMDBdJ30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICA6W10pLFxuICAgICAgICAgICAgICAgICAgICBvblNlbGVjdGlvbjogZnVuY3Rpb24gKHJvdywgY29sLCByb3cyLCBjb2wyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWV0YSA9IGNvbnRhaW5lci5oYW5kc29udGFibGUoJ2dldENlbGxNZXRhJywgcm93MiwgY29sMik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWV0YS5yZWFkT25seSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5oYW5kc29udGFibGUoJ3VwZGF0ZVNldHRpbmdzJywge2ZpbGxIYW5kbGU6IGZhbHNlfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuaGFuZHNvbnRhYmxlKCd1cGRhdGVTZXR0aW5ncycsIHtmaWxsSGFuZGxlOiB0cnVlfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY2VsbHM6IGZ1bmN0aW9uIChyb3csIGNvbCwgcHJvcCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2VsbFByb3BlcnRpZXMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmRpdGlvbmFsUmVhZG9ubHlGaWVsZHMuaW5kZXhPZihwcm9wKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyID0gbnVtZXJpY0NvbmRpdGlvbmFscmVhZE9ubHlSZW5kZXJlcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2VsbFByb3BlcnRpZXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cdH1cbn0pO1xuICAgIHZhciBjb25kaXRpb25hbFJlYWRvbmx5RmllbGRzID0gW1wiUGxhbnREZXRhaWxzLkNhcGFjaXR5QWRkZWRNV1wiLCBcIlBsYW50RGV0YWlscy5DYXBhY2l0eUFmZmVjdGVkTVdcIiwgXCJQbGFudERldGFpbHMuT3RoZXJTZWN0b3JcIiwgXCJQbGFudERldGFpbHMuR2FzVHVyYmluZVRoZXJtYWxJbnB1dFwiLFxuICAgICAgICBcIlBsYW50RGV0YWlscy5Cb2lsZXJUaGVybWFsSW5wdXRcIiwgXCJQbGFudERldGFpbHMuR2FzRW5naW5lVGhlcm1hbElucHV0XCIsIFwiUGxhbnREZXRhaWxzLkRpZXNlbEVuZ2luZVR1cmJpbmVUaGVybWFsSW5wdXRcIiwgXCJQbGFudERldGFpbHMuRGllc2VsRW5naW5lVHVyYmluZVRoZXJtYWxJbnB1dFwiLFxuICAgICAgICBcIlBsYW50RGV0YWlscy5PdGhlclR5cGVPZkNvbWJ1c3Rpb25cIiwgXCJQbGFudERldGFpbHMuT3RoZXJUaGVybWFsSW5wdXRcIixcbiAgICAgICAgXCJPcHRPdXRzQW5kTkVSUC5DYXBhY2l0eU9wdGVkT3V0TVdcIiwgXCJPcHRPdXRzQW5kTkVSUC5Ib3Vyc09wZXJhdGVkXCIsXG4gICAgICAgIFwiTGNwQXJ0MTUuT3BlcmF0aW5nSG91cnNcIiwgXCJMY3BBcnQxNS5FbHZTTzJcIixcbiAgICAgICAgXCJMY3BBcnQxNS5Ob3RhQmVuZUVsdlNPMlwiLCBcIkxjcEFydDE1LkRlc3VscGh1cmlzYXRpb25SYXRlXCIsIFwiTGNwQXJ0MTUuU0lucHV0XCIsXG4gICAgICAgIFwiTGNwQXJ0MTUuQW5uZXhWSV9BX0Zvb3Rub3RlMl9PcGVyYXRpbmdIb3Vyc1wiLCBcIkxjcEFydDE1LkVsdk5PeFwiLFxuICAgICAgICBcIkxjcEFydDE1LlZvbGF0aWxlQ29udGVudHNcIiwgXCJMY3BBcnQxNS5Bbm5leFZJX0FfRm9vdG5vdGUzX0Vsdk5PeFwiXVxuICAgIGZ1bmN0aW9uIG51bWVyaWNDb25kaXRpb25hbHJlYWRPbmx5UmVuZGVyZXIoaW5zdGFuY2UsIHRkLCByb3csIGNvbCwgcHJvcCwgdmFsdWUsIGNlbGxQcm9wZXJ0aWVzKSB7XG5cbiAgICAgICAgaWYgKHByb3AgPT09IFwiUGxhbnREZXRhaWxzLk90aGVyVHlwZU9mQ29tYnVzdGlvblwiKSB7XG4gICAgICAgICAgICBIYW5kc29udGFibGUucmVuZGVyZXJzLlRleHRSZW5kZXJlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHByb3AgPT09IFwiUGxhbnREZXRhaWxzLk90aGVyU2VjdG9yXCIpIHtcbiAgICAgICAgICAgIEhhbmRzb250YWJsZS5yZW5kZXJlcnMuQXV0b2NvbXBsZXRlUmVuZGVyZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIEhhbmRzb250YWJsZS5yZW5kZXJlcnMuTnVtZXJpY1JlbmRlcmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvbEluZGV4ID0gKFxuICAgICAgICAgICAgICAgIChwcm9wID09PSBcIlBsYW50RGV0YWlscy5PdGhlclRoZXJtYWxJbnB1dFwiIHx8IHByb3AgPT09ICBcIk9wdE91dHNBbmRORVJQLkhvdXJzT3BlcmF0ZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBwcm9wID09PSBcIkxjcEFydDE1LkVsdlNPMlwiIHx8IHByb3AgPT09ICBcIkxjcEFydDE1LkRlc3VscGh1cmlzYXRpb25SYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgcHJvcCA9PT0gXCJMY3BBcnQxNS5FbHZOT3hcIiB8fCBwcm9wID09PSAgXCJMY3BBcnQxNS5Bbm5leFZJX0FfRm9vdG5vdGUzX0Vsdk5PeFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGNvbCAtIDIgOiAocHJvcCA9PT0gXCJMY3BBcnQxNS5TSW5wdXRcIikgPyBjb2wgLSAzIDogY29sIC0gMSk7XG4gICAgICAgIHZhciBib29sZWFuVmFsdWUgPSBwcm9wID09PSBcIlBsYW50RGV0YWlscy5PdGhlclNlY3RvclwiID8gZmFsc2UgOiB0cnVlO1xuICAgICAgICB2YXIgY2hlY2tib3hWYWx1ZSA9IGluc3RhbmNlLmdldERhdGFBdENlbGwocm93LCBjb2xJbmRleCkgPT09IG51bGwgfHwgaW5zdGFuY2UuZ2V0RGF0YUF0Q2VsbChyb3csIGNvbEluZGV4KSA9PT0gJycgPyBmYWxzZSA6IGluc3RhbmNlLmdldERhdGFBdENlbGwocm93LCBjb2xJbmRleCk7XG4gICAgICAgIGlmIChjaGVja2JveFZhbHVlICE9IGJvb2xlYW5WYWx1ZSApIHtcbiAgICAgICAgICAgIGNlbGxQcm9wZXJ0aWVzLnJlYWRPbmx5ID0gdHJ1ZTtcbiAgICAgICAgICAgIHRkLnN0eWxlLmJhY2tncm91bmQgPSAnI0VFRSc7XG4gICAgICAgIH1cbiAgICB9XG4gIiwiLypcbiAqIGFuZ3VsYXItZWxhc3RpYyB2Mi4zLjNcbiAqIChjKSAyMDE0IE1vbm9zcGFjZWQgaHR0cDovL21vbm9zcGFjZWQuY29tXG4gKiBMaWNlbnNlOiBNSVRcbiAqL1xuXG5hbmd1bGFyLm1vZHVsZSgnbW9ub3NwYWNlZC5lbGFzdGljJywgW10pXG5cbiAgLmNvbnN0YW50KCdtc2RFbGFzdGljQ29uZmlnJywge1xuICAgIGFwcGVuZDogJydcbiAgfSlcblxuICAuZGlyZWN0aXZlKCdtc2RFbGFzdGljJywgWyckdGltZW91dCcsICckd2luZG93JywgJ21zZEVsYXN0aWNDb25maWcnLCBmdW5jdGlvbigkdGltZW91dCwgJHdpbmRvdywgY29uZmlnKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcbiAgICAgIHJlc3RyaWN0OiAnQSwgQycsXG4gICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcblxuICAgICAgICAvLyBjYWNoZSBhIHJlZmVyZW5jZSB0byB0aGUgRE9NIGVsZW1lbnRcbiAgICAgICAgdmFyIHRhID0gZWxlbWVudFswXSxcbiAgICAgICAgICAgICR0YSA9IGVsZW1lbnQ7XG5cbiAgICAgICAgLy8gZW5zdXJlIHRoZSBlbGVtZW50IGlzIGEgdGV4dGFyZWEsIGFuZCBicm93c2VyIGlzIGNhcGFibGVcbiAgICAgICAgaWYgKHRhLm5vZGVOYW1lICE9PSAnVEVYVEFSRUEnIHx8ICEkd2luZG93LmdldENvbXB1dGVkU3R5bGUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzZXQgdGhlc2UgcHJvcGVydGllcyBiZWZvcmUgbWVhc3VyaW5nIGRpbWVuc2lvbnNcbiAgICAgICAgJHRhLmNzcyh7XG4gICAgICAgICAgJ292ZXJmbG93JzogJ2hpZGRlbicsXG4gICAgICAgICAgJ292ZXJmbG93LXknOiAnaGlkZGVuJyxcbiAgICAgICAgICAnd29yZC13cmFwJzogJ2JyZWFrLXdvcmQnXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGZvcmNlIHRleHQgcmVmbG93XG4gICAgICAgIHZhciB0ZXh0ID0gdGEudmFsdWU7XG4gICAgICAgIHRhLnZhbHVlID0gJyc7XG4gICAgICAgIHRhLnZhbHVlID0gdGV4dDtcblxuICAgICAgICB2YXIgYXBwZW5kVGV4dCA9IGF0dHJzLm1zZEVsYXN0aWMgfHwgY29uZmlnLmFwcGVuZCxcbiAgICAgICAgICAgIGFwcGVuZCA9IGFwcGVuZFRleHQgPT09ICdcXFxcbicgPyAnXFxuJyA6IGFwcGVuZFRleHQsXG4gICAgICAgICAgICAkd2luID0gYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLFxuICAgICAgICAgICAgbWlycm9yU3R5bGUgPSAncG9zaXRpb246IGFic29sdXRlOyB0b3A6IC05OTlweDsgcmlnaHQ6IGF1dG87IGJvdHRvbTogYXV0bzsgbGVmdDogMCA7JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdvdmVyZmxvdzogaGlkZGVuOyAtd2Via2l0LWJveC1zaXppbmc6IGNvbnRlbnQtYm94OycgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnLW1vei1ib3gtc2l6aW5nOiBjb250ZW50LWJveDsgYm94LXNpemluZzogY29udGVudC1ib3g7JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdtaW4taGVpZ2h0OiAwICFpbXBvcnRhbnQ7IGhlaWdodDogMCAhaW1wb3J0YW50OyBwYWRkaW5nOiAwOycgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnd29yZC13cmFwOiBicmVhay13b3JkOyBib3JkZXI6IDA7JyxcbiAgICAgICAgICAgICRtaXJyb3IgPSBhbmd1bGFyLmVsZW1lbnQoJzx0ZXh0YXJlYSB0YWJpbmRleD1cIi0xXCIgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzdHlsZT1cIicgKyBtaXJyb3JTdHlsZSArICdcIi8+JykuZGF0YSgnZWxhc3RpYycsIHRydWUpLFxuICAgICAgICAgICAgbWlycm9yID0gJG1pcnJvclswXSxcbiAgICAgICAgICAgIHRhU3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKHRhKSxcbiAgICAgICAgICAgIHJlc2l6ZSA9IHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncmVzaXplJyksXG4gICAgICAgICAgICBib3JkZXJCb3ggPSB0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ2JveC1zaXppbmcnKSA9PT0gJ2JvcmRlci1ib3gnIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICB0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy1tb3otYm94LXNpemluZycpID09PSAnYm9yZGVyLWJveCcgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLXdlYmtpdC1ib3gtc2l6aW5nJykgPT09ICdib3JkZXItYm94JyxcbiAgICAgICAgICAgIGJveE91dGVyID0gIWJvcmRlckJveCA/IHt3aWR0aDogMCwgaGVpZ2h0OiAwfSA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ2JvcmRlci1yaWdodC13aWR0aCcpLCAxMCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy1yaWdodCcpLCAxMCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy1sZWZ0JyksIDEwKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdib3JkZXItbGVmdC13aWR0aCcpLCAxMCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdib3JkZXItdG9wLXdpZHRoJyksIDEwKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdwYWRkaW5nLXRvcCcpLCAxMCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy1ib3R0b20nKSwgMTApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ2JvcmRlci1ib3R0b20td2lkdGgnKSwgMTApXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgbWluSGVpZ2h0VmFsdWUgPSBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ21pbi1oZWlnaHQnKSwgMTApLFxuICAgICAgICAgICAgaGVpZ2h0VmFsdWUgPSBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ2hlaWdodCcpLCAxMCksXG4gICAgICAgICAgICBtaW5IZWlnaHQgPSBNYXRoLm1heChtaW5IZWlnaHRWYWx1ZSwgaGVpZ2h0VmFsdWUpIC0gYm94T3V0ZXIuaGVpZ2h0LFxuICAgICAgICAgICAgbWF4SGVpZ2h0ID0gcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdtYXgtaGVpZ2h0JyksIDEwKSxcbiAgICAgICAgICAgIG1pcnJvcmVkLFxuICAgICAgICAgICAgYWN0aXZlLFxuICAgICAgICAgICAgY29weVN0eWxlID0gWydmb250LWZhbWlseScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgJ2ZvbnQtc2l6ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgJ2ZvbnQtd2VpZ2h0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAnZm9udC1zdHlsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgJ2xldHRlci1zcGFjaW5nJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAnbGluZS1oZWlnaHQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICd0ZXh0LXRyYW5zZm9ybScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgJ3dvcmQtc3BhY2luZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgJ3RleHQtaW5kZW50J107XG5cbiAgICAgICAgLy8gZXhpdCBpZiBlbGFzdGljIGFscmVhZHkgYXBwbGllZCAob3IgaXMgdGhlIG1pcnJvciBlbGVtZW50KVxuICAgICAgICBpZiAoJHRhLmRhdGEoJ2VsYXN0aWMnKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE9wZXJhIHJldHVybnMgbWF4LWhlaWdodCBvZiAtMSBpZiBub3Qgc2V0XG4gICAgICAgIG1heEhlaWdodCA9IG1heEhlaWdodCAmJiBtYXhIZWlnaHQgPiAwID8gbWF4SGVpZ2h0IDogOWU0O1xuXG4gICAgICAgIC8vIGFwcGVuZCBtaXJyb3IgdG8gdGhlIERPTVxuICAgICAgICBpZiAobWlycm9yLnBhcmVudE5vZGUgIT09IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSkuYXBwZW5kKG1pcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzZXQgcmVzaXplIGFuZCBhcHBseSBlbGFzdGljXG4gICAgICAgICR0YS5jc3Moe1xuICAgICAgICAgICdyZXNpemUnOiAocmVzaXplID09PSAnbm9uZScgfHwgcmVzaXplID09PSAndmVydGljYWwnKSA/ICdub25lJyA6ICdob3Jpem9udGFsJ1xuICAgICAgICB9KS5kYXRhKCdlbGFzdGljJywgdHJ1ZSk7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogbWV0aG9kc1xuICAgICAgICAgKi9cblxuICAgICAgICBmdW5jdGlvbiBpbml0TWlycm9yKCkge1xuICAgICAgICAgIG1pcnJvcmVkID0gdGE7XG4gICAgICAgICAgLy8gY29weSB0aGUgZXNzZW50aWFsIHN0eWxlcyBmcm9tIHRoZSB0ZXh0YXJlYSB0byB0aGUgbWlycm9yXG4gICAgICAgICAgdGFTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUodGEpO1xuICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChjb3B5U3R5bGUsIGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgICAgbWlycm9yU3R5bGUgKz0gdmFsICsgJzonICsgdGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKHZhbCkgKyAnOyc7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgbWlycm9yLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBtaXJyb3JTdHlsZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBhZGp1c3QoKSB7XG4gICAgICAgICAgdmFyIHRhSGVpZ2h0LFxuICAgICAgICAgICAgICBtaXJyb3JIZWlnaHQsXG4gICAgICAgICAgICAgIHdpZHRoLFxuICAgICAgICAgICAgICBvdmVyZmxvdztcblxuICAgICAgICAgIGlmIChtaXJyb3JlZCAhPT0gdGEpIHtcbiAgICAgICAgICAgIGluaXRNaXJyb3IoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBhY3RpdmUgZmxhZyBwcmV2ZW50cyBhY3Rpb25zIGluIGZ1bmN0aW9uIGZyb20gY2FsbGluZyBhZGp1c3QgYWdhaW5cbiAgICAgICAgICBpZiAoIWFjdGl2ZSkge1xuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICAgICAgbWlycm9yLnZhbHVlID0gdGEudmFsdWUgKyBhcHBlbmQ7IC8vIG9wdGlvbmFsIHdoaXRlc3BhY2UgdG8gaW1wcm92ZSBhbmltYXRpb25cbiAgICAgICAgICAgIG1pcnJvci5zdHlsZS5vdmVyZmxvd1kgPSB0YS5zdHlsZS5vdmVyZmxvd1k7XG5cbiAgICAgICAgICAgIHRhSGVpZ2h0ID0gdGEuc3R5bGUuaGVpZ2h0ID09PSAnJyA/ICdhdXRvJyA6IHBhcnNlSW50KHRhLnN0eWxlLmhlaWdodCwgMTApO1xuXG4gICAgICAgICAgICAvLyB1cGRhdGUgbWlycm9yIHdpZHRoIGluIGNhc2UgdGhlIHRleHRhcmVhIHdpZHRoIGhhcyBjaGFuZ2VkXG4gICAgICAgICAgICB3aWR0aCA9IHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUodGEpLmdldFByb3BlcnR5VmFsdWUoJ3dpZHRoJyksIDEwKSAtIGJveE91dGVyLndpZHRoO1xuICAgICAgICAgICAgbWlycm9yLnN0eWxlLndpZHRoID0gd2lkdGggKyAncHgnO1xuXG4gICAgICAgICAgICBtaXJyb3JIZWlnaHQgPSBtaXJyb3Iuc2Nyb2xsSGVpZ2h0O1xuXG4gICAgICAgICAgICBpZiAobWlycm9ySGVpZ2h0ID4gbWF4SGVpZ2h0KSB7XG4gICAgICAgICAgICAgIG1pcnJvckhlaWdodCA9IG1heEhlaWdodDtcbiAgICAgICAgICAgICAgb3ZlcmZsb3cgPSAnc2Nyb2xsJztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWlycm9ySGVpZ2h0IDwgbWluSGVpZ2h0KSB7XG4gICAgICAgICAgICAgIG1pcnJvckhlaWdodCA9IG1pbkhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1pcnJvckhlaWdodCArPSBib3hPdXRlci5oZWlnaHQ7XG5cbiAgICAgICAgICAgIHRhLnN0eWxlLm92ZXJmbG93WSA9IG92ZXJmbG93IHx8ICdoaWRkZW4nO1xuXG4gICAgICAgICAgICBpZiAodGFIZWlnaHQgIT09IG1pcnJvckhlaWdodCkge1xuICAgICAgICAgICAgICB0YS5zdHlsZS5oZWlnaHQgPSBtaXJyb3JIZWlnaHQgKyAncHgnO1xuICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnZWxhc3RpYzpyZXNpemUnLCAkdGEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBzbWFsbCBkZWxheSB0byBwcmV2ZW50IGFuIGluZmluaXRlIGxvb3BcbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBhY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH0sIDEpO1xuXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZm9yY2VBZGp1c3QoKSB7XG4gICAgICAgICAgYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgYWRqdXN0KCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKlxuICAgICAgICAgKiBpbml0aWFsaXNlXG4gICAgICAgICAqL1xuXG4gICAgICAgIC8vIGxpc3RlblxuICAgICAgICBpZiAoJ29ucHJvcGVydHljaGFuZ2UnIGluIHRhICYmICdvbmlucHV0JyBpbiB0YSkge1xuICAgICAgICAgIC8vIElFOVxuICAgICAgICAgIHRhWydvbmlucHV0J10gPSB0YS5vbmtleXVwID0gYWRqdXN0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRhWydvbmlucHV0J10gPSBhZGp1c3Q7XG4gICAgICAgIH1cblxuICAgICAgICAkd2luLmJpbmQoJ3Jlc2l6ZScsIGZvcmNlQWRqdXN0KTtcblxuICAgICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIG5nTW9kZWwuJG1vZGVsVmFsdWU7XG4gICAgICAgIH0sIGZ1bmN0aW9uKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgZm9yY2VBZGp1c3QoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgc2NvcGUuJG9uKCdlbGFzdGljOmFkanVzdCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGZvcmNlQWRqdXN0KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICR0aW1lb3V0KGFkanVzdCk7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogZGVzdHJveVxuICAgICAgICAgKi9cblxuICAgICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgJG1pcnJvci5yZW1vdmUoKTtcbiAgICAgICAgICAkd2luLnVuYmluZCgncmVzaXplJywgZm9yY2VBZGp1c3QpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gIH1dKTtcbiIsIi8qXG4gQW5ndWxhckpTIHYxLjIuMTZcbiAoYykgMjAxMC0yMDE0IEdvb2dsZSwgSW5jLiBodHRwOi8vYW5ndWxhcmpzLm9yZ1xuIExpY2Vuc2U6IE1JVFxuKi9cbihmdW5jdGlvbihPLFUscyl7J3VzZSBzdHJpY3QnO2Z1bmN0aW9uIHQoYil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGE9YXJndW1lbnRzWzBdLGMsYT1cIltcIisoYj9iK1wiOlwiOlwiXCIpK2ErXCJdIGh0dHA6Ly9lcnJvcnMuYW5ndWxhcmpzLm9yZy8xLjIuMTYvXCIrKGI/YitcIi9cIjpcIlwiKSthO2ZvcihjPTE7Yzxhcmd1bWVudHMubGVuZ3RoO2MrKylhPWErKDE9PWM/XCI/XCI6XCImXCIpK1wicFwiKyhjLTEpK1wiPVwiK2VuY29kZVVSSUNvbXBvbmVudChcImZ1bmN0aW9uXCI9PXR5cGVvZiBhcmd1bWVudHNbY10/YXJndW1lbnRzW2NdLnRvU3RyaW5nKCkucmVwbGFjZSgvIFxce1tcXHNcXFNdKiQvLFwiXCIpOlwidW5kZWZpbmVkXCI9PXR5cGVvZiBhcmd1bWVudHNbY10/XCJ1bmRlZmluZWRcIjpcInN0cmluZ1wiIT10eXBlb2YgYXJndW1lbnRzW2NdP0pTT04uc3RyaW5naWZ5KGFyZ3VtZW50c1tjXSk6YXJndW1lbnRzW2NdKTtyZXR1cm4gRXJyb3IoYSl9fWZ1bmN0aW9uIGFiKGIpe2lmKG51bGw9PWJ8fENhKGIpKXJldHVybiExO1xudmFyIGE9Yi5sZW5ndGg7cmV0dXJuIDE9PT1iLm5vZGVUeXBlJiZhPyEwOncoYil8fE0oYil8fDA9PT1hfHxcIm51bWJlclwiPT09dHlwZW9mIGEmJjA8YSYmYS0xIGluIGJ9ZnVuY3Rpb24gcShiLGEsYyl7dmFyIGQ7aWYoYilpZihQKGIpKWZvcihkIGluIGIpXCJwcm90b3R5cGVcIj09ZHx8KFwibGVuZ3RoXCI9PWR8fFwibmFtZVwiPT1kfHxiLmhhc093blByb3BlcnR5JiYhYi5oYXNPd25Qcm9wZXJ0eShkKSl8fGEuY2FsbChjLGJbZF0sZCk7ZWxzZSBpZihiLmZvckVhY2gmJmIuZm9yRWFjaCE9PXEpYi5mb3JFYWNoKGEsYyk7ZWxzZSBpZihhYihiKSlmb3IoZD0wO2Q8Yi5sZW5ndGg7ZCsrKWEuY2FsbChjLGJbZF0sZCk7ZWxzZSBmb3IoZCBpbiBiKWIuaGFzT3duUHJvcGVydHkoZCkmJmEuY2FsbChjLGJbZF0sZCk7cmV0dXJuIGJ9ZnVuY3Rpb24gUWIoYil7dmFyIGE9W10sYztmb3IoYyBpbiBiKWIuaGFzT3duUHJvcGVydHkoYykmJmEucHVzaChjKTtyZXR1cm4gYS5zb3J0KCl9ZnVuY3Rpb24gU2MoYixcbmEsYyl7Zm9yKHZhciBkPVFiKGIpLGU9MDtlPGQubGVuZ3RoO2UrKylhLmNhbGwoYyxiW2RbZV1dLGRbZV0pO3JldHVybiBkfWZ1bmN0aW9uIFJiKGIpe3JldHVybiBmdW5jdGlvbihhLGMpe2IoYyxhKX19ZnVuY3Rpb24gYmIoKXtmb3IodmFyIGI9a2EubGVuZ3RoLGE7Yjspe2ItLTthPWthW2JdLmNoYXJDb2RlQXQoMCk7aWYoNTc9PWEpcmV0dXJuIGthW2JdPVwiQVwiLGthLmpvaW4oXCJcIik7aWYoOTA9PWEpa2FbYl09XCIwXCI7ZWxzZSByZXR1cm4ga2FbYl09U3RyaW5nLmZyb21DaGFyQ29kZShhKzEpLGthLmpvaW4oXCJcIil9a2EudW5zaGlmdChcIjBcIik7cmV0dXJuIGthLmpvaW4oXCJcIil9ZnVuY3Rpb24gU2IoYixhKXthP2IuJCRoYXNoS2V5PWE6ZGVsZXRlIGIuJCRoYXNoS2V5fWZ1bmN0aW9uIEQoYil7dmFyIGE9Yi4kJGhhc2hLZXk7cShhcmd1bWVudHMsZnVuY3Rpb24oYSl7YSE9PWImJnEoYSxmdW5jdGlvbihhLGMpe2JbY109YX0pfSk7U2IoYixhKTtyZXR1cm4gYn1mdW5jdGlvbiBZKGIpe3JldHVybiBwYXJzZUludChiLFxuMTApfWZ1bmN0aW9uIFRiKGIsYSl7cmV0dXJuIEQobmV3IChEKGZ1bmN0aW9uKCl7fSx7cHJvdG90eXBlOmJ9KSksYSl9ZnVuY3Rpb24gQygpe31mdW5jdGlvbiBEYShiKXtyZXR1cm4gYn1mdW5jdGlvbiBhYShiKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYn19ZnVuY3Rpb24gRShiKXtyZXR1cm5cInVuZGVmaW5lZFwiPT09dHlwZW9mIGJ9ZnVuY3Rpb24gQihiKXtyZXR1cm5cInVuZGVmaW5lZFwiIT09dHlwZW9mIGJ9ZnVuY3Rpb24gWChiKXtyZXR1cm4gbnVsbCE9YiYmXCJvYmplY3RcIj09PXR5cGVvZiBifWZ1bmN0aW9uIHcoYil7cmV0dXJuXCJzdHJpbmdcIj09PXR5cGVvZiBifWZ1bmN0aW9uIHZiKGIpe3JldHVyblwibnVtYmVyXCI9PT10eXBlb2YgYn1mdW5jdGlvbiBOYShiKXtyZXR1cm5cIltvYmplY3QgRGF0ZV1cIj09PXdhLmNhbGwoYil9ZnVuY3Rpb24gTShiKXtyZXR1cm5cIltvYmplY3QgQXJyYXldXCI9PT13YS5jYWxsKGIpfWZ1bmN0aW9uIFAoYil7cmV0dXJuXCJmdW5jdGlvblwiPT09dHlwZW9mIGJ9XG5mdW5jdGlvbiBjYihiKXtyZXR1cm5cIltvYmplY3QgUmVnRXhwXVwiPT09d2EuY2FsbChiKX1mdW5jdGlvbiBDYShiKXtyZXR1cm4gYiYmYi5kb2N1bWVudCYmYi5sb2NhdGlvbiYmYi5hbGVydCYmYi5zZXRJbnRlcnZhbH1mdW5jdGlvbiBUYyhiKXtyZXR1cm4hKCFifHwhKGIubm9kZU5hbWV8fGIucHJvcCYmYi5hdHRyJiZiLmZpbmQpKX1mdW5jdGlvbiBVYyhiLGEsYyl7dmFyIGQ9W107cShiLGZ1bmN0aW9uKGIsZyxmKXtkLnB1c2goYS5jYWxsKGMsYixnLGYpKX0pO3JldHVybiBkfWZ1bmN0aW9uIGRiKGIsYSl7aWYoYi5pbmRleE9mKXJldHVybiBiLmluZGV4T2YoYSk7Zm9yKHZhciBjPTA7YzxiLmxlbmd0aDtjKyspaWYoYT09PWJbY10pcmV0dXJuIGM7cmV0dXJuLTF9ZnVuY3Rpb24gT2EoYixhKXt2YXIgYz1kYihiLGEpOzA8PWMmJmIuc3BsaWNlKGMsMSk7cmV0dXJuIGF9ZnVuY3Rpb24gYmEoYixhKXtpZihDYShiKXx8YiYmYi4kZXZhbEFzeW5jJiZiLiR3YXRjaCl0aHJvdyBQYShcImNwd3NcIik7XG5pZihhKXtpZihiPT09YSl0aHJvdyBQYShcImNwaVwiKTtpZihNKGIpKWZvcih2YXIgYz1hLmxlbmd0aD0wO2M8Yi5sZW5ndGg7YysrKWEucHVzaChiYShiW2NdKSk7ZWxzZXtjPWEuJCRoYXNoS2V5O3EoYSxmdW5jdGlvbihiLGMpe2RlbGV0ZSBhW2NdfSk7Zm9yKHZhciBkIGluIGIpYVtkXT1iYShiW2RdKTtTYihhLGMpfX1lbHNlKGE9YikmJihNKGIpP2E9YmEoYixbXSk6TmEoYik/YT1uZXcgRGF0ZShiLmdldFRpbWUoKSk6Y2IoYik/YT1SZWdFeHAoYi5zb3VyY2UpOlgoYikmJihhPWJhKGIse30pKSk7cmV0dXJuIGF9ZnVuY3Rpb24gVWIoYixhKXthPWF8fHt9O2Zvcih2YXIgYyBpbiBiKSFiLmhhc093blByb3BlcnR5KGMpfHxcIiRcIj09PWMuY2hhckF0KDApJiZcIiRcIj09PWMuY2hhckF0KDEpfHwoYVtjXT1iW2NdKTtyZXR1cm4gYX1mdW5jdGlvbiB4YShiLGEpe2lmKGI9PT1hKXJldHVybiEwO2lmKG51bGw9PT1ifHxudWxsPT09YSlyZXR1cm4hMTtpZihiIT09YiYmYSE9PWEpcmV0dXJuITA7XG52YXIgYz10eXBlb2YgYixkO2lmKGM9PXR5cGVvZiBhJiZcIm9iamVjdFwiPT1jKWlmKE0oYikpe2lmKCFNKGEpKXJldHVybiExO2lmKChjPWIubGVuZ3RoKT09YS5sZW5ndGgpe2ZvcihkPTA7ZDxjO2QrKylpZigheGEoYltkXSxhW2RdKSlyZXR1cm4hMTtyZXR1cm4hMH19ZWxzZXtpZihOYShiKSlyZXR1cm4gTmEoYSkmJmIuZ2V0VGltZSgpPT1hLmdldFRpbWUoKTtpZihjYihiKSYmY2IoYSkpcmV0dXJuIGIudG9TdHJpbmcoKT09YS50b1N0cmluZygpO2lmKGImJmIuJGV2YWxBc3luYyYmYi4kd2F0Y2h8fGEmJmEuJGV2YWxBc3luYyYmYS4kd2F0Y2h8fENhKGIpfHxDYShhKXx8TShhKSlyZXR1cm4hMTtjPXt9O2ZvcihkIGluIGIpaWYoXCIkXCIhPT1kLmNoYXJBdCgwKSYmIVAoYltkXSkpe2lmKCF4YShiW2RdLGFbZF0pKXJldHVybiExO2NbZF09ITB9Zm9yKGQgaW4gYSlpZighYy5oYXNPd25Qcm9wZXJ0eShkKSYmXCIkXCIhPT1kLmNoYXJBdCgwKSYmYVtkXSE9PXMmJiFQKGFbZF0pKXJldHVybiExO1xucmV0dXJuITB9cmV0dXJuITF9ZnVuY3Rpb24gVmIoKXtyZXR1cm4gVS5zZWN1cml0eVBvbGljeSYmVS5zZWN1cml0eVBvbGljeS5pc0FjdGl2ZXx8VS5xdWVyeVNlbGVjdG9yJiYhKCFVLnF1ZXJ5U2VsZWN0b3IoXCJbbmctY3NwXVwiKSYmIVUucXVlcnlTZWxlY3RvcihcIltkYXRhLW5nLWNzcF1cIikpfWZ1bmN0aW9uIGViKGIsYSl7dmFyIGM9Mjxhcmd1bWVudHMubGVuZ3RoP3lhLmNhbGwoYXJndW1lbnRzLDIpOltdO3JldHVybiFQKGEpfHxhIGluc3RhbmNlb2YgUmVnRXhwP2E6Yy5sZW5ndGg/ZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD9hLmFwcGx5KGIsYy5jb25jYXQoeWEuY2FsbChhcmd1bWVudHMsMCkpKTphLmFwcGx5KGIsYyl9OmZ1bmN0aW9uKCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/YS5hcHBseShiLGFyZ3VtZW50cyk6YS5jYWxsKGIpfX1mdW5jdGlvbiBWYyhiLGEpe3ZhciBjPWE7XCJzdHJpbmdcIj09PXR5cGVvZiBiJiZcIiRcIj09PWIuY2hhckF0KDApP2M9XG5zOkNhKGEpP2M9XCIkV0lORE9XXCI6YSYmVT09PWE/Yz1cIiRET0NVTUVOVFwiOmEmJihhLiRldmFsQXN5bmMmJmEuJHdhdGNoKSYmKGM9XCIkU0NPUEVcIik7cmV0dXJuIGN9ZnVuY3Rpb24gcWEoYixhKXtyZXR1cm5cInVuZGVmaW5lZFwiPT09dHlwZW9mIGI/czpKU09OLnN0cmluZ2lmeShiLFZjLGE/XCIgIFwiOm51bGwpfWZ1bmN0aW9uIFdiKGIpe3JldHVybiB3KGIpP0pTT04ucGFyc2UoYik6Yn1mdW5jdGlvbiBRYShiKXtcImZ1bmN0aW9uXCI9PT10eXBlb2YgYj9iPSEwOmImJjAhPT1iLmxlbmd0aD8oYj1LKFwiXCIrYiksYj0hKFwiZlwiPT1ifHxcIjBcIj09Ynx8XCJmYWxzZVwiPT1ifHxcIm5vXCI9PWJ8fFwiblwiPT1ifHxcIltdXCI9PWIpKTpiPSExO3JldHVybiBifWZ1bmN0aW9uIGhhKGIpe2I9eShiKS5jbG9uZSgpO3RyeXtiLmVtcHR5KCl9Y2F0Y2goYSl7fXZhciBjPXkoXCI8ZGl2PlwiKS5hcHBlbmQoYikuaHRtbCgpO3RyeXtyZXR1cm4gMz09PWJbMF0ubm9kZVR5cGU/SyhjKTpjLm1hdGNoKC9eKDxbXj5dKz4pLylbMV0ucmVwbGFjZSgvXjwoW1xcd1xcLV0rKS8sXG5mdW5jdGlvbihhLGIpe3JldHVyblwiPFwiK0soYil9KX1jYXRjaChkKXtyZXR1cm4gSyhjKX19ZnVuY3Rpb24gWGIoYil7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoYil9Y2F0Y2goYSl7fX1mdW5jdGlvbiBZYihiKXt2YXIgYT17fSxjLGQ7cSgoYnx8XCJcIikuc3BsaXQoXCImXCIpLGZ1bmN0aW9uKGIpe2ImJihjPWIuc3BsaXQoXCI9XCIpLGQ9WGIoY1swXSksQihkKSYmKGI9QihjWzFdKT9YYihjWzFdKTohMCxhW2RdP00oYVtkXSk/YVtkXS5wdXNoKGIpOmFbZF09W2FbZF0sYl06YVtkXT1iKSl9KTtyZXR1cm4gYX1mdW5jdGlvbiBaYihiKXt2YXIgYT1bXTtxKGIsZnVuY3Rpb24oYixkKXtNKGIpP3EoYixmdW5jdGlvbihiKXthLnB1c2goemEoZCwhMCkrKCEwPT09Yj9cIlwiOlwiPVwiK3phKGIsITApKSl9KTphLnB1c2goemEoZCwhMCkrKCEwPT09Yj9cIlwiOlwiPVwiK3phKGIsITApKSl9KTtyZXR1cm4gYS5sZW5ndGg/YS5qb2luKFwiJlwiKTpcIlwifWZ1bmN0aW9uIHdiKGIpe3JldHVybiB6YShiLFxuITApLnJlcGxhY2UoLyUyNi9naSxcIiZcIikucmVwbGFjZSgvJTNEL2dpLFwiPVwiKS5yZXBsYWNlKC8lMkIvZ2ksXCIrXCIpfWZ1bmN0aW9uIHphKGIsYSl7cmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChiKS5yZXBsYWNlKC8lNDAvZ2ksXCJAXCIpLnJlcGxhY2UoLyUzQS9naSxcIjpcIikucmVwbGFjZSgvJTI0L2csXCIkXCIpLnJlcGxhY2UoLyUyQy9naSxcIixcIikucmVwbGFjZSgvJTIwL2csYT9cIiUyMFwiOlwiK1wiKX1mdW5jdGlvbiBXYyhiLGEpe2Z1bmN0aW9uIGMoYSl7YSYmZC5wdXNoKGEpfXZhciBkPVtiXSxlLGcsZj1bXCJuZzphcHBcIixcIm5nLWFwcFwiLFwieC1uZy1hcHBcIixcImRhdGEtbmctYXBwXCJdLGg9L1xcc25nWzpcXC1dYXBwKDpcXHMqKFtcXHdcXGRfXSspOz8pP1xccy87cShmLGZ1bmN0aW9uKGEpe2ZbYV09ITA7YyhVLmdldEVsZW1lbnRCeUlkKGEpKTthPWEucmVwbGFjZShcIjpcIixcIlxcXFw6XCIpO2IucXVlcnlTZWxlY3RvckFsbCYmKHEoYi5xdWVyeVNlbGVjdG9yQWxsKFwiLlwiK2EpLGMpLHEoYi5xdWVyeVNlbGVjdG9yQWxsKFwiLlwiK1xuYStcIlxcXFw6XCIpLGMpLHEoYi5xdWVyeVNlbGVjdG9yQWxsKFwiW1wiK2ErXCJdXCIpLGMpKX0pO3EoZCxmdW5jdGlvbihhKXtpZighZSl7dmFyIGI9aC5leGVjKFwiIFwiK2EuY2xhc3NOYW1lK1wiIFwiKTtiPyhlPWEsZz0oYlsyXXx8XCJcIikucmVwbGFjZSgvXFxzKy9nLFwiLFwiKSk6cShhLmF0dHJpYnV0ZXMsZnVuY3Rpb24oYil7IWUmJmZbYi5uYW1lXSYmKGU9YSxnPWIudmFsdWUpfSl9fSk7ZSYmYShlLGc/W2ddOltdKX1mdW5jdGlvbiAkYihiLGEpe3ZhciBjPWZ1bmN0aW9uKCl7Yj15KGIpO2lmKGIuaW5qZWN0b3IoKSl7dmFyIGM9YlswXT09PVU/XCJkb2N1bWVudFwiOmhhKGIpO3Rocm93IFBhKFwiYnRzdHJwZFwiLGMpO31hPWF8fFtdO2EudW5zaGlmdChbXCIkcHJvdmlkZVwiLGZ1bmN0aW9uKGEpe2EudmFsdWUoXCIkcm9vdEVsZW1lbnRcIixiKX1dKTthLnVuc2hpZnQoXCJuZ1wiKTtjPWFjKGEpO2MuaW52b2tlKFtcIiRyb290U2NvcGVcIixcIiRyb290RWxlbWVudFwiLFwiJGNvbXBpbGVcIixcIiRpbmplY3RvclwiLFwiJGFuaW1hdGVcIixcbmZ1bmN0aW9uKGEsYixjLGQsZSl7YS4kYXBwbHkoZnVuY3Rpb24oKXtiLmRhdGEoXCIkaW5qZWN0b3JcIixkKTtjKGIpKGEpfSl9XSk7cmV0dXJuIGN9LGQ9L15OR19ERUZFUl9CT09UU1RSQVAhLztpZihPJiYhZC50ZXN0KE8ubmFtZSkpcmV0dXJuIGMoKTtPLm5hbWU9Ty5uYW1lLnJlcGxhY2UoZCxcIlwiKTtFYS5yZXN1bWVCb290c3RyYXA9ZnVuY3Rpb24oYil7cShiLGZ1bmN0aW9uKGIpe2EucHVzaChiKX0pO2MoKX19ZnVuY3Rpb24gZmIoYixhKXthPWF8fFwiX1wiO3JldHVybiBiLnJlcGxhY2UoWGMsZnVuY3Rpb24oYixkKXtyZXR1cm4oZD9hOlwiXCIpK2IudG9Mb3dlckNhc2UoKX0pfWZ1bmN0aW9uIHhiKGIsYSxjKXtpZighYil0aHJvdyBQYShcImFyZXFcIixhfHxcIj9cIixjfHxcInJlcXVpcmVkXCIpO3JldHVybiBifWZ1bmN0aW9uIFJhKGIsYSxjKXtjJiZNKGIpJiYoYj1iW2IubGVuZ3RoLTFdKTt4YihQKGIpLGEsXCJub3QgYSBmdW5jdGlvbiwgZ290IFwiKyhiJiZcIm9iamVjdFwiPT10eXBlb2YgYj9cbmIuY29uc3RydWN0b3IubmFtZXx8XCJPYmplY3RcIjp0eXBlb2YgYikpO3JldHVybiBifWZ1bmN0aW9uIEFhKGIsYSl7aWYoXCJoYXNPd25Qcm9wZXJ0eVwiPT09Yil0aHJvdyBQYShcImJhZG5hbWVcIixhKTt9ZnVuY3Rpb24gYmMoYixhLGMpe2lmKCFhKXJldHVybiBiO2E9YS5zcGxpdChcIi5cIik7Zm9yKHZhciBkLGU9YixnPWEubGVuZ3RoLGY9MDtmPGc7ZisrKWQ9YVtmXSxiJiYoYj0oZT1iKVtkXSk7cmV0dXJuIWMmJlAoYik/ZWIoZSxiKTpifWZ1bmN0aW9uIHliKGIpe3ZhciBhPWJbMF07Yj1iW2IubGVuZ3RoLTFdO2lmKGE9PT1iKXJldHVybiB5KGEpO3ZhciBjPVthXTtkb3thPWEubmV4dFNpYmxpbmc7aWYoIWEpYnJlYWs7Yy5wdXNoKGEpfXdoaWxlKGEhPT1iKTtyZXR1cm4geShjKX1mdW5jdGlvbiBZYyhiKXt2YXIgYT10KFwiJGluamVjdG9yXCIpLGM9dChcIm5nXCIpO2I9Yi5hbmd1bGFyfHwoYi5hbmd1bGFyPXt9KTtiLiQkbWluRXJyPWIuJCRtaW5FcnJ8fHQ7cmV0dXJuIGIubW9kdWxlfHxcbihiLm1vZHVsZT1mdW5jdGlvbigpe3ZhciBiPXt9O3JldHVybiBmdW5jdGlvbihlLGcsZil7aWYoXCJoYXNPd25Qcm9wZXJ0eVwiPT09ZSl0aHJvdyBjKFwiYmFkbmFtZVwiLFwibW9kdWxlXCIpO2cmJmIuaGFzT3duUHJvcGVydHkoZSkmJihiW2VdPW51bGwpO3JldHVybiBiW2VdfHwoYltlXT1mdW5jdGlvbigpe2Z1bmN0aW9uIGIoYSxkLGUpe3JldHVybiBmdW5jdGlvbigpe2NbZXx8XCJwdXNoXCJdKFthLGQsYXJndW1lbnRzXSk7cmV0dXJuIG59fWlmKCFnKXRocm93IGEoXCJub21vZFwiLGUpO3ZhciBjPVtdLGQ9W10sbT1iKFwiJGluamVjdG9yXCIsXCJpbnZva2VcIiksbj17X2ludm9rZVF1ZXVlOmMsX3J1bkJsb2NrczpkLHJlcXVpcmVzOmcsbmFtZTplLHByb3ZpZGVyOmIoXCIkcHJvdmlkZVwiLFwicHJvdmlkZXJcIiksZmFjdG9yeTpiKFwiJHByb3ZpZGVcIixcImZhY3RvcnlcIiksc2VydmljZTpiKFwiJHByb3ZpZGVcIixcInNlcnZpY2VcIiksdmFsdWU6YihcIiRwcm92aWRlXCIsXCJ2YWx1ZVwiKSxjb25zdGFudDpiKFwiJHByb3ZpZGVcIixcblwiY29uc3RhbnRcIixcInVuc2hpZnRcIiksYW5pbWF0aW9uOmIoXCIkYW5pbWF0ZVByb3ZpZGVyXCIsXCJyZWdpc3RlclwiKSxmaWx0ZXI6YihcIiRmaWx0ZXJQcm92aWRlclwiLFwicmVnaXN0ZXJcIiksY29udHJvbGxlcjpiKFwiJGNvbnRyb2xsZXJQcm92aWRlclwiLFwicmVnaXN0ZXJcIiksZGlyZWN0aXZlOmIoXCIkY29tcGlsZVByb3ZpZGVyXCIsXCJkaXJlY3RpdmVcIiksY29uZmlnOm0scnVuOmZ1bmN0aW9uKGEpe2QucHVzaChhKTtyZXR1cm4gdGhpc319O2YmJm0oZik7cmV0dXJuIG59KCkpfX0oKSl9ZnVuY3Rpb24gWmMoYil7RChiLHtib290c3RyYXA6JGIsY29weTpiYSxleHRlbmQ6RCxlcXVhbHM6eGEsZWxlbWVudDp5LGZvckVhY2g6cSxpbmplY3RvcjphYyxub29wOkMsYmluZDplYix0b0pzb246cWEsZnJvbUpzb246V2IsaWRlbnRpdHk6RGEsaXNVbmRlZmluZWQ6RSxpc0RlZmluZWQ6Qixpc1N0cmluZzp3LGlzRnVuY3Rpb246UCxpc09iamVjdDpYLGlzTnVtYmVyOnZiLGlzRWxlbWVudDpUYyxpc0FycmF5Ok0sXG52ZXJzaW9uOiRjLGlzRGF0ZTpOYSxsb3dlcmNhc2U6Syx1cHBlcmNhc2U6RmEsY2FsbGJhY2tzOntjb3VudGVyOjB9LCQkbWluRXJyOnQsJCRjc3A6VmJ9KTtTYT1ZYyhPKTt0cnl7U2EoXCJuZ0xvY2FsZVwiKX1jYXRjaChhKXtTYShcIm5nTG9jYWxlXCIsW10pLnByb3ZpZGVyKFwiJGxvY2FsZVwiLGFkKX1TYShcIm5nXCIsW1wibmdMb2NhbGVcIl0sW1wiJHByb3ZpZGVcIixmdW5jdGlvbihhKXthLnByb3ZpZGVyKHskJHNhbml0aXplVXJpOmJkfSk7YS5wcm92aWRlcihcIiRjb21waWxlXCIsY2MpLmRpcmVjdGl2ZSh7YTpjZCxpbnB1dDpkYyx0ZXh0YXJlYTpkYyxmb3JtOmRkLHNjcmlwdDplZCxzZWxlY3Q6ZmQsc3R5bGU6Z2Qsb3B0aW9uOmhkLG5nQmluZDppZCxuZ0JpbmRIdG1sOmpkLG5nQmluZFRlbXBsYXRlOmtkLG5nQ2xhc3M6bGQsbmdDbGFzc0V2ZW46bWQsbmdDbGFzc09kZDpuZCxuZ0Nsb2FrOm9kLG5nQ29udHJvbGxlcjpwZCxuZ0Zvcm06cWQsbmdIaWRlOnJkLG5nSWY6c2QsbmdJbmNsdWRlOnRkLFxubmdJbml0OnVkLG5nTm9uQmluZGFibGU6dmQsbmdQbHVyYWxpemU6d2QsbmdSZXBlYXQ6eGQsbmdTaG93OnlkLG5nU3R5bGU6emQsbmdTd2l0Y2g6QWQsbmdTd2l0Y2hXaGVuOkJkLG5nU3dpdGNoRGVmYXVsdDpDZCxuZ09wdGlvbnM6RGQsbmdUcmFuc2NsdWRlOkVkLG5nTW9kZWw6RmQsbmdMaXN0OkdkLG5nQ2hhbmdlOkhkLHJlcXVpcmVkOmVjLG5nUmVxdWlyZWQ6ZWMsbmdWYWx1ZTpJZH0pLmRpcmVjdGl2ZSh7bmdJbmNsdWRlOkpkfSkuZGlyZWN0aXZlKHpiKS5kaXJlY3RpdmUoZmMpO2EucHJvdmlkZXIoeyRhbmNob3JTY3JvbGw6S2QsJGFuaW1hdGU6TGQsJGJyb3dzZXI6TWQsJGNhY2hlRmFjdG9yeTpOZCwkY29udHJvbGxlcjpPZCwkZG9jdW1lbnQ6UGQsJGV4Y2VwdGlvbkhhbmRsZXI6UWQsJGZpbHRlcjpnYywkaW50ZXJwb2xhdGU6UmQsJGludGVydmFsOlNkLCRodHRwOlRkLCRodHRwQmFja2VuZDpVZCwkbG9jYXRpb246VmQsJGxvZzpXZCwkcGFyc2U6WGQsJHJvb3RTY29wZTpZZCxcbiRxOlpkLCRzY2U6JGQsJHNjZURlbGVnYXRlOmFlLCRzbmlmZmVyOmJlLCR0ZW1wbGF0ZUNhY2hlOmNlLCR0aW1lb3V0OmRlLCR3aW5kb3c6ZWUsJCRyQUY6ZmUsJCRhc3luY0NhbGxiYWNrOmdlfSl9XSl9ZnVuY3Rpb24gVGEoYil7cmV0dXJuIGIucmVwbGFjZShoZSxmdW5jdGlvbihhLGIsZCxlKXtyZXR1cm4gZT9kLnRvVXBwZXJDYXNlKCk6ZH0pLnJlcGxhY2UoaWUsXCJNb3okMVwiKX1mdW5jdGlvbiBBYihiLGEsYyxkKXtmdW5jdGlvbiBlKGIpe3ZhciBlPWMmJmI/W3RoaXMuZmlsdGVyKGIpXTpbdGhpc10sbD1hLGssbSxuLHAscix6O2lmKCFkfHxudWxsIT1iKWZvcig7ZS5sZW5ndGg7KWZvcihrPWUuc2hpZnQoKSxtPTAsbj1rLmxlbmd0aDttPG47bSsrKWZvcihwPXkoa1ttXSksbD9wLnRyaWdnZXJIYW5kbGVyKFwiJGRlc3Ryb3lcIik6bD0hbCxyPTAscD0oej1wLmNoaWxkcmVuKCkpLmxlbmd0aDtyPHA7cisrKWUucHVzaChHYSh6W3JdKSk7cmV0dXJuIGcuYXBwbHkodGhpcyxhcmd1bWVudHMpfVxudmFyIGc9R2EuZm5bYl0sZz1nLiRvcmlnaW5hbHx8ZztlLiRvcmlnaW5hbD1nO0dhLmZuW2JdPWV9ZnVuY3Rpb24gTihiKXtpZihiIGluc3RhbmNlb2YgTilyZXR1cm4gYjt3KGIpJiYoYj1jYShiKSk7aWYoISh0aGlzIGluc3RhbmNlb2YgTikpe2lmKHcoYikmJlwiPFwiIT1iLmNoYXJBdCgwKSl0aHJvdyBCYihcIm5vc2VsXCIpO3JldHVybiBuZXcgTihiKX1pZih3KGIpKXt2YXIgYT1iO2I9VTt2YXIgYztpZihjPWplLmV4ZWMoYSkpYj1bYi5jcmVhdGVFbGVtZW50KGNbMV0pXTtlbHNle3ZhciBkPWIsZTtiPWQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO2M9W107aWYoQ2IudGVzdChhKSl7ZD1iLmFwcGVuZENoaWxkKGQuY3JlYXRlRWxlbWVudChcImRpdlwiKSk7ZT0oa2UuZXhlYyhhKXx8W1wiXCIsXCJcIl0pWzFdLnRvTG93ZXJDYXNlKCk7ZT1lYVtlXXx8ZWEuX2RlZmF1bHQ7ZC5pbm5lckhUTUw9XCI8ZGl2PiYjMTYwOzwvZGl2PlwiK2VbMV0rYS5yZXBsYWNlKGxlLFwiPCQxPjwvJDI+XCIpK2VbMl07XG5kLnJlbW92ZUNoaWxkKGQuZmlyc3RDaGlsZCk7Zm9yKGE9ZVswXTthLS07KWQ9ZC5sYXN0Q2hpbGQ7YT0wO2ZvcihlPWQuY2hpbGROb2Rlcy5sZW5ndGg7YTxlOysrYSljLnB1c2goZC5jaGlsZE5vZGVzW2FdKTtkPWIuZmlyc3RDaGlsZDtkLnRleHRDb250ZW50PVwiXCJ9ZWxzZSBjLnB1c2goZC5jcmVhdGVUZXh0Tm9kZShhKSk7Yi50ZXh0Q29udGVudD1cIlwiO2IuaW5uZXJIVE1MPVwiXCI7Yj1jfURiKHRoaXMsYik7eShVLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSkuYXBwZW5kKHRoaXMpfWVsc2UgRGIodGhpcyxiKX1mdW5jdGlvbiBFYihiKXtyZXR1cm4gYi5jbG9uZU5vZGUoITApfWZ1bmN0aW9uIEhhKGIpe2hjKGIpO3ZhciBhPTA7Zm9yKGI9Yi5jaGlsZE5vZGVzfHxbXTthPGIubGVuZ3RoO2ErKylIYShiW2FdKX1mdW5jdGlvbiBpYyhiLGEsYyxkKXtpZihCKGQpKXRocm93IEJiKFwib2ZmYXJnc1wiKTt2YXIgZT1sYShiLFwiZXZlbnRzXCIpO2xhKGIsXCJoYW5kbGVcIikmJihFKGEpP3EoZSxcbmZ1bmN0aW9uKGEsYyl7RmIoYixjLGEpO2RlbGV0ZSBlW2NdfSk6cShhLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhKXtFKGMpPyhGYihiLGEsZVthXSksZGVsZXRlIGVbYV0pOk9hKGVbYV18fFtdLGMpfSkpfWZ1bmN0aW9uIGhjKGIsYSl7dmFyIGM9YltnYl0sZD1VYVtjXTtkJiYoYT9kZWxldGUgVWFbY10uZGF0YVthXTooZC5oYW5kbGUmJihkLmV2ZW50cy4kZGVzdHJveSYmZC5oYW5kbGUoe30sXCIkZGVzdHJveVwiKSxpYyhiKSksZGVsZXRlIFVhW2NdLGJbZ2JdPXMpKX1mdW5jdGlvbiBsYShiLGEsYyl7dmFyIGQ9YltnYl0sZD1VYVtkfHwtMV07aWYoQihjKSlkfHwoYltnYl09ZD0rK21lLGQ9VWFbZF09e30pLGRbYV09YztlbHNlIHJldHVybiBkJiZkW2FdfWZ1bmN0aW9uIGpjKGIsYSxjKXt2YXIgZD1sYShiLFwiZGF0YVwiKSxlPUIoYyksZz0hZSYmQihhKSxmPWcmJiFYKGEpO2R8fGZ8fGxhKGIsXCJkYXRhXCIsZD17fSk7aWYoZSlkW2FdPWM7ZWxzZSBpZihnKXtpZihmKXJldHVybiBkJiZkW2FdO1xuRChkLGEpfWVsc2UgcmV0dXJuIGR9ZnVuY3Rpb24gR2IoYixhKXtyZXR1cm4gYi5nZXRBdHRyaWJ1dGU/LTE8KFwiIFwiKyhiLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpfHxcIlwiKStcIiBcIikucmVwbGFjZSgvW1xcblxcdF0vZyxcIiBcIikuaW5kZXhPZihcIiBcIithK1wiIFwiKTohMX1mdW5jdGlvbiBoYihiLGEpe2EmJmIuc2V0QXR0cmlidXRlJiZxKGEuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGEpe2Iuc2V0QXR0cmlidXRlKFwiY2xhc3NcIixjYSgoXCIgXCIrKGIuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIil8fFwiXCIpK1wiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLFwiIFwiKS5yZXBsYWNlKFwiIFwiK2NhKGEpK1wiIFwiLFwiIFwiKSkpfSl9ZnVuY3Rpb24gaWIoYixhKXtpZihhJiZiLnNldEF0dHJpYnV0ZSl7dmFyIGM9KFwiIFwiKyhiLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpfHxcIlwiKStcIiBcIikucmVwbGFjZSgvW1xcblxcdF0vZyxcIiBcIik7cShhLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhKXthPWNhKGEpOy0xPT09Yy5pbmRleE9mKFwiIFwiK2ErXCIgXCIpJiZcbihjKz1hK1wiIFwiKX0pO2Iuc2V0QXR0cmlidXRlKFwiY2xhc3NcIixjYShjKSl9fWZ1bmN0aW9uIERiKGIsYSl7aWYoYSl7YT1hLm5vZGVOYW1lfHwhQihhLmxlbmd0aCl8fENhKGEpP1thXTphO2Zvcih2YXIgYz0wO2M8YS5sZW5ndGg7YysrKWIucHVzaChhW2NdKX19ZnVuY3Rpb24ga2MoYixhKXtyZXR1cm4gamIoYixcIiRcIisoYXx8XCJuZ0NvbnRyb2xsZXJcIikrXCJDb250cm9sbGVyXCIpfWZ1bmN0aW9uIGpiKGIsYSxjKXtiPXkoYik7OT09YlswXS5ub2RlVHlwZSYmKGI9Yi5maW5kKFwiaHRtbFwiKSk7Zm9yKGE9TShhKT9hOlthXTtiLmxlbmd0aDspe2Zvcih2YXIgZD1iWzBdLGU9MCxnPWEubGVuZ3RoO2U8ZztlKyspaWYoKGM9Yi5kYXRhKGFbZV0pKSE9PXMpcmV0dXJuIGM7Yj15KGQucGFyZW50Tm9kZXx8MTE9PT1kLm5vZGVUeXBlJiZkLmhvc3QpfX1mdW5jdGlvbiBsYyhiKXtmb3IodmFyIGE9MCxjPWIuY2hpbGROb2RlczthPGMubGVuZ3RoO2ErKylIYShjW2FdKTtmb3IoO2IuZmlyc3RDaGlsZDspYi5yZW1vdmVDaGlsZChiLmZpcnN0Q2hpbGQpfVxuZnVuY3Rpb24gbWMoYixhKXt2YXIgYz1rYlthLnRvTG93ZXJDYXNlKCldO3JldHVybiBjJiZuY1tiLm5vZGVOYW1lXSYmY31mdW5jdGlvbiBuZShiLGEpe3ZhciBjPWZ1bmN0aW9uKGMsZSl7Yy5wcmV2ZW50RGVmYXVsdHx8KGMucHJldmVudERlZmF1bHQ9ZnVuY3Rpb24oKXtjLnJldHVyblZhbHVlPSExfSk7Yy5zdG9wUHJvcGFnYXRpb258fChjLnN0b3BQcm9wYWdhdGlvbj1mdW5jdGlvbigpe2MuY2FuY2VsQnViYmxlPSEwfSk7Yy50YXJnZXR8fChjLnRhcmdldD1jLnNyY0VsZW1lbnR8fFUpO2lmKEUoYy5kZWZhdWx0UHJldmVudGVkKSl7dmFyIGc9Yy5wcmV2ZW50RGVmYXVsdDtjLnByZXZlbnREZWZhdWx0PWZ1bmN0aW9uKCl7Yy5kZWZhdWx0UHJldmVudGVkPSEwO2cuY2FsbChjKX07Yy5kZWZhdWx0UHJldmVudGVkPSExfWMuaXNEZWZhdWx0UHJldmVudGVkPWZ1bmN0aW9uKCl7cmV0dXJuIGMuZGVmYXVsdFByZXZlbnRlZHx8ITE9PT1jLnJldHVyblZhbHVlfTt2YXIgZj1VYihhW2V8fFxuYy50eXBlXXx8W10pO3EoZixmdW5jdGlvbihhKXthLmNhbGwoYixjKX0pOzg+PVM/KGMucHJldmVudERlZmF1bHQ9bnVsbCxjLnN0b3BQcm9wYWdhdGlvbj1udWxsLGMuaXNEZWZhdWx0UHJldmVudGVkPW51bGwpOihkZWxldGUgYy5wcmV2ZW50RGVmYXVsdCxkZWxldGUgYy5zdG9wUHJvcGFnYXRpb24sZGVsZXRlIGMuaXNEZWZhdWx0UHJldmVudGVkKX07Yy5lbGVtPWI7cmV0dXJuIGN9ZnVuY3Rpb24gSWEoYil7dmFyIGE9dHlwZW9mIGIsYztcIm9iamVjdFwiPT1hJiZudWxsIT09Yj9cImZ1bmN0aW9uXCI9PXR5cGVvZihjPWIuJCRoYXNoS2V5KT9jPWIuJCRoYXNoS2V5KCk6Yz09PXMmJihjPWIuJCRoYXNoS2V5PWJiKCkpOmM9YjtyZXR1cm4gYStcIjpcIitjfWZ1bmN0aW9uIFZhKGIpe3EoYix0aGlzLnB1dCx0aGlzKX1mdW5jdGlvbiBvYyhiKXt2YXIgYSxjO1wiZnVuY3Rpb25cIj09dHlwZW9mIGI/KGE9Yi4kaW5qZWN0KXx8KGE9W10sYi5sZW5ndGgmJihjPWIudG9TdHJpbmcoKS5yZXBsYWNlKG9lLFxuXCJcIiksYz1jLm1hdGNoKHBlKSxxKGNbMV0uc3BsaXQocWUpLGZ1bmN0aW9uKGIpe2IucmVwbGFjZShyZSxmdW5jdGlvbihiLGMsZCl7YS5wdXNoKGQpfSl9KSksYi4kaW5qZWN0PWEpOk0oYik/KGM9Yi5sZW5ndGgtMSxSYShiW2NdLFwiZm5cIiksYT1iLnNsaWNlKDAsYykpOlJhKGIsXCJmblwiLCEwKTtyZXR1cm4gYX1mdW5jdGlvbiBhYyhiKXtmdW5jdGlvbiBhKGEpe3JldHVybiBmdW5jdGlvbihiLGMpe2lmKFgoYikpcShiLFJiKGEpKTtlbHNlIHJldHVybiBhKGIsYyl9fWZ1bmN0aW9uIGMoYSxiKXtBYShhLFwic2VydmljZVwiKTtpZihQKGIpfHxNKGIpKWI9bi5pbnN0YW50aWF0ZShiKTtpZighYi4kZ2V0KXRocm93IFdhKFwicGdldFwiLGEpO3JldHVybiBtW2EraF09Yn1mdW5jdGlvbiBkKGEsYil7cmV0dXJuIGMoYSx7JGdldDpifSl9ZnVuY3Rpb24gZShhKXt2YXIgYj1bXSxjLGQsZyxoO3EoYSxmdW5jdGlvbihhKXtpZighay5nZXQoYSkpe2sucHV0KGEsITApO3RyeXtpZih3KGEpKWZvcihjPVxuU2EoYSksYj1iLmNvbmNhdChlKGMucmVxdWlyZXMpKS5jb25jYXQoYy5fcnVuQmxvY2tzKSxkPWMuX2ludm9rZVF1ZXVlLGc9MCxoPWQubGVuZ3RoO2c8aDtnKyspe3ZhciBmPWRbZ10sbD1uLmdldChmWzBdKTtsW2ZbMV1dLmFwcGx5KGwsZlsyXSl9ZWxzZSBQKGEpP2IucHVzaChuLmludm9rZShhKSk6TShhKT9iLnB1c2gobi5pbnZva2UoYSkpOlJhKGEsXCJtb2R1bGVcIil9Y2F0Y2gobSl7dGhyb3cgTShhKSYmKGE9YVthLmxlbmd0aC0xXSksbS5tZXNzYWdlJiYobS5zdGFjayYmLTE9PW0uc3RhY2suaW5kZXhPZihtLm1lc3NhZ2UpKSYmKG09bS5tZXNzYWdlK1wiXFxuXCIrbS5zdGFjayksV2EoXCJtb2R1bGVyclwiLGEsbS5zdGFja3x8bS5tZXNzYWdlfHxtKTt9fX0pO3JldHVybiBifWZ1bmN0aW9uIGcoYSxiKXtmdW5jdGlvbiBjKGQpe2lmKGEuaGFzT3duUHJvcGVydHkoZCkpe2lmKGFbZF09PT1mKXRocm93IFdhKFwiY2RlcFwiLGwuam9pbihcIiA8LSBcIikpO3JldHVybiBhW2RdfXRyeXtyZXR1cm4gbC51bnNoaWZ0KGQpLFxuYVtkXT1mLGFbZF09YihkKX1jYXRjaChlKXt0aHJvdyBhW2RdPT09ZiYmZGVsZXRlIGFbZF0sZTt9ZmluYWxseXtsLnNoaWZ0KCl9fWZ1bmN0aW9uIGQoYSxiLGUpe3ZhciBnPVtdLGg9b2MoYSksZixsLGs7bD0wO2ZvcihmPWgubGVuZ3RoO2w8ZjtsKyspe2s9aFtsXTtpZihcInN0cmluZ1wiIT09dHlwZW9mIGspdGhyb3cgV2EoXCJpdGtuXCIsayk7Zy5wdXNoKGUmJmUuaGFzT3duUHJvcGVydHkoayk/ZVtrXTpjKGspKX1hLiRpbmplY3R8fChhPWFbZl0pO3JldHVybiBhLmFwcGx5KGIsZyl9cmV0dXJue2ludm9rZTpkLGluc3RhbnRpYXRlOmZ1bmN0aW9uKGEsYil7dmFyIGM9ZnVuY3Rpb24oKXt9LGU7Yy5wcm90b3R5cGU9KE0oYSk/YVthLmxlbmd0aC0xXTphKS5wcm90b3R5cGU7Yz1uZXcgYztlPWQoYSxjLGIpO3JldHVybiBYKGUpfHxQKGUpP2U6Y30sZ2V0OmMsYW5ub3RhdGU6b2MsaGFzOmZ1bmN0aW9uKGIpe3JldHVybiBtLmhhc093blByb3BlcnR5KGIraCl8fGEuaGFzT3duUHJvcGVydHkoYil9fX1cbnZhciBmPXt9LGg9XCJQcm92aWRlclwiLGw9W10saz1uZXcgVmEsbT17JHByb3ZpZGU6e3Byb3ZpZGVyOmEoYyksZmFjdG9yeTphKGQpLHNlcnZpY2U6YShmdW5jdGlvbihhLGIpe3JldHVybiBkKGEsW1wiJGluamVjdG9yXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEuaW5zdGFudGlhdGUoYil9XSl9KSx2YWx1ZTphKGZ1bmN0aW9uKGEsYil7cmV0dXJuIGQoYSxhYShiKSl9KSxjb25zdGFudDphKGZ1bmN0aW9uKGEsYil7QWEoYSxcImNvbnN0YW50XCIpO21bYV09YjtwW2FdPWJ9KSxkZWNvcmF0b3I6ZnVuY3Rpb24oYSxiKXt2YXIgYz1uLmdldChhK2gpLGQ9Yy4kZ2V0O2MuJGdldD1mdW5jdGlvbigpe3ZhciBhPXIuaW52b2tlKGQsYyk7cmV0dXJuIHIuaW52b2tlKGIsbnVsbCx7JGRlbGVnYXRlOmF9KX19fX0sbj1tLiRpbmplY3Rvcj1nKG0sZnVuY3Rpb24oKXt0aHJvdyBXYShcInVucHJcIixsLmpvaW4oXCIgPC0gXCIpKTt9KSxwPXt9LHI9cC4kaW5qZWN0b3I9ZyhwLGZ1bmN0aW9uKGEpe2E9bi5nZXQoYStcbmgpO3JldHVybiByLmludm9rZShhLiRnZXQsYSl9KTtxKGUoYiksZnVuY3Rpb24oYSl7ci5pbnZva2UoYXx8Qyl9KTtyZXR1cm4gcn1mdW5jdGlvbiBLZCgpe3ZhciBiPSEwO3RoaXMuZGlzYWJsZUF1dG9TY3JvbGxpbmc9ZnVuY3Rpb24oKXtiPSExfTt0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLFwiJGxvY2F0aW9uXCIsXCIkcm9vdFNjb3BlXCIsZnVuY3Rpb24oYSxjLGQpe2Z1bmN0aW9uIGUoYSl7dmFyIGI9bnVsbDtxKGEsZnVuY3Rpb24oYSl7Ynx8XCJhXCIhPT1LKGEubm9kZU5hbWUpfHwoYj1hKX0pO3JldHVybiBifWZ1bmN0aW9uIGcoKXt2YXIgYj1jLmhhc2goKSxkO2I/KGQ9Zi5nZXRFbGVtZW50QnlJZChiKSk/ZC5zY3JvbGxJbnRvVmlldygpOihkPWUoZi5nZXRFbGVtZW50c0J5TmFtZShiKSkpP2Quc2Nyb2xsSW50b1ZpZXcoKTpcInRvcFwiPT09YiYmYS5zY3JvbGxUbygwLDApOmEuc2Nyb2xsVG8oMCwwKX12YXIgZj1hLmRvY3VtZW50O2ImJmQuJHdhdGNoKGZ1bmN0aW9uKCl7cmV0dXJuIGMuaGFzaCgpfSxcbmZ1bmN0aW9uKCl7ZC4kZXZhbEFzeW5jKGcpfSk7cmV0dXJuIGd9XX1mdW5jdGlvbiBnZSgpe3RoaXMuJGdldD1bXCIkJHJBRlwiLFwiJHRpbWVvdXRcIixmdW5jdGlvbihiLGEpe3JldHVybiBiLnN1cHBvcnRlZD9mdW5jdGlvbihhKXtyZXR1cm4gYihhKX06ZnVuY3Rpb24oYil7cmV0dXJuIGEoYiwwLCExKX19XX1mdW5jdGlvbiBzZShiLGEsYyxkKXtmdW5jdGlvbiBlKGEpe3RyeXthLmFwcGx5KG51bGwseWEuY2FsbChhcmd1bWVudHMsMSkpfWZpbmFsbHl7aWYoei0tLDA9PT16KWZvcig7dS5sZW5ndGg7KXRyeXt1LnBvcCgpKCl9Y2F0Y2goYil7Yy5lcnJvcihiKX19fWZ1bmN0aW9uIGcoYSxiKXsoZnVuY3Rpb24gVCgpe3EoRixmdW5jdGlvbihhKXthKCl9KTt2PWIoVCxhKX0pKCl9ZnVuY3Rpb24gZigpe3g9bnVsbDtKIT1oLnVybCgpJiYoSj1oLnVybCgpLHEobWEsZnVuY3Rpb24oYSl7YShoLnVybCgpKX0pKX12YXIgaD10aGlzLGw9YVswXSxrPWIubG9jYXRpb24sbT1iLmhpc3RvcnksXG5uPWIuc2V0VGltZW91dCxwPWIuY2xlYXJUaW1lb3V0LHI9e307aC5pc01vY2s9ITE7dmFyIHo9MCx1PVtdO2guJCRjb21wbGV0ZU91dHN0YW5kaW5nUmVxdWVzdD1lO2guJCRpbmNPdXRzdGFuZGluZ1JlcXVlc3RDb3VudD1mdW5jdGlvbigpe3orK307aC5ub3RpZnlXaGVuTm9PdXRzdGFuZGluZ1JlcXVlc3RzPWZ1bmN0aW9uKGEpe3EoRixmdW5jdGlvbihhKXthKCl9KTswPT09ej9hKCk6dS5wdXNoKGEpfTt2YXIgRj1bXSx2O2guYWRkUG9sbEZuPWZ1bmN0aW9uKGEpe0UodikmJmcoMTAwLG4pO0YucHVzaChhKTtyZXR1cm4gYX07dmFyIEo9ay5ocmVmLEE9YS5maW5kKFwiYmFzZVwiKSx4PW51bGw7aC51cmw9ZnVuY3Rpb24oYSxjKXtrIT09Yi5sb2NhdGlvbiYmKGs9Yi5sb2NhdGlvbik7bSE9PWIuaGlzdG9yeSYmKG09Yi5oaXN0b3J5KTtpZihhKXtpZihKIT1hKXJldHVybiBKPWEsZC5oaXN0b3J5P2M/bS5yZXBsYWNlU3RhdGUobnVsbCxcIlwiLGEpOihtLnB1c2hTdGF0ZShudWxsLFwiXCIsXG5hKSxBLmF0dHIoXCJocmVmXCIsQS5hdHRyKFwiaHJlZlwiKSkpOih4PWEsYz9rLnJlcGxhY2UoYSk6ay5ocmVmPWEpLGh9ZWxzZSByZXR1cm4geHx8ay5ocmVmLnJlcGxhY2UoLyUyNy9nLFwiJ1wiKX07dmFyIG1hPVtdLEw9ITE7aC5vblVybENoYW5nZT1mdW5jdGlvbihhKXtpZighTCl7aWYoZC5oaXN0b3J5KXkoYikub24oXCJwb3BzdGF0ZVwiLGYpO2lmKGQuaGFzaGNoYW5nZSl5KGIpLm9uKFwiaGFzaGNoYW5nZVwiLGYpO2Vsc2UgaC5hZGRQb2xsRm4oZik7TD0hMH1tYS5wdXNoKGEpO3JldHVybiBhfTtoLmJhc2VIcmVmPWZ1bmN0aW9uKCl7dmFyIGE9QS5hdHRyKFwiaHJlZlwiKTtyZXR1cm4gYT9hLnJlcGxhY2UoL14oaHR0cHM/XFw6KT9cXC9cXC9bXlxcL10qLyxcIlwiKTpcIlwifTt2YXIgUT17fSxkYT1cIlwiLEg9aC5iYXNlSHJlZigpO2guY29va2llcz1mdW5jdGlvbihhLGIpe3ZhciBkLGUsZyxoO2lmKGEpYj09PXM/bC5jb29raWU9ZXNjYXBlKGEpK1wiPTtwYXRoPVwiK0grXCI7ZXhwaXJlcz1UaHUsIDAxIEphbiAxOTcwIDAwOjAwOjAwIEdNVFwiOlxudyhiKSYmKGQ9KGwuY29va2llPWVzY2FwZShhKStcIj1cIitlc2NhcGUoYikrXCI7cGF0aD1cIitIKS5sZW5ndGgrMSw0MDk2PGQmJmMud2FybihcIkNvb2tpZSAnXCIrYStcIicgcG9zc2libHkgbm90IHNldCBvciBvdmVyZmxvd2VkIGJlY2F1c2UgaXQgd2FzIHRvbyBsYXJnZSAoXCIrZCtcIiA+IDQwOTYgYnl0ZXMpIVwiKSk7ZWxzZXtpZihsLmNvb2tpZSE9PWRhKWZvcihkYT1sLmNvb2tpZSxkPWRhLnNwbGl0KFwiOyBcIiksUT17fSxnPTA7ZzxkLmxlbmd0aDtnKyspZT1kW2ddLGg9ZS5pbmRleE9mKFwiPVwiKSwwPGgmJihhPXVuZXNjYXBlKGUuc3Vic3RyaW5nKDAsaCkpLFFbYV09PT1zJiYoUVthXT11bmVzY2FwZShlLnN1YnN0cmluZyhoKzEpKSkpO3JldHVybiBRfX07aC5kZWZlcj1mdW5jdGlvbihhLGIpe3ZhciBjO3orKztjPW4oZnVuY3Rpb24oKXtkZWxldGUgcltjXTtlKGEpfSxifHwwKTtyW2NdPSEwO3JldHVybiBjfTtoLmRlZmVyLmNhbmNlbD1mdW5jdGlvbihhKXtyZXR1cm4gclthXT8oZGVsZXRlIHJbYV0sXG5wKGEpLGUoQyksITApOiExfX1mdW5jdGlvbiBNZCgpe3RoaXMuJGdldD1bXCIkd2luZG93XCIsXCIkbG9nXCIsXCIkc25pZmZlclwiLFwiJGRvY3VtZW50XCIsZnVuY3Rpb24oYixhLGMsZCl7cmV0dXJuIG5ldyBzZShiLGQsYSxjKX1dfWZ1bmN0aW9uIE5kKCl7dGhpcy4kZ2V0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYihiLGQpe2Z1bmN0aW9uIGUoYSl7YSE9biYmKHA/cD09YSYmKHA9YS5uKTpwPWEsZyhhLm4sYS5wKSxnKGEsbiksbj1hLG4ubj1udWxsKX1mdW5jdGlvbiBnKGEsYil7YSE9YiYmKGEmJihhLnA9YiksYiYmKGIubj1hKSl9aWYoYiBpbiBhKXRocm93IHQoXCIkY2FjaGVGYWN0b3J5XCIpKFwiaWlkXCIsYik7dmFyIGY9MCxoPUQoe30sZCx7aWQ6Yn0pLGw9e30saz1kJiZkLmNhcGFjaXR5fHxOdW1iZXIuTUFYX1ZBTFVFLG09e30sbj1udWxsLHA9bnVsbDtyZXR1cm4gYVtiXT17cHV0OmZ1bmN0aW9uKGEsYil7aWYoazxOdW1iZXIuTUFYX1ZBTFVFKXt2YXIgYz1tW2FdfHwobVthXT17a2V5OmF9KTtcbmUoYyl9aWYoIUUoYikpcmV0dXJuIGEgaW4gbHx8ZisrLGxbYV09YixmPmsmJnRoaXMucmVtb3ZlKHAua2V5KSxifSxnZXQ6ZnVuY3Rpb24oYSl7aWYoazxOdW1iZXIuTUFYX1ZBTFVFKXt2YXIgYj1tW2FdO2lmKCFiKXJldHVybjtlKGIpfXJldHVybiBsW2FdfSxyZW1vdmU6ZnVuY3Rpb24oYSl7aWYoazxOdW1iZXIuTUFYX1ZBTFVFKXt2YXIgYj1tW2FdO2lmKCFiKXJldHVybjtiPT1uJiYobj1iLnApO2I9PXAmJihwPWIubik7ZyhiLm4sYi5wKTtkZWxldGUgbVthXX1kZWxldGUgbFthXTtmLS19LHJlbW92ZUFsbDpmdW5jdGlvbigpe2w9e307Zj0wO209e307bj1wPW51bGx9LGRlc3Ryb3k6ZnVuY3Rpb24oKXttPWg9bD1udWxsO2RlbGV0ZSBhW2JdfSxpbmZvOmZ1bmN0aW9uKCl7cmV0dXJuIEQoe30saCx7c2l6ZTpmfSl9fX12YXIgYT17fTtiLmluZm89ZnVuY3Rpb24oKXt2YXIgYj17fTtxKGEsZnVuY3Rpb24oYSxlKXtiW2VdPWEuaW5mbygpfSk7cmV0dXJuIGJ9O2IuZ2V0PWZ1bmN0aW9uKGIpe3JldHVybiBhW2JdfTtcbnJldHVybiBifX1mdW5jdGlvbiBjZSgpe3RoaXMuJGdldD1bXCIkY2FjaGVGYWN0b3J5XCIsZnVuY3Rpb24oYil7cmV0dXJuIGIoXCJ0ZW1wbGF0ZXNcIil9XX1mdW5jdGlvbiBjYyhiLGEpe3ZhciBjPXt9LGQ9XCJEaXJlY3RpdmVcIixlPS9eXFxzKmRpcmVjdGl2ZVxcOlxccyooW1xcZFxcd1xcLV9dKylcXHMrKC4qKSQvLGc9LygoW1xcZFxcd1xcLV9dKykoPzpcXDooW147XSspKT87PykvLGY9L14ob25bYS16XSt8Zm9ybWFjdGlvbikkLzt0aGlzLmRpcmVjdGl2ZT1mdW5jdGlvbiBsKGEsZSl7QWEoYSxcImRpcmVjdGl2ZVwiKTt3KGEpPyh4YihlLFwiZGlyZWN0aXZlRmFjdG9yeVwiKSxjLmhhc093blByb3BlcnR5KGEpfHwoY1thXT1bXSxiLmZhY3RvcnkoYStkLFtcIiRpbmplY3RvclwiLFwiJGV4Y2VwdGlvbkhhbmRsZXJcIixmdW5jdGlvbihiLGQpe3ZhciBlPVtdO3EoY1thXSxmdW5jdGlvbihjLGcpe3RyeXt2YXIgZj1iLmludm9rZShjKTtQKGYpP2Y9e2NvbXBpbGU6YWEoZil9OiFmLmNvbXBpbGUmJmYubGluayYmKGYuY29tcGlsZT1cbmFhKGYubGluaykpO2YucHJpb3JpdHk9Zi5wcmlvcml0eXx8MDtmLmluZGV4PWc7Zi5uYW1lPWYubmFtZXx8YTtmLnJlcXVpcmU9Zi5yZXF1aXJlfHxmLmNvbnRyb2xsZXImJmYubmFtZTtmLnJlc3RyaWN0PWYucmVzdHJpY3R8fFwiQVwiO2UucHVzaChmKX1jYXRjaChsKXtkKGwpfX0pO3JldHVybiBlfV0pKSxjW2FdLnB1c2goZSkpOnEoYSxSYihsKSk7cmV0dXJuIHRoaXN9O3RoaXMuYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3Q9ZnVuY3Rpb24oYil7cmV0dXJuIEIoYik/KGEuYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3QoYiksdGhpcyk6YS5hSHJlZlNhbml0aXphdGlvbldoaXRlbGlzdCgpfTt0aGlzLmltZ1NyY1Nhbml0aXphdGlvbldoaXRlbGlzdD1mdW5jdGlvbihiKXtyZXR1cm4gQihiKT8oYS5pbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3QoYiksdGhpcyk6YS5pbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3QoKX07dGhpcy4kZ2V0PVtcIiRpbmplY3RvclwiLFwiJGludGVycG9sYXRlXCIsXG5cIiRleGNlcHRpb25IYW5kbGVyXCIsXCIkaHR0cFwiLFwiJHRlbXBsYXRlQ2FjaGVcIixcIiRwYXJzZVwiLFwiJGNvbnRyb2xsZXJcIixcIiRyb290U2NvcGVcIixcIiRkb2N1bWVudFwiLFwiJHNjZVwiLFwiJGFuaW1hdGVcIixcIiQkc2FuaXRpemVVcmlcIixmdW5jdGlvbihhLGIsbSxuLHAscix6LHUsRix2LEosQSl7ZnVuY3Rpb24geChhLGIsYyxkLGUpe2EgaW5zdGFuY2VvZiB5fHwoYT15KGEpKTtxKGEsZnVuY3Rpb24oYixjKXszPT1iLm5vZGVUeXBlJiZiLm5vZGVWYWx1ZS5tYXRjaCgvXFxTKy8pJiYoYVtjXT15KGIpLndyYXAoXCI8c3Bhbj48L3NwYW4+XCIpLnBhcmVudCgpWzBdKX0pO3ZhciBnPUwoYSxiLGEsYyxkLGUpO21hKGEsXCJuZy1zY29wZVwiKTtyZXR1cm4gZnVuY3Rpb24oYixjLGQpe3hiKGIsXCJzY29wZVwiKTt2YXIgZT1jP0phLmNsb25lLmNhbGwoYSk6YTtxKGQsZnVuY3Rpb24oYSxiKXtlLmRhdGEoXCIkXCIrYitcIkNvbnRyb2xsZXJcIixhKX0pO2Q9MDtmb3IodmFyIGY9ZS5sZW5ndGg7ZDxmO2QrKyl7dmFyIGw9XG5lW2RdLm5vZGVUeXBlOzEhPT1sJiY5IT09bHx8ZS5lcShkKS5kYXRhKFwiJHNjb3BlXCIsYil9YyYmYyhlLGIpO2cmJmcoYixlLGUpO3JldHVybiBlfX1mdW5jdGlvbiBtYShhLGIpe3RyeXthLmFkZENsYXNzKGIpfWNhdGNoKGMpe319ZnVuY3Rpb24gTChhLGIsYyxkLGUsZyl7ZnVuY3Rpb24gZihhLGMsZCxlKXt2YXIgZyxrLG0scixuLHAsejtnPWMubGVuZ3RoO3ZhciBJPUFycmF5KGcpO2ZvcihuPTA7bjxnO24rKylJW25dPWNbbl07ej1uPTA7Zm9yKHA9bC5sZW5ndGg7bjxwO3orKylrPUlbel0sYz1sW24rK10sZz1sW24rK10sbT15KGspLGM/KGMuc2NvcGU/KHI9YS4kbmV3KCksbS5kYXRhKFwiJHNjb3BlXCIscikpOnI9YSwobT1jLnRyYW5zY2x1ZGUpfHwhZSYmYj9jKGcscixrLGQsUShhLG18fGIpKTpjKGcscixrLGQsZSkpOmcmJmcoYSxrLmNoaWxkTm9kZXMscyxlKX1mb3IodmFyIGw9W10sayxtLHIsbixwPTA7cDxhLmxlbmd0aDtwKyspaz1uZXcgSGIsbT1kYShhW3BdLFtdLGssXG4wPT09cD9kOnMsZSksKGc9bS5sZW5ndGg/aWEobSxhW3BdLGssYixjLG51bGwsW10sW10sZyk6bnVsbCkmJmcuc2NvcGUmJm1hKHkoYVtwXSksXCJuZy1zY29wZVwiKSxrPWcmJmcudGVybWluYWx8fCEocj1hW3BdLmNoaWxkTm9kZXMpfHwhci5sZW5ndGg/bnVsbDpMKHIsZz9nLnRyYW5zY2x1ZGU6YiksbC5wdXNoKGcsayksbj1ufHxnfHxrLGc9bnVsbDtyZXR1cm4gbj9mOm51bGx9ZnVuY3Rpb24gUShhLGIpe3JldHVybiBmdW5jdGlvbihjLGQsZSl7dmFyIGc9ITE7Y3x8KGM9YS4kbmV3KCksZz1jLiQkdHJhbnNjbHVkZWQ9ITApO2Q9YihjLGQsZSk7aWYoZylkLm9uKFwiJGRlc3Ryb3lcIixlYihjLGMuJGRlc3Ryb3kpKTtyZXR1cm4gZH19ZnVuY3Rpb24gZGEoYSxiLGMsZCxmKXt2YXIgaz1jLiRhdHRyLGw7c3dpdGNoKGEubm9kZVR5cGUpe2Nhc2UgMTpUKGIsbmEoS2EoYSkudG9Mb3dlckNhc2UoKSksXCJFXCIsZCxmKTt2YXIgbSxyLG47bD1hLmF0dHJpYnV0ZXM7Zm9yKHZhciBwPTAsej1cbmwmJmwubGVuZ3RoO3A8ejtwKyspe3ZhciB1PSExLEY9ITE7bT1sW3BdO2lmKCFTfHw4PD1TfHxtLnNwZWNpZmllZCl7cj1tLm5hbWU7bj1uYShyKTtXLnRlc3QobikmJihyPWZiKG4uc3Vic3RyKDYpLFwiLVwiKSk7dmFyIEo9bi5yZXBsYWNlKC8oU3RhcnR8RW5kKSQvLFwiXCIpO249PT1KK1wiU3RhcnRcIiYmKHU9cixGPXIuc3Vic3RyKDAsci5sZW5ndGgtNSkrXCJlbmRcIixyPXIuc3Vic3RyKDAsci5sZW5ndGgtNikpO249bmEoci50b0xvd2VyQ2FzZSgpKTtrW25dPXI7Y1tuXT1tPWNhKG0udmFsdWUpO21jKGEsbikmJihjW25dPSEwKTtOKGEsYixtLG4pO1QoYixuLFwiQVwiLGQsZix1LEYpfX1hPWEuY2xhc3NOYW1lO2lmKHcoYSkmJlwiXCIhPT1hKWZvcig7bD1nLmV4ZWMoYSk7KW49bmEobFsyXSksVChiLG4sXCJDXCIsZCxmKSYmKGNbbl09Y2EobFszXSkpLGE9YS5zdWJzdHIobC5pbmRleCtsWzBdLmxlbmd0aCk7YnJlYWs7Y2FzZSAzOnQoYixhLm5vZGVWYWx1ZSk7YnJlYWs7Y2FzZSA4OnRyeXtpZihsPVxuZS5leGVjKGEubm9kZVZhbHVlKSluPW5hKGxbMV0pLFQoYixuLFwiTVwiLGQsZikmJihjW25dPWNhKGxbMl0pKX1jYXRjaCh4KXt9fWIuc29ydChFKTtyZXR1cm4gYn1mdW5jdGlvbiBIKGEsYixjKXt2YXIgZD1bXSxlPTA7aWYoYiYmYS5oYXNBdHRyaWJ1dGUmJmEuaGFzQXR0cmlidXRlKGIpKXtkb3tpZighYSl0aHJvdyBqYShcInV0ZXJkaXJcIixiLGMpOzE9PWEubm9kZVR5cGUmJihhLmhhc0F0dHJpYnV0ZShiKSYmZSsrLGEuaGFzQXR0cmlidXRlKGMpJiZlLS0pO2QucHVzaChhKTthPWEubmV4dFNpYmxpbmd9d2hpbGUoMDxlKX1lbHNlIGQucHVzaChhKTtyZXR1cm4geShkKX1mdW5jdGlvbiBSKGEsYixjKXtyZXR1cm4gZnVuY3Rpb24oZCxlLGcsZixsKXtlPUgoZVswXSxiLGMpO3JldHVybiBhKGQsZSxnLGYsbCl9fWZ1bmN0aW9uIGlhKGEsYyxkLGUsZyxmLGwsbixwKXtmdW5jdGlvbiB1KGEsYixjLGQpe2lmKGEpe2MmJihhPVIoYSxjLGQpKTthLnJlcXVpcmU9Ry5yZXF1aXJlO2lmKFE9PT1cbkd8fEcuJCRpc29sYXRlU2NvcGUpYT1xYyhhLHtpc29sYXRlU2NvcGU6ITB9KTtsLnB1c2goYSl9aWYoYil7YyYmKGI9UihiLGMsZCkpO2IucmVxdWlyZT1HLnJlcXVpcmU7aWYoUT09PUd8fEcuJCRpc29sYXRlU2NvcGUpYj1xYyhiLHtpc29sYXRlU2NvcGU6ITB9KTtuLnB1c2goYil9fWZ1bmN0aW9uIEYoYSxiLGMpe3ZhciBkLGU9XCJkYXRhXCIsZz0hMTtpZih3KGEpKXtmb3IoO1wiXlwiPT0oZD1hLmNoYXJBdCgwKSl8fFwiP1wiPT1kOylhPWEuc3Vic3RyKDEpLFwiXlwiPT1kJiYoZT1cImluaGVyaXRlZERhdGFcIiksZz1nfHxcIj9cIj09ZDtkPW51bGw7YyYmXCJkYXRhXCI9PT1lJiYoZD1jW2FdKTtkPWR8fGJbZV0oXCIkXCIrYStcIkNvbnRyb2xsZXJcIik7aWYoIWQmJiFnKXRocm93IGphKFwiY3RyZXFcIixhLHQpO31lbHNlIE0oYSkmJihkPVtdLHEoYSxmdW5jdGlvbihhKXtkLnB1c2goRihhLGIsYykpfSkpO3JldHVybiBkfWZ1bmN0aW9uIEooYSxlLGcsZixwKXtmdW5jdGlvbiB1KGEsYil7dmFyIGM7Mj5hcmd1bWVudHMubGVuZ3RoJiZcbihiPWEsYT1zKTtEJiYoYz1sYik7cmV0dXJuIHAoYSxiLGMpfXZhciBJLHgsdixBLFIsSCxsYj17fSxkYTtJPWM9PT1nP2Q6VWIoZCxuZXcgSGIoeShnKSxkLiRhdHRyKSk7eD1JLiQkZWxlbWVudDtpZihRKXt2YXIgVD0vXlxccyooW0A9Jl0pKFxcPz8pXFxzKihcXHcqKVxccyokLztmPXkoZyk7SD1lLiRuZXcoITApO2lhJiZpYT09PVEuJCRvcmlnaW5hbERpcmVjdGl2ZT9mLmRhdGEoXCIkaXNvbGF0ZVNjb3BlXCIsSCk6Zi5kYXRhKFwiJGlzb2xhdGVTY29wZU5vVGVtcGxhdGVcIixIKTttYShmLFwibmctaXNvbGF0ZS1zY29wZVwiKTtxKFEuc2NvcGUsZnVuY3Rpb24oYSxjKXt2YXIgZD1hLm1hdGNoKFQpfHxbXSxnPWRbM118fGMsZj1cIj9cIj09ZFsyXSxkPWRbMV0sbCxtLG4scDtILiQkaXNvbGF0ZUJpbmRpbmdzW2NdPWQrZztzd2l0Y2goZCl7Y2FzZSBcIkBcIjpJLiRvYnNlcnZlKGcsZnVuY3Rpb24oYSl7SFtjXT1hfSk7SS4kJG9ic2VydmVyc1tnXS4kJHNjb3BlPWU7SVtnXSYmKEhbY109YihJW2ddKShlKSk7XG5icmVhaztjYXNlIFwiPVwiOmlmKGYmJiFJW2ddKWJyZWFrO209cihJW2ddKTtwPW0ubGl0ZXJhbD94YTpmdW5jdGlvbihhLGIpe3JldHVybiBhPT09Yn07bj1tLmFzc2lnbnx8ZnVuY3Rpb24oKXtsPUhbY109bShlKTt0aHJvdyBqYShcIm5vbmFzc2lnblwiLElbZ10sUS5uYW1lKTt9O2w9SFtjXT1tKGUpO0guJHdhdGNoKGZ1bmN0aW9uKCl7dmFyIGE9bShlKTtwKGEsSFtjXSl8fChwKGEsbCk/bihlLGE9SFtjXSk6SFtjXT1hKTtyZXR1cm4gbD1hfSxudWxsLG0ubGl0ZXJhbCk7YnJlYWs7Y2FzZSBcIiZcIjptPXIoSVtnXSk7SFtjXT1mdW5jdGlvbihhKXtyZXR1cm4gbShlLGEpfTticmVhaztkZWZhdWx0OnRocm93IGphKFwiaXNjcFwiLFEubmFtZSxjLGEpO319KX1kYT1wJiZ1O0wmJnEoTCxmdW5jdGlvbihhKXt2YXIgYj17JHNjb3BlOmE9PT1RfHxhLiQkaXNvbGF0ZVNjb3BlP0g6ZSwkZWxlbWVudDp4LCRhdHRyczpJLCR0cmFuc2NsdWRlOmRhfSxjO1I9YS5jb250cm9sbGVyO1wiQFwiPT1SJiYoUj1cbklbYS5uYW1lXSk7Yz16KFIsYik7bGJbYS5uYW1lXT1jO0R8fHguZGF0YShcIiRcIithLm5hbWUrXCJDb250cm9sbGVyXCIsYyk7YS5jb250cm9sbGVyQXMmJihiLiRzY29wZVthLmNvbnRyb2xsZXJBc109Yyl9KTtmPTA7Zm9yKHY9bC5sZW5ndGg7Zjx2O2YrKyl0cnl7QT1sW2ZdLEEoQS5pc29sYXRlU2NvcGU/SDplLHgsSSxBLnJlcXVpcmUmJkYoQS5yZXF1aXJlLHgsbGIpLGRhKX1jYXRjaChHKXttKEcsaGEoeCkpfWY9ZTtRJiYoUS50ZW1wbGF0ZXx8bnVsbD09PVEudGVtcGxhdGVVcmwpJiYoZj1IKTthJiZhKGYsZy5jaGlsZE5vZGVzLHMscCk7Zm9yKGY9bi5sZW5ndGgtMTswPD1mO2YtLSl0cnl7QT1uW2ZdLEEoQS5pc29sYXRlU2NvcGU/SDplLHgsSSxBLnJlcXVpcmUmJkYoQS5yZXF1aXJlLHgsbGIpLGRhKX1jYXRjaChCKXttKEIsaGEoeCkpfX1wPXB8fHt9O2Zvcih2YXIgdj0tTnVtYmVyLk1BWF9WQUxVRSxBLEw9cC5jb250cm9sbGVyRGlyZWN0aXZlcyxRPXAubmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlLFxuaWE9cC50ZW1wbGF0ZURpcmVjdGl2ZSxUPXAubm9uVGxiVHJhbnNjbHVkZURpcmVjdGl2ZSxFPSExLEQ9cC5oYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZSxaPWQuJCRlbGVtZW50PXkoYyksRyx0LFYsWGE9ZSxPLE49MCxTPWEubGVuZ3RoO048UztOKyspe0c9YVtOXTt2YXIgcmE9Ry4kJHN0YXJ0LFc9Ry4kJGVuZDtyYSYmKFo9SChjLHJhLFcpKTtWPXM7aWYodj5HLnByaW9yaXR5KWJyZWFrO2lmKFY9Ry5zY29wZSlBPUF8fEcsRy50ZW1wbGF0ZVVybHx8KEsoXCJuZXcvaXNvbGF0ZWQgc2NvcGVcIixRLEcsWiksWChWKSYmKFE9RykpO3Q9Ry5uYW1lOyFHLnRlbXBsYXRlVXJsJiZHLmNvbnRyb2xsZXImJihWPUcuY29udHJvbGxlcixMPUx8fHt9LEsoXCInXCIrdCtcIicgY29udHJvbGxlclwiLExbdF0sRyxaKSxMW3RdPUcpO2lmKFY9Ry50cmFuc2NsdWRlKUU9ITAsRy4kJHRsYnx8KEsoXCJ0cmFuc2NsdXNpb25cIixULEcsWiksVD1HKSxcImVsZW1lbnRcIj09Vj8oRD0hMCx2PUcucHJpb3JpdHksXG5WPUgoYyxyYSxXKSxaPWQuJCRlbGVtZW50PXkoVS5jcmVhdGVDb21tZW50KFwiIFwiK3QrXCI6IFwiK2RbdF0rXCIgXCIpKSxjPVpbMF0sbWIoZyx5KHlhLmNhbGwoViwwKSksYyksWGE9eChWLGUsdixmJiZmLm5hbWUse25vblRsYlRyYW5zY2x1ZGVEaXJlY3RpdmU6VH0pKTooVj15KEViKGMpKS5jb250ZW50cygpLFouZW1wdHkoKSxYYT14KFYsZSkpO2lmKEcudGVtcGxhdGUpaWYoSyhcInRlbXBsYXRlXCIsaWEsRyxaKSxpYT1HLFY9UChHLnRlbXBsYXRlKT9HLnRlbXBsYXRlKFosZCk6Ry50ZW1wbGF0ZSxWPVkoViksRy5yZXBsYWNlKXtmPUc7Vj1DYi50ZXN0KFYpP3koVik6W107Yz1WWzBdO2lmKDEhPVYubGVuZ3RofHwxIT09Yy5ub2RlVHlwZSl0aHJvdyBqYShcInRwbHJ0XCIsdCxcIlwiKTttYihnLFosYyk7Uz17JGF0dHI6e319O1Y9ZGEoYyxbXSxTKTt2YXIgJD1hLnNwbGljZShOKzEsYS5sZW5ndGgtKE4rMSkpO1EmJnBjKFYpO2E9YS5jb25jYXQoVikuY29uY2F0KCQpO0IoZCxTKTtTPWEubGVuZ3RofWVsc2UgWi5odG1sKFYpO1xuaWYoRy50ZW1wbGF0ZVVybClLKFwidGVtcGxhdGVcIixpYSxHLFopLGlhPUcsRy5yZXBsYWNlJiYoZj1HKSxKPUMoYS5zcGxpY2UoTixhLmxlbmd0aC1OKSxaLGQsZyxYYSxsLG4se2NvbnRyb2xsZXJEaXJlY3RpdmVzOkwsbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlOlEsdGVtcGxhdGVEaXJlY3RpdmU6aWEsbm9uVGxiVHJhbnNjbHVkZURpcmVjdGl2ZTpUfSksUz1hLmxlbmd0aDtlbHNlIGlmKEcuY29tcGlsZSl0cnl7Tz1HLmNvbXBpbGUoWixkLFhhKSxQKE8pP3UobnVsbCxPLHJhLFcpOk8mJnUoTy5wcmUsTy5wb3N0LHJhLFcpfWNhdGNoKGFhKXttKGFhLGhhKFopKX1HLnRlcm1pbmFsJiYoSi50ZXJtaW5hbD0hMCx2PU1hdGgubWF4KHYsRy5wcmlvcml0eSkpfUouc2NvcGU9QSYmITA9PT1BLnNjb3BlO0oudHJhbnNjbHVkZT1FJiZYYTtwLmhhc0VsZW1lbnRUcmFuc2NsdWRlRGlyZWN0aXZlPUQ7cmV0dXJuIEp9ZnVuY3Rpb24gcGMoYSl7Zm9yKHZhciBiPTAsYz1hLmxlbmd0aDtiPGM7YisrKWFbYl09XG5UYihhW2JdLHskJGlzb2xhdGVTY29wZTohMH0pfWZ1bmN0aW9uIFQoYixlLGcsZixrLG4scil7aWYoZT09PWspcmV0dXJuIG51bGw7az1udWxsO2lmKGMuaGFzT3duUHJvcGVydHkoZSkpe3ZhciBwO2U9YS5nZXQoZStkKTtmb3IodmFyIHo9MCx1PWUubGVuZ3RoO3o8dTt6KyspdHJ5e3A9ZVt6XSwoZj09PXN8fGY+cC5wcmlvcml0eSkmJi0xIT1wLnJlc3RyaWN0LmluZGV4T2YoZykmJihuJiYocD1UYihwLHskJHN0YXJ0Om4sJCRlbmQ6cn0pKSxiLnB1c2gocCksaz1wKX1jYXRjaChGKXttKEYpfX1yZXR1cm4ga31mdW5jdGlvbiBCKGEsYil7dmFyIGM9Yi4kYXR0cixkPWEuJGF0dHIsZT1hLiQkZWxlbWVudDtxKGEsZnVuY3Rpb24oZCxlKXtcIiRcIiE9ZS5jaGFyQXQoMCkmJihiW2VdJiYoZCs9KFwic3R5bGVcIj09PWU/XCI7XCI6XCIgXCIpK2JbZV0pLGEuJHNldChlLGQsITAsY1tlXSkpfSk7cShiLGZ1bmN0aW9uKGIsZyl7XCJjbGFzc1wiPT1nPyhtYShlLGIpLGFbXCJjbGFzc1wiXT0oYVtcImNsYXNzXCJdP1xuYVtcImNsYXNzXCJdK1wiIFwiOlwiXCIpK2IpOlwic3R5bGVcIj09Zz8oZS5hdHRyKFwic3R5bGVcIixlLmF0dHIoXCJzdHlsZVwiKStcIjtcIitiKSxhLnN0eWxlPShhLnN0eWxlP2Euc3R5bGUrXCI7XCI6XCJcIikrYik6XCIkXCI9PWcuY2hhckF0KDApfHxhLmhhc093blByb3BlcnR5KGcpfHwoYVtnXT1iLGRbZ109Y1tnXSl9KX1mdW5jdGlvbiBDKGEsYixjLGQsZSxnLGYsbCl7dmFyIGs9W10sbSxyLHo9YlswXSx1PWEuc2hpZnQoKSxGPUQoe30sdSx7dGVtcGxhdGVVcmw6bnVsbCx0cmFuc2NsdWRlOm51bGwscmVwbGFjZTpudWxsLCQkb3JpZ2luYWxEaXJlY3RpdmU6dX0pLHg9UCh1LnRlbXBsYXRlVXJsKT91LnRlbXBsYXRlVXJsKGIsYyk6dS50ZW1wbGF0ZVVybDtiLmVtcHR5KCk7bi5nZXQodi5nZXRUcnVzdGVkUmVzb3VyY2VVcmwoeCkse2NhY2hlOnB9KS5zdWNjZXNzKGZ1bmN0aW9uKG4pe3ZhciBwLEo7bj1ZKG4pO2lmKHUucmVwbGFjZSl7bj1DYi50ZXN0KG4pP3kobik6W107cD1uWzBdO2lmKDEhPW4ubGVuZ3RofHxcbjEhPT1wLm5vZGVUeXBlKXRocm93IGphKFwidHBscnRcIix1Lm5hbWUseCk7bj17JGF0dHI6e319O21iKGQsYixwKTt2YXIgdj1kYShwLFtdLG4pO1godS5zY29wZSkmJnBjKHYpO2E9di5jb25jYXQoYSk7QihjLG4pfWVsc2UgcD16LGIuaHRtbChuKTthLnVuc2hpZnQoRik7bT1pYShhLHAsYyxlLGIsdSxnLGYsbCk7cShkLGZ1bmN0aW9uKGEsYyl7YT09cCYmKGRbY109YlswXSl9KTtmb3Iocj1MKGJbMF0uY2hpbGROb2RlcyxlKTtrLmxlbmd0aDspe249ay5zaGlmdCgpO0o9ay5zaGlmdCgpO3ZhciBBPWsuc2hpZnQoKSxSPWsuc2hpZnQoKSx2PWJbMF07aWYoSiE9PXope3ZhciBIPUouY2xhc3NOYW1lO2wuaGFzRWxlbWVudFRyYW5zY2x1ZGVEaXJlY3RpdmUmJnUucmVwbGFjZXx8KHY9RWIocCkpO21iKEEseShKKSx2KTttYSh5KHYpLEgpfUo9bS50cmFuc2NsdWRlP1EobixtLnRyYW5zY2x1ZGUpOlI7bShyLG4sdixkLEopfWs9bnVsbH0pLmVycm9yKGZ1bmN0aW9uKGEsYixjLGQpe3Rocm93IGphKFwidHBsb2FkXCIsXG5kLnVybCk7fSk7cmV0dXJuIGZ1bmN0aW9uKGEsYixjLGQsZSl7az8oay5wdXNoKGIpLGsucHVzaChjKSxrLnB1c2goZCksay5wdXNoKGUpKTptKHIsYixjLGQsZSl9fWZ1bmN0aW9uIEUoYSxiKXt2YXIgYz1iLnByaW9yaXR5LWEucHJpb3JpdHk7cmV0dXJuIDAhPT1jP2M6YS5uYW1lIT09Yi5uYW1lP2EubmFtZTxiLm5hbWU/LTE6MTphLmluZGV4LWIuaW5kZXh9ZnVuY3Rpb24gSyhhLGIsYyxkKXtpZihiKXRocm93IGphKFwibXVsdGlkaXJcIixiLm5hbWUsYy5uYW1lLGEsaGEoZCkpO31mdW5jdGlvbiB0KGEsYyl7dmFyIGQ9YihjLCEwKTtkJiZhLnB1c2goe3ByaW9yaXR5OjAsY29tcGlsZTphYShmdW5jdGlvbihhLGIpe3ZhciBjPWIucGFyZW50KCksZT1jLmRhdGEoXCIkYmluZGluZ1wiKXx8W107ZS5wdXNoKGQpO21hKGMuZGF0YShcIiRiaW5kaW5nXCIsZSksXCJuZy1iaW5kaW5nXCIpO2EuJHdhdGNoKGQsZnVuY3Rpb24oYSl7YlswXS5ub2RlVmFsdWU9YX0pfSl9KX1mdW5jdGlvbiBPKGEsYil7aWYoXCJzcmNkb2NcIj09XG5iKXJldHVybiB2LkhUTUw7dmFyIGM9S2EoYSk7aWYoXCJ4bGlua0hyZWZcIj09Ynx8XCJGT1JNXCI9PWMmJlwiYWN0aW9uXCI9PWJ8fFwiSU1HXCIhPWMmJihcInNyY1wiPT1ifHxcIm5nU3JjXCI9PWIpKXJldHVybiB2LlJFU09VUkNFX1VSTH1mdW5jdGlvbiBOKGEsYyxkLGUpe3ZhciBnPWIoZCwhMCk7aWYoZyl7aWYoXCJtdWx0aXBsZVwiPT09ZSYmXCJTRUxFQ1RcIj09PUthKGEpKXRocm93IGphKFwic2VsbXVsdGlcIixoYShhKSk7Yy5wdXNoKHtwcmlvcml0eToxMDAsY29tcGlsZTpmdW5jdGlvbigpe3JldHVybntwcmU6ZnVuY3Rpb24oYyxkLGwpe2Q9bC4kJG9ic2VydmVyc3x8KGwuJCRvYnNlcnZlcnM9e30pO2lmKGYudGVzdChlKSl0aHJvdyBqYShcIm5vZG9tZXZlbnRzXCIpO2lmKGc9YihsW2VdLCEwLE8oYSxlKSkpbFtlXT1nKGMpLChkW2VdfHwoZFtlXT1bXSkpLiQkaW50ZXI9ITAsKGwuJCRvYnNlcnZlcnMmJmwuJCRvYnNlcnZlcnNbZV0uJCRzY29wZXx8YykuJHdhdGNoKGcsZnVuY3Rpb24oYSxiKXtcImNsYXNzXCI9PT1cbmUmJmEhPWI/bC4kdXBkYXRlQ2xhc3MoYSxiKTpsLiRzZXQoZSxhKX0pfX19fSl9fWZ1bmN0aW9uIG1iKGEsYixjKXt2YXIgZD1iWzBdLGU9Yi5sZW5ndGgsZz1kLnBhcmVudE5vZGUsZixsO2lmKGEpZm9yKGY9MCxsPWEubGVuZ3RoO2Y8bDtmKyspaWYoYVtmXT09ZCl7YVtmKytdPWM7bD1mK2UtMTtmb3IodmFyIGs9YS5sZW5ndGg7ZjxrO2YrKyxsKyspbDxrP2FbZl09YVtsXTpkZWxldGUgYVtmXTthLmxlbmd0aC09ZS0xO2JyZWFrfWcmJmcucmVwbGFjZUNoaWxkKGMsZCk7YT1VLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTthLmFwcGVuZENoaWxkKGQpO2NbeS5leHBhbmRvXT1kW3kuZXhwYW5kb107ZD0xO2ZvcihlPWIubGVuZ3RoO2Q8ZTtkKyspZz1iW2RdLHkoZykucmVtb3ZlKCksYS5hcHBlbmRDaGlsZChnKSxkZWxldGUgYltkXTtiWzBdPWM7Yi5sZW5ndGg9MX1mdW5jdGlvbiBxYyhhLGIpe3JldHVybiBEKGZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxcbmEsYil9dmFyIEhiPWZ1bmN0aW9uKGEsYil7dGhpcy4kJGVsZW1lbnQ9YTt0aGlzLiRhdHRyPWJ8fHt9fTtIYi5wcm90b3R5cGU9eyRub3JtYWxpemU6bmEsJGFkZENsYXNzOmZ1bmN0aW9uKGEpe2EmJjA8YS5sZW5ndGgmJkouYWRkQ2xhc3ModGhpcy4kJGVsZW1lbnQsYSl9LCRyZW1vdmVDbGFzczpmdW5jdGlvbihhKXthJiYwPGEubGVuZ3RoJiZKLnJlbW92ZUNsYXNzKHRoaXMuJCRlbGVtZW50LGEpfSwkdXBkYXRlQ2xhc3M6ZnVuY3Rpb24oYSxiKXt2YXIgYz1yYyhhLGIpLGQ9cmMoYixhKTswPT09Yy5sZW5ndGg/Si5yZW1vdmVDbGFzcyh0aGlzLiQkZWxlbWVudCxkKTowPT09ZC5sZW5ndGg/Si5hZGRDbGFzcyh0aGlzLiQkZWxlbWVudCxjKTpKLnNldENsYXNzKHRoaXMuJCRlbGVtZW50LGMsZCl9LCRzZXQ6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9bWModGhpcy4kJGVsZW1lbnRbMF0sYSk7ZSYmKHRoaXMuJCRlbGVtZW50LnByb3AoYSxiKSxkPWUpO3RoaXNbYV09YjtkP3RoaXMuJGF0dHJbYV09XG5kOihkPXRoaXMuJGF0dHJbYV0pfHwodGhpcy4kYXR0clthXT1kPWZiKGEsXCItXCIpKTtlPUthKHRoaXMuJCRlbGVtZW50KTtpZihcIkFcIj09PWUmJlwiaHJlZlwiPT09YXx8XCJJTUdcIj09PWUmJlwic3JjXCI9PT1hKXRoaXNbYV09Yj1BKGIsXCJzcmNcIj09PWEpOyExIT09YyYmKG51bGw9PT1ifHxiPT09cz90aGlzLiQkZWxlbWVudC5yZW1vdmVBdHRyKGQpOnRoaXMuJCRlbGVtZW50LmF0dHIoZCxiKSk7KGM9dGhpcy4kJG9ic2VydmVycykmJnEoY1thXSxmdW5jdGlvbihhKXt0cnl7YShiKX1jYXRjaChjKXttKGMpfX0pfSwkb2JzZXJ2ZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD1jLiQkb2JzZXJ2ZXJzfHwoYy4kJG9ic2VydmVycz17fSksZT1kW2FdfHwoZFthXT1bXSk7ZS5wdXNoKGIpO3UuJGV2YWxBc3luYyhmdW5jdGlvbigpe2UuJCRpbnRlcnx8YihjW2FdKX0pO3JldHVybiBifX07dmFyIFo9Yi5zdGFydFN5bWJvbCgpLHJhPWIuZW5kU3ltYm9sKCksWT1cInt7XCI9PVp8fFwifX1cIj09cmE/XG5EYTpmdW5jdGlvbihhKXtyZXR1cm4gYS5yZXBsYWNlKC9cXHtcXHsvZyxaKS5yZXBsYWNlKC99fS9nLHJhKX0sVz0vXm5nQXR0cltBLVpdLztyZXR1cm4geH1dfWZ1bmN0aW9uIG5hKGIpe3JldHVybiBUYShiLnJlcGxhY2UodGUsXCJcIikpfWZ1bmN0aW9uIHJjKGIsYSl7dmFyIGM9XCJcIixkPWIuc3BsaXQoL1xccysvKSxlPWEuc3BsaXQoL1xccysvKSxnPTA7YTpmb3IoO2c8ZC5sZW5ndGg7ZysrKXtmb3IodmFyIGY9ZFtnXSxoPTA7aDxlLmxlbmd0aDtoKyspaWYoZj09ZVtoXSljb250aW51ZSBhO2MrPSgwPGMubGVuZ3RoP1wiIFwiOlwiXCIpK2Z9cmV0dXJuIGN9ZnVuY3Rpb24gT2QoKXt2YXIgYj17fSxhPS9eKFxcUyspKFxccythc1xccysoXFx3KykpPyQvO3RoaXMucmVnaXN0ZXI9ZnVuY3Rpb24oYSxkKXtBYShhLFwiY29udHJvbGxlclwiKTtYKGEpP0QoYixhKTpiW2FdPWR9O3RoaXMuJGdldD1bXCIkaW5qZWN0b3JcIixcIiR3aW5kb3dcIixmdW5jdGlvbihjLGQpe3JldHVybiBmdW5jdGlvbihlLGcpe3ZhciBmLFxuaCxsO3coZSkmJihmPWUubWF0Y2goYSksaD1mWzFdLGw9ZlszXSxlPWIuaGFzT3duUHJvcGVydHkoaCk/YltoXTpiYyhnLiRzY29wZSxoLCEwKXx8YmMoZCxoLCEwKSxSYShlLGgsITApKTtmPWMuaW5zdGFudGlhdGUoZSxnKTtpZihsKXtpZighZ3x8XCJvYmplY3RcIiE9dHlwZW9mIGcuJHNjb3BlKXRocm93IHQoXCIkY29udHJvbGxlclwiKShcIm5vc2NwXCIsaHx8ZS5uYW1lLGwpO2cuJHNjb3BlW2xdPWZ9cmV0dXJuIGZ9fV19ZnVuY3Rpb24gUGQoKXt0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLGZ1bmN0aW9uKGIpe3JldHVybiB5KGIuZG9jdW1lbnQpfV19ZnVuY3Rpb24gUWQoKXt0aGlzLiRnZXQ9W1wiJGxvZ1wiLGZ1bmN0aW9uKGIpe3JldHVybiBmdW5jdGlvbihhLGMpe2IuZXJyb3IuYXBwbHkoYixhcmd1bWVudHMpfX1dfWZ1bmN0aW9uIHNjKGIpe3ZhciBhPXt9LGMsZCxlO2lmKCFiKXJldHVybiBhO3EoYi5zcGxpdChcIlxcblwiKSxmdW5jdGlvbihiKXtlPWIuaW5kZXhPZihcIjpcIik7Yz1LKGNhKGIuc3Vic3RyKDAsXG5lKSkpO2Q9Y2EoYi5zdWJzdHIoZSsxKSk7YyYmKGFbY109YVtjXT9hW2NdKyhcIiwgXCIrZCk6ZCl9KTtyZXR1cm4gYX1mdW5jdGlvbiB0YyhiKXt2YXIgYT1YKGIpP2I6cztyZXR1cm4gZnVuY3Rpb24oYyl7YXx8KGE9c2MoYikpO3JldHVybiBjP2FbSyhjKV18fG51bGw6YX19ZnVuY3Rpb24gdWMoYixhLGMpe2lmKFAoYykpcmV0dXJuIGMoYixhKTtxKGMsZnVuY3Rpb24oYyl7Yj1jKGIsYSl9KTtyZXR1cm4gYn1mdW5jdGlvbiBUZCgpe3ZhciBiPS9eXFxzKihcXFt8XFx7W15cXHtdKS8sYT0vW1xcfVxcXV1cXHMqJC8sYz0vXlxcKVxcXVxcfScsP1xcbi8sZD17XCJDb250ZW50LVR5cGVcIjpcImFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtOFwifSxlPXRoaXMuZGVmYXVsdHM9e3RyYW5zZm9ybVJlc3BvbnNlOltmdW5jdGlvbihkKXt3KGQpJiYoZD1kLnJlcGxhY2UoYyxcIlwiKSxiLnRlc3QoZCkmJmEudGVzdChkKSYmKGQ9V2IoZCkpKTtyZXR1cm4gZH1dLHRyYW5zZm9ybVJlcXVlc3Q6W2Z1bmN0aW9uKGEpe3JldHVybiBYKGEpJiZcblwiW29iamVjdCBGaWxlXVwiIT09d2EuY2FsbChhKSYmXCJbb2JqZWN0IEJsb2JdXCIhPT13YS5jYWxsKGEpP3FhKGEpOmF9XSxoZWFkZXJzOntjb21tb246e0FjY2VwdDpcImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKlwifSxwb3N0OmJhKGQpLHB1dDpiYShkKSxwYXRjaDpiYShkKX0seHNyZkNvb2tpZU5hbWU6XCJYU1JGLVRPS0VOXCIseHNyZkhlYWRlck5hbWU6XCJYLVhTUkYtVE9LRU5cIn0sZz10aGlzLmludGVyY2VwdG9ycz1bXSxmPXRoaXMucmVzcG9uc2VJbnRlcmNlcHRvcnM9W107dGhpcy4kZ2V0PVtcIiRodHRwQmFja2VuZFwiLFwiJGJyb3dzZXJcIixcIiRjYWNoZUZhY3RvcnlcIixcIiRyb290U2NvcGVcIixcIiRxXCIsXCIkaW5qZWN0b3JcIixmdW5jdGlvbihhLGIsYyxkLG4scCl7ZnVuY3Rpb24gcihhKXtmdW5jdGlvbiBjKGEpe3ZhciBiPUQoe30sYSx7ZGF0YTp1YyhhLmRhdGEsYS5oZWFkZXJzLGQudHJhbnNmb3JtUmVzcG9uc2UpfSk7cmV0dXJuIDIwMDw9YS5zdGF0dXMmJjMwMD5hLnN0YXR1cz9cbmI6bi5yZWplY3QoYil9dmFyIGQ9e21ldGhvZDpcImdldFwiLHRyYW5zZm9ybVJlcXVlc3Q6ZS50cmFuc2Zvcm1SZXF1ZXN0LHRyYW5zZm9ybVJlc3BvbnNlOmUudHJhbnNmb3JtUmVzcG9uc2V9LGc9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihhKXt2YXIgYztxKGEsZnVuY3Rpb24oYixkKXtQKGIpJiYoYz1iKCksbnVsbCE9Yz9hW2RdPWM6ZGVsZXRlIGFbZF0pfSl9dmFyIGM9ZS5oZWFkZXJzLGQ9RCh7fSxhLmhlYWRlcnMpLGcsZixjPUQoe30sYy5jb21tb24sY1tLKGEubWV0aG9kKV0pO2IoYyk7YihkKTthOmZvcihnIGluIGMpe2E9SyhnKTtmb3IoZiBpbiBkKWlmKEsoZik9PT1hKWNvbnRpbnVlIGE7ZFtnXT1jW2ddfXJldHVybiBkfShhKTtEKGQsYSk7ZC5oZWFkZXJzPWc7ZC5tZXRob2Q9RmEoZC5tZXRob2QpOyhhPUliKGQudXJsKT9iLmNvb2tpZXMoKVtkLnhzcmZDb29raWVOYW1lfHxlLnhzcmZDb29raWVOYW1lXTpzKSYmKGdbZC54c3JmSGVhZGVyTmFtZXx8ZS54c3JmSGVhZGVyTmFtZV09XG5hKTt2YXIgZj1bZnVuY3Rpb24oYSl7Zz1hLmhlYWRlcnM7dmFyIGI9dWMoYS5kYXRhLHRjKGcpLGEudHJhbnNmb3JtUmVxdWVzdCk7RShhLmRhdGEpJiZxKGcsZnVuY3Rpb24oYSxiKXtcImNvbnRlbnQtdHlwZVwiPT09SyhiKSYmZGVsZXRlIGdbYl19KTtFKGEud2l0aENyZWRlbnRpYWxzKSYmIUUoZS53aXRoQ3JlZGVudGlhbHMpJiYoYS53aXRoQ3JlZGVudGlhbHM9ZS53aXRoQ3JlZGVudGlhbHMpO3JldHVybiB6KGEsYixnKS50aGVuKGMsYyl9LHNdLGg9bi53aGVuKGQpO2ZvcihxKHYsZnVuY3Rpb24oYSl7KGEucmVxdWVzdHx8YS5yZXF1ZXN0RXJyb3IpJiZmLnVuc2hpZnQoYS5yZXF1ZXN0LGEucmVxdWVzdEVycm9yKTsoYS5yZXNwb25zZXx8YS5yZXNwb25zZUVycm9yKSYmZi5wdXNoKGEucmVzcG9uc2UsYS5yZXNwb25zZUVycm9yKX0pO2YubGVuZ3RoOyl7YT1mLnNoaWZ0KCk7dmFyIGs9Zi5zaGlmdCgpLGg9aC50aGVuKGEsayl9aC5zdWNjZXNzPWZ1bmN0aW9uKGEpe2gudGhlbihmdW5jdGlvbihiKXthKGIuZGF0YSxcbmIuc3RhdHVzLGIuaGVhZGVycyxkKX0pO3JldHVybiBofTtoLmVycm9yPWZ1bmN0aW9uKGEpe2gudGhlbihudWxsLGZ1bmN0aW9uKGIpe2EoYi5kYXRhLGIuc3RhdHVzLGIuaGVhZGVycyxkKX0pO3JldHVybiBofTtyZXR1cm4gaH1mdW5jdGlvbiB6KGIsYyxnKXtmdW5jdGlvbiBmKGEsYixjLGUpe3YmJigyMDA8PWEmJjMwMD5hP3YucHV0KHMsW2EsYixzYyhjKSxlXSk6di5yZW1vdmUocykpO2woYixhLGMsZSk7ZC4kJHBoYXNlfHxkLiRhcHBseSgpfWZ1bmN0aW9uIGwoYSxjLGQsZSl7Yz1NYXRoLm1heChjLDApOygyMDA8PWMmJjMwMD5jP3AucmVzb2x2ZTpwLnJlamVjdCkoe2RhdGE6YSxzdGF0dXM6YyxoZWFkZXJzOnRjKGQpLGNvbmZpZzpiLHN0YXR1c1RleHQ6ZX0pfWZ1bmN0aW9uIGsoKXt2YXIgYT1kYihyLnBlbmRpbmdSZXF1ZXN0cyxiKTstMSE9PWEmJnIucGVuZGluZ1JlcXVlc3RzLnNwbGljZShhLDEpfXZhciBwPW4uZGVmZXIoKSx6PXAucHJvbWlzZSx2LHEscz11KGIudXJsLFxuYi5wYXJhbXMpO3IucGVuZGluZ1JlcXVlc3RzLnB1c2goYik7ei50aGVuKGssayk7KGIuY2FjaGV8fGUuY2FjaGUpJiYoITEhPT1iLmNhY2hlJiZcIkdFVFwiPT1iLm1ldGhvZCkmJih2PVgoYi5jYWNoZSk/Yi5jYWNoZTpYKGUuY2FjaGUpP2UuY2FjaGU6Rik7aWYodilpZihxPXYuZ2V0KHMpLEIocSkpe2lmKHEudGhlbilyZXR1cm4gcS50aGVuKGssaykscTtNKHEpP2wocVsxXSxxWzBdLGJhKHFbMl0pLHFbM10pOmwocSwyMDAse30sXCJPS1wiKX1lbHNlIHYucHV0KHMseik7RShxKSYmYShiLm1ldGhvZCxzLGMsZixnLGIudGltZW91dCxiLndpdGhDcmVkZW50aWFscyxiLnJlc3BvbnNlVHlwZSk7cmV0dXJuIHp9ZnVuY3Rpb24gdShhLGIpe2lmKCFiKXJldHVybiBhO3ZhciBjPVtdO1NjKGIsZnVuY3Rpb24oYSxiKXtudWxsPT09YXx8RShhKXx8KE0oYSl8fChhPVthXSkscShhLGZ1bmN0aW9uKGEpe1goYSkmJihhPXFhKGEpKTtjLnB1c2goemEoYikrXCI9XCIremEoYSkpfSkpfSk7MDxjLmxlbmd0aCYmXG4oYSs9KC0xPT1hLmluZGV4T2YoXCI/XCIpP1wiP1wiOlwiJlwiKStjLmpvaW4oXCImXCIpKTtyZXR1cm4gYX12YXIgRj1jKFwiJGh0dHBcIiksdj1bXTtxKGcsZnVuY3Rpb24oYSl7di51bnNoaWZ0KHcoYSk/cC5nZXQoYSk6cC5pbnZva2UoYSkpfSk7cShmLGZ1bmN0aW9uKGEsYil7dmFyIGM9dyhhKT9wLmdldChhKTpwLmludm9rZShhKTt2LnNwbGljZShiLDAse3Jlc3BvbnNlOmZ1bmN0aW9uKGEpe3JldHVybiBjKG4ud2hlbihhKSl9LHJlc3BvbnNlRXJyb3I6ZnVuY3Rpb24oYSl7cmV0dXJuIGMobi5yZWplY3QoYSkpfX0pfSk7ci5wZW5kaW5nUmVxdWVzdHM9W107KGZ1bmN0aW9uKGEpe3EoYXJndW1lbnRzLGZ1bmN0aW9uKGEpe3JbYV09ZnVuY3Rpb24oYixjKXtyZXR1cm4gcihEKGN8fHt9LHttZXRob2Q6YSx1cmw6Yn0pKX19KX0pKFwiZ2V0XCIsXCJkZWxldGVcIixcImhlYWRcIixcImpzb25wXCIpOyhmdW5jdGlvbihhKXtxKGFyZ3VtZW50cyxmdW5jdGlvbihhKXtyW2FdPWZ1bmN0aW9uKGIsYyxkKXtyZXR1cm4gcihEKGR8fFxue30se21ldGhvZDphLHVybDpiLGRhdGE6Y30pKX19KX0pKFwicG9zdFwiLFwicHV0XCIpO3IuZGVmYXVsdHM9ZTtyZXR1cm4gcn1dfWZ1bmN0aW9uIHVlKGIpe2lmKDg+PVMmJighYi5tYXRjaCgvXihnZXR8cG9zdHxoZWFkfHB1dHxkZWxldGV8b3B0aW9ucykkL2kpfHwhTy5YTUxIdHRwUmVxdWVzdCkpcmV0dXJuIG5ldyBPLkFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MSFRUUFwiKTtpZihPLlhNTEh0dHBSZXF1ZXN0KXJldHVybiBuZXcgTy5YTUxIdHRwUmVxdWVzdDt0aHJvdyB0KFwiJGh0dHBCYWNrZW5kXCIpKFwibm94aHJcIik7fWZ1bmN0aW9uIFVkKCl7dGhpcy4kZ2V0PVtcIiRicm93c2VyXCIsXCIkd2luZG93XCIsXCIkZG9jdW1lbnRcIixmdW5jdGlvbihiLGEsYyl7cmV0dXJuIHZlKGIsdWUsYi5kZWZlcixhLmFuZ3VsYXIuY2FsbGJhY2tzLGNbMF0pfV19ZnVuY3Rpb24gdmUoYixhLGMsZCxlKXtmdW5jdGlvbiBnKGEsYil7dmFyIGM9ZS5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpLGQ9ZnVuY3Rpb24oKXtjLm9ucmVhZHlzdGF0ZWNoYW5nZT1cbmMub25sb2FkPWMub25lcnJvcj1udWxsO2UuYm9keS5yZW1vdmVDaGlsZChjKTtiJiZiKCl9O2MudHlwZT1cInRleHQvamF2YXNjcmlwdFwiO2Muc3JjPWE7UyYmOD49Uz9jLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpey9sb2FkZWR8Y29tcGxldGUvLnRlc3QoYy5yZWFkeVN0YXRlKSYmZCgpfTpjLm9ubG9hZD1jLm9uZXJyb3I9ZnVuY3Rpb24oKXtkKCl9O2UuYm9keS5hcHBlbmRDaGlsZChjKTtyZXR1cm4gZH12YXIgZj0tMTtyZXR1cm4gZnVuY3Rpb24oZSxsLGssbSxuLHAscix6KXtmdW5jdGlvbiB1KCl7dj1mO0EmJkEoKTt4JiZ4LmFib3J0KCl9ZnVuY3Rpb24gRihhLGQsZSxnLGYpe0wmJmMuY2FuY2VsKEwpO0E9eD1udWxsOzA9PT1kJiYoZD1lPzIwMDpcImZpbGVcIj09c2EobCkucHJvdG9jb2w/NDA0OjApO2EoMTIyMz09PWQ/MjA0OmQsZSxnLGZ8fFwiXCIpO2IuJCRjb21wbGV0ZU91dHN0YW5kaW5nUmVxdWVzdChDKX12YXIgdjtiLiQkaW5jT3V0c3RhbmRpbmdSZXF1ZXN0Q291bnQoKTtcbmw9bHx8Yi51cmwoKTtpZihcImpzb25wXCI9PUsoZSkpe3ZhciBKPVwiX1wiKyhkLmNvdW50ZXIrKykudG9TdHJpbmcoMzYpO2RbSl09ZnVuY3Rpb24oYSl7ZFtKXS5kYXRhPWF9O3ZhciBBPWcobC5yZXBsYWNlKFwiSlNPTl9DQUxMQkFDS1wiLFwiYW5ndWxhci5jYWxsYmFja3MuXCIrSiksZnVuY3Rpb24oKXtkW0pdLmRhdGE/RihtLDIwMCxkW0pdLmRhdGEpOkYobSx2fHwtMik7ZFtKXT1FYS5ub29wfSl9ZWxzZXt2YXIgeD1hKGUpO3gub3BlbihlLGwsITApO3EobixmdW5jdGlvbihhLGIpe0IoYSkmJnguc2V0UmVxdWVzdEhlYWRlcihiLGEpfSk7eC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXtpZih4JiY0PT14LnJlYWR5U3RhdGUpe3ZhciBhPW51bGwsYj1udWxsO3YhPT1mJiYoYT14LmdldEFsbFJlc3BvbnNlSGVhZGVycygpLGI9XCJyZXNwb25zZVwiaW4geD94LnJlc3BvbnNlOngucmVzcG9uc2VUZXh0KTtGKG0sdnx8eC5zdGF0dXMsYixhLHguc3RhdHVzVGV4dHx8XCJcIil9fTtyJiYoeC53aXRoQ3JlZGVudGlhbHM9XG4hMCk7aWYoeil0cnl7eC5yZXNwb25zZVR5cGU9en1jYXRjaChzKXtpZihcImpzb25cIiE9PXopdGhyb3cgczt9eC5zZW5kKGt8fG51bGwpfWlmKDA8cCl2YXIgTD1jKHUscCk7ZWxzZSBwJiZwLnRoZW4mJnAudGhlbih1KX19ZnVuY3Rpb24gUmQoKXt2YXIgYj1cInt7XCIsYT1cIn19XCI7dGhpcy5zdGFydFN5bWJvbD1mdW5jdGlvbihhKXtyZXR1cm4gYT8oYj1hLHRoaXMpOmJ9O3RoaXMuZW5kU3ltYm9sPWZ1bmN0aW9uKGIpe3JldHVybiBiPyhhPWIsdGhpcyk6YX07dGhpcy4kZ2V0PVtcIiRwYXJzZVwiLFwiJGV4Y2VwdGlvbkhhbmRsZXJcIixcIiRzY2VcIixmdW5jdGlvbihjLGQsZSl7ZnVuY3Rpb24gZyhnLGssbSl7Zm9yKHZhciBuLHAscj0wLHo9W10sdT1nLmxlbmd0aCxGPSExLHY9W107cjx1OyktMSE9KG49Zy5pbmRleE9mKGIscikpJiYtMSE9KHA9Zy5pbmRleE9mKGEsbitmKSk/KHIhPW4mJnoucHVzaChnLnN1YnN0cmluZyhyLG4pKSx6LnB1c2gocj1jKEY9Zy5zdWJzdHJpbmcobitmLHApKSksXG5yLmV4cD1GLHI9cCtoLEY9ITApOihyIT11JiZ6LnB1c2goZy5zdWJzdHJpbmcocikpLHI9dSk7KHU9ei5sZW5ndGgpfHwoei5wdXNoKFwiXCIpLHU9MSk7aWYobSYmMTx6Lmxlbmd0aCl0aHJvdyB2YyhcIm5vY29uY2F0XCIsZyk7aWYoIWt8fEYpcmV0dXJuIHYubGVuZ3RoPXUscj1mdW5jdGlvbihhKXt0cnl7Zm9yKHZhciBiPTAsYz11LGY7YjxjO2IrKylcImZ1bmN0aW9uXCI9PXR5cGVvZihmPXpbYl0pJiYoZj1mKGEpLGY9bT9lLmdldFRydXN0ZWQobSxmKTplLnZhbHVlT2YoZiksbnVsbD09PWZ8fEUoZik/Zj1cIlwiOlwic3RyaW5nXCIhPXR5cGVvZiBmJiYoZj1xYShmKSkpLHZbYl09ZjtyZXR1cm4gdi5qb2luKFwiXCIpfWNhdGNoKGgpe2E9dmMoXCJpbnRlcnJcIixnLGgudG9TdHJpbmcoKSksZChhKX19LHIuZXhwPWcsci5wYXJ0cz16LHJ9dmFyIGY9Yi5sZW5ndGgsaD1hLmxlbmd0aDtnLnN0YXJ0U3ltYm9sPWZ1bmN0aW9uKCl7cmV0dXJuIGJ9O2cuZW5kU3ltYm9sPWZ1bmN0aW9uKCl7cmV0dXJuIGF9O1xucmV0dXJuIGd9XX1mdW5jdGlvbiBTZCgpe3RoaXMuJGdldD1bXCIkcm9vdFNjb3BlXCIsXCIkd2luZG93XCIsXCIkcVwiLGZ1bmN0aW9uKGIsYSxjKXtmdW5jdGlvbiBkKGQsZixoLGwpe3ZhciBrPWEuc2V0SW50ZXJ2YWwsbT1hLmNsZWFySW50ZXJ2YWwsbj1jLmRlZmVyKCkscD1uLnByb21pc2Uscj0wLHo9QihsKSYmIWw7aD1CKGgpP2g6MDtwLnRoZW4obnVsbCxudWxsLGQpO3AuJCRpbnRlcnZhbElkPWsoZnVuY3Rpb24oKXtuLm5vdGlmeShyKyspOzA8aCYmcj49aCYmKG4ucmVzb2x2ZShyKSxtKHAuJCRpbnRlcnZhbElkKSxkZWxldGUgZVtwLiQkaW50ZXJ2YWxJZF0pO3p8fGIuJGFwcGx5KCl9LGYpO2VbcC4kJGludGVydmFsSWRdPW47cmV0dXJuIHB9dmFyIGU9e307ZC5jYW5jZWw9ZnVuY3Rpb24oYSl7cmV0dXJuIGEmJmEuJCRpbnRlcnZhbElkIGluIGU/KGVbYS4kJGludGVydmFsSWRdLnJlamVjdChcImNhbmNlbGVkXCIpLGNsZWFySW50ZXJ2YWwoYS4kJGludGVydmFsSWQpLGRlbGV0ZSBlW2EuJCRpbnRlcnZhbElkXSxcbiEwKTohMX07cmV0dXJuIGR9XX1mdW5jdGlvbiBhZCgpe3RoaXMuJGdldD1mdW5jdGlvbigpe3JldHVybntpZDpcImVuLXVzXCIsTlVNQkVSX0ZPUk1BVFM6e0RFQ0lNQUxfU0VQOlwiLlwiLEdST1VQX1NFUDpcIixcIixQQVRURVJOUzpbe21pbkludDoxLG1pbkZyYWM6MCxtYXhGcmFjOjMscG9zUHJlOlwiXCIscG9zU3VmOlwiXCIsbmVnUHJlOlwiLVwiLG5lZ1N1ZjpcIlwiLGdTaXplOjMsbGdTaXplOjN9LHttaW5JbnQ6MSxtaW5GcmFjOjIsbWF4RnJhYzoyLHBvc1ByZTpcIlxcdTAwYTRcIixwb3NTdWY6XCJcIixuZWdQcmU6XCIoXFx1MDBhNFwiLG5lZ1N1ZjpcIilcIixnU2l6ZTozLGxnU2l6ZTozfV0sQ1VSUkVOQ1lfU1lNOlwiJFwifSxEQVRFVElNRV9GT1JNQVRTOntNT05USDpcIkphbnVhcnkgRmVicnVhcnkgTWFyY2ggQXByaWwgTWF5IEp1bmUgSnVseSBBdWd1c3QgU2VwdGVtYmVyIE9jdG9iZXIgTm92ZW1iZXIgRGVjZW1iZXJcIi5zcGxpdChcIiBcIiksU0hPUlRNT05USDpcIkphbiBGZWIgTWFyIEFwciBNYXkgSnVuIEp1bCBBdWcgU2VwIE9jdCBOb3YgRGVjXCIuc3BsaXQoXCIgXCIpLFxuREFZOlwiU3VuZGF5IE1vbmRheSBUdWVzZGF5IFdlZG5lc2RheSBUaHVyc2RheSBGcmlkYXkgU2F0dXJkYXlcIi5zcGxpdChcIiBcIiksU0hPUlREQVk6XCJTdW4gTW9uIFR1ZSBXZWQgVGh1IEZyaSBTYXRcIi5zcGxpdChcIiBcIiksQU1QTVM6W1wiQU1cIixcIlBNXCJdLG1lZGl1bTpcIk1NTSBkLCB5IGg6bW06c3MgYVwiLFwic2hvcnRcIjpcIk0vZC95eSBoOm1tIGFcIixmdWxsRGF0ZTpcIkVFRUUsIE1NTU0gZCwgeVwiLGxvbmdEYXRlOlwiTU1NTSBkLCB5XCIsbWVkaXVtRGF0ZTpcIk1NTSBkLCB5XCIsc2hvcnREYXRlOlwiTS9kL3l5XCIsbWVkaXVtVGltZTpcImg6bW06c3MgYVwiLHNob3J0VGltZTpcImg6bW0gYVwifSxwbHVyYWxDYXQ6ZnVuY3Rpb24oYil7cmV0dXJuIDE9PT1iP1wib25lXCI6XCJvdGhlclwifX19fWZ1bmN0aW9uIHdjKGIpe2I9Yi5zcGxpdChcIi9cIik7Zm9yKHZhciBhPWIubGVuZ3RoO2EtLTspYlthXT13YihiW2FdKTtyZXR1cm4gYi5qb2luKFwiL1wiKX1mdW5jdGlvbiB4YyhiLGEsYyl7Yj1zYShiLGMpO2EuJCRwcm90b2NvbD1cbmIucHJvdG9jb2w7YS4kJGhvc3Q9Yi5ob3N0bmFtZTthLiQkcG9ydD1ZKGIucG9ydCl8fHdlW2IucHJvdG9jb2xdfHxudWxsfWZ1bmN0aW9uIHljKGIsYSxjKXt2YXIgZD1cIi9cIiE9PWIuY2hhckF0KDApO2QmJihiPVwiL1wiK2IpO2I9c2EoYixjKTthLiQkcGF0aD1kZWNvZGVVUklDb21wb25lbnQoZCYmXCIvXCI9PT1iLnBhdGhuYW1lLmNoYXJBdCgwKT9iLnBhdGhuYW1lLnN1YnN0cmluZygxKTpiLnBhdGhuYW1lKTthLiQkc2VhcmNoPVliKGIuc2VhcmNoKTthLiQkaGFzaD1kZWNvZGVVUklDb21wb25lbnQoYi5oYXNoKTthLiQkcGF0aCYmXCIvXCIhPWEuJCRwYXRoLmNoYXJBdCgwKSYmKGEuJCRwYXRoPVwiL1wiK2EuJCRwYXRoKX1mdW5jdGlvbiBvYShiLGEpe2lmKDA9PT1hLmluZGV4T2YoYikpcmV0dXJuIGEuc3Vic3RyKGIubGVuZ3RoKX1mdW5jdGlvbiBZYShiKXt2YXIgYT1iLmluZGV4T2YoXCIjXCIpO3JldHVybi0xPT1hP2I6Yi5zdWJzdHIoMCxhKX1mdW5jdGlvbiBKYihiKXtyZXR1cm4gYi5zdWJzdHIoMCxcbllhKGIpLmxhc3RJbmRleE9mKFwiL1wiKSsxKX1mdW5jdGlvbiB6YyhiLGEpe3RoaXMuJCRodG1sNT0hMDthPWF8fFwiXCI7dmFyIGM9SmIoYik7eGMoYix0aGlzLGIpO3RoaXMuJCRwYXJzZT1mdW5jdGlvbihhKXt2YXIgZT1vYShjLGEpO2lmKCF3KGUpKXRocm93IEtiKFwiaXB0aHByZnhcIixhLGMpO3ljKGUsdGhpcyxiKTt0aGlzLiQkcGF0aHx8KHRoaXMuJCRwYXRoPVwiL1wiKTt0aGlzLiQkY29tcG9zZSgpfTt0aGlzLiQkY29tcG9zZT1mdW5jdGlvbigpe3ZhciBhPVpiKHRoaXMuJCRzZWFyY2gpLGI9dGhpcy4kJGhhc2g/XCIjXCIrd2IodGhpcy4kJGhhc2gpOlwiXCI7dGhpcy4kJHVybD13Yyh0aGlzLiQkcGF0aCkrKGE/XCI/XCIrYTpcIlwiKStiO3RoaXMuJCRhYnNVcmw9Yyt0aGlzLiQkdXJsLnN1YnN0cigxKX07dGhpcy4kJHJld3JpdGU9ZnVuY3Rpb24oZCl7dmFyIGU7aWYoKGU9b2EoYixkKSkhPT1zKXJldHVybiBkPWUsKGU9b2EoYSxlKSkhPT1zP2MrKG9hKFwiL1wiLGUpfHxlKTpiK2Q7aWYoKGU9b2EoYyxcbmQpKSE9PXMpcmV0dXJuIGMrZTtpZihjPT1kK1wiL1wiKXJldHVybiBjfX1mdW5jdGlvbiBMYihiLGEpe3ZhciBjPUpiKGIpO3hjKGIsdGhpcyxiKTt0aGlzLiQkcGFyc2U9ZnVuY3Rpb24oZCl7dmFyIGU9b2EoYixkKXx8b2EoYyxkKSxlPVwiI1wiPT1lLmNoYXJBdCgwKT9vYShhLGUpOnRoaXMuJCRodG1sNT9lOlwiXCI7aWYoIXcoZSkpdGhyb3cgS2IoXCJpaHNocHJmeFwiLGQsYSk7eWMoZSx0aGlzLGIpO2Q9dGhpcy4kJHBhdGg7dmFyIGc9L15cXC8/Lio/OihcXC8uKikvOzA9PT1lLmluZGV4T2YoYikmJihlPWUucmVwbGFjZShiLFwiXCIpKTtnLmV4ZWMoZSl8fChkPShlPWcuZXhlYyhkKSk/ZVsxXTpkKTt0aGlzLiQkcGF0aD1kO3RoaXMuJCRjb21wb3NlKCl9O3RoaXMuJCRjb21wb3NlPWZ1bmN0aW9uKCl7dmFyIGM9WmIodGhpcy4kJHNlYXJjaCksZT10aGlzLiQkaGFzaD9cIiNcIit3Yih0aGlzLiQkaGFzaCk6XCJcIjt0aGlzLiQkdXJsPXdjKHRoaXMuJCRwYXRoKSsoYz9cIj9cIitjOlwiXCIpK2U7dGhpcy4kJGFic1VybD1cbmIrKHRoaXMuJCR1cmw/YSt0aGlzLiQkdXJsOlwiXCIpfTt0aGlzLiQkcmV3cml0ZT1mdW5jdGlvbihhKXtpZihZYShiKT09WWEoYSkpcmV0dXJuIGF9fWZ1bmN0aW9uIEFjKGIsYSl7dGhpcy4kJGh0bWw1PSEwO0xiLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgYz1KYihiKTt0aGlzLiQkcmV3cml0ZT1mdW5jdGlvbihkKXt2YXIgZTtpZihiPT1ZYShkKSlyZXR1cm4gZDtpZihlPW9hKGMsZCkpcmV0dXJuIGIrYStlO2lmKGM9PT1kK1wiL1wiKXJldHVybiBjfX1mdW5jdGlvbiBuYihiKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdGhpc1tiXX19ZnVuY3Rpb24gQmMoYixhKXtyZXR1cm4gZnVuY3Rpb24oYyl7aWYoRShjKSlyZXR1cm4gdGhpc1tiXTt0aGlzW2JdPWEoYyk7dGhpcy4kJGNvbXBvc2UoKTtyZXR1cm4gdGhpc319ZnVuY3Rpb24gVmQoKXt2YXIgYj1cIlwiLGE9ITE7dGhpcy5oYXNoUHJlZml4PWZ1bmN0aW9uKGEpe3JldHVybiBCKGEpPyhiPWEsdGhpcyk6Yn07dGhpcy5odG1sNU1vZGU9XG5mdW5jdGlvbihiKXtyZXR1cm4gQihiKT8oYT1iLHRoaXMpOmF9O3RoaXMuJGdldD1bXCIkcm9vdFNjb3BlXCIsXCIkYnJvd3NlclwiLFwiJHNuaWZmZXJcIixcIiRyb290RWxlbWVudFwiLGZ1bmN0aW9uKGMsZCxlLGcpe2Z1bmN0aW9uIGYoYSl7Yy4kYnJvYWRjYXN0KFwiJGxvY2F0aW9uQ2hhbmdlU3VjY2Vzc1wiLGguYWJzVXJsKCksYSl9dmFyIGgsbD1kLmJhc2VIcmVmKCksaz1kLnVybCgpO2E/KGw9ay5zdWJzdHJpbmcoMCxrLmluZGV4T2YoXCIvXCIsay5pbmRleE9mKFwiLy9cIikrMikpKyhsfHxcIi9cIiksZT1lLmhpc3Rvcnk/emM6QWMpOihsPVlhKGspLGU9TGIpO2g9bmV3IGUobCxcIiNcIitiKTtoLiQkcGFyc2UoaC4kJHJld3JpdGUoaykpO2cub24oXCJjbGlja1wiLGZ1bmN0aW9uKGEpe2lmKCFhLmN0cmxLZXkmJiFhLm1ldGFLZXkmJjIhPWEud2hpY2gpe2Zvcih2YXIgYj15KGEudGFyZ2V0KTtcImFcIiE9PUsoYlswXS5ub2RlTmFtZSk7KWlmKGJbMF09PT1nWzBdfHwhKGI9Yi5wYXJlbnQoKSlbMF0pcmV0dXJuO1xudmFyIGU9Yi5wcm9wKFwiaHJlZlwiKTtYKGUpJiZcIltvYmplY3QgU1ZHQW5pbWF0ZWRTdHJpbmddXCI9PT1lLnRvU3RyaW5nKCkmJihlPXNhKGUuYW5pbVZhbCkuaHJlZik7dmFyIGY9aC4kJHJld3JpdGUoZSk7ZSYmKCFiLmF0dHIoXCJ0YXJnZXRcIikmJmYmJiFhLmlzRGVmYXVsdFByZXZlbnRlZCgpKSYmKGEucHJldmVudERlZmF1bHQoKSxmIT1kLnVybCgpJiYoaC4kJHBhcnNlKGYpLGMuJGFwcGx5KCksTy5hbmd1bGFyW1wiZmYtNjg0MjA4LXByZXZlbnREZWZhdWx0XCJdPSEwKSl9fSk7aC5hYnNVcmwoKSE9ayYmZC51cmwoaC5hYnNVcmwoKSwhMCk7ZC5vblVybENoYW5nZShmdW5jdGlvbihhKXtoLmFic1VybCgpIT1hJiYoYy4kZXZhbEFzeW5jKGZ1bmN0aW9uKCl7dmFyIGI9aC5hYnNVcmwoKTtoLiQkcGFyc2UoYSk7Yy4kYnJvYWRjYXN0KFwiJGxvY2F0aW9uQ2hhbmdlU3RhcnRcIixhLGIpLmRlZmF1bHRQcmV2ZW50ZWQ/KGguJCRwYXJzZShiKSxkLnVybChiKSk6ZihiKX0pLGMuJCRwaGFzZXx8XG5jLiRkaWdlc3QoKSl9KTt2YXIgbT0wO2MuJHdhdGNoKGZ1bmN0aW9uKCl7dmFyIGE9ZC51cmwoKSxiPWguJCRyZXBsYWNlO20mJmE9PWguYWJzVXJsKCl8fChtKyssYy4kZXZhbEFzeW5jKGZ1bmN0aW9uKCl7Yy4kYnJvYWRjYXN0KFwiJGxvY2F0aW9uQ2hhbmdlU3RhcnRcIixoLmFic1VybCgpLGEpLmRlZmF1bHRQcmV2ZW50ZWQ/aC4kJHBhcnNlKGEpOihkLnVybChoLmFic1VybCgpLGIpLGYoYSkpfSkpO2guJCRyZXBsYWNlPSExO3JldHVybiBtfSk7cmV0dXJuIGh9XX1mdW5jdGlvbiBXZCgpe3ZhciBiPSEwLGE9dGhpczt0aGlzLmRlYnVnRW5hYmxlZD1mdW5jdGlvbihhKXtyZXR1cm4gQihhKT8oYj1hLHRoaXMpOmJ9O3RoaXMuJGdldD1bXCIkd2luZG93XCIsZnVuY3Rpb24oYyl7ZnVuY3Rpb24gZChhKXthIGluc3RhbmNlb2YgRXJyb3ImJihhLnN0YWNrP2E9YS5tZXNzYWdlJiYtMT09PWEuc3RhY2suaW5kZXhPZihhLm1lc3NhZ2UpP1wiRXJyb3I6IFwiK2EubWVzc2FnZStcIlxcblwiK2Euc3RhY2s6XG5hLnN0YWNrOmEuc291cmNlVVJMJiYoYT1hLm1lc3NhZ2UrXCJcXG5cIithLnNvdXJjZVVSTCtcIjpcIithLmxpbmUpKTtyZXR1cm4gYX1mdW5jdGlvbiBlKGEpe3ZhciBiPWMuY29uc29sZXx8e30sZT1iW2FdfHxiLmxvZ3x8QzthPSExO3RyeXthPSEhZS5hcHBseX1jYXRjaChsKXt9cmV0dXJuIGE/ZnVuY3Rpb24oKXt2YXIgYT1bXTtxKGFyZ3VtZW50cyxmdW5jdGlvbihiKXthLnB1c2goZChiKSl9KTtyZXR1cm4gZS5hcHBseShiLGEpfTpmdW5jdGlvbihhLGIpe2UoYSxudWxsPT1iP1wiXCI6Yil9fXJldHVybntsb2c6ZShcImxvZ1wiKSxpbmZvOmUoXCJpbmZvXCIpLHdhcm46ZShcIndhcm5cIiksZXJyb3I6ZShcImVycm9yXCIpLGRlYnVnOmZ1bmN0aW9uKCl7dmFyIGM9ZShcImRlYnVnXCIpO3JldHVybiBmdW5jdGlvbigpe2ImJmMuYXBwbHkoYSxhcmd1bWVudHMpfX0oKX19XX1mdW5jdGlvbiBmYShiLGEpe2lmKFwiY29uc3RydWN0b3JcIj09PWIpdGhyb3cgQmEoXCJpc2VjZmxkXCIsYSk7cmV0dXJuIGJ9ZnVuY3Rpb24gWmEoYixcbmEpe2lmKGIpe2lmKGIuY29uc3RydWN0b3I9PT1iKXRocm93IEJhKFwiaXNlY2ZuXCIsYSk7aWYoYi5kb2N1bWVudCYmYi5sb2NhdGlvbiYmYi5hbGVydCYmYi5zZXRJbnRlcnZhbCl0aHJvdyBCYShcImlzZWN3aW5kb3dcIixhKTtpZihiLmNoaWxkcmVuJiYoYi5ub2RlTmFtZXx8Yi5wcm9wJiZiLmF0dHImJmIuZmluZCkpdGhyb3cgQmEoXCJpc2VjZG9tXCIsYSk7fXJldHVybiBifWZ1bmN0aW9uIG9iKGIsYSxjLGQsZSl7ZT1lfHx7fTthPWEuc3BsaXQoXCIuXCIpO2Zvcih2YXIgZyxmPTA7MTxhLmxlbmd0aDtmKyspe2c9ZmEoYS5zaGlmdCgpLGQpO3ZhciBoPWJbZ107aHx8KGg9e30sYltnXT1oKTtiPWg7Yi50aGVuJiZlLnVud3JhcFByb21pc2VzJiYodGEoZCksXCIkJHZcImluIGJ8fGZ1bmN0aW9uKGEpe2EudGhlbihmdW5jdGlvbihiKXthLiQkdj1ifSl9KGIpLGIuJCR2PT09cyYmKGIuJCR2PXt9KSxiPWIuJCR2KX1nPWZhKGEuc2hpZnQoKSxkKTtyZXR1cm4gYltnXT1jfWZ1bmN0aW9uIENjKGIsXG5hLGMsZCxlLGcsZil7ZmEoYixnKTtmYShhLGcpO2ZhKGMsZyk7ZmEoZCxnKTtmYShlLGcpO3JldHVybiBmLnVud3JhcFByb21pc2VzP2Z1bmN0aW9uKGYsbCl7dmFyIGs9bCYmbC5oYXNPd25Qcm9wZXJ0eShiKT9sOmYsbTtpZihudWxsPT1rKXJldHVybiBrOyhrPWtbYl0pJiZrLnRoZW4mJih0YShnKSxcIiQkdlwiaW4ga3x8KG09ayxtLiQkdj1zLG0udGhlbihmdW5jdGlvbihhKXttLiQkdj1hfSkpLGs9ay4kJHYpO2lmKCFhKXJldHVybiBrO2lmKG51bGw9PWspcmV0dXJuIHM7KGs9a1thXSkmJmsudGhlbiYmKHRhKGcpLFwiJCR2XCJpbiBrfHwobT1rLG0uJCR2PXMsbS50aGVuKGZ1bmN0aW9uKGEpe20uJCR2PWF9KSksaz1rLiQkdik7aWYoIWMpcmV0dXJuIGs7aWYobnVsbD09aylyZXR1cm4gczsoaz1rW2NdKSYmay50aGVuJiYodGEoZyksXCIkJHZcImluIGt8fChtPWssbS4kJHY9cyxtLnRoZW4oZnVuY3Rpb24oYSl7bS4kJHY9YX0pKSxrPWsuJCR2KTtpZighZClyZXR1cm4gaztpZihudWxsPT1cbmspcmV0dXJuIHM7KGs9a1tkXSkmJmsudGhlbiYmKHRhKGcpLFwiJCR2XCJpbiBrfHwobT1rLG0uJCR2PXMsbS50aGVuKGZ1bmN0aW9uKGEpe20uJCR2PWF9KSksaz1rLiQkdik7aWYoIWUpcmV0dXJuIGs7aWYobnVsbD09aylyZXR1cm4gczsoaz1rW2VdKSYmay50aGVuJiYodGEoZyksXCIkJHZcImluIGt8fChtPWssbS4kJHY9cyxtLnRoZW4oZnVuY3Rpb24oYSl7bS4kJHY9YX0pKSxrPWsuJCR2KTtyZXR1cm4ga306ZnVuY3Rpb24oZyxmKXt2YXIgaz1mJiZmLmhhc093blByb3BlcnR5KGIpP2Y6ZztpZihudWxsPT1rKXJldHVybiBrO2s9a1tiXTtpZighYSlyZXR1cm4gaztpZihudWxsPT1rKXJldHVybiBzO2s9a1thXTtpZighYylyZXR1cm4gaztpZihudWxsPT1rKXJldHVybiBzO2s9a1tjXTtpZighZClyZXR1cm4gaztpZihudWxsPT1rKXJldHVybiBzO2s9a1tkXTtyZXR1cm4gZT9udWxsPT1rP3M6az1rW2VdOmt9fWZ1bmN0aW9uIHhlKGIsYSl7ZmEoYixhKTtyZXR1cm4gZnVuY3Rpb24oYSxcbmQpe3JldHVybiBudWxsPT1hP3M6KGQmJmQuaGFzT3duUHJvcGVydHkoYik/ZDphKVtiXX19ZnVuY3Rpb24geWUoYixhLGMpe2ZhKGIsYyk7ZmEoYSxjKTtyZXR1cm4gZnVuY3Rpb24oYyxlKXtpZihudWxsPT1jKXJldHVybiBzO2M9KGUmJmUuaGFzT3duUHJvcGVydHkoYik/ZTpjKVtiXTtyZXR1cm4gbnVsbD09Yz9zOmNbYV19fWZ1bmN0aW9uIERjKGIsYSxjKXtpZihNYi5oYXNPd25Qcm9wZXJ0eShiKSlyZXR1cm4gTWJbYl07dmFyIGQ9Yi5zcGxpdChcIi5cIiksZT1kLmxlbmd0aCxnO2lmKGEudW53cmFwUHJvbWlzZXN8fDEhPT1lKWlmKGEudW53cmFwUHJvbWlzZXN8fDIhPT1lKWlmKGEuY3NwKWc9Nj5lP0NjKGRbMF0sZFsxXSxkWzJdLGRbM10sZFs0XSxjLGEpOmZ1bmN0aW9uKGIsZyl7dmFyIGY9MCxoO2RvIGg9Q2MoZFtmKytdLGRbZisrXSxkW2YrK10sZFtmKytdLGRbZisrXSxjLGEpKGIsZyksZz1zLGI9aDt3aGlsZShmPGUpO3JldHVybiBofTtlbHNle3ZhciBmPVwidmFyIHA7XFxuXCI7XG5xKGQsZnVuY3Rpb24oYixkKXtmYShiLGMpO2YrPVwiaWYocyA9PSBudWxsKSByZXR1cm4gdW5kZWZpbmVkO1xcbnM9XCIrKGQ/XCJzXCI6JygoayYmay5oYXNPd25Qcm9wZXJ0eShcIicrYisnXCIpKT9rOnMpJykrJ1tcIicrYisnXCJdO1xcbicrKGEudW53cmFwUHJvbWlzZXM/J2lmIChzICYmIHMudGhlbikge1xcbiBwdyhcIicrYy5yZXBsYWNlKC8oW1wiXFxyXFxuXSkvZyxcIlxcXFwkMVwiKSsnXCIpO1xcbiBpZiAoIShcIiQkdlwiIGluIHMpKSB7XFxuIHA9cztcXG4gcC4kJHYgPSB1bmRlZmluZWQ7XFxuIHAudGhlbihmdW5jdGlvbih2KSB7cC4kJHY9djt9KTtcXG59XFxuIHM9cy4kJHZcXG59XFxuJzpcIlwiKX0pO3ZhciBmPWYrXCJyZXR1cm4gcztcIixoPW5ldyBGdW5jdGlvbihcInNcIixcImtcIixcInB3XCIsZik7aC50b1N0cmluZz1hYShmKTtnPWEudW53cmFwUHJvbWlzZXM/ZnVuY3Rpb24oYSxiKXtyZXR1cm4gaChhLGIsdGEpfTpofWVsc2UgZz15ZShkWzBdLGRbMV0sYyk7ZWxzZSBnPXhlKGRbMF0sYyk7XCJoYXNPd25Qcm9wZXJ0eVwiIT09XG5iJiYoTWJbYl09Zyk7cmV0dXJuIGd9ZnVuY3Rpb24gWGQoKXt2YXIgYj17fSxhPXtjc3A6ITEsdW53cmFwUHJvbWlzZXM6ITEsbG9nUHJvbWlzZVdhcm5pbmdzOiEwfTt0aGlzLnVud3JhcFByb21pc2VzPWZ1bmN0aW9uKGIpe3JldHVybiBCKGIpPyhhLnVud3JhcFByb21pc2VzPSEhYix0aGlzKTphLnVud3JhcFByb21pc2VzfTt0aGlzLmxvZ1Byb21pc2VXYXJuaW5ncz1mdW5jdGlvbihiKXtyZXR1cm4gQihiKT8oYS5sb2dQcm9taXNlV2FybmluZ3M9Yix0aGlzKTphLmxvZ1Byb21pc2VXYXJuaW5nc307dGhpcy4kZ2V0PVtcIiRmaWx0ZXJcIixcIiRzbmlmZmVyXCIsXCIkbG9nXCIsZnVuY3Rpb24oYyxkLGUpe2EuY3NwPWQuY3NwO3RhPWZ1bmN0aW9uKGIpe2EubG9nUHJvbWlzZVdhcm5pbmdzJiYhRWMuaGFzT3duUHJvcGVydHkoYikmJihFY1tiXT0hMCxlLndhcm4oXCJbJHBhcnNlXSBQcm9taXNlIGZvdW5kIGluIHRoZSBleHByZXNzaW9uIGBcIitiK1wiYC4gQXV0b21hdGljIHVud3JhcHBpbmcgb2YgcHJvbWlzZXMgaW4gQW5ndWxhciBleHByZXNzaW9ucyBpcyBkZXByZWNhdGVkLlwiKSl9O1xucmV0dXJuIGZ1bmN0aW9uKGQpe3ZhciBlO3N3aXRjaCh0eXBlb2YgZCl7Y2FzZSBcInN0cmluZ1wiOmlmKGIuaGFzT3duUHJvcGVydHkoZCkpcmV0dXJuIGJbZF07ZT1uZXcgTmIoYSk7ZT0obmV3ICRhKGUsYyxhKSkucGFyc2UoZCwhMSk7XCJoYXNPd25Qcm9wZXJ0eVwiIT09ZCYmKGJbZF09ZSk7cmV0dXJuIGU7Y2FzZSBcImZ1bmN0aW9uXCI6cmV0dXJuIGQ7ZGVmYXVsdDpyZXR1cm4gQ319fV19ZnVuY3Rpb24gWmQoKXt0aGlzLiRnZXQ9W1wiJHJvb3RTY29wZVwiLFwiJGV4Y2VwdGlvbkhhbmRsZXJcIixmdW5jdGlvbihiLGEpe3JldHVybiB6ZShmdW5jdGlvbihhKXtiLiRldmFsQXN5bmMoYSl9LGEpfV19ZnVuY3Rpb24gemUoYixhKXtmdW5jdGlvbiBjKGEpe3JldHVybiBhfWZ1bmN0aW9uIGQoYSl7cmV0dXJuIGYoYSl9dmFyIGU9ZnVuY3Rpb24oKXt2YXIgZj1bXSxrLG07cmV0dXJuIG09e3Jlc29sdmU6ZnVuY3Rpb24oYSl7aWYoZil7dmFyIGM9ZjtmPXM7az1nKGEpO2MubGVuZ3RoJiZiKGZ1bmN0aW9uKCl7Zm9yKHZhciBhLFxuYj0wLGQ9Yy5sZW5ndGg7YjxkO2IrKylhPWNbYl0say50aGVuKGFbMF0sYVsxXSxhWzJdKX0pfX0scmVqZWN0OmZ1bmN0aW9uKGEpe20ucmVzb2x2ZShoKGEpKX0sbm90aWZ5OmZ1bmN0aW9uKGEpe2lmKGYpe3ZhciBjPWY7Zi5sZW5ndGgmJmIoZnVuY3Rpb24oKXtmb3IodmFyIGIsZD0wLGU9Yy5sZW5ndGg7ZDxlO2QrKyliPWNbZF0sYlsyXShhKX0pfX0scHJvbWlzZTp7dGhlbjpmdW5jdGlvbihiLGcsaCl7dmFyIG09ZSgpLHU9ZnVuY3Rpb24oZCl7dHJ5e20ucmVzb2x2ZSgoUChiKT9iOmMpKGQpKX1jYXRjaChlKXttLnJlamVjdChlKSxhKGUpfX0sRj1mdW5jdGlvbihiKXt0cnl7bS5yZXNvbHZlKChQKGcpP2c6ZCkoYikpfWNhdGNoKGMpe20ucmVqZWN0KGMpLGEoYyl9fSx2PWZ1bmN0aW9uKGIpe3RyeXttLm5vdGlmeSgoUChoKT9oOmMpKGIpKX1jYXRjaChkKXthKGQpfX07Zj9mLnB1c2goW3UsRix2XSk6ay50aGVuKHUsRix2KTtyZXR1cm4gbS5wcm9taXNlfSxcImNhdGNoXCI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudGhlbihudWxsLFxuYSl9LFwiZmluYWxseVwiOmZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYSxjKXt2YXIgZD1lKCk7Yz9kLnJlc29sdmUoYSk6ZC5yZWplY3QoYSk7cmV0dXJuIGQucHJvbWlzZX1mdW5jdGlvbiBkKGUsZyl7dmFyIGY9bnVsbDt0cnl7Zj0oYXx8YykoKX1jYXRjaChoKXtyZXR1cm4gYihoLCExKX1yZXR1cm4gZiYmUChmLnRoZW4pP2YudGhlbihmdW5jdGlvbigpe3JldHVybiBiKGUsZyl9LGZ1bmN0aW9uKGEpe3JldHVybiBiKGEsITEpfSk6YihlLGcpfXJldHVybiB0aGlzLnRoZW4oZnVuY3Rpb24oYSl7cmV0dXJuIGQoYSwhMCl9LGZ1bmN0aW9uKGEpe3JldHVybiBkKGEsITEpfSl9fX19LGc9ZnVuY3Rpb24oYSl7cmV0dXJuIGEmJlAoYS50aGVuKT9hOnt0aGVuOmZ1bmN0aW9uKGMpe3ZhciBkPWUoKTtiKGZ1bmN0aW9uKCl7ZC5yZXNvbHZlKGMoYSkpfSk7cmV0dXJuIGQucHJvbWlzZX19fSxmPWZ1bmN0aW9uKGEpe3ZhciBiPWUoKTtiLnJlamVjdChhKTtyZXR1cm4gYi5wcm9taXNlfSxoPWZ1bmN0aW9uKGMpe3JldHVybnt0aGVuOmZ1bmN0aW9uKGcsXG5mKXt2YXIgaD1lKCk7YihmdW5jdGlvbigpe3RyeXtoLnJlc29sdmUoKFAoZik/ZjpkKShjKSl9Y2F0Y2goYil7aC5yZWplY3QoYiksYShiKX19KTtyZXR1cm4gaC5wcm9taXNlfX19O3JldHVybntkZWZlcjplLHJlamVjdDpmLHdoZW46ZnVuY3Rpb24oaCxrLG0sbil7dmFyIHA9ZSgpLHIsej1mdW5jdGlvbihiKXt0cnl7cmV0dXJuKFAoayk/azpjKShiKX1jYXRjaChkKXtyZXR1cm4gYShkKSxmKGQpfX0sdT1mdW5jdGlvbihiKXt0cnl7cmV0dXJuKFAobSk/bTpkKShiKX1jYXRjaChjKXtyZXR1cm4gYShjKSxmKGMpfX0sRj1mdW5jdGlvbihiKXt0cnl7cmV0dXJuKFAobik/bjpjKShiKX1jYXRjaChkKXthKGQpfX07YihmdW5jdGlvbigpe2coaCkudGhlbihmdW5jdGlvbihhKXtyfHwocj0hMCxwLnJlc29sdmUoZyhhKS50aGVuKHosdSxGKSkpfSxmdW5jdGlvbihhKXtyfHwocj0hMCxwLnJlc29sdmUodShhKSkpfSxmdW5jdGlvbihhKXtyfHxwLm5vdGlmeShGKGEpKX0pfSk7cmV0dXJuIHAucHJvbWlzZX0sXG5hbGw6ZnVuY3Rpb24oYSl7dmFyIGI9ZSgpLGM9MCxkPU0oYSk/W106e307cShhLGZ1bmN0aW9uKGEsZSl7YysrO2coYSkudGhlbihmdW5jdGlvbihhKXtkLmhhc093blByb3BlcnR5KGUpfHwoZFtlXT1hLC0tY3x8Yi5yZXNvbHZlKGQpKX0sZnVuY3Rpb24oYSl7ZC5oYXNPd25Qcm9wZXJ0eShlKXx8Yi5yZWplY3QoYSl9KX0pOzA9PT1jJiZiLnJlc29sdmUoZCk7cmV0dXJuIGIucHJvbWlzZX19fWZ1bmN0aW9uIGZlKCl7dGhpcy4kZ2V0PVtcIiR3aW5kb3dcIixcIiR0aW1lb3V0XCIsZnVuY3Rpb24oYixhKXt2YXIgYz1iLnJlcXVlc3RBbmltYXRpb25GcmFtZXx8Yi53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGIubW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lLGQ9Yi5jYW5jZWxBbmltYXRpb25GcmFtZXx8Yi53ZWJraXRDYW5jZWxBbmltYXRpb25GcmFtZXx8Yi5tb3pDYW5jZWxBbmltYXRpb25GcmFtZXx8Yi53ZWJraXRDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWUsZT0hIWMsZz1lP1xuZnVuY3Rpb24oYSl7dmFyIGI9YyhhKTtyZXR1cm4gZnVuY3Rpb24oKXtkKGIpfX06ZnVuY3Rpb24oYil7dmFyIGM9YShiLDE2LjY2LCExKTtyZXR1cm4gZnVuY3Rpb24oKXthLmNhbmNlbChjKX19O2cuc3VwcG9ydGVkPWU7cmV0dXJuIGd9XX1mdW5jdGlvbiBZZCgpe3ZhciBiPTEwLGE9dChcIiRyb290U2NvcGVcIiksYz1udWxsO3RoaXMuZGlnZXN0VHRsPWZ1bmN0aW9uKGEpe2FyZ3VtZW50cy5sZW5ndGgmJihiPWEpO3JldHVybiBifTt0aGlzLiRnZXQ9W1wiJGluamVjdG9yXCIsXCIkZXhjZXB0aW9uSGFuZGxlclwiLFwiJHBhcnNlXCIsXCIkYnJvd3NlclwiLGZ1bmN0aW9uKGQsZSxnLGYpe2Z1bmN0aW9uIGgoKXt0aGlzLiRpZD1iYigpO3RoaXMuJCRwaGFzZT10aGlzLiRwYXJlbnQ9dGhpcy4kJHdhdGNoZXJzPXRoaXMuJCRuZXh0U2libGluZz10aGlzLiQkcHJldlNpYmxpbmc9dGhpcy4kJGNoaWxkSGVhZD10aGlzLiQkY2hpbGRUYWlsPW51bGw7dGhpc1tcInRoaXNcIl09dGhpcy4kcm9vdD10aGlzO1xudGhpcy4kJGRlc3Ryb3llZD0hMTt0aGlzLiQkYXN5bmNRdWV1ZT1bXTt0aGlzLiQkcG9zdERpZ2VzdFF1ZXVlPVtdO3RoaXMuJCRsaXN0ZW5lcnM9e307dGhpcy4kJGxpc3RlbmVyQ291bnQ9e307dGhpcy4kJGlzb2xhdGVCaW5kaW5ncz17fX1mdW5jdGlvbiBsKGIpe2lmKHAuJCRwaGFzZSl0aHJvdyBhKFwiaW5wcm9nXCIscC4kJHBoYXNlKTtwLiQkcGhhc2U9Yn1mdW5jdGlvbiBrKGEsYil7dmFyIGM9ZyhhKTtSYShjLGIpO3JldHVybiBjfWZ1bmN0aW9uIG0oYSxiLGMpe2RvIGEuJCRsaXN0ZW5lckNvdW50W2NdLT1iLDA9PT1hLiQkbGlzdGVuZXJDb3VudFtjXSYmZGVsZXRlIGEuJCRsaXN0ZW5lckNvdW50W2NdO3doaWxlKGE9YS4kcGFyZW50KX1mdW5jdGlvbiBuKCl7fWgucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpoLCRuZXc6ZnVuY3Rpb24oYSl7YT8oYT1uZXcgaCxhLiRyb290PXRoaXMuJHJvb3QsYS4kJGFzeW5jUXVldWU9dGhpcy4kJGFzeW5jUXVldWUsYS4kJHBvc3REaWdlc3RRdWV1ZT1cbnRoaXMuJCRwb3N0RGlnZXN0UXVldWUpOihhPWZ1bmN0aW9uKCl7fSxhLnByb3RvdHlwZT10aGlzLGE9bmV3IGEsYS4kaWQ9YmIoKSk7YVtcInRoaXNcIl09YTthLiQkbGlzdGVuZXJzPXt9O2EuJCRsaXN0ZW5lckNvdW50PXt9O2EuJHBhcmVudD10aGlzO2EuJCR3YXRjaGVycz1hLiQkbmV4dFNpYmxpbmc9YS4kJGNoaWxkSGVhZD1hLiQkY2hpbGRUYWlsPW51bGw7YS4kJHByZXZTaWJsaW5nPXRoaXMuJCRjaGlsZFRhaWw7dGhpcy4kJGNoaWxkSGVhZD90aGlzLiQkY2hpbGRUYWlsPXRoaXMuJCRjaGlsZFRhaWwuJCRuZXh0U2libGluZz1hOnRoaXMuJCRjaGlsZEhlYWQ9dGhpcy4kJGNoaWxkVGFpbD1hO3JldHVybiBhfSwkd2F0Y2g6ZnVuY3Rpb24oYSxiLGQpe3ZhciBlPWsoYSxcIndhdGNoXCIpLGc9dGhpcy4kJHdhdGNoZXJzLGY9e2ZuOmIsbGFzdDpuLGdldDplLGV4cDphLGVxOiEhZH07Yz1udWxsO2lmKCFQKGIpKXt2YXIgaD1rKGJ8fEMsXCJsaXN0ZW5lclwiKTtmLmZuPWZ1bmN0aW9uKGEsXG5iLGMpe2goYyl9fWlmKFwic3RyaW5nXCI9PXR5cGVvZiBhJiZlLmNvbnN0YW50KXt2YXIgbD1mLmZuO2YuZm49ZnVuY3Rpb24oYSxiLGMpe2wuY2FsbCh0aGlzLGEsYixjKTtPYShnLGYpfX1nfHwoZz10aGlzLiQkd2F0Y2hlcnM9W10pO2cudW5zaGlmdChmKTtyZXR1cm4gZnVuY3Rpb24oKXtPYShnLGYpO2M9bnVsbH19LCR3YXRjaENvbGxlY3Rpb246ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQsZSxmLGg9MTxiLmxlbmd0aCxsPTAsaz1nKGEpLG09W10sbj17fSxwPSEwLHE9MDtyZXR1cm4gdGhpcy4kd2F0Y2goZnVuY3Rpb24oKXtkPWsoYyk7dmFyIGEsYjtpZihYKGQpKWlmKGFiKGQpKWZvcihlIT09bSYmKGU9bSxxPWUubGVuZ3RoPTAsbCsrKSxhPWQubGVuZ3RoLHEhPT1hJiYobCsrLGUubGVuZ3RoPXE9YSksYj0wO2I8YTtiKyspZVtiXSE9PWVbYl0mJmRbYl0hPT1kW2JdfHxlW2JdPT09ZFtiXXx8KGwrKyxlW2JdPWRbYl0pO2Vsc2V7ZSE9PW4mJihlPW49e30scT0wLGwrKyk7YT1cbjA7Zm9yKGIgaW4gZClkLmhhc093blByb3BlcnR5KGIpJiYoYSsrLGUuaGFzT3duUHJvcGVydHkoYik/ZVtiXSE9PWRbYl0mJihsKyssZVtiXT1kW2JdKToocSsrLGVbYl09ZFtiXSxsKyspKTtpZihxPmEpZm9yKGIgaW4gbCsrLGUpZS5oYXNPd25Qcm9wZXJ0eShiKSYmIWQuaGFzT3duUHJvcGVydHkoYikmJihxLS0sZGVsZXRlIGVbYl0pfWVsc2UgZSE9PWQmJihlPWQsbCsrKTtyZXR1cm4gbH0sZnVuY3Rpb24oKXtwPyhwPSExLGIoZCxkLGMpKTpiKGQsZixjKTtpZihoKWlmKFgoZCkpaWYoYWIoZCkpe2Y9QXJyYXkoZC5sZW5ndGgpO2Zvcih2YXIgYT0wO2E8ZC5sZW5ndGg7YSsrKWZbYV09ZFthXX1lbHNlIGZvcihhIGluIGY9e30sZClGYy5jYWxsKGQsYSkmJihmW2FdPWRbYV0pO2Vsc2UgZj1kfSl9LCRkaWdlc3Q6ZnVuY3Rpb24oKXt2YXIgZCxnLGYsaCxrPXRoaXMuJCRhc3luY1F1ZXVlLG09dGhpcy4kJHBvc3REaWdlc3RRdWV1ZSxxLHgscz1iLEwsUT1bXSx5LEgsUjtsKFwiJGRpZ2VzdFwiKTtcbmM9bnVsbDtkb3t4PSExO2ZvcihMPXRoaXM7ay5sZW5ndGg7KXt0cnl7Uj1rLnNoaWZ0KCksUi5zY29wZS4kZXZhbChSLmV4cHJlc3Npb24pfWNhdGNoKEIpe3AuJCRwaGFzZT1udWxsLGUoQil9Yz1udWxsfWE6ZG97aWYoaD1MLiQkd2F0Y2hlcnMpZm9yKHE9aC5sZW5ndGg7cS0tOyl0cnl7aWYoZD1oW3FdKWlmKChnPWQuZ2V0KEwpKSE9PShmPWQubGFzdCkmJiEoZC5lcT94YShnLGYpOlwibnVtYmVyXCI9PXR5cGVvZiBnJiZcIm51bWJlclwiPT10eXBlb2YgZiYmaXNOYU4oZykmJmlzTmFOKGYpKSl4PSEwLGM9ZCxkLmxhc3Q9ZC5lcT9iYShnKTpnLGQuZm4oZyxmPT09bj9nOmYsTCksNT5zJiYoeT00LXMsUVt5XXx8KFFbeV09W10pLEg9UChkLmV4cCk/XCJmbjogXCIrKGQuZXhwLm5hbWV8fGQuZXhwLnRvU3RyaW5nKCkpOmQuZXhwLEgrPVwiOyBuZXdWYWw6IFwiK3FhKGcpK1wiOyBvbGRWYWw6IFwiK3FhKGYpLFFbeV0ucHVzaChIKSk7ZWxzZSBpZihkPT09Yyl7eD0hMTticmVhayBhfX1jYXRjaCh3KXtwLiQkcGhhc2U9XG5udWxsLGUodyl9aWYoIShoPUwuJCRjaGlsZEhlYWR8fEwhPT10aGlzJiZMLiQkbmV4dFNpYmxpbmcpKWZvcig7TCE9PXRoaXMmJiEoaD1MLiQkbmV4dFNpYmxpbmcpOylMPUwuJHBhcmVudH13aGlsZShMPWgpO2lmKCh4fHxrLmxlbmd0aCkmJiFzLS0pdGhyb3cgcC4kJHBoYXNlPW51bGwsYShcImluZmRpZ1wiLGIscWEoUSkpO313aGlsZSh4fHxrLmxlbmd0aCk7Zm9yKHAuJCRwaGFzZT1udWxsO20ubGVuZ3RoOyl0cnl7bS5zaGlmdCgpKCl9Y2F0Y2goVCl7ZShUKX19LCRkZXN0cm95OmZ1bmN0aW9uKCl7aWYoIXRoaXMuJCRkZXN0cm95ZWQpe3ZhciBhPXRoaXMuJHBhcmVudDt0aGlzLiRicm9hZGNhc3QoXCIkZGVzdHJveVwiKTt0aGlzLiQkZGVzdHJveWVkPSEwO3RoaXMhPT1wJiYocSh0aGlzLiQkbGlzdGVuZXJDb3VudCxlYihudWxsLG0sdGhpcykpLGEuJCRjaGlsZEhlYWQ9PXRoaXMmJihhLiQkY2hpbGRIZWFkPXRoaXMuJCRuZXh0U2libGluZyksYS4kJGNoaWxkVGFpbD09dGhpcyYmXG4oYS4kJGNoaWxkVGFpbD10aGlzLiQkcHJldlNpYmxpbmcpLHRoaXMuJCRwcmV2U2libGluZyYmKHRoaXMuJCRwcmV2U2libGluZy4kJG5leHRTaWJsaW5nPXRoaXMuJCRuZXh0U2libGluZyksdGhpcy4kJG5leHRTaWJsaW5nJiYodGhpcy4kJG5leHRTaWJsaW5nLiQkcHJldlNpYmxpbmc9dGhpcy4kJHByZXZTaWJsaW5nKSx0aGlzLiRwYXJlbnQ9dGhpcy4kJG5leHRTaWJsaW5nPXRoaXMuJCRwcmV2U2libGluZz10aGlzLiQkY2hpbGRIZWFkPXRoaXMuJCRjaGlsZFRhaWw9dGhpcy4kcm9vdD1udWxsLHRoaXMuJCRsaXN0ZW5lcnM9e30sdGhpcy4kJHdhdGNoZXJzPXRoaXMuJCRhc3luY1F1ZXVlPXRoaXMuJCRwb3N0RGlnZXN0UXVldWU9W10sdGhpcy4kZGVzdHJveT10aGlzLiRkaWdlc3Q9dGhpcy4kYXBwbHk9Qyx0aGlzLiRvbj10aGlzLiR3YXRjaD1mdW5jdGlvbigpe3JldHVybiBDfSl9fSwkZXZhbDpmdW5jdGlvbihhLGIpe3JldHVybiBnKGEpKHRoaXMsYil9LCRldmFsQXN5bmM6ZnVuY3Rpb24oYSl7cC4kJHBoYXNlfHxcbnAuJCRhc3luY1F1ZXVlLmxlbmd0aHx8Zi5kZWZlcihmdW5jdGlvbigpe3AuJCRhc3luY1F1ZXVlLmxlbmd0aCYmcC4kZGlnZXN0KCl9KTt0aGlzLiQkYXN5bmNRdWV1ZS5wdXNoKHtzY29wZTp0aGlzLGV4cHJlc3Npb246YX0pfSwkJHBvc3REaWdlc3Q6ZnVuY3Rpb24oYSl7dGhpcy4kJHBvc3REaWdlc3RRdWV1ZS5wdXNoKGEpfSwkYXBwbHk6ZnVuY3Rpb24oYSl7dHJ5e3JldHVybiBsKFwiJGFwcGx5XCIpLHRoaXMuJGV2YWwoYSl9Y2F0Y2goYil7ZShiKX1maW5hbGx5e3AuJCRwaGFzZT1udWxsO3RyeXtwLiRkaWdlc3QoKX1jYXRjaChjKXt0aHJvdyBlKGMpLGM7fX19LCRvbjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuJCRsaXN0ZW5lcnNbYV07Y3x8KHRoaXMuJCRsaXN0ZW5lcnNbYV09Yz1bXSk7Yy5wdXNoKGIpO3ZhciBkPXRoaXM7ZG8gZC4kJGxpc3RlbmVyQ291bnRbYV18fChkLiQkbGlzdGVuZXJDb3VudFthXT0wKSxkLiQkbGlzdGVuZXJDb3VudFthXSsrO3doaWxlKGQ9ZC4kcGFyZW50KTtcbnZhciBlPXRoaXM7cmV0dXJuIGZ1bmN0aW9uKCl7Y1tkYihjLGIpXT1udWxsO20oZSwxLGEpfX0sJGVtaXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1bXSxkLGc9dGhpcyxmPSExLGg9e25hbWU6YSx0YXJnZXRTY29wZTpnLHN0b3BQcm9wYWdhdGlvbjpmdW5jdGlvbigpe2Y9ITB9LHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7aC5kZWZhdWx0UHJldmVudGVkPSEwfSxkZWZhdWx0UHJldmVudGVkOiExfSxsPVtoXS5jb25jYXQoeWEuY2FsbChhcmd1bWVudHMsMSkpLGssbTtkb3tkPWcuJCRsaXN0ZW5lcnNbYV18fGM7aC5jdXJyZW50U2NvcGU9ZztrPTA7Zm9yKG09ZC5sZW5ndGg7azxtO2srKylpZihkW2tdKXRyeXtkW2tdLmFwcGx5KG51bGwsbCl9Y2F0Y2gobil7ZShuKX1lbHNlIGQuc3BsaWNlKGssMSksay0tLG0tLTtpZihmKWJyZWFrO2c9Zy4kcGFyZW50fXdoaWxlKGcpO3JldHVybiBofSwkYnJvYWRjYXN0OmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPXRoaXMsZD10aGlzLGc9e25hbWU6YSxcbnRhcmdldFNjb3BlOnRoaXMscHJldmVudERlZmF1bHQ6ZnVuY3Rpb24oKXtnLmRlZmF1bHRQcmV2ZW50ZWQ9ITB9LGRlZmF1bHRQcmV2ZW50ZWQ6ITF9LGY9W2ddLmNvbmNhdCh5YS5jYWxsKGFyZ3VtZW50cywxKSksaCxrO2M9ZDspe2cuY3VycmVudFNjb3BlPWM7ZD1jLiQkbGlzdGVuZXJzW2FdfHxbXTtoPTA7Zm9yKGs9ZC5sZW5ndGg7aDxrO2grKylpZihkW2hdKXRyeXtkW2hdLmFwcGx5KG51bGwsZil9Y2F0Y2gobCl7ZShsKX1lbHNlIGQuc3BsaWNlKGgsMSksaC0tLGstLTtpZighKGQ9Yy4kJGxpc3RlbmVyQ291bnRbYV0mJmMuJCRjaGlsZEhlYWR8fGMhPT10aGlzJiZjLiQkbmV4dFNpYmxpbmcpKWZvcig7YyE9PXRoaXMmJiEoZD1jLiQkbmV4dFNpYmxpbmcpOyljPWMuJHBhcmVudH1yZXR1cm4gZ319O3ZhciBwPW5ldyBoO3JldHVybiBwfV19ZnVuY3Rpb24gYmQoKXt2YXIgYj0vXlxccyooaHR0cHM/fGZ0cHxtYWlsdG98dGVsfGZpbGUpOi8sYT0vXlxccyooaHR0cHM/fGZ0cHxmaWxlKTp8ZGF0YTppbWFnZVxcLy87XG50aGlzLmFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0PWZ1bmN0aW9uKGEpe3JldHVybiBCKGEpPyhiPWEsdGhpcyk6Yn07dGhpcy5pbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3Q9ZnVuY3Rpb24oYil7cmV0dXJuIEIoYik/KGE9Yix0aGlzKTphfTt0aGlzLiRnZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYyxkKXt2YXIgZT1kP2E6YixnO2lmKCFTfHw4PD1TKWlmKGc9c2EoYykuaHJlZixcIlwiIT09ZyYmIWcubWF0Y2goZSkpcmV0dXJuXCJ1bnNhZmU6XCIrZztyZXR1cm4gY319fWZ1bmN0aW9uIEFlKGIpe2lmKFwic2VsZlwiPT09YilyZXR1cm4gYjtpZih3KGIpKXtpZigtMTxiLmluZGV4T2YoXCIqKipcIikpdGhyb3cgdWEoXCJpd2NhcmRcIixiKTtiPWIucmVwbGFjZSgvKFstKClcXFtcXF17fSs/Ki4kXFxefCw6IzwhXFxcXF0pL2csXCJcXFxcJDFcIikucmVwbGFjZSgvXFx4MDgvZyxcIlxcXFx4MDhcIikucmVwbGFjZShcIlxcXFwqXFxcXCpcIixcIi4qXCIpLnJlcGxhY2UoXCJcXFxcKlwiLFwiW146Ly4/JjtdKlwiKTtyZXR1cm4gUmVnRXhwKFwiXlwiK1xuYitcIiRcIil9aWYoY2IoYikpcmV0dXJuIFJlZ0V4cChcIl5cIitiLnNvdXJjZStcIiRcIik7dGhyb3cgdWEoXCJpbWF0Y2hlclwiKTt9ZnVuY3Rpb24gR2MoYil7dmFyIGE9W107QihiKSYmcShiLGZ1bmN0aW9uKGIpe2EucHVzaChBZShiKSl9KTtyZXR1cm4gYX1mdW5jdGlvbiBhZSgpe3RoaXMuU0NFX0NPTlRFWFRTPWdhO3ZhciBiPVtcInNlbGZcIl0sYT1bXTt0aGlzLnJlc291cmNlVXJsV2hpdGVsaXN0PWZ1bmN0aW9uKGEpe2FyZ3VtZW50cy5sZW5ndGgmJihiPUdjKGEpKTtyZXR1cm4gYn07dGhpcy5yZXNvdXJjZVVybEJsYWNrbGlzdD1mdW5jdGlvbihiKXthcmd1bWVudHMubGVuZ3RoJiYoYT1HYyhiKSk7cmV0dXJuIGF9O3RoaXMuJGdldD1bXCIkaW5qZWN0b3JcIixmdW5jdGlvbihjKXtmdW5jdGlvbiBkKGEpe3ZhciBiPWZ1bmN0aW9uKGEpe3RoaXMuJCR1bndyYXBUcnVzdGVkVmFsdWU9ZnVuY3Rpb24oKXtyZXR1cm4gYX19O2EmJihiLnByb3RvdHlwZT1uZXcgYSk7Yi5wcm90b3R5cGUudmFsdWVPZj1cbmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJCR1bndyYXBUcnVzdGVkVmFsdWUoKX07Yi5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kJHVud3JhcFRydXN0ZWRWYWx1ZSgpLnRvU3RyaW5nKCl9O3JldHVybiBifXZhciBlPWZ1bmN0aW9uKGEpe3Rocm93IHVhKFwidW5zYWZlXCIpO307Yy5oYXMoXCIkc2FuaXRpemVcIikmJihlPWMuZ2V0KFwiJHNhbml0aXplXCIpKTt2YXIgZz1kKCksZj17fTtmW2dhLkhUTUxdPWQoZyk7ZltnYS5DU1NdPWQoZyk7ZltnYS5VUkxdPWQoZyk7ZltnYS5KU109ZChnKTtmW2dhLlJFU09VUkNFX1VSTF09ZChmW2dhLlVSTF0pO3JldHVybnt0cnVzdEFzOmZ1bmN0aW9uKGEsYil7dmFyIGM9Zi5oYXNPd25Qcm9wZXJ0eShhKT9mW2FdOm51bGw7aWYoIWMpdGhyb3cgdWEoXCJpY29udGV4dFwiLGEsYik7aWYobnVsbD09PWJ8fGI9PT1zfHxcIlwiPT09YilyZXR1cm4gYjtpZihcInN0cmluZ1wiIT09dHlwZW9mIGIpdGhyb3cgdWEoXCJpdHlwZVwiLGEpO3JldHVybiBuZXcgYyhiKX0sXG5nZXRUcnVzdGVkOmZ1bmN0aW9uKGMsZCl7aWYobnVsbD09PWR8fGQ9PT1zfHxcIlwiPT09ZClyZXR1cm4gZDt2YXIgZz1mLmhhc093blByb3BlcnR5KGMpP2ZbY106bnVsbDtpZihnJiZkIGluc3RhbmNlb2YgZylyZXR1cm4gZC4kJHVud3JhcFRydXN0ZWRWYWx1ZSgpO2lmKGM9PT1nYS5SRVNPVVJDRV9VUkwpe3ZhciBnPXNhKGQudG9TdHJpbmcoKSksbSxuLHA9ITE7bT0wO2ZvcihuPWIubGVuZ3RoO208bjttKyspaWYoXCJzZWxmXCI9PT1iW21dP0liKGcpOmJbbV0uZXhlYyhnLmhyZWYpKXtwPSEwO2JyZWFrfWlmKHApZm9yKG09MCxuPWEubGVuZ3RoO208bjttKyspaWYoXCJzZWxmXCI9PT1hW21dP0liKGcpOmFbbV0uZXhlYyhnLmhyZWYpKXtwPSExO2JyZWFrfWlmKHApcmV0dXJuIGQ7dGhyb3cgdWEoXCJpbnNlY3VybFwiLGQudG9TdHJpbmcoKSk7fWlmKGM9PT1nYS5IVE1MKXJldHVybiBlKGQpO3Rocm93IHVhKFwidW5zYWZlXCIpO30sdmFsdWVPZjpmdW5jdGlvbihhKXtyZXR1cm4gYSBpbnN0YW5jZW9mXG5nP2EuJCR1bndyYXBUcnVzdGVkVmFsdWUoKTphfX19XX1mdW5jdGlvbiAkZCgpe3ZhciBiPSEwO3RoaXMuZW5hYmxlZD1mdW5jdGlvbihhKXthcmd1bWVudHMubGVuZ3RoJiYoYj0hIWEpO3JldHVybiBifTt0aGlzLiRnZXQ9W1wiJHBhcnNlXCIsXCIkc25pZmZlclwiLFwiJHNjZURlbGVnYXRlXCIsZnVuY3Rpb24oYSxjLGQpe2lmKGImJmMubXNpZSYmOD5jLm1zaWVEb2N1bWVudE1vZGUpdGhyb3cgdWEoXCJpZXF1aXJrc1wiKTt2YXIgZT1iYShnYSk7ZS5pc0VuYWJsZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gYn07ZS50cnVzdEFzPWQudHJ1c3RBcztlLmdldFRydXN0ZWQ9ZC5nZXRUcnVzdGVkO2UudmFsdWVPZj1kLnZhbHVlT2Y7Ynx8KGUudHJ1c3RBcz1lLmdldFRydXN0ZWQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYn0sZS52YWx1ZU9mPURhKTtlLnBhcnNlQXM9ZnVuY3Rpb24oYixjKXt2YXIgZD1hKGMpO3JldHVybiBkLmxpdGVyYWwmJmQuY29uc3RhbnQ/ZDpmdW5jdGlvbihhLGMpe3JldHVybiBlLmdldFRydXN0ZWQoYixcbmQoYSxjKSl9fTt2YXIgZz1lLnBhcnNlQXMsZj1lLmdldFRydXN0ZWQsaD1lLnRydXN0QXM7cShnYSxmdW5jdGlvbihhLGIpe3ZhciBjPUsoYik7ZVtUYShcInBhcnNlX2FzX1wiK2MpXT1mdW5jdGlvbihiKXtyZXR1cm4gZyhhLGIpfTtlW1RhKFwiZ2V0X3RydXN0ZWRfXCIrYyldPWZ1bmN0aW9uKGIpe3JldHVybiBmKGEsYil9O2VbVGEoXCJ0cnVzdF9hc19cIitjKV09ZnVuY3Rpb24oYil7cmV0dXJuIGgoYSxiKX19KTtyZXR1cm4gZX1dfWZ1bmN0aW9uIGJlKCl7dGhpcy4kZ2V0PVtcIiR3aW5kb3dcIixcIiRkb2N1bWVudFwiLGZ1bmN0aW9uKGIsYSl7dmFyIGM9e30sZD1ZKCgvYW5kcm9pZCAoXFxkKykvLmV4ZWMoSygoYi5uYXZpZ2F0b3J8fHt9KS51c2VyQWdlbnQpKXx8W10pWzFdKSxlPS9Cb3hlZS9pLnRlc3QoKGIubmF2aWdhdG9yfHx7fSkudXNlckFnZW50KSxnPWFbMF18fHt9LGY9Zy5kb2N1bWVudE1vZGUsaCxsPS9eKE1venx3ZWJraXR8T3xtcykoPz1bQS1aXSkvLGs9Zy5ib2R5JiZnLmJvZHkuc3R5bGUsXG5tPSExLG49ITE7aWYoayl7Zm9yKHZhciBwIGluIGspaWYobT1sLmV4ZWMocCkpe2g9bVswXTtoPWguc3Vic3RyKDAsMSkudG9VcHBlckNhc2UoKStoLnN1YnN0cigxKTticmVha31ofHwoaD1cIldlYmtpdE9wYWNpdHlcImluIGsmJlwid2Via2l0XCIpO209ISEoXCJ0cmFuc2l0aW9uXCJpbiBrfHxoK1wiVHJhbnNpdGlvblwiaW4gayk7bj0hIShcImFuaW1hdGlvblwiaW4ga3x8aCtcIkFuaW1hdGlvblwiaW4gayk7IWR8fG0mJm58fChtPXcoZy5ib2R5LnN0eWxlLndlYmtpdFRyYW5zaXRpb24pLG49dyhnLmJvZHkuc3R5bGUud2Via2l0QW5pbWF0aW9uKSl9cmV0dXJue2hpc3Rvcnk6ISghYi5oaXN0b3J5fHwhYi5oaXN0b3J5LnB1c2hTdGF0ZXx8ND5kfHxlKSxoYXNoY2hhbmdlOlwib25oYXNoY2hhbmdlXCJpbiBiJiYoIWZ8fDc8ZiksaGFzRXZlbnQ6ZnVuY3Rpb24oYSl7aWYoXCJpbnB1dFwiPT1hJiY5PT1TKXJldHVybiExO2lmKEUoY1thXSkpe3ZhciBiPWcuY3JlYXRlRWxlbWVudChcImRpdlwiKTtjW2FdPVwib25cIitcbmEgaW4gYn1yZXR1cm4gY1thXX0sY3NwOlZiKCksdmVuZG9yUHJlZml4OmgsdHJhbnNpdGlvbnM6bSxhbmltYXRpb25zOm4sYW5kcm9pZDpkLG1zaWU6Uyxtc2llRG9jdW1lbnRNb2RlOmZ9fV19ZnVuY3Rpb24gZGUoKXt0aGlzLiRnZXQ9W1wiJHJvb3RTY29wZVwiLFwiJGJyb3dzZXJcIixcIiRxXCIsXCIkZXhjZXB0aW9uSGFuZGxlclwiLGZ1bmN0aW9uKGIsYSxjLGQpe2Z1bmN0aW9uIGUoZSxoLGwpe3ZhciBrPWMuZGVmZXIoKSxtPWsucHJvbWlzZSxuPUIobCkmJiFsO2g9YS5kZWZlcihmdW5jdGlvbigpe3RyeXtrLnJlc29sdmUoZSgpKX1jYXRjaChhKXtrLnJlamVjdChhKSxkKGEpfWZpbmFsbHl7ZGVsZXRlIGdbbS4kJHRpbWVvdXRJZF19bnx8Yi4kYXBwbHkoKX0saCk7bS4kJHRpbWVvdXRJZD1oO2dbaF09aztyZXR1cm4gbX12YXIgZz17fTtlLmNhbmNlbD1mdW5jdGlvbihiKXtyZXR1cm4gYiYmYi4kJHRpbWVvdXRJZCBpbiBnPyhnW2IuJCR0aW1lb3V0SWRdLnJlamVjdChcImNhbmNlbGVkXCIpLFxuZGVsZXRlIGdbYi4kJHRpbWVvdXRJZF0sYS5kZWZlci5jYW5jZWwoYi4kJHRpbWVvdXRJZCkpOiExfTtyZXR1cm4gZX1dfWZ1bmN0aW9uIHNhKGIsYSl7dmFyIGM9YjtTJiYoVy5zZXRBdHRyaWJ1dGUoXCJocmVmXCIsYyksYz1XLmhyZWYpO1cuc2V0QXR0cmlidXRlKFwiaHJlZlwiLGMpO3JldHVybntocmVmOlcuaHJlZixwcm90b2NvbDpXLnByb3RvY29sP1cucHJvdG9jb2wucmVwbGFjZSgvOiQvLFwiXCIpOlwiXCIsaG9zdDpXLmhvc3Qsc2VhcmNoOlcuc2VhcmNoP1cuc2VhcmNoLnJlcGxhY2UoL15cXD8vLFwiXCIpOlwiXCIsaGFzaDpXLmhhc2g/Vy5oYXNoLnJlcGxhY2UoL14jLyxcIlwiKTpcIlwiLGhvc3RuYW1lOlcuaG9zdG5hbWUscG9ydDpXLnBvcnQscGF0aG5hbWU6XCIvXCI9PT1XLnBhdGhuYW1lLmNoYXJBdCgwKT9XLnBhdGhuYW1lOlwiL1wiK1cucGF0aG5hbWV9fWZ1bmN0aW9uIEliKGIpe2I9dyhiKT9zYShiKTpiO3JldHVybiBiLnByb3RvY29sPT09SGMucHJvdG9jb2wmJmIuaG9zdD09PUhjLmhvc3R9XG5mdW5jdGlvbiBlZSgpe3RoaXMuJGdldD1hYShPKX1mdW5jdGlvbiBnYyhiKXtmdW5jdGlvbiBhKGQsZSl7aWYoWChkKSl7dmFyIGc9e307cShkLGZ1bmN0aW9uKGIsYyl7Z1tjXT1hKGMsYil9KTtyZXR1cm4gZ31yZXR1cm4gYi5mYWN0b3J5KGQrYyxlKX12YXIgYz1cIkZpbHRlclwiO3RoaXMucmVnaXN0ZXI9YTt0aGlzLiRnZXQ9W1wiJGluamVjdG9yXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBhLmdldChiK2MpfX1dO2EoXCJjdXJyZW5jeVwiLEljKTthKFwiZGF0ZVwiLEpjKTthKFwiZmlsdGVyXCIsQmUpO2EoXCJqc29uXCIsQ2UpO2EoXCJsaW1pdFRvXCIsRGUpO2EoXCJsb3dlcmNhc2VcIixFZSk7YShcIm51bWJlclwiLEtjKTthKFwib3JkZXJCeVwiLExjKTthKFwidXBwZXJjYXNlXCIsRmUpfWZ1bmN0aW9uIEJlKCl7cmV0dXJuIGZ1bmN0aW9uKGIsYSxjKXtpZighTShiKSlyZXR1cm4gYjt2YXIgZD10eXBlb2YgYyxlPVtdO2UuY2hlY2s9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTA7YjxlLmxlbmd0aDtiKyspaWYoIWVbYl0oYSkpcmV0dXJuITE7XG5yZXR1cm4hMH07XCJmdW5jdGlvblwiIT09ZCYmKGM9XCJib29sZWFuXCI9PT1kJiZjP2Z1bmN0aW9uKGEsYil7cmV0dXJuIEVhLmVxdWFscyhhLGIpfTpmdW5jdGlvbihhLGIpe2lmKGEmJmImJlwib2JqZWN0XCI9PT10eXBlb2YgYSYmXCJvYmplY3RcIj09PXR5cGVvZiBiKXtmb3IodmFyIGQgaW4gYSlpZihcIiRcIiE9PWQuY2hhckF0KDApJiZGYy5jYWxsKGEsZCkmJmMoYVtkXSxiW2RdKSlyZXR1cm4hMDtyZXR1cm4hMX1iPShcIlwiK2IpLnRvTG93ZXJDYXNlKCk7cmV0dXJuLTE8KFwiXCIrYSkudG9Mb3dlckNhc2UoKS5pbmRleE9mKGIpfSk7dmFyIGc9ZnVuY3Rpb24oYSxiKXtpZihcInN0cmluZ1wiPT10eXBlb2YgYiYmXCIhXCI9PT1iLmNoYXJBdCgwKSlyZXR1cm4hZyhhLGIuc3Vic3RyKDEpKTtzd2l0Y2godHlwZW9mIGEpe2Nhc2UgXCJib29sZWFuXCI6Y2FzZSBcIm51bWJlclwiOmNhc2UgXCJzdHJpbmdcIjpyZXR1cm4gYyhhLGIpO2Nhc2UgXCJvYmplY3RcIjpzd2l0Y2godHlwZW9mIGIpe2Nhc2UgXCJvYmplY3RcIjpyZXR1cm4gYyhhLFxuYik7ZGVmYXVsdDpmb3IodmFyIGQgaW4gYSlpZihcIiRcIiE9PWQuY2hhckF0KDApJiZnKGFbZF0sYikpcmV0dXJuITB9cmV0dXJuITE7Y2FzZSBcImFycmF5XCI6Zm9yKGQ9MDtkPGEubGVuZ3RoO2QrKylpZihnKGFbZF0sYikpcmV0dXJuITA7cmV0dXJuITE7ZGVmYXVsdDpyZXR1cm4hMX19O3N3aXRjaCh0eXBlb2YgYSl7Y2FzZSBcImJvb2xlYW5cIjpjYXNlIFwibnVtYmVyXCI6Y2FzZSBcInN0cmluZ1wiOmE9eyQ6YX07Y2FzZSBcIm9iamVjdFwiOmZvcih2YXIgZiBpbiBhKShmdW5jdGlvbihiKXtcInVuZGVmaW5lZFwiIT10eXBlb2YgYVtiXSYmZS5wdXNoKGZ1bmN0aW9uKGMpe3JldHVybiBnKFwiJFwiPT1iP2M6YyYmY1tiXSxhW2JdKX0pfSkoZik7YnJlYWs7Y2FzZSBcImZ1bmN0aW9uXCI6ZS5wdXNoKGEpO2JyZWFrO2RlZmF1bHQ6cmV0dXJuIGJ9ZD1bXTtmb3IoZj0wO2Y8Yi5sZW5ndGg7ZisrKXt2YXIgaD1iW2ZdO2UuY2hlY2soaCkmJmQucHVzaChoKX1yZXR1cm4gZH19ZnVuY3Rpb24gSWMoYil7dmFyIGE9XG5iLk5VTUJFUl9GT1JNQVRTO3JldHVybiBmdW5jdGlvbihiLGQpe0UoZCkmJihkPWEuQ1VSUkVOQ1lfU1lNKTtyZXR1cm4gTWMoYixhLlBBVFRFUk5TWzFdLGEuR1JPVVBfU0VQLGEuREVDSU1BTF9TRVAsMikucmVwbGFjZSgvXFx1MDBBNC9nLGQpfX1mdW5jdGlvbiBLYyhiKXt2YXIgYT1iLk5VTUJFUl9GT1JNQVRTO3JldHVybiBmdW5jdGlvbihiLGQpe3JldHVybiBNYyhiLGEuUEFUVEVSTlNbMF0sYS5HUk9VUF9TRVAsYS5ERUNJTUFMX1NFUCxkKX19ZnVuY3Rpb24gTWMoYixhLGMsZCxlKXtpZihudWxsPT1ifHwhaXNGaW5pdGUoYil8fFgoYikpcmV0dXJuXCJcIjt2YXIgZz0wPmI7Yj1NYXRoLmFicyhiKTt2YXIgZj1iK1wiXCIsaD1cIlwiLGw9W10saz0hMTtpZigtMSE9PWYuaW5kZXhPZihcImVcIikpe3ZhciBtPWYubWF0Y2goLyhbXFxkXFwuXSspZSgtPykoXFxkKykvKTttJiZcIi1cIj09bVsyXSYmbVszXT5lKzE/Zj1cIjBcIjooaD1mLGs9ITApfWlmKGspMDxlJiYoLTE8YiYmMT5iKSYmKGg9Yi50b0ZpeGVkKGUpKTtcbmVsc2V7Zj0oZi5zcGxpdChOYylbMV18fFwiXCIpLmxlbmd0aDtFKGUpJiYoZT1NYXRoLm1pbihNYXRoLm1heChhLm1pbkZyYWMsZiksYS5tYXhGcmFjKSk7Zj1NYXRoLnBvdygxMCxlKTtiPU1hdGgucm91bmQoYipmKS9mO2I9KFwiXCIrYikuc3BsaXQoTmMpO2Y9YlswXTtiPWJbMV18fFwiXCI7dmFyIG09MCxuPWEubGdTaXplLHA9YS5nU2l6ZTtpZihmLmxlbmd0aD49bitwKWZvcihtPWYubGVuZ3RoLW4saz0wO2s8bTtrKyspMD09PShtLWspJXAmJjAhPT1rJiYoaCs9YyksaCs9Zi5jaGFyQXQoayk7Zm9yKGs9bTtrPGYubGVuZ3RoO2srKykwPT09KGYubGVuZ3RoLWspJW4mJjAhPT1rJiYoaCs9YyksaCs9Zi5jaGFyQXQoayk7Zm9yKDtiLmxlbmd0aDxlOyliKz1cIjBcIjtlJiZcIjBcIiE9PWUmJihoKz1kK2Iuc3Vic3RyKDAsZSkpfWwucHVzaChnP2EubmVnUHJlOmEucG9zUHJlKTtsLnB1c2goaCk7bC5wdXNoKGc/YS5uZWdTdWY6YS5wb3NTdWYpO3JldHVybiBsLmpvaW4oXCJcIil9ZnVuY3Rpb24gT2IoYixcbmEsYyl7dmFyIGQ9XCJcIjswPmImJihkPVwiLVwiLGI9LWIpO2ZvcihiPVwiXCIrYjtiLmxlbmd0aDxhOyliPVwiMFwiK2I7YyYmKGI9Yi5zdWJzdHIoYi5sZW5ndGgtYSkpO3JldHVybiBkK2J9ZnVuY3Rpb24gJChiLGEsYyxkKXtjPWN8fDA7cmV0dXJuIGZ1bmN0aW9uKGUpe2U9ZVtcImdldFwiK2JdKCk7aWYoMDxjfHxlPi1jKWUrPWM7MD09PWUmJi0xMj09YyYmKGU9MTIpO3JldHVybiBPYihlLGEsZCl9fWZ1bmN0aW9uIHBiKGIsYSl7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7dmFyIGU9Y1tcImdldFwiK2JdKCksZz1GYShhP1wiU0hPUlRcIitiOmIpO3JldHVybiBkW2ddW2VdfX1mdW5jdGlvbiBKYyhiKXtmdW5jdGlvbiBhKGEpe3ZhciBiO2lmKGI9YS5tYXRjaChjKSl7YT1uZXcgRGF0ZSgwKTt2YXIgZz0wLGY9MCxoPWJbOF0/YS5zZXRVVENGdWxsWWVhcjphLnNldEZ1bGxZZWFyLGw9Yls4XT9hLnNldFVUQ0hvdXJzOmEuc2V0SG91cnM7Yls5XSYmKGc9WShiWzldK2JbMTBdKSxmPVkoYls5XStiWzExXSkpO1xuaC5jYWxsKGEsWShiWzFdKSxZKGJbMl0pLTEsWShiWzNdKSk7Zz1ZKGJbNF18fDApLWc7Zj1ZKGJbNV18fDApLWY7aD1ZKGJbNl18fDApO2I9TWF0aC5yb3VuZCgxRTMqcGFyc2VGbG9hdChcIjAuXCIrKGJbN118fDApKSk7bC5jYWxsKGEsZyxmLGgsYil9cmV0dXJuIGF9dmFyIGM9L14oXFxkezR9KS0/KFxcZFxcZCktPyhcXGRcXGQpKD86VChcXGRcXGQpKD86Oj8oXFxkXFxkKSg/Ojo/KFxcZFxcZCkoPzpcXC4oXFxkKykpPyk/KT8oWnwoWystXSkoXFxkXFxkKTo/KFxcZFxcZCkpPyk/JC87cmV0dXJuIGZ1bmN0aW9uKGMsZSl7dmFyIGc9XCJcIixmPVtdLGgsbDtlPWV8fFwibWVkaXVtRGF0ZVwiO2U9Yi5EQVRFVElNRV9GT1JNQVRTW2VdfHxlO3coYykmJihjPUdlLnRlc3QoYyk/WShjKTphKGMpKTt2YihjKSYmKGM9bmV3IERhdGUoYykpO2lmKCFOYShjKSlyZXR1cm4gYztmb3IoO2U7KShsPUhlLmV4ZWMoZSkpPyhmPWYuY29uY2F0KHlhLmNhbGwobCwxKSksZT1mLnBvcCgpKTooZi5wdXNoKGUpLGU9bnVsbCk7cShmLGZ1bmN0aW9uKGEpe2g9XG5JZVthXTtnKz1oP2goYyxiLkRBVEVUSU1FX0ZPUk1BVFMpOmEucmVwbGFjZSgvKF4nfCckKS9nLFwiXCIpLnJlcGxhY2UoLycnL2csXCInXCIpfSk7cmV0dXJuIGd9fWZ1bmN0aW9uIENlKCl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBxYShiLCEwKX19ZnVuY3Rpb24gRGUoKXtyZXR1cm4gZnVuY3Rpb24oYixhKXtpZighTShiKSYmIXcoYikpcmV0dXJuIGI7YT1ZKGEpO2lmKHcoYikpcmV0dXJuIGE/MDw9YT9iLnNsaWNlKDAsYSk6Yi5zbGljZShhLGIubGVuZ3RoKTpcIlwiO3ZhciBjPVtdLGQsZTthPmIubGVuZ3RoP2E9Yi5sZW5ndGg6YTwtYi5sZW5ndGgmJihhPS1iLmxlbmd0aCk7MDxhPyhkPTAsZT1hKTooZD1iLmxlbmd0aCthLGU9Yi5sZW5ndGgpO2Zvcig7ZDxlO2QrKyljLnB1c2goYltkXSk7cmV0dXJuIGN9fWZ1bmN0aW9uIExjKGIpe3JldHVybiBmdW5jdGlvbihhLGMsZCl7ZnVuY3Rpb24gZShhLGIpe3JldHVybiBRYShiKT9mdW5jdGlvbihiLGMpe3JldHVybiBhKGMsYil9OmF9XG5mdW5jdGlvbiBnKGEsYil7dmFyIGM9dHlwZW9mIGEsZD10eXBlb2YgYjtyZXR1cm4gYz09ZD8oXCJzdHJpbmdcIj09YyYmKGE9YS50b0xvd2VyQ2FzZSgpLGI9Yi50b0xvd2VyQ2FzZSgpKSxhPT09Yj8wOmE8Yj8tMToxKTpjPGQ/LTE6MX1pZighTShhKXx8IWMpcmV0dXJuIGE7Yz1NKGMpP2M6W2NdO2M9VWMoYyxmdW5jdGlvbihhKXt2YXIgYz0hMSxkPWF8fERhO2lmKHcoYSkpe2lmKFwiK1wiPT1hLmNoYXJBdCgwKXx8XCItXCI9PWEuY2hhckF0KDApKWM9XCItXCI9PWEuY2hhckF0KDApLGE9YS5zdWJzdHJpbmcoMSk7ZD1iKGEpO2lmKGQuY29uc3RhbnQpe3ZhciBmPWQoKTtyZXR1cm4gZShmdW5jdGlvbihhLGIpe3JldHVybiBnKGFbZl0sYltmXSl9LGMpfX1yZXR1cm4gZShmdW5jdGlvbihhLGIpe3JldHVybiBnKGQoYSksZChiKSl9LGMpfSk7Zm9yKHZhciBmPVtdLGg9MDtoPGEubGVuZ3RoO2grKylmLnB1c2goYVtoXSk7cmV0dXJuIGYuc29ydChlKGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBkPVxuMDtkPGMubGVuZ3RoO2QrKyl7dmFyIGU9Y1tkXShhLGIpO2lmKDAhPT1lKXJldHVybiBlfXJldHVybiAwfSxkKSl9fWZ1bmN0aW9uIHZhKGIpe1AoYikmJihiPXtsaW5rOmJ9KTtiLnJlc3RyaWN0PWIucmVzdHJpY3R8fFwiQUNcIjtyZXR1cm4gYWEoYil9ZnVuY3Rpb24gT2MoYixhLGMsZCl7ZnVuY3Rpb24gZShhLGMpe2M9Yz9cIi1cIitmYihjLFwiLVwiKTpcIlwiO2QucmVtb3ZlQ2xhc3MoYiwoYT9xYjpyYikrYyk7ZC5hZGRDbGFzcyhiLChhP3JiOnFiKStjKX12YXIgZz10aGlzLGY9Yi5wYXJlbnQoKS5jb250cm9sbGVyKFwiZm9ybVwiKXx8c2IsaD0wLGw9Zy4kZXJyb3I9e30saz1bXTtnLiRuYW1lPWEubmFtZXx8YS5uZ0Zvcm07Zy4kZGlydHk9ITE7Zy4kcHJpc3RpbmU9ITA7Zy4kdmFsaWQ9ITA7Zy4kaW52YWxpZD0hMTtmLiRhZGRDb250cm9sKGcpO2IuYWRkQ2xhc3MoTGEpO2UoITApO2cuJGFkZENvbnRyb2w9ZnVuY3Rpb24oYSl7QWEoYS4kbmFtZSxcImlucHV0XCIpO2sucHVzaChhKTthLiRuYW1lJiZcbihnW2EuJG5hbWVdPWEpfTtnLiRyZW1vdmVDb250cm9sPWZ1bmN0aW9uKGEpe2EuJG5hbWUmJmdbYS4kbmFtZV09PT1hJiZkZWxldGUgZ1thLiRuYW1lXTtxKGwsZnVuY3Rpb24oYixjKXtnLiRzZXRWYWxpZGl0eShjLCEwLGEpfSk7T2EoayxhKX07Zy4kc2V0VmFsaWRpdHk9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWxbYV07aWYoYilkJiYoT2EoZCxjKSxkLmxlbmd0aHx8KGgtLSxofHwoZShiKSxnLiR2YWxpZD0hMCxnLiRpbnZhbGlkPSExKSxsW2FdPSExLGUoITAsYSksZi4kc2V0VmFsaWRpdHkoYSwhMCxnKSkpO2Vsc2V7aHx8ZShiKTtpZihkKXtpZigtMSE9ZGIoZCxjKSlyZXR1cm59ZWxzZSBsW2FdPWQ9W10saCsrLGUoITEsYSksZi4kc2V0VmFsaWRpdHkoYSwhMSxnKTtkLnB1c2goYyk7Zy4kdmFsaWQ9ITE7Zy4kaW52YWxpZD0hMH19O2cuJHNldERpcnR5PWZ1bmN0aW9uKCl7ZC5yZW1vdmVDbGFzcyhiLExhKTtkLmFkZENsYXNzKGIsdGIpO2cuJGRpcnR5PSEwO2cuJHByaXN0aW5lPVxuITE7Zi4kc2V0RGlydHkoKX07Zy4kc2V0UHJpc3RpbmU9ZnVuY3Rpb24oKXtkLnJlbW92ZUNsYXNzKGIsdGIpO2QuYWRkQ2xhc3MoYixMYSk7Zy4kZGlydHk9ITE7Zy4kcHJpc3RpbmU9ITA7cShrLGZ1bmN0aW9uKGEpe2EuJHNldFByaXN0aW5lKCl9KX19ZnVuY3Rpb24gcGEoYixhLGMsZCl7Yi4kc2V0VmFsaWRpdHkoYSxjKTtyZXR1cm4gYz9kOnN9ZnVuY3Rpb24gSmUoYixhLGMpe3ZhciBkPWMucHJvcChcInZhbGlkaXR5XCIpO1goZCkmJmIuJHBhcnNlcnMucHVzaChmdW5jdGlvbihjKXtpZihiLiRlcnJvclthXXx8IShkLmJhZElucHV0fHxkLmN1c3RvbUVycm9yfHxkLnR5cGVNaXNtYXRjaCl8fGQudmFsdWVNaXNzaW5nKXJldHVybiBjO2IuJHNldFZhbGlkaXR5KGEsITEpfSl9ZnVuY3Rpb24gdWIoYixhLGMsZCxlLGcpe3ZhciBmPWEucHJvcChcInZhbGlkaXR5XCIpO2lmKCFlLmFuZHJvaWQpe3ZhciBoPSExO2Eub24oXCJjb21wb3NpdGlvbnN0YXJ0XCIsZnVuY3Rpb24oYSl7aD0hMH0pO1xuYS5vbihcImNvbXBvc2l0aW9uZW5kXCIsZnVuY3Rpb24oKXtoPSExO2woKX0pfXZhciBsPWZ1bmN0aW9uKCl7aWYoIWgpe3ZhciBlPWEudmFsKCk7UWEoYy5uZ1RyaW18fFwiVFwiKSYmKGU9Y2EoZSkpO2lmKGQuJHZpZXdWYWx1ZSE9PWV8fGYmJlwiXCI9PT1lJiYhZi52YWx1ZU1pc3NpbmcpYi4kJHBoYXNlP2QuJHNldFZpZXdWYWx1ZShlKTpiLiRhcHBseShmdW5jdGlvbigpe2QuJHNldFZpZXdWYWx1ZShlKX0pfX07aWYoZS5oYXNFdmVudChcImlucHV0XCIpKWEub24oXCJpbnB1dFwiLGwpO2Vsc2V7dmFyIGssbT1mdW5jdGlvbigpe2t8fChrPWcuZGVmZXIoZnVuY3Rpb24oKXtsKCk7az1udWxsfSkpfTthLm9uKFwia2V5ZG93blwiLGZ1bmN0aW9uKGEpe2E9YS5rZXlDb2RlOzkxPT09YXx8KDE1PGEmJjE5PmF8fDM3PD1hJiY0MD49YSl8fG0oKX0pO2lmKGUuaGFzRXZlbnQoXCJwYXN0ZVwiKSlhLm9uKFwicGFzdGUgY3V0XCIsbSl9YS5vbihcImNoYW5nZVwiLGwpO2QuJHJlbmRlcj1mdW5jdGlvbigpe2EudmFsKGQuJGlzRW1wdHkoZC4kdmlld1ZhbHVlKT9cblwiXCI6ZC4kdmlld1ZhbHVlKX07dmFyIG49Yy5uZ1BhdHRlcm47biYmKChlPW4ubWF0Y2goL15cXC8oLiopXFwvKFtnaW1dKikkLykpPyhuPVJlZ0V4cChlWzFdLGVbMl0pLGU9ZnVuY3Rpb24oYSl7cmV0dXJuIHBhKGQsXCJwYXR0ZXJuXCIsZC4kaXNFbXB0eShhKXx8bi50ZXN0KGEpLGEpfSk6ZT1mdW5jdGlvbihjKXt2YXIgZT1iLiRldmFsKG4pO2lmKCFlfHwhZS50ZXN0KXRocm93IHQoXCJuZ1BhdHRlcm5cIikoXCJub3JlZ2V4cFwiLG4sZSxoYShhKSk7cmV0dXJuIHBhKGQsXCJwYXR0ZXJuXCIsZC4kaXNFbXB0eShjKXx8ZS50ZXN0KGMpLGMpfSxkLiRmb3JtYXR0ZXJzLnB1c2goZSksZC4kcGFyc2Vycy5wdXNoKGUpKTtpZihjLm5nTWlubGVuZ3RoKXt2YXIgcD1ZKGMubmdNaW5sZW5ndGgpO2U9ZnVuY3Rpb24oYSl7cmV0dXJuIHBhKGQsXCJtaW5sZW5ndGhcIixkLiRpc0VtcHR5KGEpfHxhLmxlbmd0aD49cCxhKX07ZC4kcGFyc2Vycy5wdXNoKGUpO2QuJGZvcm1hdHRlcnMucHVzaChlKX1pZihjLm5nTWF4bGVuZ3RoKXt2YXIgcj1cblkoYy5uZ01heGxlbmd0aCk7ZT1mdW5jdGlvbihhKXtyZXR1cm4gcGEoZCxcIm1heGxlbmd0aFwiLGQuJGlzRW1wdHkoYSl8fGEubGVuZ3RoPD1yLGEpfTtkLiRwYXJzZXJzLnB1c2goZSk7ZC4kZm9ybWF0dGVycy5wdXNoKGUpfX1mdW5jdGlvbiBQYihiLGEpe2I9XCJuZ0NsYXNzXCIrYjtyZXR1cm5bXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGMpe2Z1bmN0aW9uIGQoYSxiKXt2YXIgYz1bXSxkPTA7YTpmb3IoO2Q8YS5sZW5ndGg7ZCsrKXtmb3IodmFyIGU9YVtkXSxtPTA7bTxiLmxlbmd0aDttKyspaWYoZT09YlttXSljb250aW51ZSBhO2MucHVzaChlKX1yZXR1cm4gY31mdW5jdGlvbiBlKGEpe2lmKCFNKGEpKXtpZih3KGEpKXJldHVybiBhLnNwbGl0KFwiIFwiKTtpZihYKGEpKXt2YXIgYj1bXTtxKGEsZnVuY3Rpb24oYSxjKXthJiZiLnB1c2goYyl9KTtyZXR1cm4gYn19cmV0dXJuIGF9cmV0dXJue3Jlc3RyaWN0OlwiQUNcIixsaW5rOmZ1bmN0aW9uKGcsZixoKXtmdW5jdGlvbiBsKGEsYil7dmFyIGM9XG5mLmRhdGEoXCIkY2xhc3NDb3VudHNcIil8fHt9LGQ9W107cShhLGZ1bmN0aW9uKGEpe2lmKDA8Ynx8Y1thXSljW2FdPShjW2FdfHwwKStiLGNbYV09PT0rKDA8YikmJmQucHVzaChhKX0pO2YuZGF0YShcIiRjbGFzc0NvdW50c1wiLGMpO3JldHVybiBkLmpvaW4oXCIgXCIpfWZ1bmN0aW9uIGsoYil7aWYoITA9PT1hfHxnLiRpbmRleCUyPT09YSl7dmFyIGs9ZShifHxbXSk7aWYoIW0pe3ZhciByPWwoaywxKTtoLiRhZGRDbGFzcyhyKX1lbHNlIGlmKCF4YShiLG0pKXt2YXIgcT1lKG0pLHI9ZChrLHEpLGs9ZChxLGspLGs9bChrLC0xKSxyPWwociwxKTswPT09ci5sZW5ndGg/Yy5yZW1vdmVDbGFzcyhmLGspOjA9PT1rLmxlbmd0aD9jLmFkZENsYXNzKGYscik6Yy5zZXRDbGFzcyhmLHIsayl9fW09YmEoYil9dmFyIG07Zy4kd2F0Y2goaFtiXSxrLCEwKTtoLiRvYnNlcnZlKFwiY2xhc3NcIixmdW5jdGlvbihhKXtrKGcuJGV2YWwoaFtiXSkpfSk7XCJuZ0NsYXNzXCIhPT1iJiZnLiR3YXRjaChcIiRpbmRleFwiLFxuZnVuY3Rpb24oYyxkKXt2YXIgZj1jJjE7aWYoZiE9PWQmMSl7dmFyIGs9ZShnLiRldmFsKGhbYl0pKTtmPT09YT8oZj1sKGssMSksaC4kYWRkQ2xhc3MoZikpOihmPWwoaywtMSksaC4kcmVtb3ZlQ2xhc3MoZikpfX0pfX19XX12YXIgSz1mdW5jdGlvbihiKXtyZXR1cm4gdyhiKT9iLnRvTG93ZXJDYXNlKCk6Yn0sRmM9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxGYT1mdW5jdGlvbihiKXtyZXR1cm4gdyhiKT9iLnRvVXBwZXJDYXNlKCk6Yn0sUyx5LEdhLHlhPVtdLnNsaWNlLEtlPVtdLnB1c2gsd2E9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxQYT10KFwibmdcIiksRWE9Ty5hbmd1bGFyfHwoTy5hbmd1bGFyPXt9KSxTYSxLYSxrYT1bXCIwXCIsXCIwXCIsXCIwXCJdO1M9WSgoL21zaWUgKFxcZCspLy5leGVjKEsobmF2aWdhdG9yLnVzZXJBZ2VudCkpfHxbXSlbMV0pO2lzTmFOKFMpJiYoUz1ZKCgvdHJpZGVudFxcLy4qOyBydjooXFxkKykvLmV4ZWMoSyhuYXZpZ2F0b3IudXNlckFnZW50KSl8fFxuW10pWzFdKSk7Qy4kaW5qZWN0PVtdO0RhLiRpbmplY3Q9W107dmFyIGNhPWZ1bmN0aW9uKCl7cmV0dXJuIFN0cmluZy5wcm90b3R5cGUudHJpbT9mdW5jdGlvbihiKXtyZXR1cm4gdyhiKT9iLnRyaW0oKTpifTpmdW5jdGlvbihiKXtyZXR1cm4gdyhiKT9iLnJlcGxhY2UoL15cXHNcXHMqLyxcIlwiKS5yZXBsYWNlKC9cXHNcXHMqJC8sXCJcIik6Yn19KCk7S2E9OT5TP2Z1bmN0aW9uKGIpe2I9Yi5ub2RlTmFtZT9iOmJbMF07cmV0dXJuIGIuc2NvcGVOYW1lJiZcIkhUTUxcIiE9Yi5zY29wZU5hbWU/RmEoYi5zY29wZU5hbWUrXCI6XCIrYi5ub2RlTmFtZSk6Yi5ub2RlTmFtZX06ZnVuY3Rpb24oYil7cmV0dXJuIGIubm9kZU5hbWU/Yi5ub2RlTmFtZTpiWzBdLm5vZGVOYW1lfTt2YXIgWGM9L1tBLVpdL2csJGM9e2Z1bGw6XCIxLjIuMTZcIixtYWpvcjoxLG1pbm9yOjIsZG90OjE2LGNvZGVOYW1lOlwiYmFkZ2VyLWVudW1lcmF0aW9uXCJ9LFVhPU4uY2FjaGU9e30sZ2I9Ti5leHBhbmRvPVwibmctXCIrKG5ldyBEYXRlKS5nZXRUaW1lKCksXG5tZT0xLFBjPU8uZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcj9mdW5jdGlvbihiLGEsYyl7Yi5hZGRFdmVudExpc3RlbmVyKGEsYywhMSl9OmZ1bmN0aW9uKGIsYSxjKXtiLmF0dGFjaEV2ZW50KFwib25cIithLGMpfSxGYj1PLmRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXI/ZnVuY3Rpb24oYixhLGMpe2IucmVtb3ZlRXZlbnRMaXN0ZW5lcihhLGMsITEpfTpmdW5jdGlvbihiLGEsYyl7Yi5kZXRhY2hFdmVudChcIm9uXCIrYSxjKX07Ti5fZGF0YT1mdW5jdGlvbihiKXtyZXR1cm4gdGhpcy5jYWNoZVtiW3RoaXMuZXhwYW5kb11dfHx7fX07dmFyIGhlPS8oW1xcOlxcLVxcX10rKC4pKS9nLGllPS9ebW96KFtBLVpdKS8sQmI9dChcImpxTGl0ZVwiKSxqZT0vXjwoXFx3KylcXHMqXFwvPz4oPzo8XFwvXFwxPnwpJC8sQ2I9Lzx8JiM/XFx3KzsvLGtlPS88KFtcXHc6XSspLyxsZT0vPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1dHxsaW5rfG1ldGF8cGFyYW0pKChbXFx3Ol0rKVtePl0qKVxcLz4vZ2ksZWE9XG57b3B0aW9uOlsxLCc8c2VsZWN0IG11bHRpcGxlPVwibXVsdGlwbGVcIj4nLFwiPC9zZWxlY3Q+XCJdLHRoZWFkOlsxLFwiPHRhYmxlPlwiLFwiPC90YWJsZT5cIl0sY29sOlsyLFwiPHRhYmxlPjxjb2xncm91cD5cIixcIjwvY29sZ3JvdXA+PC90YWJsZT5cIl0sdHI6WzIsXCI8dGFibGU+PHRib2R5PlwiLFwiPC90Ym9keT48L3RhYmxlPlwiXSx0ZDpbMyxcIjx0YWJsZT48dGJvZHk+PHRyPlwiLFwiPC90cj48L3Rib2R5PjwvdGFibGU+XCJdLF9kZWZhdWx0OlswLFwiXCIsXCJcIl19O2VhLm9wdGdyb3VwPWVhLm9wdGlvbjtlYS50Ym9keT1lYS50Zm9vdD1lYS5jb2xncm91cD1lYS5jYXB0aW9uPWVhLnRoZWFkO2VhLnRoPWVhLnRkO3ZhciBKYT1OLnByb3RvdHlwZT17cmVhZHk6ZnVuY3Rpb24oYil7ZnVuY3Rpb24gYSgpe2N8fChjPSEwLGIoKSl9dmFyIGM9ITE7XCJjb21wbGV0ZVwiPT09VS5yZWFkeVN0YXRlP3NldFRpbWVvdXQoYSk6KHRoaXMub24oXCJET01Db250ZW50TG9hZGVkXCIsYSksTihPKS5vbihcImxvYWRcIixhKSl9LHRvU3RyaW5nOmZ1bmN0aW9uKCl7dmFyIGI9XG5bXTtxKHRoaXMsZnVuY3Rpb24oYSl7Yi5wdXNoKFwiXCIrYSl9KTtyZXR1cm5cIltcIitiLmpvaW4oXCIsIFwiKStcIl1cIn0sZXE6ZnVuY3Rpb24oYil7cmV0dXJuIDA8PWI/eSh0aGlzW2JdKTp5KHRoaXNbdGhpcy5sZW5ndGgrYl0pfSxsZW5ndGg6MCxwdXNoOktlLHNvcnQ6W10uc29ydCxzcGxpY2U6W10uc3BsaWNlfSxrYj17fTtxKFwibXVsdGlwbGUgc2VsZWN0ZWQgY2hlY2tlZCBkaXNhYmxlZCByZWFkT25seSByZXF1aXJlZCBvcGVuXCIuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGIpe2tiW0soYildPWJ9KTt2YXIgbmM9e307cShcImlucHV0IHNlbGVjdCBvcHRpb24gdGV4dGFyZWEgYnV0dG9uIGZvcm0gZGV0YWlsc1wiLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihiKXtuY1tGYShiKV09ITB9KTtxKHtkYXRhOmpjLGluaGVyaXRlZERhdGE6amIsc2NvcGU6ZnVuY3Rpb24oYil7cmV0dXJuIHkoYikuZGF0YShcIiRzY29wZVwiKXx8amIoYi5wYXJlbnROb2RlfHxiLFtcIiRpc29sYXRlU2NvcGVcIixcIiRzY29wZVwiXSl9LFxuaXNvbGF0ZVNjb3BlOmZ1bmN0aW9uKGIpe3JldHVybiB5KGIpLmRhdGEoXCIkaXNvbGF0ZVNjb3BlXCIpfHx5KGIpLmRhdGEoXCIkaXNvbGF0ZVNjb3BlTm9UZW1wbGF0ZVwiKX0sY29udHJvbGxlcjprYyxpbmplY3RvcjpmdW5jdGlvbihiKXtyZXR1cm4gamIoYixcIiRpbmplY3RvclwiKX0scmVtb3ZlQXR0cjpmdW5jdGlvbihiLGEpe2IucmVtb3ZlQXR0cmlidXRlKGEpfSxoYXNDbGFzczpHYixjc3M6ZnVuY3Rpb24oYixhLGMpe2E9VGEoYSk7aWYoQihjKSliLnN0eWxlW2FdPWM7ZWxzZXt2YXIgZDs4Pj1TJiYoZD1iLmN1cnJlbnRTdHlsZSYmYi5jdXJyZW50U3R5bGVbYV0sXCJcIj09PWQmJihkPVwiYXV0b1wiKSk7ZD1kfHxiLnN0eWxlW2FdOzg+PVMmJihkPVwiXCI9PT1kP3M6ZCk7cmV0dXJuIGR9fSxhdHRyOmZ1bmN0aW9uKGIsYSxjKXt2YXIgZD1LKGEpO2lmKGtiW2RdKWlmKEIoYykpYz8oYlthXT0hMCxiLnNldEF0dHJpYnV0ZShhLGQpKTooYlthXT0hMSxiLnJlbW92ZUF0dHJpYnV0ZShkKSk7XG5lbHNlIHJldHVybiBiW2FdfHwoYi5hdHRyaWJ1dGVzLmdldE5hbWVkSXRlbShhKXx8Qykuc3BlY2lmaWVkP2Q6cztlbHNlIGlmKEIoYykpYi5zZXRBdHRyaWJ1dGUoYSxjKTtlbHNlIGlmKGIuZ2V0QXR0cmlidXRlKXJldHVybiBiPWIuZ2V0QXR0cmlidXRlKGEsMiksbnVsbD09PWI/czpifSxwcm9wOmZ1bmN0aW9uKGIsYSxjKXtpZihCKGMpKWJbYV09YztlbHNlIHJldHVybiBiW2FdfSx0ZXh0OmZ1bmN0aW9uKCl7ZnVuY3Rpb24gYihiLGQpe3ZhciBlPWFbYi5ub2RlVHlwZV07aWYoRShkKSlyZXR1cm4gZT9iW2VdOlwiXCI7YltlXT1kfXZhciBhPVtdOzk+Uz8oYVsxXT1cImlubmVyVGV4dFwiLGFbM109XCJub2RlVmFsdWVcIik6YVsxXT1hWzNdPVwidGV4dENvbnRlbnRcIjtiLiRkdj1cIlwiO3JldHVybiBifSgpLHZhbDpmdW5jdGlvbihiLGEpe2lmKEUoYSkpe2lmKFwiU0VMRUNUXCI9PT1LYShiKSYmYi5tdWx0aXBsZSl7dmFyIGM9W107cShiLm9wdGlvbnMsZnVuY3Rpb24oYSl7YS5zZWxlY3RlZCYmXG5jLnB1c2goYS52YWx1ZXx8YS50ZXh0KX0pO3JldHVybiAwPT09Yy5sZW5ndGg/bnVsbDpjfXJldHVybiBiLnZhbHVlfWIudmFsdWU9YX0saHRtbDpmdW5jdGlvbihiLGEpe2lmKEUoYSkpcmV0dXJuIGIuaW5uZXJIVE1MO2Zvcih2YXIgYz0wLGQ9Yi5jaGlsZE5vZGVzO2M8ZC5sZW5ndGg7YysrKUhhKGRbY10pO2IuaW5uZXJIVE1MPWF9LGVtcHR5OmxjfSxmdW5jdGlvbihiLGEpe04ucHJvdG90eXBlW2FdPWZ1bmN0aW9uKGEsZCl7dmFyIGUsZztpZihiIT09bGMmJigyPT1iLmxlbmd0aCYmYiE9PUdiJiZiIT09a2M/YTpkKT09PXMpe2lmKFgoYSkpe2ZvcihlPTA7ZTx0aGlzLmxlbmd0aDtlKyspaWYoYj09PWpjKWIodGhpc1tlXSxhKTtlbHNlIGZvcihnIGluIGEpYih0aGlzW2VdLGcsYVtnXSk7cmV0dXJuIHRoaXN9ZT1iLiRkdjtnPWU9PT1zP01hdGgubWluKHRoaXMubGVuZ3RoLDEpOnRoaXMubGVuZ3RoO2Zvcih2YXIgZj0wO2Y8ZztmKyspe3ZhciBoPWIodGhpc1tmXSxhLGQpO2U9XG5lP2UraDpofXJldHVybiBlfWZvcihlPTA7ZTx0aGlzLmxlbmd0aDtlKyspYih0aGlzW2VdLGEsZCk7cmV0dXJuIHRoaXN9fSk7cSh7cmVtb3ZlRGF0YTpoYyxkZWFsb2M6SGEsb246ZnVuY3Rpb24gYShjLGQsZSxnKXtpZihCKGcpKXRocm93IEJiKFwib25hcmdzXCIpO3ZhciBmPWxhKGMsXCJldmVudHNcIiksaD1sYShjLFwiaGFuZGxlXCIpO2Z8fGxhKGMsXCJldmVudHNcIixmPXt9KTtofHxsYShjLFwiaGFuZGxlXCIsaD1uZShjLGYpKTtxKGQuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGQpe3ZhciBnPWZbZF07aWYoIWcpe2lmKFwibW91c2VlbnRlclwiPT1kfHxcIm1vdXNlbGVhdmVcIj09ZCl7dmFyIG09VS5ib2R5LmNvbnRhaW5zfHxVLmJvZHkuY29tcGFyZURvY3VtZW50UG9zaXRpb24/ZnVuY3Rpb24oYSxjKXt2YXIgZD05PT09YS5ub2RlVHlwZT9hLmRvY3VtZW50RWxlbWVudDphLGU9YyYmYy5wYXJlbnROb2RlO3JldHVybiBhPT09ZXx8ISEoZSYmMT09PWUubm9kZVR5cGUmJihkLmNvbnRhaW5zP2QuY29udGFpbnMoZSk6XG5hLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uJiZhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGUpJjE2KSl9OmZ1bmN0aW9uKGEsYyl7aWYoYylmb3IoO2M9Yy5wYXJlbnROb2RlOylpZihjPT09YSlyZXR1cm4hMDtyZXR1cm4hMX07ZltkXT1bXTthKGMse21vdXNlbGVhdmU6XCJtb3VzZW91dFwiLG1vdXNlZW50ZXI6XCJtb3VzZW92ZXJcIn1bZF0sZnVuY3Rpb24oYSl7dmFyIGM9YS5yZWxhdGVkVGFyZ2V0O2MmJihjPT09dGhpc3x8bSh0aGlzLGMpKXx8aChhLGQpfSl9ZWxzZSBQYyhjLGQsaCksZltkXT1bXTtnPWZbZF19Zy5wdXNoKGUpfSl9LG9mZjppYyxvbmU6ZnVuY3Rpb24oYSxjLGQpe2E9eShhKTthLm9uKGMsZnVuY3Rpb24gZygpe2Eub2ZmKGMsZCk7YS5vZmYoYyxnKX0pO2Eub24oYyxkKX0scmVwbGFjZVdpdGg6ZnVuY3Rpb24oYSxjKXt2YXIgZCxlPWEucGFyZW50Tm9kZTtIYShhKTtxKG5ldyBOKGMpLGZ1bmN0aW9uKGMpe2Q/ZS5pbnNlcnRCZWZvcmUoYyxkLm5leHRTaWJsaW5nKTpcbmUucmVwbGFjZUNoaWxkKGMsYSk7ZD1jfSl9LGNoaWxkcmVuOmZ1bmN0aW9uKGEpe3ZhciBjPVtdO3EoYS5jaGlsZE5vZGVzLGZ1bmN0aW9uKGEpezE9PT1hLm5vZGVUeXBlJiZjLnB1c2goYSl9KTtyZXR1cm4gY30sY29udGVudHM6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuY29udGVudERvY3VtZW50fHxhLmNoaWxkTm9kZXN8fFtdfSxhcHBlbmQ6ZnVuY3Rpb24oYSxjKXtxKG5ldyBOKGMpLGZ1bmN0aW9uKGMpezEhPT1hLm5vZGVUeXBlJiYxMSE9PWEubm9kZVR5cGV8fGEuYXBwZW5kQ2hpbGQoYyl9KX0scHJlcGVuZDpmdW5jdGlvbihhLGMpe2lmKDE9PT1hLm5vZGVUeXBlKXt2YXIgZD1hLmZpcnN0Q2hpbGQ7cShuZXcgTihjKSxmdW5jdGlvbihjKXthLmluc2VydEJlZm9yZShjLGQpfSl9fSx3cmFwOmZ1bmN0aW9uKGEsYyl7Yz15KGMpWzBdO3ZhciBkPWEucGFyZW50Tm9kZTtkJiZkLnJlcGxhY2VDaGlsZChjLGEpO2MuYXBwZW5kQ2hpbGQoYSl9LHJlbW92ZTpmdW5jdGlvbihhKXtIYShhKTtcbnZhciBjPWEucGFyZW50Tm9kZTtjJiZjLnJlbW92ZUNoaWxkKGEpfSxhZnRlcjpmdW5jdGlvbihhLGMpe3ZhciBkPWEsZT1hLnBhcmVudE5vZGU7cShuZXcgTihjKSxmdW5jdGlvbihhKXtlLmluc2VydEJlZm9yZShhLGQubmV4dFNpYmxpbmcpO2Q9YX0pfSxhZGRDbGFzczppYixyZW1vdmVDbGFzczpoYix0b2dnbGVDbGFzczpmdW5jdGlvbihhLGMsZCl7YyYmcShjLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihjKXt2YXIgZz1kO0UoZykmJihnPSFHYihhLGMpKTsoZz9pYjpoYikoYSxjKX0pfSxwYXJlbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuKGE9YS5wYXJlbnROb2RlKSYmMTEhPT1hLm5vZGVUeXBlP2E6bnVsbH0sbmV4dDpmdW5jdGlvbihhKXtpZihhLm5leHRFbGVtZW50U2libGluZylyZXR1cm4gYS5uZXh0RWxlbWVudFNpYmxpbmc7Zm9yKGE9YS5uZXh0U2libGluZztudWxsIT1hJiYxIT09YS5ub2RlVHlwZTspYT1hLm5leHRTaWJsaW5nO3JldHVybiBhfSxmaW5kOmZ1bmN0aW9uKGEsYyl7cmV0dXJuIGEuZ2V0RWxlbWVudHNCeVRhZ05hbWU/XG5hLmdldEVsZW1lbnRzQnlUYWdOYW1lKGMpOltdfSxjbG9uZTpFYix0cmlnZ2VySGFuZGxlcjpmdW5jdGlvbihhLGMsZCl7Yz0obGEoYSxcImV2ZW50c1wiKXx8e30pW2NdO2Q9ZHx8W107dmFyIGU9W3twcmV2ZW50RGVmYXVsdDpDLHN0b3BQcm9wYWdhdGlvbjpDfV07cShjLGZ1bmN0aW9uKGMpe2MuYXBwbHkoYSxlLmNvbmNhdChkKSl9KX19LGZ1bmN0aW9uKGEsYyl7Ti5wcm90b3R5cGVbY109ZnVuY3Rpb24oYyxlLGcpe2Zvcih2YXIgZixoPTA7aDx0aGlzLmxlbmd0aDtoKyspRShmKT8oZj1hKHRoaXNbaF0sYyxlLGcpLEIoZikmJihmPXkoZikpKTpEYihmLGEodGhpc1toXSxjLGUsZykpO3JldHVybiBCKGYpP2Y6dGhpc307Ti5wcm90b3R5cGUuYmluZD1OLnByb3RvdHlwZS5vbjtOLnByb3RvdHlwZS51bmJpbmQ9Ti5wcm90b3R5cGUub2ZmfSk7VmEucHJvdG90eXBlPXtwdXQ6ZnVuY3Rpb24oYSxjKXt0aGlzW0lhKGEpXT1jfSxnZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXNbSWEoYSldfSxcbnJlbW92ZTpmdW5jdGlvbihhKXt2YXIgYz10aGlzW2E9SWEoYSldO2RlbGV0ZSB0aGlzW2FdO3JldHVybiBjfX07dmFyIHBlPS9eZnVuY3Rpb25cXHMqW15cXChdKlxcKFxccyooW15cXCldKilcXCkvbSxxZT0vLC8scmU9L15cXHMqKF8/KShcXFMrPylcXDFcXHMqJC8sb2U9LygoXFwvXFwvLiokKXwoXFwvXFwqW1xcc1xcU10qP1xcKlxcLykpL21nLFdhPXQoXCIkaW5qZWN0b3JcIiksTGU9dChcIiRhbmltYXRlXCIpLExkPVtcIiRwcm92aWRlXCIsZnVuY3Rpb24oYSl7dGhpcy4kJHNlbGVjdG9ycz17fTt0aGlzLnJlZ2lzdGVyPWZ1bmN0aW9uKGMsZCl7dmFyIGU9YytcIi1hbmltYXRpb25cIjtpZihjJiZcIi5cIiE9Yy5jaGFyQXQoMCkpdGhyb3cgTGUoXCJub3Rjc2VsXCIsYyk7dGhpcy4kJHNlbGVjdG9yc1tjLnN1YnN0cigxKV09ZTthLmZhY3RvcnkoZSxkKX07dGhpcy5jbGFzc05hbWVGaWx0ZXI9ZnVuY3Rpb24oYSl7MT09PWFyZ3VtZW50cy5sZW5ndGgmJih0aGlzLiQkY2xhc3NOYW1lRmlsdGVyPWEgaW5zdGFuY2VvZiBSZWdFeHA/XG5hOm51bGwpO3JldHVybiB0aGlzLiQkY2xhc3NOYW1lRmlsdGVyfTt0aGlzLiRnZXQ9W1wiJHRpbWVvdXRcIixcIiQkYXN5bmNDYWxsYmFja1wiLGZ1bmN0aW9uKGEsZCl7cmV0dXJue2VudGVyOmZ1bmN0aW9uKGEsYyxmLGgpe2Y/Zi5hZnRlcihhKTooYyYmY1swXXx8KGM9Zi5wYXJlbnQoKSksYy5hcHBlbmQoYSkpO2gmJmQoaCl9LGxlYXZlOmZ1bmN0aW9uKGEsYyl7YS5yZW1vdmUoKTtjJiZkKGMpfSxtb3ZlOmZ1bmN0aW9uKGEsYyxkLGgpe3RoaXMuZW50ZXIoYSxjLGQsaCl9LGFkZENsYXNzOmZ1bmN0aW9uKGEsYyxmKXtjPXcoYyk/YzpNKGMpP2Muam9pbihcIiBcIik6XCJcIjtxKGEsZnVuY3Rpb24oYSl7aWIoYSxjKX0pO2YmJmQoZil9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGEsYyxmKXtjPXcoYyk/YzpNKGMpP2Muam9pbihcIiBcIik6XCJcIjtxKGEsZnVuY3Rpb24oYSl7aGIoYSxjKX0pO2YmJmQoZil9LHNldENsYXNzOmZ1bmN0aW9uKGEsYyxmLGgpe3EoYSxmdW5jdGlvbihhKXtpYihhLGMpO2hiKGEsXG5mKX0pO2gmJmQoaCl9LGVuYWJsZWQ6Q319XX1dLGphPXQoXCIkY29tcGlsZVwiKTtjYy4kaW5qZWN0PVtcIiRwcm92aWRlXCIsXCIkJHNhbml0aXplVXJpUHJvdmlkZXJcIl07dmFyIHRlPS9eKHhbXFw6XFwtX118ZGF0YVtcXDpcXC1fXSkvaSx2Yz10KFwiJGludGVycG9sYXRlXCIpLE1lPS9eKFteXFw/I10qKShcXD8oW14jXSopKT8oIyguKikpPyQvLHdlPXtodHRwOjgwLGh0dHBzOjQ0MyxmdHA6MjF9LEtiPXQoXCIkbG9jYXRpb25cIik7QWMucHJvdG90eXBlPUxiLnByb3RvdHlwZT16Yy5wcm90b3R5cGU9eyQkaHRtbDU6ITEsJCRyZXBsYWNlOiExLGFic1VybDpuYihcIiQkYWJzVXJsXCIpLHVybDpmdW5jdGlvbihhLGMpe2lmKEUoYSkpcmV0dXJuIHRoaXMuJCR1cmw7dmFyIGQ9TWUuZXhlYyhhKTtkWzFdJiZ0aGlzLnBhdGgoZGVjb2RlVVJJQ29tcG9uZW50KGRbMV0pKTsoZFsyXXx8ZFsxXSkmJnRoaXMuc2VhcmNoKGRbM118fFwiXCIpO3RoaXMuaGFzaChkWzVdfHxcIlwiLGMpO3JldHVybiB0aGlzfSxwcm90b2NvbDpuYihcIiQkcHJvdG9jb2xcIiksXG5ob3N0Om5iKFwiJCRob3N0XCIpLHBvcnQ6bmIoXCIkJHBvcnRcIikscGF0aDpCYyhcIiQkcGF0aFwiLGZ1bmN0aW9uKGEpe3JldHVyblwiL1wiPT1hLmNoYXJBdCgwKT9hOlwiL1wiK2F9KSxzZWFyY2g6ZnVuY3Rpb24oYSxjKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiB0aGlzLiQkc2VhcmNoO2Nhc2UgMTppZih3KGEpKXRoaXMuJCRzZWFyY2g9WWIoYSk7ZWxzZSBpZihYKGEpKXRoaXMuJCRzZWFyY2g9YTtlbHNlIHRocm93IEtiKFwiaXNyY2hhcmdcIik7YnJlYWs7ZGVmYXVsdDpFKGMpfHxudWxsPT09Yz9kZWxldGUgdGhpcy4kJHNlYXJjaFthXTp0aGlzLiQkc2VhcmNoW2FdPWN9dGhpcy4kJGNvbXBvc2UoKTtyZXR1cm4gdGhpc30saGFzaDpCYyhcIiQkaGFzaFwiLERhKSxyZXBsYWNlOmZ1bmN0aW9uKCl7dGhpcy4kJHJlcGxhY2U9ITA7cmV0dXJuIHRoaXN9fTt2YXIgQmE9dChcIiRwYXJzZVwiKSxFYz17fSx0YSxNYT17XCJudWxsXCI6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sXCJ0cnVlXCI6ZnVuY3Rpb24oKXtyZXR1cm4hMH0sXG5cImZhbHNlXCI6ZnVuY3Rpb24oKXtyZXR1cm4hMX0sdW5kZWZpbmVkOkMsXCIrXCI6ZnVuY3Rpb24oYSxjLGQsZSl7ZD1kKGEsYyk7ZT1lKGEsYyk7cmV0dXJuIEIoZCk/QihlKT9kK2U6ZDpCKGUpP2U6c30sXCItXCI6ZnVuY3Rpb24oYSxjLGQsZSl7ZD1kKGEsYyk7ZT1lKGEsYyk7cmV0dXJuKEIoZCk/ZDowKS0oQihlKT9lOjApfSxcIipcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpKmUoYSxjKX0sXCIvXCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKS9lKGEsYyl9LFwiJVwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYyklZShhLGMpfSxcIl5cIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpXmUoYSxjKX0sXCI9XCI6QyxcIj09PVwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYyk9PT1lKGEsYyl9LFwiIT09XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKSE9PWUoYSxjKX0sXCI9PVwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYyk9PWUoYSxcbmMpfSxcIiE9XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKSE9ZShhLGMpfSxcIjxcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpPGUoYSxjKX0sXCI+XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKT5lKGEsYyl9LFwiPD1cIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpPD1lKGEsYyl9LFwiPj1cIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpPj1lKGEsYyl9LFwiJiZcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpJiZlKGEsYyl9LFwifHxcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpfHxlKGEsYyl9LFwiJlwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYykmZShhLGMpfSxcInxcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZShhLGMpKGEsYyxkKGEsYykpfSxcIiFcIjpmdW5jdGlvbihhLGMsZCl7cmV0dXJuIWQoYSxjKX19LE5lPXtuOlwiXFxuXCIsZjpcIlxcZlwiLHI6XCJcXHJcIix0OlwiXFx0XCIsdjpcIlxcdlwiLFwiJ1wiOlwiJ1wiLCdcIic6J1wiJ30sXG5OYj1mdW5jdGlvbihhKXt0aGlzLm9wdGlvbnM9YX07TmIucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpOYixsZXg6ZnVuY3Rpb24oYSl7dGhpcy50ZXh0PWE7dGhpcy5pbmRleD0wO3RoaXMuY2g9czt0aGlzLmxhc3RDaD1cIjpcIjt0aGlzLnRva2Vucz1bXTt2YXIgYztmb3IoYT1bXTt0aGlzLmluZGV4PHRoaXMudGV4dC5sZW5ndGg7KXt0aGlzLmNoPXRoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCk7aWYodGhpcy5pcyhcIlxcXCInXCIpKXRoaXMucmVhZFN0cmluZyh0aGlzLmNoKTtlbHNlIGlmKHRoaXMuaXNOdW1iZXIodGhpcy5jaCl8fHRoaXMuaXMoXCIuXCIpJiZ0aGlzLmlzTnVtYmVyKHRoaXMucGVlaygpKSl0aGlzLnJlYWROdW1iZXIoKTtlbHNlIGlmKHRoaXMuaXNJZGVudCh0aGlzLmNoKSl0aGlzLnJlYWRJZGVudCgpLHRoaXMud2FzKFwieyxcIikmJihcIntcIj09PWFbMF0mJihjPXRoaXMudG9rZW5zW3RoaXMudG9rZW5zLmxlbmd0aC0xXSkpJiYoYy5qc29uPS0xPT09Yy50ZXh0LmluZGV4T2YoXCIuXCIpKTtcbmVsc2UgaWYodGhpcy5pcyhcIigpe31bXS4sOzo/XCIpKXRoaXMudG9rZW5zLnB1c2goe2luZGV4OnRoaXMuaW5kZXgsdGV4dDp0aGlzLmNoLGpzb246dGhpcy53YXMoXCI6WyxcIikmJnRoaXMuaXMoXCJ7W1wiKXx8dGhpcy5pcyhcIn1dOixcIil9KSx0aGlzLmlzKFwie1tcIikmJmEudW5zaGlmdCh0aGlzLmNoKSx0aGlzLmlzKFwifV1cIikmJmEuc2hpZnQoKSx0aGlzLmluZGV4Kys7ZWxzZSBpZih0aGlzLmlzV2hpdGVzcGFjZSh0aGlzLmNoKSl7dGhpcy5pbmRleCsrO2NvbnRpbnVlfWVsc2V7dmFyIGQ9dGhpcy5jaCt0aGlzLnBlZWsoKSxlPWQrdGhpcy5wZWVrKDIpLGc9TWFbdGhpcy5jaF0sZj1NYVtkXSxoPU1hW2VdO2g/KHRoaXMudG9rZW5zLnB1c2goe2luZGV4OnRoaXMuaW5kZXgsdGV4dDplLGZuOmh9KSx0aGlzLmluZGV4Kz0zKTpmPyh0aGlzLnRva2Vucy5wdXNoKHtpbmRleDp0aGlzLmluZGV4LHRleHQ6ZCxmbjpmfSksdGhpcy5pbmRleCs9Mik6Zz8odGhpcy50b2tlbnMucHVzaCh7aW5kZXg6dGhpcy5pbmRleCxcbnRleHQ6dGhpcy5jaCxmbjpnLGpzb246dGhpcy53YXMoXCJbLDpcIikmJnRoaXMuaXMoXCIrLVwiKX0pLHRoaXMuaW5kZXgrPTEpOnRoaXMudGhyb3dFcnJvcihcIlVuZXhwZWN0ZWQgbmV4dCBjaGFyYWN0ZXIgXCIsdGhpcy5pbmRleCx0aGlzLmluZGV4KzEpfXRoaXMubGFzdENoPXRoaXMuY2h9cmV0dXJuIHRoaXMudG9rZW5zfSxpczpmdW5jdGlvbihhKXtyZXR1cm4tMSE9PWEuaW5kZXhPZih0aGlzLmNoKX0sd2FzOmZ1bmN0aW9uKGEpe3JldHVybi0xIT09YS5pbmRleE9mKHRoaXMubGFzdENoKX0scGVlazpmdW5jdGlvbihhKXthPWF8fDE7cmV0dXJuIHRoaXMuaW5kZXgrYTx0aGlzLnRleHQubGVuZ3RoP3RoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCthKTohMX0saXNOdW1iZXI6ZnVuY3Rpb24oYSl7cmV0dXJuXCIwXCI8PWEmJlwiOVwiPj1hfSxpc1doaXRlc3BhY2U6ZnVuY3Rpb24oYSl7cmV0dXJuXCIgXCI9PT1hfHxcIlxcclwiPT09YXx8XCJcXHRcIj09PWF8fFwiXFxuXCI9PT1hfHxcIlxcdlwiPT09YXx8XCJcXHUwMGEwXCI9PT1cbmF9LGlzSWRlbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuXCJhXCI8PWEmJlwielwiPj1hfHxcIkFcIjw9YSYmXCJaXCI+PWF8fFwiX1wiPT09YXx8XCIkXCI9PT1hfSxpc0V4cE9wZXJhdG9yOmZ1bmN0aW9uKGEpe3JldHVyblwiLVwiPT09YXx8XCIrXCI9PT1hfHx0aGlzLmlzTnVtYmVyKGEpfSx0aHJvd0Vycm9yOmZ1bmN0aW9uKGEsYyxkKXtkPWR8fHRoaXMuaW5kZXg7Yz1CKGMpP1wicyBcIitjK1wiLVwiK3RoaXMuaW5kZXgrXCIgW1wiK3RoaXMudGV4dC5zdWJzdHJpbmcoYyxkKStcIl1cIjpcIiBcIitkO3Rocm93IEJhKFwibGV4ZXJyXCIsYSxjLHRoaXMudGV4dCk7fSxyZWFkTnVtYmVyOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPVwiXCIsYz10aGlzLmluZGV4O3RoaXMuaW5kZXg8dGhpcy50ZXh0Lmxlbmd0aDspe3ZhciBkPUsodGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4KSk7aWYoXCIuXCI9PWR8fHRoaXMuaXNOdW1iZXIoZCkpYSs9ZDtlbHNle3ZhciBlPXRoaXMucGVlaygpO2lmKFwiZVwiPT1kJiZ0aGlzLmlzRXhwT3BlcmF0b3IoZSkpYSs9XG5kO2Vsc2UgaWYodGhpcy5pc0V4cE9wZXJhdG9yKGQpJiZlJiZ0aGlzLmlzTnVtYmVyKGUpJiZcImVcIj09YS5jaGFyQXQoYS5sZW5ndGgtMSkpYSs9ZDtlbHNlIGlmKCF0aGlzLmlzRXhwT3BlcmF0b3IoZCl8fGUmJnRoaXMuaXNOdW1iZXIoZSl8fFwiZVwiIT1hLmNoYXJBdChhLmxlbmd0aC0xKSlicmVhaztlbHNlIHRoaXMudGhyb3dFcnJvcihcIkludmFsaWQgZXhwb25lbnRcIil9dGhpcy5pbmRleCsrfWEqPTE7dGhpcy50b2tlbnMucHVzaCh7aW5kZXg6Yyx0ZXh0OmEsanNvbjohMCxmbjpmdW5jdGlvbigpe3JldHVybiBhfX0pfSxyZWFkSWRlbnQ6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcyxjPVwiXCIsZD10aGlzLmluZGV4LGUsZyxmLGg7dGhpcy5pbmRleDx0aGlzLnRleHQubGVuZ3RoOyl7aD10aGlzLnRleHQuY2hhckF0KHRoaXMuaW5kZXgpO2lmKFwiLlwiPT09aHx8dGhpcy5pc0lkZW50KGgpfHx0aGlzLmlzTnVtYmVyKGgpKVwiLlwiPT09aCYmKGU9dGhpcy5pbmRleCksYys9aDtlbHNlIGJyZWFrO1xudGhpcy5pbmRleCsrfWlmKGUpZm9yKGc9dGhpcy5pbmRleDtnPHRoaXMudGV4dC5sZW5ndGg7KXtoPXRoaXMudGV4dC5jaGFyQXQoZyk7aWYoXCIoXCI9PT1oKXtmPWMuc3Vic3RyKGUtZCsxKTtjPWMuc3Vic3RyKDAsZS1kKTt0aGlzLmluZGV4PWc7YnJlYWt9aWYodGhpcy5pc1doaXRlc3BhY2UoaCkpZysrO2Vsc2UgYnJlYWt9ZD17aW5kZXg6ZCx0ZXh0OmN9O2lmKE1hLmhhc093blByb3BlcnR5KGMpKWQuZm49TWFbY10sZC5qc29uPU1hW2NdO2Vsc2V7dmFyIGw9RGMoYyx0aGlzLm9wdGlvbnMsdGhpcy50ZXh0KTtkLmZuPUQoZnVuY3Rpb24oYSxjKXtyZXR1cm4gbChhLGMpfSx7YXNzaWduOmZ1bmN0aW9uKGQsZSl7cmV0dXJuIG9iKGQsYyxlLGEudGV4dCxhLm9wdGlvbnMpfX0pfXRoaXMudG9rZW5zLnB1c2goZCk7ZiYmKHRoaXMudG9rZW5zLnB1c2goe2luZGV4OmUsdGV4dDpcIi5cIixqc29uOiExfSksdGhpcy50b2tlbnMucHVzaCh7aW5kZXg6ZSsxLHRleHQ6Zixqc29uOiExfSkpfSxcbnJlYWRTdHJpbmc6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcy5pbmRleDt0aGlzLmluZGV4Kys7Zm9yKHZhciBkPVwiXCIsZT1hLGc9ITE7dGhpcy5pbmRleDx0aGlzLnRleHQubGVuZ3RoOyl7dmFyIGY9dGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4KSxlPWUrZjtpZihnKVwidVwiPT09Zj8oZj10aGlzLnRleHQuc3Vic3RyaW5nKHRoaXMuaW5kZXgrMSx0aGlzLmluZGV4KzUpLGYubWF0Y2goL1tcXGRhLWZdezR9L2kpfHx0aGlzLnRocm93RXJyb3IoXCJJbnZhbGlkIHVuaWNvZGUgZXNjYXBlIFtcXFxcdVwiK2YrXCJdXCIpLHRoaXMuaW5kZXgrPTQsZCs9U3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChmLDE2KSkpOmQ9KGc9TmVbZl0pP2QrZzpkK2YsZz0hMTtlbHNlIGlmKFwiXFxcXFwiPT09ZilnPSEwO2Vsc2V7aWYoZj09PWEpe3RoaXMuaW5kZXgrKzt0aGlzLnRva2Vucy5wdXNoKHtpbmRleDpjLHRleHQ6ZSxzdHJpbmc6ZCxqc29uOiEwLGZuOmZ1bmN0aW9uKCl7cmV0dXJuIGR9fSk7cmV0dXJufWQrPVxuZn10aGlzLmluZGV4Kyt9dGhpcy50aHJvd0Vycm9yKFwiVW50ZXJtaW5hdGVkIHF1b3RlXCIsYyl9fTt2YXIgJGE9ZnVuY3Rpb24oYSxjLGQpe3RoaXMubGV4ZXI9YTt0aGlzLiRmaWx0ZXI9Yzt0aGlzLm9wdGlvbnM9ZH07JGEuWkVSTz1EKGZ1bmN0aW9uKCl7cmV0dXJuIDB9LHtjb25zdGFudDohMH0pOyRhLnByb3RvdHlwZT17Y29uc3RydWN0b3I6JGEscGFyc2U6ZnVuY3Rpb24oYSxjKXt0aGlzLnRleHQ9YTt0aGlzLmpzb249Yzt0aGlzLnRva2Vucz10aGlzLmxleGVyLmxleChhKTtjJiYodGhpcy5hc3NpZ25tZW50PXRoaXMubG9naWNhbE9SLHRoaXMuZnVuY3Rpb25DYWxsPXRoaXMuZmllbGRBY2Nlc3M9dGhpcy5vYmplY3RJbmRleD10aGlzLmZpbHRlckNoYWluPWZ1bmN0aW9uKCl7dGhpcy50aHJvd0Vycm9yKFwiaXMgbm90IHZhbGlkIGpzb25cIix7dGV4dDphLGluZGV4OjB9KX0pO3ZhciBkPWM/dGhpcy5wcmltYXJ5KCk6dGhpcy5zdGF0ZW1lbnRzKCk7MCE9PXRoaXMudG9rZW5zLmxlbmd0aCYmXG50aGlzLnRocm93RXJyb3IoXCJpcyBhbiB1bmV4cGVjdGVkIHRva2VuXCIsdGhpcy50b2tlbnNbMF0pO2QubGl0ZXJhbD0hIWQubGl0ZXJhbDtkLmNvbnN0YW50PSEhZC5jb25zdGFudDtyZXR1cm4gZH0scHJpbWFyeTpmdW5jdGlvbigpe3ZhciBhO2lmKHRoaXMuZXhwZWN0KFwiKFwiKSlhPXRoaXMuZmlsdGVyQ2hhaW4oKSx0aGlzLmNvbnN1bWUoXCIpXCIpO2Vsc2UgaWYodGhpcy5leHBlY3QoXCJbXCIpKWE9dGhpcy5hcnJheURlY2xhcmF0aW9uKCk7ZWxzZSBpZih0aGlzLmV4cGVjdChcIntcIikpYT10aGlzLm9iamVjdCgpO2Vsc2V7dmFyIGM9dGhpcy5leHBlY3QoKTsoYT1jLmZuKXx8dGhpcy50aHJvd0Vycm9yKFwibm90IGEgcHJpbWFyeSBleHByZXNzaW9uXCIsYyk7Yy5qc29uJiYoYS5jb25zdGFudD0hMCxhLmxpdGVyYWw9ITApfWZvcih2YXIgZDtjPXRoaXMuZXhwZWN0KFwiKFwiLFwiW1wiLFwiLlwiKTspXCIoXCI9PT1jLnRleHQ/KGE9dGhpcy5mdW5jdGlvbkNhbGwoYSxkKSxkPW51bGwpOlwiW1wiPT09Yy50ZXh0P1xuKGQ9YSxhPXRoaXMub2JqZWN0SW5kZXgoYSkpOlwiLlwiPT09Yy50ZXh0PyhkPWEsYT10aGlzLmZpZWxkQWNjZXNzKGEpKTp0aGlzLnRocm93RXJyb3IoXCJJTVBPU1NJQkxFXCIpO3JldHVybiBhfSx0aHJvd0Vycm9yOmZ1bmN0aW9uKGEsYyl7dGhyb3cgQmEoXCJzeW50YXhcIixjLnRleHQsYSxjLmluZGV4KzEsdGhpcy50ZXh0LHRoaXMudGV4dC5zdWJzdHJpbmcoYy5pbmRleCkpO30scGVla1Rva2VuOmZ1bmN0aW9uKCl7aWYoMD09PXRoaXMudG9rZW5zLmxlbmd0aCl0aHJvdyBCYShcInVlb2VcIix0aGlzLnRleHQpO3JldHVybiB0aGlzLnRva2Vuc1swXX0scGVlazpmdW5jdGlvbihhLGMsZCxlKXtpZigwPHRoaXMudG9rZW5zLmxlbmd0aCl7dmFyIGc9dGhpcy50b2tlbnNbMF0sZj1nLnRleHQ7aWYoZj09PWF8fGY9PT1jfHxmPT09ZHx8Zj09PWV8fCEoYXx8Y3x8ZHx8ZSkpcmV0dXJuIGd9cmV0dXJuITF9LGV4cGVjdDpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4oYT10aGlzLnBlZWsoYSxjLGQsXG5lKSk/KHRoaXMuanNvbiYmIWEuanNvbiYmdGhpcy50aHJvd0Vycm9yKFwiaXMgbm90IHZhbGlkIGpzb25cIixhKSx0aGlzLnRva2Vucy5zaGlmdCgpLGEpOiExfSxjb25zdW1lOmZ1bmN0aW9uKGEpe3RoaXMuZXhwZWN0KGEpfHx0aGlzLnRocm93RXJyb3IoXCJpcyB1bmV4cGVjdGVkLCBleHBlY3RpbmcgW1wiK2ErXCJdXCIsdGhpcy5wZWVrKCkpfSx1bmFyeUZuOmZ1bmN0aW9uKGEsYyl7cmV0dXJuIEQoZnVuY3Rpb24oZCxlKXtyZXR1cm4gYShkLGUsYyl9LHtjb25zdGFudDpjLmNvbnN0YW50fSl9LHRlcm5hcnlGbjpmdW5jdGlvbihhLGMsZCl7cmV0dXJuIEQoZnVuY3Rpb24oZSxnKXtyZXR1cm4gYShlLGcpP2MoZSxnKTpkKGUsZyl9LHtjb25zdGFudDphLmNvbnN0YW50JiZjLmNvbnN0YW50JiZkLmNvbnN0YW50fSl9LGJpbmFyeUZuOmZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4gRChmdW5jdGlvbihlLGcpe3JldHVybiBjKGUsZyxhLGQpfSx7Y29uc3RhbnQ6YS5jb25zdGFudCYmZC5jb25zdGFudH0pfSxcbnN0YXRlbWVudHM6ZnVuY3Rpb24oKXtmb3IodmFyIGE9W107OylpZigwPHRoaXMudG9rZW5zLmxlbmd0aCYmIXRoaXMucGVlayhcIn1cIixcIilcIixcIjtcIixcIl1cIikmJmEucHVzaCh0aGlzLmZpbHRlckNoYWluKCkpLCF0aGlzLmV4cGVjdChcIjtcIikpcmV0dXJuIDE9PT1hLmxlbmd0aD9hWzBdOmZ1bmN0aW9uKGMsZCl7Zm9yKHZhciBlLGc9MDtnPGEubGVuZ3RoO2crKyl7dmFyIGY9YVtnXTtmJiYoZT1mKGMsZCkpfXJldHVybiBlfX0sZmlsdGVyQ2hhaW46ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5leHByZXNzaW9uKCksYzs7KWlmKGM9dGhpcy5leHBlY3QoXCJ8XCIpKWE9dGhpcy5iaW5hcnlGbihhLGMuZm4sdGhpcy5maWx0ZXIoKSk7ZWxzZSByZXR1cm4gYX0sZmlsdGVyOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMuZXhwZWN0KCksYz10aGlzLiRmaWx0ZXIoYS50ZXh0KSxkPVtdOzspaWYoYT10aGlzLmV4cGVjdChcIjpcIikpZC5wdXNoKHRoaXMuZXhwcmVzc2lvbigpKTtlbHNle3ZhciBlPVxuZnVuY3Rpb24oYSxlLGgpe2g9W2hdO2Zvcih2YXIgbD0wO2w8ZC5sZW5ndGg7bCsrKWgucHVzaChkW2xdKGEsZSkpO3JldHVybiBjLmFwcGx5KGEsaCl9O3JldHVybiBmdW5jdGlvbigpe3JldHVybiBlfX19LGV4cHJlc3Npb246ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hc3NpZ25tZW50KCl9LGFzc2lnbm1lbnQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnRlcm5hcnkoKSxjLGQ7cmV0dXJuKGQ9dGhpcy5leHBlY3QoXCI9XCIpKT8oYS5hc3NpZ258fHRoaXMudGhyb3dFcnJvcihcImltcGxpZXMgYXNzaWdubWVudCBidXQgW1wiK3RoaXMudGV4dC5zdWJzdHJpbmcoMCxkLmluZGV4KStcIl0gY2FuIG5vdCBiZSBhc3NpZ25lZCB0b1wiLGQpLGM9dGhpcy50ZXJuYXJ5KCksZnVuY3Rpb24oZCxnKXtyZXR1cm4gYS5hc3NpZ24oZCxjKGQsZyksZyl9KTphfSx0ZXJuYXJ5OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5sb2dpY2FsT1IoKSxjLGQ7aWYodGhpcy5leHBlY3QoXCI/XCIpKXtjPXRoaXMudGVybmFyeSgpO1xuaWYoZD10aGlzLmV4cGVjdChcIjpcIikpcmV0dXJuIHRoaXMudGVybmFyeUZuKGEsYyx0aGlzLnRlcm5hcnkoKSk7dGhpcy50aHJvd0Vycm9yKFwiZXhwZWN0ZWQgOlwiLGQpfWVsc2UgcmV0dXJuIGF9LGxvZ2ljYWxPUjpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmxvZ2ljYWxBTkQoKSxjOzspaWYoYz10aGlzLmV4cGVjdChcInx8XCIpKWE9dGhpcy5iaW5hcnlGbihhLGMuZm4sdGhpcy5sb2dpY2FsQU5EKCkpO2Vsc2UgcmV0dXJuIGF9LGxvZ2ljYWxBTkQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmVxdWFsaXR5KCksYztpZihjPXRoaXMuZXhwZWN0KFwiJiZcIikpYT10aGlzLmJpbmFyeUZuKGEsYy5mbix0aGlzLmxvZ2ljYWxBTkQoKSk7cmV0dXJuIGF9LGVxdWFsaXR5OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5yZWxhdGlvbmFsKCksYztpZihjPXRoaXMuZXhwZWN0KFwiPT1cIixcIiE9XCIsXCI9PT1cIixcIiE9PVwiKSlhPXRoaXMuYmluYXJ5Rm4oYSxjLmZuLHRoaXMuZXF1YWxpdHkoKSk7cmV0dXJuIGF9LFxucmVsYXRpb25hbDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuYWRkaXRpdmUoKSxjO2lmKGM9dGhpcy5leHBlY3QoXCI8XCIsXCI+XCIsXCI8PVwiLFwiPj1cIikpYT10aGlzLmJpbmFyeUZuKGEsYy5mbix0aGlzLnJlbGF0aW9uYWwoKSk7cmV0dXJuIGF9LGFkZGl0aXZlOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMubXVsdGlwbGljYXRpdmUoKSxjO2M9dGhpcy5leHBlY3QoXCIrXCIsXCItXCIpOylhPXRoaXMuYmluYXJ5Rm4oYSxjLmZuLHRoaXMubXVsdGlwbGljYXRpdmUoKSk7cmV0dXJuIGF9LG11bHRpcGxpY2F0aXZlOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMudW5hcnkoKSxjO2M9dGhpcy5leHBlY3QoXCIqXCIsXCIvXCIsXCIlXCIpOylhPXRoaXMuYmluYXJ5Rm4oYSxjLmZuLHRoaXMudW5hcnkoKSk7cmV0dXJuIGF9LHVuYXJ5OmZ1bmN0aW9uKCl7dmFyIGE7cmV0dXJuIHRoaXMuZXhwZWN0KFwiK1wiKT90aGlzLnByaW1hcnkoKTooYT10aGlzLmV4cGVjdChcIi1cIikpP3RoaXMuYmluYXJ5Rm4oJGEuWkVSTyxhLmZuLFxudGhpcy51bmFyeSgpKTooYT10aGlzLmV4cGVjdChcIiFcIikpP3RoaXMudW5hcnlGbihhLmZuLHRoaXMudW5hcnkoKSk6dGhpcy5wcmltYXJ5KCl9LGZpZWxkQWNjZXNzOmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMsZD10aGlzLmV4cGVjdCgpLnRleHQsZT1EYyhkLHRoaXMub3B0aW9ucyx0aGlzLnRleHQpO3JldHVybiBEKGZ1bmN0aW9uKGMsZCxoKXtyZXR1cm4gZShofHxhKGMsZCkpfSx7YXNzaWduOmZ1bmN0aW9uKGUsZixoKXtyZXR1cm4gb2IoYShlLGgpLGQsZixjLnRleHQsYy5vcHRpb25zKX19KX0sb2JqZWN0SW5kZXg6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcyxkPXRoaXMuZXhwcmVzc2lvbigpO3RoaXMuY29uc3VtZShcIl1cIik7cmV0dXJuIEQoZnVuY3Rpb24oZSxnKXt2YXIgZj1hKGUsZyksaD1kKGUsZyksbDtpZighZilyZXR1cm4gczsoZj1aYShmW2hdLGMudGV4dCkpJiYoZi50aGVuJiZjLm9wdGlvbnMudW53cmFwUHJvbWlzZXMpJiYobD1mLFwiJCR2XCJpbiBmfHwobC4kJHY9cyxsLnRoZW4oZnVuY3Rpb24oYSl7bC4kJHY9XG5hfSkpLGY9Zi4kJHYpO3JldHVybiBmfSx7YXNzaWduOmZ1bmN0aW9uKGUsZyxmKXt2YXIgaD1kKGUsZik7cmV0dXJuIFphKGEoZSxmKSxjLnRleHQpW2hdPWd9fSl9LGZ1bmN0aW9uQ2FsbDpmdW5jdGlvbihhLGMpe3ZhciBkPVtdO2lmKFwiKVwiIT09dGhpcy5wZWVrVG9rZW4oKS50ZXh0KXtkbyBkLnB1c2godGhpcy5leHByZXNzaW9uKCkpO3doaWxlKHRoaXMuZXhwZWN0KFwiLFwiKSl9dGhpcy5jb25zdW1lKFwiKVwiKTt2YXIgZT10aGlzO3JldHVybiBmdW5jdGlvbihnLGYpe2Zvcih2YXIgaD1bXSxsPWM/YyhnLGYpOmcsaz0wO2s8ZC5sZW5ndGg7aysrKWgucHVzaChkW2tdKGcsZikpO2s9YShnLGYsbCl8fEM7WmEobCxlLnRleHQpO1phKGssZS50ZXh0KTtoPWsuYXBwbHk/ay5hcHBseShsLGgpOmsoaFswXSxoWzFdLGhbMl0saFszXSxoWzRdKTtyZXR1cm4gWmEoaCxlLnRleHQpfX0sYXJyYXlEZWNsYXJhdGlvbjpmdW5jdGlvbigpe3ZhciBhPVtdLGM9ITA7aWYoXCJdXCIhPT10aGlzLnBlZWtUb2tlbigpLnRleHQpe2Rve2lmKHRoaXMucGVlayhcIl1cIikpYnJlYWs7XG52YXIgZD10aGlzLmV4cHJlc3Npb24oKTthLnB1c2goZCk7ZC5jb25zdGFudHx8KGM9ITEpfXdoaWxlKHRoaXMuZXhwZWN0KFwiLFwiKSl9dGhpcy5jb25zdW1lKFwiXVwiKTtyZXR1cm4gRChmdW5jdGlvbihjLGQpe2Zvcih2YXIgZj1bXSxoPTA7aDxhLmxlbmd0aDtoKyspZi5wdXNoKGFbaF0oYyxkKSk7cmV0dXJuIGZ9LHtsaXRlcmFsOiEwLGNvbnN0YW50OmN9KX0sb2JqZWN0OmZ1bmN0aW9uKCl7dmFyIGE9W10sYz0hMDtpZihcIn1cIiE9PXRoaXMucGVla1Rva2VuKCkudGV4dCl7ZG97aWYodGhpcy5wZWVrKFwifVwiKSlicmVhazt2YXIgZD10aGlzLmV4cGVjdCgpLGQ9ZC5zdHJpbmd8fGQudGV4dDt0aGlzLmNvbnN1bWUoXCI6XCIpO3ZhciBlPXRoaXMuZXhwcmVzc2lvbigpO2EucHVzaCh7a2V5OmQsdmFsdWU6ZX0pO2UuY29uc3RhbnR8fChjPSExKX13aGlsZSh0aGlzLmV4cGVjdChcIixcIikpfXRoaXMuY29uc3VtZShcIn1cIik7cmV0dXJuIEQoZnVuY3Rpb24oYyxkKXtmb3IodmFyIGU9e30sbD0wO2w8XG5hLmxlbmd0aDtsKyspe3ZhciBrPWFbbF07ZVtrLmtleV09ay52YWx1ZShjLGQpfXJldHVybiBlfSx7bGl0ZXJhbDohMCxjb25zdGFudDpjfSl9fTt2YXIgTWI9e30sdWE9dChcIiRzY2VcIiksZ2E9e0hUTUw6XCJodG1sXCIsQ1NTOlwiY3NzXCIsVVJMOlwidXJsXCIsUkVTT1VSQ0VfVVJMOlwicmVzb3VyY2VVcmxcIixKUzpcImpzXCJ9LFc9VS5jcmVhdGVFbGVtZW50KFwiYVwiKSxIYz1zYShPLmxvY2F0aW9uLmhyZWYsITApO2djLiRpbmplY3Q9W1wiJHByb3ZpZGVcIl07SWMuJGluamVjdD1bXCIkbG9jYWxlXCJdO0tjLiRpbmplY3Q9W1wiJGxvY2FsZVwiXTt2YXIgTmM9XCIuXCIsSWU9e3l5eXk6JChcIkZ1bGxZZWFyXCIsNCkseXk6JChcIkZ1bGxZZWFyXCIsMiwwLCEwKSx5OiQoXCJGdWxsWWVhclwiLDEpLE1NTU06cGIoXCJNb250aFwiKSxNTU06cGIoXCJNb250aFwiLCEwKSxNTTokKFwiTW9udGhcIiwyLDEpLE06JChcIk1vbnRoXCIsMSwxKSxkZDokKFwiRGF0ZVwiLDIpLGQ6JChcIkRhdGVcIiwxKSxISDokKFwiSG91cnNcIiwyKSxIOiQoXCJIb3Vyc1wiLFxuMSksaGg6JChcIkhvdXJzXCIsMiwtMTIpLGg6JChcIkhvdXJzXCIsMSwtMTIpLG1tOiQoXCJNaW51dGVzXCIsMiksbTokKFwiTWludXRlc1wiLDEpLHNzOiQoXCJTZWNvbmRzXCIsMiksczokKFwiU2Vjb25kc1wiLDEpLHNzczokKFwiTWlsbGlzZWNvbmRzXCIsMyksRUVFRTpwYihcIkRheVwiKSxFRUU6cGIoXCJEYXlcIiwhMCksYTpmdW5jdGlvbihhLGMpe3JldHVybiAxMj5hLmdldEhvdXJzKCk/Yy5BTVBNU1swXTpjLkFNUE1TWzFdfSxaOmZ1bmN0aW9uKGEpe2E9LTEqYS5nZXRUaW1lem9uZU9mZnNldCgpO3JldHVybiBhPSgwPD1hP1wiK1wiOlwiXCIpKyhPYihNYXRoWzA8YT9cImZsb29yXCI6XCJjZWlsXCJdKGEvNjApLDIpK09iKE1hdGguYWJzKGElNjApLDIpKX19LEhlPS8oKD86W155TWRIaG1zYVpFJ10rKXwoPzonKD86W14nXXwnJykqJyl8KD86RSt8eSt8TSt8ZCt8SCt8aCt8bSt8cyt8YXxaKSkoLiopLyxHZT0vXlxcLT9cXGQrJC87SmMuJGluamVjdD1bXCIkbG9jYWxlXCJdO3ZhciBFZT1hYShLKSxGZT1hYShGYSk7TGMuJGluamVjdD1cbltcIiRwYXJzZVwiXTt2YXIgY2Q9YWEoe3Jlc3RyaWN0OlwiRVwiLGNvbXBpbGU6ZnVuY3Rpb24oYSxjKXs4Pj1TJiYoYy5ocmVmfHxjLm5hbWV8fGMuJHNldChcImhyZWZcIixcIlwiKSxhLmFwcGVuZChVLmNyZWF0ZUNvbW1lbnQoXCJJRSBmaXhcIikpKTtpZighYy5ocmVmJiYhYy54bGlua0hyZWYmJiFjLm5hbWUpcmV0dXJuIGZ1bmN0aW9uKGEsYyl7dmFyIGc9XCJbb2JqZWN0IFNWR0FuaW1hdGVkU3RyaW5nXVwiPT09d2EuY2FsbChjLnByb3AoXCJocmVmXCIpKT9cInhsaW5rOmhyZWZcIjpcImhyZWZcIjtjLm9uKFwiY2xpY2tcIixmdW5jdGlvbihhKXtjLmF0dHIoZyl8fGEucHJldmVudERlZmF1bHQoKX0pfX19KSx6Yj17fTtxKGtiLGZ1bmN0aW9uKGEsYyl7aWYoXCJtdWx0aXBsZVwiIT1hKXt2YXIgZD1uYShcIm5nLVwiK2MpO3piW2RdPWZ1bmN0aW9uKCl7cmV0dXJue3ByaW9yaXR5OjEwMCxsaW5rOmZ1bmN0aW9uKGEsZyxmKXthLiR3YXRjaChmW2RdLGZ1bmN0aW9uKGEpe2YuJHNldChjLCEhYSl9KX19fX19KTtxKFtcInNyY1wiLFxuXCJzcmNzZXRcIixcImhyZWZcIl0sZnVuY3Rpb24oYSl7dmFyIGM9bmEoXCJuZy1cIithKTt6YltjXT1mdW5jdGlvbigpe3JldHVybntwcmlvcml0eTo5OSxsaW5rOmZ1bmN0aW9uKGQsZSxnKXt2YXIgZj1hLGg9YTtcImhyZWZcIj09PWEmJlwiW29iamVjdCBTVkdBbmltYXRlZFN0cmluZ11cIj09PXdhLmNhbGwoZS5wcm9wKFwiaHJlZlwiKSkmJihoPVwieGxpbmtIcmVmXCIsZy4kYXR0cltoXT1cInhsaW5rOmhyZWZcIixmPW51bGwpO2cuJG9ic2VydmUoYyxmdW5jdGlvbihhKXthJiYoZy4kc2V0KGgsYSksUyYmZiYmZS5wcm9wKGYsZ1toXSkpfSl9fX19KTt2YXIgc2I9eyRhZGRDb250cm9sOkMsJHJlbW92ZUNvbnRyb2w6Qywkc2V0VmFsaWRpdHk6Qywkc2V0RGlydHk6Qywkc2V0UHJpc3RpbmU6Q307T2MuJGluamVjdD1bXCIkZWxlbWVudFwiLFwiJGF0dHJzXCIsXCIkc2NvcGVcIixcIiRhbmltYXRlXCJdO3ZhciBRYz1mdW5jdGlvbihhKXtyZXR1cm5bXCIkdGltZW91dFwiLGZ1bmN0aW9uKGMpe3JldHVybntuYW1lOlwiZm9ybVwiLFxucmVzdHJpY3Q6YT9cIkVBQ1wiOlwiRVwiLGNvbnRyb2xsZXI6T2MsY29tcGlsZTpmdW5jdGlvbigpe3JldHVybntwcmU6ZnVuY3Rpb24oYSxlLGcsZil7aWYoIWcuYWN0aW9uKXt2YXIgaD1mdW5jdGlvbihhKXthLnByZXZlbnREZWZhdWx0P2EucHJldmVudERlZmF1bHQoKTphLnJldHVyblZhbHVlPSExfTtQYyhlWzBdLFwic3VibWl0XCIsaCk7ZS5vbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtjKGZ1bmN0aW9uKCl7RmIoZVswXSxcInN1Ym1pdFwiLGgpfSwwLCExKX0pfXZhciBsPWUucGFyZW50KCkuY29udHJvbGxlcihcImZvcm1cIiksaz1nLm5hbWV8fGcubmdGb3JtO2smJm9iKGEsayxmLGspO2lmKGwpZS5vbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtsLiRyZW1vdmVDb250cm9sKGYpO2smJm9iKGEsayxzLGspO0QoZixzYil9KX19fX19XX0sZGQ9UWMoKSxxZD1RYyghMCksT2U9L14oZnRwfGh0dHB8aHR0cHMpOlxcL1xcLyhcXHcrOnswLDF9XFx3KkApPyhcXFMrKSg6WzAtOV0rKT8oXFwvfFxcLyhbXFx3IyE6Lj8rPSYlQCFcXC1cXC9dKSk/JC8sXG5QZT0vXlthLXowLTkhIyQlJicqKy89P15fYHt8fX4uLV0rQFthLXowLTktXSsoXFwuW2EtejAtOS1dKykqJC9pLFFlPS9eXFxzKihcXC18XFwrKT8oXFxkK3woXFxkKihcXC5cXGQqKSkpXFxzKiQvLFJjPXt0ZXh0OnViLG51bWJlcjpmdW5jdGlvbihhLGMsZCxlLGcsZil7dWIoYSxjLGQsZSxnLGYpO2UuJHBhcnNlcnMucHVzaChmdW5jdGlvbihhKXt2YXIgYz1lLiRpc0VtcHR5KGEpO2lmKGN8fFFlLnRlc3QoYSkpcmV0dXJuIGUuJHNldFZhbGlkaXR5KFwibnVtYmVyXCIsITApLFwiXCI9PT1hP251bGw6Yz9hOnBhcnNlRmxvYXQoYSk7ZS4kc2V0VmFsaWRpdHkoXCJudW1iZXJcIiwhMSk7cmV0dXJuIHN9KTtKZShlLFwibnVtYmVyXCIsYyk7ZS4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKGEpe3JldHVybiBlLiRpc0VtcHR5KGEpP1wiXCI6XCJcIithfSk7ZC5taW4mJihhPWZ1bmN0aW9uKGEpe3ZhciBjPXBhcnNlRmxvYXQoZC5taW4pO3JldHVybiBwYShlLFwibWluXCIsZS4kaXNFbXB0eShhKXx8YT49YyxhKX0sZS4kcGFyc2Vycy5wdXNoKGEpLFxuZS4kZm9ybWF0dGVycy5wdXNoKGEpKTtkLm1heCYmKGE9ZnVuY3Rpb24oYSl7dmFyIGM9cGFyc2VGbG9hdChkLm1heCk7cmV0dXJuIHBhKGUsXCJtYXhcIixlLiRpc0VtcHR5KGEpfHxhPD1jLGEpfSxlLiRwYXJzZXJzLnB1c2goYSksZS4kZm9ybWF0dGVycy5wdXNoKGEpKTtlLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24oYSl7cmV0dXJuIHBhKGUsXCJudW1iZXJcIixlLiRpc0VtcHR5KGEpfHx2YihhKSxhKX0pfSx1cmw6ZnVuY3Rpb24oYSxjLGQsZSxnLGYpe3ViKGEsYyxkLGUsZyxmKTthPWZ1bmN0aW9uKGEpe3JldHVybiBwYShlLFwidXJsXCIsZS4kaXNFbXB0eShhKXx8T2UudGVzdChhKSxhKX07ZS4kZm9ybWF0dGVycy5wdXNoKGEpO2UuJHBhcnNlcnMucHVzaChhKX0sZW1haWw6ZnVuY3Rpb24oYSxjLGQsZSxnLGYpe3ViKGEsYyxkLGUsZyxmKTthPWZ1bmN0aW9uKGEpe3JldHVybiBwYShlLFwiZW1haWxcIixlLiRpc0VtcHR5KGEpfHxQZS50ZXN0KGEpLGEpfTtlLiRmb3JtYXR0ZXJzLnB1c2goYSk7XG5lLiRwYXJzZXJzLnB1c2goYSl9LHJhZGlvOmZ1bmN0aW9uKGEsYyxkLGUpe0UoZC5uYW1lKSYmYy5hdHRyKFwibmFtZVwiLGJiKCkpO2Mub24oXCJjbGlja1wiLGZ1bmN0aW9uKCl7Y1swXS5jaGVja2VkJiZhLiRhcHBseShmdW5jdGlvbigpe2UuJHNldFZpZXdWYWx1ZShkLnZhbHVlKX0pfSk7ZS4kcmVuZGVyPWZ1bmN0aW9uKCl7Y1swXS5jaGVja2VkPWQudmFsdWU9PWUuJHZpZXdWYWx1ZX07ZC4kb2JzZXJ2ZShcInZhbHVlXCIsZS4kcmVuZGVyKX0sY2hlY2tib3g6ZnVuY3Rpb24oYSxjLGQsZSl7dmFyIGc9ZC5uZ1RydWVWYWx1ZSxmPWQubmdGYWxzZVZhbHVlO3coZyl8fChnPSEwKTt3KGYpfHwoZj0hMSk7Yy5vbihcImNsaWNrXCIsZnVuY3Rpb24oKXthLiRhcHBseShmdW5jdGlvbigpe2UuJHNldFZpZXdWYWx1ZShjWzBdLmNoZWNrZWQpfSl9KTtlLiRyZW5kZXI9ZnVuY3Rpb24oKXtjWzBdLmNoZWNrZWQ9ZS4kdmlld1ZhbHVlfTtlLiRpc0VtcHR5PWZ1bmN0aW9uKGEpe3JldHVybiBhIT09Z307XG5lLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24oYSl7cmV0dXJuIGE9PT1nfSk7ZS4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKGEpe3JldHVybiBhP2c6Zn0pfSxoaWRkZW46QyxidXR0b246QyxzdWJtaXQ6QyxyZXNldDpDLGZpbGU6Q30sZGM9W1wiJGJyb3dzZXJcIixcIiRzbmlmZmVyXCIsZnVuY3Rpb24oYSxjKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIscmVxdWlyZTpcIj9uZ01vZGVsXCIsbGluazpmdW5jdGlvbihkLGUsZyxmKXtmJiYoUmNbSyhnLnR5cGUpXXx8UmMudGV4dCkoZCxlLGcsZixjLGEpfX19XSxyYj1cIm5nLXZhbGlkXCIscWI9XCJuZy1pbnZhbGlkXCIsTGE9XCJuZy1wcmlzdGluZVwiLHRiPVwibmctZGlydHlcIixSZT1bXCIkc2NvcGVcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsXCIkYXR0cnNcIixcIiRlbGVtZW50XCIsXCIkcGFyc2VcIixcIiRhbmltYXRlXCIsZnVuY3Rpb24oYSxjLGQsZSxnLGYpe2Z1bmN0aW9uIGgoYSxjKXtjPWM/XCItXCIrZmIoYyxcIi1cIik6XCJcIjtmLnJlbW92ZUNsYXNzKGUsKGE/cWI6cmIpK2MpO1xuZi5hZGRDbGFzcyhlLChhP3JiOnFiKStjKX10aGlzLiRtb2RlbFZhbHVlPXRoaXMuJHZpZXdWYWx1ZT1OdW1iZXIuTmFOO3RoaXMuJHBhcnNlcnM9W107dGhpcy4kZm9ybWF0dGVycz1bXTt0aGlzLiR2aWV3Q2hhbmdlTGlzdGVuZXJzPVtdO3RoaXMuJHByaXN0aW5lPSEwO3RoaXMuJGRpcnR5PSExO3RoaXMuJHZhbGlkPSEwO3RoaXMuJGludmFsaWQ9ITE7dGhpcy4kbmFtZT1kLm5hbWU7dmFyIGw9ZyhkLm5nTW9kZWwpLGs9bC5hc3NpZ247aWYoIWspdGhyb3cgdChcIm5nTW9kZWxcIikoXCJub25hc3NpZ25cIixkLm5nTW9kZWwsaGEoZSkpO3RoaXMuJHJlbmRlcj1DO3RoaXMuJGlzRW1wdHk9ZnVuY3Rpb24oYSl7cmV0dXJuIEUoYSl8fFwiXCI9PT1hfHxudWxsPT09YXx8YSE9PWF9O3ZhciBtPWUuaW5oZXJpdGVkRGF0YShcIiRmb3JtQ29udHJvbGxlclwiKXx8c2Isbj0wLHA9dGhpcy4kZXJyb3I9e307ZS5hZGRDbGFzcyhMYSk7aCghMCk7dGhpcy4kc2V0VmFsaWRpdHk9ZnVuY3Rpb24oYSxjKXtwW2FdIT09XG4hYyYmKGM/KHBbYV0mJm4tLSxufHwoaCghMCksdGhpcy4kdmFsaWQ9ITAsdGhpcy4kaW52YWxpZD0hMSkpOihoKCExKSx0aGlzLiRpbnZhbGlkPSEwLHRoaXMuJHZhbGlkPSExLG4rKykscFthXT0hYyxoKGMsYSksbS4kc2V0VmFsaWRpdHkoYSxjLHRoaXMpKX07dGhpcy4kc2V0UHJpc3RpbmU9ZnVuY3Rpb24oKXt0aGlzLiRkaXJ0eT0hMTt0aGlzLiRwcmlzdGluZT0hMDtmLnJlbW92ZUNsYXNzKGUsdGIpO2YuYWRkQ2xhc3MoZSxMYSl9O3RoaXMuJHNldFZpZXdWYWx1ZT1mdW5jdGlvbihkKXt0aGlzLiR2aWV3VmFsdWU9ZDt0aGlzLiRwcmlzdGluZSYmKHRoaXMuJGRpcnR5PSEwLHRoaXMuJHByaXN0aW5lPSExLGYucmVtb3ZlQ2xhc3MoZSxMYSksZi5hZGRDbGFzcyhlLHRiKSxtLiRzZXREaXJ0eSgpKTtxKHRoaXMuJHBhcnNlcnMsZnVuY3Rpb24oYSl7ZD1hKGQpfSk7dGhpcy4kbW9kZWxWYWx1ZSE9PWQmJih0aGlzLiRtb2RlbFZhbHVlPWQsayhhLGQpLHEodGhpcy4kdmlld0NoYW5nZUxpc3RlbmVycyxcbmZ1bmN0aW9uKGEpe3RyeXthKCl9Y2F0Y2goZCl7YyhkKX19KSl9O3ZhciByPXRoaXM7YS4kd2F0Y2goZnVuY3Rpb24oKXt2YXIgYz1sKGEpO2lmKHIuJG1vZGVsVmFsdWUhPT1jKXt2YXIgZD1yLiRmb3JtYXR0ZXJzLGU9ZC5sZW5ndGg7Zm9yKHIuJG1vZGVsVmFsdWU9YztlLS07KWM9ZFtlXShjKTtyLiR2aWV3VmFsdWUhPT1jJiYoci4kdmlld1ZhbHVlPWMsci4kcmVuZGVyKCkpfXJldHVybiBjfSl9XSxGZD1mdW5jdGlvbigpe3JldHVybntyZXF1aXJlOltcIm5nTW9kZWxcIixcIl4/Zm9ybVwiXSxjb250cm9sbGVyOlJlLGxpbms6ZnVuY3Rpb24oYSxjLGQsZSl7dmFyIGc9ZVswXSxmPWVbMV18fHNiO2YuJGFkZENvbnRyb2woZyk7YS4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7Zi4kcmVtb3ZlQ29udHJvbChnKX0pfX19LEhkPWFhKHtyZXF1aXJlOlwibmdNb2RlbFwiLGxpbms6ZnVuY3Rpb24oYSxjLGQsZSl7ZS4kdmlld0NoYW5nZUxpc3RlbmVycy5wdXNoKGZ1bmN0aW9uKCl7YS4kZXZhbChkLm5nQ2hhbmdlKX0pfX0pLFxuZWM9ZnVuY3Rpb24oKXtyZXR1cm57cmVxdWlyZTpcIj9uZ01vZGVsXCIsbGluazpmdW5jdGlvbihhLGMsZCxlKXtpZihlKXtkLnJlcXVpcmVkPSEwO3ZhciBnPWZ1bmN0aW9uKGEpe2lmKGQucmVxdWlyZWQmJmUuJGlzRW1wdHkoYSkpZS4kc2V0VmFsaWRpdHkoXCJyZXF1aXJlZFwiLCExKTtlbHNlIHJldHVybiBlLiRzZXRWYWxpZGl0eShcInJlcXVpcmVkXCIsITApLGF9O2UuJGZvcm1hdHRlcnMucHVzaChnKTtlLiRwYXJzZXJzLnVuc2hpZnQoZyk7ZC4kb2JzZXJ2ZShcInJlcXVpcmVkXCIsZnVuY3Rpb24oKXtnKGUuJHZpZXdWYWx1ZSl9KX19fX0sR2Q9ZnVuY3Rpb24oKXtyZXR1cm57cmVxdWlyZTpcIm5nTW9kZWxcIixsaW5rOmZ1bmN0aW9uKGEsYyxkLGUpe3ZhciBnPShhPS9cXC8oLiopXFwvLy5leGVjKGQubmdMaXN0KSkmJlJlZ0V4cChhWzFdKXx8ZC5uZ0xpc3R8fFwiLFwiO2UuJHBhcnNlcnMucHVzaChmdW5jdGlvbihhKXtpZighRShhKSl7dmFyIGM9W107YSYmcShhLnNwbGl0KGcpLGZ1bmN0aW9uKGEpe2EmJlxuYy5wdXNoKGNhKGEpKX0pO3JldHVybiBjfX0pO2UuJGZvcm1hdHRlcnMucHVzaChmdW5jdGlvbihhKXtyZXR1cm4gTShhKT9hLmpvaW4oXCIsIFwiKTpzfSk7ZS4kaXNFbXB0eT1mdW5jdGlvbihhKXtyZXR1cm4hYXx8IWEubGVuZ3RofX19fSxTZT0vXih0cnVlfGZhbHNlfFxcZCspJC8sSWQ9ZnVuY3Rpb24oKXtyZXR1cm57cHJpb3JpdHk6MTAwLGNvbXBpbGU6ZnVuY3Rpb24oYSxjKXtyZXR1cm4gU2UudGVzdChjLm5nVmFsdWUpP2Z1bmN0aW9uKGEsYyxnKXtnLiRzZXQoXCJ2YWx1ZVwiLGEuJGV2YWwoZy5uZ1ZhbHVlKSl9OmZ1bmN0aW9uKGEsYyxnKXthLiR3YXRjaChnLm5nVmFsdWUsZnVuY3Rpb24oYSl7Zy4kc2V0KFwidmFsdWVcIixhKX0pfX19fSxpZD12YShmdW5jdGlvbihhLGMsZCl7Yy5hZGRDbGFzcyhcIm5nLWJpbmRpbmdcIikuZGF0YShcIiRiaW5kaW5nXCIsZC5uZ0JpbmQpO2EuJHdhdGNoKGQubmdCaW5kLGZ1bmN0aW9uKGEpe2MudGV4dChhPT1zP1wiXCI6YSl9KX0pLGtkPVtcIiRpbnRlcnBvbGF0ZVwiLFxuZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGMsZCxlKXtjPWEoZC5hdHRyKGUuJGF0dHIubmdCaW5kVGVtcGxhdGUpKTtkLmFkZENsYXNzKFwibmctYmluZGluZ1wiKS5kYXRhKFwiJGJpbmRpbmdcIixjKTtlLiRvYnNlcnZlKFwibmdCaW5kVGVtcGxhdGVcIixmdW5jdGlvbihhKXtkLnRleHQoYSl9KX19XSxqZD1bXCIkc2NlXCIsXCIkcGFyc2VcIixmdW5jdGlvbihhLGMpe3JldHVybiBmdW5jdGlvbihkLGUsZyl7ZS5hZGRDbGFzcyhcIm5nLWJpbmRpbmdcIikuZGF0YShcIiRiaW5kaW5nXCIsZy5uZ0JpbmRIdG1sKTt2YXIgZj1jKGcubmdCaW5kSHRtbCk7ZC4kd2F0Y2goZnVuY3Rpb24oKXtyZXR1cm4oZihkKXx8XCJcIikudG9TdHJpbmcoKX0sZnVuY3Rpb24oYyl7ZS5odG1sKGEuZ2V0VHJ1c3RlZEh0bWwoZihkKSl8fFwiXCIpfSl9fV0sbGQ9UGIoXCJcIiwhMCksbmQ9UGIoXCJPZGRcIiwwKSxtZD1QYihcIkV2ZW5cIiwxKSxvZD12YSh7Y29tcGlsZTpmdW5jdGlvbihhLGMpe2MuJHNldChcIm5nQ2xvYWtcIixzKTthLnJlbW92ZUNsYXNzKFwibmctY2xvYWtcIil9fSksXG5wZD1bZnVuY3Rpb24oKXtyZXR1cm57c2NvcGU6ITAsY29udHJvbGxlcjpcIkBcIixwcmlvcml0eTo1MDB9fV0sZmM9e307cShcImNsaWNrIGRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZW1vdmUgbW91c2VlbnRlciBtb3VzZWxlYXZlIGtleWRvd24ga2V5dXAga2V5cHJlc3Mgc3VibWl0IGZvY3VzIGJsdXIgY29weSBjdXQgcGFzdGVcIi5zcGxpdChcIiBcIiksZnVuY3Rpb24oYSl7dmFyIGM9bmEoXCJuZy1cIithKTtmY1tjXT1bXCIkcGFyc2VcIixmdW5jdGlvbihkKXtyZXR1cm57Y29tcGlsZTpmdW5jdGlvbihlLGcpe3ZhciBmPWQoZ1tjXSk7cmV0dXJuIGZ1bmN0aW9uKGMsZCxlKXtkLm9uKEsoYSksZnVuY3Rpb24oYSl7Yy4kYXBwbHkoZnVuY3Rpb24oKXtmKGMseyRldmVudDphfSl9KX0pfX19fV19KTt2YXIgc2Q9W1wiJGFuaW1hdGVcIixmdW5jdGlvbihhKXtyZXR1cm57dHJhbnNjbHVkZTpcImVsZW1lbnRcIixwcmlvcml0eTo2MDAsdGVybWluYWw6ITAscmVzdHJpY3Q6XCJBXCIsXG4kJHRsYjohMCxsaW5rOmZ1bmN0aW9uKGMsZCxlLGcsZil7dmFyIGgsbCxrO2MuJHdhdGNoKGUubmdJZixmdW5jdGlvbihnKXtRYShnKT9sfHwobD1jLiRuZXcoKSxmKGwsZnVuY3Rpb24oYyl7Y1tjLmxlbmd0aCsrXT1VLmNyZWF0ZUNvbW1lbnQoXCIgZW5kIG5nSWY6IFwiK2UubmdJZitcIiBcIik7aD17Y2xvbmU6Y307YS5lbnRlcihjLGQucGFyZW50KCksZCl9KSk6KGsmJihrLnJlbW92ZSgpLGs9bnVsbCksbCYmKGwuJGRlc3Ryb3koKSxsPW51bGwpLGgmJihrPXliKGguY2xvbmUpLGEubGVhdmUoayxmdW5jdGlvbigpe2s9bnVsbH0pLGg9bnVsbCkpfSl9fX1dLHRkPVtcIiRodHRwXCIsXCIkdGVtcGxhdGVDYWNoZVwiLFwiJGFuY2hvclNjcm9sbFwiLFwiJGFuaW1hdGVcIixcIiRzY2VcIixmdW5jdGlvbihhLGMsZCxlLGcpe3JldHVybntyZXN0cmljdDpcIkVDQVwiLHByaW9yaXR5OjQwMCx0ZXJtaW5hbDohMCx0cmFuc2NsdWRlOlwiZWxlbWVudFwiLGNvbnRyb2xsZXI6RWEubm9vcCxjb21waWxlOmZ1bmN0aW9uKGYsXG5oKXt2YXIgbD1oLm5nSW5jbHVkZXx8aC5zcmMsaz1oLm9ubG9hZHx8XCJcIixtPWguYXV0b3Njcm9sbDtyZXR1cm4gZnVuY3Rpb24oZixoLHEscyx1KXt2YXIgRj0wLHYseSxBLHg9ZnVuY3Rpb24oKXt5JiYoeS5yZW1vdmUoKSx5PW51bGwpO3YmJih2LiRkZXN0cm95KCksdj1udWxsKTtBJiYoZS5sZWF2ZShBLGZ1bmN0aW9uKCl7eT1udWxsfSkseT1BLEE9bnVsbCl9O2YuJHdhdGNoKGcucGFyc2VBc1Jlc291cmNlVXJsKGwpLGZ1bmN0aW9uKGcpe3ZhciBsPWZ1bmN0aW9uKCl7IUIobSl8fG0mJiFmLiRldmFsKG0pfHxkKCl9LHE9KytGO2c/KGEuZ2V0KGcse2NhY2hlOmN9KS5zdWNjZXNzKGZ1bmN0aW9uKGEpe2lmKHE9PT1GKXt2YXIgYz1mLiRuZXcoKTtzLnRlbXBsYXRlPWE7YT11KGMsZnVuY3Rpb24oYSl7eCgpO2UuZW50ZXIoYSxudWxsLGgsbCl9KTt2PWM7QT1hO3YuJGVtaXQoXCIkaW5jbHVkZUNvbnRlbnRMb2FkZWRcIik7Zi4kZXZhbChrKX19KS5lcnJvcihmdW5jdGlvbigpe3E9PT1cbkYmJngoKX0pLGYuJGVtaXQoXCIkaW5jbHVkZUNvbnRlbnRSZXF1ZXN0ZWRcIikpOih4KCkscy50ZW1wbGF0ZT1udWxsKX0pfX19fV0sSmQ9W1wiJGNvbXBpbGVcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJFQ0FcIixwcmlvcml0eTotNDAwLHJlcXVpcmU6XCJuZ0luY2x1ZGVcIixsaW5rOmZ1bmN0aW9uKGMsZCxlLGcpe2QuaHRtbChnLnRlbXBsYXRlKTthKGQuY29udGVudHMoKSkoYyl9fX1dLHVkPXZhKHtwcmlvcml0eTo0NTAsY29tcGlsZTpmdW5jdGlvbigpe3JldHVybntwcmU6ZnVuY3Rpb24oYSxjLGQpe2EuJGV2YWwoZC5uZ0luaXQpfX19fSksdmQ9dmEoe3Rlcm1pbmFsOiEwLHByaW9yaXR5OjFFM30pLHdkPVtcIiRsb2NhbGVcIixcIiRpbnRlcnBvbGF0ZVwiLGZ1bmN0aW9uKGEsYyl7dmFyIGQ9L3t9L2c7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixsaW5rOmZ1bmN0aW9uKGUsZyxmKXt2YXIgaD1mLmNvdW50LGw9Zi4kYXR0ci53aGVuJiZnLmF0dHIoZi4kYXR0ci53aGVuKSxrPWYub2Zmc2V0fHxcbjAsbT1lLiRldmFsKGwpfHx7fSxuPXt9LHA9Yy5zdGFydFN5bWJvbCgpLHI9Yy5lbmRTeW1ib2woKSxzPS9ed2hlbihNaW51cyk/KC4rKSQvO3EoZixmdW5jdGlvbihhLGMpe3MudGVzdChjKSYmKG1bSyhjLnJlcGxhY2UoXCJ3aGVuXCIsXCJcIikucmVwbGFjZShcIk1pbnVzXCIsXCItXCIpKV09Zy5hdHRyKGYuJGF0dHJbY10pKX0pO3EobSxmdW5jdGlvbihhLGUpe25bZV09YyhhLnJlcGxhY2UoZCxwK2grXCItXCIraytyKSl9KTtlLiR3YXRjaChmdW5jdGlvbigpe3ZhciBjPXBhcnNlRmxvYXQoZS4kZXZhbChoKSk7aWYoaXNOYU4oYykpcmV0dXJuXCJcIjtjIGluIG18fChjPWEucGx1cmFsQ2F0KGMtaykpO3JldHVybiBuW2NdKGUsZywhMCl9LGZ1bmN0aW9uKGEpe2cudGV4dChhKX0pfX19XSx4ZD1bXCIkcGFyc2VcIixcIiRhbmltYXRlXCIsZnVuY3Rpb24oYSxjKXt2YXIgZD10KFwibmdSZXBlYXRcIik7cmV0dXJue3RyYW5zY2x1ZGU6XCJlbGVtZW50XCIscHJpb3JpdHk6MUUzLHRlcm1pbmFsOiEwLCQkdGxiOiEwLFxubGluazpmdW5jdGlvbihlLGcsZixoLGwpe3ZhciBrPWYubmdSZXBlYXQsbT1rLm1hdGNoKC9eXFxzKihbXFxzXFxTXSs/KVxccytpblxccysoW1xcc1xcU10rPykoPzpcXHMrdHJhY2tcXHMrYnlcXHMrKFtcXHNcXFNdKz8pKT9cXHMqJC8pLG4scCxyLHMsdSxGLHY9eyRpZDpJYX07aWYoIW0pdGhyb3cgZChcImlleHBcIixrKTtmPW1bMV07aD1tWzJdOyhtPW1bM10pPyhuPWEobSkscD1mdW5jdGlvbihhLGMsZCl7RiYmKHZbRl09YSk7dlt1XT1jO3YuJGluZGV4PWQ7cmV0dXJuIG4oZSx2KX0pOihyPWZ1bmN0aW9uKGEsYyl7cmV0dXJuIElhKGMpfSxzPWZ1bmN0aW9uKGEpe3JldHVybiBhfSk7bT1mLm1hdGNoKC9eKD86KFtcXCRcXHddKyl8XFwoKFtcXCRcXHddKylcXHMqLFxccyooW1xcJFxcd10rKVxcKSkkLyk7aWYoIW0pdGhyb3cgZChcImlpZGV4cFwiLGYpO3U9bVszXXx8bVsxXTtGPW1bMl07dmFyIEI9e307ZS4kd2F0Y2hDb2xsZWN0aW9uKGgsZnVuY3Rpb24oYSl7dmFyIGYsaCxtPWdbMF0sbix2PXt9LEgsUix3LEMsVCx0LFxuRT1bXTtpZihhYihhKSlUPWEsbj1wfHxyO2Vsc2V7bj1wfHxzO1Q9W107Zm9yKHcgaW4gYSlhLmhhc093blByb3BlcnR5KHcpJiZcIiRcIiE9dy5jaGFyQXQoMCkmJlQucHVzaCh3KTtULnNvcnQoKX1IPVQubGVuZ3RoO2g9RS5sZW5ndGg9VC5sZW5ndGg7Zm9yKGY9MDtmPGg7ZisrKWlmKHc9YT09PVQ/ZjpUW2ZdLEM9YVt3XSxDPW4odyxDLGYpLEFhKEMsXCJgdHJhY2sgYnlgIGlkXCIpLEIuaGFzT3duUHJvcGVydHkoQykpdD1CW0NdLGRlbGV0ZSBCW0NdLHZbQ109dCxFW2ZdPXQ7ZWxzZXtpZih2Lmhhc093blByb3BlcnR5KEMpKXRocm93IHEoRSxmdW5jdGlvbihhKXthJiZhLnNjb3BlJiYoQlthLmlkXT1hKX0pLGQoXCJkdXBlc1wiLGssQyk7RVtmXT17aWQ6Q307dltDXT0hMX1mb3IodyBpbiBCKUIuaGFzT3duUHJvcGVydHkodykmJih0PUJbd10sZj15Yih0LmNsb25lKSxjLmxlYXZlKGYpLHEoZixmdW5jdGlvbihhKXthLiQkTkdfUkVNT1ZFRD0hMH0pLHQuc2NvcGUuJGRlc3Ryb3koKSk7XG5mPTA7Zm9yKGg9VC5sZW5ndGg7ZjxoO2YrKyl7dz1hPT09VD9mOlRbZl07Qz1hW3ddO3Q9RVtmXTtFW2YtMV0mJihtPUVbZi0xXS5jbG9uZVtFW2YtMV0uY2xvbmUubGVuZ3RoLTFdKTtpZih0LnNjb3BlKXtSPXQuc2NvcGU7bj1tO2RvIG49bi5uZXh0U2libGluZzt3aGlsZShuJiZuLiQkTkdfUkVNT1ZFRCk7dC5jbG9uZVswXSE9biYmYy5tb3ZlKHliKHQuY2xvbmUpLG51bGwseShtKSk7bT10LmNsb25lW3QuY2xvbmUubGVuZ3RoLTFdfWVsc2UgUj1lLiRuZXcoKTtSW3VdPUM7RiYmKFJbRl09dyk7Ui4kaW5kZXg9ZjtSLiRmaXJzdD0wPT09ZjtSLiRsYXN0PWY9PT1ILTE7Ui4kbWlkZGxlPSEoUi4kZmlyc3R8fFIuJGxhc3QpO1IuJG9kZD0hKFIuJGV2ZW49MD09PShmJjEpKTt0LnNjb3BlfHxsKFIsZnVuY3Rpb24oYSl7YVthLmxlbmd0aCsrXT1VLmNyZWF0ZUNvbW1lbnQoXCIgZW5kIG5nUmVwZWF0OiBcIitrK1wiIFwiKTtjLmVudGVyKGEsbnVsbCx5KG0pKTttPWE7dC5zY29wZT1SO3QuY2xvbmU9XG5hO3ZbdC5pZF09dH0pfUI9dn0pfX19XSx5ZD1bXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihjLGQsZSl7Yy4kd2F0Y2goZS5uZ1Nob3csZnVuY3Rpb24oYyl7YVtRYShjKT9cInJlbW92ZUNsYXNzXCI6XCJhZGRDbGFzc1wiXShkLFwibmctaGlkZVwiKX0pfX1dLHJkPVtcIiRhbmltYXRlXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGMsZCxlKXtjLiR3YXRjaChlLm5nSGlkZSxmdW5jdGlvbihjKXthW1FhKGMpP1wiYWRkQ2xhc3NcIjpcInJlbW92ZUNsYXNzXCJdKGQsXCJuZy1oaWRlXCIpfSl9fV0semQ9dmEoZnVuY3Rpb24oYSxjLGQpe2EuJHdhdGNoKGQubmdTdHlsZSxmdW5jdGlvbihhLGQpe2QmJmEhPT1kJiZxKGQsZnVuY3Rpb24oYSxkKXtjLmNzcyhkLFwiXCIpfSk7YSYmYy5jc3MoYSl9LCEwKX0pLEFkPVtcIiRhbmltYXRlXCIsZnVuY3Rpb24oYSl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixyZXF1aXJlOlwibmdTd2l0Y2hcIixjb250cm9sbGVyOltcIiRzY29wZVwiLGZ1bmN0aW9uKCl7dGhpcy5jYXNlcz1cbnt9fV0sbGluazpmdW5jdGlvbihjLGQsZSxnKXt2YXIgZixoLGwsaz1bXTtjLiR3YXRjaChlLm5nU3dpdGNofHxlLm9uLGZ1bmN0aW9uKGQpe3ZhciBuLHA9ay5sZW5ndGg7aWYoMDxwKXtpZihsKXtmb3Iobj0wO248cDtuKyspbFtuXS5yZW1vdmUoKTtsPW51bGx9bD1bXTtmb3Iobj0wO248cDtuKyspe3ZhciByPWhbbl07a1tuXS4kZGVzdHJveSgpO2xbbl09cjthLmxlYXZlKHIsZnVuY3Rpb24oKXtsLnNwbGljZShuLDEpOzA9PT1sLmxlbmd0aCYmKGw9bnVsbCl9KX19aD1bXTtrPVtdO2lmKGY9Zy5jYXNlc1tcIiFcIitkXXx8Zy5jYXNlc1tcIj9cIl0pYy4kZXZhbChlLmNoYW5nZSkscShmLGZ1bmN0aW9uKGQpe3ZhciBlPWMuJG5ldygpO2sucHVzaChlKTtkLnRyYW5zY2x1ZGUoZSxmdW5jdGlvbihjKXt2YXIgZT1kLmVsZW1lbnQ7aC5wdXNoKGMpO2EuZW50ZXIoYyxlLnBhcmVudCgpLGUpfSl9KX0pfX19XSxCZD12YSh7dHJhbnNjbHVkZTpcImVsZW1lbnRcIixwcmlvcml0eTo4MDAscmVxdWlyZTpcIl5uZ1N3aXRjaFwiLFxubGluazpmdW5jdGlvbihhLGMsZCxlLGcpe2UuY2FzZXNbXCIhXCIrZC5uZ1N3aXRjaFdoZW5dPWUuY2FzZXNbXCIhXCIrZC5uZ1N3aXRjaFdoZW5dfHxbXTtlLmNhc2VzW1wiIVwiK2QubmdTd2l0Y2hXaGVuXS5wdXNoKHt0cmFuc2NsdWRlOmcsZWxlbWVudDpjfSl9fSksQ2Q9dmEoe3RyYW5zY2x1ZGU6XCJlbGVtZW50XCIscHJpb3JpdHk6ODAwLHJlcXVpcmU6XCJebmdTd2l0Y2hcIixsaW5rOmZ1bmN0aW9uKGEsYyxkLGUsZyl7ZS5jYXNlc1tcIj9cIl09ZS5jYXNlc1tcIj9cIl18fFtdO2UuY2FzZXNbXCI/XCJdLnB1c2goe3RyYW5zY2x1ZGU6ZyxlbGVtZW50OmN9KX19KSxFZD12YSh7bGluazpmdW5jdGlvbihhLGMsZCxlLGcpe2lmKCFnKXRocm93IHQoXCJuZ1RyYW5zY2x1ZGVcIikoXCJvcnBoYW5cIixoYShjKSk7ZyhmdW5jdGlvbihhKXtjLmVtcHR5KCk7Yy5hcHBlbmQoYSl9KX19KSxlZD1bXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe3JldHVybntyZXN0cmljdDpcIkVcIix0ZXJtaW5hbDohMCxjb21waWxlOmZ1bmN0aW9uKGMsXG5kKXtcInRleHQvbmctdGVtcGxhdGVcIj09ZC50eXBlJiZhLnB1dChkLmlkLGNbMF0udGV4dCl9fX1dLFRlPXQoXCJuZ09wdGlvbnNcIiksRGQ9YWEoe3Rlcm1pbmFsOiEwfSksZmQ9W1wiJGNvbXBpbGVcIixcIiRwYXJzZVwiLGZ1bmN0aW9uKGEsYyl7dmFyIGQ9L15cXHMqKFtcXHNcXFNdKz8pKD86XFxzK2FzXFxzKyhbXFxzXFxTXSs/KSk/KD86XFxzK2dyb3VwXFxzK2J5XFxzKyhbXFxzXFxTXSs/KSk/XFxzK2ZvclxccysoPzooW1xcJFxcd11bXFwkXFx3XSopfCg/OlxcKFxccyooW1xcJFxcd11bXFwkXFx3XSopXFxzKixcXHMqKFtcXCRcXHddW1xcJFxcd10qKVxccypcXCkpKVxccytpblxccysoW1xcc1xcU10rPykoPzpcXHMrdHJhY2tcXHMrYnlcXHMrKFtcXHNcXFNdKz8pKT8kLyxlPXskc2V0Vmlld1ZhbHVlOkN9O3JldHVybntyZXN0cmljdDpcIkVcIixyZXF1aXJlOltcInNlbGVjdFwiLFwiP25nTW9kZWxcIl0sY29udHJvbGxlcjpbXCIkZWxlbWVudFwiLFwiJHNjb3BlXCIsXCIkYXR0cnNcIixmdW5jdGlvbihhLGMsZCl7dmFyIGw9dGhpcyxrPXt9LG09ZSxuO2wuZGF0YWJvdW5kPVxuZC5uZ01vZGVsO2wuaW5pdD1mdW5jdGlvbihhLGMsZCl7bT1hO249ZH07bC5hZGRPcHRpb249ZnVuY3Rpb24oYyl7QWEoYywnXCJvcHRpb24gdmFsdWVcIicpO2tbY109ITA7bS4kdmlld1ZhbHVlPT1jJiYoYS52YWwoYyksbi5wYXJlbnQoKSYmbi5yZW1vdmUoKSl9O2wucmVtb3ZlT3B0aW9uPWZ1bmN0aW9uKGEpe3RoaXMuaGFzT3B0aW9uKGEpJiYoZGVsZXRlIGtbYV0sbS4kdmlld1ZhbHVlPT1hJiZ0aGlzLnJlbmRlclVua25vd25PcHRpb24oYSkpfTtsLnJlbmRlclVua25vd25PcHRpb249ZnVuY3Rpb24oYyl7Yz1cIj8gXCIrSWEoYykrXCIgP1wiO24udmFsKGMpO2EucHJlcGVuZChuKTthLnZhbChjKTtuLnByb3AoXCJzZWxlY3RlZFwiLCEwKX07bC5oYXNPcHRpb249ZnVuY3Rpb24oYSl7cmV0dXJuIGsuaGFzT3duUHJvcGVydHkoYSl9O2MuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2wucmVuZGVyVW5rbm93bk9wdGlvbj1DfSl9XSxsaW5rOmZ1bmN0aW9uKGUsZixoLGwpe2Z1bmN0aW9uIGsoYSxcbmMsZCxlKXtkLiRyZW5kZXI9ZnVuY3Rpb24oKXt2YXIgYT1kLiR2aWV3VmFsdWU7ZS5oYXNPcHRpb24oYSk/KEEucGFyZW50KCkmJkEucmVtb3ZlKCksYy52YWwoYSksXCJcIj09PWEmJncucHJvcChcInNlbGVjdGVkXCIsITApKTpFKGEpJiZ3P2MudmFsKFwiXCIpOmUucmVuZGVyVW5rbm93bk9wdGlvbihhKX07Yy5vbihcImNoYW5nZVwiLGZ1bmN0aW9uKCl7YS4kYXBwbHkoZnVuY3Rpb24oKXtBLnBhcmVudCgpJiZBLnJlbW92ZSgpO2QuJHNldFZpZXdWYWx1ZShjLnZhbCgpKX0pfSl9ZnVuY3Rpb24gbShhLGMsZCl7dmFyIGU7ZC4kcmVuZGVyPWZ1bmN0aW9uKCl7dmFyIGE9bmV3IFZhKGQuJHZpZXdWYWx1ZSk7cShjLmZpbmQoXCJvcHRpb25cIiksZnVuY3Rpb24oYyl7Yy5zZWxlY3RlZD1CKGEuZ2V0KGMudmFsdWUpKX0pfTthLiR3YXRjaChmdW5jdGlvbigpe3hhKGUsZC4kdmlld1ZhbHVlKXx8KGU9YmEoZC4kdmlld1ZhbHVlKSxkLiRyZW5kZXIoKSl9KTtjLm9uKFwiY2hhbmdlXCIsZnVuY3Rpb24oKXthLiRhcHBseShmdW5jdGlvbigpe3ZhciBhPVxuW107cShjLmZpbmQoXCJvcHRpb25cIiksZnVuY3Rpb24oYyl7Yy5zZWxlY3RlZCYmYS5wdXNoKGMudmFsdWUpfSk7ZC4kc2V0Vmlld1ZhbHVlKGEpfSl9KX1mdW5jdGlvbiBuKGUsZixnKXtmdW5jdGlvbiBoKCl7dmFyIGE9e1wiXCI6W119LGM9W1wiXCJdLGQsayxzLHQsejt0PWcuJG1vZGVsVmFsdWU7ej15KGUpfHxbXTt2YXIgRT1uP1FiKHopOnosRixJLEE7ST17fTtzPSExO3ZhciBELEg7aWYocilpZih3JiZNKHQpKWZvcihzPW5ldyBWYShbXSksQT0wO0E8dC5sZW5ndGg7QSsrKUlbbV09dFtBXSxzLnB1dCh3KGUsSSksdFtBXSk7ZWxzZSBzPW5ldyBWYSh0KTtmb3IoQT0wO0Y9RS5sZW5ndGgsQTxGO0ErKyl7az1BO2lmKG4pe2s9RVtBXTtpZihcIiRcIj09PWsuY2hhckF0KDApKWNvbnRpbnVlO0lbbl09a31JW21dPXpba107ZD1wKGUsSSl8fFwiXCI7KGs9YVtkXSl8fChrPWFbZF09W10sYy5wdXNoKGQpKTtyP2Q9QihzLnJlbW92ZSh3P3coZSxJKTpxKGUsSSkpKToodz8oZD17fSxkW21dPXQsZD1cbncoZSxkKT09PXcoZSxJKSk6ZD10PT09cShlLEkpLHM9c3x8ZCk7RD1sKGUsSSk7RD1CKEQpP0Q6XCJcIjtrLnB1c2goe2lkOnc/dyhlLEkpOm4/RVtBXTpBLGxhYmVsOkQsc2VsZWN0ZWQ6ZH0pfXJ8fCh1fHxudWxsPT09dD9hW1wiXCJdLnVuc2hpZnQoe2lkOlwiXCIsbGFiZWw6XCJcIixzZWxlY3RlZDohc30pOnN8fGFbXCJcIl0udW5zaGlmdCh7aWQ6XCI/XCIsbGFiZWw6XCJcIixzZWxlY3RlZDohMH0pKTtJPTA7Zm9yKEU9Yy5sZW5ndGg7STxFO0krKyl7ZD1jW0ldO2s9YVtkXTt4Lmxlbmd0aDw9ST8odD17ZWxlbWVudDpDLmNsb25lKCkuYXR0cihcImxhYmVsXCIsZCksbGFiZWw6ay5sYWJlbH0sej1bdF0seC5wdXNoKHopLGYuYXBwZW5kKHQuZWxlbWVudCkpOih6PXhbSV0sdD16WzBdLHQubGFiZWwhPWQmJnQuZWxlbWVudC5hdHRyKFwibGFiZWxcIix0LmxhYmVsPWQpKTtEPW51bGw7QT0wO2ZvcihGPWsubGVuZ3RoO0E8RjtBKyspcz1rW0FdLChkPXpbQSsxXSk/KEQ9ZC5lbGVtZW50LGQubGFiZWwhPT1zLmxhYmVsJiZcbkQudGV4dChkLmxhYmVsPXMubGFiZWwpLGQuaWQhPT1zLmlkJiZELnZhbChkLmlkPXMuaWQpLGQuc2VsZWN0ZWQhPT1zLnNlbGVjdGVkJiZELnByb3AoXCJzZWxlY3RlZFwiLGQuc2VsZWN0ZWQ9cy5zZWxlY3RlZCkpOihcIlwiPT09cy5pZCYmdT9IPXU6KEg9di5jbG9uZSgpKS52YWwocy5pZCkuYXR0cihcInNlbGVjdGVkXCIscy5zZWxlY3RlZCkudGV4dChzLmxhYmVsKSx6LnB1c2goe2VsZW1lbnQ6SCxsYWJlbDpzLmxhYmVsLGlkOnMuaWQsc2VsZWN0ZWQ6cy5zZWxlY3RlZH0pLEQ/RC5hZnRlcihIKTp0LmVsZW1lbnQuYXBwZW5kKEgpLEQ9SCk7Zm9yKEErKzt6Lmxlbmd0aD5BOyl6LnBvcCgpLmVsZW1lbnQucmVtb3ZlKCl9Zm9yKDt4Lmxlbmd0aD5JOyl4LnBvcCgpWzBdLmVsZW1lbnQucmVtb3ZlKCl9dmFyIGs7aWYoIShrPXQubWF0Y2goZCkpKXRocm93IFRlKFwiaWV4cFwiLHQsaGEoZikpO3ZhciBsPWMoa1syXXx8a1sxXSksbT1rWzRdfHxrWzZdLG49a1s1XSxwPWMoa1szXXx8XCJcIikscT1cbmMoa1syXT9rWzFdOm0pLHk9YyhrWzddKSx3PWtbOF0/YyhrWzhdKTpudWxsLHg9W1t7ZWxlbWVudDpmLGxhYmVsOlwiXCJ9XV07dSYmKGEodSkoZSksdS5yZW1vdmVDbGFzcyhcIm5nLXNjb3BlXCIpLHUucmVtb3ZlKCkpO2YuZW1wdHkoKTtmLm9uKFwiY2hhbmdlXCIsZnVuY3Rpb24oKXtlLiRhcHBseShmdW5jdGlvbigpe3ZhciBhLGM9eShlKXx8W10sZD17fSxoLGssbCxwLHQsdix1O2lmKHIpZm9yKGs9W10scD0wLHY9eC5sZW5ndGg7cDx2O3ArKylmb3IoYT14W3BdLGw9MSx0PWEubGVuZ3RoO2w8dDtsKyspe2lmKChoPWFbbF0uZWxlbWVudClbMF0uc2VsZWN0ZWQpe2g9aC52YWwoKTtuJiYoZFtuXT1oKTtpZih3KWZvcih1PTA7dTxjLmxlbmd0aCYmKGRbbV09Y1t1XSx3KGUsZCkhPWgpO3UrKyk7ZWxzZSBkW21dPWNbaF07ay5wdXNoKHEoZSxkKSl9fWVsc2V7aD1mLnZhbCgpO2lmKFwiP1wiPT1oKWs9cztlbHNlIGlmKFwiXCI9PT1oKWs9bnVsbDtlbHNlIGlmKHcpZm9yKHU9MDt1PGMubGVuZ3RoO3UrKyl7aWYoZFttXT1cbmNbdV0sdyhlLGQpPT1oKXtrPXEoZSxkKTticmVha319ZWxzZSBkW21dPWNbaF0sbiYmKGRbbl09aCksaz1xKGUsZCk7MTx4WzBdLmxlbmd0aCYmeFswXVsxXS5pZCE9PWgmJih4WzBdWzFdLnNlbGVjdGVkPSExKX1nLiRzZXRWaWV3VmFsdWUoayl9KX0pO2cuJHJlbmRlcj1oO2UuJHdhdGNoKGgpfWlmKGxbMV0pe3ZhciBwPWxbMF07bD1sWzFdO3ZhciByPWgubXVsdGlwbGUsdD1oLm5nT3B0aW9ucyx1PSExLHcsdj15KFUuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKSksQz15KFUuY3JlYXRlRWxlbWVudChcIm9wdGdyb3VwXCIpKSxBPXYuY2xvbmUoKTtoPTA7Zm9yKHZhciB4PWYuY2hpbGRyZW4oKSxEPXgubGVuZ3RoO2g8RDtoKyspaWYoXCJcIj09PXhbaF0udmFsdWUpe3c9dT14LmVxKGgpO2JyZWFrfXAuaW5pdChsLHUsQSk7ciYmKGwuJGlzRW1wdHk9ZnVuY3Rpb24oYSl7cmV0dXJuIWF8fDA9PT1hLmxlbmd0aH0pO3Q/bihlLGYsbCk6cj9tKGUsZixsKTprKGUsZixsLHApfX19fV0saGQ9W1wiJGludGVycG9sYXRlXCIsXG5mdW5jdGlvbihhKXt2YXIgYz17YWRkT3B0aW9uOkMscmVtb3ZlT3B0aW9uOkN9O3JldHVybntyZXN0cmljdDpcIkVcIixwcmlvcml0eToxMDAsY29tcGlsZTpmdW5jdGlvbihkLGUpe2lmKEUoZS52YWx1ZSkpe3ZhciBnPWEoZC50ZXh0KCksITApO2d8fGUuJHNldChcInZhbHVlXCIsZC50ZXh0KCkpfXJldHVybiBmdW5jdGlvbihhLGQsZSl7dmFyIGs9ZC5wYXJlbnQoKSxtPWsuZGF0YShcIiRzZWxlY3RDb250cm9sbGVyXCIpfHxrLnBhcmVudCgpLmRhdGEoXCIkc2VsZWN0Q29udHJvbGxlclwiKTttJiZtLmRhdGFib3VuZD9kLnByb3AoXCJzZWxlY3RlZFwiLCExKTptPWM7Zz9hLiR3YXRjaChnLGZ1bmN0aW9uKGEsYyl7ZS4kc2V0KFwidmFsdWVcIixhKTthIT09YyYmbS5yZW1vdmVPcHRpb24oYyk7bS5hZGRPcHRpb24oYSl9KTptLmFkZE9wdGlvbihlLnZhbHVlKTtkLm9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe20ucmVtb3ZlT3B0aW9uKGUudmFsdWUpfSl9fX19XSxnZD1hYSh7cmVzdHJpY3Q6XCJFXCIsXG50ZXJtaW5hbDohMH0pO08uYW5ndWxhci5ib290c3RyYXA/Y29uc29sZS5sb2coXCJXQVJOSU5HOiBUcmllZCB0byBsb2FkIGFuZ3VsYXIgbW9yZSB0aGFuIG9uY2UuXCIpOigoR2E9Ty5qUXVlcnkpPyh5PUdhLEQoR2EuZm4se3Njb3BlOkphLnNjb3BlLGlzb2xhdGVTY29wZTpKYS5pc29sYXRlU2NvcGUsY29udHJvbGxlcjpKYS5jb250cm9sbGVyLGluamVjdG9yOkphLmluamVjdG9yLGluaGVyaXRlZERhdGE6SmEuaW5oZXJpdGVkRGF0YX0pLEFiKFwicmVtb3ZlXCIsITAsITAsITEpLEFiKFwiZW1wdHlcIiwhMSwhMSwhMSksQWIoXCJodG1sXCIsITEsITEsITApKTp5PU4sRWEuZWxlbWVudD15LFpjKEVhKSx5KFUpLnJlYWR5KGZ1bmN0aW9uKCl7V2MoVSwkYil9KSl9KSh3aW5kb3csZG9jdW1lbnQpOyFhbmd1bGFyLiQkY3NwKCkmJmFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkuZmluZChcImhlYWRcIikucHJlcGVuZCgnPHN0eWxlIHR5cGU9XCJ0ZXh0L2Nzc1wiPkBjaGFyc2V0IFwiVVRGLThcIjtbbmdcXFxcOmNsb2FrXSxbbmctY2xvYWtdLFtkYXRhLW5nLWNsb2FrXSxbeC1uZy1jbG9ha10sLm5nLWNsb2FrLC54LW5nLWNsb2FrLC5uZy1oaWRle2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50O31uZ1xcXFw6Zm9ybXtkaXNwbGF5OmJsb2NrO30ubmctYW5pbWF0ZS1ibG9jay10cmFuc2l0aW9uc3t0cmFuc2l0aW9uOjBzIGFsbCFpbXBvcnRhbnQ7LXdlYmtpdC10cmFuc2l0aW9uOjBzIGFsbCFpbXBvcnRhbnQ7fTwvc3R5bGU+Jyk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hbmd1bGFyLm1pbi5qcy5tYXBcbiIsInJlcXVpcmUoXCIuL2FuZ3VsYXIvYW5ndWxhci5taW4uanNcIik7XG5yZXF1aXJlKFwiYW5ndWxhci1hbmltYXRlXCIpO1xucmVxdWlyZShcIi4vbGlicy91aS1ib290c3RyYXAtdHBscy0wLjExLjIubWluLmpzXCIpO1xucmVxdWlyZShcIi4vbGlicy9hbmd1bGFyLXRyYW5zbGF0ZS5qc1wiKTtcbnJlcXVpcmUoXCIuL2xpYnMvYW5ndWxhci10cmFuc2xhdGUtbG9hZGVyLXN0YXRpYy1maWxlcy5qc1wiKTtcbnJlcXVpcmUoXCIuL2xpYnMvcHJvbWlzZS10cmFja2VyLmpzXCIpO1xucmVxdWlyZShcIi4vbGlicy9wcm9taXNlLXRyYWNrZXItaHR0cC1pbnRlcmNlcHRvci5qc1wiKTtcbnJlcXVpcmUoXCIuL211bHRpc2VsZWN0L211bHRpc2VsZWN0LmpzXCIpO1xucmVxdWlyZShcIi4vbmF2aWdhdGlvbi1ibG9ja2VyL25hdmlnYXRpb24tYmxvY2tlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2xhbmd1YWdlLWNoYW5nZXIvbGFuZ3VhZ2UtY2hhbmdlci5qc1wiKTtcbnJlcXVpcmUoXCIuL3RhYnMvZm9ybS10YWJzLmpzXCIpO1xucmVxdWlyZShcIi4vdXRpbHMvdXRpbHMuanNcIik7XG5yZXF1aXJlKFwiLi9lcnJvci1tYXBwZXIvZXJyb3ItbWFwcGVyLmpzXCIpO1xucmVxdWlyZShcIi4vYW5ndWxhci1lbGFzdGljL2VsYXN0aWMuanNcIik7XG5yZXF1aXJlKFwiLi9vcmRlci1vYmplY3QtYnkvbmctb3JkZXItb2JqZWN0LWJ5LmpzXCIpO1xucmVxdWlyZShcIi4vbm90aWZpY2F0aW9uL25vdGlmaWNhdGlvbi5qc1wiKTtcbnJlcXVpcmUoXCIuL2xpYnMvdWktaGFuZHNvbnRhYmxlLmpzXCIpO1xucmVxdWlyZShcIi4vbGlicy9udW1lcmFsLmRlLWRlLmpzXCIpO1xucmVxdWlyZShcIi4vYW5ndWxhci1hcHAuanNcIik7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgYXJnb2FhdmEgb24gMTMuMDUuMTQuXHJcbiAqL1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ3VpLmVycm9yTWFwcGVyJywgW10pXHJcbiAgICAuc2VydmljZSgnZXJyb3JNYXBwZXJTZXJ2aWNlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5lcnJvck1hcHBpbmdzID0ge1xyXG4gICAgICAgICAgICBcInJlcXVpcmVkXCIgOiBcIlRoaXMgaXMgYSByZXF1aXJlZCBmaWVsZFwiLFxyXG4gICAgICAgICAgICBcInBhdHRlcm5fZGVjaW1hbFwiIDogXCJQbGVhc2UgcHJvdmlkZSBhIG51bWJlciBncmVhdGVyIHRoYW4gMFwiLFxyXG4gICAgICAgICAgICBcInBhdHRlcm5faW50ZWdlclwiIDogXCJQbGVhc2UgcHJvdmlkZSBhIHdob2xlIG51bWJlciBncmVhdGVyIHRoYW4gMFwiLFxyXG4gICAgICAgICAgICBcInBhdHRlcm5fdGVsZXBob25lXCIgOiBcIlBsZWFzZSBlbnRlciBhIHZhbGlkIHRlbGVwaG9uZSBudW1iZXIgKGF0IGxlYXN0IDcgZGlnaXRzKVwiLFxyXG4gICAgICAgICAgICBcInBhdHRlcm5fZW1haWxcIiA6IFwiUGxlYXNlIGVudGVyIGEgdmFsaWQgZW1haWwgYWRkcmVzc1wiLFxyXG4gICAgICAgICAgICBcInBhdHRlcm5fdXJsXCIgOiBcIlBsZWFzZSBlbnRlciBhIHZhbGlkIFVSTFwiLFxyXG4gICAgICAgICAgICBcInBhdHRlcm5fbG9uZ2l0dWRlXCIgOiBcIlBsZWFzZSBlbnRlciBudW1iZXIgYmV0d2VlbiAtMTgwIGFuZCAxODAgXCIsXHJcbiAgICAgICAgICAgIFwicGF0dGVybl9sYXRpdHVkZVwiIDogXCJQbGVhc2UgZW50ZXIgbnVtYmVyIGJldHdlZW4gLTkwIGFuZCA5MFwifTtcclxuXHJcbiAgICAgICAgdGhpcy5nZXRFcnJvck1hcHBpbmdzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVycm9yTWFwcGluZ3M7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmFkZEVycm9yTWFwcGluZyA9IGZ1bmN0aW9uKGtleSwgbWVzc2FnZSkge1xyXG4gICAgICAgICAgICB0aGlzLmVycm9yTWFwcGluZ3Nba2V5XSA9IG1lc3NhZ2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNldEVycm9yTWFwcGluZ3MgPSBmdW5jdGlvbihlcnJvck1hcHBpbmdzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXJyb3JNYXBwaW5ncyA9IGVycm9yTWFwcGluZ3M7XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuICAgIC5jb250cm9sbGVyKFwiRXJyb3JDb250cm9sbGVyXCIsIGZ1bmN0aW9uICgkc2NvcGUsIGVycm9yTWFwcGVyU2VydmljZSkge1xyXG5cclxuICAgICAgICAkc2NvcGUuZXJyb3JNYXBwaW5ncyA9IGVycm9yTWFwcGVyU2VydmljZS5nZXRFcnJvck1hcHBpbmdzKCk7XHJcbiAgICAgICAgJHNjb3BlLnNob3dDdXJyZW50RXJyb3IgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmdldEVycm9yTWVzc2FnZSA9IGZ1bmN0aW9uKGVycm9yQ29kZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLmVycm9yTWFwcGluZ3NbZXJyb3JDb2RlXTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuZ2V0Q29udHJvbGxlciA9IGZ1bmN0aW9uKGF0dHJpYnV0ZXMpIHtcclxuICAgICAgICAgICAgaWYgKCFhdHRyaWJ1dGVzLndhdGNoVmlldykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHRva2VucyA9IGF0dHJpYnV0ZXMud2F0Y2hWaWV3LnNwbGl0KFwiLlwiKTtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9ICRzY29wZTtcclxuICAgICAgICAgICAgd2hpbGUodG9rZW5zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0W3Rva2Vucy5zaGlmdCgpXTtcclxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUucGFyc2VFcnJvcnMgPSBmdW5jdGlvbihjdHJsLCBhdHRyaWJ1dGVzKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWVsZE5hbWVJZGVudGlmaWVyID0gIWF0dHJpYnV0ZXMud2F0Y2hWaWV3PyBhdHRyaWJ1dGVzLmVycm9yTWFwcGVyIDogYXR0cmlidXRlcy53YXRjaFZpZXc7XHJcbiAgICAgICAgICAgIHZhciBuYW1lVG9rZW5zID0gZmllbGROYW1lSWRlbnRpZmllci5zcGxpdCgnLicpO1xyXG4gICAgICAgICAgICB2YXIgbmFtZSA9IG5hbWVUb2tlbnNbMV07XHJcblxyXG4gICAgICAgICAgICB2YXIgZmllbGRDb250cm9sbGVyID0gIWN0cmxbbmFtZV0/ICRzY29wZS5nZXRDb250cm9sbGVyKGF0dHJpYnV0ZXMpIDogY3RybFtuYW1lXTtcclxuICAgICAgICAgICAgaWYgKCFmaWVsZENvbnRyb2xsZXIpIHtcclxuICAgICAgICAgICAgICAgIGlmICghYXR0cmlidXRlcy5yYWRpb0J1dHRvblZhbHVlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IEVycm9yKFwiaW5wdXQgZmllbGQgY29udHJvbGxlciBub3QgZm91bmQgZm9yIFwiICsgYXR0cmlidXRlcy5lcnJvck1hcHBlcik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByYWRpb0J1dHRvblZhbHVlcyA9IEpTT04ucGFyc2UoYXR0cmlidXRlcy5yYWRpb0J1dHRvblZhbHVlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dDdXJyZW50RXJyb3IgPSAhcmFkaW9CdXR0b25WYWx1ZXMudmFsdWUgJiYgJHNjb3BlLnN1Ym1pdHRlZCAmJiByYWRpb0J1dHRvblZhbHVlcy5yZXF1aXJlZDtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudEVycm9yQ29kZSA9ICdyZXF1aXJlZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgY29udHJvbGxlckVycm9ycyA9IGZpZWxkQ29udHJvbGxlci4kZXJyb3I7XHJcbiAgICAgICAgICAgIGlmICggIWF0dHJpYnV0ZXMuZXJyb3JzVG9TaG93KSByZXR1cm47XHJcbiAgICAgICAgICAgIHZhciBlcnJvcnNUb1Nob3dBc0FycmF5ID0gSlNPTi5wYXJzZShhdHRyaWJ1dGVzLmVycm9yc1RvU2hvdyk7XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVycm9yc1RvU2hvd0FzQXJyYXkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBzcGxpdEVycm9yU3RyaW5nID0gZXJyb3JzVG9TaG93QXNBcnJheVtpXS5zcGxpdCgnXycpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHN0cmlwcGVkRXJyb3JTdHJpbmcgPSBzcGxpdEVycm9yU3RyaW5nWzBdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbnRyb2xsZXJFcnJvcnNbc3RyaXBwZWRFcnJvclN0cmluZ10pIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0N1cnJlbnRFcnJvciA9ICRzY29wZS5zaG93RXJyb3IoZmllbGRDb250cm9sbGVyLCBzdHJpcHBlZEVycm9yU3RyaW5nKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudEVycm9yQ29kZSA9IGVycm9yc1RvU2hvd0FzQXJyYXlbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93Q3VycmVudEVycm9yID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS5zaG93RXJyb3IgPSBmdW5jdGlvbihtb2RlbENvbnRyb2xsZXIsIGVycm9yQ29kZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gKCRzY29wZS5zdWJtaXR0ZWQgfHwgbW9kZWxDb250cm9sbGVyLiRkaXJ0eSkgJiYgbW9kZWxDb250cm9sbGVyLiRlcnJvcltlcnJvckNvZGVdICYmIG1vZGVsQ29udHJvbGxlci4kaW52YWxpZDtcclxuICAgICAgICB9O1xyXG4gICAgfSlcclxuXHJcbiAgICAvLyBFcnJvciBtYXBwZXIgZGlyZWN0aXZlIHRvIHNpbXBsaWZ5IHNob3dpbmcgZXJyb3JzIGZvciBpbnB1dCBmaWVsZHMgYW5kIGdldCByaWQgb2Ygc29tZVxyXG4gICAgLy8gYm9pbGVycGxhdGUgY29kZS5cclxuICAgIC8vXHJcbiAgICAvLyBVc2FnZTpcclxuICAgIC8vXHJcbiAgICAvLyA8aW5wdXQgbmFtZT1cIk1vbmV5XCIgbmctbW9kZWw9XCJpbnN0YW5jZS5NTVJBcnRpY2xlMTdRdWVzdGlvbm5haXJlLlRhYmxlMS5Nb25leVwiIHR5cGU9XCJ0ZXh0XCJcclxuICAgIC8vICAgICAgbmctcGF0dGVybj1cImRlY2ltYWxOdW1iZXJQYXR0ZXJuXCIgcmVxdWlyZWQvPlxyXG4gICAgLy8gPGRpdiBjbGFzcz1cImludmFsaWQtbXNnXCIgdGQtZXJyb3ItbWFwcGVyIHdhdGNoLWVsZW1lbnRzPSdbXCJUYWJsZTEuT3RoZXJEZXNjcmlwdGlvblwiXSdcclxuICAgIC8vICAgICAgd2F0Y2gtdmlldz1cIkZvcm0uSW5wdXROYW1lXCIgZXJyb3JzLXRvLXNob3c9J1tcInJlcXVpcmVkXCIsIFwicGF0dGVybl9kZWNpbWFsXCJdJz48L2Rpdj5cclxuICAgIC8vIC4uLlxyXG4gICAgLy8gV2hlcmUgPGRpdj4gd2l0aCAndGQtZXJyb3ItbWFwcGVyJyBhdHRyaWJ1dGUgaXMgdXNlZCBhcyBlcnJvciBkaXYgYW5kIGFsbCBmdW5jdGlvbmFsaXR5IGlzIGFwcGxpZWQuXHJcbiAgICAvL1xyXG4gICAgLy8gQ29uZmlndXJhdGlvbiBwYXJhbWV0ZXJzOlxyXG4gICAgLy8gdGQtZXJyb3ItbWFwcGVyIC0gaWRlbnRpZmllciBmb3IgZXJyb3IgbWFwcGVyIGFuZCBzY29wZSBwYXJhbWV0ZXIgd2F0Y2hlciBlLmcgdGQtZXJyb3ItbWFwcGVyPVwidXNlck5hbWVcIi4gV2hlbmV2ZXJcclxuICAgIC8vICAgICAgICAgICAgICAgICAgICRzY29wZS51c2VyTmFtZSBjaGFuZ2VzIGl0IGlzIHBpY2tlZCB1cCBieSBtYXBwZXIgYW5kIGNvcnJlY3QgZXJyb3IgaXMgc2hvd24gd2hlbiBpZGVudGlmaWVkLlxyXG4gICAgLy8gd2F0Y2gtdmlldyAgICAgIC0gVXNlZCB0byB3YXRjaCB2aWV3IHZhbHVlIG9mIHRoZSBmaWVsZC4gVXNlZnVsIGZvciB3YXRjaGluZyBudW1iZXIgZmllbGRzIGV0Yy4gd2hlbiBhY3R1YWwgc2NvcGVcclxuICAgIC8vICAgICAgICAgICAgICAgICAgIHZhbHVlIGRvZXMgbm90IGNoYW5nZSBvbiBpbnZhbGlkIGZpZWxkIHZhbHVlLlxyXG4gICAgLy8gICAgICAgICAgICAgICAgICAgU2hvdWxkIGJlIHVzZWQgYXMge0Zvcm1OYW1lfS57SW5wdXROYW1lfSBzbyBJbnB1dE5hbWUgY2FuIGJlIGV4dHJhY3RlZCB0byBnZXQgY29ycmVjdCBjb250cm9sbGVyLlxyXG4gICAgLy8gd2F0Y2gtZWxlbWVudHMgIC0gQXJyYXkgb2Ygc3RyaW5nIHRoYXQgaXMgcGFyc2VkIGFuZCByZWdpc3RlcmVkIGZvciB3YXRjaGluZy4gV2hlbmV2ZXIgJ1RhYmxlMS5PdGhlckRlc2NyaXB0aW9uJ1xyXG4gICAgLy8gICAgICAgICAgICAgICAgICAgY2hhbmdlcyB0aGVuIHBhcnNlIGZ1bmN0aW9uIGlzIGNhbGxlZCBhbmQgY29ycmVjdCBlcnJvcnMgc2hvdyBmb3IgY3VycmVudCBpbnB1dC5cclxuICAgIC8vIGVycm9ycy10by1zaG93ICAtIEVycm9ycyB0byBiZSBzaG93biBhcyBhcnJheS4gVGhpcyBzdHJpbmcgaXMgcGFyc2VkIGFuZCBlcnJvcnMgYXJlIHNob3duIGluIHRoZSBzYW1lIG9yZGVyXHJcbiAgICAvLyAgICAgICAgICAgICAgICAgICBhcyBhcnJheS4gTmFtZXMgY2FuIGJlIHVzZWQgZm9yIGRpZmZlcmVudCBraW5kIG9mIG1lc3NhZ2VzIGFzIGZvbGxvd3MgZS5nIFwicGF0dGVybl9kZWNpbWFsXCJcclxuICAgIC8vICAgICAgICAgICAgICAgICAgIG1lYW5zIGVycm9yIHR5cGUgaXMgcGF0dGVybiBhbmQgbWVzc2FnZSB0eXBlIGRlY2ltYWwuIEZpcnN0IHBhcnQgaXMgZXh0cmFjdGVkIHVzZWQgdG9nZXRoZXIgd2l0aFxyXG4gICAgLy8gICAgICAgICAgICAgICAgICAgYW5ndWxhciBuZy1wYXR0ZXJuIGRpcmVjdGl2ZSB0byBnZXQgY29ycmVjdCByZXN1bHQuXHJcbiAgICAuZGlyZWN0aXZlKCdlcnJvck1hcHBlcicsZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgICAgIHJlcXVpcmU6ICc/XmZvcm0nLFxyXG4gICAgICAgICAgICBzY29wZTogdHJ1ZSxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0Vycm9yQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPHNwYW4gbmctc2hvdz1cXFwic2hvd0N1cnJlbnRFcnJvclxcXCI+e3tnZXRFcnJvck1lc3NhZ2UoY3VycmVudEVycm9yQ29kZSl9fTwvc3Bhbj4nLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIGN0cmwpIHtcclxuICAgICAgICAgICAgICAgIGlmICghYXR0cnMud2F0Y2hWaWV3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKGF0dHJzLmVycm9yTWFwcGVyLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUucGFyc2VFcnJvcnMoY3RybCwgYXR0cnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goYXR0cnMud2F0Y2hWaWV3ICsgXCIuJHZpZXdWYWx1ZVwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUucGFyc2VFcnJvcnMoY3RybCwgYXR0cnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaCgnc3VibWl0dGVkJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUucGFyc2VFcnJvcnMoY3RybCwgYXR0cnMpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy9Gb3Igd2F0Y2hpbmcgb3RoZXIgdmFsdWVzIHRoYXQgdGhpcyBlcnJvciBkZXBlbmRzIG9uXHJcbiAgICAgICAgICAgICAgICBpZiAoYXR0cnMud2F0Y2hFbGVtZW50cykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB3YXRjaEFycmF5ID0gSlNPTi5wYXJzZShhdHRycy53YXRjaEVsZW1lbnRzKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHdhdGNoQXJyYXkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKHdhdGNoQXJyYXlbaV0gKyBcIi4kdmlld1ZhbHVlXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUucGFyc2VFcnJvcnMoY3RybCwgYXR0cnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSkiLCIvKipcclxuICogQ3JlYXRlZCBieSBhcmdvYWF2YSBvbiAyMi4wNC4xNC5cclxuICovXHJcblxyXG4vLyBNb2R1bGUgdGhhdCBwcm92aWRlcyBsYW5ndWFnZSBjaGFuZ2luZyBmdW5jdGlvbmFsaXR5IHRvIHdlYmZvcm0uXHJcbi8vXHJcbi8vIE1vZHVsZSBuZWVkcyBjb25maWd1cmF0aW9uIGFuZCA8ZGl2IHRkLWxhbmd1YWdlLWNoYW5nZXI+PC9kaXY+IG9yIDx0ZC1sYW5ndWFnZS1jaGFuZ2VyLz4gdGFncy5cclxuLy8gdGQtbGFuZ3VhZ2UtY2hhbmdlciBjb21wb25lbnQgaXMgcmVwbGFjZWQgd2l0aCBsYW5ndWFnZSBzZWxlY3QgaW5wdXQgdGhhdCBpcyBjb25maWd1cmVkIHRvIHVzZVxyXG4vLyBwcmUtY29uZmlndXJlZCB2YWx1ZXMuXHJcbi8vXHJcbi8vIEV4YW1wbGUgY29uZmlndXJhdGlvbiBvZiBsYW5ndWFnZUNoYW5nZXJcclxuLy9cclxuLy8gYXBwLmNvbmZpZyhbXCJsYW5ndWFnZUNoYW5nZXJQcm92aWRlclwiLCBmdW5jdGlvbihsYW5ndWFnZUNoYW5nZXJQcm92aWRlcikge1xyXG4vLyAgICBsYW5ndWFnZUNoYW5nZXJQcm92aWRlci5zZXREZWZhdWx0TGFuZ3VhZ2UoJ2VuJyk7XHJcbi8vICAgIGxhbmd1YWdlQ2hhbmdlclByb3ZpZGVyLnNldExhbmd1YWdlRmlsZVByZWZpeCgnZW4tbGFiZWxzLScpO1xyXG4vLyAgICBsYW5ndWFnZUNoYW5nZXJQcm92aWRlci5zZXRBdmFpbGFibGVMYW5ndWFnZXMoe1wiaXRlbVwiIDpbe1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwiYmdcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCLQkdGK0LvQs9Cw0YDRgdC60LggKGJnKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwiY3NcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCLEjWXFoXRpbmEgKGNzKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwiaHJcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJIcnZhdHNraSAoaHIpXCJ9LCB7XHJcbi8vICAgICAgICBcImNvZGVcIjogXCJkYVwiLFxyXG4vLyAgICAgICAgXCJsYWJlbFwiOiBcIkRhbnNrIChkYSlcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcIm5sXCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiTmVkZXJsYW5kcyAobmwpXCJ9LCB7XHJcbi8vICAgICAgICBcImNvZGVcIjogXCJlbFwiLFxyXG4vLyAgICAgICAgXCJsYWJlbFwiOiBcIs61zrvOu863zr3Ouc66zqwgKGVsKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwiZW5cIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJFbmdsaXNoIChlbilcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcImV0XCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiRWVzdGkgKGV0KVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwiZmlcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJTdW9taSAoZmkpXCJ9LCB7XHJcbi8vICAgICAgICBcImNvZGVcIjogXCJmclwiLFxyXG4vLyAgICAgICAgXCJsYWJlbFwiOiBcIkZyYW7Dp2FpcyAoZnIpXCJ9LCB7XHJcbi8vICAgICAgICBcImNvZGVcIjogXCJkZVwiLFxyXG4vLyAgICAgICAgXCJsYWJlbFwiOiBcIkRldXRzY2ggKGRlKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwiaHVcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJNYWd5YXIgKGh1KVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwiaXNcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCLDjXNsZW5za2EgKGlzKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwiaXRcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJJdGFsaWFubyAoaXQpXCJ9LCB7XHJcbi8vICAgICAgICBcImNvZGVcIjogXCJsdlwiLFxyXG4vLyAgICAgICAgXCJsYWJlbFwiOiBcIkxhdHZpZcWhdSAobHYpXCJ9LCB7XHJcbi8vICAgICAgICBcImNvZGVcIjogXCJsdFwiLFxyXG4vLyAgICAgICAgXCJsYWJlbFwiOiBcIkxpZXR1dmnFsyAobHQpXCJ9LCB7XHJcbi8vICAgICAgICBcImNvZGVcIjogXCJtdFwiLFxyXG4vLyAgICAgICAgXCJsYWJlbFwiOiBcIk1hbHRpIChtdClcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcIm5vXCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiTm9yc2sgKG5vKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwicGxcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJQb2xza2kgKHBsKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwicHRcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJQb3J0dWd1w6pzIChwdClcIn0sIHtcclxuLy8gICAgICAgIFwiY29kZVwiOiBcInJvXCIsXHJcbi8vICAgICAgICBcImxhYmVsXCI6IFwiUm9tw6JuxIMgKHJvKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwic2tcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJTbG92ZW7EjWluYSAoc2spXCJ9LCB7XHJcbi8vICAgICAgICBcImNvZGVcIjogXCJzbFwiLFxyXG4vLyAgICAgICAgXCJsYWJlbFwiOiBcIlNsb3ZlbsWhxI1pbmEgKHNsKVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwiZXNcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJFc3Bhw7FvbCAoZXMpXCJ9LCB7XHJcbi8vICAgICAgICBcImNvZGVcIjogXCJzdlwiLFxyXG4vLyAgICAgICAgXCJsYWJlbFwiOiBcIlN2ZW5za2EgKHN2KVwifSwge1xyXG4vLyAgICAgICAgXCJjb2RlXCI6IFwidHJcIixcclxuLy8gICAgICAgIFwibGFiZWxcIjogXCJUw7xya8OnZSAodHIpXCJ9XX0pXHJcbi8vfV0pO1xyXG5cclxuXHJcbmFuZ3VsYXIubW9kdWxlKCd0cmFuc2xhdGUubGFuZ3VhZ2VDaGFuZ2VyJywgWydwYXNjYWxwcmVjaHQudHJhbnNsYXRlJ10pXHJcbiAgICAuZmFjdG9yeSgnY3VzdG9tTG9hZGVyJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRodHRwLCAkcSwgbGFuZ3VhZ2VDaGFuZ2VyKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIWxhbmd1YWdlQ2hhbmdlci5nZXRMYW5ndWFnZUZpbGVQcmVmaXgoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTGFuZ3VhZ2UgZmlsZSBwcmVmaXggbXVzdCBiZSBkZWZpbmVkIHdoZW4gdXNpbmcgbGFuZ3VhZ2VDaGFuZ2VyIGNvbXBvbmVudC5cIik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBsYW5ndWFnZVVybCA9IGxhbmd1YWdlQ2hhbmdlci5nZXRMYW5ndWFnZUZpbGVQcmVmaXgoKSArIG9wdGlvbnMua2V5ICsgJy54bWw/Zm9ybWF0PWpzb24nO1xyXG5cclxuICAgICAgICAgICAgJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kOidHRVQnLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBsYW5ndWFnZVVybFxyXG4gICAgICAgICAgICB9LCB7dHJhY2tlciA6ICRyb290U2NvcGUubG9hZGluZ1RyYWNrZXJ9KVxyXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGRhdGEubGFiZWxzKTtcclxuICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KCdsYWJlbC0nICsgb3B0aW9ucy5rZXkgKyAnLmpzb24nICsnIHN1Y2Nlc3MnKTtcclxuICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3Qob3B0aW9ucy5rZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoJ2xhYmVsLScgKyBvcHRpb25zLmtleSArICcuanNvbicgKycgZXJyb3InKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy9hbGVydChvcHRpb25zLmtleSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgLnByb3ZpZGVyKCdsYW5ndWFnZUNoYW5nZXInLCBmdW5jdGlvbiBsYW5ndWFnZUNoYW5nZXJQcm92aWRlcigpIHtcclxuXHJcbiAgICAgICAgdGhpcy5jdXJyZW50TGFuZ3VhZ2UgPSAnZW4nO1xyXG4gICAgICAgIHRoaXMuYXZhaWxhYmxlTGFuZ3VhZ2VzID0gW107XHJcbiAgICAgICAgdGhpcy5sYW5ndWFnZUZpbGVQcmVmaXggPSAnJztcclxuXHJcbiAgICAgICAgdGhpcy5zZXREZWZhdWx0TGFuZ3VhZ2UgPSBmdW5jdGlvbihkZWZhdWx0TGFuZ3VhZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50TGFuZ3VhZ2UgPSBkZWZhdWx0TGFuZ3VhZ2U7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRMYW5ndWFnZUZpbGVQcmVmaXggPSBmdW5jdGlvbihwcmVmaXgpIHtcclxuICAgICAgICAgICAgdGhpcy5sYW5ndWFnZUZpbGVQcmVmaXggPSBwcmVmaXg7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRBdmFpbGFibGVMYW5ndWFnZXMgPSBmdW5jdGlvbihhdmFpbGFibGVMYW5ndWFnZXMpIHtcclxuICAgICAgICAgICAgdGhpcy5hdmFpbGFibGVMYW5ndWFnZXMgPSBhdmFpbGFibGVMYW5ndWFnZXM7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhdmFpbGFibGVMYW5ndWFnZXMgPSB0aGlzLmF2YWlsYWJsZUxhbmd1YWdlcztcclxuICAgICAgICAgICAgdmFyIGN1cnJlbnRMYW5ndWFnZSA9IHRoaXMuY3VycmVudExhbmd1YWdlO1xyXG4gICAgICAgICAgICB2YXIgcHJlZml4ID0gdGhpcy5sYW5ndWFnZUZpbGVQcmVmaXg7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBnZXRMYW5ndWFnZSA6IGZ1bmN0aW9uKCkge3JldHVybiBjdXJyZW50TGFuZ3VhZ2U7fSxcclxuICAgICAgICAgICAgICAgIHNldExhbmd1YWdlIDogZnVuY3Rpb24obmV3TGFuZ3VhZ2UpIHtjdXJyZW50TGFuZ3VhZ2UgPSBuZXdMYW5ndWFnZTt9LFxyXG4gICAgICAgICAgICAgICAgZ2V0QXZhaWxhYmxlTGFuZ3VhZ2VzIDogZnVuY3Rpb24oKSB7cmV0dXJuIGF2YWlsYWJsZUxhbmd1YWdlczt9LFxyXG4gICAgICAgICAgICAgICAgZ2V0TGFuZ3VhZ2VGaWxlUHJlZml4IDogZnVuY3Rpb24oKSB7cmV0dXJuIHByZWZpeDt9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSlcclxuXHJcbiAgICAuY29uZmlnKCBmdW5jdGlvbiAoJHRyYW5zbGF0ZVByb3ZpZGVyKSB7XHJcbiAgICAgICAgJHRyYW5zbGF0ZVByb3ZpZGVyLnVzZUxvYWRlcignY3VzdG9tTG9hZGVyJywge30pO1xyXG4gICAgICAgIC8vIGxvYWQgJ2VuJyB0YWJsZSBvbiBzdGFydHVwXHJcbiAgICAgICAgJHRyYW5zbGF0ZVByb3ZpZGVyLnByZWZlcnJlZExhbmd1YWdlKCdlbicpO1xyXG4gICAgfSlcclxuXHJcbiAgICAuY29udHJvbGxlcignTGFuZ3VhZ2VDdHJsJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICckdHJhbnNsYXRlJywgJ2xhbmd1YWdlQ2hhbmdlcicsICdkYXRhUmVwb3NpdG9yeScsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsICR0cmFuc2xhdGUsIGxhbmd1YWdlQ2hhbmdlciwgZGF0YVJlcG9zaXRvcnkpIHtcclxuXHJcbiAgICAgICAgJHNjb3BlLmN1cnJlbnRMYW5ndWFnZSA9IGxhbmd1YWdlQ2hhbmdlci5nZXRMYW5ndWFnZSgpO1xyXG4gICAgICAgICRzY29wZS5hdmFpbGFibGVMYW5ndWFnZXMgPSBsYW5ndWFnZUNoYW5nZXIuZ2V0QXZhaWxhYmxlTGFuZ3VhZ2VzKCk7XHJcblxyXG4gICAgICAgICRzY29wZS5jaGFuZ2VMYW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBsYW5ndWFnZUNoYW5nZXIuc2V0TGFuZ3VhZ2UoJHNjb3BlLmN1cnJlbnRMYW5ndWFnZSlcclxuICAgICAgICAgICAgJHRyYW5zbGF0ZS51c2UobGFuZ3VhZ2VDaGFuZ2VyLmdldExhbmd1YWdlKCkpO1xyXG4gICAgICAgICAgICBkYXRhUmVwb3NpdG9yeS5sb2FkQ29kZUxpc3QobGFuZ3VhZ2VDaGFuZ2VyLmdldExhbmd1YWdlKCkpO1xyXG4gICAgICAgICAgICBpZiAobGFuZ3VhZ2VDaGFuZ2VyLmdldExhbmd1YWdlKCkgIT0gJHJvb3RTY29wZS5jdXJyZW50TGFuZ3VhZ2UpIHtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudExhbmd1YWdlID0gbGFuZ3VhZ2VDaGFuZ2VyLmdldExhbmd1YWdlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHJvb3RTY29wZS4kd2F0Y2goJ2N1cnJlbnRMYW5ndWFnZScsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xyXG4gICAgICAgICAgICBpZiAoIW5ld1ZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW9sZFZhbHVlIHx8IChsYW5ndWFnZUNoYW5nZXIuZ2V0TGFuZ3VhZ2UoKSAhPSAkcm9vdFNjb3BlLmN1cnJlbnRMYW5ndWFnZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudExhbmd1YWdlID0gJHJvb3RTY29wZS5jdXJyZW50TGFuZ3VhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5nZUxhbmcoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XSlcclxuXHJcbiAgICAuZGlyZWN0aXZlKFwibGFuZ3VhZ2VDaGFuZ2VyXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTGFuZ3VhZ2VDdHJsJyxcclxuICAgICAgICAgICAgdGVtcGxhdGU6IFwiPGRpdiBuZy1zaG93PVxcXCJhdmFpbGFibGVMYW5ndWFnZXMuaXRlbS5sZW5ndGggPiAwXFxcIiBjbGFzcz1cXFwic3BhbjJcXFwiIG5nLWNvbnRyb2xsZXI9XFxcIkxhbmd1YWdlQ3RybFxcXCIgc3R5bGU9XFxcImZsb2F0OiByaWdodDtcXFwiPjxzZWxlY3QgbmFtZT1cXFwiRm9ybUxhbmd1YWdlXFxcIiBjbGFzcz1cXFwiaW5wdXQtbWVkaXVtXFxcIiBuZy1tb2RlbD1cXFwiY3VycmVudExhbmd1YWdlXFxcIiBuZy1vcHRpb25zPVxcXCJsYW5ndWFnZS5jb2RlIGFzIGxhbmd1YWdlLmxhYmVsIGZvciBsYW5ndWFnZSBpbiBhdmFpbGFibGVMYW5ndWFnZXMuaXRlbVxcXCIgbmctY2hhbmdlPVxcXCJjaGFuZ2VMYW5nKClcXFwiPjwvc2VsZWN0PjwvZGl2PlwiXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuIiwiYW5ndWxhci5tb2R1bGUoJ3Bhc2NhbHByZWNodC50cmFuc2xhdGUnKS5mYWN0b3J5KCckdHJhbnNsYXRlU3RhdGljRmlsZXNMb2FkZXInLCBbXG4gICckcScsXG4gICckaHR0cCcsXG4gIGZ1bmN0aW9uICgkcSwgJGh0dHApIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgIGlmICghb3B0aW9ucyB8fCAoIWFuZ3VsYXIuaXNTdHJpbmcob3B0aW9ucy5wcmVmaXgpIHx8ICFhbmd1bGFyLmlzU3RyaW5nKG9wdGlvbnMuc3VmZml4KSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZG5cXCd0IGxvYWQgc3RhdGljIGZpbGVzLCBubyBwcmVmaXggb3Igc3VmZml4IHNwZWNpZmllZCEnKTtcbiAgICAgIH1cbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAkaHR0cCh7XG4gICAgICAgIHVybDogW1xuICAgICAgICAgIG9wdGlvbnMucHJlZml4LFxuICAgICAgICAgIG9wdGlvbnMua2V5LFxuICAgICAgICAgIG9wdGlvbnMuc3VmZml4XG4gICAgICAgIF0uam9pbignJyksXG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIHBhcmFtczogJydcbiAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShkYXRhKTtcbiAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGRlZmVycmVkLnJlamVjdChvcHRpb25zLmtleSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgIH07XG4gIH1cbl0pOyIsImFuZ3VsYXIubW9kdWxlKCdwYXNjYWxwcmVjaHQudHJhbnNsYXRlJywgWyduZyddKS5ydW4oW1xuICAnJHRyYW5zbGF0ZScsXG4gIGZ1bmN0aW9uICgkdHJhbnNsYXRlKSB7XG4gICAgdmFyIGtleSA9ICR0cmFuc2xhdGUuc3RvcmFnZUtleSgpLCBzdG9yYWdlID0gJHRyYW5zbGF0ZS5zdG9yYWdlKCk7XG4gICAgaWYgKHN0b3JhZ2UpIHtcbiAgICAgIGlmICghc3RvcmFnZS5nZXQoa2V5KSkge1xuICAgICAgICBpZiAoYW5ndWxhci5pc1N0cmluZygkdHJhbnNsYXRlLnByZWZlcnJlZExhbmd1YWdlKCkpKSB7XG4gICAgICAgICAgJHRyYW5zbGF0ZS51c2UoJHRyYW5zbGF0ZS5wcmVmZXJyZWRMYW5ndWFnZSgpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdG9yYWdlLnNldChrZXksICR0cmFuc2xhdGUudXNlKCkpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkdHJhbnNsYXRlLnVzZShzdG9yYWdlLmdldChrZXkpKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGFuZ3VsYXIuaXNTdHJpbmcoJHRyYW5zbGF0ZS5wcmVmZXJyZWRMYW5ndWFnZSgpKSkge1xuICAgICAgJHRyYW5zbGF0ZS51c2UoJHRyYW5zbGF0ZS5wcmVmZXJyZWRMYW5ndWFnZSgpKTtcbiAgICB9XG4gIH1cbl0pO1xuYW5ndWxhci5tb2R1bGUoJ3Bhc2NhbHByZWNodC50cmFuc2xhdGUnKS5wcm92aWRlcignJHRyYW5zbGF0ZScsIFtcbiAgJyRTVE9SQUdFX0tFWScsXG4gIGZ1bmN0aW9uICgkU1RPUkFHRV9LRVkpIHtcbiAgICB2YXIgJHRyYW5zbGF0aW9uVGFibGUgPSB7fSwgJHByZWZlcnJlZExhbmd1YWdlLCAkYXZhaWxhYmxlTGFuZ3VhZ2VLZXlzID0gW10sICRsYW5ndWFnZUtleUFsaWFzZXMsICRmYWxsYmFja0xhbmd1YWdlLCAkZmFsbGJhY2tXYXNTdHJpbmcsICR1c2VzLCAkbmV4dExhbmcsICRzdG9yYWdlRmFjdG9yeSwgJHN0b3JhZ2VLZXkgPSAkU1RPUkFHRV9LRVksICRzdG9yYWdlUHJlZml4LCAkbWlzc2luZ1RyYW5zbGF0aW9uSGFuZGxlckZhY3RvcnksICRpbnRlcnBvbGF0aW9uRmFjdG9yeSwgJGludGVycG9sYXRvckZhY3RvcmllcyA9IFtdLCAkaW50ZXJwb2xhdGlvblNhbml0aXphdGlvblN0cmF0ZWd5ID0gZmFsc2UsICRsb2FkZXJGYWN0b3J5LCAkY2xvYWtDbGFzc05hbWUgPSAndHJhbnNsYXRlLWNsb2FrJywgJGxvYWRlck9wdGlvbnMsICRub3RGb3VuZEluZGljYXRvckxlZnQsICRub3RGb3VuZEluZGljYXRvclJpZ2h0LCAkcG9zdENvbXBpbGluZ0VuYWJsZWQgPSBmYWxzZSwgTkVTVEVEX09CSkVDVF9ERUxJTUlURVIgPSAnLic7XG4gICAgdmFyIGdldExvY2FsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBuYXYgPSB3aW5kb3cubmF2aWdhdG9yO1xuICAgICAgcmV0dXJuIChuYXYubGFuZ3VhZ2UgfHwgbmF2LmJyb3dzZXJMYW5ndWFnZSB8fCBuYXYuc3lzdGVtTGFuZ3VhZ2UgfHwgbmF2LnVzZXJMYW5ndWFnZSB8fCAnJykuc3BsaXQoJy0nKS5qb2luKCdfJyk7XG4gICAgfTtcbiAgICB2YXIgbmVnb3RpYXRlTG9jYWxlID0gZnVuY3Rpb24gKHByZWZlcnJlZCkge1xuICAgICAgdmFyIGF2YWlsID0gW10sIGxvY2FsZSA9IGFuZ3VsYXIubG93ZXJjYXNlKHByZWZlcnJlZCksIGkgPSAwLCBuID0gJGF2YWlsYWJsZUxhbmd1YWdlS2V5cy5sZW5ndGg7XG4gICAgICBmb3IgKDsgaSA8IG47IGkrKykge1xuICAgICAgICBhdmFpbC5wdXNoKGFuZ3VsYXIubG93ZXJjYXNlKCRhdmFpbGFibGVMYW5ndWFnZUtleXNbaV0pKTtcbiAgICAgIH1cbiAgICAgIGlmIChhdmFpbC5pbmRleE9mKGxvY2FsZSkgPiAtMSkge1xuICAgICAgICByZXR1cm4gbG9jYWxlO1xuICAgICAgfVxuICAgICAgaWYgKCRsYW5ndWFnZUtleUFsaWFzZXMpIHtcbiAgICAgICAgaWYgKCRsYW5ndWFnZUtleUFsaWFzZXNbcHJlZmVycmVkXSkge1xuICAgICAgICAgIHZhciBhbGlhcyA9ICRsYW5ndWFnZUtleUFsaWFzZXNbcHJlZmVycmVkXTtcbiAgICAgICAgICBpZiAoYXZhaWwuaW5kZXhPZihhbmd1bGFyLmxvd2VyY2FzZShhbGlhcykpID4gLTEpIHtcbiAgICAgICAgICAgIHJldHVybiBhbGlhcztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciBwYXJ0cyA9IHByZWZlcnJlZC5zcGxpdCgnXycpO1xuICAgICAgaWYgKHBhcnRzLmxlbmd0aCA+IDEgJiYgYXZhaWwuaW5kZXhPZihhbmd1bGFyLmxvd2VyY2FzZShwYXJ0c1swXSkpID4gMSkge1xuICAgICAgICByZXR1cm4gcGFydHNbMF07XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgdHJhbnNsYXRpb25zID0gZnVuY3Rpb24gKGxhbmdLZXksIHRyYW5zbGF0aW9uVGFibGUpIHtcbiAgICAgIGlmICghbGFuZ0tleSAmJiAhdHJhbnNsYXRpb25UYWJsZSkge1xuICAgICAgICByZXR1cm4gJHRyYW5zbGF0aW9uVGFibGU7XG4gICAgICB9XG4gICAgICBpZiAobGFuZ0tleSAmJiAhdHJhbnNsYXRpb25UYWJsZSkge1xuICAgICAgICBpZiAoYW5ndWxhci5pc1N0cmluZyhsYW5nS2V5KSkge1xuICAgICAgICAgIHJldHVybiAkdHJhbnNsYXRpb25UYWJsZVtsYW5nS2V5XTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzT2JqZWN0KCR0cmFuc2xhdGlvblRhYmxlW2xhbmdLZXldKSkge1xuICAgICAgICAgICR0cmFuc2xhdGlvblRhYmxlW2xhbmdLZXldID0ge307XG4gICAgICAgIH1cbiAgICAgICAgYW5ndWxhci5leHRlbmQoJHRyYW5zbGF0aW9uVGFibGVbbGFuZ0tleV0sIGZsYXRPYmplY3QodHJhbnNsYXRpb25UYWJsZSkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLnRyYW5zbGF0aW9ucyA9IHRyYW5zbGF0aW9ucztcbiAgICB0aGlzLmNsb2FrQ2xhc3NOYW1lID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgIGlmICghbmFtZSkge1xuICAgICAgICByZXR1cm4gJGNsb2FrQ2xhc3NOYW1lO1xuICAgICAgfVxuICAgICAgJGNsb2FrQ2xhc3NOYW1lID0gbmFtZTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdmFyIGZsYXRPYmplY3QgPSBmdW5jdGlvbiAoZGF0YSwgcGF0aCwgcmVzdWx0LCBwcmV2S2V5KSB7XG4gICAgICB2YXIga2V5LCBrZXlXaXRoUGF0aCwga2V5V2l0aFNob3J0UGF0aCwgdmFsO1xuICAgICAgaWYgKCFwYXRoKSB7XG4gICAgICAgIHBhdGggPSBbXTtcbiAgICAgIH1cbiAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJlc3VsdCA9IHt9O1xuICAgICAgfVxuICAgICAgZm9yIChrZXkgaW4gZGF0YSkge1xuICAgICAgICBpZiAoIWRhdGEuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhbCA9IGRhdGFba2V5XTtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNPYmplY3QodmFsKSkge1xuICAgICAgICAgIGZsYXRPYmplY3QodmFsLCBwYXRoLmNvbmNhdChrZXkpLCByZXN1bHQsIGtleSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAga2V5V2l0aFBhdGggPSBwYXRoLmxlbmd0aCA/ICcnICsgcGF0aC5qb2luKE5FU1RFRF9PQkpFQ1RfREVMSU1JVEVSKSArIE5FU1RFRF9PQkpFQ1RfREVMSU1JVEVSICsga2V5IDoga2V5O1xuICAgICAgICAgIGlmIChwYXRoLmxlbmd0aCAmJiBrZXkgPT09IHByZXZLZXkpIHtcbiAgICAgICAgICAgIGtleVdpdGhTaG9ydFBhdGggPSAnJyArIHBhdGguam9pbihORVNURURfT0JKRUNUX0RFTElNSVRFUik7XG4gICAgICAgICAgICByZXN1bHRba2V5V2l0aFNob3J0UGF0aF0gPSAnQDonICsga2V5V2l0aFBhdGg7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJlc3VsdFtrZXlXaXRoUGF0aF0gPSB2YWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICB0aGlzLmFkZEludGVycG9sYXRpb24gPSBmdW5jdGlvbiAoZmFjdG9yeSkge1xuICAgICAgJGludGVycG9sYXRvckZhY3Rvcmllcy5wdXNoKGZhY3RvcnkpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLnVzZU1lc3NhZ2VGb3JtYXRJbnRlcnBvbGF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMudXNlSW50ZXJwb2xhdGlvbignJHRyYW5zbGF0ZU1lc3NhZ2VGb3JtYXRJbnRlcnBvbGF0aW9uJyk7XG4gICAgfTtcbiAgICB0aGlzLnVzZUludGVycG9sYXRpb24gPSBmdW5jdGlvbiAoZmFjdG9yeSkge1xuICAgICAgJGludGVycG9sYXRpb25GYWN0b3J5ID0gZmFjdG9yeTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy51c2VTYW5pdGl6ZVZhbHVlU3RyYXRlZ3kgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICRpbnRlcnBvbGF0aW9uU2FuaXRpemF0aW9uU3RyYXRlZ3kgPSB2YWx1ZTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy5wcmVmZXJyZWRMYW5ndWFnZSA9IGZ1bmN0aW9uIChsYW5nS2V5KSB7XG4gICAgICBpZiAobGFuZ0tleSkge1xuICAgICAgICAkcHJlZmVycmVkTGFuZ3VhZ2UgPSBsYW5nS2V5O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cbiAgICAgIHJldHVybiAkcHJlZmVycmVkTGFuZ3VhZ2U7XG4gICAgfTtcbiAgICB0aGlzLnRyYW5zbGF0aW9uTm90Rm91bmRJbmRpY2F0b3IgPSBmdW5jdGlvbiAoaW5kaWNhdG9yKSB7XG4gICAgICB0aGlzLnRyYW5zbGF0aW9uTm90Rm91bmRJbmRpY2F0b3JMZWZ0KGluZGljYXRvcik7XG4gICAgICB0aGlzLnRyYW5zbGF0aW9uTm90Rm91bmRJbmRpY2F0b3JSaWdodChpbmRpY2F0b3IpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLnRyYW5zbGF0aW9uTm90Rm91bmRJbmRpY2F0b3JMZWZ0ID0gZnVuY3Rpb24gKGluZGljYXRvcikge1xuICAgICAgaWYgKCFpbmRpY2F0b3IpIHtcbiAgICAgICAgcmV0dXJuICRub3RGb3VuZEluZGljYXRvckxlZnQ7XG4gICAgICB9XG4gICAgICAkbm90Rm91bmRJbmRpY2F0b3JMZWZ0ID0gaW5kaWNhdG9yO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLnRyYW5zbGF0aW9uTm90Rm91bmRJbmRpY2F0b3JSaWdodCA9IGZ1bmN0aW9uIChpbmRpY2F0b3IpIHtcbiAgICAgIGlmICghaW5kaWNhdG9yKSB7XG4gICAgICAgIHJldHVybiAkbm90Rm91bmRJbmRpY2F0b3JSaWdodDtcbiAgICAgIH1cbiAgICAgICRub3RGb3VuZEluZGljYXRvclJpZ2h0ID0gaW5kaWNhdG9yO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLmZhbGxiYWNrTGFuZ3VhZ2UgPSBmdW5jdGlvbiAobGFuZ0tleSkge1xuICAgICAgZmFsbGJhY2tTdGFjayhsYW5nS2V5KTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdmFyIGZhbGxiYWNrU3RhY2sgPSBmdW5jdGlvbiAobGFuZ0tleSkge1xuICAgICAgaWYgKGxhbmdLZXkpIHtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNTdHJpbmcobGFuZ0tleSkpIHtcbiAgICAgICAgICAkZmFsbGJhY2tXYXNTdHJpbmcgPSB0cnVlO1xuICAgICAgICAgICRmYWxsYmFja0xhbmd1YWdlID0gW2xhbmdLZXldO1xuICAgICAgICB9IGVsc2UgaWYgKGFuZ3VsYXIuaXNBcnJheShsYW5nS2V5KSkge1xuICAgICAgICAgICRmYWxsYmFja1dhc1N0cmluZyA9IGZhbHNlO1xuICAgICAgICAgICRmYWxsYmFja0xhbmd1YWdlID0gbGFuZ0tleTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5ndWxhci5pc1N0cmluZygkcHJlZmVycmVkTGFuZ3VhZ2UpKSB7XG4gICAgICAgICAgJGZhbGxiYWNrTGFuZ3VhZ2UucHVzaCgkcHJlZmVycmVkTGFuZ3VhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCRmYWxsYmFja1dhc1N0cmluZykge1xuICAgICAgICAgIHJldHVybiAkZmFsbGJhY2tMYW5ndWFnZVswXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gJGZhbGxiYWNrTGFuZ3VhZ2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMudXNlID0gZnVuY3Rpb24gKGxhbmdLZXkpIHtcbiAgICAgIGlmIChsYW5nS2V5KSB7XG4gICAgICAgIGlmICghJHRyYW5zbGF0aW9uVGFibGVbbGFuZ0tleV0gJiYgISRsb2FkZXJGYWN0b3J5KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCckdHJhbnNsYXRlUHJvdmlkZXIgY291bGRuXFwndCBmaW5kIHRyYW5zbGF0aW9uVGFibGUgZm9yIGxhbmdLZXk6IFxcJycgKyBsYW5nS2V5ICsgJ1xcJycpO1xuICAgICAgICB9XG4gICAgICAgICR1c2VzID0gbGFuZ0tleTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG4gICAgICByZXR1cm4gJHVzZXM7XG4gICAgfTtcbiAgICB2YXIgc3RvcmFnZUtleSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIGlmICgha2V5KSB7XG4gICAgICAgIGlmICgkc3RvcmFnZVByZWZpeCkge1xuICAgICAgICAgIHJldHVybiAkc3RvcmFnZVByZWZpeCArICRzdG9yYWdlS2V5O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAkc3RvcmFnZUtleTtcbiAgICAgIH1cbiAgICAgICRzdG9yYWdlS2V5ID0ga2V5O1xuICAgIH07XG4gICAgdGhpcy5zdG9yYWdlS2V5ID0gc3RvcmFnZUtleTtcbiAgICB0aGlzLnVzZVVybExvYWRlciA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgIHJldHVybiB0aGlzLnVzZUxvYWRlcignJHRyYW5zbGF0ZVVybExvYWRlcicsIHsgdXJsOiB1cmwgfSk7XG4gICAgfTtcbiAgICB0aGlzLnVzZVN0YXRpY0ZpbGVzTG9hZGVyID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgIHJldHVybiB0aGlzLnVzZUxvYWRlcignJHRyYW5zbGF0ZVN0YXRpY0ZpbGVzTG9hZGVyJywgb3B0aW9ucyk7XG4gICAgfTtcbiAgICB0aGlzLnVzZUxvYWRlciA9IGZ1bmN0aW9uIChsb2FkZXJGYWN0b3J5LCBvcHRpb25zKSB7XG4gICAgICAkbG9hZGVyRmFjdG9yeSA9IGxvYWRlckZhY3Rvcnk7XG4gICAgICAkbG9hZGVyT3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHRoaXMudXNlTG9jYWxTdG9yYWdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMudXNlU3RvcmFnZSgnJHRyYW5zbGF0ZUxvY2FsU3RvcmFnZScpO1xuICAgIH07XG4gICAgdGhpcy51c2VDb29raWVTdG9yYWdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMudXNlU3RvcmFnZSgnJHRyYW5zbGF0ZUNvb2tpZVN0b3JhZ2UnKTtcbiAgICB9O1xuICAgIHRoaXMudXNlU3RvcmFnZSA9IGZ1bmN0aW9uIChzdG9yYWdlRmFjdG9yeSkge1xuICAgICAgJHN0b3JhZ2VGYWN0b3J5ID0gc3RvcmFnZUZhY3Rvcnk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHRoaXMuc3RvcmFnZVByZWZpeCA9IGZ1bmN0aW9uIChwcmVmaXgpIHtcbiAgICAgIGlmICghcHJlZml4KSB7XG4gICAgICAgIHJldHVybiBwcmVmaXg7XG4gICAgICB9XG4gICAgICAkc3RvcmFnZVByZWZpeCA9IHByZWZpeDtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy51c2VNaXNzaW5nVHJhbnNsYXRpb25IYW5kbGVyTG9nID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMudXNlTWlzc2luZ1RyYW5zbGF0aW9uSGFuZGxlcignJHRyYW5zbGF0ZU1pc3NpbmdUcmFuc2xhdGlvbkhhbmRsZXJMb2cnKTtcbiAgICB9O1xuICAgIHRoaXMudXNlTWlzc2luZ1RyYW5zbGF0aW9uSGFuZGxlciA9IGZ1bmN0aW9uIChmYWN0b3J5KSB7XG4gICAgICAkbWlzc2luZ1RyYW5zbGF0aW9uSGFuZGxlckZhY3RvcnkgPSBmYWN0b3J5O1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLnVzZVBvc3RDb21waWxpbmcgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICRwb3N0Q29tcGlsaW5nRW5hYmxlZCA9ICEhdmFsdWU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHRoaXMuZGV0ZXJtaW5lUHJlZmVycmVkTGFuZ3VhZ2UgPSBmdW5jdGlvbiAoZm4pIHtcbiAgICAgIHZhciBsb2NhbGUgPSBmbiAmJiBhbmd1bGFyLmlzRnVuY3Rpb24oZm4pID8gZm4oKSA6IGdldExvY2FsZSgpO1xuICAgICAgaWYgKCEkYXZhaWxhYmxlTGFuZ3VhZ2VLZXlzLmxlbmd0aCkge1xuICAgICAgICAkcHJlZmVycmVkTGFuZ3VhZ2UgPSBsb2NhbGU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHByZWZlcnJlZExhbmd1YWdlID0gbmVnb3RpYXRlTG9jYWxlKGxvY2FsZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLnJlZ2lzdGVyQXZhaWxhYmxlTGFuZ3VhZ2VLZXlzID0gZnVuY3Rpb24gKGxhbmd1YWdlS2V5cywgYWxpYXNlcykge1xuICAgICAgaWYgKGxhbmd1YWdlS2V5cykge1xuICAgICAgICAkYXZhaWxhYmxlTGFuZ3VhZ2VLZXlzID0gbGFuZ3VhZ2VLZXlzO1xuICAgICAgICBpZiAoYWxpYXNlcykge1xuICAgICAgICAgICRsYW5ndWFnZUtleUFsaWFzZXMgPSBhbGlhc2VzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgICAgcmV0dXJuICRhdmFpbGFibGVMYW5ndWFnZUtleXM7XG4gICAgfTtcbiAgICB0aGlzLiRnZXQgPSBbXG4gICAgICAnJGxvZycsXG4gICAgICAnJGluamVjdG9yJyxcbiAgICAgICckcm9vdFNjb3BlJyxcbiAgICAgICckcScsXG4gICAgICBmdW5jdGlvbiAoJGxvZywgJGluamVjdG9yLCAkcm9vdFNjb3BlLCAkcSkge1xuICAgICAgICB2YXIgU3RvcmFnZSwgZGVmYXVsdEludGVycG9sYXRvciA9ICRpbmplY3Rvci5nZXQoJGludGVycG9sYXRpb25GYWN0b3J5IHx8ICckdHJhbnNsYXRlRGVmYXVsdEludGVycG9sYXRpb24nKSwgcGVuZGluZ0xvYWRlciA9IGZhbHNlLCBpbnRlcnBvbGF0b3JIYXNoTWFwID0ge30sIGxhbmdQcm9taXNlcyA9IHt9LCBmYWxsYmFja0luZGV4LCBzdGFydEZhbGxiYWNrSXRlcmF0aW9uO1xuICAgICAgICB2YXIgJHRyYW5zbGF0ZSA9IGZ1bmN0aW9uICh0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgaW50ZXJwb2xhdGlvbklkKSB7XG4gICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICB0cmFuc2xhdGlvbklkID0gdHJhbnNsYXRpb25JZC50cmltKCk7XG4gICAgICAgICAgdmFyIHByb21pc2VUb1dhaXRGb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHZhciBwcm9taXNlID0gJHByZWZlcnJlZExhbmd1YWdlID8gbGFuZ1Byb21pc2VzWyRwcmVmZXJyZWRMYW5ndWFnZV0gOiBsYW5nUHJvbWlzZXNbJHVzZXNdO1xuICAgICAgICAgICAgICBmYWxsYmFja0luZGV4ID0gMDtcbiAgICAgICAgICAgICAgaWYgKCRzdG9yYWdlRmFjdG9yeSAmJiAhcHJvbWlzZSkge1xuICAgICAgICAgICAgICAgIHZhciBsYW5nS2V5ID0gU3RvcmFnZS5nZXQoJHN0b3JhZ2VLZXkpO1xuICAgICAgICAgICAgICAgIHByb21pc2UgPSBsYW5nUHJvbWlzZXNbbGFuZ0tleV07XG4gICAgICAgICAgICAgICAgaWYgKCRmYWxsYmFja0xhbmd1YWdlICYmICRmYWxsYmFja0xhbmd1YWdlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gaW5kZXhPZigkZmFsbGJhY2tMYW5ndWFnZSwgbGFuZ0tleSk7XG4gICAgICAgICAgICAgICAgICBmYWxsYmFja0luZGV4ID0gaW5kZXggPiAtMSA/IGluZGV4ICs9IDEgOiAwO1xuICAgICAgICAgICAgICAgICAgJGZhbGxiYWNrTGFuZ3VhZ2UucHVzaCgkcHJlZmVycmVkTGFuZ3VhZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgICAgIH0oKTtcbiAgICAgICAgICBpZiAoIXByb21pc2VUb1dhaXRGb3IpIHtcbiAgICAgICAgICAgIGRldGVybWluZVRyYW5zbGF0aW9uKHRyYW5zbGF0aW9uSWQsIGludGVycG9sYXRlUGFyYW1zLCBpbnRlcnBvbGF0aW9uSWQpLnRoZW4oZGVmZXJyZWQucmVzb2x2ZSwgZGVmZXJyZWQucmVqZWN0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcHJvbWlzZVRvV2FpdEZvci50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgZGV0ZXJtaW5lVHJhbnNsYXRpb24odHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIGludGVycG9sYXRpb25JZCkudGhlbihkZWZlcnJlZC5yZXNvbHZlLCBkZWZlcnJlZC5yZWplY3QpO1xuICAgICAgICAgICAgfSwgZGVmZXJyZWQucmVqZWN0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBpbmRleE9mID0gZnVuY3Rpb24gKGFycmF5LCBzZWFyY2hFbGVtZW50KSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFycmF5Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoYXJyYXlbaV0gPT09IHNlYXJjaEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGFwcGx5Tm90Rm91bmRJbmRpY2F0b3JzID0gZnVuY3Rpb24gKHRyYW5zbGF0aW9uSWQpIHtcbiAgICAgICAgICBpZiAoJG5vdEZvdW5kSW5kaWNhdG9yTGVmdCkge1xuICAgICAgICAgICAgdHJhbnNsYXRpb25JZCA9IFtcbiAgICAgICAgICAgICAgJG5vdEZvdW5kSW5kaWNhdG9yTGVmdCxcbiAgICAgICAgICAgICAgdHJhbnNsYXRpb25JZFxuICAgICAgICAgICAgXS5qb2luKCcgJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICgkbm90Rm91bmRJbmRpY2F0b3JSaWdodCkge1xuICAgICAgICAgICAgdHJhbnNsYXRpb25JZCA9IFtcbiAgICAgICAgICAgICAgdHJhbnNsYXRpb25JZCxcbiAgICAgICAgICAgICAgJG5vdEZvdW5kSW5kaWNhdG9yUmlnaHRcbiAgICAgICAgICAgIF0uam9pbignICcpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdHJhbnNsYXRpb25JZDtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHVzZUxhbmd1YWdlID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICR1c2VzID0ga2V5O1xuICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJyR0cmFuc2xhdGVDaGFuZ2VTdWNjZXNzJyk7XG4gICAgICAgICAgaWYgKCRzdG9yYWdlRmFjdG9yeSkge1xuICAgICAgICAgICAgU3RvcmFnZS5zZXQoJHRyYW5zbGF0ZS5zdG9yYWdlS2V5KCksICR1c2VzKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZGVmYXVsdEludGVycG9sYXRvci5zZXRMb2NhbGUoJHVzZXMpO1xuICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChpbnRlcnBvbGF0b3JIYXNoTWFwLCBmdW5jdGlvbiAoaW50ZXJwb2xhdG9yLCBpZCkge1xuICAgICAgICAgICAgaW50ZXJwb2xhdG9ySGFzaE1hcFtpZF0uc2V0TG9jYWxlKCR1c2VzKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCckdHJhbnNsYXRlQ2hhbmdlRW5kJyk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBsb2FkQXN5bmMgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgaWYgKCFrZXkpIHtcbiAgICAgICAgICAgIHRocm93ICdObyBsYW5ndWFnZSBrZXkgc3BlY2lmaWVkIGZvciBsb2FkaW5nLic7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnJHRyYW5zbGF0ZUxvYWRpbmdTdGFydCcpO1xuICAgICAgICAgIHBlbmRpbmdMb2FkZXIgPSB0cnVlO1xuICAgICAgICAgICRpbmplY3Rvci5nZXQoJGxvYWRlckZhY3RvcnkpKGFuZ3VsYXIuZXh0ZW5kKCRsb2FkZXJPcHRpb25zLCB7IGtleToga2V5IH0pKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2YXIgdHJhbnNsYXRpb25UYWJsZSA9IHt9O1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnJHRyYW5zbGF0ZUxvYWRpbmdTdWNjZXNzJyk7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbiAodGFibGUpIHtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZCh0cmFuc2xhdGlvblRhYmxlLCBmbGF0T2JqZWN0KHRhYmxlKSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQodHJhbnNsYXRpb25UYWJsZSwgZmxhdE9iamVjdChkYXRhKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwZW5kaW5nTG9hZGVyID0gZmFsc2U7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHtcbiAgICAgICAgICAgICAga2V5OiBrZXksXG4gICAgICAgICAgICAgIHRhYmxlOiB0cmFuc2xhdGlvblRhYmxlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJyR0cmFuc2xhdGVMb2FkaW5nRW5kJyk7XG4gICAgICAgICAgfSwgZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnJHRyYW5zbGF0ZUxvYWRpbmdFcnJvcicpO1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGtleSk7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCckdHJhbnNsYXRlTG9hZGluZ0VuZCcpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoJHN0b3JhZ2VGYWN0b3J5KSB7XG4gICAgICAgICAgU3RvcmFnZSA9ICRpbmplY3Rvci5nZXQoJHN0b3JhZ2VGYWN0b3J5KTtcbiAgICAgICAgICBpZiAoIVN0b3JhZ2UuZ2V0IHx8ICFTdG9yYWdlLnNldCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZG5cXCd0IHVzZSBzdG9yYWdlIFxcJycgKyAkc3RvcmFnZUZhY3RvcnkgKyAnXFwnLCBtaXNzaW5nIGdldCgpIG9yIHNldCgpIG1ldGhvZCEnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNGdW5jdGlvbihkZWZhdWx0SW50ZXJwb2xhdG9yLnVzZVNhbml0aXplVmFsdWVTdHJhdGVneSkpIHtcbiAgICAgICAgICBkZWZhdWx0SW50ZXJwb2xhdG9yLnVzZVNhbml0aXplVmFsdWVTdHJhdGVneSgkaW50ZXJwb2xhdGlvblNhbml0aXphdGlvblN0cmF0ZWd5KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoJGludGVycG9sYXRvckZhY3Rvcmllcy5sZW5ndGgpIHtcbiAgICAgICAgICBhbmd1bGFyLmZvckVhY2goJGludGVycG9sYXRvckZhY3RvcmllcywgZnVuY3Rpb24gKGludGVycG9sYXRvckZhY3RvcnkpIHtcbiAgICAgICAgICAgIHZhciBpbnRlcnBvbGF0b3IgPSAkaW5qZWN0b3IuZ2V0KGludGVycG9sYXRvckZhY3RvcnkpO1xuICAgICAgICAgICAgaW50ZXJwb2xhdG9yLnNldExvY2FsZSgkcHJlZmVycmVkTGFuZ3VhZ2UgfHwgJHVzZXMpO1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNGdW5jdGlvbihpbnRlcnBvbGF0b3IudXNlU2FuaXRpemVWYWx1ZVN0cmF0ZWd5KSkge1xuICAgICAgICAgICAgICBpbnRlcnBvbGF0b3IudXNlU2FuaXRpemVWYWx1ZVN0cmF0ZWd5KCRpbnRlcnBvbGF0aW9uU2FuaXRpemF0aW9uU3RyYXRlZ3kpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW50ZXJwb2xhdG9ySGFzaE1hcFtpbnRlcnBvbGF0b3IuZ2V0SW50ZXJwb2xhdGlvbklkZW50aWZpZXIoKV0gPSBpbnRlcnBvbGF0b3I7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGdldFRyYW5zbGF0aW9uVGFibGUgPSBmdW5jdGlvbiAobGFuZ0tleSkge1xuICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgaWYgKCR0cmFuc2xhdGlvblRhYmxlLmhhc093blByb3BlcnR5KGxhbmdLZXkpKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCR0cmFuc2xhdGlvblRhYmxlW2xhbmdLZXldKTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsYW5nUHJvbWlzZXNbbGFuZ0tleV0udGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICB0cmFuc2xhdGlvbnMoZGF0YS5rZXksIGRhdGEudGFibGUpO1xuICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGRhdGEudGFibGUpO1xuICAgICAgICAgICAgfSwgZGVmZXJyZWQucmVqZWN0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBnZXRGYWxsYmFja1RyYW5zbGF0aW9uID0gZnVuY3Rpb24gKGxhbmdLZXksIHRyYW5zbGF0aW9uSWQsIGludGVycG9sYXRlUGFyYW1zLCBJbnRlcnBvbGF0b3IpIHtcbiAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgIGdldFRyYW5zbGF0aW9uVGFibGUobGFuZ0tleSkudGhlbihmdW5jdGlvbiAodHJhbnNsYXRpb25UYWJsZSkge1xuICAgICAgICAgICAgaWYgKHRyYW5zbGF0aW9uVGFibGUuaGFzT3duUHJvcGVydHkodHJhbnNsYXRpb25JZCkpIHtcbiAgICAgICAgICAgICAgSW50ZXJwb2xhdG9yLnNldExvY2FsZShsYW5nS2V5KTtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShJbnRlcnBvbGF0b3IuaW50ZXJwb2xhdGUodHJhbnNsYXRpb25UYWJsZVt0cmFuc2xhdGlvbklkXSwgaW50ZXJwb2xhdGVQYXJhbXMpKTtcbiAgICAgICAgICAgICAgSW50ZXJwb2xhdG9yLnNldExvY2FsZSgkdXNlcyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCBkZWZlcnJlZC5yZWplY3QpO1xuICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgZ2V0RmFsbGJhY2tUcmFuc2xhdGlvbkluc3RhbnQgPSBmdW5jdGlvbiAobGFuZ0tleSwgdHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIEludGVycG9sYXRvcikge1xuICAgICAgICAgIHZhciByZXN1bHQsIHRyYW5zbGF0aW9uVGFibGUgPSAkdHJhbnNsYXRpb25UYWJsZVtsYW5nS2V5XTtcbiAgICAgICAgICBpZiAodHJhbnNsYXRpb25UYWJsZS5oYXNPd25Qcm9wZXJ0eSh0cmFuc2xhdGlvbklkKSkge1xuICAgICAgICAgICAgSW50ZXJwb2xhdG9yLnNldExvY2FsZShsYW5nS2V5KTtcbiAgICAgICAgICAgIHJlc3VsdCA9IEludGVycG9sYXRvci5pbnRlcnBvbGF0ZSh0cmFuc2xhdGlvblRhYmxlW3RyYW5zbGF0aW9uSWRdLCBpbnRlcnBvbGF0ZVBhcmFtcyk7XG4gICAgICAgICAgICBJbnRlcnBvbGF0b3Iuc2V0TG9jYWxlKCR1c2VzKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHJlc29sdmVGb3JGYWxsYmFja0xhbmd1YWdlID0gZnVuY3Rpb24gKGZhbGxiYWNrTGFuZ3VhZ2VJbmRleCwgdHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIEludGVycG9sYXRvcikge1xuICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgaWYgKGZhbGxiYWNrTGFuZ3VhZ2VJbmRleCA8ICRmYWxsYmFja0xhbmd1YWdlLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIGxhbmdLZXkgPSAkZmFsbGJhY2tMYW5ndWFnZVtmYWxsYmFja0xhbmd1YWdlSW5kZXhdO1xuICAgICAgICAgICAgZ2V0RmFsbGJhY2tUcmFuc2xhdGlvbihsYW5nS2V5LCB0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgSW50ZXJwb2xhdG9yKS50aGVuKGZ1bmN0aW9uICh0cmFuc2xhdGlvbikge1xuICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHRyYW5zbGF0aW9uKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgdmFyIG5leHRGYWxsYmFja0xhbmd1YWdlUHJvbWlzZSA9IHJlc29sdmVGb3JGYWxsYmFja0xhbmd1YWdlKGZhbGxiYWNrTGFuZ3VhZ2VJbmRleCArIDEsIHRyYW5zbGF0aW9uSWQsIGludGVycG9sYXRlUGFyYW1zLCBJbnRlcnBvbGF0b3IpO1xuICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKG5leHRGYWxsYmFja0xhbmd1YWdlUHJvbWlzZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSh0cmFuc2xhdGlvbklkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH07XG4gICAgICAgIHZhciByZXNvbHZlRm9yRmFsbGJhY2tMYW5ndWFnZUluc3RhbnQgPSBmdW5jdGlvbiAoZmFsbGJhY2tMYW5ndWFnZUluZGV4LCB0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgSW50ZXJwb2xhdG9yKSB7XG4gICAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgICBpZiAoZmFsbGJhY2tMYW5ndWFnZUluZGV4IDwgJGZhbGxiYWNrTGFuZ3VhZ2UubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgbGFuZ0tleSA9ICRmYWxsYmFja0xhbmd1YWdlW2ZhbGxiYWNrTGFuZ3VhZ2VJbmRleF07XG4gICAgICAgICAgICByZXN1bHQgPSBnZXRGYWxsYmFja1RyYW5zbGF0aW9uSW5zdGFudChsYW5nS2V5LCB0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgSW50ZXJwb2xhdG9yKTtcbiAgICAgICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICAgIHJlc3VsdCA9IHJlc29sdmVGb3JGYWxsYmFja0xhbmd1YWdlSW5zdGFudChmYWxsYmFja0xhbmd1YWdlSW5kZXggKyAxLCB0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgSW50ZXJwb2xhdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGZhbGxiYWNrVHJhbnNsYXRpb24gPSBmdW5jdGlvbiAodHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIEludGVycG9sYXRvcikge1xuICAgICAgICAgIHJldHVybiByZXNvbHZlRm9yRmFsbGJhY2tMYW5ndWFnZShzdGFydEZhbGxiYWNrSXRlcmF0aW9uID4gMCA/IHN0YXJ0RmFsbGJhY2tJdGVyYXRpb24gOiBmYWxsYmFja0luZGV4LCB0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgSW50ZXJwb2xhdG9yKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGZhbGxiYWNrVHJhbnNsYXRpb25JbnN0YW50ID0gZnVuY3Rpb24gKHRyYW5zbGF0aW9uSWQsIGludGVycG9sYXRlUGFyYW1zLCBJbnRlcnBvbGF0b3IpIHtcbiAgICAgICAgICByZXR1cm4gcmVzb2x2ZUZvckZhbGxiYWNrTGFuZ3VhZ2VJbnN0YW50KHN0YXJ0RmFsbGJhY2tJdGVyYXRpb24gPiAwID8gc3RhcnRGYWxsYmFja0l0ZXJhdGlvbiA6IGZhbGxiYWNrSW5kZXgsIHRyYW5zbGF0aW9uSWQsIGludGVycG9sYXRlUGFyYW1zLCBJbnRlcnBvbGF0b3IpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgZGV0ZXJtaW5lVHJhbnNsYXRpb24gPSBmdW5jdGlvbiAodHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIGludGVycG9sYXRpb25JZCkge1xuICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgdmFyIHRhYmxlID0gJHVzZXMgPyAkdHJhbnNsYXRpb25UYWJsZVskdXNlc10gOiAkdHJhbnNsYXRpb25UYWJsZSwgSW50ZXJwb2xhdG9yID0gaW50ZXJwb2xhdGlvbklkID8gaW50ZXJwb2xhdG9ySGFzaE1hcFtpbnRlcnBvbGF0aW9uSWRdIDogZGVmYXVsdEludGVycG9sYXRvcjtcbiAgICAgICAgICBpZiAodGFibGUgJiYgdGFibGUuaGFzT3duUHJvcGVydHkodHJhbnNsYXRpb25JZCkpIHtcbiAgICAgICAgICAgIHZhciB0cmFuc2xhdGlvbiA9IHRhYmxlW3RyYW5zbGF0aW9uSWRdO1xuICAgICAgICAgICAgaWYgKHRyYW5zbGF0aW9uLnN1YnN0cigwLCAyKSA9PT0gJ0A6Jykge1xuICAgICAgICAgICAgICAkdHJhbnNsYXRlKHRyYW5zbGF0aW9uLnN1YnN0cigyKSwgaW50ZXJwb2xhdGVQYXJhbXMsIGludGVycG9sYXRpb25JZCkudGhlbihkZWZlcnJlZC5yZXNvbHZlLCBkZWZlcnJlZC5yZWplY3QpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShJbnRlcnBvbGF0b3IuaW50ZXJwb2xhdGUodHJhbnNsYXRpb24sIGludGVycG9sYXRlUGFyYW1zKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICgkbWlzc2luZ1RyYW5zbGF0aW9uSGFuZGxlckZhY3RvcnkgJiYgIXBlbmRpbmdMb2FkZXIpIHtcbiAgICAgICAgICAgICAgJGluamVjdG9yLmdldCgkbWlzc2luZ1RyYW5zbGF0aW9uSGFuZGxlckZhY3RvcnkpKHRyYW5zbGF0aW9uSWQsICR1c2VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgkdXNlcyAmJiAkZmFsbGJhY2tMYW5ndWFnZSAmJiAkZmFsbGJhY2tMYW5ndWFnZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgZmFsbGJhY2tUcmFuc2xhdGlvbih0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgSW50ZXJwb2xhdG9yKS50aGVuKGZ1bmN0aW9uICh0cmFuc2xhdGlvbikge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUodHJhbnNsYXRpb24pO1xuICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoX3RyYW5zbGF0aW9uSWQpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoYXBwbHlOb3RGb3VuZEluZGljYXRvcnMoX3RyYW5zbGF0aW9uSWQpKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoYXBwbHlOb3RGb3VuZEluZGljYXRvcnModHJhbnNsYXRpb25JZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGRldGVybWluZVRyYW5zbGF0aW9uSW5zdGFudCA9IGZ1bmN0aW9uICh0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgaW50ZXJwb2xhdGlvbklkKSB7XG4gICAgICAgICAgdmFyIHJlc3VsdCwgdGFibGUgPSAkdXNlcyA/ICR0cmFuc2xhdGlvblRhYmxlWyR1c2VzXSA6ICR0cmFuc2xhdGlvblRhYmxlLCBJbnRlcnBvbGF0b3IgPSBpbnRlcnBvbGF0aW9uSWQgPyBpbnRlcnBvbGF0b3JIYXNoTWFwW2ludGVycG9sYXRpb25JZF0gOiBkZWZhdWx0SW50ZXJwb2xhdG9yO1xuICAgICAgICAgIGlmICh0YWJsZSAmJiB0YWJsZS5oYXNPd25Qcm9wZXJ0eSh0cmFuc2xhdGlvbklkKSkge1xuICAgICAgICAgICAgdmFyIHRyYW5zbGF0aW9uID0gdGFibGVbdHJhbnNsYXRpb25JZF07XG4gICAgICAgICAgICBpZiAodHJhbnNsYXRpb24uc3Vic3RyKDAsIDIpID09PSAnQDonKSB7XG4gICAgICAgICAgICAgIHJlc3VsdCA9IGRldGVybWluZVRyYW5zbGF0aW9uSW5zdGFudCh0cmFuc2xhdGlvbi5zdWJzdHIoMiksIGludGVycG9sYXRlUGFyYW1zLCBpbnRlcnBvbGF0aW9uSWQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmVzdWx0ID0gSW50ZXJwb2xhdG9yLmludGVycG9sYXRlKHRyYW5zbGF0aW9uLCBpbnRlcnBvbGF0ZVBhcmFtcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICgkbWlzc2luZ1RyYW5zbGF0aW9uSGFuZGxlckZhY3RvcnkgJiYgIXBlbmRpbmdMb2FkZXIpIHtcbiAgICAgICAgICAgICAgJGluamVjdG9yLmdldCgkbWlzc2luZ1RyYW5zbGF0aW9uSGFuZGxlckZhY3RvcnkpKHRyYW5zbGF0aW9uSWQsICR1c2VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgkdXNlcyAmJiAkZmFsbGJhY2tMYW5ndWFnZSAmJiAkZmFsbGJhY2tMYW5ndWFnZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgZmFsbGJhY2tJbmRleCA9IDA7XG4gICAgICAgICAgICAgIHJlc3VsdCA9IGZhbGxiYWNrVHJhbnNsYXRpb25JbnN0YW50KHRyYW5zbGF0aW9uSWQsIGludGVycG9sYXRlUGFyYW1zLCBJbnRlcnBvbGF0b3IpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmVzdWx0ID0gYXBwbHlOb3RGb3VuZEluZGljYXRvcnModHJhbnNsYXRpb25JZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICAgICR0cmFuc2xhdGUucHJlZmVycmVkTGFuZ3VhZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuICRwcmVmZXJyZWRMYW5ndWFnZTtcbiAgICAgICAgfTtcbiAgICAgICAgJHRyYW5zbGF0ZS5jbG9ha0NsYXNzTmFtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gJGNsb2FrQ2xhc3NOYW1lO1xuICAgICAgICB9O1xuICAgICAgICAkdHJhbnNsYXRlLmZhbGxiYWNrTGFuZ3VhZ2UgPSBmdW5jdGlvbiAobGFuZ0tleSkge1xuICAgICAgICAgIGlmIChsYW5nS2V5ICE9PSB1bmRlZmluZWQgJiYgbGFuZ0tleSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgZmFsbGJhY2tTdGFjayhsYW5nS2V5KTtcbiAgICAgICAgICAgIGlmICgkbG9hZGVyRmFjdG9yeSkge1xuICAgICAgICAgICAgICBpZiAoJGZhbGxiYWNrTGFuZ3VhZ2UgJiYgJGZhbGxiYWNrTGFuZ3VhZ2UubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9ICRmYWxsYmFja0xhbmd1YWdlLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoIWxhbmdQcm9taXNlc1skZmFsbGJhY2tMYW5ndWFnZVtpXV0pIHtcbiAgICAgICAgICAgICAgICAgICAgbGFuZ1Byb21pc2VzWyRmYWxsYmFja0xhbmd1YWdlW2ldXSA9IGxvYWRBc3luYygkZmFsbGJhY2tMYW5ndWFnZVtpXSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkdHJhbnNsYXRlLnVzZSgkdHJhbnNsYXRlLnVzZSgpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCRmYWxsYmFja1dhc1N0cmluZykge1xuICAgICAgICAgICAgcmV0dXJuICRmYWxsYmFja0xhbmd1YWdlWzBdO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gJGZhbGxiYWNrTGFuZ3VhZ2U7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkdHJhbnNsYXRlLnVzZUZhbGxiYWNrTGFuZ3VhZ2UgPSBmdW5jdGlvbiAobGFuZ0tleSkge1xuICAgICAgICAgIGlmIChsYW5nS2V5ICE9PSB1bmRlZmluZWQgJiYgbGFuZ0tleSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKCFsYW5nS2V5KSB7XG4gICAgICAgICAgICAgIHN0YXJ0RmFsbGJhY2tJdGVyYXRpb24gPSAwO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFyIGxhbmdLZXlQb3NpdGlvbiA9IGluZGV4T2YoJGZhbGxiYWNrTGFuZ3VhZ2UsIGxhbmdLZXkpO1xuICAgICAgICAgICAgICBpZiAobGFuZ0tleVBvc2l0aW9uID4gLTEpIHtcbiAgICAgICAgICAgICAgICBzdGFydEZhbGxiYWNrSXRlcmF0aW9uID0gbGFuZ0tleVBvc2l0aW9uO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkdHJhbnNsYXRlLnByb3Bvc2VkTGFuZ3VhZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuICRuZXh0TGFuZztcbiAgICAgICAgfTtcbiAgICAgICAgJHRyYW5zbGF0ZS5zdG9yYWdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBTdG9yYWdlO1xuICAgICAgICB9O1xuICAgICAgICAkdHJhbnNsYXRlLnVzZSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICBpZiAoIWtleSkge1xuICAgICAgICAgICAgcmV0dXJuICR1c2VzO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJyR0cmFuc2xhdGVDaGFuZ2VTdGFydCcpO1xuICAgICAgICAgIGlmICghJHRyYW5zbGF0aW9uVGFibGVba2V5XSAmJiAkbG9hZGVyRmFjdG9yeSkge1xuICAgICAgICAgICAgJG5leHRMYW5nID0ga2V5O1xuICAgICAgICAgICAgbGFuZ1Byb21pc2VzW2tleV0gPSBsb2FkQXN5bmMoa2V5KS50aGVuKGZ1bmN0aW9uICh0cmFuc2xhdGlvbikge1xuICAgICAgICAgICAgICB0cmFuc2xhdGlvbnModHJhbnNsYXRpb24ua2V5LCB0cmFuc2xhdGlvbi50YWJsZSk7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUodHJhbnNsYXRpb24ua2V5KTtcbiAgICAgICAgICAgICAgaWYgKCRuZXh0TGFuZyA9PT0ga2V5KSB7XG4gICAgICAgICAgICAgICAgdXNlTGFuZ3VhZ2UodHJhbnNsYXRpb24ua2V5KTtcbiAgICAgICAgICAgICAgICAkbmV4dExhbmcgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICAgJG5leHRMYW5nID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCckdHJhbnNsYXRlQ2hhbmdlRXJyb3InKTtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGtleSk7XG4gICAgICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJyR0cmFuc2xhdGVDaGFuZ2VFbmQnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGtleSk7XG4gICAgICAgICAgICB1c2VMYW5ndWFnZShrZXkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgJHRyYW5zbGF0ZS5zdG9yYWdlS2V5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBzdG9yYWdlS2V5KCk7XG4gICAgICAgIH07XG4gICAgICAgICR0cmFuc2xhdGUuaXNQb3N0Q29tcGlsaW5nRW5hYmxlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gJHBvc3RDb21waWxpbmdFbmFibGVkO1xuICAgICAgICB9O1xuICAgICAgICAkdHJhbnNsYXRlLnJlZnJlc2ggPSBmdW5jdGlvbiAobGFuZ0tleSkge1xuICAgICAgICAgIGlmICghJGxvYWRlckZhY3RvcnkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGRuXFwndCByZWZyZXNoIHRyYW5zbGF0aW9uIHRhYmxlLCBubyBsb2FkZXIgcmVnaXN0ZXJlZCEnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICBmdW5jdGlvbiByZXNvbHZlKCkge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnJHRyYW5zbGF0ZVJlZnJlc2hFbmQnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZnVuY3Rpb24gcmVqZWN0KCkge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCckdHJhbnNsYXRlUmVmcmVzaEVuZCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCckdHJhbnNsYXRlUmVmcmVzaFN0YXJ0Jyk7XG4gICAgICAgICAgaWYgKCFsYW5nS2V5KSB7XG4gICAgICAgICAgICB2YXIgdGFibGVzID0gW107XG4gICAgICAgICAgICBpZiAoJGZhbGxiYWNrTGFuZ3VhZ2UgJiYgJGZhbGxiYWNrTGFuZ3VhZ2UubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSAkZmFsbGJhY2tMYW5ndWFnZS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHRhYmxlcy5wdXNoKGxvYWRBc3luYygkZmFsbGJhY2tMYW5ndWFnZVtpXSkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoJHVzZXMpIHtcbiAgICAgICAgICAgICAgdGFibGVzLnB1c2gobG9hZEFzeW5jKCR1c2VzKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkcS5hbGwodGFibGVzKS50aGVuKGZ1bmN0aW9uICh0YWJsZURhdGEpIHtcbiAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHRhYmxlRGF0YSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHRyYW5zbGF0aW9uVGFibGVbZGF0YS5rZXldKSB7XG4gICAgICAgICAgICAgICAgICBkZWxldGUgJHRyYW5zbGF0aW9uVGFibGVbZGF0YS5rZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0cmFuc2xhdGlvbnMoZGF0YS5rZXksIGRhdGEudGFibGUpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgaWYgKCR1c2VzKSB7XG4gICAgICAgICAgICAgICAgdXNlTGFuZ3VhZ2UoJHVzZXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSBpZiAoJHRyYW5zbGF0aW9uVGFibGVbbGFuZ0tleV0pIHtcbiAgICAgICAgICAgIGxvYWRBc3luYyhsYW5nS2V5KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIHRyYW5zbGF0aW9ucyhkYXRhLmtleSwgZGF0YS50YWJsZSk7XG4gICAgICAgICAgICAgIGlmIChsYW5nS2V5ID09PSAkdXNlcykge1xuICAgICAgICAgICAgICAgIHVzZUxhbmd1YWdlKCR1c2VzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9LCByZWplY3QpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH07XG4gICAgICAgICR0cmFuc2xhdGUuaW5zdGFudCA9IGZ1bmN0aW9uICh0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgaW50ZXJwb2xhdGlvbklkKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiB0cmFuc2xhdGlvbklkID09PSAndW5kZWZpbmVkJyB8fCB0cmFuc2xhdGlvbklkID09PSAnJykge1xuICAgICAgICAgICAgcmV0dXJuIHRyYW5zbGF0aW9uSWQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRyYW5zbGF0aW9uSWQgPSB0cmFuc2xhdGlvbklkLnRyaW0oKTtcbiAgICAgICAgICB2YXIgcmVzdWx0LCBwb3NzaWJsZUxhbmdLZXlzID0gW107XG4gICAgICAgICAgaWYgKCRwcmVmZXJyZWRMYW5ndWFnZSkge1xuICAgICAgICAgICAgcG9zc2libGVMYW5nS2V5cy5wdXNoKCRwcmVmZXJyZWRMYW5ndWFnZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICgkdXNlcykge1xuICAgICAgICAgICAgcG9zc2libGVMYW5nS2V5cy5wdXNoKCR1c2VzKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCRmYWxsYmFja0xhbmd1YWdlICYmICRmYWxsYmFja0xhbmd1YWdlLmxlbmd0aCkge1xuICAgICAgICAgICAgcG9zc2libGVMYW5nS2V5cyA9IHBvc3NpYmxlTGFuZ0tleXMuY29uY2F0KCRmYWxsYmFja0xhbmd1YWdlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGMgPSBwb3NzaWJsZUxhbmdLZXlzLmxlbmd0aDsgaSA8IGM7IGkrKykge1xuICAgICAgICAgICAgdmFyIHBvc3NpYmxlTGFuZ0tleSA9IHBvc3NpYmxlTGFuZ0tleXNbaV07XG4gICAgICAgICAgICBpZiAoJHRyYW5zbGF0aW9uVGFibGVbcG9zc2libGVMYW5nS2V5XSkge1xuICAgICAgICAgICAgICBpZiAoJHRyYW5zbGF0aW9uVGFibGVbcG9zc2libGVMYW5nS2V5XVt0cmFuc2xhdGlvbklkXSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGRldGVybWluZVRyYW5zbGF0aW9uSW5zdGFudCh0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgaW50ZXJwb2xhdGlvbklkKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiByZXN1bHQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgcmVzdWx0ID0gdHJhbnNsYXRpb25JZDtcbiAgICAgICAgICAgIGlmICgkbWlzc2luZ1RyYW5zbGF0aW9uSGFuZGxlckZhY3RvcnkgJiYgIXBlbmRpbmdMb2FkZXIpIHtcbiAgICAgICAgICAgICAgJGluamVjdG9yLmdldCgkbWlzc2luZ1RyYW5zbGF0aW9uSGFuZGxlckZhY3RvcnkpKHRyYW5zbGF0aW9uSWQsICR1c2VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCRsb2FkZXJGYWN0b3J5KSB7XG4gICAgICAgICAgaWYgKGFuZ3VsYXIuZXF1YWxzKCR0cmFuc2xhdGlvblRhYmxlLCB7fSkpIHtcbiAgICAgICAgICAgICR0cmFuc2xhdGUudXNlKCR0cmFuc2xhdGUudXNlKCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoJGZhbGxiYWNrTGFuZ3VhZ2UgJiYgJGZhbGxiYWNrTGFuZ3VhZ2UubGVuZ3RoKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gJGZhbGxiYWNrTGFuZ3VhZ2UubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgbGFuZ1Byb21pc2VzWyRmYWxsYmFja0xhbmd1YWdlW2ldXSA9IGxvYWRBc3luYygkZmFsbGJhY2tMYW5ndWFnZVtpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAkdHJhbnNsYXRlO1xuICAgICAgfVxuICAgIF07XG4gIH1cbl0pO1xuYW5ndWxhci5tb2R1bGUoJ3Bhc2NhbHByZWNodC50cmFuc2xhdGUnKS5mYWN0b3J5KCckdHJhbnNsYXRlRGVmYXVsdEludGVycG9sYXRpb24nLCBbXG4gICckaW50ZXJwb2xhdGUnLFxuICBmdW5jdGlvbiAoJGludGVycG9sYXRlKSB7XG4gICAgdmFyICR0cmFuc2xhdGVJbnRlcnBvbGF0b3IgPSB7fSwgJGxvY2FsZSwgJGlkZW50aWZpZXIgPSAnZGVmYXVsdCcsICRzYW5pdGl6ZVZhbHVlU3RyYXRlZ3kgPSBudWxsLCBzYW5pdGl6ZVZhbHVlU3RyYXRlZ2llcyA9IHtcbiAgICAgICAgZXNjYXBlZDogZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gcGFyYW1zKSB7XG4gICAgICAgICAgICBpZiAocGFyYW1zLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgcmVzdWx0W2tleV0gPSBhbmd1bGFyLmVsZW1lbnQoJzxkaXY+PC9kaXY+JykudGV4dChwYXJhbXNba2V5XSkuaHRtbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIHZhciBzYW5pdGl6ZVBhcmFtcyA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgIHZhciByZXN1bHQ7XG4gICAgICBpZiAoYW5ndWxhci5pc0Z1bmN0aW9uKHNhbml0aXplVmFsdWVTdHJhdGVnaWVzWyRzYW5pdGl6ZVZhbHVlU3RyYXRlZ3ldKSkge1xuICAgICAgICByZXN1bHQgPSBzYW5pdGl6ZVZhbHVlU3RyYXRlZ2llc1skc2FuaXRpemVWYWx1ZVN0cmF0ZWd5XShwYXJhbXMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gcGFyYW1zO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgICR0cmFuc2xhdGVJbnRlcnBvbGF0b3Iuc2V0TG9jYWxlID0gZnVuY3Rpb24gKGxvY2FsZSkge1xuICAgICAgJGxvY2FsZSA9IGxvY2FsZTtcbiAgICB9O1xuICAgICR0cmFuc2xhdGVJbnRlcnBvbGF0b3IuZ2V0SW50ZXJwb2xhdGlvbklkZW50aWZpZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gJGlkZW50aWZpZXI7XG4gICAgfTtcbiAgICAkdHJhbnNsYXRlSW50ZXJwb2xhdG9yLnVzZVNhbml0aXplVmFsdWVTdHJhdGVneSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgJHNhbml0aXplVmFsdWVTdHJhdGVneSA9IHZhbHVlO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICAkdHJhbnNsYXRlSW50ZXJwb2xhdG9yLmludGVycG9sYXRlID0gZnVuY3Rpb24gKHN0cmluZywgaW50ZXJwb2xhdGVQYXJhbXMpIHtcbiAgICAgIGlmICgkc2FuaXRpemVWYWx1ZVN0cmF0ZWd5KSB7XG4gICAgICAgIGludGVycG9sYXRlUGFyYW1zID0gc2FuaXRpemVQYXJhbXMoaW50ZXJwb2xhdGVQYXJhbXMpO1xuICAgICAgfVxuICAgICAgcmV0dXJuICRpbnRlcnBvbGF0ZShzdHJpbmcpKGludGVycG9sYXRlUGFyYW1zKTtcbiAgICB9O1xuICAgIHJldHVybiAkdHJhbnNsYXRlSW50ZXJwb2xhdG9yO1xuICB9XG5dKTtcbmFuZ3VsYXIubW9kdWxlKCdwYXNjYWxwcmVjaHQudHJhbnNsYXRlJykuY29uc3RhbnQoJyRTVE9SQUdFX0tFWScsICdOR19UUkFOU0xBVEVfTEFOR19LRVknKTtcbmFuZ3VsYXIubW9kdWxlKCdwYXNjYWxwcmVjaHQudHJhbnNsYXRlJykuZGlyZWN0aXZlKCd0cmFuc2xhdGUnLCBbXG4gICckdHJhbnNsYXRlJyxcbiAgJyRxJyxcbiAgJyRpbnRlcnBvbGF0ZScsXG4gICckY29tcGlsZScsXG4gICckcGFyc2UnLFxuICAnJHJvb3RTY29wZScsXG4gIGZ1bmN0aW9uICgkdHJhbnNsYXRlLCAkcSwgJGludGVycG9sYXRlLCAkY29tcGlsZSwgJHBhcnNlLCAkcm9vdFNjb3BlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnQUUnLFxuICAgICAgc2NvcGU6IHRydWUsXG4gICAgICBjb21waWxlOiBmdW5jdGlvbiAodEVsZW1lbnQsIHRBdHRyKSB7XG4gICAgICAgIHZhciB0cmFuc2xhdGVWYWx1ZXNFeGlzdCA9IHRBdHRyLnRyYW5zbGF0ZVZhbHVlcyA/IHRBdHRyLnRyYW5zbGF0ZVZhbHVlcyA6IHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIHRyYW5zbGF0ZUludGVycG9sYXRpb24gPSB0QXR0ci50cmFuc2xhdGVJbnRlcnBvbGF0aW9uID8gdEF0dHIudHJhbnNsYXRlSW50ZXJwb2xhdGlvbiA6IHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIHRyYW5zbGF0ZVZhbHVlRXhpc3QgPSB0RWxlbWVudFswXS5vdXRlckhUTUwubWF0Y2goL3RyYW5zbGF0ZS12YWx1ZS0rL2kpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gbGlua0ZuKHNjb3BlLCBpRWxlbWVudCwgaUF0dHIpIHtcbiAgICAgICAgICBzY29wZS5pbnRlcnBvbGF0ZVBhcmFtcyA9IHt9O1xuICAgICAgICAgIGlBdHRyLiRvYnNlcnZlKCd0cmFuc2xhdGUnLCBmdW5jdGlvbiAodHJhbnNsYXRpb25JZCkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuZXF1YWxzKHRyYW5zbGF0aW9uSWQsICcnKSB8fCAhYW5ndWxhci5pc0RlZmluZWQodHJhbnNsYXRpb25JZCkpIHtcbiAgICAgICAgICAgICAgc2NvcGUudHJhbnNsYXRpb25JZCA9ICRpbnRlcnBvbGF0ZShpRWxlbWVudC50ZXh0KCkucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgJycpKShzY29wZS4kcGFyZW50KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHNjb3BlLnRyYW5zbGF0aW9uSWQgPSB0cmFuc2xhdGlvbklkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICh0cmFuc2xhdGVWYWx1ZXNFeGlzdCkge1xuICAgICAgICAgICAgaUF0dHIuJG9ic2VydmUoJ3RyYW5zbGF0ZVZhbHVlcycsIGZ1bmN0aW9uIChpbnRlcnBvbGF0ZVBhcmFtcykge1xuICAgICAgICAgICAgICBpZiAoaW50ZXJwb2xhdGVQYXJhbXMpIHtcbiAgICAgICAgICAgICAgICBzY29wZS4kcGFyZW50LiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChzY29wZS5pbnRlcnBvbGF0ZVBhcmFtcywgJHBhcnNlKGludGVycG9sYXRlUGFyYW1zKShzY29wZS4kcGFyZW50KSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodHJhbnNsYXRlVmFsdWVFeGlzdCkge1xuICAgICAgICAgICAgdmFyIGZuID0gZnVuY3Rpb24gKGF0dHJOYW1lKSB7XG4gICAgICAgICAgICAgIGlBdHRyLiRvYnNlcnZlKGF0dHJOYW1lLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBzY29wZS5pbnRlcnBvbGF0ZVBhcmFtc1thbmd1bGFyLmxvd2VyY2FzZShhdHRyTmFtZS5zdWJzdHIoMTQpKV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZm9yICh2YXIgYXR0ciBpbiBpQXR0cikge1xuICAgICAgICAgICAgICBpZiAoaUF0dHIuaGFzT3duUHJvcGVydHkoYXR0cikgJiYgYXR0ci5zdWJzdHIoMCwgMTQpID09PSAndHJhbnNsYXRlVmFsdWUnICYmIGF0dHIgIT09ICd0cmFuc2xhdGVWYWx1ZXMnKSB7XG4gICAgICAgICAgICAgICAgZm4oYXR0cik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGFwcGx5RWxlbWVudENvbnRlbnQgPSBmdW5jdGlvbiAodmFsdWUsIHNjb3BlKSB7XG4gICAgICAgICAgICBpRWxlbWVudC5odG1sKHZhbHVlKTtcbiAgICAgICAgICAgIHZhciBnbG9iYWxseUVuYWJsZWQgPSAkdHJhbnNsYXRlLmlzUG9zdENvbXBpbGluZ0VuYWJsZWQoKTtcbiAgICAgICAgICAgIHZhciBsb2NhbGx5RGVmaW5lZCA9IHR5cGVvZiB0QXR0ci50cmFuc2xhdGVDb21waWxlICE9PSAndW5kZWZpbmVkJztcbiAgICAgICAgICAgIHZhciBsb2NhbGx5RW5hYmxlZCA9IGxvY2FsbHlEZWZpbmVkICYmIHRBdHRyLnRyYW5zbGF0ZUNvbXBpbGUgIT09ICdmYWxzZSc7XG4gICAgICAgICAgICBpZiAoZ2xvYmFsbHlFbmFibGVkICYmICFsb2NhbGx5RGVmaW5lZCB8fCBsb2NhbGx5RW5hYmxlZCkge1xuICAgICAgICAgICAgICAkY29tcGlsZShpRWxlbWVudC5jb250ZW50cygpKShzY29wZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgICB2YXIgdXBkYXRlVHJhbnNsYXRpb25GbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgaWYgKCF0cmFuc2xhdGVWYWx1ZXNFeGlzdCAmJiAhdHJhbnNsYXRlVmFsdWVFeGlzdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgdW53YXRjaCA9IHNjb3BlLiR3YXRjaCgndHJhbnNsYXRpb25JZCcsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS50cmFuc2xhdGlvbklkICYmIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdHJhbnNsYXRlKHZhbHVlLCB7fSwgdHJhbnNsYXRlSW50ZXJwb2xhdGlvbikudGhlbihmdW5jdGlvbiAodHJhbnNsYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwbHlFbGVtZW50Q29udGVudCh0cmFuc2xhdGlvbiwgc2NvcGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB1bndhdGNoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAodHJhbnNsYXRpb25JZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBseUVsZW1lbnRDb250ZW50KHRyYW5zbGF0aW9uSWQsIHNjb3BlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdW53YXRjaCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goJ2ludGVycG9sYXRlUGFyYW1zJywgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS50cmFuc2xhdGlvbklkICYmIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgJHRyYW5zbGF0ZShzY29wZS50cmFuc2xhdGlvbklkLCB2YWx1ZSwgdHJhbnNsYXRlSW50ZXJwb2xhdGlvbikudGhlbihmdW5jdGlvbiAodHJhbnNsYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGx5RWxlbWVudENvbnRlbnQodHJhbnNsYXRpb24sIHNjb3BlKTtcbiAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAodHJhbnNsYXRpb25JZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbHlFbGVtZW50Q29udGVudCh0cmFuc2xhdGlvbklkLCBzY29wZSk7XG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sIHRydWUpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0oKTtcbiAgICAgICAgICB2YXIgdW5iaW5kID0gJHJvb3RTY29wZS4kb24oJyR0cmFuc2xhdGVDaGFuZ2VTdWNjZXNzJywgdXBkYXRlVHJhbnNsYXRpb25Gbik7XG4gICAgICAgICAgdXBkYXRlVHJhbnNsYXRpb25GbigpO1xuICAgICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCB1bmJpbmQpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH07XG4gIH1cbl0pO1xuYW5ndWxhci5tb2R1bGUoJ3Bhc2NhbHByZWNodC50cmFuc2xhdGUnKS5kaXJlY3RpdmUoJ3RyYW5zbGF0ZUNsb2FrJywgW1xuICAnJHJvb3RTY29wZScsXG4gICckdHJhbnNsYXRlJyxcbiAgZnVuY3Rpb24gKCRyb290U2NvcGUsICR0cmFuc2xhdGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY29tcGlsZTogZnVuY3Rpb24gKHRFbGVtZW50KSB7XG4gICAgICAgICRyb290U2NvcGUuJG9uKCckdHJhbnNsYXRlTG9hZGluZ1N1Y2Nlc3MnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdEVsZW1lbnQucmVtb3ZlQ2xhc3MoJHRyYW5zbGF0ZS5jbG9ha0NsYXNzTmFtZSgpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRFbGVtZW50LmFkZENsYXNzKCR0cmFuc2xhdGUuY2xvYWtDbGFzc05hbWUoKSk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXSk7XG5hbmd1bGFyLm1vZHVsZSgncGFzY2FscHJlY2h0LnRyYW5zbGF0ZScpLmZpbHRlcigndHJhbnNsYXRlJywgW1xuICAnJHBhcnNlJyxcbiAgJyR0cmFuc2xhdGUnLFxuICBmdW5jdGlvbiAoJHBhcnNlLCAkdHJhbnNsYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0cmFuc2xhdGlvbklkLCBpbnRlcnBvbGF0ZVBhcmFtcywgaW50ZXJwb2xhdGlvbikge1xuICAgICAgaWYgKCFhbmd1bGFyLmlzT2JqZWN0KGludGVycG9sYXRlUGFyYW1zKSkge1xuICAgICAgICBpbnRlcnBvbGF0ZVBhcmFtcyA9ICRwYXJzZShpbnRlcnBvbGF0ZVBhcmFtcykoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAkdHJhbnNsYXRlLmluc3RhbnQodHJhbnNsYXRpb25JZCwgaW50ZXJwb2xhdGVQYXJhbXMsIGludGVycG9sYXRpb24pO1xuICAgIH07XG4gIH1cbl0pOyIsIi8qISBcbiAqIG51bWVyYWwuanMgbGFuZ3VhZ2UgY29uZmlndXJhdGlvblxuICogbGFuZ3VhZ2UgOiBHZXJtYW4gKGRlKSDigJMgZ2VuZXJhbGx5IHVzZWZ1bCBpbiBHZXJtYW55LCBBdXN0cmlhLCBMdXhlbWJvdXJnLCBCZWxnaXVtXG4gKiBhdXRob3IgOiBNYXJjbyBLcmFnZSA6IGh0dHBzOi8vZ2l0aHViLmNvbS9zaW5reVxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgIHZhciBsYW5ndWFnZSA9IHtcbiAgICAgICAgZGVsaW1pdGVyczoge1xuICAgICAgICAgICAgdGhvdXNhbmRzOiAnICcsXG4gICAgICAgICAgICBkZWNpbWFsOiAnLCdcbiAgICAgICAgfSxcbiAgICAgICAgYWJicmV2aWF0aW9uczoge1xuICAgICAgICAgICAgdGhvdXNhbmQ6ICdrJyxcbiAgICAgICAgICAgIG1pbGxpb246ICdtJyxcbiAgICAgICAgICAgIGJpbGxpb246ICdiJyxcbiAgICAgICAgICAgIHRyaWxsaW9uOiAndCdcbiAgICAgICAgfSxcbiAgICAgICAgb3JkaW5hbDogZnVuY3Rpb24gKG51bWJlcikge1xuICAgICAgICAgICAgcmV0dXJuICcuJztcbiAgICAgICAgfSxcbiAgICAgICAgY3VycmVuY3k6IHtcbiAgICAgICAgICAgIHN5bWJvbDogJ+KCrCdcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBOb2RlXG4gICAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gbGFuZ3VhZ2U7XG4gICAgfVxuICAgIC8vIEJyb3dzZXJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdGhpcy5udW1lcmFsICYmIHRoaXMubnVtZXJhbC5sYW5ndWFnZSkge1xuICAgICAgICB0aGlzLm51bWVyYWwubGFuZ3VhZ2UoJ2RlJywgbGFuZ3VhZ2UpO1xuICAgICAgICB0aGlzLm51bWVyYWwubGFuZ3VhZ2UoJ2RlLWRlJywgbGFuZ3VhZ2UpO1xuICAgIH1cbn0oKSk7IiwiLypcbiAqIHByb21pc2UtdHJhY2tlciAtIHYyLjAuMSAtIDIwMTQtMDQtMTFcbiAqIGh0dHA6Ly9naXRodWIuY29tL2Fqb3NsaW4vYW5ndWxhci1wcm9taXNlLXRyYWNrZXJcbiAqIENyZWF0ZWQgYnkgQW5keSBKb3NsaW47IExpY2Vuc2VkIHVuZGVyIFB1YmxpYyBEb21haW5cbiAqL1xuXG4oZnVuY3Rpb24oKSB7XG5cbmFuZ3VsYXIubW9kdWxlKCdham9zbGluLnByb21pc2UtdHJhY2tlcicpXG4uY29uZmlnKFsnJGh0dHBQcm92aWRlcicsIGZ1bmN0aW9uKCRodHRwUHJvdmlkZXIpIHtcbiAgJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaChbJyRxJywgJ3Byb21pc2VUcmFja2VyJywgZnVuY3Rpb24oJHEsIHByb21pc2VUcmFja2VyKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICBpZiAoY29uZmlnLnRyYWNrZXIpIHtcbiAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNBcnJheShjb25maWcudHJhY2tlcikpIHtcbiAgICAgICAgICAgIGNvbmZpZy50cmFja2VyID0gW2NvbmZpZy50cmFja2VyXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uZmlnLiRwcm9taXNlVHJhY2tlckRlZmVycmVkID0gY29uZmlnLiRwcm9taXNlVHJhY2tlckRlZmVycmVkIHx8IFtdO1xuXG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGNvbmZpZy50cmFja2VyLCBmdW5jdGlvbih0cmFja2VyKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSB0cmFja2VyLmNyZWF0ZVByb21pc2UoKTtcbiAgICAgICAgICAgIGNvbmZpZy4kcHJvbWlzZVRyYWNrZXJEZWZlcnJlZC5wdXNoKGRlZmVycmVkKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJHEud2hlbihjb25maWcpO1xuICAgICAgfSxcbiAgICAgIHJlc3BvbnNlOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UuY29uZmlnICYmIHJlc3BvbnNlLmNvbmZpZy4kcHJvbWlzZVRyYWNrZXJEZWZlcnJlZCkge1xuICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChyZXNwb25zZS5jb25maWcuJHByb21pc2VUcmFja2VyRGVmZXJyZWQsIGZ1bmN0aW9uKGRlZmVycmVkKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJHEud2hlbihyZXNwb25zZSk7XG4gICAgICB9LFxuICAgICAgcmVzcG9uc2VFcnJvcjogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmNvbmZpZyAmJiByZXNwb25zZS5jb25maWcuJHByb21pc2VUcmFja2VyRGVmZXJyZWQpIHtcbiAgICAgICAgICBhbmd1bGFyLmZvckVhY2gocmVzcG9uc2UuY29uZmlnLiRwcm9taXNlVHJhY2tlckRlZmVycmVkLCBmdW5jdGlvbihkZWZlcnJlZCkge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XSk7XG59XSk7XG5cbn0oKSk7IiwiLypcbiAqIHByb21pc2UtdHJhY2tlciAtIHYyLjAuMSAtIDIwMTQtMDQtMTFcbiAqIGh0dHA6Ly9naXRodWIuY29tL2Fqb3NsaW4vYW5ndWxhci1wcm9taXNlLXRyYWNrZXJcbiAqIENyZWF0ZWQgYnkgQW5keSBKb3NsaW47IExpY2Vuc2VkIHVuZGVyIFB1YmxpYyBEb21haW5cbiAqL1xuXG4oZnVuY3Rpb24oKSB7XG5cbmFuZ3VsYXIubW9kdWxlKCdham9zbGluLnByb21pc2UtdHJhY2tlcicsIFtdKVxuXG4ucHJvdmlkZXIoJ3Byb21pc2VUcmFja2VyJywgZnVuY3Rpb24oKSB7XG4gIHZhciB0cmFja2VycyA9IHt9O1xuXG4gIHRoaXMuJGdldCA9IFsnJHEnLCAnJHRpbWVvdXQnLCBmdW5jdGlvbigkcSwgJHRpbWVvdXQpIHtcbiAgICBmdW5jdGlvbiBjYW5jZWxUaW1lb3V0KHByb21pc2UpIHtcbiAgICAgIGlmIChwcm9taXNlKSB7XG4gICAgICAgICR0aW1lb3V0LmNhbmNlbChwcm9taXNlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gUHJvbWlzZVRyYWNrZXIob3B0aW9ucykge1xuICAgICAgLy9kbyBuZXcgaWYgdXNlciBkb2Vzbid0XG4gICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUHJvbWlzZVRyYWNrZXIpKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZVRyYWNrZXIob3B0aW9ucyk7XG4gICAgICB9XG5cbiAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgICAvL0FycmF5IG9mIHByb21pc2VzIGJlaW5nIHRyYWNrZWRcbiAgICAgIHZhciB0cmFja2VkID0gW107XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgIC8vQWxsb3cgYW4gb3B0aW9uYWwgXCJtaW5pbXVtIGR1cmF0aW9uXCIgdGhhdCB0aGUgdHJhY2tlciBoYXMgdG8gc3RheSBhY3RpdmUgZm9yLlxuICAgICAgdmFyIG1pbkR1cmF0aW9uID0gb3B0aW9ucy5taW5EdXJhdGlvbjtcbiAgICAgIC8vQWxsb3cgYSBkZWxheSB0aGF0IHdpbGwgc3RvcCB0aGUgdHJhY2tlciBmcm9tIGFjdGl2YXRpbmcgdW50aWwgdGhhdCB0aW1lIGlzIHJlYWNoZWRcbiAgICAgIHZhciBhY3RpdmF0aW9uRGVsYXkgPSBvcHRpb25zLmFjdGl2YXRpb25EZWxheTtcblxuICAgICAgdmFyIG1pbkR1cmF0aW9uUHJvbWlzZTtcbiAgICAgIHZhciBhY3RpdmF0aW9uRGVsYXlQcm9taXNlO1xuXG4gICAgICBzZWxmLmFjdGl2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvL0V2ZW4gaWYgd2UgaGF2ZSBhIHByb21pc2UgaW4gb3VyIHRyYWNrZXIsIHdlIGFyZW4ndCBhY3RpdmUgdW50aWwgZGVsYXkgaXMgZWxhcHNlZFxuICAgICAgICBpZiAoYWN0aXZhdGlvbkRlbGF5UHJvbWlzZSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJhY2tlZC5sZW5ndGggPiAwO1xuICAgICAgfTtcblxuICAgICAgc2VsZi50cmFja2luZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvL0V2ZW4gaWYgd2UgYXJlbid0IGFjdGl2ZSwgd2UgY291bGQgc3RpbGwgaGF2ZSBhIHByb21pc2UgaW4gb3VyIHRyYWNrZXJcbiAgICAgICAgcmV0dXJuIHRyYWNrZWQubGVuZ3RoID4gMDtcbiAgICAgIH07XG5cbiAgICAgIHNlbGYuZGVzdHJveSA9IHNlbGYuY2FuY2VsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIG1pbkR1cmF0aW9uUHJvbWlzZSA9IGNhbmNlbFRpbWVvdXQobWluRHVyYXRpb25Qcm9taXNlKTtcbiAgICAgICAgYWN0aXZhdGlvbkRlbGF5UHJvbWlzZSA9IGNhbmNlbFRpbWVvdXQoYWN0aXZhdGlvbkRlbGF5UHJvbWlzZSk7XG4gICAgICAgIGZvciAodmFyIGk9dHJhY2tlZC5sZW5ndGgtMTsgaT49MDsgaS0tKSB7XG4gICAgICAgICAgdHJhY2tlZFtpXS5yZXNvbHZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdHJhY2tlZC5sZW5ndGggPSAwO1xuICAgICAgfTtcblxuICAgICAgLy9DcmVhdGUgYSBwcm9taXNlIHRoYXQgd2lsbCBtYWtlIG91ciB0cmFja2VyIGFjdGl2ZSB1bnRpbCBpdCBpcyByZXNvbHZlZC5cbiAgICAgIC8vIEByZXR1cm4gZGVmZXJyZWQgLSBvdXIgZGVmZXJyZWQgb2JqZWN0IHRoYXQgaXMgYmVpbmcgdHJhY2tlZFxuICAgICAgc2VsZi5jcmVhdGVQcm9taXNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHRyYWNrZWQucHVzaChkZWZlcnJlZCk7XG5cbiAgICAgICAgLy9JZiB0aGUgdHJhY2tlciB3YXMganVzdCBpbmFjdGl2ZSBhbmQgdGhpcyB0aGUgZmlyc3QgaW4gdGhlIGxpc3Qgb2ZcbiAgICAgICAgLy9wcm9taXNlcywgd2UgcmVzZXQgb3VyIGRlbGF5IGFuZCBtaW5EdXJhdGlvblxuICAgICAgICAvL2FnYWluLlxuICAgICAgICBpZiAodHJhY2tlZC5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICBpZiAoYWN0aXZhdGlvbkRlbGF5KSB7XG4gICAgICAgICAgICBhY3RpdmF0aW9uRGVsYXlQcm9taXNlID0gJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGFjdGl2YXRpb25EZWxheVByb21pc2UgPSBjYW5jZWxUaW1lb3V0KGFjdGl2YXRpb25EZWxheVByb21pc2UpO1xuICAgICAgICAgICAgICBzdGFydE1pbkR1cmF0aW9uKCk7XG4gICAgICAgICAgICB9LCBhY3RpdmF0aW9uRGVsYXkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdGFydE1pbkR1cmF0aW9uKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZGVmZXJyZWQucHJvbWlzZS50aGVuKG9uRG9uZShmYWxzZSksIG9uRG9uZSh0cnVlKSk7XG5cbiAgICAgICAgcmV0dXJuIGRlZmVycmVkO1xuXG4gICAgICAgIGZ1bmN0aW9uIHN0YXJ0TWluRHVyYXRpb24oKSB7XG4gICAgICAgICAgaWYgKG1pbkR1cmF0aW9uKSB7XG4gICAgICAgICAgICBtaW5EdXJhdGlvblByb21pc2UgPSAkdGltZW91dChhbmd1bGFyLm5vb3AsIG1pbkR1cmF0aW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL0NyZWF0ZSBhIGNhbGxiYWNrIGZvciB3aGVuIHRoaXMgcHJvbWlzZSBpcyBkb25lLiBJdCB3aWxsIHJlbW92ZSBvdXJcbiAgICAgICAgLy90cmFja2VkIHByb21pc2UgZnJvbSB0aGUgYXJyYXkgaWYgb25jZSBtaW5EdXJhdGlvbiBpcyBjb21wbGV0ZVxuICAgICAgICBmdW5jdGlvbiBvbkRvbmUoaXNFcnJvcikge1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgKG1pbkR1cmF0aW9uUHJvbWlzZSB8fCAkcS53aGVuKCkpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHZhciBpbmRleCA9IHRyYWNrZWQuaW5kZXhPZihkZWZlcnJlZCk7XG4gICAgICAgICAgICAgIHRyYWNrZWQuc3BsaWNlKGluZGV4LCAxKTtcblxuICAgICAgICAgICAgICAvL0lmIHRoaXMgaXMgdGhlIGxhc3QgcHJvbWlzZSwgY2xlYW51cCB0aGUgdGltZW91dHNcbiAgICAgICAgICAgICAgLy9mb3IgYWN0aXZhdGlvbkRlbGF5XG4gICAgICAgICAgICAgIGlmICh0cmFja2VkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGFjdGl2YXRpb25EZWxheVByb21pc2UgPSBjYW5jZWxUaW1lb3V0KGFjdGl2YXRpb25EZWxheVByb21pc2UpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBzZWxmLmFkZFByb21pc2UgPSBmdW5jdGlvbihwcm9taXNlKSB7XG4gICAgICAgIHZhciB0aGVuID0gcHJvbWlzZSAmJiAocHJvbWlzZS50aGVuIHx8IHByb21pc2UuJHRoZW4gfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocHJvbWlzZS4kcHJvbWlzZSAmJiBwcm9taXNlLiRwcm9taXNlLnRoZW4pKTtcbiAgICAgICAgaWYgKCF0aGVuKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwicHJvbWlzZVRyYWNrZXIjYWRkUHJvbWlzZSBleHBlY3RzIGEgcHJvbWlzZSBvYmplY3QhXCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkZWZlcnJlZCA9IHNlbGYuY3JlYXRlUHJvbWlzZSgpO1xuXG4gICAgICAgIC8vV2hlbiBnaXZlbiBwcm9taXNlIGlzIGRvbmUsIHJlc29sdmUgb3VyIGNyZWF0ZWQgcHJvbWlzZVxuICAgICAgICAvL0FsbG93ICR0aGVuIGZvciBhbmd1bGFyLXJlc291cmNlIG9iamVjdHNcbiAgICAgICAgdGhlbihmdW5jdGlvbiBzdWNjZXNzKHZhbHVlKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSh2YWx1ZSk7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9LCBmdW5jdGlvbiBlcnJvcih2YWx1ZSkge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdCh2YWx1ZSk7XG4gICAgICAgICAgcmV0dXJuICRxLnJlamVjdCh2YWx1ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBkZWZlcnJlZDtcbiAgICAgIH07XG4gICAgfTtcbiAgfV07XG59KTtcblxufSgpKTtcbiIsIi8qXG4gKiBhbmd1bGFyLXVpLWJvb3RzdHJhcFxuICogaHR0cDovL2FuZ3VsYXItdWkuZ2l0aHViLmlvL2Jvb3RzdHJhcC9cblxuICogVmVyc2lvbjogMC4xMS4yIC0gMjAxNC0wOS0yNlxuICogTGljZW5zZTogTUlUXG4gKi9cbmFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwXCIsW1widWkuYm9vdHN0cmFwLnRwbHNcIixcInVpLmJvb3RzdHJhcC50cmFuc2l0aW9uXCIsXCJ1aS5ib290c3RyYXAuY29sbGFwc2VcIixcInVpLmJvb3RzdHJhcC5hY2NvcmRpb25cIixcInVpLmJvb3RzdHJhcC5hbGVydFwiLFwidWkuYm9vdHN0cmFwLmJpbmRIdG1sXCIsXCJ1aS5ib290c3RyYXAuYnV0dG9uc1wiLFwidWkuYm9vdHN0cmFwLmNhcm91c2VsXCIsXCJ1aS5ib290c3RyYXAuZGF0ZXBhcnNlclwiLFwidWkuYm9vdHN0cmFwLnBvc2l0aW9uXCIsXCJ1aS5ib290c3RyYXAuZGF0ZXBpY2tlclwiLFwidWkuYm9vdHN0cmFwLmRyb3Bkb3duXCIsXCJ1aS5ib290c3RyYXAubW9kYWxcIixcInVpLmJvb3RzdHJhcC5wYWdpbmF0aW9uXCIsXCJ1aS5ib290c3RyYXAudG9vbHRpcFwiLFwidWkuYm9vdHN0cmFwLnBvcG92ZXJcIixcInVpLmJvb3RzdHJhcC5wcm9ncmVzc2JhclwiLFwidWkuYm9vdHN0cmFwLnJhdGluZ1wiLFwidWkuYm9vdHN0cmFwLnRhYnNcIixcInVpLmJvb3RzdHJhcC50aW1lcGlja2VyXCIsXCJ1aS5ib290c3RyYXAudHlwZWFoZWFkXCJdKSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC50cGxzXCIsW1widGVtcGxhdGUvYWNjb3JkaW9uL2FjY29yZGlvbi1ncm91cC5odG1sXCIsXCJ0ZW1wbGF0ZS9hY2NvcmRpb24vYWNjb3JkaW9uLmh0bWxcIixcInRlbXBsYXRlL2FsZXJ0L2FsZXJ0Lmh0bWxcIixcInRlbXBsYXRlL2Nhcm91c2VsL2Nhcm91c2VsLmh0bWxcIixcInRlbXBsYXRlL2Nhcm91c2VsL3NsaWRlLmh0bWxcIixcInRlbXBsYXRlL2RhdGVwaWNrZXIvZGF0ZXBpY2tlci5odG1sXCIsXCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL2RheS5odG1sXCIsXCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL21vbnRoLmh0bWxcIixcInRlbXBsYXRlL2RhdGVwaWNrZXIvcG9wdXAuaHRtbFwiLFwidGVtcGxhdGUvZGF0ZXBpY2tlci95ZWFyLmh0bWxcIixcInRlbXBsYXRlL21vZGFsL2JhY2tkcm9wLmh0bWxcIixcInRlbXBsYXRlL21vZGFsL3dpbmRvdy5odG1sXCIsXCJ0ZW1wbGF0ZS9wYWdpbmF0aW9uL3BhZ2VyLmh0bWxcIixcInRlbXBsYXRlL3BhZ2luYXRpb24vcGFnaW5hdGlvbi5odG1sXCIsXCJ0ZW1wbGF0ZS90b29sdGlwL3Rvb2x0aXAtaHRtbC11bnNhZmUtcG9wdXAuaHRtbFwiLFwidGVtcGxhdGUvdG9vbHRpcC90b29sdGlwLXBvcHVwLmh0bWxcIixcInRlbXBsYXRlL3BvcG92ZXIvcG9wb3Zlci5odG1sXCIsXCJ0ZW1wbGF0ZS9wcm9ncmVzc2Jhci9iYXIuaHRtbFwiLFwidGVtcGxhdGUvcHJvZ3Jlc3NiYXIvcHJvZ3Jlc3MuaHRtbFwiLFwidGVtcGxhdGUvcHJvZ3Jlc3NiYXIvcHJvZ3Jlc3NiYXIuaHRtbFwiLFwidGVtcGxhdGUvcmF0aW5nL3JhdGluZy5odG1sXCIsXCJ0ZW1wbGF0ZS90YWJzL3RhYi5odG1sXCIsXCJ0ZW1wbGF0ZS90YWJzL3RhYnNldC5odG1sXCIsXCJ0ZW1wbGF0ZS90aW1lcGlja2VyL3RpbWVwaWNrZXIuaHRtbFwiLFwidGVtcGxhdGUvdHlwZWFoZWFkL3R5cGVhaGVhZC1tYXRjaC5odG1sXCIsXCJ0ZW1wbGF0ZS90eXBlYWhlYWQvdHlwZWFoZWFkLXBvcHVwLmh0bWxcIl0pLGFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwLnRyYW5zaXRpb25cIixbXSkuZmFjdG9yeShcIiR0cmFuc2l0aW9uXCIsW1wiJHFcIixcIiR0aW1lb3V0XCIsXCIkcm9vdFNjb3BlXCIsZnVuY3Rpb24oYSxiLGMpe2Z1bmN0aW9uIGQoYSl7Zm9yKHZhciBiIGluIGEpaWYodm9pZCAwIT09Zi5zdHlsZVtiXSlyZXR1cm4gYVtiXX12YXIgZT1mdW5jdGlvbihkLGYsZyl7Zz1nfHx7fTt2YXIgaD1hLmRlZmVyKCksaT1lW2cuYW5pbWF0aW9uP1wiYW5pbWF0aW9uRW5kRXZlbnROYW1lXCI6XCJ0cmFuc2l0aW9uRW5kRXZlbnROYW1lXCJdLGo9ZnVuY3Rpb24oKXtjLiRhcHBseShmdW5jdGlvbigpe2QudW5iaW5kKGksaiksaC5yZXNvbHZlKGQpfSl9O3JldHVybiBpJiZkLmJpbmQoaSxqKSxiKGZ1bmN0aW9uKCl7YW5ndWxhci5pc1N0cmluZyhmKT9kLmFkZENsYXNzKGYpOmFuZ3VsYXIuaXNGdW5jdGlvbihmKT9mKGQpOmFuZ3VsYXIuaXNPYmplY3QoZikmJmQuY3NzKGYpLGl8fGgucmVzb2x2ZShkKX0pLGgucHJvbWlzZS5jYW5jZWw9ZnVuY3Rpb24oKXtpJiZkLnVuYmluZChpLGopLGgucmVqZWN0KFwiVHJhbnNpdGlvbiBjYW5jZWxsZWRcIil9LGgucHJvbWlzZX0sZj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidHJhbnNcIiksZz17V2Via2l0VHJhbnNpdGlvbjpcIndlYmtpdFRyYW5zaXRpb25FbmRcIixNb3pUcmFuc2l0aW9uOlwidHJhbnNpdGlvbmVuZFwiLE9UcmFuc2l0aW9uOlwib1RyYW5zaXRpb25FbmRcIix0cmFuc2l0aW9uOlwidHJhbnNpdGlvbmVuZFwifSxoPXtXZWJraXRUcmFuc2l0aW9uOlwid2Via2l0QW5pbWF0aW9uRW5kXCIsTW96VHJhbnNpdGlvbjpcImFuaW1hdGlvbmVuZFwiLE9UcmFuc2l0aW9uOlwib0FuaW1hdGlvbkVuZFwiLHRyYW5zaXRpb246XCJhbmltYXRpb25lbmRcIn07cmV0dXJuIGUudHJhbnNpdGlvbkVuZEV2ZW50TmFtZT1kKGcpLGUuYW5pbWF0aW9uRW5kRXZlbnROYW1lPWQoaCksZX1dKSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC5jb2xsYXBzZVwiLFtcInVpLmJvb3RzdHJhcC50cmFuc2l0aW9uXCJdKS5kaXJlY3RpdmUoXCJjb2xsYXBzZVwiLFtcIiR0cmFuc2l0aW9uXCIsZnVuY3Rpb24oYSl7cmV0dXJue2xpbms6ZnVuY3Rpb24oYixjLGQpe2Z1bmN0aW9uIGUoYil7ZnVuY3Rpb24gZCgpe2o9PT1lJiYoaj12b2lkIDApfXZhciBlPWEoYyxiKTtyZXR1cm4gaiYmai5jYW5jZWwoKSxqPWUsZS50aGVuKGQsZCksZX1mdW5jdGlvbiBmKCl7az8oaz0hMSxnKCkpOihjLnJlbW92ZUNsYXNzKFwiY29sbGFwc2VcIikuYWRkQ2xhc3MoXCJjb2xsYXBzaW5nXCIpLGUoe2hlaWdodDpjWzBdLnNjcm9sbEhlaWdodCtcInB4XCJ9KS50aGVuKGcpKX1mdW5jdGlvbiBnKCl7Yy5yZW1vdmVDbGFzcyhcImNvbGxhcHNpbmdcIiksYy5hZGRDbGFzcyhcImNvbGxhcHNlIGluXCIpLGMuY3NzKHtoZWlnaHQ6XCJhdXRvXCJ9KX1mdW5jdGlvbiBoKCl7aWYoaylrPSExLGkoKSxjLmNzcyh7aGVpZ2h0OjB9KTtlbHNle2MuY3NzKHtoZWlnaHQ6Y1swXS5zY3JvbGxIZWlnaHQrXCJweFwifSk7e2NbMF0ub2Zmc2V0V2lkdGh9Yy5yZW1vdmVDbGFzcyhcImNvbGxhcHNlIGluXCIpLmFkZENsYXNzKFwiY29sbGFwc2luZ1wiKSxlKHtoZWlnaHQ6MH0pLnRoZW4oaSl9fWZ1bmN0aW9uIGkoKXtjLnJlbW92ZUNsYXNzKFwiY29sbGFwc2luZ1wiKSxjLmFkZENsYXNzKFwiY29sbGFwc2VcIil9dmFyIGosaz0hMDtiLiR3YXRjaChkLmNvbGxhcHNlLGZ1bmN0aW9uKGEpe2E/aCgpOmYoKX0pfX19XSksYW5ndWxhci5tb2R1bGUoXCJ1aS5ib290c3RyYXAuYWNjb3JkaW9uXCIsW1widWkuYm9vdHN0cmFwLmNvbGxhcHNlXCJdKS5jb25zdGFudChcImFjY29yZGlvbkNvbmZpZ1wiLHtjbG9zZU90aGVyczohMH0pLmNvbnRyb2xsZXIoXCJBY2NvcmRpb25Db250cm9sbGVyXCIsW1wiJHNjb3BlXCIsXCIkYXR0cnNcIixcImFjY29yZGlvbkNvbmZpZ1wiLGZ1bmN0aW9uKGEsYixjKXt0aGlzLmdyb3Vwcz1bXSx0aGlzLmNsb3NlT3RoZXJzPWZ1bmN0aW9uKGQpe3ZhciBlPWFuZ3VsYXIuaXNEZWZpbmVkKGIuY2xvc2VPdGhlcnMpP2EuJGV2YWwoYi5jbG9zZU90aGVycyk6Yy5jbG9zZU90aGVycztlJiZhbmd1bGFyLmZvckVhY2godGhpcy5ncm91cHMsZnVuY3Rpb24oYSl7YSE9PWQmJihhLmlzT3Blbj0hMSl9KX0sdGhpcy5hZGRHcm91cD1mdW5jdGlvbihhKXt2YXIgYj10aGlzO3RoaXMuZ3JvdXBzLnB1c2goYSksYS4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7Yi5yZW1vdmVHcm91cChhKX0pfSx0aGlzLnJlbW92ZUdyb3VwPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZ3JvdXBzLmluZGV4T2YoYSk7LTEhPT1iJiZ0aGlzLmdyb3Vwcy5zcGxpY2UoYiwxKX19XSkuZGlyZWN0aXZlKFwiYWNjb3JkaW9uXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLGNvbnRyb2xsZXI6XCJBY2NvcmRpb25Db250cm9sbGVyXCIsdHJhbnNjbHVkZTohMCxyZXBsYWNlOiExLHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvYWNjb3JkaW9uL2FjY29yZGlvbi5odG1sXCJ9fSkuZGlyZWN0aXZlKFwiYWNjb3JkaW9uR3JvdXBcIixmdW5jdGlvbigpe3JldHVybntyZXF1aXJlOlwiXmFjY29yZGlvblwiLHJlc3RyaWN0OlwiRUFcIix0cmFuc2NsdWRlOiEwLHJlcGxhY2U6ITAsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZS9hY2NvcmRpb24vYWNjb3JkaW9uLWdyb3VwLmh0bWxcIixzY29wZTp7aGVhZGluZzpcIkBcIixpc09wZW46XCI9P1wiLGlzRGlzYWJsZWQ6XCI9P1wifSxjb250cm9sbGVyOmZ1bmN0aW9uKCl7dGhpcy5zZXRIZWFkaW5nPWZ1bmN0aW9uKGEpe3RoaXMuaGVhZGluZz1hfX0sbGluazpmdW5jdGlvbihhLGIsYyxkKXtkLmFkZEdyb3VwKGEpLGEuJHdhdGNoKFwiaXNPcGVuXCIsZnVuY3Rpb24oYil7YiYmZC5jbG9zZU90aGVycyhhKX0pLGEudG9nZ2xlT3Blbj1mdW5jdGlvbigpe2EuaXNEaXNhYmxlZHx8KGEuaXNPcGVuPSFhLmlzT3Blbil9fX19KS5kaXJlY3RpdmUoXCJhY2NvcmRpb25IZWFkaW5nXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHRyYW5zY2x1ZGU6ITAsdGVtcGxhdGU6XCJcIixyZXBsYWNlOiEwLHJlcXVpcmU6XCJeYWNjb3JkaW9uR3JvdXBcIixsaW5rOmZ1bmN0aW9uKGEsYixjLGQsZSl7ZC5zZXRIZWFkaW5nKGUoYSxmdW5jdGlvbigpe30pKX19fSkuZGlyZWN0aXZlKFwiYWNjb3JkaW9uVHJhbnNjbHVkZVwiLGZ1bmN0aW9uKCl7cmV0dXJue3JlcXVpcmU6XCJeYWNjb3JkaW9uR3JvdXBcIixsaW5rOmZ1bmN0aW9uKGEsYixjLGQpe2EuJHdhdGNoKGZ1bmN0aW9uKCl7cmV0dXJuIGRbYy5hY2NvcmRpb25UcmFuc2NsdWRlXX0sZnVuY3Rpb24oYSl7YSYmKGIuaHRtbChcIlwiKSxiLmFwcGVuZChhKSl9KX19fSksYW5ndWxhci5tb2R1bGUoXCJ1aS5ib290c3RyYXAuYWxlcnRcIixbXSkuY29udHJvbGxlcihcIkFsZXJ0Q29udHJvbGxlclwiLFtcIiRzY29wZVwiLFwiJGF0dHJzXCIsZnVuY3Rpb24oYSxiKXthLmNsb3NlYWJsZT1cImNsb3NlXCJpbiBifV0pLmRpcmVjdGl2ZShcImFsZXJ0XCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLGNvbnRyb2xsZXI6XCJBbGVydENvbnRyb2xsZXJcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL2FsZXJ0L2FsZXJ0Lmh0bWxcIix0cmFuc2NsdWRlOiEwLHJlcGxhY2U6ITAsc2NvcGU6e3R5cGU6XCJAXCIsY2xvc2U6XCImXCJ9fX0pLGFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwLmJpbmRIdG1sXCIsW10pLmRpcmVjdGl2ZShcImJpbmRIdG1sVW5zYWZlXCIsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxiLGMpe2IuYWRkQ2xhc3MoXCJuZy1iaW5kaW5nXCIpLmRhdGEoXCIkYmluZGluZ1wiLGMuYmluZEh0bWxVbnNhZmUpLGEuJHdhdGNoKGMuYmluZEh0bWxVbnNhZmUsZnVuY3Rpb24oYSl7Yi5odG1sKGF8fFwiXCIpfSl9fSksYW5ndWxhci5tb2R1bGUoXCJ1aS5ib290c3RyYXAuYnV0dG9uc1wiLFtdKS5jb25zdGFudChcImJ1dHRvbkNvbmZpZ1wiLHthY3RpdmVDbGFzczpcImFjdGl2ZVwiLHRvZ2dsZUV2ZW50OlwiY2xpY2tcIn0pLmNvbnRyb2xsZXIoXCJCdXR0b25zQ29udHJvbGxlclwiLFtcImJ1dHRvbkNvbmZpZ1wiLGZ1bmN0aW9uKGEpe3RoaXMuYWN0aXZlQ2xhc3M9YS5hY3RpdmVDbGFzc3x8XCJhY3RpdmVcIix0aGlzLnRvZ2dsZUV2ZW50PWEudG9nZ2xlRXZlbnR8fFwiY2xpY2tcIn1dKS5kaXJlY3RpdmUoXCJidG5SYWRpb1wiLGZ1bmN0aW9uKCl7cmV0dXJue3JlcXVpcmU6W1wiYnRuUmFkaW9cIixcIm5nTW9kZWxcIl0sY29udHJvbGxlcjpcIkJ1dHRvbnNDb250cm9sbGVyXCIsbGluazpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1kWzBdLGY9ZFsxXTtmLiRyZW5kZXI9ZnVuY3Rpb24oKXtiLnRvZ2dsZUNsYXNzKGUuYWN0aXZlQ2xhc3MsYW5ndWxhci5lcXVhbHMoZi4kbW9kZWxWYWx1ZSxhLiRldmFsKGMuYnRuUmFkaW8pKSl9LGIuYmluZChlLnRvZ2dsZUV2ZW50LGZ1bmN0aW9uKCl7dmFyIGQ9Yi5oYXNDbGFzcyhlLmFjdGl2ZUNsYXNzKTsoIWR8fGFuZ3VsYXIuaXNEZWZpbmVkKGMudW5jaGVja2FibGUpKSYmYS4kYXBwbHkoZnVuY3Rpb24oKXtmLiRzZXRWaWV3VmFsdWUoZD9udWxsOmEuJGV2YWwoYy5idG5SYWRpbykpLGYuJHJlbmRlcigpfSl9KX19fSkuZGlyZWN0aXZlKFwiYnRuQ2hlY2tib3hcIixmdW5jdGlvbigpe3JldHVybntyZXF1aXJlOltcImJ0bkNoZWNrYm94XCIsXCJuZ01vZGVsXCJdLGNvbnRyb2xsZXI6XCJCdXR0b25zQ29udHJvbGxlclwiLGxpbms6ZnVuY3Rpb24oYSxiLGMsZCl7ZnVuY3Rpb24gZSgpe3JldHVybiBnKGMuYnRuQ2hlY2tib3hUcnVlLCEwKX1mdW5jdGlvbiBmKCl7cmV0dXJuIGcoYy5idG5DaGVja2JveEZhbHNlLCExKX1mdW5jdGlvbiBnKGIsYyl7dmFyIGQ9YS4kZXZhbChiKTtyZXR1cm4gYW5ndWxhci5pc0RlZmluZWQoZCk/ZDpjfXZhciBoPWRbMF0saT1kWzFdO2kuJHJlbmRlcj1mdW5jdGlvbigpe2IudG9nZ2xlQ2xhc3MoaC5hY3RpdmVDbGFzcyxhbmd1bGFyLmVxdWFscyhpLiRtb2RlbFZhbHVlLGUoKSkpfSxiLmJpbmQoaC50b2dnbGVFdmVudCxmdW5jdGlvbigpe2EuJGFwcGx5KGZ1bmN0aW9uKCl7aS4kc2V0Vmlld1ZhbHVlKGIuaGFzQ2xhc3MoaC5hY3RpdmVDbGFzcyk/ZigpOmUoKSksaS4kcmVuZGVyKCl9KX0pfX19KSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC5jYXJvdXNlbFwiLFtcInVpLmJvb3RzdHJhcC50cmFuc2l0aW9uXCJdKS5jb250cm9sbGVyKFwiQ2Fyb3VzZWxDb250cm9sbGVyXCIsW1wiJHNjb3BlXCIsXCIkdGltZW91dFwiLFwiJHRyYW5zaXRpb25cIixmdW5jdGlvbihhLGIsYyl7ZnVuY3Rpb24gZCgpe2UoKTt2YXIgYz0rYS5pbnRlcnZhbDshaXNOYU4oYykmJmM+PTAmJihnPWIoZixjKSl9ZnVuY3Rpb24gZSgpe2cmJihiLmNhbmNlbChnKSxnPW51bGwpfWZ1bmN0aW9uIGYoKXtoPyhhLm5leHQoKSxkKCkpOmEucGF1c2UoKX12YXIgZyxoLGk9dGhpcyxqPWkuc2xpZGVzPWEuc2xpZGVzPVtdLGs9LTE7aS5jdXJyZW50U2xpZGU9bnVsbDt2YXIgbD0hMTtpLnNlbGVjdD1hLnNlbGVjdD1mdW5jdGlvbihlLGYpe2Z1bmN0aW9uIGcoKXtpZighbCl7aWYoaS5jdXJyZW50U2xpZGUmJmFuZ3VsYXIuaXNTdHJpbmcoZikmJiFhLm5vVHJhbnNpdGlvbiYmZS4kZWxlbWVudCl7ZS4kZWxlbWVudC5hZGRDbGFzcyhmKTt7ZS4kZWxlbWVudFswXS5vZmZzZXRXaWR0aH1hbmd1bGFyLmZvckVhY2goaixmdW5jdGlvbihhKXthbmd1bGFyLmV4dGVuZChhLHtkaXJlY3Rpb246XCJcIixlbnRlcmluZzohMSxsZWF2aW5nOiExLGFjdGl2ZTohMX0pfSksYW5ndWxhci5leHRlbmQoZSx7ZGlyZWN0aW9uOmYsYWN0aXZlOiEwLGVudGVyaW5nOiEwfSksYW5ndWxhci5leHRlbmQoaS5jdXJyZW50U2xpZGV8fHt9LHtkaXJlY3Rpb246ZixsZWF2aW5nOiEwfSksYS4kY3VycmVudFRyYW5zaXRpb249YyhlLiRlbGVtZW50LHt9KSxmdW5jdGlvbihiLGMpe2EuJGN1cnJlbnRUcmFuc2l0aW9uLnRoZW4oZnVuY3Rpb24oKXtoKGIsYyl9LGZ1bmN0aW9uKCl7aChiLGMpfSl9KGUsaS5jdXJyZW50U2xpZGUpfWVsc2UgaChlLGkuY3VycmVudFNsaWRlKTtpLmN1cnJlbnRTbGlkZT1lLGs9bSxkKCl9fWZ1bmN0aW9uIGgoYixjKXthbmd1bGFyLmV4dGVuZChiLHtkaXJlY3Rpb246XCJcIixhY3RpdmU6ITAsbGVhdmluZzohMSxlbnRlcmluZzohMX0pLGFuZ3VsYXIuZXh0ZW5kKGN8fHt9LHtkaXJlY3Rpb246XCJcIixhY3RpdmU6ITEsbGVhdmluZzohMSxlbnRlcmluZzohMX0pLGEuJGN1cnJlbnRUcmFuc2l0aW9uPW51bGx9dmFyIG09ai5pbmRleE9mKGUpO3ZvaWQgMD09PWYmJihmPW0+az9cIm5leHRcIjpcInByZXZcIiksZSYmZSE9PWkuY3VycmVudFNsaWRlJiYoYS4kY3VycmVudFRyYW5zaXRpb24/KGEuJGN1cnJlbnRUcmFuc2l0aW9uLmNhbmNlbCgpLGIoZykpOmcoKSl9LGEuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2w9ITB9KSxpLmluZGV4T2ZTbGlkZT1mdW5jdGlvbihhKXtyZXR1cm4gai5pbmRleE9mKGEpfSxhLm5leHQ9ZnVuY3Rpb24oKXt2YXIgYj0oaysxKSVqLmxlbmd0aDtyZXR1cm4gYS4kY3VycmVudFRyYW5zaXRpb24/dm9pZCAwOmkuc2VsZWN0KGpbYl0sXCJuZXh0XCIpfSxhLnByZXY9ZnVuY3Rpb24oKXt2YXIgYj0wPmstMT9qLmxlbmd0aC0xOmstMTtyZXR1cm4gYS4kY3VycmVudFRyYW5zaXRpb24/dm9pZCAwOmkuc2VsZWN0KGpbYl0sXCJwcmV2XCIpfSxhLmlzQWN0aXZlPWZ1bmN0aW9uKGEpe3JldHVybiBpLmN1cnJlbnRTbGlkZT09PWF9LGEuJHdhdGNoKFwiaW50ZXJ2YWxcIixkKSxhLiRvbihcIiRkZXN0cm95XCIsZSksYS5wbGF5PWZ1bmN0aW9uKCl7aHx8KGg9ITAsZCgpKX0sYS5wYXVzZT1mdW5jdGlvbigpe2Eubm9QYXVzZXx8KGg9ITEsZSgpKX0saS5hZGRTbGlkZT1mdW5jdGlvbihiLGMpe2IuJGVsZW1lbnQ9YyxqLnB1c2goYiksMT09PWoubGVuZ3RofHxiLmFjdGl2ZT8oaS5zZWxlY3QoaltqLmxlbmd0aC0xXSksMT09ai5sZW5ndGgmJmEucGxheSgpKTpiLmFjdGl2ZT0hMX0saS5yZW1vdmVTbGlkZT1mdW5jdGlvbihhKXt2YXIgYj1qLmluZGV4T2YoYSk7ai5zcGxpY2UoYiwxKSxqLmxlbmd0aD4wJiZhLmFjdGl2ZT9pLnNlbGVjdChiPj1qLmxlbmd0aD9qW2ItMV06altiXSk6az5iJiZrLS19fV0pLmRpcmVjdGl2ZShcImNhcm91c2VsXCIsW2Z1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIix0cmFuc2NsdWRlOiEwLHJlcGxhY2U6ITAsY29udHJvbGxlcjpcIkNhcm91c2VsQ29udHJvbGxlclwiLHJlcXVpcmU6XCJjYXJvdXNlbFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvY2Fyb3VzZWwvY2Fyb3VzZWwuaHRtbFwiLHNjb3BlOntpbnRlcnZhbDpcIj1cIixub1RyYW5zaXRpb246XCI9XCIsbm9QYXVzZTpcIj1cIn19fV0pLmRpcmVjdGl2ZShcInNsaWRlXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVxdWlyZTpcIl5jYXJvdXNlbFwiLHJlc3RyaWN0OlwiRUFcIix0cmFuc2NsdWRlOiEwLHJlcGxhY2U6ITAsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZS9jYXJvdXNlbC9zbGlkZS5odG1sXCIsc2NvcGU6e2FjdGl2ZTpcIj0/XCJ9LGxpbms6ZnVuY3Rpb24oYSxiLGMsZCl7ZC5hZGRTbGlkZShhLGIpLGEuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2QucmVtb3ZlU2xpZGUoYSl9KSxhLiR3YXRjaChcImFjdGl2ZVwiLGZ1bmN0aW9uKGIpe2ImJmQuc2VsZWN0KGEpfSl9fX0pLGFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwLmRhdGVwYXJzZXJcIixbXSkuc2VydmljZShcImRhdGVQYXJzZXJcIixbXCIkbG9jYWxlXCIsXCJvcmRlckJ5RmlsdGVyXCIsZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBjKGEpe3ZhciBjPVtdLGQ9YS5zcGxpdChcIlwiKTtyZXR1cm4gYW5ndWxhci5mb3JFYWNoKGUsZnVuY3Rpb24oYixlKXt2YXIgZj1hLmluZGV4T2YoZSk7aWYoZj4tMSl7YT1hLnNwbGl0KFwiXCIpLGRbZl09XCIoXCIrYi5yZWdleCtcIilcIixhW2ZdPVwiJFwiO2Zvcih2YXIgZz1mKzEsaD1mK2UubGVuZ3RoO2g+ZztnKyspZFtnXT1cIlwiLGFbZ109XCIkXCI7YT1hLmpvaW4oXCJcIiksYy5wdXNoKHtpbmRleDpmLGFwcGx5OmIuYXBwbHl9KX19KSx7cmVnZXg6bmV3IFJlZ0V4cChcIl5cIitkLmpvaW4oXCJcIikrXCIkXCIpLG1hcDpiKGMsXCJpbmRleFwiKX19ZnVuY3Rpb24gZChhLGIsYyl7cmV0dXJuIDE9PT1iJiZjPjI4PzI5PT09YyYmKGElND09PTAmJmElMTAwIT09MHx8YSU0MDA9PT0wKTozPT09Ynx8NT09PWJ8fDg9PT1ifHwxMD09PWI/MzE+YzohMH10aGlzLnBhcnNlcnM9e307dmFyIGU9e3l5eXk6e3JlZ2V4OlwiXFxcXGR7NH1cIixhcHBseTpmdW5jdGlvbihhKXt0aGlzLnllYXI9K2F9fSx5eTp7cmVnZXg6XCJcXFxcZHsyfVwiLGFwcGx5OmZ1bmN0aW9uKGEpe3RoaXMueWVhcj0rYSsyZTN9fSx5OntyZWdleDpcIlxcXFxkezEsNH1cIixhcHBseTpmdW5jdGlvbihhKXt0aGlzLnllYXI9K2F9fSxNTU1NOntyZWdleDphLkRBVEVUSU1FX0ZPUk1BVFMuTU9OVEguam9pbihcInxcIiksYXBwbHk6ZnVuY3Rpb24oYil7dGhpcy5tb250aD1hLkRBVEVUSU1FX0ZPUk1BVFMuTU9OVEguaW5kZXhPZihiKX19LE1NTTp7cmVnZXg6YS5EQVRFVElNRV9GT1JNQVRTLlNIT1JUTU9OVEguam9pbihcInxcIiksYXBwbHk6ZnVuY3Rpb24oYil7dGhpcy5tb250aD1hLkRBVEVUSU1FX0ZPUk1BVFMuU0hPUlRNT05USC5pbmRleE9mKGIpfX0sTU06e3JlZ2V4OlwiMFsxLTldfDFbMC0yXVwiLGFwcGx5OmZ1bmN0aW9uKGEpe3RoaXMubW9udGg9YS0xfX0sTTp7cmVnZXg6XCJbMS05XXwxWzAtMl1cIixhcHBseTpmdW5jdGlvbihhKXt0aGlzLm1vbnRoPWEtMX19LGRkOntyZWdleDpcIlswLTJdWzAtOV17MX18M1swLTFdezF9XCIsYXBwbHk6ZnVuY3Rpb24oYSl7dGhpcy5kYXRlPSthfX0sZDp7cmVnZXg6XCJbMS0yXT9bMC05XXsxfXwzWzAtMV17MX1cIixhcHBseTpmdW5jdGlvbihhKXt0aGlzLmRhdGU9K2F9fSxFRUVFOntyZWdleDphLkRBVEVUSU1FX0ZPUk1BVFMuREFZLmpvaW4oXCJ8XCIpfSxFRUU6e3JlZ2V4OmEuREFURVRJTUVfRk9STUFUUy5TSE9SVERBWS5qb2luKFwifFwiKX19O3RoaXMucGFyc2U9ZnVuY3Rpb24oYixlKXtpZighYW5ndWxhci5pc1N0cmluZyhiKXx8IWUpcmV0dXJuIGI7ZT1hLkRBVEVUSU1FX0ZPUk1BVFNbZV18fGUsdGhpcy5wYXJzZXJzW2VdfHwodGhpcy5wYXJzZXJzW2VdPWMoZSkpO3ZhciBmPXRoaXMucGFyc2Vyc1tlXSxnPWYucmVnZXgsaD1mLm1hcCxpPWIubWF0Y2goZyk7aWYoaSYmaS5sZW5ndGgpe2Zvcih2YXIgaixrPXt5ZWFyOjE5MDAsbW9udGg6MCxkYXRlOjEsaG91cnM6MH0sbD0xLG09aS5sZW5ndGg7bT5sO2wrKyl7dmFyIG49aFtsLTFdO24uYXBwbHkmJm4uYXBwbHkuY2FsbChrLGlbbF0pfXJldHVybiBkKGsueWVhcixrLm1vbnRoLGsuZGF0ZSkmJihqPW5ldyBEYXRlKGsueWVhcixrLm1vbnRoLGsuZGF0ZSxrLmhvdXJzKSksan19fV0pLGFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwLnBvc2l0aW9uXCIsW10pLmZhY3RvcnkoXCIkcG9zaXRpb25cIixbXCIkZG9jdW1lbnRcIixcIiR3aW5kb3dcIixmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGMoYSxjKXtyZXR1cm4gYS5jdXJyZW50U3R5bGU/YS5jdXJyZW50U3R5bGVbY106Yi5nZXRDb21wdXRlZFN0eWxlP2IuZ2V0Q29tcHV0ZWRTdHlsZShhKVtjXTphLnN0eWxlW2NdfWZ1bmN0aW9uIGQoYSl7cmV0dXJuXCJzdGF0aWNcIj09PShjKGEsXCJwb3NpdGlvblwiKXx8XCJzdGF0aWNcIil9dmFyIGU9ZnVuY3Rpb24oYil7Zm9yKHZhciBjPWFbMF0sZT1iLm9mZnNldFBhcmVudHx8YztlJiZlIT09YyYmZChlKTspZT1lLm9mZnNldFBhcmVudDtyZXR1cm4gZXx8Y307cmV0dXJue3Bvc2l0aW9uOmZ1bmN0aW9uKGIpe3ZhciBjPXRoaXMub2Zmc2V0KGIpLGQ9e3RvcDowLGxlZnQ6MH0sZj1lKGJbMF0pO2YhPWFbMF0mJihkPXRoaXMub2Zmc2V0KGFuZ3VsYXIuZWxlbWVudChmKSksZC50b3ArPWYuY2xpZW50VG9wLWYuc2Nyb2xsVG9wLGQubGVmdCs9Zi5jbGllbnRMZWZ0LWYuc2Nyb2xsTGVmdCk7dmFyIGc9YlswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtyZXR1cm57d2lkdGg6Zy53aWR0aHx8Yi5wcm9wKFwib2Zmc2V0V2lkdGhcIiksaGVpZ2h0OmcuaGVpZ2h0fHxiLnByb3AoXCJvZmZzZXRIZWlnaHRcIiksdG9wOmMudG9wLWQudG9wLGxlZnQ6Yy5sZWZ0LWQubGVmdH19LG9mZnNldDpmdW5jdGlvbihjKXt2YXIgZD1jWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3JldHVybnt3aWR0aDpkLndpZHRofHxjLnByb3AoXCJvZmZzZXRXaWR0aFwiKSxoZWlnaHQ6ZC5oZWlnaHR8fGMucHJvcChcIm9mZnNldEhlaWdodFwiKSx0b3A6ZC50b3ArKGIucGFnZVlPZmZzZXR8fGFbMF0uZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCksbGVmdDpkLmxlZnQrKGIucGFnZVhPZmZzZXR8fGFbMF0uZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQpfX0scG9zaXRpb25FbGVtZW50czpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZSxmLGcsaCxpPWMuc3BsaXQoXCItXCIpLGo9aVswXSxrPWlbMV18fFwiY2VudGVyXCI7ZT1kP3RoaXMub2Zmc2V0KGEpOnRoaXMucG9zaXRpb24oYSksZj1iLnByb3AoXCJvZmZzZXRXaWR0aFwiKSxnPWIucHJvcChcIm9mZnNldEhlaWdodFwiKTt2YXIgbD17Y2VudGVyOmZ1bmN0aW9uKCl7cmV0dXJuIGUubGVmdCtlLndpZHRoLzItZi8yfSxsZWZ0OmZ1bmN0aW9uKCl7cmV0dXJuIGUubGVmdH0scmlnaHQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5sZWZ0K2Uud2lkdGh9fSxtPXtjZW50ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gZS50b3ArZS5oZWlnaHQvMi1nLzJ9LHRvcDpmdW5jdGlvbigpe3JldHVybiBlLnRvcH0sYm90dG9tOmZ1bmN0aW9uKCl7cmV0dXJuIGUudG9wK2UuaGVpZ2h0fX07c3dpdGNoKGope2Nhc2VcInJpZ2h0XCI6aD17dG9wOm1ba10oKSxsZWZ0Omxbal0oKX07YnJlYWs7Y2FzZVwibGVmdFwiOmg9e3RvcDptW2tdKCksbGVmdDplLmxlZnQtZn07YnJlYWs7Y2FzZVwiYm90dG9tXCI6aD17dG9wOm1bal0oKSxsZWZ0Omxba10oKX07YnJlYWs7ZGVmYXVsdDpoPXt0b3A6ZS50b3AtZyxsZWZ0Omxba10oKX19cmV0dXJuIGh9fX1dKSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC5kYXRlcGlja2VyXCIsW1widWkuYm9vdHN0cmFwLmRhdGVwYXJzZXJcIixcInVpLmJvb3RzdHJhcC5wb3NpdGlvblwiXSkuY29uc3RhbnQoXCJkYXRlcGlja2VyQ29uZmlnXCIse2Zvcm1hdERheTpcImRkXCIsZm9ybWF0TW9udGg6XCJNTU1NXCIsZm9ybWF0WWVhcjpcInl5eXlcIixmb3JtYXREYXlIZWFkZXI6XCJFRUVcIixmb3JtYXREYXlUaXRsZTpcIk1NTU0geXl5eVwiLGZvcm1hdE1vbnRoVGl0bGU6XCJ5eXl5XCIsZGF0ZXBpY2tlck1vZGU6XCJkYXlcIixtaW5Nb2RlOlwiZGF5XCIsbWF4TW9kZTpcInllYXJcIixzaG93V2Vla3M6ITAsc3RhcnRpbmdEYXk6MCx5ZWFyUmFuZ2U6MjAsbWluRGF0ZTpudWxsLG1heERhdGU6bnVsbH0pLmNvbnRyb2xsZXIoXCJEYXRlcGlja2VyQ29udHJvbGxlclwiLFtcIiRzY29wZVwiLFwiJGF0dHJzXCIsXCIkcGFyc2VcIixcIiRpbnRlcnBvbGF0ZVwiLFwiJHRpbWVvdXRcIixcIiRsb2dcIixcImRhdGVGaWx0ZXJcIixcImRhdGVwaWNrZXJDb25maWdcIixmdW5jdGlvbihhLGIsYyxkLGUsZixnLGgpe3ZhciBpPXRoaXMsaj17JHNldFZpZXdWYWx1ZTphbmd1bGFyLm5vb3B9O3RoaXMubW9kZXM9W1wiZGF5XCIsXCJtb250aFwiLFwieWVhclwiXSxhbmd1bGFyLmZvckVhY2goW1wiZm9ybWF0RGF5XCIsXCJmb3JtYXRNb250aFwiLFwiZm9ybWF0WWVhclwiLFwiZm9ybWF0RGF5SGVhZGVyXCIsXCJmb3JtYXREYXlUaXRsZVwiLFwiZm9ybWF0TW9udGhUaXRsZVwiLFwibWluTW9kZVwiLFwibWF4TW9kZVwiLFwic2hvd1dlZWtzXCIsXCJzdGFydGluZ0RheVwiLFwieWVhclJhbmdlXCJdLGZ1bmN0aW9uKGMsZSl7aVtjXT1hbmd1bGFyLmlzRGVmaW5lZChiW2NdKT84PmU/ZChiW2NdKShhLiRwYXJlbnQpOmEuJHBhcmVudC4kZXZhbChiW2NdKTpoW2NdfSksYW5ndWxhci5mb3JFYWNoKFtcIm1pbkRhdGVcIixcIm1heERhdGVcIl0sZnVuY3Rpb24oZCl7YltkXT9hLiRwYXJlbnQuJHdhdGNoKGMoYltkXSksZnVuY3Rpb24oYSl7aVtkXT1hP25ldyBEYXRlKGEpOm51bGwsaS5yZWZyZXNoVmlldygpfSk6aVtkXT1oW2RdP25ldyBEYXRlKGhbZF0pOm51bGx9KSxhLmRhdGVwaWNrZXJNb2RlPWEuZGF0ZXBpY2tlck1vZGV8fGguZGF0ZXBpY2tlck1vZGUsYS51bmlxdWVJZD1cImRhdGVwaWNrZXItXCIrYS4kaWQrXCItXCIrTWF0aC5mbG9vcigxZTQqTWF0aC5yYW5kb20oKSksdGhpcy5hY3RpdmVEYXRlPWFuZ3VsYXIuaXNEZWZpbmVkKGIuaW5pdERhdGUpP2EuJHBhcmVudC4kZXZhbChiLmluaXREYXRlKTpuZXcgRGF0ZSxhLmlzQWN0aXZlPWZ1bmN0aW9uKGIpe3JldHVybiAwPT09aS5jb21wYXJlKGIuZGF0ZSxpLmFjdGl2ZURhdGUpPyhhLmFjdGl2ZURhdGVJZD1iLnVpZCwhMCk6ITF9LHRoaXMuaW5pdD1mdW5jdGlvbihhKXtqPWEsai4kcmVuZGVyPWZ1bmN0aW9uKCl7aS5yZW5kZXIoKX19LHRoaXMucmVuZGVyPWZ1bmN0aW9uKCl7aWYoai4kbW9kZWxWYWx1ZSl7dmFyIGE9bmV3IERhdGUoai4kbW9kZWxWYWx1ZSksYj0haXNOYU4oYSk7Yj90aGlzLmFjdGl2ZURhdGU9YTpmLmVycm9yKCdEYXRlcGlja2VyIGRpcmVjdGl2ZTogXCJuZy1tb2RlbFwiIHZhbHVlIG11c3QgYmUgYSBEYXRlIG9iamVjdCwgYSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHNpbmNlIDAxLjAxLjE5NzAgb3IgYSBzdHJpbmcgcmVwcmVzZW50aW5nIGFuIFJGQzI4MjIgb3IgSVNPIDg2MDEgZGF0ZS4nKSxqLiRzZXRWYWxpZGl0eShcImRhdGVcIixiKX10aGlzLnJlZnJlc2hWaWV3KCl9LHRoaXMucmVmcmVzaFZpZXc9ZnVuY3Rpb24oKXtpZih0aGlzLmVsZW1lbnQpe3RoaXMuX3JlZnJlc2hWaWV3KCk7dmFyIGE9ai4kbW9kZWxWYWx1ZT9uZXcgRGF0ZShqLiRtb2RlbFZhbHVlKTpudWxsO2ouJHNldFZhbGlkaXR5KFwiZGF0ZS1kaXNhYmxlZFwiLCFhfHx0aGlzLmVsZW1lbnQmJiF0aGlzLmlzRGlzYWJsZWQoYSkpfX0sdGhpcy5jcmVhdGVEYXRlT2JqZWN0PWZ1bmN0aW9uKGEsYil7dmFyIGM9ai4kbW9kZWxWYWx1ZT9uZXcgRGF0ZShqLiRtb2RlbFZhbHVlKTpudWxsO3JldHVybntkYXRlOmEsbGFiZWw6ZyhhLGIpLHNlbGVjdGVkOmMmJjA9PT10aGlzLmNvbXBhcmUoYSxjKSxkaXNhYmxlZDp0aGlzLmlzRGlzYWJsZWQoYSksY3VycmVudDowPT09dGhpcy5jb21wYXJlKGEsbmV3IERhdGUpfX0sdGhpcy5pc0Rpc2FibGVkPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLm1pbkRhdGUmJnRoaXMuY29tcGFyZShjLHRoaXMubWluRGF0ZSk8MHx8dGhpcy5tYXhEYXRlJiZ0aGlzLmNvbXBhcmUoYyx0aGlzLm1heERhdGUpPjB8fGIuZGF0ZURpc2FibGVkJiZhLmRhdGVEaXNhYmxlZCh7ZGF0ZTpjLG1vZGU6YS5kYXRlcGlja2VyTW9kZX0pfSx0aGlzLnNwbGl0PWZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPVtdO2EubGVuZ3RoPjA7KWMucHVzaChhLnNwbGljZSgwLGIpKTtyZXR1cm4gY30sYS5zZWxlY3Q9ZnVuY3Rpb24oYil7aWYoYS5kYXRlcGlja2VyTW9kZT09PWkubWluTW9kZSl7dmFyIGM9ai4kbW9kZWxWYWx1ZT9uZXcgRGF0ZShqLiRtb2RlbFZhbHVlKTpuZXcgRGF0ZSgwLDAsMCwwLDAsMCwwKTtjLnNldEZ1bGxZZWFyKGIuZ2V0RnVsbFllYXIoKSxiLmdldE1vbnRoKCksYi5nZXREYXRlKCkpLGouJHNldFZpZXdWYWx1ZShjKSxqLiRyZW5kZXIoKX1lbHNlIGkuYWN0aXZlRGF0ZT1iLGEuZGF0ZXBpY2tlck1vZGU9aS5tb2Rlc1tpLm1vZGVzLmluZGV4T2YoYS5kYXRlcGlja2VyTW9kZSktMV19LGEubW92ZT1mdW5jdGlvbihhKXt2YXIgYj1pLmFjdGl2ZURhdGUuZ2V0RnVsbFllYXIoKSthKihpLnN0ZXAueWVhcnN8fDApLGM9aS5hY3RpdmVEYXRlLmdldE1vbnRoKCkrYSooaS5zdGVwLm1vbnRoc3x8MCk7aS5hY3RpdmVEYXRlLnNldEZ1bGxZZWFyKGIsYywxKSxpLnJlZnJlc2hWaWV3KCl9LGEudG9nZ2xlTW9kZT1mdW5jdGlvbihiKXtiPWJ8fDEsYS5kYXRlcGlja2VyTW9kZT09PWkubWF4TW9kZSYmMT09PWJ8fGEuZGF0ZXBpY2tlck1vZGU9PT1pLm1pbk1vZGUmJi0xPT09Ynx8KGEuZGF0ZXBpY2tlck1vZGU9aS5tb2Rlc1tpLm1vZGVzLmluZGV4T2YoYS5kYXRlcGlja2VyTW9kZSkrYl0pfSxhLmtleXM9ezEzOlwiZW50ZXJcIiwzMjpcInNwYWNlXCIsMzM6XCJwYWdldXBcIiwzNDpcInBhZ2Vkb3duXCIsMzU6XCJlbmRcIiwzNjpcImhvbWVcIiwzNzpcImxlZnRcIiwzODpcInVwXCIsMzk6XCJyaWdodFwiLDQwOlwiZG93blwifTt2YXIgaz1mdW5jdGlvbigpe2UoZnVuY3Rpb24oKXtpLmVsZW1lbnRbMF0uZm9jdXMoKX0sMCwhMSl9O2EuJG9uKFwiZGF0ZXBpY2tlci5mb2N1c1wiLGspLGEua2V5ZG93bj1mdW5jdGlvbihiKXt2YXIgYz1hLmtleXNbYi53aGljaF07aWYoYyYmIWIuc2hpZnRLZXkmJiFiLmFsdEtleSlpZihiLnByZXZlbnREZWZhdWx0KCksYi5zdG9wUHJvcGFnYXRpb24oKSxcImVudGVyXCI9PT1jfHxcInNwYWNlXCI9PT1jKXtpZihpLmlzRGlzYWJsZWQoaS5hY3RpdmVEYXRlKSlyZXR1cm47YS5zZWxlY3QoaS5hY3RpdmVEYXRlKSxrKCl9ZWxzZSFiLmN0cmxLZXl8fFwidXBcIiE9PWMmJlwiZG93blwiIT09Yz8oaS5oYW5kbGVLZXlEb3duKGMsYiksaS5yZWZyZXNoVmlldygpKTooYS50b2dnbGVNb2RlKFwidXBcIj09PWM/MTotMSksaygpKX19XSkuZGlyZWN0aXZlKFwiZGF0ZXBpY2tlclwiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixyZXBsYWNlOiEwLHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvZGF0ZXBpY2tlci9kYXRlcGlja2VyLmh0bWxcIixzY29wZTp7ZGF0ZXBpY2tlck1vZGU6XCI9P1wiLGRhdGVEaXNhYmxlZDpcIiZcIn0scmVxdWlyZTpbXCJkYXRlcGlja2VyXCIsXCI/Xm5nTW9kZWxcIl0sY29udHJvbGxlcjpcIkRhdGVwaWNrZXJDb250cm9sbGVyXCIsbGluazpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1kWzBdLGY9ZFsxXTtmJiZlLmluaXQoZil9fX0pLmRpcmVjdGl2ZShcImRheXBpY2tlclwiLFtcImRhdGVGaWx0ZXJcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHJlcGxhY2U6ITAsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL2RheS5odG1sXCIscmVxdWlyZTpcIl5kYXRlcGlja2VyXCIsbGluazpmdW5jdGlvbihiLGMsZCxlKXtmdW5jdGlvbiBmKGEsYil7cmV0dXJuIDEhPT1ifHxhJTQhPT0wfHxhJTEwMD09PTAmJmElNDAwIT09MD9pW2JdOjI5fWZ1bmN0aW9uIGcoYSxiKXt2YXIgYz1uZXcgQXJyYXkoYiksZD1uZXcgRGF0ZShhKSxlPTA7Zm9yKGQuc2V0SG91cnMoMTIpO2I+ZTspY1tlKytdPW5ldyBEYXRlKGQpLGQuc2V0RGF0ZShkLmdldERhdGUoKSsxKTtyZXR1cm4gY31mdW5jdGlvbiBoKGEpe3ZhciBiPW5ldyBEYXRlKGEpO2Iuc2V0RGF0ZShiLmdldERhdGUoKSs0LShiLmdldERheSgpfHw3KSk7dmFyIGM9Yi5nZXRUaW1lKCk7cmV0dXJuIGIuc2V0TW9udGgoMCksYi5zZXREYXRlKDEpLE1hdGguZmxvb3IoTWF0aC5yb3VuZCgoYy1iKS84NjRlNSkvNykrMX1iLnNob3dXZWVrcz1lLnNob3dXZWVrcyxlLnN0ZXA9e21vbnRoczoxfSxlLmVsZW1lbnQ9Yzt2YXIgaT1bMzEsMjgsMzEsMzAsMzEsMzAsMzEsMzEsMzAsMzEsMzAsMzFdO2UuX3JlZnJlc2hWaWV3PWZ1bmN0aW9uKCl7dmFyIGM9ZS5hY3RpdmVEYXRlLmdldEZ1bGxZZWFyKCksZD1lLmFjdGl2ZURhdGUuZ2V0TW9udGgoKSxmPW5ldyBEYXRlKGMsZCwxKSxpPWUuc3RhcnRpbmdEYXktZi5nZXREYXkoKSxqPWk+MD83LWk6LWksaz1uZXcgRGF0ZShmKTtqPjAmJmsuc2V0RGF0ZSgtaisxKTtmb3IodmFyIGw9ZyhrLDQyKSxtPTA7NDI+bTttKyspbFttXT1hbmd1bGFyLmV4dGVuZChlLmNyZWF0ZURhdGVPYmplY3QobFttXSxlLmZvcm1hdERheSkse3NlY29uZGFyeTpsW21dLmdldE1vbnRoKCkhPT1kLHVpZDpiLnVuaXF1ZUlkK1wiLVwiK219KTtiLmxhYmVscz1uZXcgQXJyYXkoNyk7Zm9yKHZhciBuPTA7Nz5uO24rKyliLmxhYmVsc1tuXT17YWJicjphKGxbbl0uZGF0ZSxlLmZvcm1hdERheUhlYWRlciksZnVsbDphKGxbbl0uZGF0ZSxcIkVFRUVcIil9O2lmKGIudGl0bGU9YShlLmFjdGl2ZURhdGUsZS5mb3JtYXREYXlUaXRsZSksYi5yb3dzPWUuc3BsaXQobCw3KSxiLnNob3dXZWVrcyl7Yi53ZWVrTnVtYmVycz1bXTtmb3IodmFyIG89aChiLnJvd3NbMF1bMF0uZGF0ZSkscD1iLnJvd3MubGVuZ3RoO2Iud2Vla051bWJlcnMucHVzaChvKyspPHA7KTt9fSxlLmNvbXBhcmU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IERhdGUoYS5nZXRGdWxsWWVhcigpLGEuZ2V0TW9udGgoKSxhLmdldERhdGUoKSktbmV3IERhdGUoYi5nZXRGdWxsWWVhcigpLGIuZ2V0TW9udGgoKSxiLmdldERhdGUoKSl9LGUuaGFuZGxlS2V5RG93bj1mdW5jdGlvbihhKXt2YXIgYj1lLmFjdGl2ZURhdGUuZ2V0RGF0ZSgpO2lmKFwibGVmdFwiPT09YSliLT0xO2Vsc2UgaWYoXCJ1cFwiPT09YSliLT03O2Vsc2UgaWYoXCJyaWdodFwiPT09YSliKz0xO2Vsc2UgaWYoXCJkb3duXCI9PT1hKWIrPTc7ZWxzZSBpZihcInBhZ2V1cFwiPT09YXx8XCJwYWdlZG93blwiPT09YSl7dmFyIGM9ZS5hY3RpdmVEYXRlLmdldE1vbnRoKCkrKFwicGFnZXVwXCI9PT1hPy0xOjEpO2UuYWN0aXZlRGF0ZS5zZXRNb250aChjLDEpLGI9TWF0aC5taW4oZihlLmFjdGl2ZURhdGUuZ2V0RnVsbFllYXIoKSxlLmFjdGl2ZURhdGUuZ2V0TW9udGgoKSksYil9ZWxzZVwiaG9tZVwiPT09YT9iPTE6XCJlbmRcIj09PWEmJihiPWYoZS5hY3RpdmVEYXRlLmdldEZ1bGxZZWFyKCksZS5hY3RpdmVEYXRlLmdldE1vbnRoKCkpKTtlLmFjdGl2ZURhdGUuc2V0RGF0ZShiKX0sZS5yZWZyZXNoVmlldygpfX19XSkuZGlyZWN0aXZlKFwibW9udGhwaWNrZXJcIixbXCJkYXRlRmlsdGVyXCIsZnVuY3Rpb24oYSl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixyZXBsYWNlOiEwLHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvZGF0ZXBpY2tlci9tb250aC5odG1sXCIscmVxdWlyZTpcIl5kYXRlcGlja2VyXCIsbGluazpmdW5jdGlvbihiLGMsZCxlKXtlLnN0ZXA9e3llYXJzOjF9LGUuZWxlbWVudD1jLGUuX3JlZnJlc2hWaWV3PWZ1bmN0aW9uKCl7Zm9yKHZhciBjPW5ldyBBcnJheSgxMiksZD1lLmFjdGl2ZURhdGUuZ2V0RnVsbFllYXIoKSxmPTA7MTI+ZjtmKyspY1tmXT1hbmd1bGFyLmV4dGVuZChlLmNyZWF0ZURhdGVPYmplY3QobmV3IERhdGUoZCxmLDEpLGUuZm9ybWF0TW9udGgpLHt1aWQ6Yi51bmlxdWVJZCtcIi1cIitmfSk7Yi50aXRsZT1hKGUuYWN0aXZlRGF0ZSxlLmZvcm1hdE1vbnRoVGl0bGUpLGIucm93cz1lLnNwbGl0KGMsMyl9LGUuY29tcGFyZT1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgRGF0ZShhLmdldEZ1bGxZZWFyKCksYS5nZXRNb250aCgpKS1uZXcgRGF0ZShiLmdldEZ1bGxZZWFyKCksYi5nZXRNb250aCgpKX0sZS5oYW5kbGVLZXlEb3duPWZ1bmN0aW9uKGEpe3ZhciBiPWUuYWN0aXZlRGF0ZS5nZXRNb250aCgpO2lmKFwibGVmdFwiPT09YSliLT0xO2Vsc2UgaWYoXCJ1cFwiPT09YSliLT0zO2Vsc2UgaWYoXCJyaWdodFwiPT09YSliKz0xO2Vsc2UgaWYoXCJkb3duXCI9PT1hKWIrPTM7ZWxzZSBpZihcInBhZ2V1cFwiPT09YXx8XCJwYWdlZG93blwiPT09YSl7dmFyIGM9ZS5hY3RpdmVEYXRlLmdldEZ1bGxZZWFyKCkrKFwicGFnZXVwXCI9PT1hPy0xOjEpO2UuYWN0aXZlRGF0ZS5zZXRGdWxsWWVhcihjKX1lbHNlXCJob21lXCI9PT1hP2I9MDpcImVuZFwiPT09YSYmKGI9MTEpO2UuYWN0aXZlRGF0ZS5zZXRNb250aChiKX0sZS5yZWZyZXNoVmlldygpfX19XSkuZGlyZWN0aXZlKFwieWVhcnBpY2tlclwiLFtcImRhdGVGaWx0ZXJcIixmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVBXCIscmVwbGFjZTohMCx0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL2RhdGVwaWNrZXIveWVhci5odG1sXCIscmVxdWlyZTpcIl5kYXRlcGlja2VyXCIsbGluazpmdW5jdGlvbihhLGIsYyxkKXtmdW5jdGlvbiBlKGEpe3JldHVybiBwYXJzZUludCgoYS0xKS9mLDEwKSpmKzF9dmFyIGY9ZC55ZWFyUmFuZ2U7ZC5zdGVwPXt5ZWFyczpmfSxkLmVsZW1lbnQ9YixkLl9yZWZyZXNoVmlldz1mdW5jdGlvbigpe2Zvcih2YXIgYj1uZXcgQXJyYXkoZiksYz0wLGc9ZShkLmFjdGl2ZURhdGUuZ2V0RnVsbFllYXIoKSk7Zj5jO2MrKyliW2NdPWFuZ3VsYXIuZXh0ZW5kKGQuY3JlYXRlRGF0ZU9iamVjdChuZXcgRGF0ZShnK2MsMCwxKSxkLmZvcm1hdFllYXIpLHt1aWQ6YS51bmlxdWVJZCtcIi1cIitjfSk7YS50aXRsZT1bYlswXS5sYWJlbCxiW2YtMV0ubGFiZWxdLmpvaW4oXCIgLSBcIiksYS5yb3dzPWQuc3BsaXQoYiw1KX0sZC5jb21wYXJlPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuZ2V0RnVsbFllYXIoKS1iLmdldEZ1bGxZZWFyKCl9LGQuaGFuZGxlS2V5RG93bj1mdW5jdGlvbihhKXt2YXIgYj1kLmFjdGl2ZURhdGUuZ2V0RnVsbFllYXIoKTtcImxlZnRcIj09PWE/Yi09MTpcInVwXCI9PT1hP2ItPTU6XCJyaWdodFwiPT09YT9iKz0xOlwiZG93blwiPT09YT9iKz01OlwicGFnZXVwXCI9PT1hfHxcInBhZ2Vkb3duXCI9PT1hP2IrPShcInBhZ2V1cFwiPT09YT8tMToxKSpkLnN0ZXAueWVhcnM6XCJob21lXCI9PT1hP2I9ZShkLmFjdGl2ZURhdGUuZ2V0RnVsbFllYXIoKSk6XCJlbmRcIj09PWEmJihiPWUoZC5hY3RpdmVEYXRlLmdldEZ1bGxZZWFyKCkpK2YtMSksZC5hY3RpdmVEYXRlLnNldEZ1bGxZZWFyKGIpfSxkLnJlZnJlc2hWaWV3KCl9fX1dKS5jb25zdGFudChcImRhdGVwaWNrZXJQb3B1cENvbmZpZ1wiLHtkYXRlcGlja2VyUG9wdXA6XCJ5eXl5LU1NLWRkXCIsY3VycmVudFRleHQ6XCJUb2RheVwiLGNsZWFyVGV4dDpcIkNsZWFyXCIsY2xvc2VUZXh0OlwiRG9uZVwiLGNsb3NlT25EYXRlU2VsZWN0aW9uOiEwLGFwcGVuZFRvQm9keTohMSxzaG93QnV0dG9uQmFyOiEwfSkuZGlyZWN0aXZlKFwiZGF0ZXBpY2tlclBvcHVwXCIsW1wiJGNvbXBpbGVcIixcIiRwYXJzZVwiLFwiJGRvY3VtZW50XCIsXCIkcG9zaXRpb25cIixcImRhdGVGaWx0ZXJcIixcImRhdGVQYXJzZXJcIixcImRhdGVwaWNrZXJQb3B1cENvbmZpZ1wiLGZ1bmN0aW9uKGEsYixjLGQsZSxmLGcpe3JldHVybntyZXN0cmljdDpcIkVBXCIscmVxdWlyZTpcIm5nTW9kZWxcIixzY29wZTp7aXNPcGVuOlwiPT9cIixjdXJyZW50VGV4dDpcIkBcIixjbGVhclRleHQ6XCJAXCIsY2xvc2VUZXh0OlwiQFwiLGRhdGVEaXNhYmxlZDpcIiZcIn0sbGluazpmdW5jdGlvbihoLGksaixrKXtmdW5jdGlvbiBsKGEpe3JldHVybiBhLnJlcGxhY2UoLyhbQS1aXSkvZyxmdW5jdGlvbihhKXtyZXR1cm5cIi1cIithLnRvTG93ZXJDYXNlKCl9KX1mdW5jdGlvbiBtKGEpe2lmKGEpe2lmKGFuZ3VsYXIuaXNEYXRlKGEpJiYhaXNOYU4oYSkpcmV0dXJuIGsuJHNldFZhbGlkaXR5KFwiZGF0ZVwiLCEwKSxhO2lmKGFuZ3VsYXIuaXNTdHJpbmcoYSkpe3ZhciBiPWYucGFyc2UoYSxuKXx8bmV3IERhdGUoYSk7cmV0dXJuIGlzTmFOKGIpP3ZvaWQgay4kc2V0VmFsaWRpdHkoXCJkYXRlXCIsITEpOihrLiRzZXRWYWxpZGl0eShcImRhdGVcIiwhMCksYil9cmV0dXJuIHZvaWQgay4kc2V0VmFsaWRpdHkoXCJkYXRlXCIsITEpfXJldHVybiBrLiRzZXRWYWxpZGl0eShcImRhdGVcIiwhMCksbnVsbH12YXIgbixvPWFuZ3VsYXIuaXNEZWZpbmVkKGouY2xvc2VPbkRhdGVTZWxlY3Rpb24pP2guJHBhcmVudC4kZXZhbChqLmNsb3NlT25EYXRlU2VsZWN0aW9uKTpnLmNsb3NlT25EYXRlU2VsZWN0aW9uLHA9YW5ndWxhci5pc0RlZmluZWQoai5kYXRlcGlja2VyQXBwZW5kVG9Cb2R5KT9oLiRwYXJlbnQuJGV2YWwoai5kYXRlcGlja2VyQXBwZW5kVG9Cb2R5KTpnLmFwcGVuZFRvQm9keTtoLnNob3dCdXR0b25CYXI9YW5ndWxhci5pc0RlZmluZWQoai5zaG93QnV0dG9uQmFyKT9oLiRwYXJlbnQuJGV2YWwoai5zaG93QnV0dG9uQmFyKTpnLnNob3dCdXR0b25CYXIsaC5nZXRUZXh0PWZ1bmN0aW9uKGEpe3JldHVybiBoW2ErXCJUZXh0XCJdfHxnW2ErXCJUZXh0XCJdfSxqLiRvYnNlcnZlKFwiZGF0ZXBpY2tlclBvcHVwXCIsZnVuY3Rpb24oYSl7bj1hfHxnLmRhdGVwaWNrZXJQb3B1cCxrLiRyZW5kZXIoKX0pO3ZhciBxPWFuZ3VsYXIuZWxlbWVudChcIjxkaXYgZGF0ZXBpY2tlci1wb3B1cC13cmFwPjxkaXYgZGF0ZXBpY2tlcj48L2Rpdj48L2Rpdj5cIik7cS5hdHRyKHtcIm5nLW1vZGVsXCI6XCJkYXRlXCIsXCJuZy1jaGFuZ2VcIjpcImRhdGVTZWxlY3Rpb24oKVwifSk7dmFyIHI9YW5ndWxhci5lbGVtZW50KHEuY2hpbGRyZW4oKVswXSk7ai5kYXRlcGlja2VyT3B0aW9ucyYmYW5ndWxhci5mb3JFYWNoKGguJHBhcmVudC4kZXZhbChqLmRhdGVwaWNrZXJPcHRpb25zKSxmdW5jdGlvbihhLGIpe3IuYXR0cihsKGIpLGEpfSksaC53YXRjaERhdGE9e30sYW5ndWxhci5mb3JFYWNoKFtcIm1pbkRhdGVcIixcIm1heERhdGVcIixcImRhdGVwaWNrZXJNb2RlXCJdLGZ1bmN0aW9uKGEpe2lmKGpbYV0pe3ZhciBjPWIoalthXSk7aWYoaC4kcGFyZW50LiR3YXRjaChjLGZ1bmN0aW9uKGIpe2gud2F0Y2hEYXRhW2FdPWJ9KSxyLmF0dHIobChhKSxcIndhdGNoRGF0YS5cIithKSxcImRhdGVwaWNrZXJNb2RlXCI9PT1hKXt2YXIgZD1jLmFzc2lnbjtoLiR3YXRjaChcIndhdGNoRGF0YS5cIithLGZ1bmN0aW9uKGEsYil7YSE9PWImJmQoaC4kcGFyZW50LGEpfSl9fX0pLGouZGF0ZURpc2FibGVkJiZyLmF0dHIoXCJkYXRlLWRpc2FibGVkXCIsXCJkYXRlRGlzYWJsZWQoeyBkYXRlOiBkYXRlLCBtb2RlOiBtb2RlIH0pXCIpLGsuJHBhcnNlcnMudW5zaGlmdChtKSxoLmRhdGVTZWxlY3Rpb249ZnVuY3Rpb24oYSl7YW5ndWxhci5pc0RlZmluZWQoYSkmJihoLmRhdGU9YSksay4kc2V0Vmlld1ZhbHVlKGguZGF0ZSksay4kcmVuZGVyKCksbyYmKGguaXNPcGVuPSExLGlbMF0uZm9jdXMoKSl9LGkuYmluZChcImlucHV0IGNoYW5nZSBrZXl1cFwiLGZ1bmN0aW9uKCl7aC4kYXBwbHkoZnVuY3Rpb24oKXtoLmRhdGU9ay4kbW9kZWxWYWx1ZX0pfSksay4kcmVuZGVyPWZ1bmN0aW9uKCl7dmFyIGE9ay4kdmlld1ZhbHVlP2Uoay4kdmlld1ZhbHVlLG4pOlwiXCI7aS52YWwoYSksaC5kYXRlPW0oay4kbW9kZWxWYWx1ZSl9O3ZhciBzPWZ1bmN0aW9uKGEpe2guaXNPcGVuJiZhLnRhcmdldCE9PWlbMF0mJmguJGFwcGx5KGZ1bmN0aW9uKCl7aC5pc09wZW49ITF9KX0sdD1mdW5jdGlvbihhKXtoLmtleWRvd24oYSl9O2kuYmluZChcImtleWRvd25cIix0KSxoLmtleWRvd249ZnVuY3Rpb24oYSl7Mjc9PT1hLndoaWNoPyhhLnByZXZlbnREZWZhdWx0KCksYS5zdG9wUHJvcGFnYXRpb24oKSxoLmNsb3NlKCkpOjQwIT09YS53aGljaHx8aC5pc09wZW58fChoLmlzT3Blbj0hMCl9LGguJHdhdGNoKFwiaXNPcGVuXCIsZnVuY3Rpb24oYSl7YT8oaC4kYnJvYWRjYXN0KFwiZGF0ZXBpY2tlci5mb2N1c1wiKSxoLnBvc2l0aW9uPXA/ZC5vZmZzZXQoaSk6ZC5wb3NpdGlvbihpKSxoLnBvc2l0aW9uLnRvcD1oLnBvc2l0aW9uLnRvcCtpLnByb3AoXCJvZmZzZXRIZWlnaHRcIiksYy5iaW5kKFwiY2xpY2tcIixzKSk6Yy51bmJpbmQoXCJjbGlja1wiLHMpfSksaC5zZWxlY3Q9ZnVuY3Rpb24oYSl7aWYoXCJ0b2RheVwiPT09YSl7dmFyIGI9bmV3IERhdGU7YW5ndWxhci5pc0RhdGUoay4kbW9kZWxWYWx1ZSk/KGE9bmV3IERhdGUoay4kbW9kZWxWYWx1ZSksYS5zZXRGdWxsWWVhcihiLmdldEZ1bGxZZWFyKCksYi5nZXRNb250aCgpLGIuZ2V0RGF0ZSgpKSk6YT1uZXcgRGF0ZShiLnNldEhvdXJzKDAsMCwwLDApKX1oLmRhdGVTZWxlY3Rpb24oYSl9LGguY2xvc2U9ZnVuY3Rpb24oKXtoLmlzT3Blbj0hMSxpWzBdLmZvY3VzKCl9O3ZhciB1PWEocSkoaCk7cS5yZW1vdmUoKSxwP2MuZmluZChcImJvZHlcIikuYXBwZW5kKHUpOmkuYWZ0ZXIodSksaC4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7dS5yZW1vdmUoKSxpLnVuYmluZChcImtleWRvd25cIix0KSxjLnVuYmluZChcImNsaWNrXCIscyl9KX19fV0pLmRpcmVjdGl2ZShcImRhdGVwaWNrZXJQb3B1cFdyYXBcIixmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVBXCIscmVwbGFjZTohMCx0cmFuc2NsdWRlOiEwLHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvZGF0ZXBpY2tlci9wb3B1cC5odG1sXCIsbGluazpmdW5jdGlvbihhLGIpe2IuYmluZChcImNsaWNrXCIsZnVuY3Rpb24oYSl7YS5wcmV2ZW50RGVmYXVsdCgpLGEuc3RvcFByb3BhZ2F0aW9uKCl9KX19fSksYW5ndWxhci5tb2R1bGUoXCJ1aS5ib290c3RyYXAuZHJvcGRvd25cIixbXSkuY29uc3RhbnQoXCJkcm9wZG93bkNvbmZpZ1wiLHtvcGVuQ2xhc3M6XCJvcGVuXCJ9KS5zZXJ2aWNlKFwiZHJvcGRvd25TZXJ2aWNlXCIsW1wiJGRvY3VtZW50XCIsZnVuY3Rpb24oYSl7dmFyIGI9bnVsbDt0aGlzLm9wZW49ZnVuY3Rpb24oZSl7Ynx8KGEuYmluZChcImNsaWNrXCIsYyksYS5iaW5kKFwia2V5ZG93blwiLGQpKSxiJiZiIT09ZSYmKGIuaXNPcGVuPSExKSxiPWV9LHRoaXMuY2xvc2U9ZnVuY3Rpb24oZSl7Yj09PWUmJihiPW51bGwsYS51bmJpbmQoXCJjbGlja1wiLGMpLGEudW5iaW5kKFwia2V5ZG93blwiLGQpKX07dmFyIGM9ZnVuY3Rpb24oYSl7dmFyIGM9Yi5nZXRUb2dnbGVFbGVtZW50KCk7YSYmYyYmY1swXS5jb250YWlucyhhLnRhcmdldCl8fGIuJGFwcGx5KGZ1bmN0aW9uKCl7Yi5pc09wZW49ITF9KX0sZD1mdW5jdGlvbihhKXsyNz09PWEud2hpY2gmJihiLmZvY3VzVG9nZ2xlRWxlbWVudCgpLGMoKSl9fV0pLmNvbnRyb2xsZXIoXCJEcm9wZG93bkNvbnRyb2xsZXJcIixbXCIkc2NvcGVcIixcIiRhdHRyc1wiLFwiJHBhcnNlXCIsXCJkcm9wZG93bkNvbmZpZ1wiLFwiZHJvcGRvd25TZXJ2aWNlXCIsXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEsYixjLGQsZSxmKXt2YXIgZyxoPXRoaXMsaT1hLiRuZXcoKSxqPWQub3BlbkNsYXNzLGs9YW5ndWxhci5ub29wLGw9Yi5vblRvZ2dsZT9jKGIub25Ub2dnbGUpOmFuZ3VsYXIubm9vcDt0aGlzLmluaXQ9ZnVuY3Rpb24oZCl7aC4kZWxlbWVudD1kLGIuaXNPcGVuJiYoZz1jKGIuaXNPcGVuKSxrPWcuYXNzaWduLGEuJHdhdGNoKGcsZnVuY3Rpb24oYSl7aS5pc09wZW49ISFhfSkpfSx0aGlzLnRvZ2dsZT1mdW5jdGlvbihhKXtyZXR1cm4gaS5pc09wZW49YXJndW1lbnRzLmxlbmd0aD8hIWE6IWkuaXNPcGVufSx0aGlzLmlzT3Blbj1mdW5jdGlvbigpe3JldHVybiBpLmlzT3Blbn0saS5nZXRUb2dnbGVFbGVtZW50PWZ1bmN0aW9uKCl7cmV0dXJuIGgudG9nZ2xlRWxlbWVudH0saS5mb2N1c1RvZ2dsZUVsZW1lbnQ9ZnVuY3Rpb24oKXtoLnRvZ2dsZUVsZW1lbnQmJmgudG9nZ2xlRWxlbWVudFswXS5mb2N1cygpfSxpLiR3YXRjaChcImlzT3BlblwiLGZ1bmN0aW9uKGIsYyl7ZltiP1wiYWRkQ2xhc3NcIjpcInJlbW92ZUNsYXNzXCJdKGguJGVsZW1lbnQsaiksYj8oaS5mb2N1c1RvZ2dsZUVsZW1lbnQoKSxlLm9wZW4oaSkpOmUuY2xvc2UoaSksayhhLGIpLGFuZ3VsYXIuaXNEZWZpbmVkKGIpJiZiIT09YyYmbChhLHtvcGVuOiEhYn0pfSksYS4kb24oXCIkbG9jYXRpb25DaGFuZ2VTdWNjZXNzXCIsZnVuY3Rpb24oKXtpLmlzT3Blbj0hMX0pLGEuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2kuJGRlc3Ryb3koKX0pfV0pLmRpcmVjdGl2ZShcImRyb3Bkb3duXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJDQVwiLGNvbnRyb2xsZXI6XCJEcm9wZG93bkNvbnRyb2xsZXJcIixsaW5rOmZ1bmN0aW9uKGEsYixjLGQpe2QuaW5pdChiKX19fSkuZGlyZWN0aXZlKFwiZHJvcGRvd25Ub2dnbGVcIixmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkNBXCIscmVxdWlyZTpcIj9eZHJvcGRvd25cIixsaW5rOmZ1bmN0aW9uKGEsYixjLGQpe2lmKGQpe2QudG9nZ2xlRWxlbWVudD1iO3ZhciBlPWZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKSxiLmhhc0NsYXNzKFwiZGlzYWJsZWRcIil8fGMuZGlzYWJsZWR8fGEuJGFwcGx5KGZ1bmN0aW9uKCl7ZC50b2dnbGUoKX0pfTtiLmJpbmQoXCJjbGlja1wiLGUpLGIuYXR0cih7XCJhcmlhLWhhc3BvcHVwXCI6ITAsXCJhcmlhLWV4cGFuZGVkXCI6ITF9KSxhLiR3YXRjaChkLmlzT3BlbixmdW5jdGlvbihhKXtiLmF0dHIoXCJhcmlhLWV4cGFuZGVkXCIsISFhKX0pLGEuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2IudW5iaW5kKFwiY2xpY2tcIixlKX0pfX19fSksYW5ndWxhci5tb2R1bGUoXCJ1aS5ib290c3RyYXAubW9kYWxcIixbXCJ1aS5ib290c3RyYXAudHJhbnNpdGlvblwiXSkuZmFjdG9yeShcIiQkc3RhY2tlZE1hcFwiLGZ1bmN0aW9uKCl7cmV0dXJue2NyZWF0ZU5ldzpmdW5jdGlvbigpe3ZhciBhPVtdO3JldHVybnthZGQ6ZnVuY3Rpb24oYixjKXthLnB1c2goe2tleTpiLHZhbHVlOmN9KX0sZ2V0OmZ1bmN0aW9uKGIpe2Zvcih2YXIgYz0wO2M8YS5sZW5ndGg7YysrKWlmKGI9PWFbY10ua2V5KXJldHVybiBhW2NdfSxrZXlzOmZ1bmN0aW9uKCl7Zm9yKHZhciBiPVtdLGM9MDtjPGEubGVuZ3RoO2MrKyliLnB1c2goYVtjXS5rZXkpO3JldHVybiBifSx0b3A6ZnVuY3Rpb24oKXtyZXR1cm4gYVthLmxlbmd0aC0xXX0scmVtb3ZlOmZ1bmN0aW9uKGIpe2Zvcih2YXIgYz0tMSxkPTA7ZDxhLmxlbmd0aDtkKyspaWYoYj09YVtkXS5rZXkpe2M9ZDticmVha31yZXR1cm4gYS5zcGxpY2UoYywxKVswXX0scmVtb3ZlVG9wOmZ1bmN0aW9uKCl7cmV0dXJuIGEuc3BsaWNlKGEubGVuZ3RoLTEsMSlbMF19LGxlbmd0aDpmdW5jdGlvbigpe3JldHVybiBhLmxlbmd0aH19fX19KS5kaXJlY3RpdmUoXCJtb2RhbEJhY2tkcm9wXCIsW1wiJHRpbWVvdXRcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHJlcGxhY2U6ITAsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZS9tb2RhbC9iYWNrZHJvcC5odG1sXCIsbGluazpmdW5jdGlvbihiLGMsZCl7Yi5iYWNrZHJvcENsYXNzPWQuYmFja2Ryb3BDbGFzc3x8XCJcIixiLmFuaW1hdGU9ITEsYShmdW5jdGlvbigpe2IuYW5pbWF0ZT0hMH0pfX19XSkuZGlyZWN0aXZlKFwibW9kYWxXaW5kb3dcIixbXCIkbW9kYWxTdGFja1wiLFwiJHRpbWVvdXRcIixmdW5jdGlvbihhLGIpe3JldHVybntyZXN0cmljdDpcIkVBXCIsc2NvcGU6e2luZGV4OlwiQFwiLGFuaW1hdGU6XCI9XCJ9LHJlcGxhY2U6ITAsdHJhbnNjbHVkZTohMCx0ZW1wbGF0ZVVybDpmdW5jdGlvbihhLGIpe3JldHVybiBiLnRlbXBsYXRlVXJsfHxcInRlbXBsYXRlL21vZGFsL3dpbmRvdy5odG1sXCJ9LGxpbms6ZnVuY3Rpb24oYyxkLGUpe2QuYWRkQ2xhc3MoZS53aW5kb3dDbGFzc3x8XCJcIiksYy5zaXplPWUuc2l6ZSxiKGZ1bmN0aW9uKCl7Yy5hbmltYXRlPSEwLGRbMF0ucXVlcnlTZWxlY3RvckFsbChcIlthdXRvZm9jdXNdXCIpLmxlbmd0aHx8ZFswXS5mb2N1cygpfSksYy5jbG9zZT1mdW5jdGlvbihiKXt2YXIgYz1hLmdldFRvcCgpO2MmJmMudmFsdWUuYmFja2Ryb3AmJlwic3RhdGljXCIhPWMudmFsdWUuYmFja2Ryb3AmJmIudGFyZ2V0PT09Yi5jdXJyZW50VGFyZ2V0JiYoYi5wcmV2ZW50RGVmYXVsdCgpLGIuc3RvcFByb3BhZ2F0aW9uKCksYS5kaXNtaXNzKGMua2V5LFwiYmFja2Ryb3AgY2xpY2tcIikpfX19fV0pLmRpcmVjdGl2ZShcIm1vZGFsVHJhbnNjbHVkZVwiLGZ1bmN0aW9uKCl7cmV0dXJue2xpbms6ZnVuY3Rpb24oYSxiLGMsZCxlKXtlKGEuJHBhcmVudCxmdW5jdGlvbihhKXtiLmVtcHR5KCksYi5hcHBlbmQoYSl9KX19fSkuZmFjdG9yeShcIiRtb2RhbFN0YWNrXCIsW1wiJHRyYW5zaXRpb25cIixcIiR0aW1lb3V0XCIsXCIkZG9jdW1lbnRcIixcIiRjb21waWxlXCIsXCIkcm9vdFNjb3BlXCIsXCIkJHN0YWNrZWRNYXBcIixmdW5jdGlvbihhLGIsYyxkLGUsZil7ZnVuY3Rpb24gZygpe2Zvcih2YXIgYT0tMSxiPW4ua2V5cygpLGM9MDtjPGIubGVuZ3RoO2MrKyluLmdldChiW2NdKS52YWx1ZS5iYWNrZHJvcCYmKGE9Yyk7cmV0dXJuIGF9ZnVuY3Rpb24gaChhKXt2YXIgYj1jLmZpbmQoXCJib2R5XCIpLmVxKDApLGQ9bi5nZXQoYSkudmFsdWU7bi5yZW1vdmUoYSksaihkLm1vZGFsRG9tRWwsZC5tb2RhbFNjb3BlLDMwMCxmdW5jdGlvbigpe2QubW9kYWxTY29wZS4kZGVzdHJveSgpLGIudG9nZ2xlQ2xhc3MobSxuLmxlbmd0aCgpPjApLGkoKX0pfWZ1bmN0aW9uIGkoKXtpZihrJiYtMT09ZygpKXt2YXIgYT1sO2ooayxsLDE1MCxmdW5jdGlvbigpe2EuJGRlc3Ryb3koKSxhPW51bGx9KSxrPXZvaWQgMCxsPXZvaWQgMH19ZnVuY3Rpb24gaihjLGQsZSxmKXtmdW5jdGlvbiBnKCl7Zy5kb25lfHwoZy5kb25lPSEwLGMucmVtb3ZlKCksZiYmZigpKX1kLmFuaW1hdGU9ITE7dmFyIGg9YS50cmFuc2l0aW9uRW5kRXZlbnROYW1lO2lmKGgpe3ZhciBpPWIoZyxlKTtjLmJpbmQoaCxmdW5jdGlvbigpe2IuY2FuY2VsKGkpLGcoKSxkLiRhcHBseSgpfSl9ZWxzZSBiKGcpfXZhciBrLGwsbT1cIm1vZGFsLW9wZW5cIixuPWYuY3JlYXRlTmV3KCksbz17fTtyZXR1cm4gZS4kd2F0Y2goZyxmdW5jdGlvbihhKXtsJiYobC5pbmRleD1hKX0pLGMuYmluZChcImtleWRvd25cIixmdW5jdGlvbihhKXt2YXIgYjsyNz09PWEud2hpY2gmJihiPW4udG9wKCksYiYmYi52YWx1ZS5rZXlib2FyZCYmKGEucHJldmVudERlZmF1bHQoKSxlLiRhcHBseShmdW5jdGlvbigpe28uZGlzbWlzcyhiLmtleSxcImVzY2FwZSBrZXkgcHJlc3NcIil9KSkpfSksby5vcGVuPWZ1bmN0aW9uKGEsYil7bi5hZGQoYSx7ZGVmZXJyZWQ6Yi5kZWZlcnJlZCxtb2RhbFNjb3BlOmIuc2NvcGUsYmFja2Ryb3A6Yi5iYWNrZHJvcCxrZXlib2FyZDpiLmtleWJvYXJkfSk7dmFyIGY9Yy5maW5kKFwiYm9keVwiKS5lcSgwKSxoPWcoKTtpZihoPj0wJiYhayl7bD1lLiRuZXcoITApLGwuaW5kZXg9aDt2YXIgaT1hbmd1bGFyLmVsZW1lbnQoXCI8ZGl2IG1vZGFsLWJhY2tkcm9wPjwvZGl2PlwiKTtpLmF0dHIoXCJiYWNrZHJvcC1jbGFzc1wiLGIuYmFja2Ryb3BDbGFzcyksaz1kKGkpKGwpLGYuYXBwZW5kKGspfXZhciBqPWFuZ3VsYXIuZWxlbWVudChcIjxkaXYgbW9kYWwtd2luZG93PjwvZGl2PlwiKTtqLmF0dHIoe1widGVtcGxhdGUtdXJsXCI6Yi53aW5kb3dUZW1wbGF0ZVVybCxcIndpbmRvdy1jbGFzc1wiOmIud2luZG93Q2xhc3Msc2l6ZTpiLnNpemUsaW5kZXg6bi5sZW5ndGgoKS0xLGFuaW1hdGU6XCJhbmltYXRlXCJ9KS5odG1sKGIuY29udGVudCk7dmFyIG89ZChqKShiLnNjb3BlKTtuLnRvcCgpLnZhbHVlLm1vZGFsRG9tRWw9byxmLmFwcGVuZChvKSxmLmFkZENsYXNzKG0pfSxvLmNsb3NlPWZ1bmN0aW9uKGEsYil7dmFyIGM9bi5nZXQoYSk7YyYmKGMudmFsdWUuZGVmZXJyZWQucmVzb2x2ZShiKSxoKGEpKX0sby5kaXNtaXNzPWZ1bmN0aW9uKGEsYil7dmFyIGM9bi5nZXQoYSk7YyYmKGMudmFsdWUuZGVmZXJyZWQucmVqZWN0KGIpLGgoYSkpfSxvLmRpc21pc3NBbGw9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuZ2V0VG9wKCk7YjspdGhpcy5kaXNtaXNzKGIua2V5LGEpLGI9dGhpcy5nZXRUb3AoKX0sby5nZXRUb3A9ZnVuY3Rpb24oKXtyZXR1cm4gbi50b3AoKX0sb31dKS5wcm92aWRlcihcIiRtb2RhbFwiLGZ1bmN0aW9uKCl7dmFyIGE9e29wdGlvbnM6e2JhY2tkcm9wOiEwLGtleWJvYXJkOiEwfSwkZ2V0OltcIiRpbmplY3RvclwiLFwiJHJvb3RTY29wZVwiLFwiJHFcIixcIiRodHRwXCIsXCIkdGVtcGxhdGVDYWNoZVwiLFwiJGNvbnRyb2xsZXJcIixcIiRtb2RhbFN0YWNrXCIsZnVuY3Rpb24oYixjLGQsZSxmLGcsaCl7ZnVuY3Rpb24gaShhKXtyZXR1cm4gYS50ZW1wbGF0ZT9kLndoZW4oYS50ZW1wbGF0ZSk6ZS5nZXQoYW5ndWxhci5pc0Z1bmN0aW9uKGEudGVtcGxhdGVVcmwpP2EudGVtcGxhdGVVcmwoKTphLnRlbXBsYXRlVXJsLHtjYWNoZTpmfSkudGhlbihmdW5jdGlvbihhKXtyZXR1cm4gYS5kYXRhfSl9ZnVuY3Rpb24gaihhKXt2YXIgYz1bXTtyZXR1cm4gYW5ndWxhci5mb3JFYWNoKGEsZnVuY3Rpb24oYSl7KGFuZ3VsYXIuaXNGdW5jdGlvbihhKXx8YW5ndWxhci5pc0FycmF5KGEpKSYmYy5wdXNoKGQud2hlbihiLmludm9rZShhKSkpfSksY312YXIgaz17fTtyZXR1cm4gay5vcGVuPWZ1bmN0aW9uKGIpe3ZhciBlPWQuZGVmZXIoKSxmPWQuZGVmZXIoKSxrPXtyZXN1bHQ6ZS5wcm9taXNlLG9wZW5lZDpmLnByb21pc2UsY2xvc2U6ZnVuY3Rpb24oYSl7aC5jbG9zZShrLGEpfSxkaXNtaXNzOmZ1bmN0aW9uKGEpe2guZGlzbWlzcyhrLGEpfX07aWYoYj1hbmd1bGFyLmV4dGVuZCh7fSxhLm9wdGlvbnMsYiksYi5yZXNvbHZlPWIucmVzb2x2ZXx8e30sIWIudGVtcGxhdGUmJiFiLnRlbXBsYXRlVXJsKXRocm93IG5ldyBFcnJvcihcIk9uZSBvZiB0ZW1wbGF0ZSBvciB0ZW1wbGF0ZVVybCBvcHRpb25zIGlzIHJlcXVpcmVkLlwiKTt2YXIgbD1kLmFsbChbaShiKV0uY29uY2F0KGooYi5yZXNvbHZlKSkpO3JldHVybiBsLnRoZW4oZnVuY3Rpb24oYSl7dmFyIGQ9KGIuc2NvcGV8fGMpLiRuZXcoKTtkLiRjbG9zZT1rLmNsb3NlLGQuJGRpc21pc3M9ay5kaXNtaXNzO3ZhciBmLGk9e30saj0xO2IuY29udHJvbGxlciYmKGkuJHNjb3BlPWQsaS4kbW9kYWxJbnN0YW5jZT1rLGFuZ3VsYXIuZm9yRWFjaChiLnJlc29sdmUsZnVuY3Rpb24oYixjKXtpW2NdPWFbaisrXX0pLGY9ZyhiLmNvbnRyb2xsZXIsaSksYi5jb250cm9sbGVyQXMmJihkW2IuY29udHJvbGxlckFzXT1mKSksaC5vcGVuKGsse3Njb3BlOmQsZGVmZXJyZWQ6ZSxjb250ZW50OmFbMF0sYmFja2Ryb3A6Yi5iYWNrZHJvcCxrZXlib2FyZDpiLmtleWJvYXJkLGJhY2tkcm9wQ2xhc3M6Yi5iYWNrZHJvcENsYXNzLHdpbmRvd0NsYXNzOmIud2luZG93Q2xhc3Msd2luZG93VGVtcGxhdGVVcmw6Yi53aW5kb3dUZW1wbGF0ZVVybCxzaXplOmIuc2l6ZX0pfSxmdW5jdGlvbihhKXtlLnJlamVjdChhKX0pLGwudGhlbihmdW5jdGlvbigpe2YucmVzb2x2ZSghMCl9LGZ1bmN0aW9uKCl7Zi5yZWplY3QoITEpfSksa30sa31dfTtyZXR1cm4gYX0pLGFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwLnBhZ2luYXRpb25cIixbXSkuY29udHJvbGxlcihcIlBhZ2luYXRpb25Db250cm9sbGVyXCIsW1wiJHNjb3BlXCIsXCIkYXR0cnNcIixcIiRwYXJzZVwiLGZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLGU9eyRzZXRWaWV3VmFsdWU6YW5ndWxhci5ub29wfSxmPWIubnVtUGFnZXM/YyhiLm51bVBhZ2VzKS5hc3NpZ246YW5ndWxhci5ub29wO3RoaXMuaW5pdD1mdW5jdGlvbihmLGcpe2U9Zix0aGlzLmNvbmZpZz1nLGUuJHJlbmRlcj1mdW5jdGlvbigpe2QucmVuZGVyKCl9LGIuaXRlbXNQZXJQYWdlP2EuJHBhcmVudC4kd2F0Y2goYyhiLml0ZW1zUGVyUGFnZSksZnVuY3Rpb24oYil7ZC5pdGVtc1BlclBhZ2U9cGFyc2VJbnQoYiwxMCksYS50b3RhbFBhZ2VzPWQuY2FsY3VsYXRlVG90YWxQYWdlcygpfSk6dGhpcy5pdGVtc1BlclBhZ2U9Zy5pdGVtc1BlclBhZ2V9LHRoaXMuY2FsY3VsYXRlVG90YWxQYWdlcz1mdW5jdGlvbigpe3ZhciBiPXRoaXMuaXRlbXNQZXJQYWdlPDE/MTpNYXRoLmNlaWwoYS50b3RhbEl0ZW1zL3RoaXMuaXRlbXNQZXJQYWdlKTtyZXR1cm4gTWF0aC5tYXgoYnx8MCwxKX0sdGhpcy5yZW5kZXI9ZnVuY3Rpb24oKXthLnBhZ2U9cGFyc2VJbnQoZS4kdmlld1ZhbHVlLDEwKXx8MX0sYS5zZWxlY3RQYWdlPWZ1bmN0aW9uKGIpe2EucGFnZSE9PWImJmI+MCYmYjw9YS50b3RhbFBhZ2VzJiYoZS4kc2V0Vmlld1ZhbHVlKGIpLGUuJHJlbmRlcigpKX0sYS5nZXRUZXh0PWZ1bmN0aW9uKGIpe3JldHVybiBhW2IrXCJUZXh0XCJdfHxkLmNvbmZpZ1tiK1wiVGV4dFwiXX0sYS5ub1ByZXZpb3VzPWZ1bmN0aW9uKCl7cmV0dXJuIDE9PT1hLnBhZ2V9LGEubm9OZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIGEucGFnZT09PWEudG90YWxQYWdlc30sYS4kd2F0Y2goXCJ0b3RhbEl0ZW1zXCIsZnVuY3Rpb24oKXthLnRvdGFsUGFnZXM9ZC5jYWxjdWxhdGVUb3RhbFBhZ2VzKCl9KSxhLiR3YXRjaChcInRvdGFsUGFnZXNcIixmdW5jdGlvbihiKXtmKGEuJHBhcmVudCxiKSxhLnBhZ2U+Yj9hLnNlbGVjdFBhZ2UoYik6ZS4kcmVuZGVyKCl9KX1dKS5jb25zdGFudChcInBhZ2luYXRpb25Db25maWdcIix7aXRlbXNQZXJQYWdlOjEwLGJvdW5kYXJ5TGlua3M6ITEsZGlyZWN0aW9uTGlua3M6ITAsZmlyc3RUZXh0OlwiRmlyc3RcIixwcmV2aW91c1RleHQ6XCJQcmV2aW91c1wiLG5leHRUZXh0OlwiTmV4dFwiLGxhc3RUZXh0OlwiTGFzdFwiLHJvdGF0ZTohMH0pLmRpcmVjdGl2ZShcInBhZ2luYXRpb25cIixbXCIkcGFyc2VcIixcInBhZ2luYXRpb25Db25maWdcIixmdW5jdGlvbihhLGIpe3JldHVybntyZXN0cmljdDpcIkVBXCIsc2NvcGU6e3RvdGFsSXRlbXM6XCI9XCIsZmlyc3RUZXh0OlwiQFwiLHByZXZpb3VzVGV4dDpcIkBcIixuZXh0VGV4dDpcIkBcIixsYXN0VGV4dDpcIkBcIn0scmVxdWlyZTpbXCJwYWdpbmF0aW9uXCIsXCI/bmdNb2RlbFwiXSxjb250cm9sbGVyOlwiUGFnaW5hdGlvbkNvbnRyb2xsZXJcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL3BhZ2luYXRpb24vcGFnaW5hdGlvbi5odG1sXCIscmVwbGFjZTohMCxsaW5rOmZ1bmN0aW9uKGMsZCxlLGYpe2Z1bmN0aW9uIGcoYSxiLGMpe3JldHVybntudW1iZXI6YSx0ZXh0OmIsYWN0aXZlOmN9fWZ1bmN0aW9uIGgoYSxiKXt2YXIgYz1bXSxkPTEsZT1iLGY9YW5ndWxhci5pc0RlZmluZWQoaykmJmI+aztmJiYobD8oZD1NYXRoLm1heChhLU1hdGguZmxvb3Ioay8yKSwxKSxlPWQray0xLGU+YiYmKGU9YixkPWUtaysxKSk6KGQ9KE1hdGguY2VpbChhL2spLTEpKmsrMSxlPU1hdGgubWluKGQray0xLGIpKSk7Zm9yKHZhciBoPWQ7ZT49aDtoKyspe3ZhciBpPWcoaCxoLGg9PT1hKTtjLnB1c2goaSl9aWYoZiYmIWwpe2lmKGQ+MSl7dmFyIGo9ZyhkLTEsXCIuLi5cIiwhMSk7Yy51bnNoaWZ0KGopfWlmKGI+ZSl7dmFyIG09ZyhlKzEsXCIuLi5cIiwhMSk7Yy5wdXNoKG0pfX1yZXR1cm4gY312YXIgaT1mWzBdLGo9ZlsxXTtpZihqKXt2YXIgaz1hbmd1bGFyLmlzRGVmaW5lZChlLm1heFNpemUpP2MuJHBhcmVudC4kZXZhbChlLm1heFNpemUpOmIubWF4U2l6ZSxsPWFuZ3VsYXIuaXNEZWZpbmVkKGUucm90YXRlKT9jLiRwYXJlbnQuJGV2YWwoZS5yb3RhdGUpOmIucm90YXRlO2MuYm91bmRhcnlMaW5rcz1hbmd1bGFyLmlzRGVmaW5lZChlLmJvdW5kYXJ5TGlua3MpP2MuJHBhcmVudC4kZXZhbChlLmJvdW5kYXJ5TGlua3MpOmIuYm91bmRhcnlMaW5rcyxjLmRpcmVjdGlvbkxpbmtzPWFuZ3VsYXIuaXNEZWZpbmVkKGUuZGlyZWN0aW9uTGlua3MpP2MuJHBhcmVudC4kZXZhbChlLmRpcmVjdGlvbkxpbmtzKTpiLmRpcmVjdGlvbkxpbmtzLGkuaW5pdChqLGIpLGUubWF4U2l6ZSYmYy4kcGFyZW50LiR3YXRjaChhKGUubWF4U2l6ZSksZnVuY3Rpb24oYSl7az1wYXJzZUludChhLDEwKSxpLnJlbmRlcigpXG59KTt2YXIgbT1pLnJlbmRlcjtpLnJlbmRlcj1mdW5jdGlvbigpe20oKSxjLnBhZ2U+MCYmYy5wYWdlPD1jLnRvdGFsUGFnZXMmJihjLnBhZ2VzPWgoYy5wYWdlLGMudG90YWxQYWdlcykpfX19fX1dKS5jb25zdGFudChcInBhZ2VyQ29uZmlnXCIse2l0ZW1zUGVyUGFnZToxMCxwcmV2aW91c1RleHQ6XCLCqyBQcmV2aW91c1wiLG5leHRUZXh0OlwiTmV4dCDCu1wiLGFsaWduOiEwfSkuZGlyZWN0aXZlKFwicGFnZXJcIixbXCJwYWdlckNvbmZpZ1wiLGZ1bmN0aW9uKGEpe3JldHVybntyZXN0cmljdDpcIkVBXCIsc2NvcGU6e3RvdGFsSXRlbXM6XCI9XCIscHJldmlvdXNUZXh0OlwiQFwiLG5leHRUZXh0OlwiQFwifSxyZXF1aXJlOltcInBhZ2VyXCIsXCI/bmdNb2RlbFwiXSxjb250cm9sbGVyOlwiUGFnaW5hdGlvbkNvbnRyb2xsZXJcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL3BhZ2luYXRpb24vcGFnZXIuaHRtbFwiLHJlcGxhY2U6ITAsbGluazpmdW5jdGlvbihiLGMsZCxlKXt2YXIgZj1lWzBdLGc9ZVsxXTtnJiYoYi5hbGlnbj1hbmd1bGFyLmlzRGVmaW5lZChkLmFsaWduKT9iLiRwYXJlbnQuJGV2YWwoZC5hbGlnbik6YS5hbGlnbixmLmluaXQoZyxhKSl9fX1dKSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC50b29sdGlwXCIsW1widWkuYm9vdHN0cmFwLnBvc2l0aW9uXCIsXCJ1aS5ib290c3RyYXAuYmluZEh0bWxcIl0pLnByb3ZpZGVyKFwiJHRvb2x0aXBcIixmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGI9L1tBLVpdL2csYz1cIi1cIjtyZXR1cm4gYS5yZXBsYWNlKGIsZnVuY3Rpb24oYSxiKXtyZXR1cm4oYj9jOlwiXCIpK2EudG9Mb3dlckNhc2UoKX0pfXZhciBiPXtwbGFjZW1lbnQ6XCJ0b3BcIixhbmltYXRpb246ITAscG9wdXBEZWxheTowfSxjPXttb3VzZWVudGVyOlwibW91c2VsZWF2ZVwiLGNsaWNrOlwiY2xpY2tcIixmb2N1czpcImJsdXJcIn0sZD17fTt0aGlzLm9wdGlvbnM9ZnVuY3Rpb24oYSl7YW5ndWxhci5leHRlbmQoZCxhKX0sdGhpcy5zZXRUcmlnZ2Vycz1mdW5jdGlvbihhKXthbmd1bGFyLmV4dGVuZChjLGEpfSx0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLFwiJGNvbXBpbGVcIixcIiR0aW1lb3V0XCIsXCIkcGFyc2VcIixcIiRkb2N1bWVudFwiLFwiJHBvc2l0aW9uXCIsXCIkaW50ZXJwb2xhdGVcIixmdW5jdGlvbihlLGYsZyxoLGksaixrKXtyZXR1cm4gZnVuY3Rpb24oZSxsLG0pe2Z1bmN0aW9uIG4oYSl7dmFyIGI9YXx8by50cmlnZ2VyfHxtLGQ9Y1tiXXx8YjtyZXR1cm57c2hvdzpiLGhpZGU6ZH19dmFyIG89YW5ndWxhci5leHRlbmQoe30sYixkKSxwPWEoZSkscT1rLnN0YXJ0U3ltYm9sKCkscj1rLmVuZFN5bWJvbCgpLHM9XCI8ZGl2IFwiK3ArJy1wb3B1cCB0aXRsZT1cIicrcStcInR0X3RpdGxlXCIrcisnXCIgY29udGVudD1cIicrcStcInR0X2NvbnRlbnRcIityKydcIiBwbGFjZW1lbnQ9XCInK3ErXCJ0dF9wbGFjZW1lbnRcIityKydcIiBhbmltYXRpb249XCJ0dF9hbmltYXRpb25cIiBpcy1vcGVuPVwidHRfaXNPcGVuXCI+PC9kaXY+JztyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHNjb3BlOiEwLGNvbXBpbGU6ZnVuY3Rpb24oKXt2YXIgYT1mKHMpO3JldHVybiBmdW5jdGlvbihiLGMsZCl7ZnVuY3Rpb24gZigpe2IudHRfaXNPcGVuP20oKTprKCl9ZnVuY3Rpb24gaygpeygheXx8Yi4kZXZhbChkW2wrXCJFbmFibGVcIl0pKSYmKGIudHRfcG9wdXBEZWxheT92fHwodj1nKHAsYi50dF9wb3B1cERlbGF5LCExKSx2LnRoZW4oZnVuY3Rpb24oYSl7YSgpfSkpOnAoKSgpKX1mdW5jdGlvbiBtKCl7Yi4kYXBwbHkoZnVuY3Rpb24oKXtxKCl9KX1mdW5jdGlvbiBwKCl7cmV0dXJuIHY9bnVsbCx1JiYoZy5jYW5jZWwodSksdT1udWxsKSxiLnR0X2NvbnRlbnQ/KHIoKSx0LmNzcyh7dG9wOjAsbGVmdDowLGRpc3BsYXk6XCJibG9ja1wifSksdz9pLmZpbmQoXCJib2R5XCIpLmFwcGVuZCh0KTpjLmFmdGVyKHQpLHooKSxiLnR0X2lzT3Blbj0hMCxiLiRkaWdlc3QoKSx6KTphbmd1bGFyLm5vb3B9ZnVuY3Rpb24gcSgpe2IudHRfaXNPcGVuPSExLGcuY2FuY2VsKHYpLHY9bnVsbCxiLnR0X2FuaW1hdGlvbj91fHwodT1nKHMsNTAwKSk6cygpfWZ1bmN0aW9uIHIoKXt0JiZzKCksdD1hKGIsZnVuY3Rpb24oKXt9KSxiLiRkaWdlc3QoKX1mdW5jdGlvbiBzKCl7dT1udWxsLHQmJih0LnJlbW92ZSgpLHQ9bnVsbCl9dmFyIHQsdSx2LHc9YW5ndWxhci5pc0RlZmluZWQoby5hcHBlbmRUb0JvZHkpP28uYXBwZW5kVG9Cb2R5OiExLHg9bih2b2lkIDApLHk9YW5ndWxhci5pc0RlZmluZWQoZFtsK1wiRW5hYmxlXCJdKSx6PWZ1bmN0aW9uKCl7dmFyIGE9ai5wb3NpdGlvbkVsZW1lbnRzKGMsdCxiLnR0X3BsYWNlbWVudCx3KTthLnRvcCs9XCJweFwiLGEubGVmdCs9XCJweFwiLHQuY3NzKGEpfTtiLnR0X2lzT3Blbj0hMSxkLiRvYnNlcnZlKGUsZnVuY3Rpb24oYSl7Yi50dF9jb250ZW50PWEsIWEmJmIudHRfaXNPcGVuJiZxKCl9KSxkLiRvYnNlcnZlKGwrXCJUaXRsZVwiLGZ1bmN0aW9uKGEpe2IudHRfdGl0bGU9YX0pLGQuJG9ic2VydmUobCtcIlBsYWNlbWVudFwiLGZ1bmN0aW9uKGEpe2IudHRfcGxhY2VtZW50PWFuZ3VsYXIuaXNEZWZpbmVkKGEpP2E6by5wbGFjZW1lbnR9KSxkLiRvYnNlcnZlKGwrXCJQb3B1cERlbGF5XCIsZnVuY3Rpb24oYSl7dmFyIGM9cGFyc2VJbnQoYSwxMCk7Yi50dF9wb3B1cERlbGF5PWlzTmFOKGMpP28ucG9wdXBEZWxheTpjfSk7dmFyIEE9ZnVuY3Rpb24oKXtjLnVuYmluZCh4LnNob3csayksYy51bmJpbmQoeC5oaWRlLG0pfTtkLiRvYnNlcnZlKGwrXCJUcmlnZ2VyXCIsZnVuY3Rpb24oYSl7QSgpLHg9bihhKSx4LnNob3c9PT14LmhpZGU/Yy5iaW5kKHguc2hvdyxmKTooYy5iaW5kKHguc2hvdyxrKSxjLmJpbmQoeC5oaWRlLG0pKX0pO3ZhciBCPWIuJGV2YWwoZFtsK1wiQW5pbWF0aW9uXCJdKTtiLnR0X2FuaW1hdGlvbj1hbmd1bGFyLmlzRGVmaW5lZChCKT8hIUI6by5hbmltYXRpb24sZC4kb2JzZXJ2ZShsK1wiQXBwZW5kVG9Cb2R5XCIsZnVuY3Rpb24oYSl7dz1hbmd1bGFyLmlzRGVmaW5lZChhKT9oKGEpKGIpOnd9KSx3JiZiLiRvbihcIiRsb2NhdGlvbkNoYW5nZVN1Y2Nlc3NcIixmdW5jdGlvbigpe2IudHRfaXNPcGVuJiZxKCl9KSxiLiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtnLmNhbmNlbCh1KSxnLmNhbmNlbCh2KSxBKCkscygpfSl9fX19fV19KS5kaXJlY3RpdmUoXCJ0b29sdGlwUG9wdXBcIixmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVBXCIscmVwbGFjZTohMCxzY29wZTp7Y29udGVudDpcIkBcIixwbGFjZW1lbnQ6XCJAXCIsYW5pbWF0aW9uOlwiJlwiLGlzT3BlbjpcIiZcIn0sdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZS90b29sdGlwL3Rvb2x0aXAtcG9wdXAuaHRtbFwifX0pLmRpcmVjdGl2ZShcInRvb2x0aXBcIixbXCIkdG9vbHRpcFwiLGZ1bmN0aW9uKGEpe3JldHVybiBhKFwidG9vbHRpcFwiLFwidG9vbHRpcFwiLFwibW91c2VlbnRlclwiKX1dKS5kaXJlY3RpdmUoXCJ0b29sdGlwSHRtbFVuc2FmZVBvcHVwXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHJlcGxhY2U6ITAsc2NvcGU6e2NvbnRlbnQ6XCJAXCIscGxhY2VtZW50OlwiQFwiLGFuaW1hdGlvbjpcIiZcIixpc09wZW46XCImXCJ9LHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvdG9vbHRpcC90b29sdGlwLWh0bWwtdW5zYWZlLXBvcHVwLmh0bWxcIn19KS5kaXJlY3RpdmUoXCJ0b29sdGlwSHRtbFVuc2FmZVwiLFtcIiR0b29sdGlwXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEoXCJ0b29sdGlwSHRtbFVuc2FmZVwiLFwidG9vbHRpcFwiLFwibW91c2VlbnRlclwiKX1dKSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC5wb3BvdmVyXCIsW1widWkuYm9vdHN0cmFwLnRvb2x0aXBcIl0pLmRpcmVjdGl2ZShcInBvcG92ZXJQb3B1cFwiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixyZXBsYWNlOiEwLHNjb3BlOnt0aXRsZTpcIkBcIixjb250ZW50OlwiQFwiLHBsYWNlbWVudDpcIkBcIixhbmltYXRpb246XCImXCIsaXNPcGVuOlwiJlwifSx0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL3BvcG92ZXIvcG9wb3Zlci5odG1sXCJ9fSkuZGlyZWN0aXZlKFwicG9wb3ZlclwiLFtcIiR0b29sdGlwXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEoXCJwb3BvdmVyXCIsXCJwb3BvdmVyXCIsXCJjbGlja1wiKX1dKSxhbmd1bGFyLm1vZHVsZShcInVpLmJvb3RzdHJhcC5wcm9ncmVzc2JhclwiLFtdKS5jb25zdGFudChcInByb2dyZXNzQ29uZmlnXCIse2FuaW1hdGU6ITAsbWF4OjEwMH0pLmNvbnRyb2xsZXIoXCJQcm9ncmVzc0NvbnRyb2xsZXJcIixbXCIkc2NvcGVcIixcIiRhdHRyc1wiLFwicHJvZ3Jlc3NDb25maWdcIixmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcyxlPWFuZ3VsYXIuaXNEZWZpbmVkKGIuYW5pbWF0ZSk/YS4kcGFyZW50LiRldmFsKGIuYW5pbWF0ZSk6Yy5hbmltYXRlO3RoaXMuYmFycz1bXSxhLm1heD1hbmd1bGFyLmlzRGVmaW5lZChiLm1heCk/YS4kcGFyZW50LiRldmFsKGIubWF4KTpjLm1heCx0aGlzLmFkZEJhcj1mdW5jdGlvbihiLGMpe2V8fGMuY3NzKHt0cmFuc2l0aW9uOlwibm9uZVwifSksdGhpcy5iYXJzLnB1c2goYiksYi4kd2F0Y2goXCJ2YWx1ZVwiLGZ1bmN0aW9uKGMpe2IucGVyY2VudD0rKDEwMCpjL2EubWF4KS50b0ZpeGVkKDIpfSksYi4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7Yz1udWxsLGQucmVtb3ZlQmFyKGIpfSl9LHRoaXMucmVtb3ZlQmFyPWZ1bmN0aW9uKGEpe3RoaXMuYmFycy5zcGxpY2UodGhpcy5iYXJzLmluZGV4T2YoYSksMSl9fV0pLmRpcmVjdGl2ZShcInByb2dyZXNzXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHJlcGxhY2U6ITAsdHJhbnNjbHVkZTohMCxjb250cm9sbGVyOlwiUHJvZ3Jlc3NDb250cm9sbGVyXCIscmVxdWlyZTpcInByb2dyZXNzXCIsc2NvcGU6e30sdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZS9wcm9ncmVzc2Jhci9wcm9ncmVzcy5odG1sXCJ9fSkuZGlyZWN0aXZlKFwiYmFyXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHJlcGxhY2U6ITAsdHJhbnNjbHVkZTohMCxyZXF1aXJlOlwiXnByb2dyZXNzXCIsc2NvcGU6e3ZhbHVlOlwiPVwiLHR5cGU6XCJAXCJ9LHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvcHJvZ3Jlc3NiYXIvYmFyLmh0bWxcIixsaW5rOmZ1bmN0aW9uKGEsYixjLGQpe2QuYWRkQmFyKGEsYil9fX0pLmRpcmVjdGl2ZShcInByb2dyZXNzYmFyXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHJlcGxhY2U6ITAsdHJhbnNjbHVkZTohMCxjb250cm9sbGVyOlwiUHJvZ3Jlc3NDb250cm9sbGVyXCIsc2NvcGU6e3ZhbHVlOlwiPVwiLHR5cGU6XCJAXCJ9LHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvcHJvZ3Jlc3NiYXIvcHJvZ3Jlc3NiYXIuaHRtbFwiLGxpbms6ZnVuY3Rpb24oYSxiLGMsZCl7ZC5hZGRCYXIoYSxhbmd1bGFyLmVsZW1lbnQoYi5jaGlsZHJlbigpWzBdKSl9fX0pLGFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwLnJhdGluZ1wiLFtdKS5jb25zdGFudChcInJhdGluZ0NvbmZpZ1wiLHttYXg6NSxzdGF0ZU9uOm51bGwsc3RhdGVPZmY6bnVsbH0pLmNvbnRyb2xsZXIoXCJSYXRpbmdDb250cm9sbGVyXCIsW1wiJHNjb3BlXCIsXCIkYXR0cnNcIixcInJhdGluZ0NvbmZpZ1wiLGZ1bmN0aW9uKGEsYixjKXt2YXIgZD17JHNldFZpZXdWYWx1ZTphbmd1bGFyLm5vb3B9O3RoaXMuaW5pdD1mdW5jdGlvbihlKXtkPWUsZC4kcmVuZGVyPXRoaXMucmVuZGVyLHRoaXMuc3RhdGVPbj1hbmd1bGFyLmlzRGVmaW5lZChiLnN0YXRlT24pP2EuJHBhcmVudC4kZXZhbChiLnN0YXRlT24pOmMuc3RhdGVPbix0aGlzLnN0YXRlT2ZmPWFuZ3VsYXIuaXNEZWZpbmVkKGIuc3RhdGVPZmYpP2EuJHBhcmVudC4kZXZhbChiLnN0YXRlT2ZmKTpjLnN0YXRlT2ZmO3ZhciBmPWFuZ3VsYXIuaXNEZWZpbmVkKGIucmF0aW5nU3RhdGVzKT9hLiRwYXJlbnQuJGV2YWwoYi5yYXRpbmdTdGF0ZXMpOm5ldyBBcnJheShhbmd1bGFyLmlzRGVmaW5lZChiLm1heCk/YS4kcGFyZW50LiRldmFsKGIubWF4KTpjLm1heCk7YS5yYW5nZT10aGlzLmJ1aWxkVGVtcGxhdGVPYmplY3RzKGYpfSx0aGlzLmJ1aWxkVGVtcGxhdGVPYmplY3RzPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wLGM9YS5sZW5ndGg7Yz5iO2IrKylhW2JdPWFuZ3VsYXIuZXh0ZW5kKHtpbmRleDpifSx7c3RhdGVPbjp0aGlzLnN0YXRlT24sc3RhdGVPZmY6dGhpcy5zdGF0ZU9mZn0sYVtiXSk7cmV0dXJuIGF9LGEucmF0ZT1mdW5jdGlvbihiKXshYS5yZWFkb25seSYmYj49MCYmYjw9YS5yYW5nZS5sZW5ndGgmJihkLiRzZXRWaWV3VmFsdWUoYiksZC4kcmVuZGVyKCkpfSxhLmVudGVyPWZ1bmN0aW9uKGIpe2EucmVhZG9ubHl8fChhLnZhbHVlPWIpLGEub25Ib3Zlcih7dmFsdWU6Yn0pfSxhLnJlc2V0PWZ1bmN0aW9uKCl7YS52YWx1ZT1kLiR2aWV3VmFsdWUsYS5vbkxlYXZlKCl9LGEub25LZXlkb3duPWZ1bmN0aW9uKGIpey8oMzd8Mzh8Mzl8NDApLy50ZXN0KGIud2hpY2gpJiYoYi5wcmV2ZW50RGVmYXVsdCgpLGIuc3RvcFByb3BhZ2F0aW9uKCksYS5yYXRlKGEudmFsdWUrKDM4PT09Yi53aGljaHx8Mzk9PT1iLndoaWNoPzE6LTEpKSl9LHRoaXMucmVuZGVyPWZ1bmN0aW9uKCl7YS52YWx1ZT1kLiR2aWV3VmFsdWV9fV0pLmRpcmVjdGl2ZShcInJhdGluZ1wiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixyZXF1aXJlOltcInJhdGluZ1wiLFwibmdNb2RlbFwiXSxzY29wZTp7cmVhZG9ubHk6XCI9P1wiLG9uSG92ZXI6XCImXCIsb25MZWF2ZTpcIiZcIn0sY29udHJvbGxlcjpcIlJhdGluZ0NvbnRyb2xsZXJcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL3JhdGluZy9yYXRpbmcuaHRtbFwiLHJlcGxhY2U6ITAsbGluazpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1kWzBdLGY9ZFsxXTtmJiZlLmluaXQoZil9fX0pLGFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwLnRhYnNcIixbXSkuY29udHJvbGxlcihcIlRhYnNldENvbnRyb2xsZXJcIixbXCIkc2NvcGVcIixmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9Yi50YWJzPWEudGFicz1bXTtiLnNlbGVjdD1mdW5jdGlvbihhKXthbmd1bGFyLmZvckVhY2goYyxmdW5jdGlvbihiKXtiLmFjdGl2ZSYmYiE9PWEmJihiLmFjdGl2ZT0hMSxiLm9uRGVzZWxlY3QoKSl9KSxhLmFjdGl2ZT0hMCxhLm9uU2VsZWN0KCl9LGIuYWRkVGFiPWZ1bmN0aW9uKGEpe2MucHVzaChhKSwxPT09Yy5sZW5ndGg/YS5hY3RpdmU9ITA6YS5hY3RpdmUmJmIuc2VsZWN0KGEpfSxiLnJlbW92ZVRhYj1mdW5jdGlvbihhKXt2YXIgZD1jLmluZGV4T2YoYSk7aWYoYS5hY3RpdmUmJmMubGVuZ3RoPjEpe3ZhciBlPWQ9PWMubGVuZ3RoLTE/ZC0xOmQrMTtiLnNlbGVjdChjW2VdKX1jLnNwbGljZShkLDEpfX1dKS5kaXJlY3RpdmUoXCJ0YWJzZXRcIixmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVBXCIsdHJhbnNjbHVkZTohMCxyZXBsYWNlOiEwLHNjb3BlOnt0eXBlOlwiQFwifSxjb250cm9sbGVyOlwiVGFic2V0Q29udHJvbGxlclwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvdGFicy90YWJzZXQuaHRtbFwiLGxpbms6ZnVuY3Rpb24oYSxiLGMpe2EudmVydGljYWw9YW5ndWxhci5pc0RlZmluZWQoYy52ZXJ0aWNhbCk/YS4kcGFyZW50LiRldmFsKGMudmVydGljYWwpOiExLGEuanVzdGlmaWVkPWFuZ3VsYXIuaXNEZWZpbmVkKGMuanVzdGlmaWVkKT9hLiRwYXJlbnQuJGV2YWwoYy5qdXN0aWZpZWQpOiExfX19KS5kaXJlY3RpdmUoXCJ0YWJcIixbXCIkcGFyc2VcIixmdW5jdGlvbihhKXtyZXR1cm57cmVxdWlyZTpcIl50YWJzZXRcIixyZXN0cmljdDpcIkVBXCIscmVwbGFjZTohMCx0ZW1wbGF0ZVVybDpcInRlbXBsYXRlL3RhYnMvdGFiLmh0bWxcIix0cmFuc2NsdWRlOiEwLHNjb3BlOnthY3RpdmU6XCI9P1wiLGhlYWRpbmc6XCJAXCIsb25TZWxlY3Q6XCImc2VsZWN0XCIsb25EZXNlbGVjdDpcIiZkZXNlbGVjdFwifSxjb250cm9sbGVyOmZ1bmN0aW9uKCl7fSxjb21waWxlOmZ1bmN0aW9uKGIsYyxkKXtyZXR1cm4gZnVuY3Rpb24oYixjLGUsZil7Yi4kd2F0Y2goXCJhY3RpdmVcIixmdW5jdGlvbihhKXthJiZmLnNlbGVjdChiKX0pLGIuZGlzYWJsZWQ9ITEsZS5kaXNhYmxlZCYmYi4kcGFyZW50LiR3YXRjaChhKGUuZGlzYWJsZWQpLGZ1bmN0aW9uKGEpe2IuZGlzYWJsZWQ9ISFhfSksYi5zZWxlY3Q9ZnVuY3Rpb24oKXtiLmRpc2FibGVkfHwoYi5hY3RpdmU9ITApfSxmLmFkZFRhYihiKSxiLiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtmLnJlbW92ZVRhYihiKX0pLGIuJHRyYW5zY2x1ZGVGbj1kfX19fV0pLmRpcmVjdGl2ZShcInRhYkhlYWRpbmdUcmFuc2NsdWRlXCIsW2Z1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHJlcXVpcmU6XCJedGFiXCIsbGluazpmdW5jdGlvbihhLGIpe2EuJHdhdGNoKFwiaGVhZGluZ0VsZW1lbnRcIixmdW5jdGlvbihhKXthJiYoYi5odG1sKFwiXCIpLGIuYXBwZW5kKGEpKX0pfX19XSkuZGlyZWN0aXZlKFwidGFiQ29udGVudFRyYW5zY2x1ZGVcIixmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7cmV0dXJuIGEudGFnTmFtZSYmKGEuaGFzQXR0cmlidXRlKFwidGFiLWhlYWRpbmdcIil8fGEuaGFzQXR0cmlidXRlKFwiZGF0YS10YWItaGVhZGluZ1wiKXx8XCJ0YWItaGVhZGluZ1wiPT09YS50YWdOYW1lLnRvTG93ZXJDYXNlKCl8fFwiZGF0YS10YWItaGVhZGluZ1wiPT09YS50YWdOYW1lLnRvTG93ZXJDYXNlKCkpfXJldHVybntyZXN0cmljdDpcIkFcIixyZXF1aXJlOlwiXnRhYnNldFwiLGxpbms6ZnVuY3Rpb24oYixjLGQpe3ZhciBlPWIuJGV2YWwoZC50YWJDb250ZW50VHJhbnNjbHVkZSk7ZS4kdHJhbnNjbHVkZUZuKGUuJHBhcmVudCxmdW5jdGlvbihiKXthbmd1bGFyLmZvckVhY2goYixmdW5jdGlvbihiKXthKGIpP2UuaGVhZGluZ0VsZW1lbnQ9YjpjLmFwcGVuZChiKX0pfSl9fX0pLGFuZ3VsYXIubW9kdWxlKFwidWkuYm9vdHN0cmFwLnRpbWVwaWNrZXJcIixbXSkuY29uc3RhbnQoXCJ0aW1lcGlja2VyQ29uZmlnXCIse2hvdXJTdGVwOjEsbWludXRlU3RlcDoxLHNob3dNZXJpZGlhbjohMCxtZXJpZGlhbnM6bnVsbCxyZWFkb25seUlucHV0OiExLG1vdXNld2hlZWw6ITB9KS5jb250cm9sbGVyKFwiVGltZXBpY2tlckNvbnRyb2xsZXJcIixbXCIkc2NvcGVcIixcIiRhdHRyc1wiLFwiJHBhcnNlXCIsXCIkbG9nXCIsXCIkbG9jYWxlXCIsXCJ0aW1lcGlja2VyQ29uZmlnXCIsZnVuY3Rpb24oYSxiLGMsZCxlLGYpe2Z1bmN0aW9uIGcoKXt2YXIgYj1wYXJzZUludChhLmhvdXJzLDEwKSxjPWEuc2hvd01lcmlkaWFuP2I+MCYmMTM+YjpiPj0wJiYyND5iO3JldHVybiBjPyhhLnNob3dNZXJpZGlhbiYmKDEyPT09YiYmKGI9MCksYS5tZXJpZGlhbj09PXBbMV0mJihiKz0xMikpLGIpOnZvaWQgMH1mdW5jdGlvbiBoKCl7dmFyIGI9cGFyc2VJbnQoYS5taW51dGVzLDEwKTtyZXR1cm4gYj49MCYmNjA+Yj9iOnZvaWQgMH1mdW5jdGlvbiBpKGEpe3JldHVybiBhbmd1bGFyLmlzRGVmaW5lZChhKSYmYS50b1N0cmluZygpLmxlbmd0aDwyP1wiMFwiK2E6YX1mdW5jdGlvbiBqKGEpe2soKSxvLiRzZXRWaWV3VmFsdWUobmV3IERhdGUobikpLGwoYSl9ZnVuY3Rpb24gaygpe28uJHNldFZhbGlkaXR5KFwidGltZVwiLCEwKSxhLmludmFsaWRIb3Vycz0hMSxhLmludmFsaWRNaW51dGVzPSExfWZ1bmN0aW9uIGwoYil7dmFyIGM9bi5nZXRIb3VycygpLGQ9bi5nZXRNaW51dGVzKCk7YS5zaG93TWVyaWRpYW4mJihjPTA9PT1jfHwxMj09PWM/MTI6YyUxMiksYS5ob3Vycz1cImhcIj09PWI/YzppKGMpLGEubWludXRlcz1cIm1cIj09PWI/ZDppKGQpLGEubWVyaWRpYW49bi5nZXRIb3VycygpPDEyP3BbMF06cFsxXX1mdW5jdGlvbiBtKGEpe3ZhciBiPW5ldyBEYXRlKG4uZ2V0VGltZSgpKzZlNCphKTtuLnNldEhvdXJzKGIuZ2V0SG91cnMoKSxiLmdldE1pbnV0ZXMoKSksaigpfXZhciBuPW5ldyBEYXRlLG89eyRzZXRWaWV3VmFsdWU6YW5ndWxhci5ub29wfSxwPWFuZ3VsYXIuaXNEZWZpbmVkKGIubWVyaWRpYW5zKT9hLiRwYXJlbnQuJGV2YWwoYi5tZXJpZGlhbnMpOmYubWVyaWRpYW5zfHxlLkRBVEVUSU1FX0ZPUk1BVFMuQU1QTVM7dGhpcy5pbml0PWZ1bmN0aW9uKGMsZCl7bz1jLG8uJHJlbmRlcj10aGlzLnJlbmRlcjt2YXIgZT1kLmVxKDApLGc9ZC5lcSgxKSxoPWFuZ3VsYXIuaXNEZWZpbmVkKGIubW91c2V3aGVlbCk/YS4kcGFyZW50LiRldmFsKGIubW91c2V3aGVlbCk6Zi5tb3VzZXdoZWVsO2gmJnRoaXMuc2V0dXBNb3VzZXdoZWVsRXZlbnRzKGUsZyksYS5yZWFkb25seUlucHV0PWFuZ3VsYXIuaXNEZWZpbmVkKGIucmVhZG9ubHlJbnB1dCk/YS4kcGFyZW50LiRldmFsKGIucmVhZG9ubHlJbnB1dCk6Zi5yZWFkb25seUlucHV0LHRoaXMuc2V0dXBJbnB1dEV2ZW50cyhlLGcpfTt2YXIgcT1mLmhvdXJTdGVwO2IuaG91clN0ZXAmJmEuJHBhcmVudC4kd2F0Y2goYyhiLmhvdXJTdGVwKSxmdW5jdGlvbihhKXtxPXBhcnNlSW50KGEsMTApfSk7dmFyIHI9Zi5taW51dGVTdGVwO2IubWludXRlU3RlcCYmYS4kcGFyZW50LiR3YXRjaChjKGIubWludXRlU3RlcCksZnVuY3Rpb24oYSl7cj1wYXJzZUludChhLDEwKX0pLGEuc2hvd01lcmlkaWFuPWYuc2hvd01lcmlkaWFuLGIuc2hvd01lcmlkaWFuJiZhLiRwYXJlbnQuJHdhdGNoKGMoYi5zaG93TWVyaWRpYW4pLGZ1bmN0aW9uKGIpe2lmKGEuc2hvd01lcmlkaWFuPSEhYixvLiRlcnJvci50aW1lKXt2YXIgYz1nKCksZD1oKCk7YW5ndWxhci5pc0RlZmluZWQoYykmJmFuZ3VsYXIuaXNEZWZpbmVkKGQpJiYobi5zZXRIb3VycyhjKSxqKCkpfWVsc2UgbCgpfSksdGhpcy5zZXR1cE1vdXNld2hlZWxFdmVudHM9ZnVuY3Rpb24oYixjKXt2YXIgZD1mdW5jdGlvbihhKXthLm9yaWdpbmFsRXZlbnQmJihhPWEub3JpZ2luYWxFdmVudCk7dmFyIGI9YS53aGVlbERlbHRhP2Eud2hlZWxEZWx0YTotYS5kZWx0YVk7cmV0dXJuIGEuZGV0YWlsfHxiPjB9O2IuYmluZChcIm1vdXNld2hlZWwgd2hlZWxcIixmdW5jdGlvbihiKXthLiRhcHBseShkKGIpP2EuaW5jcmVtZW50SG91cnMoKTphLmRlY3JlbWVudEhvdXJzKCkpLGIucHJldmVudERlZmF1bHQoKX0pLGMuYmluZChcIm1vdXNld2hlZWwgd2hlZWxcIixmdW5jdGlvbihiKXthLiRhcHBseShkKGIpP2EuaW5jcmVtZW50TWludXRlcygpOmEuZGVjcmVtZW50TWludXRlcygpKSxiLnByZXZlbnREZWZhdWx0KCl9KX0sdGhpcy5zZXR1cElucHV0RXZlbnRzPWZ1bmN0aW9uKGIsYyl7aWYoYS5yZWFkb25seUlucHV0KXJldHVybiBhLnVwZGF0ZUhvdXJzPWFuZ3VsYXIubm9vcCx2b2lkKGEudXBkYXRlTWludXRlcz1hbmd1bGFyLm5vb3ApO3ZhciBkPWZ1bmN0aW9uKGIsYyl7by4kc2V0Vmlld1ZhbHVlKG51bGwpLG8uJHNldFZhbGlkaXR5KFwidGltZVwiLCExKSxhbmd1bGFyLmlzRGVmaW5lZChiKSYmKGEuaW52YWxpZEhvdXJzPWIpLGFuZ3VsYXIuaXNEZWZpbmVkKGMpJiYoYS5pbnZhbGlkTWludXRlcz1jKX07YS51cGRhdGVIb3Vycz1mdW5jdGlvbigpe3ZhciBhPWcoKTthbmd1bGFyLmlzRGVmaW5lZChhKT8obi5zZXRIb3VycyhhKSxqKFwiaFwiKSk6ZCghMCl9LGIuYmluZChcImJsdXJcIixmdW5jdGlvbigpeyFhLmludmFsaWRIb3VycyYmYS5ob3VyczwxMCYmYS4kYXBwbHkoZnVuY3Rpb24oKXthLmhvdXJzPWkoYS5ob3Vycyl9KX0pLGEudXBkYXRlTWludXRlcz1mdW5jdGlvbigpe3ZhciBhPWgoKTthbmd1bGFyLmlzRGVmaW5lZChhKT8obi5zZXRNaW51dGVzKGEpLGooXCJtXCIpKTpkKHZvaWQgMCwhMCl9LGMuYmluZChcImJsdXJcIixmdW5jdGlvbigpeyFhLmludmFsaWRNaW51dGVzJiZhLm1pbnV0ZXM8MTAmJmEuJGFwcGx5KGZ1bmN0aW9uKCl7YS5taW51dGVzPWkoYS5taW51dGVzKX0pfSl9LHRoaXMucmVuZGVyPWZ1bmN0aW9uKCl7dmFyIGE9by4kbW9kZWxWYWx1ZT9uZXcgRGF0ZShvLiRtb2RlbFZhbHVlKTpudWxsO2lzTmFOKGEpPyhvLiRzZXRWYWxpZGl0eShcInRpbWVcIiwhMSksZC5lcnJvcignVGltZXBpY2tlciBkaXJlY3RpdmU6IFwibmctbW9kZWxcIiB2YWx1ZSBtdXN0IGJlIGEgRGF0ZSBvYmplY3QsIGEgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBzaW5jZSAwMS4wMS4xOTcwIG9yIGEgc3RyaW5nIHJlcHJlc2VudGluZyBhbiBSRkMyODIyIG9yIElTTyA4NjAxIGRhdGUuJykpOihhJiYobj1hKSxrKCksbCgpKX0sYS5pbmNyZW1lbnRIb3Vycz1mdW5jdGlvbigpe20oNjAqcSl9LGEuZGVjcmVtZW50SG91cnM9ZnVuY3Rpb24oKXttKDYwKi1xKX0sYS5pbmNyZW1lbnRNaW51dGVzPWZ1bmN0aW9uKCl7bShyKX0sYS5kZWNyZW1lbnRNaW51dGVzPWZ1bmN0aW9uKCl7bSgtcil9LGEudG9nZ2xlTWVyaWRpYW49ZnVuY3Rpb24oKXttKDcyMCoobi5nZXRIb3VycygpPDEyPzE6LTEpKX19XSkuZGlyZWN0aXZlKFwidGltZXBpY2tlclwiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixyZXF1aXJlOltcInRpbWVwaWNrZXJcIixcIj9ebmdNb2RlbFwiXSxjb250cm9sbGVyOlwiVGltZXBpY2tlckNvbnRyb2xsZXJcIixyZXBsYWNlOiEwLHNjb3BlOnt9LHRlbXBsYXRlVXJsOlwidGVtcGxhdGUvdGltZXBpY2tlci90aW1lcGlja2VyLmh0bWxcIixsaW5rOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPWRbMF0sZj1kWzFdO2YmJmUuaW5pdChmLGIuZmluZChcImlucHV0XCIpKX19fSksYW5ndWxhci5tb2R1bGUoXCJ1aS5ib290c3RyYXAudHlwZWFoZWFkXCIsW1widWkuYm9vdHN0cmFwLnBvc2l0aW9uXCIsXCJ1aS5ib290c3RyYXAuYmluZEh0bWxcIl0pLmZhY3RvcnkoXCJ0eXBlYWhlYWRQYXJzZXJcIixbXCIkcGFyc2VcIixmdW5jdGlvbihhKXt2YXIgYj0vXlxccyooW1xcc1xcU10rPykoPzpcXHMrYXNcXHMrKFtcXHNcXFNdKz8pKT9cXHMrZm9yXFxzKyg/OihbXFwkXFx3XVtcXCRcXHdcXGRdKikpXFxzK2luXFxzKyhbXFxzXFxTXSs/KSQvO3JldHVybntwYXJzZTpmdW5jdGlvbihjKXt2YXIgZD1jLm1hdGNoKGIpO2lmKCFkKXRocm93IG5ldyBFcnJvcignRXhwZWN0ZWQgdHlwZWFoZWFkIHNwZWNpZmljYXRpb24gaW4gZm9ybSBvZiBcIl9tb2RlbFZhbHVlXyAoYXMgX2xhYmVsXyk/IGZvciBfaXRlbV8gaW4gX2NvbGxlY3Rpb25fXCIgYnV0IGdvdCBcIicrYysnXCIuJyk7cmV0dXJue2l0ZW1OYW1lOmRbM10sc291cmNlOmEoZFs0XSksdmlld01hcHBlcjphKGRbMl18fGRbMV0pLG1vZGVsTWFwcGVyOmEoZFsxXSl9fX19XSkuZGlyZWN0aXZlKFwidHlwZWFoZWFkXCIsW1wiJGNvbXBpbGVcIixcIiRwYXJzZVwiLFwiJHFcIixcIiR0aW1lb3V0XCIsXCIkZG9jdW1lbnRcIixcIiRwb3NpdGlvblwiLFwidHlwZWFoZWFkUGFyc2VyXCIsZnVuY3Rpb24oYSxiLGMsZCxlLGYsZyl7dmFyIGg9WzksMTMsMjcsMzgsNDBdO3JldHVybntyZXF1aXJlOlwibmdNb2RlbFwiLGxpbms6ZnVuY3Rpb24oaSxqLGssbCl7dmFyIG0sbj1pLiRldmFsKGsudHlwZWFoZWFkTWluTGVuZ3RoKXx8MSxvPWkuJGV2YWwoay50eXBlYWhlYWRXYWl0TXMpfHwwLHA9aS4kZXZhbChrLnR5cGVhaGVhZEVkaXRhYmxlKSE9PSExLHE9YihrLnR5cGVhaGVhZExvYWRpbmcpLmFzc2lnbnx8YW5ndWxhci5ub29wLHI9YihrLnR5cGVhaGVhZE9uU2VsZWN0KSxzPWsudHlwZWFoZWFkSW5wdXRGb3JtYXR0ZXI/YihrLnR5cGVhaGVhZElucHV0Rm9ybWF0dGVyKTp2b2lkIDAsdD1rLnR5cGVhaGVhZEFwcGVuZFRvQm9keT9pLiRldmFsKGsudHlwZWFoZWFkQXBwZW5kVG9Cb2R5KTohMSx1PWIoay5uZ01vZGVsKS5hc3NpZ24sdj1nLnBhcnNlKGsudHlwZWFoZWFkKSx3PWkuJG5ldygpO2kuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe3cuJGRlc3Ryb3koKX0pO3ZhciB4PVwidHlwZWFoZWFkLVwiK3cuJGlkK1wiLVwiK01hdGguZmxvb3IoMWU0Kk1hdGgucmFuZG9tKCkpO2ouYXR0cih7XCJhcmlhLWF1dG9jb21wbGV0ZVwiOlwibGlzdFwiLFwiYXJpYS1leHBhbmRlZFwiOiExLFwiYXJpYS1vd25zXCI6eH0pO3ZhciB5PWFuZ3VsYXIuZWxlbWVudChcIjxkaXYgdHlwZWFoZWFkLXBvcHVwPjwvZGl2PlwiKTt5LmF0dHIoe2lkOngsbWF0Y2hlczpcIm1hdGNoZXNcIixhY3RpdmU6XCJhY3RpdmVJZHhcIixzZWxlY3Q6XCJzZWxlY3QoYWN0aXZlSWR4KVwiLHF1ZXJ5OlwicXVlcnlcIixwb3NpdGlvbjpcInBvc2l0aW9uXCJ9KSxhbmd1bGFyLmlzRGVmaW5lZChrLnR5cGVhaGVhZFRlbXBsYXRlVXJsKSYmeS5hdHRyKFwidGVtcGxhdGUtdXJsXCIsay50eXBlYWhlYWRUZW1wbGF0ZVVybCk7dmFyIHo9ZnVuY3Rpb24oKXt3Lm1hdGNoZXM9W10sdy5hY3RpdmVJZHg9LTEsai5hdHRyKFwiYXJpYS1leHBhbmRlZFwiLCExKX0sQT1mdW5jdGlvbihhKXtyZXR1cm4geCtcIi1vcHRpb24tXCIrYX07dy4kd2F0Y2goXCJhY3RpdmVJZHhcIixmdW5jdGlvbihhKXswPmE/ai5yZW1vdmVBdHRyKFwiYXJpYS1hY3RpdmVkZXNjZW5kYW50XCIpOmouYXR0cihcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiLEEoYSkpfSk7dmFyIEI9ZnVuY3Rpb24oYSl7dmFyIGI9eyR2aWV3VmFsdWU6YX07cShpLCEwKSxjLndoZW4odi5zb3VyY2UoaSxiKSkudGhlbihmdW5jdGlvbihjKXt2YXIgZD1hPT09bC4kdmlld1ZhbHVlO2lmKGQmJm0paWYoYy5sZW5ndGg+MCl7dy5hY3RpdmVJZHg9MCx3Lm1hdGNoZXMubGVuZ3RoPTA7Zm9yKHZhciBlPTA7ZTxjLmxlbmd0aDtlKyspYlt2Lml0ZW1OYW1lXT1jW2VdLHcubWF0Y2hlcy5wdXNoKHtpZDpBKGUpLGxhYmVsOnYudmlld01hcHBlcih3LGIpLG1vZGVsOmNbZV19KTt3LnF1ZXJ5PWEsdy5wb3NpdGlvbj10P2Yub2Zmc2V0KGopOmYucG9zaXRpb24oaiksdy5wb3NpdGlvbi50b3A9dy5wb3NpdGlvbi50b3Arai5wcm9wKFwib2Zmc2V0SGVpZ2h0XCIpLGouYXR0cihcImFyaWEtZXhwYW5kZWRcIiwhMCl9ZWxzZSB6KCk7ZCYmcShpLCExKX0sZnVuY3Rpb24oKXt6KCkscShpLCExKX0pfTt6KCksdy5xdWVyeT12b2lkIDA7dmFyIEMsRD1mdW5jdGlvbihhKXtDPWQoZnVuY3Rpb24oKXtCKGEpfSxvKX0sRT1mdW5jdGlvbigpe0MmJmQuY2FuY2VsKEMpfTtsLiRwYXJzZXJzLnVuc2hpZnQoZnVuY3Rpb24oYSl7cmV0dXJuIG09ITAsYSYmYS5sZW5ndGg+PW4/bz4wPyhFKCksRChhKSk6QihhKToocShpLCExKSxFKCkseigpKSxwP2E6YT92b2lkIGwuJHNldFZhbGlkaXR5KFwiZWRpdGFibGVcIiwhMSk6KGwuJHNldFZhbGlkaXR5KFwiZWRpdGFibGVcIiwhMCksYSl9KSxsLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24oYSl7dmFyIGIsYyxkPXt9O3JldHVybiBzPyhkLiRtb2RlbD1hLHMoaSxkKSk6KGRbdi5pdGVtTmFtZV09YSxiPXYudmlld01hcHBlcihpLGQpLGRbdi5pdGVtTmFtZV09dm9pZCAwLGM9di52aWV3TWFwcGVyKGksZCksYiE9PWM/YjphKX0pLHcuc2VsZWN0PWZ1bmN0aW9uKGEpe3ZhciBiLGMsZT17fTtlW3YuaXRlbU5hbWVdPWM9dy5tYXRjaGVzW2FdLm1vZGVsLGI9di5tb2RlbE1hcHBlcihpLGUpLHUoaSxiKSxsLiRzZXRWYWxpZGl0eShcImVkaXRhYmxlXCIsITApLHIoaSx7JGl0ZW06YywkbW9kZWw6YiwkbGFiZWw6di52aWV3TWFwcGVyKGksZSl9KSx6KCksZChmdW5jdGlvbigpe2pbMF0uZm9jdXMoKX0sMCwhMSl9LGouYmluZChcImtleWRvd25cIixmdW5jdGlvbihhKXswIT09dy5tYXRjaGVzLmxlbmd0aCYmLTEhPT1oLmluZGV4T2YoYS53aGljaCkmJihhLnByZXZlbnREZWZhdWx0KCksNDA9PT1hLndoaWNoPyh3LmFjdGl2ZUlkeD0ody5hY3RpdmVJZHgrMSkldy5tYXRjaGVzLmxlbmd0aCx3LiRkaWdlc3QoKSk6Mzg9PT1hLndoaWNoPyh3LmFjdGl2ZUlkeD0ody5hY3RpdmVJZHg/dy5hY3RpdmVJZHg6dy5tYXRjaGVzLmxlbmd0aCktMSx3LiRkaWdlc3QoKSk6MTM9PT1hLndoaWNofHw5PT09YS53aGljaD93LiRhcHBseShmdW5jdGlvbigpe3cuc2VsZWN0KHcuYWN0aXZlSWR4KX0pOjI3PT09YS53aGljaCYmKGEuc3RvcFByb3BhZ2F0aW9uKCkseigpLHcuJGRpZ2VzdCgpKSl9KSxqLmJpbmQoXCJibHVyXCIsZnVuY3Rpb24oKXttPSExfSk7dmFyIEY9ZnVuY3Rpb24oYSl7alswXSE9PWEudGFyZ2V0JiYoeigpLHcuJGRpZ2VzdCgpKX07ZS5iaW5kKFwiY2xpY2tcIixGKSxpLiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtlLnVuYmluZChcImNsaWNrXCIsRil9KTt2YXIgRz1hKHkpKHcpO3Q/ZS5maW5kKFwiYm9keVwiKS5hcHBlbmQoRyk6ai5hZnRlcihHKX19fV0pLmRpcmVjdGl2ZShcInR5cGVhaGVhZFBvcHVwXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHNjb3BlOnttYXRjaGVzOlwiPVwiLHF1ZXJ5OlwiPVwiLGFjdGl2ZTpcIj1cIixwb3NpdGlvbjpcIj1cIixzZWxlY3Q6XCImXCJ9LHJlcGxhY2U6ITAsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZS90eXBlYWhlYWQvdHlwZWFoZWFkLXBvcHVwLmh0bWxcIixsaW5rOmZ1bmN0aW9uKGEsYixjKXthLnRlbXBsYXRlVXJsPWMudGVtcGxhdGVVcmwsYS5pc09wZW49ZnVuY3Rpb24oKXtyZXR1cm4gYS5tYXRjaGVzLmxlbmd0aD4wfSxhLmlzQWN0aXZlPWZ1bmN0aW9uKGIpe3JldHVybiBhLmFjdGl2ZT09Yn0sYS5zZWxlY3RBY3RpdmU9ZnVuY3Rpb24oYil7YS5hY3RpdmU9Yn0sYS5zZWxlY3RNYXRjaD1mdW5jdGlvbihiKXthLnNlbGVjdCh7YWN0aXZlSWR4OmJ9KX19fX0pLmRpcmVjdGl2ZShcInR5cGVhaGVhZE1hdGNoXCIsW1wiJGh0dHBcIixcIiR0ZW1wbGF0ZUNhY2hlXCIsXCIkY29tcGlsZVwiLFwiJHBhcnNlXCIsZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixzY29wZTp7aW5kZXg6XCI9XCIsbWF0Y2g6XCI9XCIscXVlcnk6XCI9XCJ9LGxpbms6ZnVuY3Rpb24oZSxmLGcpe3ZhciBoPWQoZy50ZW1wbGF0ZVVybCkoZS4kcGFyZW50KXx8XCJ0ZW1wbGF0ZS90eXBlYWhlYWQvdHlwZWFoZWFkLW1hdGNoLmh0bWxcIjthLmdldChoLHtjYWNoZTpifSkuc3VjY2VzcyhmdW5jdGlvbihhKXtmLnJlcGxhY2VXaXRoKGMoYS50cmltKCkpKGUpKX0pfX19XSkuZmlsdGVyKFwidHlwZWFoZWFkSGlnaGxpZ2h0XCIsZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3JldHVybiBhLnJlcGxhY2UoLyhbLj8qK14kW1xcXVxcXFwoKXt9fC1dKS9nLFwiXFxcXCQxXCIpfXJldHVybiBmdW5jdGlvbihiLGMpe3JldHVybiBjPyhcIlwiK2IpLnJlcGxhY2UobmV3IFJlZ0V4cChhKGMpLFwiZ2lcIiksXCI8c3Ryb25nPiQmPC9zdHJvbmc+XCIpOmJ9fSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS9hY2NvcmRpb24vYWNjb3JkaW9uLWdyb3VwLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS9hY2NvcmRpb24vYWNjb3JkaW9uLWdyb3VwLmh0bWxcIiwnPGRpdiBjbGFzcz1cInBhbmVsIHBhbmVsLWRlZmF1bHRcIj5cXG4gIDxkaXYgY2xhc3M9XCJwYW5lbC1oZWFkaW5nXCI+XFxuICAgIDxoNCBjbGFzcz1cInBhbmVsLXRpdGxlXCI+XFxuICAgICAgPGEgY2xhc3M9XCJhY2NvcmRpb24tdG9nZ2xlXCIgbmctY2xpY2s9XCJ0b2dnbGVPcGVuKClcIiBhY2NvcmRpb24tdHJhbnNjbHVkZT1cImhlYWRpbmdcIj48c3BhbiBuZy1jbGFzcz1cIntcXCd0ZXh0LW11dGVkXFwnOiBpc0Rpc2FibGVkfVwiPnt7aGVhZGluZ319PC9zcGFuPjwvYT5cXG4gICAgPC9oND5cXG4gIDwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cInBhbmVsLWNvbGxhcHNlXCIgY29sbGFwc2U9XCIhaXNPcGVuXCI+XFxuXHQgIDxkaXYgY2xhc3M9XCJwYW5lbC1ib2R5XCIgbmctdHJhbnNjbHVkZT48L2Rpdj5cXG4gIDwvZGl2PlxcbjwvZGl2PicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvYWNjb3JkaW9uL2FjY29yZGlvbi5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvYWNjb3JkaW9uL2FjY29yZGlvbi5odG1sXCIsJzxkaXYgY2xhc3M9XCJwYW5lbC1ncm91cFwiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+Jyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS9hbGVydC9hbGVydC5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvYWxlcnQvYWxlcnQuaHRtbFwiLCc8ZGl2IGNsYXNzPVwiYWxlcnRcIiBuZy1jbGFzcz1cIltcXCdhbGVydC1cXCcgKyAodHlwZSB8fCBcXCd3YXJuaW5nXFwnKSwgY2xvc2VhYmxlID8gXFwnYWxlcnQtZGlzbWlzc2FibGVcXCcgOiBudWxsXVwiIHJvbGU9XCJhbGVydFwiPlxcbiAgICA8YnV0dG9uIG5nLXNob3c9XCJjbG9zZWFibGVcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJjbG9zZVwiIG5nLWNsaWNrPVwiY2xvc2UoKVwiPlxcbiAgICAgICAgPHNwYW4gYXJpYS1oaWRkZW49XCJ0cnVlXCI+JnRpbWVzOzwvc3Bhbj5cXG4gICAgICAgIDxzcGFuIGNsYXNzPVwic3Itb25seVwiPkNsb3NlPC9zcGFuPlxcbiAgICA8L2J1dHRvbj5cXG4gICAgPGRpdiBuZy10cmFuc2NsdWRlPjwvZGl2PlxcbjwvZGl2PlxcbicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvY2Fyb3VzZWwvY2Fyb3VzZWwuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL2Nhcm91c2VsL2Nhcm91c2VsLmh0bWxcIiwnPGRpdiBuZy1tb3VzZWVudGVyPVwicGF1c2UoKVwiIG5nLW1vdXNlbGVhdmU9XCJwbGF5KClcIiBjbGFzcz1cImNhcm91c2VsXCIgbmctc3dpcGUtcmlnaHQ9XCJwcmV2KClcIiBuZy1zd2lwZS1sZWZ0PVwibmV4dCgpXCI+XFxuICAgIDxvbCBjbGFzcz1cImNhcm91c2VsLWluZGljYXRvcnNcIiBuZy1zaG93PVwic2xpZGVzLmxlbmd0aCA+IDFcIj5cXG4gICAgICAgIDxsaSBuZy1yZXBlYXQ9XCJzbGlkZSBpbiBzbGlkZXMgdHJhY2sgYnkgJGluZGV4XCIgbmctY2xhc3M9XCJ7YWN0aXZlOiBpc0FjdGl2ZShzbGlkZSl9XCIgbmctY2xpY2s9XCJzZWxlY3Qoc2xpZGUpXCI+PC9saT5cXG4gICAgPC9vbD5cXG4gICAgPGRpdiBjbGFzcz1cImNhcm91c2VsLWlubmVyXCIgbmctdHJhbnNjbHVkZT48L2Rpdj5cXG4gICAgPGEgY2xhc3M9XCJsZWZ0IGNhcm91c2VsLWNvbnRyb2xcIiBuZy1jbGljaz1cInByZXYoKVwiIG5nLXNob3c9XCJzbGlkZXMubGVuZ3RoID4gMVwiPjxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1jaGV2cm9uLWxlZnRcIj48L3NwYW4+PC9hPlxcbiAgICA8YSBjbGFzcz1cInJpZ2h0IGNhcm91c2VsLWNvbnRyb2xcIiBuZy1jbGljaz1cIm5leHQoKVwiIG5nLXNob3c9XCJzbGlkZXMubGVuZ3RoID4gMVwiPjxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1jaGV2cm9uLXJpZ2h0XCI+PC9zcGFuPjwvYT5cXG48L2Rpdj5cXG4nKX1dKSxhbmd1bGFyLm1vZHVsZShcInRlbXBsYXRlL2Nhcm91c2VsL3NsaWRlLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS9jYXJvdXNlbC9zbGlkZS5odG1sXCIsXCI8ZGl2IG5nLWNsYXNzPVxcXCJ7XFxuICAgICdhY3RpdmUnOiBsZWF2aW5nIHx8IChhY3RpdmUgJiYgIWVudGVyaW5nKSxcXG4gICAgJ3ByZXYnOiAobmV4dCB8fCBhY3RpdmUpICYmIGRpcmVjdGlvbj09J3ByZXYnLFxcbiAgICAnbmV4dCc6IChuZXh0IHx8IGFjdGl2ZSkgJiYgZGlyZWN0aW9uPT0nbmV4dCcsXFxuICAgICdyaWdodCc6IGRpcmVjdGlvbj09J3ByZXYnLFxcbiAgICAnbGVmdCc6IGRpcmVjdGlvbj09J25leHQnXFxuICB9XFxcIiBjbGFzcz1cXFwiaXRlbSB0ZXh0LWNlbnRlclxcXCIgbmctdHJhbnNjbHVkZT48L2Rpdj5cXG5cIil9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL2RhdGVwaWNrZXIuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL2RhdGVwaWNrZXIvZGF0ZXBpY2tlci5odG1sXCIsJzxkaXYgbmctc3dpdGNoPVwiZGF0ZXBpY2tlck1vZGVcIiByb2xlPVwiYXBwbGljYXRpb25cIiBuZy1rZXlkb3duPVwia2V5ZG93bigkZXZlbnQpXCI+XFxuICA8ZGF5cGlja2VyIG5nLXN3aXRjaC13aGVuPVwiZGF5XCIgdGFiaW5kZXg9XCIwXCI+PC9kYXlwaWNrZXI+XFxuICA8bW9udGhwaWNrZXIgbmctc3dpdGNoLXdoZW49XCJtb250aFwiIHRhYmluZGV4PVwiMFwiPjwvbW9udGhwaWNrZXI+XFxuICA8eWVhcnBpY2tlciBuZy1zd2l0Y2gtd2hlbj1cInllYXJcIiB0YWJpbmRleD1cIjBcIj48L3llYXJwaWNrZXI+XFxuPC9kaXY+Jyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL2RheS5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvZGF0ZXBpY2tlci9kYXkuaHRtbFwiLCc8dGFibGUgcm9sZT1cImdyaWRcIiBhcmlhLWxhYmVsbGVkYnk9XCJ7e3VuaXF1ZUlkfX0tdGl0bGVcIiBhcmlhLWFjdGl2ZWRlc2NlbmRhbnQ9XCJ7e2FjdGl2ZURhdGVJZH19XCI+XFxuICA8dGhlYWQ+XFxuICAgIDx0cj5cXG4gICAgICA8dGg+PGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtIHB1bGwtbGVmdFwiIG5nLWNsaWNrPVwibW92ZSgtMSlcIiB0YWJpbmRleD1cIi0xXCI+PGkgY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLWNoZXZyb24tbGVmdFwiPjwvaT48L2J1dHRvbj48L3RoPlxcbiAgICAgIDx0aCBjb2xzcGFuPVwie3s1ICsgc2hvd1dlZWtzfX1cIj48YnV0dG9uIGlkPVwie3t1bmlxdWVJZH19LXRpdGxlXCIgcm9sZT1cImhlYWRpbmdcIiBhcmlhLWxpdmU9XCJhc3NlcnRpdmVcIiBhcmlhLWF0b21pYz1cInRydWVcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXCIgbmctY2xpY2s9XCJ0b2dnbGVNb2RlKClcIiB0YWJpbmRleD1cIi0xXCIgc3R5bGU9XCJ3aWR0aDoxMDAlO1wiPjxzdHJvbmc+e3t0aXRsZX19PC9zdHJvbmc+PC9idXR0b24+PC90aD5cXG4gICAgICA8dGg+PGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtIHB1bGwtcmlnaHRcIiBuZy1jbGljaz1cIm1vdmUoMSlcIiB0YWJpbmRleD1cIi0xXCI+PGkgY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLWNoZXZyb24tcmlnaHRcIj48L2k+PC9idXR0b24+PC90aD5cXG4gICAgPC90cj5cXG4gICAgPHRyPlxcbiAgICAgIDx0aCBuZy1zaG93PVwic2hvd1dlZWtzXCIgY2xhc3M9XCJ0ZXh0LWNlbnRlclwiPjwvdGg+XFxuICAgICAgPHRoIG5nLXJlcGVhdD1cImxhYmVsIGluIGxhYmVscyB0cmFjayBieSAkaW5kZXhcIiBjbGFzcz1cInRleHQtY2VudGVyXCI+PHNtYWxsIGFyaWEtbGFiZWw9XCJ7e2xhYmVsLmZ1bGx9fVwiPnt7bGFiZWwuYWJicn19PC9zbWFsbD48L3RoPlxcbiAgICA8L3RyPlxcbiAgPC90aGVhZD5cXG4gIDx0Ym9keT5cXG4gICAgPHRyIG5nLXJlcGVhdD1cInJvdyBpbiByb3dzIHRyYWNrIGJ5ICRpbmRleFwiPlxcbiAgICAgIDx0ZCBuZy1zaG93PVwic2hvd1dlZWtzXCIgY2xhc3M9XCJ0ZXh0LWNlbnRlciBoNlwiPjxlbT57eyB3ZWVrTnVtYmVyc1skaW5kZXhdIH19PC9lbT48L3RkPlxcbiAgICAgIDx0ZCBuZy1yZXBlYXQ9XCJkdCBpbiByb3cgdHJhY2sgYnkgZHQuZGF0ZVwiIGNsYXNzPVwidGV4dC1jZW50ZXJcIiByb2xlPVwiZ3JpZGNlbGxcIiBpZD1cInt7ZHQudWlkfX1cIiBhcmlhLWRpc2FibGVkPVwie3shIWR0LmRpc2FibGVkfX1cIj5cXG4gICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIHN0eWxlPVwid2lkdGg6MTAwJTtcIiBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBidG4tc21cIiBuZy1jbGFzcz1cIntcXCdidG4taW5mb1xcJzogZHQuc2VsZWN0ZWQsIGFjdGl2ZTogaXNBY3RpdmUoZHQpfVwiIG5nLWNsaWNrPVwic2VsZWN0KGR0LmRhdGUpXCIgbmctZGlzYWJsZWQ9XCJkdC5kaXNhYmxlZFwiIHRhYmluZGV4PVwiLTFcIj48c3BhbiBuZy1jbGFzcz1cIntcXCd0ZXh0LW11dGVkXFwnOiBkdC5zZWNvbmRhcnksIFxcJ3RleHQtaW5mb1xcJzogZHQuY3VycmVudH1cIj57e2R0LmxhYmVsfX08L3NwYW4+PC9idXR0b24+XFxuICAgICAgPC90ZD5cXG4gICAgPC90cj5cXG4gIDwvdGJvZHk+XFxuPC90YWJsZT5cXG4nKX1dKSxhbmd1bGFyLm1vZHVsZShcInRlbXBsYXRlL2RhdGVwaWNrZXIvbW9udGguaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL2RhdGVwaWNrZXIvbW9udGguaHRtbFwiLCc8dGFibGUgcm9sZT1cImdyaWRcIiBhcmlhLWxhYmVsbGVkYnk9XCJ7e3VuaXF1ZUlkfX0tdGl0bGVcIiBhcmlhLWFjdGl2ZWRlc2NlbmRhbnQ9XCJ7e2FjdGl2ZURhdGVJZH19XCI+XFxuICA8dGhlYWQ+XFxuICAgIDx0cj5cXG4gICAgICA8dGg+PGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtIHB1bGwtbGVmdFwiIG5nLWNsaWNrPVwibW92ZSgtMSlcIiB0YWJpbmRleD1cIi0xXCI+PGkgY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLWNoZXZyb24tbGVmdFwiPjwvaT48L2J1dHRvbj48L3RoPlxcbiAgICAgIDx0aD48YnV0dG9uIGlkPVwie3t1bmlxdWVJZH19LXRpdGxlXCIgcm9sZT1cImhlYWRpbmdcIiBhcmlhLWxpdmU9XCJhc3NlcnRpdmVcIiBhcmlhLWF0b21pYz1cInRydWVcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXCIgbmctY2xpY2s9XCJ0b2dnbGVNb2RlKClcIiB0YWJpbmRleD1cIi0xXCIgc3R5bGU9XCJ3aWR0aDoxMDAlO1wiPjxzdHJvbmc+e3t0aXRsZX19PC9zdHJvbmc+PC9idXR0b24+PC90aD5cXG4gICAgICA8dGg+PGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtIHB1bGwtcmlnaHRcIiBuZy1jbGljaz1cIm1vdmUoMSlcIiB0YWJpbmRleD1cIi0xXCI+PGkgY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLWNoZXZyb24tcmlnaHRcIj48L2k+PC9idXR0b24+PC90aD5cXG4gICAgPC90cj5cXG4gIDwvdGhlYWQ+XFxuICA8dGJvZHk+XFxuICAgIDx0ciBuZy1yZXBlYXQ9XCJyb3cgaW4gcm93cyB0cmFjayBieSAkaW5kZXhcIj5cXG4gICAgICA8dGQgbmctcmVwZWF0PVwiZHQgaW4gcm93IHRyYWNrIGJ5IGR0LmRhdGVcIiBjbGFzcz1cInRleHQtY2VudGVyXCIgcm9sZT1cImdyaWRjZWxsXCIgaWQ9XCJ7e2R0LnVpZH19XCIgYXJpYS1kaXNhYmxlZD1cInt7ISFkdC5kaXNhYmxlZH19XCI+XFxuICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBzdHlsZT1cIndpZHRoOjEwMCU7XCIgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHRcIiBuZy1jbGFzcz1cIntcXCdidG4taW5mb1xcJzogZHQuc2VsZWN0ZWQsIGFjdGl2ZTogaXNBY3RpdmUoZHQpfVwiIG5nLWNsaWNrPVwic2VsZWN0KGR0LmRhdGUpXCIgbmctZGlzYWJsZWQ9XCJkdC5kaXNhYmxlZFwiIHRhYmluZGV4PVwiLTFcIj48c3BhbiBuZy1jbGFzcz1cIntcXCd0ZXh0LWluZm9cXCc6IGR0LmN1cnJlbnR9XCI+e3tkdC5sYWJlbH19PC9zcGFuPjwvYnV0dG9uPlxcbiAgICAgIDwvdGQ+XFxuICAgIDwvdHI+XFxuICA8L3Rib2R5PlxcbjwvdGFibGU+XFxuJyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL3BvcHVwLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL3BvcHVwLmh0bWxcIiwnPHVsIGNsYXNzPVwiZHJvcGRvd24tbWVudVwiIG5nLXN0eWxlPVwie2Rpc3BsYXk6IChpc09wZW4gJiYgXFwnYmxvY2tcXCcpIHx8IFxcJ25vbmVcXCcsIHRvcDogcG9zaXRpb24udG9wK1xcJ3B4XFwnLCBsZWZ0OiBwb3NpdGlvbi5sZWZ0K1xcJ3B4XFwnfVwiIG5nLWtleWRvd249XCJrZXlkb3duKCRldmVudClcIj5cXG5cdDxsaSBuZy10cmFuc2NsdWRlPjwvbGk+XFxuXHQ8bGkgbmctaWY9XCJzaG93QnV0dG9uQmFyXCIgc3R5bGU9XCJwYWRkaW5nOjEwcHggOXB4IDJweFwiPlxcblx0XHQ8c3BhbiBjbGFzcz1cImJ0bi1ncm91cFwiPlxcblx0XHRcdDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1zbSBidG4taW5mb1wiIG5nLWNsaWNrPVwic2VsZWN0KFxcJ3RvZGF5XFwnKVwiPnt7IGdldFRleHQoXFwnY3VycmVudFxcJykgfX08L2J1dHRvbj5cXG5cdFx0XHQ8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tc20gYnRuLWRhbmdlclwiIG5nLWNsaWNrPVwic2VsZWN0KG51bGwpXCI+e3sgZ2V0VGV4dChcXCdjbGVhclxcJykgfX08L2J1dHRvbj5cXG5cdFx0PC9zcGFuPlxcblx0XHQ8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tc20gYnRuLXN1Y2Nlc3MgcHVsbC1yaWdodFwiIG5nLWNsaWNrPVwiY2xvc2UoKVwiPnt7IGdldFRleHQoXFwnY2xvc2VcXCcpIH19PC9idXR0b24+XFxuXHQ8L2xpPlxcbjwvdWw+XFxuJyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS9kYXRlcGlja2VyL3llYXIuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL2RhdGVwaWNrZXIveWVhci5odG1sXCIsJzx0YWJsZSByb2xlPVwiZ3JpZFwiIGFyaWEtbGFiZWxsZWRieT1cInt7dW5pcXVlSWR9fS10aXRsZVwiIGFyaWEtYWN0aXZlZGVzY2VuZGFudD1cInt7YWN0aXZlRGF0ZUlkfX1cIj5cXG4gIDx0aGVhZD5cXG4gICAgPHRyPlxcbiAgICAgIDx0aD48YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBidG4tc20gcHVsbC1sZWZ0XCIgbmctY2xpY2s9XCJtb3ZlKC0xKVwiIHRhYmluZGV4PVwiLTFcIj48aSBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tY2hldnJvbi1sZWZ0XCI+PC9pPjwvYnV0dG9uPjwvdGg+XFxuICAgICAgPHRoIGNvbHNwYW49XCIzXCI+PGJ1dHRvbiBpZD1cInt7dW5pcXVlSWR9fS10aXRsZVwiIHJvbGU9XCJoZWFkaW5nXCIgYXJpYS1saXZlPVwiYXNzZXJ0aXZlXCIgYXJpYS1hdG9taWM9XCJ0cnVlXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVwiIG5nLWNsaWNrPVwidG9nZ2xlTW9kZSgpXCIgdGFiaW5kZXg9XCItMVwiIHN0eWxlPVwid2lkdGg6MTAwJTtcIj48c3Ryb25nPnt7dGl0bGV9fTwvc3Ryb25nPjwvYnV0dG9uPjwvdGg+XFxuICAgICAgPHRoPjxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbSBwdWxsLXJpZ2h0XCIgbmctY2xpY2s9XCJtb3ZlKDEpXCIgdGFiaW5kZXg9XCItMVwiPjxpIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1jaGV2cm9uLXJpZ2h0XCI+PC9pPjwvYnV0dG9uPjwvdGg+XFxuICAgIDwvdHI+XFxuICA8L3RoZWFkPlxcbiAgPHRib2R5PlxcbiAgICA8dHIgbmctcmVwZWF0PVwicm93IGluIHJvd3MgdHJhY2sgYnkgJGluZGV4XCI+XFxuICAgICAgPHRkIG5nLXJlcGVhdD1cImR0IGluIHJvdyB0cmFjayBieSBkdC5kYXRlXCIgY2xhc3M9XCJ0ZXh0LWNlbnRlclwiIHJvbGU9XCJncmlkY2VsbFwiIGlkPVwie3tkdC51aWR9fVwiIGFyaWEtZGlzYWJsZWQ9XCJ7eyEhZHQuZGlzYWJsZWR9fVwiPlxcbiAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgc3R5bGU9XCJ3aWR0aDoxMDAlO1wiIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0XCIgbmctY2xhc3M9XCJ7XFwnYnRuLWluZm9cXCc6IGR0LnNlbGVjdGVkLCBhY3RpdmU6IGlzQWN0aXZlKGR0KX1cIiBuZy1jbGljaz1cInNlbGVjdChkdC5kYXRlKVwiIG5nLWRpc2FibGVkPVwiZHQuZGlzYWJsZWRcIiB0YWJpbmRleD1cIi0xXCI+PHNwYW4gbmctY2xhc3M9XCJ7XFwndGV4dC1pbmZvXFwnOiBkdC5jdXJyZW50fVwiPnt7ZHQubGFiZWx9fTwvc3Bhbj48L2J1dHRvbj5cXG4gICAgICA8L3RkPlxcbiAgICA8L3RyPlxcbiAgPC90Ym9keT5cXG48L3RhYmxlPlxcbicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvbW9kYWwvYmFja2Ryb3AuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL21vZGFsL2JhY2tkcm9wLmh0bWxcIiwnPGRpdiBjbGFzcz1cIm1vZGFsLWJhY2tkcm9wIGZhZGUge3sgYmFja2Ryb3BDbGFzcyB9fVwiXFxuICAgICBuZy1jbGFzcz1cIntpbjogYW5pbWF0ZX1cIlxcbiAgICAgbmctc3R5bGU9XCJ7XFwnei1pbmRleFxcJzogMTA0MCArIChpbmRleCAmJiAxIHx8IDApICsgaW5kZXgqMTB9XCJcXG4+PC9kaXY+XFxuJyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS9tb2RhbC93aW5kb3cuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL21vZGFsL3dpbmRvdy5odG1sXCIsJzxkaXYgdGFiaW5kZXg9XCItMVwiIHJvbGU9XCJkaWFsb2dcIiBjbGFzcz1cIm1vZGFsIGZhZGVcIiBuZy1jbGFzcz1cIntpbjogYW5pbWF0ZX1cIiBuZy1zdHlsZT1cIntcXCd6LWluZGV4XFwnOiAxMDUwICsgaW5kZXgqMTAsIGRpc3BsYXk6IFxcJ2Jsb2NrXFwnfVwiIG5nLWNsaWNrPVwiY2xvc2UoJGV2ZW50KVwiPlxcbiAgICA8ZGl2IGNsYXNzPVwibW9kYWwtZGlhbG9nXCIgbmctY2xhc3M9XCJ7XFwnbW9kYWwtc21cXCc6IHNpemUgPT0gXFwnc21cXCcsIFxcJ21vZGFsLWxnXFwnOiBzaXplID09IFxcJ2xnXFwnfVwiPjxkaXYgY2xhc3M9XCJtb2RhbC1jb250ZW50XCIgbW9kYWwtdHJhbnNjbHVkZT48L2Rpdj48L2Rpdj5cXG48L2Rpdj4nKX1dKSxhbmd1bGFyLm1vZHVsZShcInRlbXBsYXRlL3BhZ2luYXRpb24vcGFnZXIuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL3BhZ2luYXRpb24vcGFnZXIuaHRtbFwiLCc8dWwgY2xhc3M9XCJwYWdlclwiPlxcbiAgPGxpIG5nLWNsYXNzPVwie2Rpc2FibGVkOiBub1ByZXZpb3VzKCksIHByZXZpb3VzOiBhbGlnbn1cIj48YSBocmVmIG5nLWNsaWNrPVwic2VsZWN0UGFnZShwYWdlIC0gMSlcIj57e2dldFRleHQoXFwncHJldmlvdXNcXCcpfX08L2E+PC9saT5cXG4gIDxsaSBuZy1jbGFzcz1cIntkaXNhYmxlZDogbm9OZXh0KCksIG5leHQ6IGFsaWdufVwiPjxhIGhyZWYgbmctY2xpY2s9XCJzZWxlY3RQYWdlKHBhZ2UgKyAxKVwiPnt7Z2V0VGV4dChcXCduZXh0XFwnKX19PC9hPjwvbGk+XFxuPC91bD4nKX1dKSxhbmd1bGFyLm1vZHVsZShcInRlbXBsYXRlL3BhZ2luYXRpb24vcGFnaW5hdGlvbi5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvcGFnaW5hdGlvbi9wYWdpbmF0aW9uLmh0bWxcIiwnPHVsIGNsYXNzPVwicGFnaW5hdGlvblwiPlxcbiAgPGxpIG5nLWlmPVwiYm91bmRhcnlMaW5rc1wiIG5nLWNsYXNzPVwie2Rpc2FibGVkOiBub1ByZXZpb3VzKCl9XCI+PGEgaHJlZiBuZy1jbGljaz1cInNlbGVjdFBhZ2UoMSlcIj57e2dldFRleHQoXFwnZmlyc3RcXCcpfX08L2E+PC9saT5cXG4gIDxsaSBuZy1pZj1cImRpcmVjdGlvbkxpbmtzXCIgbmctY2xhc3M9XCJ7ZGlzYWJsZWQ6IG5vUHJldmlvdXMoKX1cIj48YSBocmVmIG5nLWNsaWNrPVwic2VsZWN0UGFnZShwYWdlIC0gMSlcIj57e2dldFRleHQoXFwncHJldmlvdXNcXCcpfX08L2E+PC9saT5cXG4gIDxsaSBuZy1yZXBlYXQ9XCJwYWdlIGluIHBhZ2VzIHRyYWNrIGJ5ICRpbmRleFwiIG5nLWNsYXNzPVwie2FjdGl2ZTogcGFnZS5hY3RpdmV9XCI+PGEgaHJlZiBuZy1jbGljaz1cInNlbGVjdFBhZ2UocGFnZS5udW1iZXIpXCI+e3twYWdlLnRleHR9fTwvYT48L2xpPlxcbiAgPGxpIG5nLWlmPVwiZGlyZWN0aW9uTGlua3NcIiBuZy1jbGFzcz1cIntkaXNhYmxlZDogbm9OZXh0KCl9XCI+PGEgaHJlZiBuZy1jbGljaz1cInNlbGVjdFBhZ2UocGFnZSArIDEpXCI+e3tnZXRUZXh0KFxcJ25leHRcXCcpfX08L2E+PC9saT5cXG4gIDxsaSBuZy1pZj1cImJvdW5kYXJ5TGlua3NcIiBuZy1jbGFzcz1cIntkaXNhYmxlZDogbm9OZXh0KCl9XCI+PGEgaHJlZiBuZy1jbGljaz1cInNlbGVjdFBhZ2UodG90YWxQYWdlcylcIj57e2dldFRleHQoXFwnbGFzdFxcJyl9fTwvYT48L2xpPlxcbjwvdWw+Jyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS90b29sdGlwL3Rvb2x0aXAtaHRtbC11bnNhZmUtcG9wdXAuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL3Rvb2x0aXAvdG9vbHRpcC1odG1sLXVuc2FmZS1wb3B1cC5odG1sXCIsJzxkaXYgY2xhc3M9XCJ0b29sdGlwIHt7cGxhY2VtZW50fX1cIiBuZy1jbGFzcz1cInsgaW46IGlzT3BlbigpLCBmYWRlOiBhbmltYXRpb24oKSB9XCI+XFxuICA8ZGl2IGNsYXNzPVwidG9vbHRpcC1hcnJvd1wiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cInRvb2x0aXAtaW5uZXJcIiBiaW5kLWh0bWwtdW5zYWZlPVwiY29udGVudFwiPjwvZGl2PlxcbjwvZGl2PlxcbicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvdG9vbHRpcC90b29sdGlwLXBvcHVwLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS90b29sdGlwL3Rvb2x0aXAtcG9wdXAuaHRtbFwiLCc8ZGl2IGNsYXNzPVwidG9vbHRpcCB7e3BsYWNlbWVudH19XCIgbmctY2xhc3M9XCJ7IGluOiBpc09wZW4oKSwgZmFkZTogYW5pbWF0aW9uKCkgfVwiPlxcbiAgPGRpdiBjbGFzcz1cInRvb2x0aXAtYXJyb3dcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XCJ0b29sdGlwLWlubmVyXCIgbmctYmluZD1cImNvbnRlbnRcIj48L2Rpdj5cXG48L2Rpdj5cXG4nKX1dKSxhbmd1bGFyLm1vZHVsZShcInRlbXBsYXRlL3BvcG92ZXIvcG9wb3Zlci5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvcG9wb3Zlci9wb3BvdmVyLmh0bWxcIiwnPGRpdiBjbGFzcz1cInBvcG92ZXIge3twbGFjZW1lbnR9fVwiIG5nLWNsYXNzPVwieyBpbjogaXNPcGVuKCksIGZhZGU6IGFuaW1hdGlvbigpIH1cIj5cXG4gIDxkaXYgY2xhc3M9XCJhcnJvd1wiPjwvZGl2PlxcblxcbiAgPGRpdiBjbGFzcz1cInBvcG92ZXItaW5uZXJcIj5cXG4gICAgICA8aDMgY2xhc3M9XCJwb3BvdmVyLXRpdGxlXCIgbmctYmluZD1cInRpdGxlXCIgbmctc2hvdz1cInRpdGxlXCI+PC9oMz5cXG4gICAgICA8ZGl2IGNsYXNzPVwicG9wb3Zlci1jb250ZW50XCIgbmctYmluZD1cImNvbnRlbnRcIj48L2Rpdj5cXG4gIDwvZGl2PlxcbjwvZGl2PlxcbicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvcHJvZ3Jlc3NiYXIvYmFyLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS9wcm9ncmVzc2Jhci9iYXIuaHRtbFwiLCc8ZGl2IGNsYXNzPVwicHJvZ3Jlc3MtYmFyXCIgbmctY2xhc3M9XCJ0eXBlICYmIFxcJ3Byb2dyZXNzLWJhci1cXCcgKyB0eXBlXCIgcm9sZT1cInByb2dyZXNzYmFyXCIgYXJpYS12YWx1ZW5vdz1cInt7dmFsdWV9fVwiIGFyaWEtdmFsdWVtaW49XCIwXCIgYXJpYS12YWx1ZW1heD1cInt7bWF4fX1cIiBuZy1zdHlsZT1cInt3aWR0aDogcGVyY2VudCArIFxcJyVcXCd9XCIgYXJpYS12YWx1ZXRleHQ9XCJ7e3BlcmNlbnQgfCBudW1iZXI6MH19JVwiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+Jyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS9wcm9ncmVzc2Jhci9wcm9ncmVzcy5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvcHJvZ3Jlc3NiYXIvcHJvZ3Jlc3MuaHRtbFwiLCc8ZGl2IGNsYXNzPVwicHJvZ3Jlc3NcIiBuZy10cmFuc2NsdWRlPjwvZGl2PicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvcHJvZ3Jlc3NiYXIvcHJvZ3Jlc3NiYXIuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL3Byb2dyZXNzYmFyL3Byb2dyZXNzYmFyLmh0bWxcIiwnPGRpdiBjbGFzcz1cInByb2dyZXNzXCI+XFxuICA8ZGl2IGNsYXNzPVwicHJvZ3Jlc3MtYmFyXCIgbmctY2xhc3M9XCJ0eXBlICYmIFxcJ3Byb2dyZXNzLWJhci1cXCcgKyB0eXBlXCIgcm9sZT1cInByb2dyZXNzYmFyXCIgYXJpYS12YWx1ZW5vdz1cInt7dmFsdWV9fVwiIGFyaWEtdmFsdWVtaW49XCIwXCIgYXJpYS12YWx1ZW1heD1cInt7bWF4fX1cIiBuZy1zdHlsZT1cInt3aWR0aDogcGVyY2VudCArIFxcJyVcXCd9XCIgYXJpYS12YWx1ZXRleHQ9XCJ7e3BlcmNlbnQgfCBudW1iZXI6MH19JVwiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+XFxuPC9kaXY+Jyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS9yYXRpbmcvcmF0aW5nLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS9yYXRpbmcvcmF0aW5nLmh0bWxcIiwnPHNwYW4gbmctbW91c2VsZWF2ZT1cInJlc2V0KClcIiBuZy1rZXlkb3duPVwib25LZXlkb3duKCRldmVudClcIiB0YWJpbmRleD1cIjBcIiByb2xlPVwic2xpZGVyXCIgYXJpYS12YWx1ZW1pbj1cIjBcIiBhcmlhLXZhbHVlbWF4PVwie3tyYW5nZS5sZW5ndGh9fVwiIGFyaWEtdmFsdWVub3c9XCJ7e3ZhbHVlfX1cIj5cXG4gICAgPGkgbmctcmVwZWF0PVwiciBpbiByYW5nZSB0cmFjayBieSAkaW5kZXhcIiBuZy1tb3VzZWVudGVyPVwiZW50ZXIoJGluZGV4ICsgMSlcIiBuZy1jbGljaz1cInJhdGUoJGluZGV4ICsgMSlcIiBjbGFzcz1cImdseXBoaWNvblwiIG5nLWNsYXNzPVwiJGluZGV4IDwgdmFsdWUgJiYgKHIuc3RhdGVPbiB8fCBcXCdnbHlwaGljb24tc3RhclxcJykgfHwgKHIuc3RhdGVPZmYgfHwgXFwnZ2x5cGhpY29uLXN0YXItZW1wdHlcXCcpXCI+XFxuICAgICAgICA8c3BhbiBjbGFzcz1cInNyLW9ubHlcIj4oe3sgJGluZGV4IDwgdmFsdWUgPyBcXCcqXFwnIDogXFwnIFxcJyB9fSk8L3NwYW4+XFxuICAgIDwvaT5cXG48L3NwYW4+Jyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS90YWJzL3RhYi5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvdGFicy90YWIuaHRtbFwiLCc8bGkgbmctY2xhc3M9XCJ7YWN0aXZlOiBhY3RpdmUsIGRpc2FibGVkOiBkaXNhYmxlZH1cIj5cXG4gIDxhIG5nLWNsaWNrPVwic2VsZWN0KClcIiB0YWItaGVhZGluZy10cmFuc2NsdWRlPnt7aGVhZGluZ319PC9hPlxcbjwvbGk+XFxuJyl9XSksYW5ndWxhci5tb2R1bGUoXCJ0ZW1wbGF0ZS90YWJzL3RhYnNldC5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvdGFicy90YWJzZXQuaHRtbFwiLCc8ZGl2PlxcbiAgPHVsIGNsYXNzPVwibmF2IG5hdi17e3R5cGUgfHwgXFwndGFic1xcJ319XCIgbmctY2xhc3M9XCJ7XFwnbmF2LXN0YWNrZWRcXCc6IHZlcnRpY2FsLCBcXCduYXYtanVzdGlmaWVkXFwnOiBqdXN0aWZpZWR9XCIgbmctdHJhbnNjbHVkZT48L3VsPlxcbiAgPGRpdiBjbGFzcz1cInRhYi1jb250ZW50XCI+XFxuICAgIDxkaXYgY2xhc3M9XCJ0YWItcGFuZVwiIFxcbiAgICAgICAgIG5nLXJlcGVhdD1cInRhYiBpbiB0YWJzXCIgXFxuICAgICAgICAgbmctY2xhc3M9XCJ7YWN0aXZlOiB0YWIuYWN0aXZlfVwiXFxuICAgICAgICAgdGFiLWNvbnRlbnQtdHJhbnNjbHVkZT1cInRhYlwiPlxcbiAgICA8L2Rpdj5cXG4gIDwvZGl2PlxcbjwvZGl2PlxcbicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvdGltZXBpY2tlci90aW1lcGlja2VyLmh0bWxcIixbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7YS5wdXQoXCJ0ZW1wbGF0ZS90aW1lcGlja2VyL3RpbWVwaWNrZXIuaHRtbFwiLCc8dGFibGU+XFxuXHQ8dGJvZHk+XFxuXHRcdDx0ciBjbGFzcz1cInRleHQtY2VudGVyXCI+XFxuXHRcdFx0PHRkPjxhIG5nLWNsaWNrPVwiaW5jcmVtZW50SG91cnMoKVwiIGNsYXNzPVwiYnRuIGJ0bi1saW5rXCI+PHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLWNoZXZyb24tdXBcIj48L3NwYW4+PC9hPjwvdGQ+XFxuXHRcdFx0PHRkPiZuYnNwOzwvdGQ+XFxuXHRcdFx0PHRkPjxhIG5nLWNsaWNrPVwiaW5jcmVtZW50TWludXRlcygpXCIgY2xhc3M9XCJidG4gYnRuLWxpbmtcIj48c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tY2hldnJvbi11cFwiPjwvc3Bhbj48L2E+PC90ZD5cXG5cdFx0XHQ8dGQgbmctc2hvdz1cInNob3dNZXJpZGlhblwiPjwvdGQ+XFxuXHRcdDwvdHI+XFxuXHRcdDx0cj5cXG5cdFx0XHQ8dGQgc3R5bGU9XCJ3aWR0aDo1MHB4O1wiIGNsYXNzPVwiZm9ybS1ncm91cFwiIG5nLWNsYXNzPVwie1xcJ2hhcy1lcnJvclxcJzogaW52YWxpZEhvdXJzfVwiPlxcblx0XHRcdFx0PGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJob3Vyc1wiIG5nLWNoYW5nZT1cInVwZGF0ZUhvdXJzKClcIiBjbGFzcz1cImZvcm0tY29udHJvbCB0ZXh0LWNlbnRlclwiIG5nLW1vdXNld2hlZWw9XCJpbmNyZW1lbnRIb3VycygpXCIgbmctcmVhZG9ubHk9XCJyZWFkb25seUlucHV0XCIgbWF4bGVuZ3RoPVwiMlwiPlxcblx0XHRcdDwvdGQ+XFxuXHRcdFx0PHRkPjo8L3RkPlxcblx0XHRcdDx0ZCBzdHlsZT1cIndpZHRoOjUwcHg7XCIgY2xhc3M9XCJmb3JtLWdyb3VwXCIgbmctY2xhc3M9XCJ7XFwnaGFzLWVycm9yXFwnOiBpbnZhbGlkTWludXRlc31cIj5cXG5cdFx0XHRcdDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwibWludXRlc1wiIG5nLWNoYW5nZT1cInVwZGF0ZU1pbnV0ZXMoKVwiIGNsYXNzPVwiZm9ybS1jb250cm9sIHRleHQtY2VudGVyXCIgbmctcmVhZG9ubHk9XCJyZWFkb25seUlucHV0XCIgbWF4bGVuZ3RoPVwiMlwiPlxcblx0XHRcdDwvdGQ+XFxuXHRcdFx0PHRkIG5nLXNob3c9XCJzaG93TWVyaWRpYW5cIj48YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCB0ZXh0LWNlbnRlclwiIG5nLWNsaWNrPVwidG9nZ2xlTWVyaWRpYW4oKVwiPnt7bWVyaWRpYW59fTwvYnV0dG9uPjwvdGQ+XFxuXHRcdDwvdHI+XFxuXHRcdDx0ciBjbGFzcz1cInRleHQtY2VudGVyXCI+XFxuXHRcdFx0PHRkPjxhIG5nLWNsaWNrPVwiZGVjcmVtZW50SG91cnMoKVwiIGNsYXNzPVwiYnRuIGJ0bi1saW5rXCI+PHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLWNoZXZyb24tZG93blwiPjwvc3Bhbj48L2E+PC90ZD5cXG5cdFx0XHQ8dGQ+Jm5ic3A7PC90ZD5cXG5cdFx0XHQ8dGQ+PGEgbmctY2xpY2s9XCJkZWNyZW1lbnRNaW51dGVzKClcIiBjbGFzcz1cImJ0biBidG4tbGlua1wiPjxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1jaGV2cm9uLWRvd25cIj48L3NwYW4+PC9hPjwvdGQ+XFxuXHRcdFx0PHRkIG5nLXNob3c9XCJzaG93TWVyaWRpYW5cIj48L3RkPlxcblx0XHQ8L3RyPlxcblx0PC90Ym9keT5cXG48L3RhYmxlPlxcbicpfV0pLGFuZ3VsYXIubW9kdWxlKFwidGVtcGxhdGUvdHlwZWFoZWFkL3R5cGVhaGVhZC1tYXRjaC5odG1sXCIsW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGEpe2EucHV0KFwidGVtcGxhdGUvdHlwZWFoZWFkL3R5cGVhaGVhZC1tYXRjaC5odG1sXCIsJzxhIHRhYmluZGV4PVwiLTFcIiBiaW5kLWh0bWwtdW5zYWZlPVwibWF0Y2gubGFiZWwgfCB0eXBlYWhlYWRIaWdobGlnaHQ6cXVlcnlcIj48L2E+Jylcbn1dKSxhbmd1bGFyLm1vZHVsZShcInRlbXBsYXRlL3R5cGVhaGVhZC90eXBlYWhlYWQtcG9wdXAuaHRtbFwiLFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXthLnB1dChcInRlbXBsYXRlL3R5cGVhaGVhZC90eXBlYWhlYWQtcG9wdXAuaHRtbFwiLCc8dWwgY2xhc3M9XCJkcm9wZG93bi1tZW51XCIgbmctc2hvdz1cImlzT3BlbigpXCIgbmctc3R5bGU9XCJ7dG9wOiBwb3NpdGlvbi50b3ArXFwncHhcXCcsIGxlZnQ6IHBvc2l0aW9uLmxlZnQrXFwncHhcXCd9XCIgc3R5bGU9XCJkaXNwbGF5OiBibG9jaztcIiByb2xlPVwibGlzdGJveFwiIGFyaWEtaGlkZGVuPVwie3shaXNPcGVuKCl9fVwiPlxcbiAgICA8bGkgbmctcmVwZWF0PVwibWF0Y2ggaW4gbWF0Y2hlcyB0cmFjayBieSAkaW5kZXhcIiBuZy1jbGFzcz1cInthY3RpdmU6IGlzQWN0aXZlKCRpbmRleCkgfVwiIG5nLW1vdXNlZW50ZXI9XCJzZWxlY3RBY3RpdmUoJGluZGV4KVwiIG5nLWNsaWNrPVwic2VsZWN0TWF0Y2goJGluZGV4KVwiIHJvbGU9XCJvcHRpb25cIiBpZD1cInt7bWF0Y2guaWR9fVwiPlxcbiAgICAgICAgPGRpdiB0eXBlYWhlYWQtbWF0Y2ggaW5kZXg9XCIkaW5kZXhcIiBtYXRjaD1cIm1hdGNoXCIgcXVlcnk9XCJxdWVyeVwiIHRlbXBsYXRlLXVybD1cInRlbXBsYXRlVXJsXCI+PC9kaXY+XFxuICAgIDwvbGk+XFxuPC91bD5cXG4nKX1dKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBrYXNwZXJlbiBvbiAxOC4wOS4xNC5cclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCd1aS5oYW5kc29udGFibGUnLCBbXSlcclxuICAgIC5zZXJ2aWNlKCdoYW5kc29udGFibGVTcnZjJywgZnVuY3Rpb24oKSB7XHJcbiAgICB9KVxyXG4gICAgLmNvbnRyb2xsZXIoXCJIYW5kc29uQ29udHJvbGxlclwiLCBmdW5jdGlvbiAoJHNjb3BlKSB7XHJcblx0XHQvKlxyXG5cdFx0JHNjb3BlLmRhdGEgPSBpbnN0YW5jZS5MQ1BRdWVzdGlvbm5haXJlLmxpc3RPZlBsYW50cztcclxuXHRcdCRzY29wZS5kYXRhID0gW1xyXG5cdFx0XHR7XHJcblx0XHRcdFx0XCJkZWxldGVcIjogZmFsc2UsXHJcblx0XHRcdFx0XCJwbGFudE5hbWVcIjogXCIxXCIsXHJcblx0XHRcdFx0XCJwbGFudElkXCI6IFwiXCIsXHJcblx0XHRcdFx0XCJlcHJ0ck5hdGlvbmFsSWRcIjogXCJcIixcclxuXHRcdFx0XHRcImFkZHJlc3MxXCI6IFwiXCIsXHJcblx0XHRcdFx0XCJhZGRyZXNzMlwiOiBcIlwiLFxyXG5cdFx0XHRcdFwiY2l0eVwiOiBcIlwiLFxyXG5cdFx0XHRcdFwicmVnaW9uXCI6IFwiXCIsXHJcblx0XHRcdFx0XCJwb3N0YWxDb2RlXCI6IFwiXCIsXHJcblx0XHRcdFx0XCJsb25naXR1ZGVcIjogXCJcIixcclxuXHRcdFx0XHRcImxhdGl0dWRlXCI6IFwiXCJcclxuXHRcdFx0fSxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdFwiZGVsZXRlXCI6IGZhbHNlLFxyXG5cdFx0XHRcdFwicGxhbnROYW1lXCI6IFwiMlwiLFxyXG5cdFx0XHRcdFwicGxhbnRJZFwiOiBudWxsLFxyXG5cdFx0XHRcdFwiZXBydHJOYXRpb25hbElkXCI6IG51bGwsXHJcblx0XHRcdFx0XCJhZGRyZXNzMVwiOiBudWxsLFxyXG5cdFx0XHRcdFwiYWRkcmVzczJcIjogbnVsbCxcclxuXHRcdFx0XHRcImNpdHlcIjogbnVsbCxcclxuXHRcdFx0XHRcInJlZ2lvblwiOiBudWxsLFxyXG5cdFx0XHRcdFwicG9zdGFsQ29kZVwiOiBudWxsLFxyXG5cdFx0XHRcdFwibG9uZ2l0dWRlXCI6IG51bGwsXHJcblx0XHRcdFx0XCJsYXRpdHVkZVwiOiBudWxsXHJcblx0XHRcdH1cclxuXHRcdF07XHJcblx0XHQqL1xyXG5cdH0pXHJcblx0LmRpcmVjdGl2ZSgndWlIYW5kc29udGFibGUnLCBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRyZXN0cmljdDogJ0EnLFxyXG5cdFx0XHRzY29wZToge1xyXG5cdFx0XHRcdGRhdGE6ICc9J1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRyZXBsYWNlOiB0cnVlLFxyXG5cdFx0XHRsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHJzKSB7XHJcblx0XHRcdFx0ZWxlbS5oYW5kc29udGFibGUoe1xyXG5cdFx0XHRcdGRhdGE6IHNjb3BlLmRhdGEsXHJcbiAgICAgICAgICAgICAgICBjb250ZXh0TWVudTogdHJ1ZSxcclxuXHRcdFx0XHRyb3dIZWFkZXJzOiB0cnVlLFxyXG5cdFx0XHRcdG1pblNwYXJlUm93czogMSxcclxuICAgICAgICAgICAgICAgIGNvbEhlYWRlcnM6IFtcIkRlbGV0ZVwiLCBcIlBsYW50IE5hbWVcIiwgXCJQbGFudCBJZFwiLCBcIkUtUFJUUiBuYXRpb25hbCBJRFwiLCBcIkFkZHJlc3MgMVwiLCBcIkFkZHJlc3MgMlwiLCBcIkNpdHlcIiwgXCJSZWdpb25cIiwgXCJQb3N0YWwgY29kZVwiLCBcIkxvbmdpdHVkZVwiLCBcIkxhdGl0dWRlXCJdLFxyXG4gICAgICAgICAgICAgICAgY29sdW1uczogW1xyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogXCJkZWxldGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJjaGVja2JveFwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IFwicGxhbnROYW1lXCJcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogXCJwbGFudElkXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdudW1lcmljJ1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBcImVwcnRyTmF0aW9uYWxJZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbnVtZXJpYydcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogXCJhZGRyZXNzMVwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IFwiYWRkcmVzczJcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBcImNpdHlcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBcInJlZ2lvblwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IFwicG9zdGFsQ29kZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbnVtZXJpYydcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogXCJsb25naXR1ZGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ251bWVyaWMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6ICcwMDAuMDAwJ1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBcImxhdGl0dWRlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdudW1lcmljJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiAnMDAwLjAwMCdcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cdH0pIiwiLy8gTW9kdWxlIHRoYXQgcHJvdmlkZXMgbXVsdGlzZWxlY3QgYm94IHRvIHdlYmZvcm0gZnJvbSBqc29uLWxkIGZvcm1hdC5cclxuLy9cclxuLy8gVXNhZ2UgRXhhbXBsZTpcclxuLy8gPGRpdiBtdWx0aXNlbGVjdCBjbGFzcz1cIm11bHRpc2VsZWN0XCIgbmFtZT1cIlR5cGVPZlVzZVwiIG11bHRpcGxlPVwidHJ1ZVwiXHJcbi8vICAgICAgbmctbW9kZWw9XCJyb3cuVHlwZU9mVXNlXCJcclxuLy8gICAgICBvcHRpb25zPVwiYW5uZXgxQ29uY2VwdFsnQGlkJ10gYXMgYW5uZXgxQ29uY2VwdC5wcmVmTGFiZWxbMF1bJ0B2YWx1ZSddIGZvciBhbm5leDFDb25jZXB0IGluIGNvZGVMaXN0LkxDUENvZGVsaXN0cy5Bbm5leDFBY3Rpdml0aWVzLmNvbmNlcHRzXCJcclxuLy8gICAgICBjaGFuZ2U9XCJzZWxlY3RlZCgpXCIgcmVxdWlyZWQ+PC9kaXY+XHJcbi8vXHJcbi8vIE5vdGUhIG9wdGlvbnMgaW5zdGVhZCBvZiBuZy1vcHRpb25zIGlzIHVzZWQuXHJcbmFuZ3VsYXIubW9kdWxlKCd1aS5tdWx0aXNlbGVjdCcsIFtcclxuICAgICAgICAnbXVsdGlzZWxlY3QudHBsLmh0bWwnXHJcbiAgICBdKVxyXG5cclxuICAgIC8vZnJvbSBib290c3RyYXAtdWkgdHlwZWFoZWFkIHBhcnNlclxyXG4gICAgLmZhY3RvcnkoJ29wdGlvblBhcnNlcicsIFsnJHBhcnNlJywgZnVuY3Rpb24gKCRwYXJzZSkge1xyXG5cclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAwMDAwMDExMTAwMDAwMDAwMDAwMDAyMjIwMDAwMDAwMDAwMDAwMDAwMzMzMzMzMzMzMzMzMzMzMDAwMDAwMDAwMDA0NDAwMFxyXG4gICAgICAgIHZhciBUWVBFQUhFQURfUkVHRVhQID0gL15cXHMqKC4qPykoPzpcXHMrYXNcXHMrKC4qPykpP1xccytmb3JcXHMrKD86KFtcXCRcXHddW1xcJFxcd1xcZF0qKSlcXHMraW5cXHMrKC4qKSQvO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBwYXJzZTogZnVuY3Rpb24gKGlucHV0KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG1hdGNoID0gaW5wdXQubWF0Y2goVFlQRUFIRUFEX1JFR0VYUCksIG1vZGVsTWFwcGVyLCB2aWV3TWFwcGVyLCBzb3VyY2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkV4cGVjdGVkIHR5cGVhaGVhZCBzcGVjaWZpY2F0aW9uIGluIGZvcm0gb2YgJ19tb2RlbFZhbHVlXyAoYXMgX2xhYmVsXyk/IGZvciBfaXRlbV8gaW4gX2NvbGxlY3Rpb25fJ1wiICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIGJ1dCBnb3QgJ1wiICsgaW5wdXQgKyBcIicuXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbU5hbWU6IG1hdGNoWzNdLFxyXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJHBhcnNlKG1hdGNoWzRdKSxcclxuICAgICAgICAgICAgICAgICAgICB2aWV3TWFwcGVyOiAkcGFyc2UobWF0Y2hbMl0gfHwgbWF0Y2hbMV0pLFxyXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsTWFwcGVyOiAkcGFyc2UobWF0Y2hbMV0pXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1dKVxyXG5cclxuICAgIC5kaXJlY3RpdmUoJ211bHRpc2VsZWN0JywgWyckcGFyc2UnLCAnJGRvY3VtZW50JywgJyRjb21waWxlJywgJyRpbnRlcnBvbGF0ZScsICdvcHRpb25QYXJzZXInLFxyXG5cclxuICAgICAgICBmdW5jdGlvbiAoJHBhcnNlLCAkZG9jdW1lbnQsICRjb21waWxlLCAkaW50ZXJwb2xhdGUsIG9wdGlvblBhcnNlcikge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6ICdBRScsXHJcbiAgICAgICAgICAgICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXHJcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAob3JpZ2luYWxTY29wZSwgZWxlbWVudCwgYXR0cnMsIG1vZGVsQ3RybCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZXhwID0gYXR0cnMub3B0aW9ucyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VkUmVzdWx0ID0gb3B0aW9uUGFyc2VyLnBhcnNlKGV4cCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzTXVsdGlwbGUgPSAoYXR0cnMubXVsdGlwbGUgPT09IFwidHJ1ZVwiKSA/IHRydWUgOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0NoZWNrQWxsID0gKGF0dHJzLnNob3djaGVja2FsbCA9PT0gXCJ0cnVlXCIpID8gdHJ1ZSA6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93RmlsdGVyID0gKGF0dHJzLnNob3dmaWx0ZXIgPT09IFwidHJ1ZVwiKSA/IHRydWUgOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQgPSBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUgPSBvcmlnaW5hbFNjb3BlLiRuZXcoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlSGFuZGxlciA9IGF0dHJzLmNoYW5nZSB8fCBhbmd1bGFyLm5vb3A7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmdyb3VwcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmhlYWRlciA9ICdTZWxlY3QnO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLm11bHRpcGxlID0gaXNNdWx0aXBsZTtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnNob3dDaGVja0FsbCA9IHNob3dDaGVja0FsbDtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5zaG93RmlsdGVyID0gc2hvd0ZpbHRlcjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxTY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kZGVzdHJveSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgcG9wVXBFbCA9IGFuZ3VsYXIuZWxlbWVudCgnPG11bHRpc2VsZWN0LXBvcHVwPjwvbXVsdGlzZWxlY3QtcG9wdXA+Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vcmVxdWlyZWQgdmFsaWRhdG9yXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJzLnJlcXVpcmVkIHx8IGF0dHJzLm5nUmVxdWlyZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBhdHRycy4kb2JzZXJ2ZSgncmVxdWlyZWQnLCBmdW5jdGlvbihuZXdWYWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQgPSBuZXdWYWw7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vd2F0Y2ggZGlzYWJsZWQgc3RhdGVcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHBhcnNlKGF0dHJzLmRpc2FibGVkKShvcmlnaW5hbFNjb3BlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAobmV3VmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmRpc2FibGVkID0gbmV3VmFsO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL3dhdGNoIHNpbmdsZS9tdWx0aXBsZSBzdGF0ZSBmb3IgZHluYW1pY2FsbHkgY2hhbmdlIHNpbmdsZSB0byBtdWx0aXBsZVxyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcGFyc2UoYXR0cnMubXVsdGlwbGUpKG9yaWdpbmFsU2NvcGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChuZXdWYWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNNdWx0aXBsZSA9IG5ld1ZhbCB8fCBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy93YXRjaCBvcHRpb24gY2hhbmdlcyBmb3Igb3B0aW9ucyB0aGF0IGFyZSBwb3B1bGF0ZWQgZHluYW1pY2FsbHlcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VkUmVzdWx0LnNvdXJjZShvcmlnaW5hbFNjb3BlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAobmV3VmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChuZXdWYWwpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VNb2RlbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIHRydWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL3dhdGNoIG1vZGVsIGNoYW5nZVxyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2RlbEN0cmwuJG1vZGVsVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKG5ld1ZhbCwgb2xkVmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vd2hlbiBkaXJlY3RpdmUgaW5pdGlhbGl6ZSwgbmV3VmFsIHVzdWFsbHkgdW5kZWZpbmVkLiBBbHNvLCBpZiBtb2RlbCB2YWx1ZSBhbHJlYWR5IHNldCBpbiB0aGUgY29udHJvbGxlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2ZvciBwcmVzZWxlY3RlZCBsaXN0IHRoZW4gd2UgbmVlZCB0byBtYXJrIGNoZWNrZWQgaW4gb3VyIHNjb3BlIGl0ZW0uIEJ1dCB3ZSBkb24ndCB3YW50IHRvIGRvIHRoaXMgZXZlcnkgdGltZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL21vZGVsIGNoYW5nZXMuIFdlIG5lZWQgdG8gZG8gdGhpcyBvbmx5IGlmIGl0IGlzIGRvbmUgb3V0c2lkZSBkaXJlY3RpdmUgc2NvcGUsIGZyb20gY29udHJvbGxlciwgZm9yIGV4YW1wbGUuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChuZXdWYWwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrQ2hlY2tlZChuZXdWYWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBzY29wZS4kZXZhbChjaGFuZ2VIYW5kbGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRIZWFkZXJUZXh0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsQ3RybC4kc2V0VmFsaWRpdHkoJ3JlcXVpcmVkJywgc2NvcGUudmFsaWQoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgdHJ1ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHBhcnNlTW9kZWwoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmdyb3Vwcy5sZW5ndGggPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSBwYXJzZWRSZXN1bHQuc291cmNlKG9yaWdpbmFsU2NvcGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXBJbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cElkSW5kZXhNYXAgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRHcm91cCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0R3JvdXAuaXRlbXMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWFuZ3VsYXIuaXNEZWZpbmVkKG1vZGVsKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtb2RlbC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKG1vZGVsW2ldLm5hcnJvd2VyKSAmJiBtb2RlbFtpXS5uYXJyb3dlci5sZW5ndGggPiAwKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL25vdyB3ZSBoYXZlIGdyb3Vwc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmdyb3Vwc1tncm91cEluZGV4XSA9IHsgXCJuYW1lXCIgOiBtb2RlbFtpXS5wcmVmTGFiZWxbMF1bJ0B2YWx1ZSddLCBcIml0ZW1zXCIgOiBbXX07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBJZEluZGV4TWFwW21vZGVsW2ldWydAaWQnXV0gPSBncm91cEluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwSW5kZXgrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBkZWZhdWx0R3JvdXA7IC8vaWYgdGhlcmUgaXMgbm8gZ3JvdXAgb3IgZ3JvdXAgY2Fubm90IGJlIGZvdW5kLCB0aGVuIGFkZCBpdCB0byBkZWZhdWx0IGdyb3VwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQobW9kZWxbaV0uYnJvYWRlcikgJiYgbW9kZWxbaV0uYnJvYWRlci5sZW5ndGggPT0gMSAmJiBhbmd1bGFyLmlzRGVmaW5lZChncm91cElkSW5kZXhNYXBbbW9kZWxbaV0uYnJvYWRlclswXVsnQGlkJ11dKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vbm93IHdlIGhhdmUgYSBzdWIgZWxlbWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwID0gc2NvcGUuZ3JvdXBzW2dyb3VwSWRJbmRleE1hcFttb2RlbFtpXS5icm9hZGVyWzBdWydAaWQnXV1dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhbCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxbcGFyc2VkUmVzdWx0Lml0ZW1OYW1lXSA9IG1vZGVsW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RlbEN0cmwuJG1vZGVsVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1RPRE8gd2hhdCBpcyB0aGlzIG1vZGVsQ3RybCBhbmQgbW9kZWxWYWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCEobW9kZWxDdHJsLiRtb2RlbFZhbHVlIGluc3RhbmNlb2YgQXJyYXkpICYmIG1vZGVsW2ldWydAaWQnXSA9PT0gbW9kZWxDdHJsLiRtb2RlbFZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZigobW9kZWxDdHJsLiRtb2RlbFZhbHVlIGluc3RhbmNlb2YgQXJyYXkpICYmIGNvbnRhaW5zKG1vZGVsQ3RybC4kbW9kZWxWYWx1ZSwgbW9kZWxbaV1bJ0BpZCddKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuaXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHBhcnNlZFJlc3VsdC52aWV3TWFwcGVyKGxvY2FsKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDogbW9kZWxbaV1bJ0BpZCddLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ6IGNoZWNrZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBub3cgYWRkIGRlZmF1bHQgZ3JvdXBcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZ3JvdXBzW2dyb3VwSW5kZXhdID0gZGVmYXVsdEdyb3VwO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gLy9lbmQgb2YgZnVuY3Rpb24gcGFyc2VNb2RlbFxyXG5cclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjb250YWlucyhhcnJheSwgbmVlZGxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFycmF5W2ldID09IG5lZWRsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlTW9kZWwoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmQoJGNvbXBpbGUocG9wVXBFbCkoc2NvcGUpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0SGVhZGVyVGV4dCgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRIZWFkZXIgPSAnU2VsZWN0JztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbW9kZWxDdHJsLiRtb2RlbFZhbHVlKSByZXR1cm4gc2NvcGUuaGVhZGVyID0gYXR0cnMubXNIZWFkZXIgfHwgZGVmYXVsdEhlYWRlcjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RlbEN0cmwuJG1vZGVsVmFsdWUgJiYgbW9kZWxDdHJsLiRtb2RlbFZhbHVlIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRycy5tc1NlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuaGVhZGVyID0gJGludGVycG9sYXRlKGF0dHJzLm1zU2VsZWN0ZWQpKHNjb3BlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuaGVhZGVyID0gbW9kZWxDdHJsLiRtb2RlbFZhbHVlWzBdICE9ICcnPyBtb2RlbEN0cmwuJG1vZGVsVmFsdWUubGVuZ3RoICsgJyAnICsgJ3NlbGVjdGVkJyA6IGRlZmF1bHRIZWFkZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYobW9kZWxDdHJsLiRtb2RlbFZhbHVlICYmIHR5cGVvZiAwKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmhlYWRlciA9ICcxIHNlbGVjdGVkJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhbCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxbcGFyc2VkUmVzdWx0Lml0ZW1OYW1lXSA9IG1vZGVsQ3RybC4kbW9kZWxWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmhlYWRlciA9IHBhcnNlZFJlc3VsdC52aWV3TWFwcGVyKGxvY2FsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gaXNfZW1wdHkob2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghb2JqKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5sZW5ndGggJiYgb2JqLmxlbmd0aCA+IDApIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBvYmopIGlmIChvYmpbcHJvcF0pIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUudmFsaWQgPSBmdW5jdGlvbiB2YWxpZE1vZGVsKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZighcmVxdWlyZWQpIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBtb2RlbEN0cmwuJG1vZGVsVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoYW5ndWxhci5pc0FycmF5KHZhbHVlKSAmJiB2YWx1ZS5sZW5ndGggPiAwKSB8fCAoIWFuZ3VsYXIuaXNBcnJheSh2YWx1ZSkgJiYgdmFsdWUgIT0gbnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gc2VsZWN0U2luZ2xlKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudW5jaGVja0FsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudW5jaGVja0FsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gIWl0ZW0uY2hlY2tlZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRNb2RlbFZhbHVlKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNlbGVjdE11bHRpcGxlKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gIWl0ZW0uY2hlY2tlZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0TW9kZWxWYWx1ZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNldE1vZGVsVmFsdWUoaXNNdWx0aXBsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNNdWx0aXBsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzY29wZS5ncm91cHMsIGZ1bmN0aW9uIChncm91cCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChncm91cC5pdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2hlY2tlZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5wdXNoKGl0ZW0ubW9kZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goc2NvcGUuZ3JvdXBzLCBmdW5jdGlvbiAoZ3JvdXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZ3JvdXAuaXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gaXRlbS5tb2RlbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsQ3RybC4kc2V0Vmlld1ZhbHVlKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIG1hcmtDaGVja2VkKG5ld1ZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNBcnJheShuZXdWYWwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFuZXdWYWwgJiYgdHlwZW9mIG5ld1ZhbCAhPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbCA9IG5ld1ZhbC50b1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHNjb3BlLmdyb3VwcywgZnVuY3Rpb24gKGdyb3VwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGdyb3VwLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5lcXVhbHMoaXRlbS5tb2RlbCwgbmV3VmFsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzY29wZS5ncm91cHMsIGZ1bmN0aW9uIChncm91cCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChncm91cC5pdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChuZXdWYWwsIGZ1bmN0aW9uIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFpICYmIHR5cGVvZiBpICE9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGkudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbmd1bGFyLmVxdWFscyhpdGVtLm1vZGVsLCBpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2hlY2tBbGwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNNdWx0aXBsZSkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goc2NvcGUuZ3JvdXBzLCBmdW5jdGlvbiAoZ3JvdXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChncm91cC5pdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldE1vZGVsVmFsdWUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUudW5jaGVja0FsbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHNjb3BlLmdyb3VwcywgZnVuY3Rpb24gKGdyb3VwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZ3JvdXAuaXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0TW9kZWxWYWx1ZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5zZWxlY3QgPSBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNNdWx0aXBsZSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdFNpbmdsZShpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnRvZ2dsZVNlbGVjdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TXVsdGlwbGUoaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfV0pXHJcblxyXG4gICAgLmRpcmVjdGl2ZSgnbXVsdGlzZWxlY3RQb3B1cCcsIFsnJGRvY3VtZW50JywgZnVuY3Rpb24gKCRkb2N1bWVudCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQUUnLFxyXG4gICAgICAgICAgICBzY29wZTogZmFsc2UsXHJcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbXVsdGlzZWxlY3QudHBsLmh0bWwnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgc2NvcGUuaXNWaXNpYmxlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgc2NvcGUudG9nZ2xlU2VsZWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdvcGVuJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnb3BlbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkZG9jdW1lbnQudW5iaW5kKCdjbGljaycsIGNsaWNrSGFuZGxlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnb3BlbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkZG9jdW1lbnQuYmluZCgnY2xpY2snLCBjbGlja0hhbmRsZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3Njb3BlLmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjbGlja0hhbmRsZXIoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudE1hdGNoZXNBbnlJbkFycmF5KGV2ZW50LnRhcmdldCwgZWxlbWVudC5maW5kKGV2ZW50LnRhcmdldC50YWdOYW1lKSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdvcGVuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJGRvY3VtZW50LnVuYmluZCgnY2xpY2snLCBjbGlja0hhbmRsZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuLy8gICAgICAgICAgICAgICAgc2NvcGUuZm9jdXMgPSBmdW5jdGlvbiBmb2N1cygpe1xyXG4vLyAgICAgICAgICAgICAgICAgICAgdmFyIHNlYXJjaEJveCA9IGVsZW1lbnQuZmluZCgnaW5wdXQnKVswXTtcclxuLy8gICAgICAgICAgICAgICAgICAgIHNlYXJjaEJveC5mb2N1cygpO1xyXG4vLyAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRNYXRjaGVzQW55SW5BcnJheSA9IGZ1bmN0aW9uIChlbGVtZW50LCBlbGVtZW50QXJyYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRBcnJheS5sZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQgPT0gZWxlbWVudEFycmF5W2ldKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfV0pO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ211bHRpc2VsZWN0LnRwbC5odG1sJywgW10pXHJcblxyXG4gICAgLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oJHRlbXBsYXRlQ2FjaGUpIHtcclxuICAgICAgICAkdGVtcGxhdGVDYWNoZS5wdXQoJ211bHRpc2VsZWN0LnRwbC5odG1sJyxcclxuXHJcbiAgICAgICAgICAgIFwiPGRpdiBjbGFzcz1cXFwiZHJvcGRvd25cXFwiPlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICA8YnV0dG9uIHR5cGU9XFxcImJ1dHRvblxcXCIgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgbmctY2xpY2s9XFxcInRvZ2dsZVNlbGVjdCgpXFxcIiBuZy1kaXNhYmxlZD1cXFwiZGlzYWJsZWRcXFwiIG5nLWNsYXNzPVxcXCJ7J2Vycm9yJzogIXZhbGlkKCl9XFxcIj5cXG5cIiArXHJcbiAgICAgICAgICAgICAgICBcIiAgICB7e2hlYWRlcn19IDxzcGFuIGNsYXNzPVxcXCJjYXJldFxcXCI+PC9zcGFuPlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICA8L2J1dHRvbj5cXG5cIiArXHJcbiAgICAgICAgICAgICAgICBcIiAgPHVsIGNsYXNzPVxcXCJkcm9wZG93bi1tZW51XFxcIj5cXG5cIiArXHJcbiAgICAgICAgICAgICAgICBcIiAgICA8bGkgbmctc2hvdz1cXFwic2hvd0ZpbHRlclxcXCI+XFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgXCIgICAgICA8aW5wdXQgY2xhc3M9XFxcImZvcm0tY29udHJvbCBpbnB1dC1zbVxcXCIgdHlwZT1cXFwidGV4dFxcXCIgbmctbW9kZWw9XFxcInNlYXJjaFRleHQubGFiZWxcXFwiIGF1dG9mb2N1cz1cXFwiYXV0b2ZvY3VzXFxcIiBwbGFjZWhvbGRlcj1cXFwiRmlsdGVyXFxcIiAvPlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICAgIDwvbGk+XFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgXCIgICAgPGxpIG5nLXNob3c9XFxcIm11bHRpcGxlICYmIHNob3dDaGVja0FsbFxcXCIgcm9sZT1cXFwicHJlc2VudGF0aW9uXFxcIiBjbGFzcz1cXFwiXFxcIj5cXG5cIiArXHJcbiAgICAgICAgICAgICAgICBcIiAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tbGluayBidG4teHNcXFwiIG5nLWNsaWNrPVxcXCJjaGVja0FsbCgpXFxcIiB0eXBlPVxcXCJidXR0b25cXFwiPjxpIGNsYXNzPVxcXCJpY29uLW9rXFxcIj48L2k+IENoZWNrIGFsbDwvYnV0dG9uPlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1saW5rIGJ0bi14c1xcXCIgbmctY2xpY2s9XFxcInVuY2hlY2tBbGwoKVxcXCIgdHlwZT1cXFwiYnV0dG9uXFxcIj48aSBjbGFzcz1cXFwiaWNvbi1yZW1vdmVcXFwiPjwvaT4gVW5jaGVjayBhbGw8L2J1dHRvbj5cXG5cIiArXHJcbiAgICAgICAgICAgICAgICBcIiAgICA8L2xpPlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICAgIDxkaXYgbmctcmVwZWF0PVxcXCJpIGluIGdyb3Vwc1xcXCI+XFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgXCIgICAgICAgPGRpdj5cXG5cIiArXHJcbiAgICAgICAgICAgICAgICBcIiAgICAgICAgICAgPGg1Pnt7aS5uYW1lfX08L2g1PlwiK1xyXG4gICAgICAgICAgICAgICAgXCIgICAgICAgPC9kaXY+XFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgXCIgICAgICAgPGRpdiBjbGFzcz1cXFwiZHJvcGRvd24tY29udGFpbmVyXFxcIiBuZy1yZXBlYXQ9XFxcImogaW4gaS5pdGVtcyB8IGZpbHRlcjpzZWFyY2hUZXh0XFxcIj5cXG5cIiArXHJcbiAgICAgICAgICAgICAgICBcIiAgICAgICAgICAgPGEgbmctY2xpY2s9XFxcInNlbGVjdChqKTsgZm9jdXMoKVxcXCI+XFxuXCIgK1xyXG4gICAgICAgICAgICAgICAgXCIgICAgICAgICAgICAgICA8aSBuZy1jbGFzcz1cXFwieydpY29uLW9rJzogai5jaGVja2VkLCAnaWNvbi1lbXB0eSc6ICFqLmNoZWNrZWR9XFxcIj48L2k+IHt7ai5sYWJlbH19PC9hPlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICAgICAgIDwvZGl2PlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICAgIDwvZGl2PlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiICA8L3VsPlxcblwiICtcclxuICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIpO1xyXG4gICAgfV0pO1xyXG4iLCIvKipcclxuICogQ3JlYXRlZCBieSBhcmdvYWF2YSBvbiAyMi4wNC4xNC5cclxuICovXHJcblxyXG4vLyBNb2R1bGUgdGhhdCBwcm92aWRlcyBmdW5jdGlvbmFsaXR5IHRvIGFzayBjb25maXJtYXRpb24gZnJvbSB1c2VyIHdoZW5cclxuLy8gZm9ybSBoYXMgY2hhbmdlZCBhbmQgdXNlciB0cmllcyB0byBsZWF2ZSBwYWdlIHdpdGhvdXQgc2F2aW5nLlxyXG4vL1xyXG4vLyBVc2FnZSBleGFtcGxlOlxyXG4vL1xyXG4vLyA8ZGl2IG5nLWZvcm09XCJhcHBGb3JtXCIgbm92YWxpZGF0ZSBjbGFzcz1cImNzcy1mb3JtXCIgbmctY2xhc3M9XCJ7ICdzdWJtaXR0ZWQnIDogc3VibWl0dGVkIH1cIiB0ZC1uYXZpZ2F0aW9uLWJsb2NrZXItZm9ybT5cclxuLy9cclxuLy8gJ3RkLW5hdmlnYXRpb24tYmxvY2tlci1mb3JtJyBtdXN0IGJlIHNwZWNpZmllZCBhcyBhdHRyaWJ1dGUgZm9yIHRoZSBmb3JtIHRoYXQgY29uZmlybWF0aW9uIGZ1bmN0aW9uYWxpdHlcclxuLy8gbXVzdCBhcHBseSB0by5cclxuXHJcbi8vRklYTUUgc2hvdWxkIGJlIGFibGUgdG8gbWFrZSBpdCBzbyB0aGF0IHJvb3RTY29wZSBpcyBub3QgdXNlZC5cclxuYW5ndWxhci5tb2R1bGUoJ25hdmlnYXRpb24ubmF2aWdhdGlvbkJsb2NrZXInLCBbXSlcclxuICAgIC5ydW4oWyckcm9vdFNjb3BlJywgJyRsb2NhdGlvbicsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkbG9jYXRpb24pIHtcclxuICAgICAgICB2YXIgX3ByZXZlbnROYXZpZ2F0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIF9wcmV2ZW50TmF2aWdhdGlvblVybCA9IG51bGw7XHJcblxyXG4gICAgICAgICRyb290U2NvcGUuYWxsb3dOYXZpZ2F0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIF9wcmV2ZW50TmF2aWdhdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRyb290U2NvcGUucHJldmVudE5hdmlnYXRpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgX3ByZXZlbnROYXZpZ2F0aW9uID0gdHJ1ZTtcclxuICAgICAgICAgICAgX3ByZXZlbnROYXZpZ2F0aW9uVXJsID0gJGxvY2F0aW9uLmFic1VybCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHJvb3RTY29wZS4kb24oJyRsb2NhdGlvbkNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBuZXdVcmwsIG9sZFVybCkge1xyXG4gICAgICAgICAgICAvLyBBbGxvdyBuYXZpZ2F0aW9uIGlmIG91ciBvbGQgdXJsIHdhc24ndCB3aGVyZSB3ZSBwcmV2ZW50ZWQgbmF2aWdhdGlvbiBmcm9tXHJcbiAgICAgICAgICAgIGlmIChfcHJldmVudE5hdmlnYXRpb25VcmwgIT0gb2xkVXJsIHx8IF9wcmV2ZW50TmF2aWdhdGlvblVybCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmFsbG93TmF2aWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoX3ByZXZlbnROYXZpZ2F0aW9uICYmICFjb25maXJtKFwiWW91IGhhdmUgdW5zYXZlZCBjaGFuZ2VzLCBkbyB5b3Ugd2FudCB0byBjb250aW51ZT9cIikpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmFsbG93TmF2aWdhdGlvbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFRha2UgY2FyZSBvZiBwcmV2ZW50aW5nIG5hdmlnYXRpb24gb3V0IG9mIG91ciBhbmd1bGFyIGFwcFxyXG4gICAgICAgIHdpbmRvdy5vbmJlZm9yZXVubG9hZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBVc2UgdGhlIHNhbWUgZGF0YSB0aGF0IHdlJ3ZlIHNldCBpbiBvdXIgYW5ndWxhciBhcHBcclxuICAgICAgICAgICAgaWYgKF9wcmV2ZW50TmF2aWdhdGlvbiAmJiAkbG9jYXRpb24uYWJzVXJsKCkgPT0gX3ByZXZlbnROYXZpZ2F0aW9uVXJsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJZb3UgaGF2ZSB1bnNhdmVkIGNoYW5nZXMsIGRvIHlvdSB3YW50IHRvIGNvbnRpbnVlP1wiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfV0pXHJcblxyXG4gICAgLmRpcmVjdGl2ZShcImJsb2NrRm9ybU5hdmlnYXRpb25cIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgICAgIHJlcXVpcmU6IFsnXmZvcm0nXSxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycywgZm9ybUNvbnRyb2xsZXIpIHtcclxuICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaChhdHRycy5uZ0Zvcm0gKyAnLiRkaXJ0eScsIGZ1bmN0aW9uIChkaXJ0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkaXJ0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kcm9vdC5wcmV2ZW50TmF2aWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRyb290LmFsbG93TmF2aWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuXHJcblxyXG4iLCIndXNlIHN0cmljdCc7XG4vLyAgU2VydmljZSBmb3IgY3JlYXRpbmcgbm90aWZpY2F0aW9ucy5cbi8vICBPcmlnaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9EZXJla1JpZXMvQW5ndWxhci1Ob3RpZmljYXRpb25zXG4vL1xuLy8gIERlcGVuZGVuY2llczpcbi8vICAgICAgSXQgdXNlIEJvb3RzdHJhYiBjb21wb25lbnQ6ICBodHRwOi8vZ2V0Ym9vdHN0cmFwLmNvbS9jb21wb25lbnRzL1xuXG4vLyAgSW5zdGFsbGF0aW9uOlxuLy8gICAgICAxLiBBZGQgc2NyaXB0IGZpbGU6XG4vLyAgICAgICAgICA8c2NyaXB0IHNyYz1cIm5vdGlmaWNhdGlvbi5qc1wiPjwvc2NyaXB0PlxuLy9cbi8vICAgICAgMi4gQWRkIGNzcyB0byB5b3VyIHdlYmZvcm06XG4vLyAgICAgICAgICA8bGluayByZWw9XCJzdHlsZXNoZWV0XCIgaHJlZj1cIm5vdGlmaWNhdGlvbi5jc3NcIi8+XG4vL1xuLy8gICAgICAzLiBBZGQgbm90aWZpY2F0aW9ucyBtb2R1bGUgYXMgYSBkZXBlbmRlbmN5IG9mIHlvdXIgYXBwIG1vZHVsZTpcbi8vICAgICAgICAgIGUuZyBhbmd1bGFyLm1vZHVsZSgnbmdjb21wb25lbnRzQXBwJywgWydub3RpZmljYXRpb25zJ10pXG4vL1xuLy8gICAgICA0LiBBZGQgYSBkaXYgdG8geW91ciBib2R5IHRhZyBzb21ld2hlcmUgYW5kIGdpdmUgaXQgYVxuLy8gICAgICAgICAgbm90aWZpY2F0aW9ucyBkaXJlY3RpdmUgc3BlY2lmeWluZyBpdHMgcG9zaXRpb24gbGlrZSBzbzpcbi8vICAgICAgICAgICAgICA8ZGl2IG5vdGlmaWNhdGlvbnM9XCJib3R0b20gcmlnaHRcIj48L2Rpdj5cbi8vXG4vLyBVc2FnZSBFeGFtcGxlOlxuLy8gICAgICBZb3UgY2FuIHVzZSB0aGVzZSBtZXRob2RzIHdpdGggdGhlIGZvbGxvd2luZ1xuLy8gICAgICBsaW5lIG9mIGNvZGUgKHVzZXJEYXRhIHBhcmFtZXRlciBpcyBvcHRpb25hbCwgY3VycmVudGx5IHRpdGxlIGlzIG5vdCB1c2VkKTpcbi8vXG4vLyAgICAkbm90aWZpY2F0aW9uLmluZm8odGl0bGUsIGNvbnRlbnQsIHVzZXJEYXRhKTtcbi8vICAgICRub3RpZmljYXRpb24ud2FybmluZyh0aXRsZSwgY29udGVudCwgdXNlckRhdGEpO1xuLy8gICAgJG5vdGlmaWNhdGlvbi5lcnJvcihcIlNhdmVcIiwgXCJEYXRhIGlzIG5vdCBzYXZlZCAhXCIpO1xuLy8gICAgJG5vdGlmaWNhdGlvbi5zdWNjZXNzKFwiU2F2ZVwiLCBcIkRhdGEgaXMgc2F2ZWQgc3VjY2Vzc2Z1bGx5LlwiKTtcbi8vXG5hbmd1bGFyLm1vZHVsZSgnbm90aWZpY2F0aW9ucycsIFtdKS5cbiAgICBmYWN0b3J5KCckbm90aWZpY2F0aW9uJywgWyckdGltZW91dCcsZnVuY3Rpb24oJHRpbWVvdXQpe1xuXG4gICAgICAgIC8vY29uc29sZS5sb2coJ25vdGlmaWNhdGlvbiBzZXJ2aWNlIG9ubGluZScpO1xuICAgICAgICB2YXIgbm90aWZpY2F0aW9ucyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJyRub3RpZmljYXRpb25zJykpIHx8IFtdLFxuICAgICAgICAgICAgcXVldWUgPSBbXTtcblxuICAgICAgICB2YXIgc2V0dGluZ3MgPSB7XG4gICAgICAgICAgICBpbmZvOiB7IGR1cmF0aW9uOiA1MDAwLCBlbmFibGVkOiB0cnVlIH0sXG4gICAgICAgICAgICB3YXJuaW5nOiB7IGR1cmF0aW9uOiA1MDAwLCBlbmFibGVkOiB0cnVlIH0sXG4gICAgICAgICAgICBlcnJvcjogeyBkdXJhdGlvbjogNTAwMCwgZW5hYmxlZDogdHJ1ZSB9LFxuICAgICAgICAgICAgc3VjY2VzczogeyBkdXJhdGlvbjogNTAwMCwgZW5hYmxlZDogdHJ1ZSB9LFxuICAgICAgICAgICAgcHJvZ3Jlc3M6IHsgZHVyYXRpb246IDAsIGVuYWJsZWQ6IHRydWUgfSxcbiAgICAgICAgICAgIGN1c3RvbTogeyBkdXJhdGlvbjogMzUwMDAsIGVuYWJsZWQ6IHRydWUgfSxcbiAgICAgICAgICAgIGRldGFpbHM6IHRydWUsXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2U6IGZhbHNlLFxuICAgICAgICAgICAgaHRtbDVNb2RlOiBmYWxzZSxcbiAgICAgICAgICAgIGh0bWw1RGVmYXVsdEljb246ICdpY29uLnBuZydcbiAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiBodG1sNU5vdGlmeShpY29uLCB0aXRsZSwgY29udGVudCwgb25kaXNwbGF5LCBvbmNsb3NlKXtcbiAgICAgICAgICAgIGlmKHdpbmRvdy53ZWJraXROb3RpZmljYXRpb25zLmNoZWNrUGVybWlzc2lvbigpID09PSAwKXtcbiAgICAgICAgICAgICAgICBpZighaWNvbil7XG4gICAgICAgICAgICAgICAgICAgIGljb24gPSAnZmF2aWNvbi5pY28nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbm90aSA9IHdpbmRvdy53ZWJraXROb3RpZmljYXRpb25zLmNyZWF0ZU5vdGlmaWNhdGlvbihpY29uLCB0aXRsZSwgY29udGVudCk7XG4gICAgICAgICAgICAgICAgaWYodHlwZW9mIG9uZGlzcGxheSA9PT0gJ2Z1bmN0aW9uJyl7XG4gICAgICAgICAgICAgICAgICAgIG5vdGkub25kaXNwbGF5ID0gb25kaXNwbGF5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZih0eXBlb2Ygb25jbG9zZSA9PT0gJ2Z1bmN0aW9uJyl7XG4gICAgICAgICAgICAgICAgICAgIG5vdGkub25jbG9zZSA9IG9uY2xvc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5vdGkuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2V0dGluZ3MuaHRtbDVNb2RlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXG4gICAgICAgIHJldHVybiB7XG5cbiAgICAgICAgICAgIC8qID09PT09PT09PT0gU0VUVElOR1MgUkVMQVRFRCBNRVRIT0RTID09PT09PT09PT09PT0qL1xuXG4gICAgICAgICAgICBkaXNhYmxlSHRtbDVNb2RlOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHNldHRpbmdzLmh0bWw1TW9kZSA9IGZhbHNlO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgZGlzYWJsZVR5cGU6IGZ1bmN0aW9uKG5vdGlmaWNhdGlvblR5cGUpe1xuICAgICAgICAgICAgICAgIHNldHRpbmdzW25vdGlmaWNhdGlvblR5cGVdLmVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGVuYWJsZUh0bWw1TW9kZTogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAvLyBzZXR0aW5ncy5odG1sNU1vZGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHNldHRpbmdzLmh0bWw1TW9kZSA9IHRoaXMucmVxdWVzdEh0bWw1TW9kZVBlcm1pc3Npb25zKCk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBlbmFibGVUeXBlOiBmdW5jdGlvbihub3RpZmljYXRpb25UeXBlKXtcbiAgICAgICAgICAgICAgICBzZXR0aW5nc1tub3RpZmljYXRpb25UeXBlXS5lbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGdldFNldHRpbmdzOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHJldHVybiBzZXR0aW5ncztcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHRvZ2dsZVR5cGU6IGZ1bmN0aW9uKG5vdGlmaWNhdGlvblR5cGUpe1xuICAgICAgICAgICAgICAgIHNldHRpbmdzW25vdGlmaWNhdGlvblR5cGVdLmVuYWJsZWQgPSAhc2V0dGluZ3Nbbm90aWZpY2F0aW9uVHlwZV0uZW5hYmxlZDtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHRvZ2dsZUh0bWw1TW9kZTogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBzZXR0aW5ncy5odG1sNU1vZGUgPSAhc2V0dGluZ3MuaHRtbDVNb2RlO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgcmVxdWVzdEh0bWw1TW9kZVBlcm1pc3Npb25zOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGlmICh3aW5kb3cud2Via2l0Tm90aWZpY2F0aW9ucyl7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ25vdGlmaWNhdGlvbnMgYXJlIGF2YWlsYWJsZScpO1xuICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LndlYmtpdE5vdGlmaWNhdGlvbnMuY2hlY2tQZXJtaXNzaW9uKCkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cud2Via2l0Tm90aWZpY2F0aW9ucy5yZXF1ZXN0UGVybWlzc2lvbihmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHdpbmRvdy53ZWJraXROb3RpZmljYXRpb25zLmNoZWNrUGVybWlzc2lvbigpID09PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3MuaHRtbDVNb2RlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3MuaHRtbDVNb2RlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnbm90aWZpY2F0aW9ucyBhcmUgbm90IHN1cHBvcnRlZCcpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcblxuXG4gICAgICAgICAgICAvKiA9PT09PT09PT09PT0gUVVFUllJTkcgUkVMQVRFRCBNRVRIT0RTID09PT09PT09PT09PSovXG5cbiAgICAgICAgICAgIGdldEFsbDogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAvLyBSZXR1cm5zIGFsbCBub3RpZmljYXRpb25zIHRoYXQgYXJlIGN1cnJlbnRseSBzdG9yZWRcbiAgICAgICAgICAgICAgICByZXR1cm4gbm90aWZpY2F0aW9ucztcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGdldFF1ZXVlOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHJldHVybiBxdWV1ZTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qID09PT09PT09PT09PT09IE5PVElGSUNBVElPTiBNRVRIT0RTID09PT09PT09PT09PT09Ki9cblxuICAgICAgICAgICAgaW5mbzogZnVuY3Rpb24odGl0bGUsIGNvbnRlbnQsIHVzZXJEYXRhKXtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRpdGxlLCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hd2Vzb21lTm90aWZ5KCdpbmZvJywnaW5mby1zaWduJywgdGl0bGUsIGNvbnRlbnQsIHVzZXJEYXRhKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbih0aXRsZSwgY29udGVudCwgdXNlckRhdGEpe1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmF3ZXNvbWVOb3RpZnkoJ2Vycm9yJywgJ3JlbW92ZS1zaWduJywgdGl0bGUsIGNvbnRlbnQsIHVzZXJEYXRhKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHRpdGxlLCBjb250ZW50LCB1c2VyRGF0YSl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXdlc29tZU5vdGlmeSgnc3VjY2VzcycsICdvay1zaWduJywgdGl0bGUsIGNvbnRlbnQsIHVzZXJEYXRhKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHdhcm5pbmc6IGZ1bmN0aW9uKHRpdGxlLCBjb250ZW50LCB1c2VyRGF0YSl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXdlc29tZU5vdGlmeSgnd2FybmluZycsICdleGNsYW1hdGlvbi1zaWduJywgdGl0bGUsIGNvbnRlbnQsIHVzZXJEYXRhKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGF3ZXNvbWVOb3RpZnk6IGZ1bmN0aW9uKHR5cGUsIGljb24sIHRpdGxlLCBjb250ZW50LCB1c2VyRGF0YSl7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogU3VwcG9zZWQgdG8gd3JhcCB0aGUgbWFrZU5vdGlmaWNhdGlvbiBtZXRob2QgZm9yIGRyYXdpbmcgaWNvbnMgdXNpbmcgZm9udC1hd2Vzb21lXG4gICAgICAgICAgICAgICAgICogcmF0aGVyIHRoYW4gYW4gaW1hZ2UuXG4gICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgKiBOZWVkIHRvIGZpbmQgb3V0IGhvdyBJJ20gZ29pbmcgdG8gbWFrZSB0aGUgQVBJIHRha2UgZWl0aGVyIGFuIGltYWdlXG4gICAgICAgICAgICAgICAgICogcmVzb3VyY2UsIG9yIGEgZm9udC1hd2Vzb21lIGljb24gYW5kIHRoZW4gZGlzcGxheSBlaXRoZXIgb2YgdGhlbS5cbiAgICAgICAgICAgICAgICAgKiBBbHNvIHNob3VsZCBwcm9iYWJseSBwcm92aWRlIHNvbWUgYml0cyBvZiBjb2xvciwgY291bGQgZG8gdGhlIGNvbG9yaW5nXG4gICAgICAgICAgICAgICAgICogdGhyb3VnaCBjbGFzc2VzLlxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIC8vIGltYWdlID0gJzxpIGNsYXNzPVwiaWNvbi0nICsgaW1hZ2UgKyAnXCI+PC9pPic7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubWFrZU5vdGlmaWNhdGlvbih0eXBlLCBmYWxzZSwgaWNvbiwgdGl0bGUsIGNvbnRlbnQsIHVzZXJEYXRhKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIG5vdGlmeTogZnVuY3Rpb24oaW1hZ2UsIHRpdGxlLCBjb250ZW50LCB1c2VyRGF0YSl7XG4gICAgICAgICAgICAgICAgLy8gV3JhcHMgdGhlIG1ha2VOb3RpZmljYXRpb24gbWV0aG9kIGZvciBkaXNwbGF5aW5nIG5vdGlmaWNhdGlvbnMgd2l0aCBpbWFnZXNcbiAgICAgICAgICAgICAgICAvLyByYXRoZXIgdGhhbiBpY29uc1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1ha2VOb3RpZmljYXRpb24oJ2N1c3RvbScsIGltYWdlLCB0cnVlLCB0aXRsZSwgY29udGVudCwgdXNlckRhdGEpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgbWFrZU5vdGlmaWNhdGlvbjogZnVuY3Rpb24odHlwZSwgaW1hZ2UsIGljb24sIHRpdGxlLCBjb250ZW50LCB1c2VyRGF0YSl7XG4gICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiB0eXBlLFxuICAgICAgICAgICAgICAgICAgICAnaW1hZ2UnOiBpbWFnZSxcbiAgICAgICAgICAgICAgICAgICAgJ2ljb24nOiBpY29uLFxuICAgICAgICAgICAgICAgICAgICAndGl0bGUnOiB0aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnQnOiBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAndGltZXN0YW1wJzogK25ldyBEYXRlKCksXG4gICAgICAgICAgICAgICAgICAgICd1c2VyRGF0YSc6IHVzZXJEYXRhXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb25zLnB1c2gobm90aWZpY2F0aW9uKTtcblxuICAgICAgICAgICAgICAgIGlmKHNldHRpbmdzLmh0bWw1TW9kZSl7XG4gICAgICAgICAgICAgICAgICAgIGh0bWw1Tm90aWZ5KGltYWdlLCB0aXRsZSwgY29udGVudCwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJpbm5lciBvbiBkaXNwbGF5IGZ1bmN0aW9uXCIpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcImlubmVyIG9uIGNsb3NlIGZ1bmN0aW9uXCIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgcXVldWUucHVzaChub3RpZmljYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiByZW1vdmVGcm9tUXVldWVUaW1lb3V0KCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWV1ZS5zcGxpY2UocXVldWUuaW5kZXhPZihub3RpZmljYXRpb24pLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgc2V0dGluZ3NbdHlwZV0uZHVyYXRpb24pO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vdGlmaWNhdGlvbjtcbiAgICAgICAgICAgIH0sXG5cblxuICAgICAgICAgICAgLyogPT09PT09PT09PT09IFBFUlNJU1RFTkNFIE1FVEhPRFMgPT09PT09PT09PT09ICovXG5cbiAgICAgICAgICAgIHNhdmU6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgLy8gU2F2ZSBhbGwgdGhlIG5vdGlmaWNhdGlvbnMgaW50byBsb2NhbFN0b3JhZ2VcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhKU09OKTtcbiAgICAgICAgICAgICAgICBpZihzZXR0aW5ncy5sb2NhbFN0b3JhZ2Upe1xuICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnJG5vdGlmaWNhdGlvbnMnLCBKU09OLnN0cmluZ2lmeShub3RpZmljYXRpb25zKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCckbm90aWZpY2F0aW9ucycpKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHJlc3RvcmU6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgLy8gTG9hZCBhbGwgbm90aWZpY2F0aW9ucyBmcm9tIGxvY2FsU3RvcmFnZVxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgY2xlYXI6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgbm90aWZpY2F0aW9ucyA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH07XG4gICAgfV0pLlxuICAgIGRpcmVjdGl2ZSgnbm90aWZpY2F0aW9ucycsIFsnJG5vdGlmaWNhdGlvbicsICckY29tcGlsZScsIGZ1bmN0aW9uKCRub3RpZmljYXRpb24sICRjb21waWxlKXtcbiAgICAgICAgLyoqXG4gICAgICAgICAqXG4gICAgICAgICAqIEl0IHNob3VsZCBhbHNvIHBhcnNlIHRoZSBhcmd1bWVudHMgcGFzc2VkIHRvIGl0IHRoYXQgc3BlY2lmeVxuICAgICAgICAgKiBpdHMgcG9zaXRpb24gb24gdGhlIHNjcmVlbiBsaWtlIFwiYm90dG9tIHJpZ2h0XCIgYW5kIGFwcGx5IHRob3NlXG4gICAgICAgICAqIHBvc2l0aW9ucyBhcyBhIGNsYXNzIHRvIHRoZSBjb250YWluZXIgZWxlbWVudFxuICAgICAgICAgKlxuICAgICAgICAgKiBGaW5hbGx5LCB0aGUgZGlyZWN0aXZlIHNob3VsZCBoYXZlIGl0cyBvd24gY29udHJvbGxlciBmb3JcbiAgICAgICAgICogaGFuZGxpbmcgYWxsIG9mIHRoZSBub3RpZmljYXRpb25zIGZyb20gdGhlIG5vdGlmaWNhdGlvbiBzZXJ2aWNlXG4gICAgICAgICAqL1xuICAgICAgICAvL2NvbnNvbGUubG9nKCd0aGlzIGlzIGEgbmV3IGRpcmVjdGl2ZScpO1xuICAgICAgICB2YXIgaHRtbCA9XG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cImRyLW5vdGlmaWNhdGlvbi13cmFwcGVyXCIgbmctcmVwZWF0PVwibm90aSBpbiBxdWV1ZVwiPicgK1xuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZHItbm90aWZpY2F0aW9uLWNsb3NlLWJ0blwiIG5nLWNsaWNrPVwicmVtb3ZlTm90aWZpY2F0aW9uKG5vdGkpXCI+JyArXG4gICAgICAgICAgICAgICAgICAgICc8aSBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tcmVtb3ZlXCI+PC9pPicgK1xuICAgICAgICAgICAgICAgICc8L2Rpdj4nICtcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImRyLW5vdGlmaWNhdGlvbiBub3RpLWJhY2stZ3JvdW5kLXt7bm90aS50eXBlfX1cIj4nICtcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJkci1ub3RpZmljYXRpb24taW1hZ2UgZHItbm90aWZpY2F0aW9uLXR5cGUte3tub3RpLnR5cGV9fVwiIG5nLXN3aXRjaCBvbj1cIm5vdGkuaW1hZ2VcIj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8aSBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24te3tub3RpLmljb259fVwiIG5nLXN3aXRjaC13aGVuPVwiZmFsc2VcIj48L2k+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGltZyBuZy1zcmM9XCJ7e25vdGkuaW1hZ2V9fVwiIG5nLXN3aXRjaC1kZWZhdWx0IC8+JyArXG4gICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nICtcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJkci1ub3RpZmljYXRpb24tY29udGVudFwiPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgLyonPGgzIGNsYXNzPVwiZHItbm90aWZpY2F0aW9uLXRpdGxlXCI+e3tub3RpLnRpdGxlfX08L2gzPicgKyAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxwIGNsYXNzPVwiZHItbm90aWZpY2F0aW9uLXRleHRcIj57e25vdGkuY29udGVudH19PC9wPicgK1xuICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JyArXG4gICAgICAgICAgICAgICAgJzwvZGl2PicgK1xuICAgICAgICAgICAgJzwvZGl2Pic7XG5cblxuICAgICAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycyl7XG4gICAgICAgICAgICB2YXIgcG9zaXRpb24gPSBhdHRycy5ub3RpZmljYXRpb25zO1xuICAgICAgICAgICAgcG9zaXRpb24gPSBwb3NpdGlvbi5zcGxpdCgnICcpO1xuICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnZHItbm90aWZpY2F0aW9uLWNvbnRhaW5lcicpO1xuICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHBvc2l0aW9uLmxlbmd0aCA7IGkrKyl7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcyhwb3NpdGlvbltpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgc2NvcGU6IHt9LFxuICAgICAgICAgICAgdGVtcGxhdGU6IGh0bWwsXG4gICAgICAgICAgICBsaW5rOiBsaW5rLFxuICAgICAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCBmdW5jdGlvbiBOb3RpZmljYXRpb25zQ3RybCggJHNjb3BlICl7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnF1ZXVlID0gJG5vdGlmaWNhdGlvbi5nZXRRdWV1ZSgpO1xuXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlbW92ZU5vdGlmaWNhdGlvbiA9IGZ1bmN0aW9uKG5vdGkpe1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVldWUuc3BsaWNlKCRzY29wZS5xdWV1ZS5pbmRleE9mKG5vdGkpLCAxKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuXG4gICAgICAgIH07XG4gICAgfV0pOyIsIid1c2Ugc3RyaWN0JztcblxuKFxuICAgIGZ1bmN0aW9uKGFuZ3VsYXIpIHtcbiAgICAgICAgcmV0dXJuIGFuZ3VsYXJcbiAgICAgICAgICAgIC5tb2R1bGUoJ25nT3JkZXJPYmplY3RCeScsIFtdKVxuICAgICAgICAgICAgLmZpbHRlcignb3JkZXJPYmplY3RCeScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoaXRlbXMsIGZpZWxkLCByZXZlcnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmaWx0ZXJlZCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goaXRlbXMsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkLnB1c2goaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBpbmRleChvYmosIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmpbaV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWQuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBhcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVkdWNlZEEgPSBmaWVsZC5zcGxpdCgnLicpLnJlZHVjZShpbmRleCwgYSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVkdWNlZEIgPSBmaWVsZC5zcGxpdCgnLicpLnJlZHVjZShpbmRleCwgYik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVkdWNlZEEgPT09IHJlZHVjZWRCKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFyYXRvciA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhcmF0b3IgPSAocmVkdWNlZEEgPiByZWR1Y2VkQiA/IDEgOiAtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXZlcnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZC5yZXZlcnNlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpbHRlcmVkO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgKShhbmd1bGFyKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBhcmdvYWF2YSBvbiAxMy4wNS4xNC5cclxuICovXHJcblxyXG5cclxuLy8gTW9kdWxlIHRoYXQgY29udGFpbnMgZnVuY3Rpb25hbGl0eSBmb3IgdGFiIG5hdmlnYXRpb24uIFVzZXIgbXVzdCBmaWxsICd0YWJTZXJ2aWNlJyB3aXRoXHJcbi8vIGF2YWlsYWJsZSB0YWJzIGFzIGZvbGxvd3M6XHJcbi8vXHJcbi8vIGFwcC5ydW4oZnVuY3Rpb24oJHJvb3RTY29wZSwgcHJvbWlzZVRyYWNrZXIsICRsb2NhdGlvbiwgdGFiU2VydmljZSkge1xyXG4vLyAgICAgIHRhYlNlcnZpY2Uuc2V0VGFicyhbXHJcbi8vICAgICAgICAgIHtcImlkXCI6XCJUYWJsZTFcIixcImFjdGl2ZVwiIDogdHJ1ZX0sXHJcbi8vICAgICAgICAgIHtcImlkXCI6XCJUYWJsZTJcIixcImFjdGl2ZVwiIDogZmFsc2V9LFxyXG4vLyAgICAgICAgICB7XCJpZFwiOlwiVGFibGUzXCIsXCJhY3RpdmVcIiA6IGZhbHNlfSxcclxuLy8gICAgICAgICAge1wiaWRcIjpcIlRhYmxlNFwiLFwiYWN0aXZlXCIgOiBmYWxzZX0sXHJcbi8vICAgICAgICAgIHtcImlkXCI6XCJUYWJsZTVcIixcImFjdGl2ZVwiIDogZmFsc2V9XSk7XHJcbi8vIH0pO1xyXG4vL1xyXG4vLyB0aGVuICdUYWJDb250cm9sbGVyJyBtdXN0IGJlIHNldCB0byBlbGVtZW50cyB0aGF0IHdhbnQgdG8gaW50ZXJhY3Qgd2l0aFxyXG4vLyB0YWJTZXJ2aWNlLlxyXG4vL1xyXG4vLyA8dWwgdGFic2V0IG5nLWNsb2FrIG5nLWNvbnRyb2xsZXI9XCJUYWJDb250cm9sbGVyXCI+XHJcbi8vICAgICAgPGRpdiBuZy1jbGFzcz1cInsnaW52YWxpZFRhYicgOiBpc0ludmFsaWRUYWIoJ1RhYmxlMScpfVwiPlxyXG4vLyAgICAgICAgICA8bGkgdGFiIGhlYWRpbmc9XCJUYWJsZSAxXCIgYWN0aXZlPVwidGFic1tnZXRUYWJJbmRleCgnVGFibGUxJyldLmFjdGl2ZVwiPlxyXG4vLyAgICAgICAgICA8L2xpPlxyXG4vLyAgICAgIDwvZGl2PlxyXG4vLyA8L3VsPlxyXG4vL1xyXG4vLyBvclxyXG4vL1xyXG4vLyA8ZGl2IGNsYXNzPVwiYW5pbWF0ZS1zaG93XCIgbmctc2hvdz1cInNob3dNZW51XCIgc3R5bGU9XCJmbG9hdDpyaWdodFwiIG5nLWNvbnRyb2xsZXI9XCJUYWJDb250cm9sbGVyXCI+XHJcbi8vICAgICAgPGlucHV0IHR5cGU9XCJidXR0b25cIiBuZy1jbGljaz1cInByZXZpb3VzVGFiKClcIiB2YWx1ZT1cIlByZXZcIiBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBidG4tcHJpbWFyeVwiIG5nLWRpc2FibGVkPVwiZ2V0QWN0aXZlVGFiSW5kZXgoKSA9PSAwXCI+XHJcbi8vICAgICAgPGlucHV0IHR5cGU9XCJidXR0b25cIiBuZy1jbGljaz1cIm5leHRUYWIoKVwiIHZhbHVlPVwiTmV4dFwiIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1wcmltYXJ5XCIgbmctZGlzYWJsZWQ9XCJnZXRBY3RpdmVUYWJJbmRleCgpID09ICh0YWJzLmxlbmd0aCAtIDEpXCIvPlxyXG4vLyA8L2Rpdj5cclxuLy9cclxuYW5ndWxhci5tb2R1bGUoJ3RhYnMuZm9ybVRhYnMnLCBbXSlcclxuICAgIC5zZXJ2aWNlKCd0YWJTZXJ2aWNlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy50YWJzID0gW107XHJcblxyXG4gICAgICAgIHRoaXMuZ2V0VGFicyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50YWJzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zZXRUYWJzID0gZnVuY3Rpb24odGFicykge1xyXG4gICAgICAgICAgICB0aGlzLnRhYnMgPSB0YWJzO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICAuY29udHJvbGxlcihcIlRhYkNvbnRyb2xsZXJcIiwgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgJGxvY2F0aW9uLCAkdGltZW91dCwgJGFuY2hvclNjcm9sbCwgdGFiU2VydmljZSkge1xyXG4gICAgICAgIFxyXG5cclxuICAgICAgICBpZiAodGFiU2VydmljZS5nZXRUYWJzKCkubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJZb3UgbXVzdCBjb25maWd1cmUgdGFiU2VydmljZVwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS50YWJzID0gdGFiU2VydmljZS50YWJzO1xyXG5cclxuICAgICAgICAkc2NvcGUuZ290byA9IGZ1bmN0aW9uICh0YWIsIGlkKXtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAkc2NvcGUudGFicy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS50YWJzW2ldLmlkID09IHRhYikge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50YWJzW2ldLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50YWJzW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgb2xkID0gJGxvY2F0aW9uLmhhc2goKTtcclxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24uaGFzaChpZCk7XHJcbiAgICAgICAgICAgICAgICAkYW5jaG9yU2Nyb2xsKCk7XHJcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24uaGFzaChvbGQpO1xyXG4gICAgICAgICAgICB9LCAyMDApO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5nZXRBY3RpdmVUYWJJbmRleCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS50YWJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnRhYnNbaV0uYWN0aXZlID09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuZ2V0VGFiSW5kZXggPSBmdW5jdGlvbih0YWJJZCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS50YWJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnRhYnNbaV0uaWQgPT0gdGFiSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLm5leHRUYWIgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB2YXIgYWN0aXZlVGFiSW5kZXggPSAkc2NvcGUuZ2V0QWN0aXZlVGFiSW5kZXgoKTtcclxuICAgICAgICAgICAgdmFyIG5leHRUYWIgPSAoYWN0aXZlVGFiSW5kZXggKyAxIDw9ICRzY29wZS50YWJzLmxlbmd0aCk/IGFjdGl2ZVRhYkluZGV4KzEgOiBhY3RpdmVUYWJJbmRleDtcclxuICAgICAgICAgICAgJHNjb3BlLmdvdG8oJHNjb3BlLnRhYnNbbmV4dFRhYl0uaWQsICdiZWdpbm5pbmcnKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUucHJldmlvdXNUYWIgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB2YXIgYWN0aXZlVGFiSW5kZXggPSAkc2NvcGUuZ2V0QWN0aXZlVGFiSW5kZXgoKTtcclxuICAgICAgICAgICAgdmFyIHByZXZpb3VzVGFiID0gKGFjdGl2ZVRhYkluZGV4IC0gMSA+PSAwKT8gYWN0aXZlVGFiSW5kZXggLSAxIDogYWN0aXZlVGFiSW5kZXg7XHJcbiAgICAgICAgICAgICRzY29wZS5nb3RvKCRzY29wZS50YWJzW3ByZXZpb3VzVGFiXS5pZCwgJ2JlZ2lubmluZycpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5pc0ludmFsaWRUYWIgPSBmdW5jdGlvbih0YWJJZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLnN1Ym1pdHRlZCAmJiAkc2NvcGUuYXBwRm9ybVt0YWJJZF0uJGludmFsaWQ7XHJcbiAgICAgICAgfTtcclxuICAgIH0pIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgYXJnb2FhdmEgb24gMTMuMDUuMTQuXHJcbiAqL1xyXG5cclxuLy9DaGVja3MgaWYgYXJyYXkgaXMgZW1wdHkuXHJcbndpbmRvdy5pc0VtcHR5QXJyYXkgPSBmdW5jdGlvbihhcnJheSkge1xyXG4gICAgaWYgKCEoYXJyYXkgaW5zdGFuY2VvZiBBcnJheSkpIHtcclxuICAgICAgICB0aHJvdyBFcnJvcihcIkVsZW1lbnQgbm90IGFycmF5XCIpO1xyXG4gICAgfVxyXG5cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAoIWFycmF5W2ldKSB7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuLy8gQ291bnRzIGFsbCBwcm9wZXJ0aWVzIG9mIGFuIG9iamVjdCBvciBhcnJheS5cclxuLy8gUmVkdWNlcyB0aGUgY291bnQgYnkgb25lIHdoZW4gb2JqZWN0IGlzIGNvbnNpZGVyZWQgZml4ZWQgcXVlc3Rpb25cclxuLy8gaW4gdGhpcyBjYXNlIGZpcnN0IGVsZW1lbnQgb2Ygb2JqZWN0IGlzIHByZWZpbGxlZCBhbmQgbXVzdCBub3QgYmUgY291bnRlZC5cclxud2luZG93LmNvdW50Tm9uRW1wdHlQcm9wZXJ0aWVzID0gZnVuY3Rpb24ob2JqZWN0T3JBcnJheSwgaXNGaXhlZFF1ZXN0aW9uKSB7XHJcbiAgICB2YXIgY291bnQgPSAwO1xyXG5cclxuICAgIGlmICghKG9iamVjdE9yQXJyYXkgaW5zdGFuY2VvZiBBcnJheSkpIHtcclxuICAgICAgICBjb3VudCA9IGNvdW50T2JqZWN0UHJvcGVydGllcyhvYmplY3RPckFycmF5KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvYmplY3RPckFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBvYmplY3RDb3VudCA9IGNvdW50T2JqZWN0UHJvcGVydGllcyhvYmplY3RPckFycmF5W2ldKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpc0ZpeGVkUXVlc3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIG9iamVjdENvdW50IC09IDE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvdW50ICs9IG9iamVjdENvdW50O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBjb3VudDtcclxufTtcclxuXHJcbi8vIENvdW50cyBvbmx5XHJcbndpbmRvdy5jb3VudE9iamVjdFByb3BlcnRpZXMgPSBmdW5jdGlvbihvYmplY3QpIHtcclxuICAgIHZhciBjb3VudCA9IDA7XHJcblxyXG4gICAgLy9Gb3IgcHJpbWl0aXZlc1xyXG4gICAgaWYgKCEodHlwZW9mIG9iamVjdCA9PT0gJ29iamVjdCcpICYmXHJcbiAgICAgICAgISh0eXBlb2Ygb2JqZWN0ID09PSAnYXJyYXknKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gMTtcclxuICAgIH1cclxuXHJcbiAgICBmb3IgKHZhciBpIGluIG9iamVjdCkge1xyXG4gICAgICAgIGlmIChvYmplY3QuaGFzT3duUHJvcGVydHkoaSlcclxuICAgICAgICAgICAgJiYgISFvYmplY3RbaV1cclxuICAgICAgICAgICAgJiYgKGkgIT0gJyQkaGFzaEtleScpKSB7XHJcblxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIG9iamVjdFtpXSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgIHZhciBvYmplY3RFbGVtZW50Q291bnQgPSBjb3VudE5vbkVtcHR5UHJvcGVydGllcyhvYmplY3RbaV0pO1xyXG4gICAgICAgICAgICAgICAgY291bnQgKz0gb2JqZWN0RWxlbWVudENvdW50O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBjb3VudDtcclxufTtcclxuXHJcbi8vIENsZWFycyBvYmplY3Qgb3IgYXJyYXkgZGF0YS4gV2hlbiBvYmplY3QgaXMgYXJyYXkgYWxsIG90aGVyIGVsZW1lbnRzIGV4Y2VwdFxyXG4vLyBmaXJzdCBhcmUgZGVsZXRlZC5cclxud2luZG93LmNsZWFyT2JqZWN0ID0gZnVuY3Rpb24ob2JqZWN0LCBrZWVwRmlyc3QpIHtcclxuICAgIGlmICghKG9iamVjdCBpbnN0YW5jZW9mIEFycmF5KSkge1xyXG5cclxuICAgICAgICB2YXIgaW5kZXhDb3VudGVyID0gMDtcclxuICAgICAgICBmb3IgKHZhciBpIGluIG9iamVjdCkge1xyXG4gICAgICAgICAgICBpZiAob2JqZWN0Lmhhc093blByb3BlcnR5KGkpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXhDb3VudGVyID09IDAgJiYga2VlcEZpcnN0KSB7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG9iamVjdFtpXSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaW5kZXhDb3VudGVyKys7XHJcbiAgICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjbGVhckFycmF5KG9iamVjdCwga2VlcEZpcnN0KTtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbi8vIERlbGV0ZXMgYWxsIG90aGVyIGFycmF5IGVsZW1lbnRzIGV4cGVjdCBmaXJzdCBvbmUgYW5kXHJcbi8vIGNsZWFycyBhbGwgZGF0YSBmcm9tIGZpcnN0IGVsZW1lbnQuXHJcbndpbmRvdy5jbGVhckFycmF5ID1mdW5jdGlvbihhcnJheSwga2VlcFJvdykge1xyXG4gICAgZm9yICh2YXIgaSA9IGFycmF5Lmxlbmd0aDsgaSA+IDA7IGktLSkge1xyXG4gICAgICAgIGlmIChrZWVwUm93KSB7XHJcbiAgICAgICAgICAgIGNsZWFyT2JqZWN0KGFycmF5W2ldLCBrZWVwUm93KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhcnJheS5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY2xlYXJPYmplY3QoYXJyYXlbMF0sIGtlZXBSb3cpO1xyXG5cclxuICAgIC8vIEZvciBhcnJheXMgdGhhdCBjb250YWluIHByaW1pdGl2ZXMuIExhc3QgZWxlbWVudCBtdXN0IGJlXHJcbiAgICAvLyBsZWZ0IGJ1dCBoYXMgdG8gYmUgZW1wdHkgc28gZWxlbWVudCBpcyBzdGlsbCBwcmVzZW50IGFmdGVyXHJcbiAgICAvLyBjb252ZXJzaW9uIHRvIHhtbC5cclxuICAgIGlmICghKGFycmF5WzBdIGluc3RhbmNlb2YgT2JqZWN0KSkge1xyXG4gICAgICAgIGFycmF5WzBdID0gXCJcIjtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vQ2xvbmUgb2JqZWN0LlxyXG53aW5kb3cuY2xvbmUgPSBmdW5jdGlvbihvYmopIHtcclxuICAgIC8vIEhhbmRsZSB0aGUgMyBzaW1wbGUgdHlwZXMsIGFuZCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKG51bGwgPT0gb2JqIHx8IFwib2JqZWN0XCIgIT0gdHlwZW9mIG9iaikgcmV0dXJuIG9iajtcclxuXHJcbiAgICAvLyBIYW5kbGUgRGF0ZVxyXG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mIERhdGUpIHtcclxuICAgICAgICB2YXIgY29weSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgY29weS5zZXRUaW1lKG9iai5nZXRUaW1lKCkpO1xyXG4gICAgICAgIHJldHVybiBjb3B5O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEhhbmRsZSBBcnJheVxyXG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgdmFyIGNvcHkgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gb2JqLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvcHlbaV0gPSBjbG9uZShvYmpbaV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY29weTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBIYW5kbGUgT2JqZWN0XHJcbiAgICBpZiAob2JqIGluc3RhbmNlb2YgT2JqZWN0KSB7XHJcbiAgICAgICAgdmFyIGNvcHkgPSB7fTtcclxuICAgICAgICBmb3IgKHZhciBhdHRyIGluIG9iaikge1xyXG4gICAgICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGF0dHIpKSBjb3B5W2F0dHJdID0gY2xvbmUob2JqW2F0dHJdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNvcHk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIGNvcHkgb2JqISBJdHMgdHlwZSBpc24ndCBzdXBwb3J0ZWQuXCIpO1xyXG59XHJcblxyXG4vLyBGdW5jdGlvbiBpcyB1c2VkIGJlZm9yZSBzYXZpbmcgSlNPTiBvYmplY3QgYmFjayB0byBYTUwgZmlsZS4gV2hlbiBkZWxldGluZyBmaWVsZCBvbiB0aGUgZm9ybVxyXG4vLyBhbmd1bGFyIHNldHMgaXQgdG8gdW5kZWZpbmVkIHdoaWNoIGJyZWFrcyB0aGUgb3JkZXIgb2YgZWxlbWVudHMgaWYgY29udmVydGVkIHRvIFhNTC5cclxud2luZG93LmZpeFVuZGVmaW5lZCA9IGZ1bmN0aW9uKG9iaikge1xyXG4gICAgdmFyIGlzQXJyYXkgPSBvYmogaW5zdGFuY2VvZiBBcnJheTtcclxuICAgIGZvciAodmFyIGogaW4gb2JqKSB7XHJcbiAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShqKSkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mKG9ialtqXSkgPT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgICAgICAgZml4VW5kZWZpbmVkKG9ialtqXSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZighaXNBcnJheSAmJiBqICE9ICckJGhhc2hrZXknKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9ialtqXSA9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgICAgIG9ialtqXSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIGhlbHBlciBmdW5jdGlvbiBmb3IgZ2V0dGluZyBxdWVyeSBzdHJpbmcgcGFyYW1ldGVyIHZhbHVlcy4gQW5ndWxhckpTIHNvbHV0aW9uICRsb2NhdGlvbi5zZWFyY2goKSBkb2Vzbid0IHdvcmsgaW4gSUU4LlxyXG53aW5kb3cuZ2V0UGFyYW1ldGVyQnlOYW1lID0gZnVuY3Rpb24obmFtZSkge1xyXG4gICAgLy8gRklYTUUgLSBXZWJRIGluc3RhbmNlIHBhcmFtIGlzIG5vdCBlc2NhcGVkXHJcbiAgICB2YXIgc2VhcmNoQXJyID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zcGxpdCgnPycpO1xyXG4gICAgdmFyIHNlYXJjaCA9ICc/JyArIHNlYXJjaEFycltzZWFyY2hBcnIubGVuZ3RoIC0gMV07XHJcbiAgICB2YXIgbWF0Y2ggPSBuZXcgUmVnRXhwKCdbPyZdJyArIG5hbWUgKyAnPShbXiZdKiknKS5leGVjKHNlYXJjaCk7XHJcbiAgICByZXR1cm4gbWF0Y2ggJiYgZGVjb2RlVVJJQ29tcG9uZW50KG1hdGNoWzFdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcclxufTsiLCIvKipcbiAqIEBsaWNlbnNlIEFuZ3VsYXJKUyB2MS4yLjE2XG4gKiAoYykgMjAxMC0yMDE0IEdvb2dsZSwgSW5jLiBodHRwOi8vYW5ndWxhcmpzLm9yZ1xuICogTGljZW5zZTogTUlUXG4gKi9cbihmdW5jdGlvbih3aW5kb3csIGFuZ3VsYXIsIHVuZGVmaW5lZCkgeyd1c2Ugc3RyaWN0JztcblxuLyoganNoaW50IG1heGxlbjogZmFsc2UgKi9cblxuLyoqXG4gKiBAbmdkb2MgbW9kdWxlXG4gKiBAbmFtZSBuZ0FuaW1hdGVcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqICMgbmdBbmltYXRlXG4gKlxuICogVGhlIGBuZ0FuaW1hdGVgIG1vZHVsZSBwcm92aWRlcyBzdXBwb3J0IGZvciBKYXZhU2NyaXB0LCBDU1MzIHRyYW5zaXRpb24gYW5kIENTUzMga2V5ZnJhbWUgYW5pbWF0aW9uIGhvb2tzIHdpdGhpbiBleGlzdGluZyBjb3JlIGFuZCBjdXN0b20gZGlyZWN0aXZlcy5cbiAqXG4gKlxuICogPGRpdiBkb2MtbW9kdWxlLWNvbXBvbmVudHM9XCJuZ0FuaW1hdGVcIj48L2Rpdj5cbiAqXG4gKiAjIFVzYWdlXG4gKlxuICogVG8gc2VlIGFuaW1hdGlvbnMgaW4gYWN0aW9uLCBhbGwgdGhhdCBpcyByZXF1aXJlZCBpcyB0byBkZWZpbmUgdGhlIGFwcHJvcHJpYXRlIENTUyBjbGFzc2VzXG4gKiBvciB0byByZWdpc3RlciBhIEphdmFTY3JpcHQgYW5pbWF0aW9uIHZpYSB0aGUgbXlNb2R1bGUuYW5pbWF0aW9uKCkgZnVuY3Rpb24uIFRoZSBkaXJlY3RpdmVzIHRoYXQgc3VwcG9ydCBhbmltYXRpb24gYXV0b21hdGljYWxseSBhcmU6XG4gKiBgbmdSZXBlYXRgLCBgbmdJbmNsdWRlYCwgYG5nSWZgLCBgbmdTd2l0Y2hgLCBgbmdTaG93YCwgYG5nSGlkZWAsIGBuZ1ZpZXdgIGFuZCBgbmdDbGFzc2AuIEN1c3RvbSBkaXJlY3RpdmVzIGNhbiB0YWtlIGFkdmFudGFnZSBvZiBhbmltYXRpb25cbiAqIGJ5IHVzaW5nIHRoZSBgJGFuaW1hdGVgIHNlcnZpY2UuXG4gKlxuICogQmVsb3cgaXMgYSBtb3JlIGRldGFpbGVkIGJyZWFrZG93biBvZiB0aGUgc3VwcG9ydGVkIGFuaW1hdGlvbiBldmVudHMgcHJvdmlkZWQgYnkgcHJlLWV4aXN0aW5nIG5nIGRpcmVjdGl2ZXM6XG4gKlxuICogfCBEaXJlY3RpdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBTdXBwb3J0ZWQgQW5pbWF0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ1JlcGVhdCN1c2FnZV9hbmltYXRpb25zIG5nUmVwZWF0fSAgICAgICAgIHwgZW50ZXIsIGxlYXZlIGFuZCBtb3ZlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCB7QGxpbmsgbmdSb3V0ZS5kaXJlY3RpdmU6bmdWaWV3I3VzYWdlX2FuaW1hdGlvbnMgbmdWaWV3fSAgICAgICAgfCBlbnRlciBhbmQgbGVhdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdJbmNsdWRlI3VzYWdlX2FuaW1hdGlvbnMgbmdJbmNsdWRlfSAgICAgICB8IGVudGVyIGFuZCBsZWF2ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ1N3aXRjaCN1c2FnZV9hbmltYXRpb25zIG5nU3dpdGNofSAgICAgICAgIHwgZW50ZXIgYW5kIGxlYXZlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nSWYjdXNhZ2VfYW5pbWF0aW9ucyBuZ0lmfSAgICAgICAgICAgICAgICAgfCBlbnRlciBhbmQgbGVhdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdDbGFzcyN1c2FnZV9hbmltYXRpb25zIG5nQ2xhc3N9ICAgICAgICAgICB8IGFkZCBhbmQgcmVtb3ZlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ1Nob3cjdXNhZ2VfYW5pbWF0aW9ucyBuZ1Nob3cgJiBuZ0hpZGV9ICAgIHwgYWRkIGFuZCByZW1vdmUgKHRoZSBuZy1oaWRlIGNsYXNzIHZhbHVlKSAgICAgICAgICAgfFxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOmZvcm0jdXNhZ2VfYW5pbWF0aW9ucyBmb3JtfSAgICAgICAgICAgICAgICAgfCBhZGQgYW5kIHJlbW92ZSAoZGlydHksIHByaXN0aW5lLCB2YWxpZCwgaW52YWxpZCAmIGFsbCBvdGhlciB2YWxpZGF0aW9ucykgICAgICAgICAgICAgICAgfFxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nTW9kZWwjdXNhZ2VfYW5pbWF0aW9ucyBuZ01vZGVsfSAgICAgICAgICAgfCBhZGQgYW5kIHJlbW92ZSAoZGlydHksIHByaXN0aW5lLCB2YWxpZCwgaW52YWxpZCAmIGFsbCBvdGhlciB2YWxpZGF0aW9ucykgICAgICAgICAgICAgICAgfFxuICpcbiAqIFlvdSBjYW4gZmluZCBvdXQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBhbmltYXRpb25zIHVwb24gdmlzaXRpbmcgZWFjaCBkaXJlY3RpdmUgcGFnZS5cbiAqXG4gKiBCZWxvdyBpcyBhbiBleGFtcGxlIG9mIGhvdyB0byBhcHBseSBhbmltYXRpb25zIHRvIGEgZGlyZWN0aXZlIHRoYXQgc3VwcG9ydHMgYW5pbWF0aW9uIGhvb2tzOlxuICpcbiAqIGBgYGh0bWxcbiAqIDxzdHlsZSB0eXBlPVwidGV4dC9jc3NcIj5cbiAqIC5zbGlkZS5uZy1lbnRlciwgLnNsaWRlLm5nLWxlYXZlIHtcbiAqICAgLXdlYmtpdC10cmFuc2l0aW9uOjAuNXMgbGluZWFyIGFsbDtcbiAqICAgdHJhbnNpdGlvbjowLjVzIGxpbmVhciBhbGw7XG4gKiB9XG4gKlxuICogLnNsaWRlLm5nLWVudGVyIHsgfSAgICAgICAgLyYjNDI7IHN0YXJ0aW5nIGFuaW1hdGlvbnMgZm9yIGVudGVyICYjNDI7L1xuICogLnNsaWRlLm5nLWVudGVyLWFjdGl2ZSB7IH0gLyYjNDI7IHRlcm1pbmFsIGFuaW1hdGlvbnMgZm9yIGVudGVyICYjNDI7L1xuICogLnNsaWRlLm5nLWxlYXZlIHsgfSAgICAgICAgLyYjNDI7IHN0YXJ0aW5nIGFuaW1hdGlvbnMgZm9yIGxlYXZlICYjNDI7L1xuICogLnNsaWRlLm5nLWxlYXZlLWFjdGl2ZSB7IH0gLyYjNDI7IHRlcm1pbmFsIGFuaW1hdGlvbnMgZm9yIGxlYXZlICYjNDI7L1xuICogPC9zdHlsZT5cbiAqXG4gKiA8IS0tXG4gKiB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHdpbGwgYXV0b21hdGljYWxseSBhZGQgLm5nLWVudGVyIGFuZCAubmctbGVhdmUgdG8gdGhlIGVsZW1lbnRcbiAqIHRvIHRyaWdnZXIgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbnNcbiAqIC0tPlxuICogPEFOWSBjbGFzcz1cInNsaWRlXCIgbmctaW5jbHVkZT1cIi4uLlwiPjwvQU5ZPlxuICogYGBgXG4gKlxuICogS2VlcCBpbiBtaW5kIHRoYXQgaWYgYW4gYW5pbWF0aW9uIGlzIHJ1bm5pbmcsIGFueSBjaGlsZCBlbGVtZW50cyBjYW5ub3QgYmUgYW5pbWF0ZWQgdW50aWwgdGhlIHBhcmVudCBlbGVtZW50J3NcbiAqIGFuaW1hdGlvbiBoYXMgY29tcGxldGVkLlxuICpcbiAqIDxoMj5DU1MtZGVmaW5lZCBBbmltYXRpb25zPC9oMj5cbiAqIFRoZSBhbmltYXRlIHNlcnZpY2Ugd2lsbCBhdXRvbWF0aWNhbGx5IGFwcGx5IHR3byBDU1MgY2xhc3NlcyB0byB0aGUgYW5pbWF0ZWQgZWxlbWVudCBhbmQgdGhlc2UgdHdvIENTUyBjbGFzc2VzXG4gKiBhcmUgZGVzaWduZWQgdG8gY29udGFpbiB0aGUgc3RhcnQgYW5kIGVuZCBDU1Mgc3R5bGluZy4gQm90aCBDU1MgdHJhbnNpdGlvbnMgYW5kIGtleWZyYW1lIGFuaW1hdGlvbnMgYXJlIHN1cHBvcnRlZFxuICogYW5kIGNhbiBiZSB1c2VkIHRvIHBsYXkgYWxvbmcgd2l0aCB0aGlzIG5hbWluZyBzdHJ1Y3R1cmUuXG4gKlxuICogVGhlIGZvbGxvd2luZyBjb2RlIGJlbG93IGRlbW9uc3RyYXRlcyBob3cgdG8gcGVyZm9ybSBhbmltYXRpb25zIHVzaW5nICoqQ1NTIHRyYW5zaXRpb25zKiogd2l0aCBBbmd1bGFyOlxuICpcbiAqIGBgYGh0bWxcbiAqIDxzdHlsZSB0eXBlPVwidGV4dC9jc3NcIj5cbiAqIC8mIzQyO1xuICogIFRoZSBhbmltYXRlIGNsYXNzIGlzIGFwYXJ0IG9mIHRoZSBlbGVtZW50IGFuZCB0aGUgbmctZW50ZXIgY2xhc3NcbiAqICBpcyBhdHRhY2hlZCB0byB0aGUgZWxlbWVudCBvbmNlIHRoZSBlbnRlciBhbmltYXRpb24gZXZlbnQgaXMgdHJpZ2dlcmVkXG4gKiAmIzQyOy9cbiAqIC5yZXZlYWwtYW5pbWF0aW9uLm5nLWVudGVyIHtcbiAqICAtd2Via2l0LXRyYW5zaXRpb246IDFzIGxpbmVhciBhbGw7IC8mIzQyOyBTYWZhcmkvQ2hyb21lICYjNDI7L1xuICogIHRyYW5zaXRpb246IDFzIGxpbmVhciBhbGw7IC8mIzQyOyBBbGwgb3RoZXIgbW9kZXJuIGJyb3dzZXJzIGFuZCBJRTEwKyAmIzQyOy9cbiAqXG4gKiAgLyYjNDI7IFRoZSBhbmltYXRpb24gcHJlcGFyYXRpb24gY29kZSAmIzQyOy9cbiAqICBvcGFjaXR5OiAwO1xuICogfVxuICpcbiAqIC8mIzQyO1xuICogIEtlZXAgaW4gbWluZCB0aGF0IHlvdSB3YW50IHRvIGNvbWJpbmUgYm90aCBDU1NcbiAqICBjbGFzc2VzIHRvZ2V0aGVyIHRvIGF2b2lkIGFueSBDU1Mtc3BlY2lmaWNpdHlcbiAqICBjb25mbGljdHNcbiAqICYjNDI7L1xuICogLnJldmVhbC1hbmltYXRpb24ubmctZW50ZXIubmctZW50ZXItYWN0aXZlIHtcbiAqICAvJiM0MjsgVGhlIGFuaW1hdGlvbiBjb2RlIGl0c2VsZiAmIzQyOy9cbiAqICBvcGFjaXR5OiAxO1xuICogfVxuICogPC9zdHlsZT5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwidmlldy1jb250YWluZXJcIj5cbiAqICAgPGRpdiBuZy12aWV3IGNsYXNzPVwicmV2ZWFsLWFuaW1hdGlvblwiPjwvZGl2PlxuICogPC9kaXY+XG4gKiBgYGBcbiAqXG4gKiBUaGUgZm9sbG93aW5nIGNvZGUgYmVsb3cgZGVtb25zdHJhdGVzIGhvdyB0byBwZXJmb3JtIGFuaW1hdGlvbnMgdXNpbmcgKipDU1MgYW5pbWF0aW9ucyoqIHdpdGggQW5ndWxhcjpcbiAqXG4gKiBgYGBodG1sXG4gKiA8c3R5bGUgdHlwZT1cInRleHQvY3NzXCI+XG4gKiAucmV2ZWFsLWFuaW1hdGlvbi5uZy1lbnRlciB7XG4gKiAgIC13ZWJraXQtYW5pbWF0aW9uOiBlbnRlcl9zZXF1ZW5jZSAxcyBsaW5lYXI7IC8mIzQyOyBTYWZhcmkvQ2hyb21lICYjNDI7L1xuICogICBhbmltYXRpb246IGVudGVyX3NlcXVlbmNlIDFzIGxpbmVhcjsgLyYjNDI7IElFMTArIGFuZCBGdXR1cmUgQnJvd3NlcnMgJiM0MjsvXG4gKiB9XG4gKiBALXdlYmtpdC1rZXlmcmFtZXMgZW50ZXJfc2VxdWVuY2Uge1xuICogICBmcm9tIHsgb3BhY2l0eTowOyB9XG4gKiAgIHRvIHsgb3BhY2l0eToxOyB9XG4gKiB9XG4gKiBAa2V5ZnJhbWVzIGVudGVyX3NlcXVlbmNlIHtcbiAqICAgZnJvbSB7IG9wYWNpdHk6MDsgfVxuICogICB0byB7IG9wYWNpdHk6MTsgfVxuICogfVxuICogPC9zdHlsZT5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwidmlldy1jb250YWluZXJcIj5cbiAqICAgPGRpdiBuZy12aWV3IGNsYXNzPVwicmV2ZWFsLWFuaW1hdGlvblwiPjwvZGl2PlxuICogPC9kaXY+XG4gKiBgYGBcbiAqXG4gKiBCb3RoIENTUzMgYW5pbWF0aW9ucyBhbmQgdHJhbnNpdGlvbnMgY2FuIGJlIHVzZWQgdG9nZXRoZXIgYW5kIHRoZSBhbmltYXRlIHNlcnZpY2Ugd2lsbCBmaWd1cmUgb3V0IHRoZSBjb3JyZWN0IGR1cmF0aW9uIGFuZCBkZWxheSB0aW1pbmcuXG4gKlxuICogVXBvbiBET00gbXV0YXRpb24sIHRoZSBldmVudCBjbGFzcyBpcyBhZGRlZCBmaXJzdCAoc29tZXRoaW5nIGxpa2UgYG5nLWVudGVyYCksIHRoZW4gdGhlIGJyb3dzZXIgcHJlcGFyZXMgaXRzZWxmIHRvIGFkZFxuICogdGhlIGFjdGl2ZSBjbGFzcyAoaW4gdGhpcyBjYXNlIGBuZy1lbnRlci1hY3RpdmVgKSB3aGljaCB0aGVuIHRyaWdnZXJzIHRoZSBhbmltYXRpb24uIFRoZSBhbmltYXRpb24gbW9kdWxlIHdpbGwgYXV0b21hdGljYWxseVxuICogZGV0ZWN0IHRoZSBDU1MgY29kZSB0byBkZXRlcm1pbmUgd2hlbiB0aGUgYW5pbWF0aW9uIGVuZHMuIE9uY2UgdGhlIGFuaW1hdGlvbiBpcyBvdmVyIHRoZW4gYm90aCBDU1MgY2xhc3NlcyB3aWxsIGJlXG4gKiByZW1vdmVkIGZyb20gdGhlIERPTS4gSWYgYSBicm93c2VyIGRvZXMgbm90IHN1cHBvcnQgQ1NTIHRyYW5zaXRpb25zIG9yIENTUyBhbmltYXRpb25zIHRoZW4gdGhlIGFuaW1hdGlvbiB3aWxsIHN0YXJ0IGFuZCBlbmRcbiAqIGltbWVkaWF0ZWx5IHJlc3VsdGluZyBpbiBhIERPTSBlbGVtZW50IHRoYXQgaXMgYXQgaXRzIGZpbmFsIHN0YXRlLiBUaGlzIGZpbmFsIHN0YXRlIGlzIHdoZW4gdGhlIERPTSBlbGVtZW50XG4gKiBoYXMgbm8gQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uIGNsYXNzZXMgYXBwbGllZCB0byBpdC5cbiAqXG4gKiA8aDM+Q1NTIFN0YWdnZXJpbmcgQW5pbWF0aW9uczwvaDM+XG4gKiBBIFN0YWdnZXJpbmcgYW5pbWF0aW9uIGlzIGEgY29sbGVjdGlvbiBvZiBhbmltYXRpb25zIHRoYXQgYXJlIGlzc3VlZCB3aXRoIGEgc2xpZ2h0IGRlbGF5IGluIGJldHdlZW4gZWFjaCBzdWNjZXNzaXZlIG9wZXJhdGlvbiByZXN1bHRpbmcgaW4gYVxuICogY3VydGFpbi1saWtlIGVmZmVjdC4gVGhlIG5nQW5pbWF0ZSBtb2R1bGUsIGFzIG9mIDEuMi4wLCBzdXBwb3J0cyBzdGFnZ2VyaW5nIGFuaW1hdGlvbnMgYW5kIHRoZSBzdGFnZ2VyIGVmZmVjdCBjYW4gYmVcbiAqIHBlcmZvcm1lZCBieSBjcmVhdGluZyBhICoqbmctRVZFTlQtc3RhZ2dlcioqIENTUyBjbGFzcyBhbmQgYXR0YWNoaW5nIHRoYXQgY2xhc3MgdG8gdGhlIGJhc2UgQ1NTIGNsYXNzIHVzZWQgZm9yXG4gKiB0aGUgYW5pbWF0aW9uLiBUaGUgc3R5bGUgcHJvcGVydHkgZXhwZWN0ZWQgd2l0aGluIHRoZSBzdGFnZ2VyIGNsYXNzIGNhbiBlaXRoZXIgYmUgYSAqKnRyYW5zaXRpb24tZGVsYXkqKiBvciBhblxuICogKiphbmltYXRpb24tZGVsYXkqKiBwcm9wZXJ0eSAob3IgYm90aCBpZiB5b3VyIGFuaW1hdGlvbiBjb250YWlucyBib3RoIHRyYW5zaXRpb25zIGFuZCBrZXlmcmFtZSBhbmltYXRpb25zKS5cbiAqXG4gKiBgYGBjc3NcbiAqIC5teS1hbmltYXRpb24ubmctZW50ZXIge1xuICogICAvJiM0Mjsgc3RhbmRhcmQgdHJhbnNpdGlvbiBjb2RlICYjNDI7L1xuICogICAtd2Via2l0LXRyYW5zaXRpb246IDFzIGxpbmVhciBhbGw7XG4gKiAgIHRyYW5zaXRpb246IDFzIGxpbmVhciBhbGw7XG4gKiAgIG9wYWNpdHk6MDtcbiAqIH1cbiAqIC5teS1hbmltYXRpb24ubmctZW50ZXItc3RhZ2dlciB7XG4gKiAgIC8mIzQyOyB0aGlzIHdpbGwgaGF2ZSBhIDEwMG1zIGRlbGF5IGJldHdlZW4gZWFjaCBzdWNjZXNzaXZlIGxlYXZlIGFuaW1hdGlvbiAmIzQyOy9cbiAqICAgLXdlYmtpdC10cmFuc2l0aW9uLWRlbGF5OiAwLjFzO1xuICogICB0cmFuc2l0aW9uLWRlbGF5OiAwLjFzO1xuICpcbiAqICAgLyYjNDI7IGluIGNhc2UgdGhlIHN0YWdnZXIgZG9lc24ndCB3b3JrIHRoZW4gdGhlc2UgdHdvIHZhbHVlc1xuICogICAgbXVzdCBiZSBzZXQgdG8gMCB0byBhdm9pZCBhbiBhY2NpZGVudGFsIENTUyBpbmhlcml0YW5jZSAmIzQyOy9cbiAqICAgLXdlYmtpdC10cmFuc2l0aW9uLWR1cmF0aW9uOiAwcztcbiAqICAgdHJhbnNpdGlvbi1kdXJhdGlvbjogMHM7XG4gKiB9XG4gKiAubXktYW5pbWF0aW9uLm5nLWVudGVyLm5nLWVudGVyLWFjdGl2ZSB7XG4gKiAgIC8mIzQyOyBzdGFuZGFyZCB0cmFuc2l0aW9uIHN0eWxlcyAmIzQyOy9cbiAqICAgb3BhY2l0eToxO1xuICogfVxuICogYGBgXG4gKlxuICogU3RhZ2dlcmluZyBhbmltYXRpb25zIHdvcmsgYnkgZGVmYXVsdCBpbiBuZ1JlcGVhdCAoc28gbG9uZyBhcyB0aGUgQ1NTIGNsYXNzIGlzIGRlZmluZWQpLiBPdXRzaWRlIG9mIG5nUmVwZWF0LCB0byB1c2Ugc3RhZ2dlcmluZyBhbmltYXRpb25zXG4gKiBvbiB5b3VyIG93biwgdGhleSBjYW4gYmUgdHJpZ2dlcmVkIGJ5IGZpcmluZyBtdWx0aXBsZSBjYWxscyB0byB0aGUgc2FtZSBldmVudCBvbiAkYW5pbWF0ZS4gSG93ZXZlciwgdGhlIHJlc3RyaWN0aW9ucyBzdXJyb3VuZGluZyB0aGlzXG4gKiBhcmUgdGhhdCBlYWNoIG9mIHRoZSBlbGVtZW50cyBtdXN0IGhhdmUgdGhlIHNhbWUgQ1NTIGNsYXNzTmFtZSB2YWx1ZSBhcyB3ZWxsIGFzIHRoZSBzYW1lIHBhcmVudCBlbGVtZW50LiBBIHN0YWdnZXIgb3BlcmF0aW9uXG4gKiB3aWxsIGFsc28gYmUgcmVzZXQgaWYgbW9yZSB0aGFuIDEwbXMgaGFzIHBhc3NlZCBhZnRlciB0aGUgbGFzdCBhbmltYXRpb24gaGFzIGJlZW4gZmlyZWQuXG4gKlxuICogVGhlIGZvbGxvd2luZyBjb2RlIHdpbGwgaXNzdWUgdGhlICoqbmctbGVhdmUtc3RhZ2dlcioqIGV2ZW50IG9uIHRoZSBlbGVtZW50IHByb3ZpZGVkOlxuICpcbiAqIGBgYGpzXG4gKiB2YXIga2lkcyA9IHBhcmVudC5jaGlsZHJlbigpO1xuICpcbiAqICRhbmltYXRlLmxlYXZlKGtpZHNbMF0pOyAvL3N0YWdnZXIgaW5kZXg9MFxuICogJGFuaW1hdGUubGVhdmUoa2lkc1sxXSk7IC8vc3RhZ2dlciBpbmRleD0xXG4gKiAkYW5pbWF0ZS5sZWF2ZShraWRzWzJdKTsgLy9zdGFnZ2VyIGluZGV4PTJcbiAqICRhbmltYXRlLmxlYXZlKGtpZHNbM10pOyAvL3N0YWdnZXIgaW5kZXg9M1xuICogJGFuaW1hdGUubGVhdmUoa2lkc1s0XSk7IC8vc3RhZ2dlciBpbmRleD00XG4gKlxuICogJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gKiAgIC8vc3RhZ2dlciBoYXMgcmVzZXQgaXRzZWxmXG4gKiAgICRhbmltYXRlLmxlYXZlKGtpZHNbNV0pOyAvL3N0YWdnZXIgaW5kZXg9MFxuICogICAkYW5pbWF0ZS5sZWF2ZShraWRzWzZdKTsgLy9zdGFnZ2VyIGluZGV4PTFcbiAqIH0sIDEwMCwgZmFsc2UpO1xuICogYGBgXG4gKlxuICogU3RhZ2dlciBhbmltYXRpb25zIGFyZSBjdXJyZW50bHkgb25seSBzdXBwb3J0ZWQgd2l0aGluIENTUy1kZWZpbmVkIGFuaW1hdGlvbnMuXG4gKlxuICogPGgyPkphdmFTY3JpcHQtZGVmaW5lZCBBbmltYXRpb25zPC9oMj5cbiAqIEluIHRoZSBldmVudCB0aGF0IHlvdSBkbyBub3Qgd2FudCB0byB1c2UgQ1NTMyB0cmFuc2l0aW9ucyBvciBDU1MzIGFuaW1hdGlvbnMgb3IgaWYgeW91IHdpc2ggdG8gb2ZmZXIgYW5pbWF0aW9ucyBvbiBicm93c2VycyB0aGF0IGRvIG5vdFxuICogeWV0IHN1cHBvcnQgQ1NTIHRyYW5zaXRpb25zL2FuaW1hdGlvbnMsIHRoZW4geW91IGNhbiBtYWtlIHVzZSBvZiBKYXZhU2NyaXB0IGFuaW1hdGlvbnMgZGVmaW5lZCBpbnNpZGUgb2YgeW91ciBBbmd1bGFySlMgbW9kdWxlLlxuICpcbiAqIGBgYGpzXG4gKiAvLyFhbm5vdGF0ZT1cIllvdXJBcHBcIiBZb3VyIEFuZ3VsYXJKUyBNb2R1bGV8UmVwbGFjZSB0aGlzIG9yIG5nTW9kdWxlIHdpdGggdGhlIG1vZHVsZSB0aGF0IHlvdSB1c2VkIHRvIGRlZmluZSB5b3VyIGFwcGxpY2F0aW9uLlxuICogdmFyIG5nTW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ1lvdXJBcHAnLCBbJ25nQW5pbWF0ZSddKTtcbiAqIG5nTW9kdWxlLmFuaW1hdGlvbignLm15LWNyYXp5LWFuaW1hdGlvbicsIGZ1bmN0aW9uKCkge1xuICogICByZXR1cm4ge1xuICogICAgIGVudGVyOiBmdW5jdGlvbihlbGVtZW50LCBkb25lKSB7XG4gKiAgICAgICAvL3J1biB0aGUgYW5pbWF0aW9uIGhlcmUgYW5kIGNhbGwgZG9uZSB3aGVuIHRoZSBhbmltYXRpb24gaXMgY29tcGxldGVcbiAqICAgICAgIHJldHVybiBmdW5jdGlvbihjYW5jZWxsZWQpIHtcbiAqICAgICAgICAgLy90aGlzIChvcHRpb25hbCkgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgYW5pbWF0aW9uXG4gKiAgICAgICAgIC8vY29tcGxldGVzIG9yIHdoZW4gdGhlIGFuaW1hdGlvbiBpcyBjYW5jZWxsZWQgKHRoZSBjYW5jZWxsZWRcbiAqICAgICAgICAgLy9mbGFnIHdpbGwgYmUgc2V0IHRvIHRydWUgaWYgY2FuY2VsbGVkKS5cbiAqICAgICAgIH07XG4gKiAgICAgfSxcbiAqICAgICBsZWF2ZTogZnVuY3Rpb24oZWxlbWVudCwgZG9uZSkgeyB9LFxuICogICAgIG1vdmU6IGZ1bmN0aW9uKGVsZW1lbnQsIGRvbmUpIHsgfSxcbiAqXG4gKiAgICAgLy9hbmltYXRpb24gdGhhdCBjYW4gYmUgdHJpZ2dlcmVkIGJlZm9yZSB0aGUgY2xhc3MgaXMgYWRkZWRcbiAqICAgICBiZWZvcmVBZGRDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7IH0sXG4gKlxuICogICAgIC8vYW5pbWF0aW9uIHRoYXQgY2FuIGJlIHRyaWdnZXJlZCBhZnRlciB0aGUgY2xhc3MgaXMgYWRkZWRcbiAqICAgICBhZGRDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7IH0sXG4gKlxuICogICAgIC8vYW5pbWF0aW9uIHRoYXQgY2FuIGJlIHRyaWdnZXJlZCBiZWZvcmUgdGhlIGNsYXNzIGlzIHJlbW92ZWRcbiAqICAgICBiZWZvcmVSZW1vdmVDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7IH0sXG4gKlxuICogICAgIC8vYW5pbWF0aW9uIHRoYXQgY2FuIGJlIHRyaWdnZXJlZCBhZnRlciB0aGUgY2xhc3MgaXMgcmVtb3ZlZFxuICogICAgIHJlbW92ZUNsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpIHsgfVxuICogICB9O1xuICogfSk7XG4gKiBgYGBcbiAqXG4gKiBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyBhcmUgY3JlYXRlZCB3aXRoIGEgQ1NTLWxpa2UgY2xhc3Mgc2VsZWN0b3IgYW5kIGEgY29sbGVjdGlvbiBvZiBldmVudHMgd2hpY2ggYXJlIHNldCB0byBydW5cbiAqIGEgamF2YXNjcmlwdCBjYWxsYmFjayBmdW5jdGlvbi4gV2hlbiBhbiBhbmltYXRpb24gaXMgdHJpZ2dlcmVkLCAkYW5pbWF0ZSB3aWxsIGxvb2sgZm9yIGEgbWF0Y2hpbmcgYW5pbWF0aW9uIHdoaWNoIGZpdHNcbiAqIHRoZSBlbGVtZW50J3MgQ1NTIGNsYXNzIGF0dHJpYnV0ZSB2YWx1ZSBhbmQgdGhlbiBydW4gdGhlIG1hdGNoaW5nIGFuaW1hdGlvbiBldmVudCBmdW5jdGlvbiAoaWYgZm91bmQpLlxuICogSW4gb3RoZXIgd29yZHMsIGlmIHRoZSBDU1MgY2xhc3NlcyBwcmVzZW50IG9uIHRoZSBhbmltYXRlZCBlbGVtZW50IG1hdGNoIGFueSBvZiB0aGUgSmF2YVNjcmlwdCBhbmltYXRpb25zIHRoZW4gdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIHdpbGxcbiAqIGJlIGV4ZWN1dGVkLiBJdCBzaG91bGQgYmUgYWxzbyBub3RlZCB0aGF0IG9ubHkgc2ltcGxlLCBzaW5nbGUgY2xhc3Mgc2VsZWN0b3JzIGFyZSBhbGxvd2VkIChjb21wb3VuZCBjbGFzcyBzZWxlY3RvcnMgYXJlIG5vdCBzdXBwb3J0ZWQpLlxuICpcbiAqIFdpdGhpbiBhIEphdmFTY3JpcHQgYW5pbWF0aW9uLCBhbiBvYmplY3QgY29udGFpbmluZyB2YXJpb3VzIGV2ZW50IGNhbGxiYWNrIGFuaW1hdGlvbiBmdW5jdGlvbnMgaXMgZXhwZWN0ZWQgdG8gYmUgcmV0dXJuZWQuXG4gKiBBcyBleHBsYWluZWQgYWJvdmUsIHRoZXNlIGNhbGxiYWNrcyBhcmUgdHJpZ2dlcmVkIGJhc2VkIG9uIHRoZSBhbmltYXRpb24gZXZlbnQuIFRoZXJlZm9yZSBpZiBhbiBlbnRlciBhbmltYXRpb24gaXMgcnVuLFxuICogYW5kIHRoZSBKYXZhU2NyaXB0IGFuaW1hdGlvbiBpcyBmb3VuZCwgdGhlbiB0aGUgZW50ZXIgY2FsbGJhY2sgd2lsbCBoYW5kbGUgdGhhdCBhbmltYXRpb24gKGluIGFkZGl0aW9uIHRvIHRoZSBDU1Mga2V5ZnJhbWUgYW5pbWF0aW9uXG4gKiBvciB0cmFuc2l0aW9uIGNvZGUgdGhhdCBpcyBkZWZpbmVkIHZpYSBhIHN0eWxlc2hlZXQpLlxuICpcbiAqL1xuXG5hbmd1bGFyLm1vZHVsZSgnbmdBbmltYXRlJywgWyduZyddKVxuXG4gIC8qKlxuICAgKiBAbmdkb2MgcHJvdmlkZXJcbiAgICogQG5hbWUgJGFuaW1hdGVQcm92aWRlclxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogVGhlIGAkYW5pbWF0ZVByb3ZpZGVyYCBhbGxvd3MgZGV2ZWxvcGVycyB0byByZWdpc3RlciBKYXZhU2NyaXB0IGFuaW1hdGlvbiBldmVudCBoYW5kbGVycyBkaXJlY3RseSBpbnNpZGUgb2YgYSBtb2R1bGUuXG4gICAqIFdoZW4gYW4gYW5pbWF0aW9uIGlzIHRyaWdnZXJlZCwgdGhlICRhbmltYXRlIHNlcnZpY2Ugd2lsbCBxdWVyeSB0aGUgJGFuaW1hdGUgc2VydmljZSB0byBmaW5kIGFueSBhbmltYXRpb25zIHRoYXQgbWF0Y2hcbiAgICogdGhlIHByb3ZpZGVkIG5hbWUgdmFsdWUuXG4gICAqXG4gICAqIFJlcXVpcmVzIHRoZSB7QGxpbmsgbmdBbmltYXRlIGBuZ0FuaW1hdGVgfSBtb2R1bGUgdG8gYmUgaW5zdGFsbGVkLlxuICAgKlxuICAgKiBQbGVhc2UgdmlzaXQgdGhlIHtAbGluayBuZ0FuaW1hdGUgYG5nQW5pbWF0ZWB9IG1vZHVsZSBvdmVydmlldyBwYWdlIGxlYXJuIG1vcmUgYWJvdXQgaG93IHRvIHVzZSBhbmltYXRpb25zIGluIHlvdXIgYXBwbGljYXRpb24uXG4gICAqXG4gICAqL1xuXG4gIC8vdGhpcyBwcml2YXRlIHNlcnZpY2UgaXMgb25seSB1c2VkIHdpdGhpbiBDU1MtZW5hYmxlZCBhbmltYXRpb25zXG4gIC8vSUU4ICsgSUU5IGRvIG5vdCBzdXBwb3J0IHJBRiBuYXRpdmVseSwgYnV0IHRoYXQgaXMgZmluZSBzaW5jZSB0aGV5XG4gIC8vYWxzbyBkb24ndCBzdXBwb3J0IHRyYW5zaXRpb25zIGFuZCBrZXlmcmFtZXMgd2hpY2ggbWVhbnMgdGhhdCB0aGUgY29kZVxuICAvL2JlbG93IHdpbGwgbmV2ZXIgYmUgdXNlZCBieSB0aGUgdHdvIGJyb3dzZXJzLlxuICAuZmFjdG9yeSgnJCRhbmltYXRlUmVmbG93JywgWyckJHJBRicsICckZG9jdW1lbnQnLCBmdW5jdGlvbigkJHJBRiwgJGRvY3VtZW50KSB7XG4gICAgdmFyIGJvZCA9ICRkb2N1bWVudFswXS5ib2R5O1xuICAgIHJldHVybiBmdW5jdGlvbihmbikge1xuICAgICAgLy90aGUgcmV0dXJuZWQgZnVuY3Rpb24gYWN0cyBhcyB0aGUgY2FuY2VsbGF0aW9uIGZ1bmN0aW9uXG4gICAgICByZXR1cm4gJCRyQUYoZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vdGhlIGxpbmUgYmVsb3cgd2lsbCBmb3JjZSB0aGUgYnJvd3NlciB0byBwZXJmb3JtIGEgcmVwYWludFxuICAgICAgICAvL3NvIHRoYXQgYWxsIHRoZSBhbmltYXRlZCBlbGVtZW50cyB3aXRoaW4gdGhlIGFuaW1hdGlvbiBmcmFtZVxuICAgICAgICAvL3dpbGwgYmUgcHJvcGVybHkgdXBkYXRlZCBhbmQgZHJhd24gb24gc2NyZWVuLiBUaGlzIGlzXG4gICAgICAgIC8vcmVxdWlyZWQgdG8gcGVyZm9ybSBtdWx0aS1jbGFzcyBDU1MgYmFzZWQgYW5pbWF0aW9ucyB3aXRoXG4gICAgICAgIC8vRmlyZWZveC4gRE8gTk9UIFJFTU9WRSBUSElTIExJTkUuXG4gICAgICAgIHZhciBhID0gYm9kLm9mZnNldFdpZHRoICsgMTtcbiAgICAgICAgZm4oKTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH1dKVxuXG4gIC5jb25maWcoWyckcHJvdmlkZScsICckYW5pbWF0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHByb3ZpZGUsICRhbmltYXRlUHJvdmlkZXIpIHtcbiAgICB2YXIgbm9vcCA9IGFuZ3VsYXIubm9vcDtcbiAgICB2YXIgZm9yRWFjaCA9IGFuZ3VsYXIuZm9yRWFjaDtcbiAgICB2YXIgc2VsZWN0b3JzID0gJGFuaW1hdGVQcm92aWRlci4kJHNlbGVjdG9ycztcblxuICAgIHZhciBFTEVNRU5UX05PREUgPSAxO1xuICAgIHZhciBOR19BTklNQVRFX1NUQVRFID0gJyQkbmdBbmltYXRlU3RhdGUnO1xuICAgIHZhciBOR19BTklNQVRFX0NMQVNTX05BTUUgPSAnbmctYW5pbWF0ZSc7XG4gICAgdmFyIHJvb3RBbmltYXRlU3RhdGUgPSB7cnVubmluZzogdHJ1ZX07XG5cbiAgICBmdW5jdGlvbiBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCkge1xuICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGVsZW1lbnQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGVsbSA9IGVsZW1lbnRbaV07XG4gICAgICAgIGlmKGVsbS5ub2RlVHlwZSA9PSBFTEVNRU5UX05PREUpIHtcbiAgICAgICAgICByZXR1cm4gZWxtO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RyaXBDb21tZW50c0Zyb21FbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgIHJldHVybiBhbmd1bGFyLmVsZW1lbnQoZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc01hdGNoaW5nRWxlbWVudChlbG0xLCBlbG0yKSB7XG4gICAgICByZXR1cm4gZXh0cmFjdEVsZW1lbnROb2RlKGVsbTEpID09IGV4dHJhY3RFbGVtZW50Tm9kZShlbG0yKTtcbiAgICB9XG5cbiAgICAkcHJvdmlkZS5kZWNvcmF0b3IoJyRhbmltYXRlJywgWyckZGVsZWdhdGUnLCAnJGluamVjdG9yJywgJyRzbmlmZmVyJywgJyRyb290RWxlbWVudCcsICckJGFzeW5jQ2FsbGJhY2snLCAnJHJvb3RTY29wZScsICckZG9jdW1lbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCRkZWxlZ2F0ZSwgICAkaW5qZWN0b3IsICAgJHNuaWZmZXIsICAgJHJvb3RFbGVtZW50LCAgICQkYXN5bmNDYWxsYmFjaywgICAgJHJvb3RTY29wZSwgICAkZG9jdW1lbnQpIHtcblxuICAgICAgdmFyIGdsb2JhbEFuaW1hdGlvbkNvdW50ZXIgPSAwO1xuICAgICAgJHJvb3RFbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSwgcm9vdEFuaW1hdGVTdGF0ZSk7XG5cbiAgICAgIC8vIGRpc2FibGUgYW5pbWF0aW9ucyBkdXJpbmcgYm9vdHN0cmFwLCBidXQgb25jZSB3ZSBib290c3RyYXBwZWQsIHdhaXQgYWdhaW5cbiAgICAgIC8vIGZvciBhbm90aGVyIGRpZ2VzdCB1bnRpbCBlbmFibGluZyBhbmltYXRpb25zLiBUaGUgcmVhc29uIHdoeSB3ZSBkaWdlc3QgdHdpY2VcbiAgICAgIC8vIGlzIGJlY2F1c2UgYWxsIHN0cnVjdHVyYWwgYW5pbWF0aW9ucyAoZW50ZXIsIGxlYXZlIGFuZCBtb3ZlKSBhbGwgcGVyZm9ybSBhXG4gICAgICAvLyBwb3N0IGRpZ2VzdCBvcGVyYXRpb24gYmVmb3JlIGFuaW1hdGluZy4gSWYgd2Ugb25seSB3YWl0IGZvciBhIHNpbmdsZSBkaWdlc3RcbiAgICAgIC8vIHRvIHBhc3MgdGhlbiB0aGUgc3RydWN0dXJhbCBhbmltYXRpb24gd291bGQgcmVuZGVyIGl0cyBhbmltYXRpb24gb24gcGFnZSBsb2FkLlxuICAgICAgLy8gKHdoaWNoIGlzIHdoYXQgd2UncmUgdHJ5aW5nIHRvIGF2b2lkIHdoZW4gdGhlIGFwcGxpY2F0aW9uIGZpcnN0IGJvb3RzIHVwLilcbiAgICAgICRyb290U2NvcGUuJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCkge1xuICAgICAgICAkcm9vdFNjb3BlLiQkcG9zdERpZ2VzdChmdW5jdGlvbigpIHtcbiAgICAgICAgICByb290QW5pbWF0ZVN0YXRlLnJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgdmFyIGNsYXNzTmFtZUZpbHRlciA9ICRhbmltYXRlUHJvdmlkZXIuY2xhc3NOYW1lRmlsdGVyKCk7XG4gICAgICB2YXIgaXNBbmltYXRhYmxlQ2xhc3NOYW1lID0gIWNsYXNzTmFtZUZpbHRlclxuICAgICAgICAgICAgICA/IGZ1bmN0aW9uKCkgeyByZXR1cm4gdHJ1ZTsgfVxuICAgICAgICAgICAgICA6IGZ1bmN0aW9uKGNsYXNzTmFtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjbGFzc05hbWVGaWx0ZXIudGVzdChjbGFzc05hbWUpO1xuICAgICAgICAgICAgICB9O1xuXG4gICAgICBmdW5jdGlvbiBsb29rdXAobmFtZSkge1xuICAgICAgICBpZiAobmFtZSkge1xuICAgICAgICAgIHZhciBtYXRjaGVzID0gW10sXG4gICAgICAgICAgICAgIGZsYWdNYXAgPSB7fSxcbiAgICAgICAgICAgICAgY2xhc3NlcyA9IG5hbWUuc3Vic3RyKDEpLnNwbGl0KCcuJyk7XG5cbiAgICAgICAgICAvL3RoZSBlbXB0eSBzdHJpbmcgdmFsdWUgaXMgdGhlIGRlZmF1bHQgYW5pbWF0aW9uXG4gICAgICAgICAgLy9vcGVyYXRpb24gd2hpY2ggcGVyZm9ybXMgQ1NTIHRyYW5zaXRpb24gYW5kIGtleWZyYW1lXG4gICAgICAgICAgLy9hbmltYXRpb25zIHNuaWZmaW5nLiBUaGlzIGlzIGFsd2F5cyBpbmNsdWRlZCBmb3IgZWFjaFxuICAgICAgICAgIC8vZWxlbWVudCBhbmltYXRpb24gcHJvY2VkdXJlIGlmIHRoZSBicm93c2VyIHN1cHBvcnRzXG4gICAgICAgICAgLy90cmFuc2l0aW9ucyBhbmQvb3Iga2V5ZnJhbWUgYW5pbWF0aW9ucy4gVGhlIGRlZmF1bHRcbiAgICAgICAgICAvL2FuaW1hdGlvbiBpcyBhZGRlZCB0byB0aGUgdG9wIG9mIHRoZSBsaXN0IHRvIHByZXZlbnRcbiAgICAgICAgICAvL2FueSBwcmV2aW91cyBhbmltYXRpb25zIGZyb20gYWZmZWN0aW5nIHRoZSBlbGVtZW50IHN0eWxpbmdcbiAgICAgICAgICAvL3ByaW9yIHRvIHRoZSBlbGVtZW50IGJlaW5nIGFuaW1hdGVkLlxuICAgICAgICAgIGlmICgkc25pZmZlci50cmFuc2l0aW9ucyB8fCAkc25pZmZlci5hbmltYXRpb25zKSB7XG4gICAgICAgICAgICBtYXRjaGVzLnB1c2goJGluamVjdG9yLmdldChzZWxlY3RvcnNbJyddKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZm9yKHZhciBpPTA7IGkgPCBjbGFzc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIga2xhc3MgPSBjbGFzc2VzW2ldLFxuICAgICAgICAgICAgICAgIHNlbGVjdG9yRmFjdG9yeU5hbWUgPSBzZWxlY3RvcnNba2xhc3NdO1xuICAgICAgICAgICAgaWYoc2VsZWN0b3JGYWN0b3J5TmFtZSAmJiAhZmxhZ01hcFtrbGFzc10pIHtcbiAgICAgICAgICAgICAgbWF0Y2hlcy5wdXNoKCRpbmplY3Rvci5nZXQoc2VsZWN0b3JGYWN0b3J5TmFtZSkpO1xuICAgICAgICAgICAgICBmbGFnTWFwW2tsYXNzXSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBtYXRjaGVzO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGlvblJ1bm5lcihlbGVtZW50LCBhbmltYXRpb25FdmVudCwgY2xhc3NOYW1lKSB7XG4gICAgICAgIC8vdHJhbnNjbHVkZWQgZGlyZWN0aXZlcyBtYXkgc29tZXRpbWVzIGZpcmUgYW4gYW5pbWF0aW9uIHVzaW5nIG9ubHkgY29tbWVudCBub2Rlc1xuICAgICAgICAvL2Jlc3QgdG8gY2F0Y2ggdGhpcyBlYXJseSBvbiB0byBwcmV2ZW50IGFueSBhbmltYXRpb24gb3BlcmF0aW9ucyBmcm9tIG9jY3VycmluZ1xuICAgICAgICB2YXIgbm9kZSA9IGVsZW1lbnRbMF07XG4gICAgICAgIGlmKCFub2RlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGlzU2V0Q2xhc3NPcGVyYXRpb24gPSBhbmltYXRpb25FdmVudCA9PSAnc2V0Q2xhc3MnO1xuICAgICAgICB2YXIgaXNDbGFzc0Jhc2VkID0gaXNTZXRDbGFzc09wZXJhdGlvbiB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uRXZlbnQgPT0gJ2FkZENsYXNzJyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uRXZlbnQgPT0gJ3JlbW92ZUNsYXNzJztcblxuICAgICAgICB2YXIgY2xhc3NOYW1lQWRkLCBjbGFzc05hbWVSZW1vdmU7XG4gICAgICAgIGlmKGFuZ3VsYXIuaXNBcnJheShjbGFzc05hbWUpKSB7XG4gICAgICAgICAgY2xhc3NOYW1lQWRkID0gY2xhc3NOYW1lWzBdO1xuICAgICAgICAgIGNsYXNzTmFtZVJlbW92ZSA9IGNsYXNzTmFtZVsxXTtcbiAgICAgICAgICBjbGFzc05hbWUgPSBjbGFzc05hbWVBZGQgKyAnICcgKyBjbGFzc05hbWVSZW1vdmU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgY3VycmVudENsYXNzTmFtZSA9IGVsZW1lbnQuYXR0cignY2xhc3MnKTtcbiAgICAgICAgdmFyIGNsYXNzZXMgPSBjdXJyZW50Q2xhc3NOYW1lICsgJyAnICsgY2xhc3NOYW1lO1xuICAgICAgICBpZighaXNBbmltYXRhYmxlQ2xhc3NOYW1lKGNsYXNzZXMpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGJlZm9yZUNvbXBsZXRlID0gbm9vcCxcbiAgICAgICAgICAgIGJlZm9yZUNhbmNlbCA9IFtdLFxuICAgICAgICAgICAgYmVmb3JlID0gW10sXG4gICAgICAgICAgICBhZnRlckNvbXBsZXRlID0gbm9vcCxcbiAgICAgICAgICAgIGFmdGVyQ2FuY2VsID0gW10sXG4gICAgICAgICAgICBhZnRlciA9IFtdO1xuXG4gICAgICAgIHZhciBhbmltYXRpb25Mb29rdXAgPSAoJyAnICsgY2xhc3NlcykucmVwbGFjZSgvXFxzKy9nLCcuJyk7XG4gICAgICAgIGZvckVhY2gobG9va3VwKGFuaW1hdGlvbkxvb2t1cCksIGZ1bmN0aW9uKGFuaW1hdGlvbkZhY3RvcnkpIHtcbiAgICAgICAgICB2YXIgY3JlYXRlZCA9IHJlZ2lzdGVyQW5pbWF0aW9uKGFuaW1hdGlvbkZhY3RvcnksIGFuaW1hdGlvbkV2ZW50KTtcbiAgICAgICAgICBpZighY3JlYXRlZCAmJiBpc1NldENsYXNzT3BlcmF0aW9uKSB7XG4gICAgICAgICAgICByZWdpc3RlckFuaW1hdGlvbihhbmltYXRpb25GYWN0b3J5LCAnYWRkQ2xhc3MnKTtcbiAgICAgICAgICAgIHJlZ2lzdGVyQW5pbWF0aW9uKGFuaW1hdGlvbkZhY3RvcnksICdyZW1vdmVDbGFzcycpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgZnVuY3Rpb24gcmVnaXN0ZXJBbmltYXRpb24oYW5pbWF0aW9uRmFjdG9yeSwgZXZlbnQpIHtcbiAgICAgICAgICB2YXIgYWZ0ZXJGbiA9IGFuaW1hdGlvbkZhY3RvcnlbZXZlbnRdO1xuICAgICAgICAgIHZhciBiZWZvcmVGbiA9IGFuaW1hdGlvbkZhY3RvcnlbJ2JlZm9yZScgKyBldmVudC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGV2ZW50LnN1YnN0cigxKV07XG4gICAgICAgICAgaWYoYWZ0ZXJGbiB8fCBiZWZvcmVGbikge1xuICAgICAgICAgICAgaWYoZXZlbnQgPT0gJ2xlYXZlJykge1xuICAgICAgICAgICAgICBiZWZvcmVGbiA9IGFmdGVyRm47XG4gICAgICAgICAgICAgIC8vd2hlbiBzZXQgYXMgbnVsbCB0aGVuIGFuaW1hdGlvbiBrbm93cyB0byBza2lwIHRoaXMgcGhhc2VcbiAgICAgICAgICAgICAgYWZ0ZXJGbiA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhZnRlci5wdXNoKHtcbiAgICAgICAgICAgICAgZXZlbnQgOiBldmVudCwgZm4gOiBhZnRlckZuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJlZm9yZS5wdXNoKHtcbiAgICAgICAgICAgICAgZXZlbnQgOiBldmVudCwgZm4gOiBiZWZvcmVGblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBydW4oZm5zLCBjYW5jZWxsYXRpb25zLCBhbGxDb21wbGV0ZUZuKSB7XG4gICAgICAgICAgdmFyIGFuaW1hdGlvbnMgPSBbXTtcbiAgICAgICAgICBmb3JFYWNoKGZucywgZnVuY3Rpb24oYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICBhbmltYXRpb24uZm4gJiYgYW5pbWF0aW9ucy5wdXNoKGFuaW1hdGlvbik7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgY291bnQgPSAwO1xuICAgICAgICAgIGZ1bmN0aW9uIGFmdGVyQW5pbWF0aW9uQ29tcGxldGUoaW5kZXgpIHtcbiAgICAgICAgICAgIGlmKGNhbmNlbGxhdGlvbnMpIHtcbiAgICAgICAgICAgICAgKGNhbmNlbGxhdGlvbnNbaW5kZXhdIHx8IG5vb3ApKCk7XG4gICAgICAgICAgICAgIGlmKCsrY291bnQgPCBhbmltYXRpb25zLmxlbmd0aCkgcmV0dXJuO1xuICAgICAgICAgICAgICBjYW5jZWxsYXRpb25zID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFsbENvbXBsZXRlRm4oKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvL1RoZSBjb2RlIGJlbG93IGFkZHMgZGlyZWN0bHkgdG8gdGhlIGFycmF5IGluIG9yZGVyIHRvIHdvcmsgd2l0aFxuICAgICAgICAgIC8vYm90aCBzeW5jIGFuZCBhc3luYyBhbmltYXRpb25zLiBTeW5jIGFuaW1hdGlvbnMgYXJlIHdoZW4gdGhlIGRvbmUoKVxuICAgICAgICAgIC8vb3BlcmF0aW9uIGlzIGNhbGxlZCByaWdodCBhd2F5LiBETyBOT1QgUkVGQUNUT1IhXG4gICAgICAgICAgZm9yRWFjaChhbmltYXRpb25zLCBmdW5jdGlvbihhbmltYXRpb24sIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgcHJvZ3Jlc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgYWZ0ZXJBbmltYXRpb25Db21wbGV0ZShpbmRleCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc3dpdGNoKGFuaW1hdGlvbi5ldmVudCkge1xuICAgICAgICAgICAgICBjYXNlICdzZXRDbGFzcyc6XG4gICAgICAgICAgICAgICAgY2FuY2VsbGF0aW9ucy5wdXNoKGFuaW1hdGlvbi5mbihlbGVtZW50LCBjbGFzc05hbWVBZGQsIGNsYXNzTmFtZVJlbW92ZSwgcHJvZ3Jlc3MpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSAnYWRkQ2xhc3MnOlxuICAgICAgICAgICAgICAgIGNhbmNlbGxhdGlvbnMucHVzaChhbmltYXRpb24uZm4oZWxlbWVudCwgY2xhc3NOYW1lQWRkIHx8IGNsYXNzTmFtZSwgICAgIHByb2dyZXNzKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGNhc2UgJ3JlbW92ZUNsYXNzJzpcbiAgICAgICAgICAgICAgICBjYW5jZWxsYXRpb25zLnB1c2goYW5pbWF0aW9uLmZuKGVsZW1lbnQsIGNsYXNzTmFtZVJlbW92ZSB8fCBjbGFzc05hbWUsICBwcm9ncmVzcykpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNhbmNlbGxhdGlvbnMucHVzaChhbmltYXRpb24uZm4oZWxlbWVudCwgcHJvZ3Jlc3MpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGlmKGNhbmNlbGxhdGlvbnMgJiYgY2FuY2VsbGF0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGFsbENvbXBsZXRlRm4oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIG5vZGUgOiBub2RlLFxuICAgICAgICAgIGV2ZW50IDogYW5pbWF0aW9uRXZlbnQsXG4gICAgICAgICAgY2xhc3NOYW1lIDogY2xhc3NOYW1lLFxuICAgICAgICAgIGlzQ2xhc3NCYXNlZCA6IGlzQ2xhc3NCYXNlZCxcbiAgICAgICAgICBpc1NldENsYXNzT3BlcmF0aW9uIDogaXNTZXRDbGFzc09wZXJhdGlvbixcbiAgICAgICAgICBiZWZvcmUgOiBmdW5jdGlvbihhbGxDb21wbGV0ZUZuKSB7XG4gICAgICAgICAgICBiZWZvcmVDb21wbGV0ZSA9IGFsbENvbXBsZXRlRm47XG4gICAgICAgICAgICBydW4oYmVmb3JlLCBiZWZvcmVDYW5jZWwsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBiZWZvcmVDb21wbGV0ZSA9IG5vb3A7XG4gICAgICAgICAgICAgIGFsbENvbXBsZXRlRm4oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgYWZ0ZXIgOiBmdW5jdGlvbihhbGxDb21wbGV0ZUZuKSB7XG4gICAgICAgICAgICBhZnRlckNvbXBsZXRlID0gYWxsQ29tcGxldGVGbjtcbiAgICAgICAgICAgIHJ1bihhZnRlciwgYWZ0ZXJDYW5jZWwsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBhZnRlckNvbXBsZXRlID0gbm9vcDtcbiAgICAgICAgICAgICAgYWxsQ29tcGxldGVGbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBjYW5jZWwgOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmKGJlZm9yZUNhbmNlbCkge1xuICAgICAgICAgICAgICBmb3JFYWNoKGJlZm9yZUNhbmNlbCwgZnVuY3Rpb24oY2FuY2VsRm4pIHtcbiAgICAgICAgICAgICAgICAoY2FuY2VsRm4gfHwgbm9vcCkodHJ1ZSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBiZWZvcmVDb21wbGV0ZSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKGFmdGVyQ2FuY2VsKSB7XG4gICAgICAgICAgICAgIGZvckVhY2goYWZ0ZXJDYW5jZWwsIGZ1bmN0aW9uKGNhbmNlbEZuKSB7XG4gICAgICAgICAgICAgICAgKGNhbmNlbEZuIHx8IG5vb3ApKHRydWUpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgYWZ0ZXJDb21wbGV0ZSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogQG5nZG9jIHNlcnZpY2VcbiAgICAgICAqIEBuYW1lICRhbmltYXRlXG4gICAgICAgKiBAZnVuY3Rpb25cbiAgICAgICAqXG4gICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAqIFRoZSBgJGFuaW1hdGVgIHNlcnZpY2UgcHJvdmlkZXMgYW5pbWF0aW9uIGRldGVjdGlvbiBzdXBwb3J0IHdoaWxlIHBlcmZvcm1pbmcgRE9NIG9wZXJhdGlvbnMgKGVudGVyLCBsZWF2ZSBhbmQgbW92ZSkgYXMgd2VsbCBhcyBkdXJpbmcgYWRkQ2xhc3MgYW5kIHJlbW92ZUNsYXNzIG9wZXJhdGlvbnMuXG4gICAgICAgKiBXaGVuIGFueSBvZiB0aGVzZSBvcGVyYXRpb25zIGFyZSBydW4sIHRoZSAkYW5pbWF0ZSBzZXJ2aWNlXG4gICAgICAgKiB3aWxsIGV4YW1pbmUgYW55IEphdmFTY3JpcHQtZGVmaW5lZCBhbmltYXRpb25zICh3aGljaCBhcmUgZGVmaW5lZCBieSB1c2luZyB0aGUgJGFuaW1hdGVQcm92aWRlciBwcm92aWRlciBvYmplY3QpXG4gICAgICAgKiBhcyB3ZWxsIGFzIGFueSBDU1MtZGVmaW5lZCBhbmltYXRpb25zIGFnYWluc3QgdGhlIENTUyBjbGFzc2VzIHByZXNlbnQgb24gdGhlIGVsZW1lbnQgb25jZSB0aGUgRE9NIG9wZXJhdGlvbiBpcyBydW4uXG4gICAgICAgKlxuICAgICAgICogVGhlIGAkYW5pbWF0ZWAgc2VydmljZSBpcyB1c2VkIGJlaGluZCB0aGUgc2NlbmVzIHdpdGggcHJlLWV4aXN0aW5nIGRpcmVjdGl2ZXMgYW5kIGFuaW1hdGlvbiB3aXRoIHRoZXNlIGRpcmVjdGl2ZXNcbiAgICAgICAqIHdpbGwgd29yayBvdXQgb2YgdGhlIGJveCB3aXRob3V0IGFueSBleHRyYSBjb25maWd1cmF0aW9uLlxuICAgICAgICpcbiAgICAgICAqIFJlcXVpcmVzIHRoZSB7QGxpbmsgbmdBbmltYXRlIGBuZ0FuaW1hdGVgfSBtb2R1bGUgdG8gYmUgaW5zdGFsbGVkLlxuICAgICAgICpcbiAgICAgICAqIFBsZWFzZSB2aXNpdCB0aGUge0BsaW5rIG5nQW5pbWF0ZSBgbmdBbmltYXRlYH0gbW9kdWxlIG92ZXJ2aWV3IHBhZ2UgbGVhcm4gbW9yZSBhYm91dCBob3cgdG8gdXNlIGFuaW1hdGlvbnMgaW4geW91ciBhcHBsaWNhdGlvbi5cbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAqIEBuYW1lICRhbmltYXRlI2VudGVyXG4gICAgICAgICAqIEBmdW5jdGlvblxuICAgICAgICAgKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAgICogQXBwZW5kcyB0aGUgZWxlbWVudCB0byB0aGUgcGFyZW50RWxlbWVudCBlbGVtZW50IHRoYXQgcmVzaWRlcyBpbiB0aGUgZG9jdW1lbnQgYW5kIHRoZW4gcnVucyB0aGUgZW50ZXIgYW5pbWF0aW9uLiBPbmNlXG4gICAgICAgICAqIHRoZSBhbmltYXRpb24gaXMgc3RhcnRlZCwgdGhlIGZvbGxvd2luZyBDU1MgY2xhc3NlcyB3aWxsIGJlIHByZXNlbnQgb24gdGhlIGVsZW1lbnQgZm9yIHRoZSBkdXJhdGlvbiBvZiB0aGUgYW5pbWF0aW9uOlxuICAgICAgICAgKlxuICAgICAgICAgKiBCZWxvdyBpcyBhIGJyZWFrZG93biBvZiBlYWNoIHN0ZXAgdGhhdCBvY2N1cnMgZHVyaW5nIGVudGVyIGFuaW1hdGlvbjpcbiAgICAgICAgICpcbiAgICAgICAgICogfCBBbmltYXRpb24gU3RlcCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFdoYXQgdGhlIGVsZW1lbnQgY2xhc3MgYXR0cmlidXRlIGxvb2tzIGxpa2UgfFxuICAgICAgICAgKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XG4gICAgICAgICAqIHwgMS4gJGFuaW1hdGUuZW50ZXIoLi4uKSBpcyBjYWxsZWQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvblwiICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDIuIGVsZW1lbnQgaXMgaW5zZXJ0ZWQgaW50byB0aGUgcGFyZW50RWxlbWVudCBlbGVtZW50IG9yIGJlc2lkZSB0aGUgYWZ0ZXJFbGVtZW50IGVsZW1lbnQgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb25cIiAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAzLiAkYW5pbWF0ZSBydW5zIGFueSBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGVcIiAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgNC4gdGhlIC5uZy1lbnRlciBjbGFzcyBpcyBhZGRlZCB0byB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWVudGVyXCIgICAgfFxuICAgICAgICAgKiB8IDUuICRhbmltYXRlIHNjYW5zIHRoZSBlbGVtZW50IHN0eWxlcyB0byBnZXQgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbiBkdXJhdGlvbiBhbmQgZGVsYXkgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1lbnRlclwiICAgIHxcbiAgICAgICAgICogfCA2LiAkYW5pbWF0ZSB3YWl0cyBmb3IgMTBtcyAodGhpcyBwZXJmb3JtcyBhIHJlZmxvdykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctZW50ZXJcIiAgICB8XG4gICAgICAgICAqIHwgNy4gdGhlIC5uZy1lbnRlci1hY3RpdmUgYW5kIC5uZy1hbmltYXRlLWFjdGl2ZSBjbGFzc2VzIGFyZSBhZGRlZCAodGhpcyB0cmlnZ2VycyB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uKSB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctYW5pbWF0ZS1hY3RpdmUgbmctZW50ZXIgbmctZW50ZXItYWN0aXZlXCIgfFxuICAgICAgICAgKiB8IDguICRhbmltYXRlIHdhaXRzIGZvciBYIG1pbGxpc2Vjb25kcyBmb3IgdGhlIGFuaW1hdGlvbiB0byBjb21wbGV0ZSAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1hbmltYXRlLWFjdGl2ZSBuZy1lbnRlciBuZy1lbnRlci1hY3RpdmVcIiB8XG4gICAgICAgICAqIHwgOS4gVGhlIGFuaW1hdGlvbiBlbmRzIGFuZCBhbGwgZ2VuZXJhdGVkIENTUyBjbGFzc2VzIGFyZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnQgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvblwiICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDEwLiBUaGUgZG9uZUNhbGxiYWNrKCkgY2FsbGJhY2sgaXMgZmlyZWQgKGlmIHByb3ZpZGVkKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb25cIiAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBlbGVtZW50IHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSB0aGUgZm9jdXMgb2YgdGhlIGVudGVyIGFuaW1hdGlvblxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IHBhcmVudEVsZW1lbnQgdGhlIHBhcmVudCBlbGVtZW50IG9mIHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSB0aGUgZm9jdXMgb2YgdGhlIGVudGVyIGFuaW1hdGlvblxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGFmdGVyRWxlbWVudCB0aGUgc2libGluZyBlbGVtZW50ICh3aGljaCBpcyB0aGUgcHJldmlvdXMgZWxlbWVudCkgb2YgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHRoZSBmb2N1cyBvZiB0aGUgZW50ZXIgYW5pbWF0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oKT19IGRvbmVDYWxsYmFjayB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZCBvbmNlIHRoZSBhbmltYXRpb24gaXMgY29tcGxldGVcbiAgICAgICAgKi9cbiAgICAgICAgZW50ZXIgOiBmdW5jdGlvbihlbGVtZW50LCBwYXJlbnRFbGVtZW50LCBhZnRlckVsZW1lbnQsIGRvbmVDYWxsYmFjaykge1xuICAgICAgICAgIHRoaXMuZW5hYmxlZChmYWxzZSwgZWxlbWVudCk7XG4gICAgICAgICAgJGRlbGVnYXRlLmVudGVyKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCk7XG4gICAgICAgICAgJHJvb3RTY29wZS4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBlbGVtZW50ID0gc3RyaXBDb21tZW50c0Zyb21FbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgcGVyZm9ybUFuaW1hdGlvbignZW50ZXInLCAnbmctZW50ZXInLCBlbGVtZW50LCBwYXJlbnRFbGVtZW50LCBhZnRlckVsZW1lbnQsIG5vb3AsIGRvbmVDYWxsYmFjayk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICogQG5hbWUgJGFuaW1hdGUjbGVhdmVcbiAgICAgICAgICogQGZ1bmN0aW9uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBSdW5zIHRoZSBsZWF2ZSBhbmltYXRpb24gb3BlcmF0aW9uIGFuZCwgdXBvbiBjb21wbGV0aW9uLCByZW1vdmVzIHRoZSBlbGVtZW50IGZyb20gdGhlIERPTS4gT25jZVxuICAgICAgICAgKiB0aGUgYW5pbWF0aW9uIGlzIHN0YXJ0ZWQsIHRoZSBmb2xsb3dpbmcgQ1NTIGNsYXNzZXMgd2lsbCBiZSBhZGRlZCBmb3IgdGhlIGR1cmF0aW9uIG9mIHRoZSBhbmltYXRpb246XG4gICAgICAgICAqXG4gICAgICAgICAqIEJlbG93IGlzIGEgYnJlYWtkb3duIG9mIGVhY2ggc3RlcCB0aGF0IG9jY3VycyBkdXJpbmcgbGVhdmUgYW5pbWF0aW9uOlxuICAgICAgICAgKlxuICAgICAgICAgKiB8IEFuaW1hdGlvbiBTdGVwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgV2hhdCB0aGUgZWxlbWVudCBjbGFzcyBhdHRyaWJ1dGUgbG9va3MgbGlrZSB8XG4gICAgICAgICAqIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbiAgICAgICAgICogfCAxLiAkYW5pbWF0ZS5sZWF2ZSguLi4pIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uXCIgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMi4gJGFuaW1hdGUgcnVucyBhbnkgSmF2YVNjcmlwdC1kZWZpbmVkIGFuaW1hdGlvbnMgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlXCIgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDMuIHRoZSAubmctbGVhdmUgY2xhc3MgaXMgYWRkZWQgdG8gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1sZWF2ZVwiICAgIHxcbiAgICAgICAgICogfCA0LiAkYW5pbWF0ZSBzY2FucyB0aGUgZWxlbWVudCBzdHlsZXMgdG8gZ2V0IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24gZHVyYXRpb24gYW5kIGRlbGF5ICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbGVhdmVcIiAgICB8XG4gICAgICAgICAqIHwgNS4gJGFuaW1hdGUgd2FpdHMgZm9yIDEwbXMgKHRoaXMgcGVyZm9ybXMgYSByZWZsb3cpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWxlYXZlXCIgICAgfFxuICAgICAgICAgKiB8IDYuIHRoZSAubmctbGVhdmUtYWN0aXZlIGFuZCAubmctYW5pbWF0ZS1hY3RpdmUgY2xhc3NlcyBpcyBhZGRlZCAodGhpcyB0cmlnZ2VycyB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uKSB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctYW5pbWF0ZS1hY3RpdmUgbmctbGVhdmUgbmctbGVhdmUtYWN0aXZlXCIgfFxuICAgICAgICAgKiB8IDcuICRhbmltYXRlIHdhaXRzIGZvciBYIG1pbGxpc2Vjb25kcyBmb3IgdGhlIGFuaW1hdGlvbiB0byBjb21wbGV0ZSAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1hbmltYXRlLWFjdGl2ZSBuZy1sZWF2ZSBuZy1sZWF2ZS1hY3RpdmVcIiB8XG4gICAgICAgICAqIHwgOC4gVGhlIGFuaW1hdGlvbiBlbmRzIGFuZCBhbGwgZ2VuZXJhdGVkIENTUyBjbGFzc2VzIGFyZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnQgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvblwiICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDkuIFRoZSBlbGVtZW50IGlzIHJlbW92ZWQgZnJvbSB0aGUgRE9NICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgLi4uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMTAuIFRoZSBkb25lQ2FsbGJhY2soKSBjYWxsYmFjayBpcyBmaXJlZCAoaWYgcHJvdmlkZWQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAuLi4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBlbGVtZW50IHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSB0aGUgZm9jdXMgb2YgdGhlIGxlYXZlIGFuaW1hdGlvblxuICAgICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCk9fSBkb25lQ2FsbGJhY2sgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgb25jZSB0aGUgYW5pbWF0aW9uIGlzIGNvbXBsZXRlXG4gICAgICAgICovXG4gICAgICAgIGxlYXZlIDogZnVuY3Rpb24oZWxlbWVudCwgZG9uZUNhbGxiYWNrKSB7XG4gICAgICAgICAgY2FuY2VsQ2hpbGRBbmltYXRpb25zKGVsZW1lbnQpO1xuICAgICAgICAgIHRoaXMuZW5hYmxlZChmYWxzZSwgZWxlbWVudCk7XG4gICAgICAgICAgJHJvb3RTY29wZS4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBwZXJmb3JtQW5pbWF0aW9uKCdsZWF2ZScsICduZy1sZWF2ZScsIHN0cmlwQ29tbWVudHNGcm9tRWxlbWVudChlbGVtZW50KSwgbnVsbCwgbnVsbCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICRkZWxlZ2F0ZS5sZWF2ZShlbGVtZW50KTtcbiAgICAgICAgICAgIH0sIGRvbmVDYWxsYmFjayk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICogQG5hbWUgJGFuaW1hdGUjbW92ZVxuICAgICAgICAgKiBAZnVuY3Rpb25cbiAgICAgICAgICpcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAqIEZpcmVzIHRoZSBtb3ZlIERPTSBvcGVyYXRpb24uIEp1c3QgYmVmb3JlIHRoZSBhbmltYXRpb24gc3RhcnRzLCB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHdpbGwgZWl0aGVyIGFwcGVuZCBpdCBpbnRvIHRoZSBwYXJlbnRFbGVtZW50IGNvbnRhaW5lciBvclxuICAgICAgICAgKiBhZGQgdGhlIGVsZW1lbnQgZGlyZWN0bHkgYWZ0ZXIgdGhlIGFmdGVyRWxlbWVudCBlbGVtZW50IGlmIHByZXNlbnQuIFRoZW4gdGhlIG1vdmUgYW5pbWF0aW9uIHdpbGwgYmUgcnVuLiBPbmNlXG4gICAgICAgICAqIHRoZSBhbmltYXRpb24gaXMgc3RhcnRlZCwgdGhlIGZvbGxvd2luZyBDU1MgY2xhc3NlcyB3aWxsIGJlIGFkZGVkIGZvciB0aGUgZHVyYXRpb24gb2YgdGhlIGFuaW1hdGlvbjpcbiAgICAgICAgICpcbiAgICAgICAgICogQmVsb3cgaXMgYSBicmVha2Rvd24gb2YgZWFjaCBzdGVwIHRoYXQgb2NjdXJzIGR1cmluZyBtb3ZlIGFuaW1hdGlvbjpcbiAgICAgICAgICpcbiAgICAgICAgICogfCBBbmltYXRpb24gU3RlcCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFdoYXQgdGhlIGVsZW1lbnQgY2xhc3MgYXR0cmlidXRlIGxvb2tzIGxpa2UgfFxuICAgICAgICAgKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XG4gICAgICAgICAqIHwgMS4gJGFuaW1hdGUubW92ZSguLi4pIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvblwiICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDIuIGVsZW1lbnQgaXMgbW92ZWQgaW50byB0aGUgcGFyZW50RWxlbWVudCBlbGVtZW50IG9yIGJlc2lkZSB0aGUgYWZ0ZXJFbGVtZW50IGVsZW1lbnQgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb25cIiAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAzLiAkYW5pbWF0ZSBydW5zIGFueSBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGVcIiAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgNC4gdGhlIC5uZy1tb3ZlIGNsYXNzIGlzIGFkZGVkIHRvIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLW1vdmVcIiAgICAgfFxuICAgICAgICAgKiB8IDUuICRhbmltYXRlIHNjYW5zIHRoZSBlbGVtZW50IHN0eWxlcyB0byBnZXQgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbiBkdXJhdGlvbiBhbmQgZGVsYXkgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1tb3ZlXCIgICAgIHxcbiAgICAgICAgICogfCA2LiAkYW5pbWF0ZSB3YWl0cyBmb3IgMTBtcyAodGhpcyBwZXJmb3JtcyBhIHJlZmxvdykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbW92ZVwiICAgICB8XG4gICAgICAgICAqIHwgNy4gdGhlIC5uZy1tb3ZlLWFjdGl2ZSBhbmQgLm5nLWFuaW1hdGUtYWN0aXZlIGNsYXNzZXMgaXMgYWRkZWQgKHRoaXMgdHJpZ2dlcnMgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbikgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWFuaW1hdGUtYWN0aXZlIG5nLW1vdmUgbmctbW92ZS1hY3RpdmVcIiB8XG4gICAgICAgICAqIHwgOC4gJGFuaW1hdGUgd2FpdHMgZm9yIFggbWlsbGlzZWNvbmRzIGZvciB0aGUgYW5pbWF0aW9uIHRvIGNvbXBsZXRlICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWFuaW1hdGUtYWN0aXZlIG5nLW1vdmUgbmctbW92ZS1hY3RpdmVcIiB8XG4gICAgICAgICAqIHwgOS4gVGhlIGFuaW1hdGlvbiBlbmRzIGFuZCBhbGwgZ2VuZXJhdGVkIENTUyBjbGFzc2VzIGFyZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnQgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvblwiICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDEwLiBUaGUgZG9uZUNhbGxiYWNrKCkgY2FsbGJhY2sgaXMgZmlyZWQgKGlmIHByb3ZpZGVkKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb25cIiAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBlbGVtZW50IHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSB0aGUgZm9jdXMgb2YgdGhlIG1vdmUgYW5pbWF0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gcGFyZW50RWxlbWVudCB0aGUgcGFyZW50RWxlbWVudCBlbGVtZW50IG9mIHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSB0aGUgZm9jdXMgb2YgdGhlIG1vdmUgYW5pbWF0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gYWZ0ZXJFbGVtZW50IHRoZSBzaWJsaW5nIGVsZW1lbnQgKHdoaWNoIGlzIHRoZSBwcmV2aW91cyBlbGVtZW50KSBvZiB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgdGhlIGZvY3VzIG9mIHRoZSBtb3ZlIGFuaW1hdGlvblxuICAgICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCk9fSBkb25lQ2FsbGJhY2sgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgb25jZSB0aGUgYW5pbWF0aW9uIGlzIGNvbXBsZXRlXG4gICAgICAgICovXG4gICAgICAgIG1vdmUgOiBmdW5jdGlvbihlbGVtZW50LCBwYXJlbnRFbGVtZW50LCBhZnRlckVsZW1lbnQsIGRvbmVDYWxsYmFjaykge1xuICAgICAgICAgIGNhbmNlbENoaWxkQW5pbWF0aW9ucyhlbGVtZW50KTtcbiAgICAgICAgICB0aGlzLmVuYWJsZWQoZmFsc2UsIGVsZW1lbnQpO1xuICAgICAgICAgICRkZWxlZ2F0ZS5tb3ZlKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCk7XG4gICAgICAgICAgJHJvb3RTY29wZS4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBlbGVtZW50ID0gc3RyaXBDb21tZW50c0Zyb21FbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgcGVyZm9ybUFuaW1hdGlvbignbW92ZScsICduZy1tb3ZlJywgZWxlbWVudCwgcGFyZW50RWxlbWVudCwgYWZ0ZXJFbGVtZW50LCBub29wLCBkb25lQ2FsbGJhY2spO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAqIEBuYW1lICRhbmltYXRlI2FkZENsYXNzXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBUcmlnZ2VycyBhIGN1c3RvbSBhbmltYXRpb24gZXZlbnQgYmFzZWQgb2ZmIHRoZSBjbGFzc05hbWUgdmFyaWFibGUgYW5kIHRoZW4gYXR0YWNoZXMgdGhlIGNsYXNzTmFtZSB2YWx1ZSB0byB0aGUgZWxlbWVudCBhcyBhIENTUyBjbGFzcy5cbiAgICAgICAgICogVW5saWtlIHRoZSBvdGhlciBhbmltYXRpb24gbWV0aG9kcywgdGhlIGFuaW1hdGUgc2VydmljZSB3aWxsIHN1ZmZpeCB0aGUgY2xhc3NOYW1lIHZhbHVlIHdpdGgge0B0eXBlIC1hZGR9IGluIG9yZGVyIHRvIHByb3ZpZGVcbiAgICAgICAgICogdGhlIGFuaW1hdGUgc2VydmljZSB0aGUgc2V0dXAgYW5kIGFjdGl2ZSBDU1MgY2xhc3NlcyBpbiBvcmRlciB0byB0cmlnZ2VyIHRoZSBhbmltYXRpb24gKHRoaXMgd2lsbCBiZSBza2lwcGVkIGlmIG5vIENTUyB0cmFuc2l0aW9uc1xuICAgICAgICAgKiBvciBrZXlmcmFtZXMgYXJlIGRlZmluZWQgb24gdGhlIC1hZGQgb3IgYmFzZSBDU1MgY2xhc3MpLlxuICAgICAgICAgKlxuICAgICAgICAgKiBCZWxvdyBpcyBhIGJyZWFrZG93biBvZiBlYWNoIHN0ZXAgdGhhdCBvY2N1cnMgZHVyaW5nIGFkZENsYXNzIGFuaW1hdGlvbjpcbiAgICAgICAgICpcbiAgICAgICAgICogfCBBbmltYXRpb24gU3RlcCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgV2hhdCB0aGUgZWxlbWVudCBjbGFzcyBhdHRyaWJ1dGUgbG9va3MgbGlrZSB8XG4gICAgICAgICAqIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxuICAgICAgICAgKiB8IDEuICRhbmltYXRlLmFkZENsYXNzKGVsZW1lbnQsICdzdXBlcicpIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvblwiICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDIuICRhbmltYXRlIHJ1bnMgYW55IEphdmFTY3JpcHQtZGVmaW5lZCBhbmltYXRpb25zIG9uIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlXCIgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDMuIHRoZSAuc3VwZXItYWRkIGNsYXNzIGFyZSBhZGRlZCB0byB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyLWFkZFwiICAgfFxuICAgICAgICAgKiB8IDQuICRhbmltYXRlIHNjYW5zIHRoZSBlbGVtZW50IHN0eWxlcyB0byBnZXQgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbiBkdXJhdGlvbiBhbmQgZGVsYXkgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyLWFkZFwiICAgfFxuICAgICAgICAgKiB8IDUuICRhbmltYXRlIHdhaXRzIGZvciAxMG1zICh0aGlzIHBlcmZvcm1zIGEgcmVmbG93KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyLWFkZFwiICAgfFxuICAgICAgICAgKiB8IDYuIHRoZSAuc3VwZXIsIC5zdXBlci1hZGQtYWN0aXZlIGFuZCAubmctYW5pbWF0ZS1hY3RpdmUgY2xhc3NlcyBhcmUgYWRkZWQgKHRoaXMgdHJpZ2dlcnMgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbikgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWFuaW1hdGUtYWN0aXZlIHN1cGVyIHN1cGVyLWFkZCBzdXBlci1hZGQtYWN0aXZlXCIgICAgICAgICAgfFxuICAgICAgICAgKiB8IDcuICRhbmltYXRlIHdhaXRzIGZvciBYIG1pbGxpc2Vjb25kcyBmb3IgdGhlIGFuaW1hdGlvbiB0byBjb21wbGV0ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlciBzdXBlci1hZGQgc3VwZXItYWRkLWFjdGl2ZVwiICB8XG4gICAgICAgICAqIHwgOC4gVGhlIGFuaW1hdGlvbiBlbmRzIGFuZCBhbGwgZ2VuZXJhdGVkIENTUyBjbGFzc2VzIGFyZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIHN1cGVyXCIgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgOS4gVGhlIHN1cGVyIGNsYXNzIGlzIGtlcHQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIHN1cGVyXCIgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMTAuIFRoZSBkb25lQ2FsbGJhY2soKSBjYWxsYmFjayBpcyBmaXJlZCAoaWYgcHJvdmlkZWQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIHN1cGVyXCIgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgYW5pbWF0ZWRcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGNsYXNzTmFtZSB0aGUgQ1NTIGNsYXNzIHRoYXQgd2lsbCBiZSBhZGRlZCB0byB0aGUgZWxlbWVudCBhbmQgdGhlbiBhbmltYXRlZFxuICAgICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCk9fSBkb25lQ2FsbGJhY2sgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgb25jZSB0aGUgYW5pbWF0aW9uIGlzIGNvbXBsZXRlXG4gICAgICAgICovXG4gICAgICAgIGFkZENsYXNzIDogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lQ2FsbGJhY2spIHtcbiAgICAgICAgICBlbGVtZW50ID0gc3RyaXBDb21tZW50c0Zyb21FbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgIHBlcmZvcm1BbmltYXRpb24oJ2FkZENsYXNzJywgY2xhc3NOYW1lLCBlbGVtZW50LCBudWxsLCBudWxsLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRkZWxlZ2F0ZS5hZGRDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpO1xuICAgICAgICAgIH0sIGRvbmVDYWxsYmFjayk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICogQG5hbWUgJGFuaW1hdGUjcmVtb3ZlQ2xhc3NcbiAgICAgICAgICpcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAqIFRyaWdnZXJzIGEgY3VzdG9tIGFuaW1hdGlvbiBldmVudCBiYXNlZCBvZmYgdGhlIGNsYXNzTmFtZSB2YXJpYWJsZSBhbmQgdGhlbiByZW1vdmVzIHRoZSBDU1MgY2xhc3MgcHJvdmlkZWQgYnkgdGhlIGNsYXNzTmFtZSB2YWx1ZVxuICAgICAgICAgKiBmcm9tIHRoZSBlbGVtZW50LiBVbmxpa2UgdGhlIG90aGVyIGFuaW1hdGlvbiBtZXRob2RzLCB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHdpbGwgc3VmZml4IHRoZSBjbGFzc05hbWUgdmFsdWUgd2l0aCB7QHR5cGUgLXJlbW92ZX0gaW5cbiAgICAgICAgICogb3JkZXIgdG8gcHJvdmlkZSB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHRoZSBzZXR1cCBhbmQgYWN0aXZlIENTUyBjbGFzc2VzIGluIG9yZGVyIHRvIHRyaWdnZXIgdGhlIGFuaW1hdGlvbiAodGhpcyB3aWxsIGJlIHNraXBwZWQgaWZcbiAgICAgICAgICogbm8gQ1NTIHRyYW5zaXRpb25zIG9yIGtleWZyYW1lcyBhcmUgZGVmaW5lZCBvbiB0aGUgLXJlbW92ZSBvciBiYXNlIENTUyBjbGFzc2VzKS5cbiAgICAgICAgICpcbiAgICAgICAgICogQmVsb3cgaXMgYSBicmVha2Rvd24gb2YgZWFjaCBzdGVwIHRoYXQgb2NjdXJzIGR1cmluZyByZW1vdmVDbGFzcyBhbmltYXRpb246XG4gICAgICAgICAqXG4gICAgICAgICAqIHwgQW5pbWF0aW9uIFN0ZXAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgV2hhdCB0aGUgZWxlbWVudCBjbGFzcyBhdHRyaWJ1dGUgbG9va3MgbGlrZSAgICAgfFxuICAgICAgICAgKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxuICAgICAgICAgKiB8IDEuICRhbmltYXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsICdzdXBlcicpIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIHN1cGVyXCIgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMi4gJGFuaW1hdGUgcnVucyBhbnkgSmF2YVNjcmlwdC1kZWZpbmVkIGFuaW1hdGlvbnMgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gc3VwZXIgbmctYW5pbWF0ZVwiICAgICAgIHxcbiAgICAgICAgICogfCAzLiB0aGUgLnN1cGVyLXJlbW92ZSBjbGFzcyBhcmUgYWRkZWQgdG8gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlciBuZy1hbmltYXRlIHN1cGVyLXJlbW92ZVwifFxuICAgICAgICAgKiB8IDQuICRhbmltYXRlIHNjYW5zIHRoZSBlbGVtZW50IHN0eWxlcyB0byBnZXQgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbiBkdXJhdGlvbiBhbmQgZGVsYXkgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIHN1cGVyIG5nLWFuaW1hdGUgc3VwZXItcmVtb3ZlXCIgICB8XG4gICAgICAgICAqIHwgNS4gJGFuaW1hdGUgd2FpdHMgZm9yIDEwbXMgKHRoaXMgcGVyZm9ybXMgYSByZWZsb3cpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgY2xhc3M9XCJteS1hbmltYXRpb24gc3VwZXIgbmctYW5pbWF0ZSBzdXBlci1yZW1vdmVcIiAgIHxcbiAgICAgICAgICogfCA2LiB0aGUgLnN1cGVyLXJlbW92ZS1hY3RpdmUgYW5kIC5uZy1hbmltYXRlLWFjdGl2ZSBjbGFzc2VzIGFyZSBhZGRlZCBhbmQgLnN1cGVyIGlzIHJlbW92ZWQgKHRoaXMgdHJpZ2dlcnMgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbikgfCBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWFuaW1hdGUtYWN0aXZlIHN1cGVyLXJlbW92ZSBzdXBlci1yZW1vdmUtYWN0aXZlXCIgICAgICAgICAgfFxuICAgICAgICAgKiB8IDcuICRhbmltYXRlIHdhaXRzIGZvciBYIG1pbGxpc2Vjb25kcyBmb3IgdGhlIGFuaW1hdGlvbiB0byBjb21wbGV0ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctYW5pbWF0ZS1hY3RpdmUgc3VwZXItcmVtb3ZlIHN1cGVyLXJlbW92ZS1hY3RpdmVcIiAgIHxcbiAgICAgICAgICogfCA4LiBUaGUgYW5pbWF0aW9uIGVuZHMgYW5kIGFsbCBnZW5lcmF0ZWQgQ1NTIGNsYXNzZXMgYXJlIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudCAgICAgICAgICAgICAgfCBjbGFzcz1cIm15LWFuaW1hdGlvblwiICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDkuIFRoZSBkb25lQ2FsbGJhY2soKSBjYWxsYmFjayBpcyBmaXJlZCAoaWYgcHJvdmlkZWQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGNsYXNzPVwibXktYW5pbWF0aW9uXCIgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgYW5pbWF0ZWRcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGNsYXNzTmFtZSB0aGUgQ1NTIGNsYXNzIHRoYXQgd2lsbCBiZSBhbmltYXRlZCBhbmQgdGhlbiByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnRcbiAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbigpPX0gZG9uZUNhbGxiYWNrIHRoZSBjYWxsYmFjayBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIG9uY2UgdGhlIGFuaW1hdGlvbiBpcyBjb21wbGV0ZVxuICAgICAgICAqL1xuICAgICAgICByZW1vdmVDbGFzcyA6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZUNhbGxiYWNrKSB7XG4gICAgICAgICAgZWxlbWVudCA9IHN0cmlwQ29tbWVudHNGcm9tRWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgICBwZXJmb3JtQW5pbWF0aW9uKCdyZW1vdmVDbGFzcycsIGNsYXNzTmFtZSwgZWxlbWVudCwgbnVsbCwgbnVsbCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkZGVsZWdhdGUucmVtb3ZlQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKTtcbiAgICAgICAgICB9LCBkb25lQ2FsbGJhY2spO1xuICAgICAgICB9LFxuXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICpcbiAgICAgICAgICAgKiBAbmdkb2MgZnVuY3Rpb25cbiAgICAgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNzZXRDbGFzc1xuICAgICAgICAgICAqIEBmdW5jdGlvblxuICAgICAgICAgICAqIEBkZXNjcmlwdGlvbiBBZGRzIGFuZC9vciByZW1vdmVzIHRoZSBnaXZlbiBDU1MgY2xhc3NlcyB0byBhbmQgZnJvbSB0aGUgZWxlbWVudC5cbiAgICAgICAgICAgKiBPbmNlIGNvbXBsZXRlLCB0aGUgZG9uZSgpIGNhbGxiYWNrIHdpbGwgYmUgZmlyZWQgKGlmIHByb3ZpZGVkKS5cbiAgICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgd2hpY2ggd2lsbCBpdCdzIENTUyBjbGFzc2VzIGNoYW5nZWRcbiAgICAgICAgICAgKiAgIHJlbW92ZWQgZnJvbSBpdFxuICAgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhZGQgdGhlIENTUyBjbGFzc2VzIHdoaWNoIHdpbGwgYmUgYWRkZWQgdG8gdGhlIGVsZW1lbnRcbiAgICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gcmVtb3ZlIHRoZSBDU1MgY2xhc3Mgd2hpY2ggd2lsbCBiZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnRcbiAgICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9uPX0gZG9uZSB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gKGlmIHByb3ZpZGVkKSB0aGF0IHdpbGwgYmUgZmlyZWQgYWZ0ZXIgdGhlXG4gICAgICAgICAgICogICBDU1MgY2xhc3NlcyBoYXZlIGJlZW4gc2V0IG9uIHRoZSBlbGVtZW50XG4gICAgICAgICAgICovXG4gICAgICAgIHNldENsYXNzIDogZnVuY3Rpb24oZWxlbWVudCwgYWRkLCByZW1vdmUsIGRvbmVDYWxsYmFjaykge1xuICAgICAgICAgIGVsZW1lbnQgPSBzdHJpcENvbW1lbnRzRnJvbUVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgICAgcGVyZm9ybUFuaW1hdGlvbignc2V0Q2xhc3MnLCBbYWRkLCByZW1vdmVdLCBlbGVtZW50LCBudWxsLCBudWxsLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRkZWxlZ2F0ZS5zZXRDbGFzcyhlbGVtZW50LCBhZGQsIHJlbW92ZSk7XG4gICAgICAgICAgfSwgZG9uZUNhbGxiYWNrKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNlbmFibGVkXG4gICAgICAgICAqIEBmdW5jdGlvblxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge2Jvb2xlYW49fSB2YWx1ZSBJZiBwcm92aWRlZCB0aGVuIHNldCB0aGUgYW5pbWF0aW9uIG9uIG9yIG9mZi5cbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50PX0gZWxlbWVudCBJZiBwcm92aWRlZCB0aGVuIHRoZSBlbGVtZW50IHdpbGwgYmUgdXNlZCB0byByZXByZXNlbnQgdGhlIGVuYWJsZS9kaXNhYmxlIG9wZXJhdGlvblxuICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufSBDdXJyZW50IGFuaW1hdGlvbiBzdGF0ZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAqIEdsb2JhbGx5IGVuYWJsZXMvZGlzYWJsZXMgYW5pbWF0aW9ucy5cbiAgICAgICAgICpcbiAgICAgICAgKi9cbiAgICAgICAgZW5hYmxlZCA6IGZ1bmN0aW9uKHZhbHVlLCBlbGVtZW50KSB7XG4gICAgICAgICAgc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgaWYodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjbGVhbnVwKGVsZW1lbnQpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpIHx8IHt9O1xuICAgICAgICAgICAgICAgIGRhdGEuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFLCBkYXRhKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgcm9vdEFuaW1hdGVTdGF0ZS5kaXNhYmxlZCA9ICF2YWx1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICB2YWx1ZSA9ICFyb290QW5pbWF0ZVN0YXRlLmRpc2FibGVkO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiAhIXZhbHVlO1xuICAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLypcbiAgICAgICAgYWxsIGFuaW1hdGlvbnMgY2FsbCB0aGlzIHNoYXJlZCBhbmltYXRpb24gdHJpZ2dlcmluZyBmdW5jdGlvbiBpbnRlcm5hbGx5LlxuICAgICAgICBUaGUgYW5pbWF0aW9uRXZlbnQgdmFyaWFibGUgcmVmZXJzIHRvIHRoZSBKYXZhU2NyaXB0IGFuaW1hdGlvbiBldmVudCB0aGF0IHdpbGwgYmUgdHJpZ2dlcmVkXG4gICAgICAgIGFuZCB0aGUgY2xhc3NOYW1lIHZhbHVlIGlzIHRoZSBuYW1lIG9mIHRoZSBhbmltYXRpb24gdGhhdCB3aWxsIGJlIGFwcGxpZWQgd2l0aGluIHRoZVxuICAgICAgICBDU1MgY29kZS4gRWxlbWVudCwgcGFyZW50RWxlbWVudCBhbmQgYWZ0ZXJFbGVtZW50IGFyZSBwcm92aWRlZCBET00gZWxlbWVudHMgZm9yIHRoZSBhbmltYXRpb25cbiAgICAgICAgYW5kIHRoZSBvbkNvbXBsZXRlIGNhbGxiYWNrIHdpbGwgYmUgZmlyZWQgb25jZSB0aGUgYW5pbWF0aW9uIGlzIGZ1bGx5IGNvbXBsZXRlLlxuICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIHBlcmZvcm1BbmltYXRpb24oYW5pbWF0aW9uRXZlbnQsIGNsYXNzTmFtZSwgZWxlbWVudCwgcGFyZW50RWxlbWVudCwgYWZ0ZXJFbGVtZW50LCBkb21PcGVyYXRpb24sIGRvbmVDYWxsYmFjaykge1xuXG4gICAgICAgIHZhciBydW5uZXIgPSBhbmltYXRpb25SdW5uZXIoZWxlbWVudCwgYW5pbWF0aW9uRXZlbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgIGlmKCFydW5uZXIpIHtcbiAgICAgICAgICBmaXJlRE9NT3BlcmF0aW9uKCk7XG4gICAgICAgICAgZmlyZUJlZm9yZUNhbGxiYWNrQXN5bmMoKTtcbiAgICAgICAgICBmaXJlQWZ0ZXJDYWxsYmFja0FzeW5jKCk7XG4gICAgICAgICAgY2xvc2VBbmltYXRpb24oKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjbGFzc05hbWUgPSBydW5uZXIuY2xhc3NOYW1lO1xuICAgICAgICB2YXIgZWxlbWVudEV2ZW50cyA9IGFuZ3VsYXIuZWxlbWVudC5fZGF0YShydW5uZXIubm9kZSk7XG4gICAgICAgIGVsZW1lbnRFdmVudHMgPSBlbGVtZW50RXZlbnRzICYmIGVsZW1lbnRFdmVudHMuZXZlbnRzO1xuXG4gICAgICAgIGlmICghcGFyZW50RWxlbWVudCkge1xuICAgICAgICAgIHBhcmVudEVsZW1lbnQgPSBhZnRlckVsZW1lbnQgPyBhZnRlckVsZW1lbnQucGFyZW50KCkgOiBlbGVtZW50LnBhcmVudCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIG5nQW5pbWF0ZVN0YXRlICA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKSB8fCB7fTtcbiAgICAgICAgdmFyIHJ1bm5pbmdBbmltYXRpb25zICAgICA9IG5nQW5pbWF0ZVN0YXRlLmFjdGl2ZSB8fCB7fTtcbiAgICAgICAgdmFyIHRvdGFsQWN0aXZlQW5pbWF0aW9ucyA9IG5nQW5pbWF0ZVN0YXRlLnRvdGFsQWN0aXZlIHx8IDA7XG4gICAgICAgIHZhciBsYXN0QW5pbWF0aW9uICAgICAgICAgPSBuZ0FuaW1hdGVTdGF0ZS5sYXN0O1xuXG4gICAgICAgIC8vb25seSBhbGxvdyBhbmltYXRpb25zIGlmIHRoZSBjdXJyZW50bHkgcnVubmluZyBhbmltYXRpb24gaXMgbm90IHN0cnVjdHVyYWxcbiAgICAgICAgLy9vciBpZiB0aGVyZSBpcyBubyBhbmltYXRpb24gcnVubmluZyBhdCBhbGxcbiAgICAgICAgdmFyIHNraXBBbmltYXRpb25zID0gcnVubmVyLmlzQ2xhc3NCYXNlZCA/XG4gICAgICAgICAgbmdBbmltYXRlU3RhdGUuZGlzYWJsZWQgfHwgKGxhc3RBbmltYXRpb24gJiYgIWxhc3RBbmltYXRpb24uaXNDbGFzc0Jhc2VkKSA6XG4gICAgICAgICAgZmFsc2U7XG5cbiAgICAgICAgLy9za2lwIHRoZSBhbmltYXRpb24gaWYgYW5pbWF0aW9ucyBhcmUgZGlzYWJsZWQsIGEgcGFyZW50IGlzIGFscmVhZHkgYmVpbmcgYW5pbWF0ZWQsXG4gICAgICAgIC8vdGhlIGVsZW1lbnQgaXMgbm90IGN1cnJlbnRseSBhdHRhY2hlZCB0byB0aGUgZG9jdW1lbnQgYm9keSBvciB0aGVuIGNvbXBsZXRlbHkgY2xvc2VcbiAgICAgICAgLy90aGUgYW5pbWF0aW9uIGlmIGFueSBtYXRjaGluZyBhbmltYXRpb25zIGFyZSBub3QgZm91bmQgYXQgYWxsLlxuICAgICAgICAvL05PVEU6IElFOCArIElFOSBzaG91bGQgY2xvc2UgcHJvcGVybHkgKHJ1biBjbG9zZUFuaW1hdGlvbigpKSBpbiBjYXNlIGFuIGFuaW1hdGlvbiB3YXMgZm91bmQuXG4gICAgICAgIGlmIChza2lwQW5pbWF0aW9ucyB8fCBhbmltYXRpb25zRGlzYWJsZWQoZWxlbWVudCwgcGFyZW50RWxlbWVudCkpIHtcbiAgICAgICAgICBmaXJlRE9NT3BlcmF0aW9uKCk7XG4gICAgICAgICAgZmlyZUJlZm9yZUNhbGxiYWNrQXN5bmMoKTtcbiAgICAgICAgICBmaXJlQWZ0ZXJDYWxsYmFja0FzeW5jKCk7XG4gICAgICAgICAgY2xvc2VBbmltYXRpb24oKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2tpcEFuaW1hdGlvbiA9IGZhbHNlO1xuICAgICAgICBpZih0b3RhbEFjdGl2ZUFuaW1hdGlvbnMgPiAwKSB7XG4gICAgICAgICAgdmFyIGFuaW1hdGlvbnNUb0NhbmNlbCA9IFtdO1xuICAgICAgICAgIGlmKCFydW5uZXIuaXNDbGFzc0Jhc2VkKSB7XG4gICAgICAgICAgICBpZihhbmltYXRpb25FdmVudCA9PSAnbGVhdmUnICYmIHJ1bm5pbmdBbmltYXRpb25zWyduZy1sZWF2ZSddKSB7XG4gICAgICAgICAgICAgIHNraXBBbmltYXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgLy9jYW5jZWwgYWxsIGFuaW1hdGlvbnMgd2hlbiBhIHN0cnVjdHVyYWwgYW5pbWF0aW9uIHRha2VzIHBsYWNlXG4gICAgICAgICAgICAgIGZvcih2YXIga2xhc3MgaW4gcnVubmluZ0FuaW1hdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25zVG9DYW5jZWwucHVzaChydW5uaW5nQW5pbWF0aW9uc1trbGFzc10pO1xuICAgICAgICAgICAgICAgIGNsZWFudXAoZWxlbWVudCwga2xhc3MpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJ1bm5pbmdBbmltYXRpb25zID0ge307XG4gICAgICAgICAgICAgIHRvdGFsQWN0aXZlQW5pbWF0aW9ucyA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmKGxhc3RBbmltYXRpb24uZXZlbnQgPT0gJ3NldENsYXNzJykge1xuICAgICAgICAgICAgYW5pbWF0aW9uc1RvQ2FuY2VsLnB1c2gobGFzdEFuaW1hdGlvbik7XG4gICAgICAgICAgICBjbGVhbnVwKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYocnVubmluZ0FuaW1hdGlvbnNbY2xhc3NOYW1lXSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnQgPSBydW5uaW5nQW5pbWF0aW9uc1tjbGFzc05hbWVdO1xuICAgICAgICAgICAgaWYoY3VycmVudC5ldmVudCA9PSBhbmltYXRpb25FdmVudCkge1xuICAgICAgICAgICAgICBza2lwQW5pbWF0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGFuaW1hdGlvbnNUb0NhbmNlbC5wdXNoKGN1cnJlbnQpO1xuICAgICAgICAgICAgICBjbGVhbnVwKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYoYW5pbWF0aW9uc1RvQ2FuY2VsLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvckVhY2goYW5pbWF0aW9uc1RvQ2FuY2VsLCBmdW5jdGlvbihvcGVyYXRpb24pIHtcbiAgICAgICAgICAgICAgb3BlcmF0aW9uLmNhbmNlbCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYocnVubmVyLmlzQ2xhc3NCYXNlZCAmJiAhcnVubmVyLmlzU2V0Q2xhc3NPcGVyYXRpb24gJiYgIXNraXBBbmltYXRpb24pIHtcbiAgICAgICAgICBza2lwQW5pbWF0aW9uID0gKGFuaW1hdGlvbkV2ZW50ID09ICdhZGRDbGFzcycpID09IGVsZW1lbnQuaGFzQ2xhc3MoY2xhc3NOYW1lKTsgLy9vcHBvc2l0ZSBvZiBYT1JcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKHNraXBBbmltYXRpb24pIHtcbiAgICAgICAgICBmaXJlQmVmb3JlQ2FsbGJhY2tBc3luYygpO1xuICAgICAgICAgIGZpcmVBZnRlckNhbGxiYWNrQXN5bmMoKTtcbiAgICAgICAgICBmaXJlRG9uZUNhbGxiYWNrQXN5bmMoKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZihhbmltYXRpb25FdmVudCA9PSAnbGVhdmUnKSB7XG4gICAgICAgICAgLy90aGVyZSdzIG5vIG5lZWQgdG8gZXZlciByZW1vdmUgdGhlIGxpc3RlbmVyIHNpbmNlIHRoZSBlbGVtZW50XG4gICAgICAgICAgLy93aWxsIGJlIHJlbW92ZWQgKGRlc3Ryb3llZCkgYWZ0ZXIgdGhlIGxlYXZlIGFuaW1hdGlvbiBlbmRzIG9yXG4gICAgICAgICAgLy9pcyBjYW5jZWxsZWQgbWlkd2F5XG4gICAgICAgICAgZWxlbWVudC5vbmUoJyRkZXN0cm95JywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQodGhpcyk7XG4gICAgICAgICAgICB2YXIgc3RhdGUgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSk7XG4gICAgICAgICAgICBpZihzdGF0ZSkge1xuICAgICAgICAgICAgICB2YXIgYWN0aXZlTGVhdmVBbmltYXRpb24gPSBzdGF0ZS5hY3RpdmVbJ25nLWxlYXZlJ107XG4gICAgICAgICAgICAgIGlmKGFjdGl2ZUxlYXZlQW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgYWN0aXZlTGVhdmVBbmltYXRpb24uY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgY2xlYW51cChlbGVtZW50LCAnbmctbGVhdmUnKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy90aGUgbmctYW5pbWF0ZSBjbGFzcyBkb2VzIG5vdGhpbmcsIGJ1dCBpdCdzIGhlcmUgdG8gYWxsb3cgZm9yXG4gICAgICAgIC8vcGFyZW50IGFuaW1hdGlvbnMgdG8gZmluZCBhbmQgY2FuY2VsIGNoaWxkIGFuaW1hdGlvbnMgd2hlbiBuZWVkZWRcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcyhOR19BTklNQVRFX0NMQVNTX05BTUUpO1xuXG4gICAgICAgIHZhciBsb2NhbEFuaW1hdGlvbkNvdW50ID0gZ2xvYmFsQW5pbWF0aW9uQ291bnRlcisrO1xuICAgICAgICB0b3RhbEFjdGl2ZUFuaW1hdGlvbnMrKztcbiAgICAgICAgcnVubmluZ0FuaW1hdGlvbnNbY2xhc3NOYW1lXSA9IHJ1bm5lcjtcblxuICAgICAgICBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSwge1xuICAgICAgICAgIGxhc3QgOiBydW5uZXIsXG4gICAgICAgICAgYWN0aXZlIDogcnVubmluZ0FuaW1hdGlvbnMsXG4gICAgICAgICAgaW5kZXggOiBsb2NhbEFuaW1hdGlvbkNvdW50LFxuICAgICAgICAgIHRvdGFsQWN0aXZlIDogdG90YWxBY3RpdmVBbmltYXRpb25zXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vZmlyc3Qgd2UgcnVuIHRoZSBiZWZvcmUgYW5pbWF0aW9ucyBhbmQgd2hlbiBhbGwgb2YgdGhvc2UgYXJlIGNvbXBsZXRlXG4gICAgICAgIC8vdGhlbiB3ZSBwZXJmb3JtIHRoZSBET00gb3BlcmF0aW9uIGFuZCBydW4gdGhlIG5leHQgc2V0IG9mIGFuaW1hdGlvbnNcbiAgICAgICAgZmlyZUJlZm9yZUNhbGxiYWNrQXN5bmMoKTtcbiAgICAgICAgcnVubmVyLmJlZm9yZShmdW5jdGlvbihjYW5jZWxsZWQpIHtcbiAgICAgICAgICB2YXIgZGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKTtcbiAgICAgICAgICBjYW5jZWxsZWQgPSBjYW5jZWxsZWQgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICFkYXRhIHx8ICFkYXRhLmFjdGl2ZVtjbGFzc05hbWVdIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAocnVubmVyLmlzQ2xhc3NCYXNlZCAmJiBkYXRhLmFjdGl2ZVtjbGFzc05hbWVdLmV2ZW50ICE9IGFuaW1hdGlvbkV2ZW50KTtcblxuICAgICAgICAgIGZpcmVET01PcGVyYXRpb24oKTtcbiAgICAgICAgICBpZihjYW5jZWxsZWQgPT09IHRydWUpIHtcbiAgICAgICAgICAgIGNsb3NlQW5pbWF0aW9uKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZpcmVBZnRlckNhbGxiYWNrQXN5bmMoKTtcbiAgICAgICAgICAgIHJ1bm5lci5hZnRlcihjbG9zZUFuaW1hdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBmdW5jdGlvbiBmaXJlRE9NQ2FsbGJhY2soYW5pbWF0aW9uUGhhc2UpIHtcbiAgICAgICAgICB2YXIgZXZlbnROYW1lID0gJyRhbmltYXRlOicgKyBhbmltYXRpb25QaGFzZTtcbiAgICAgICAgICBpZihlbGVtZW50RXZlbnRzICYmIGVsZW1lbnRFdmVudHNbZXZlbnROYW1lXSAmJiBlbGVtZW50RXZlbnRzW2V2ZW50TmFtZV0ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgJCRhc3luY0NhbGxiYWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBlbGVtZW50LnRyaWdnZXJIYW5kbGVyKGV2ZW50TmFtZSwge1xuICAgICAgICAgICAgICAgIGV2ZW50IDogYW5pbWF0aW9uRXZlbnQsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lIDogY2xhc3NOYW1lXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZmlyZUJlZm9yZUNhbGxiYWNrQXN5bmMoKSB7XG4gICAgICAgICAgZmlyZURPTUNhbGxiYWNrKCdiZWZvcmUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGZpcmVBZnRlckNhbGxiYWNrQXN5bmMoKSB7XG4gICAgICAgICAgZmlyZURPTUNhbGxiYWNrKCdhZnRlcicpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZmlyZURvbmVDYWxsYmFja0FzeW5jKCkge1xuICAgICAgICAgIGZpcmVET01DYWxsYmFjaygnY2xvc2UnKTtcbiAgICAgICAgICBpZihkb25lQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICQkYXN5bmNDYWxsYmFjayhmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgZG9uZUNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL2l0IGlzIGxlc3MgY29tcGxpY2F0ZWQgdG8gdXNlIGEgZmxhZyB0aGFuIG1hbmFnaW5nIGFuZCBjYW5jZWxpbmdcbiAgICAgICAgLy90aW1lb3V0cyBjb250YWluaW5nIG11bHRpcGxlIGNhbGxiYWNrcy5cbiAgICAgICAgZnVuY3Rpb24gZmlyZURPTU9wZXJhdGlvbigpIHtcbiAgICAgICAgICBpZighZmlyZURPTU9wZXJhdGlvbi5oYXNCZWVuUnVuKSB7XG4gICAgICAgICAgICBmaXJlRE9NT3BlcmF0aW9uLmhhc0JlZW5SdW4gPSB0cnVlO1xuICAgICAgICAgICAgZG9tT3BlcmF0aW9uKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2xvc2VBbmltYXRpb24oKSB7XG4gICAgICAgICAgaWYoIWNsb3NlQW5pbWF0aW9uLmhhc0JlZW5SdW4pIHtcbiAgICAgICAgICAgIGNsb3NlQW5pbWF0aW9uLmhhc0JlZW5SdW4gPSB0cnVlO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSk7XG4gICAgICAgICAgICBpZihkYXRhKSB7XG4gICAgICAgICAgICAgIC8qIG9ubHkgc3RydWN0dXJhbCBhbmltYXRpb25zIHdhaXQgZm9yIHJlZmxvdyBiZWZvcmUgcmVtb3ZpbmcgYW5cbiAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLCBidXQgY2xhc3MtYmFzZWQgYW5pbWF0aW9ucyBkb24ndC4gQW4gZXhhbXBsZSBvZiB0aGlzXG4gICAgICAgICAgICAgICAgIGZhaWxpbmcgd291bGQgYmUgd2hlbiBhIHBhcmVudCBIVE1MIHRhZyBoYXMgYSBuZy1jbGFzcyBhdHRyaWJ1dGVcbiAgICAgICAgICAgICAgICAgY2F1c2luZyBBTEwgZGlyZWN0aXZlcyBiZWxvdyB0byBza2lwIGFuaW1hdGlvbnMgZHVyaW5nIHRoZSBkaWdlc3QgKi9cbiAgICAgICAgICAgICAgaWYocnVubmVyICYmIHJ1bm5lci5pc0NsYXNzQmFzZWQpIHtcbiAgICAgICAgICAgICAgICBjbGVhbnVwKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJCRhc3luY0NhbGxiYWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSkgfHwge307XG4gICAgICAgICAgICAgICAgICBpZihsb2NhbEFuaW1hdGlvbkNvdW50ID09IGRhdGEuaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xlYW51cChlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkV2ZW50KTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSwgZGF0YSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpcmVEb25lQ2FsbGJhY2tBc3luYygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBjYW5jZWxDaGlsZEFuaW1hdGlvbnMoZWxlbWVudCkge1xuICAgICAgICB2YXIgbm9kZSA9IGV4dHJhY3RFbGVtZW50Tm9kZShlbGVtZW50KTtcbiAgICAgICAgaWYgKG5vZGUpIHtcbiAgICAgICAgICB2YXIgbm9kZXMgPSBhbmd1bGFyLmlzRnVuY3Rpb24obm9kZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKSA/XG4gICAgICAgICAgICBub2RlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoTkdfQU5JTUFURV9DTEFTU19OQU1FKSA6XG4gICAgICAgICAgICBub2RlLnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgTkdfQU5JTUFURV9DTEFTU19OQU1FKTtcbiAgICAgICAgICBmb3JFYWNoKG5vZGVzLCBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgICBlbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSk7XG4gICAgICAgICAgICBpZihkYXRhICYmIGRhdGEuYWN0aXZlKSB7XG4gICAgICAgICAgICAgIGZvckVhY2goZGF0YS5hY3RpdmUsIGZ1bmN0aW9uKHJ1bm5lcikge1xuICAgICAgICAgICAgICAgIHJ1bm5lci5jYW5jZWwoKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gY2xlYW51cChlbGVtZW50LCBjbGFzc05hbWUpIHtcbiAgICAgICAgaWYoaXNNYXRjaGluZ0VsZW1lbnQoZWxlbWVudCwgJHJvb3RFbGVtZW50KSkge1xuICAgICAgICAgIGlmKCFyb290QW5pbWF0ZVN0YXRlLmRpc2FibGVkKSB7XG4gICAgICAgICAgICByb290QW5pbWF0ZVN0YXRlLnJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHJvb3RBbmltYXRlU3RhdGUuc3RydWN0dXJhbCA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmKGNsYXNzTmFtZSkge1xuICAgICAgICAgIHZhciBkYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpIHx8IHt9O1xuXG4gICAgICAgICAgdmFyIHJlbW92ZUFuaW1hdGlvbnMgPSBjbGFzc05hbWUgPT09IHRydWU7XG4gICAgICAgICAgaWYoIXJlbW92ZUFuaW1hdGlvbnMgJiYgZGF0YS5hY3RpdmUgJiYgZGF0YS5hY3RpdmVbY2xhc3NOYW1lXSkge1xuICAgICAgICAgICAgZGF0YS50b3RhbEFjdGl2ZS0tO1xuICAgICAgICAgICAgZGVsZXRlIGRhdGEuYWN0aXZlW2NsYXNzTmFtZV07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYocmVtb3ZlQW5pbWF0aW9ucyB8fCAhZGF0YS50b3RhbEFjdGl2ZSkge1xuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcyhOR19BTklNQVRFX0NMQVNTX05BTUUpO1xuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVEYXRhKE5HX0FOSU1BVEVfU1RBVEUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBhbmltYXRpb25zRGlzYWJsZWQoZWxlbWVudCwgcGFyZW50RWxlbWVudCkge1xuICAgICAgICBpZiAocm9vdEFuaW1hdGVTdGF0ZS5kaXNhYmxlZCkgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgaWYoaXNNYXRjaGluZ0VsZW1lbnQoZWxlbWVudCwgJHJvb3RFbGVtZW50KSkge1xuICAgICAgICAgIHJldHVybiByb290QW5pbWF0ZVN0YXRlLmRpc2FibGVkIHx8IHJvb3RBbmltYXRlU3RhdGUucnVubmluZztcbiAgICAgICAgfVxuXG4gICAgICAgIGRvIHtcbiAgICAgICAgICAvL3RoZSBlbGVtZW50IGRpZCBub3QgcmVhY2ggdGhlIHJvb3QgZWxlbWVudCB3aGljaCBtZWFucyB0aGF0IGl0XG4gICAgICAgICAgLy9pcyBub3QgYXBhcnQgb2YgdGhlIERPTS4gVGhlcmVmb3JlIHRoZXJlIGlzIG5vIHJlYXNvbiB0byBkb1xuICAgICAgICAgIC8vYW55IGFuaW1hdGlvbnMgb24gaXRcbiAgICAgICAgICBpZihwYXJlbnRFbGVtZW50Lmxlbmd0aCA9PT0gMCkgYnJlYWs7XG5cbiAgICAgICAgICB2YXIgaXNSb290ID0gaXNNYXRjaGluZ0VsZW1lbnQocGFyZW50RWxlbWVudCwgJHJvb3RFbGVtZW50KTtcbiAgICAgICAgICB2YXIgc3RhdGUgPSBpc1Jvb3QgPyByb290QW5pbWF0ZVN0YXRlIDogcGFyZW50RWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpO1xuICAgICAgICAgIHZhciByZXN1bHQgPSBzdGF0ZSAmJiAoISFzdGF0ZS5kaXNhYmxlZCB8fCBzdGF0ZS5ydW5uaW5nIHx8IHN0YXRlLnRvdGFsQWN0aXZlID4gMCk7XG4gICAgICAgICAgaWYoaXNSb290IHx8IHJlc3VsdCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZihpc1Jvb3QpIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlKHBhcmVudEVsZW1lbnQgPSBwYXJlbnRFbGVtZW50LnBhcmVudCgpKTtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XSk7XG5cbiAgICAkYW5pbWF0ZVByb3ZpZGVyLnJlZ2lzdGVyKCcnLCBbJyR3aW5kb3cnLCAnJHNuaWZmZXInLCAnJHRpbWVvdXQnLCAnJCRhbmltYXRlUmVmbG93JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCR3aW5kb3csICAgJHNuaWZmZXIsICAgJHRpbWVvdXQsICAgJCRhbmltYXRlUmVmbG93KSB7XG4gICAgICAvLyBEZXRlY3QgcHJvcGVyIHRyYW5zaXRpb25lbmQvYW5pbWF0aW9uZW5kIGV2ZW50IG5hbWVzLlxuICAgICAgdmFyIENTU19QUkVGSVggPSAnJywgVFJBTlNJVElPTl9QUk9QLCBUUkFOU0lUSU9ORU5EX0VWRU5ULCBBTklNQVRJT05fUFJPUCwgQU5JTUFUSU9ORU5EX0VWRU5UO1xuXG4gICAgICAvLyBJZiB1bnByZWZpeGVkIGV2ZW50cyBhcmUgbm90IHN1cHBvcnRlZCBidXQgd2Via2l0LXByZWZpeGVkIGFyZSwgdXNlIHRoZSBsYXR0ZXIuXG4gICAgICAvLyBPdGhlcndpc2UsIGp1c3QgdXNlIFczQyBuYW1lcywgYnJvd3NlcnMgbm90IHN1cHBvcnRpbmcgdGhlbSBhdCBhbGwgd2lsbCBqdXN0IGlnbm9yZSB0aGVtLlxuICAgICAgLy8gTm90ZTogQ2hyb21lIGltcGxlbWVudHMgYHdpbmRvdy5vbndlYmtpdGFuaW1hdGlvbmVuZGAgYW5kIGRvZXNuJ3QgaW1wbGVtZW50IGB3aW5kb3cub25hbmltYXRpb25lbmRgXG4gICAgICAvLyBidXQgYXQgdGhlIHNhbWUgdGltZSBkaXNwYXRjaGVzIHRoZSBgYW5pbWF0aW9uZW5kYCBldmVudCBhbmQgbm90IGB3ZWJraXRBbmltYXRpb25FbmRgLlxuICAgICAgLy8gUmVnaXN0ZXIgYm90aCBldmVudHMgaW4gY2FzZSBgd2luZG93Lm9uYW5pbWF0aW9uZW5kYCBpcyBub3Qgc3VwcG9ydGVkIGJlY2F1c2Ugb2YgdGhhdCxcbiAgICAgIC8vIGRvIHRoZSBzYW1lIGZvciBgdHJhbnNpdGlvbmVuZGAgYXMgU2FmYXJpIGlzIGxpa2VseSB0byBleGhpYml0IHNpbWlsYXIgYmVoYXZpb3IuXG4gICAgICAvLyBBbHNvLCB0aGUgb25seSBtb2Rlcm4gYnJvd3NlciB0aGF0IHVzZXMgdmVuZG9yIHByZWZpeGVzIGZvciB0cmFuc2l0aW9ucy9rZXlmcmFtZXMgaXMgd2Via2l0XG4gICAgICAvLyB0aGVyZWZvcmUgdGhlcmUgaXMgbm8gcmVhc29uIHRvIHRlc3QgYW55bW9yZSBmb3Igb3RoZXIgdmVuZG9yIHByZWZpeGVzOiBodHRwOi8vY2FuaXVzZS5jb20vI3NlYXJjaD10cmFuc2l0aW9uXG4gICAgICBpZiAod2luZG93Lm9udHJhbnNpdGlvbmVuZCA9PT0gdW5kZWZpbmVkICYmIHdpbmRvdy5vbndlYmtpdHRyYW5zaXRpb25lbmQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBDU1NfUFJFRklYID0gJy13ZWJraXQtJztcbiAgICAgICAgVFJBTlNJVElPTl9QUk9QID0gJ1dlYmtpdFRyYW5zaXRpb24nO1xuICAgICAgICBUUkFOU0lUSU9ORU5EX0VWRU5UID0gJ3dlYmtpdFRyYW5zaXRpb25FbmQgdHJhbnNpdGlvbmVuZCc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBUUkFOU0lUSU9OX1BST1AgPSAndHJhbnNpdGlvbic7XG4gICAgICAgIFRSQU5TSVRJT05FTkRfRVZFTlQgPSAndHJhbnNpdGlvbmVuZCc7XG4gICAgICB9XG5cbiAgICAgIGlmICh3aW5kb3cub25hbmltYXRpb25lbmQgPT09IHVuZGVmaW5lZCAmJiB3aW5kb3cub253ZWJraXRhbmltYXRpb25lbmQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBDU1NfUFJFRklYID0gJy13ZWJraXQtJztcbiAgICAgICAgQU5JTUFUSU9OX1BST1AgPSAnV2Via2l0QW5pbWF0aW9uJztcbiAgICAgICAgQU5JTUFUSU9ORU5EX0VWRU5UID0gJ3dlYmtpdEFuaW1hdGlvbkVuZCBhbmltYXRpb25lbmQnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgQU5JTUFUSU9OX1BST1AgPSAnYW5pbWF0aW9uJztcbiAgICAgICAgQU5JTUFUSU9ORU5EX0VWRU5UID0gJ2FuaW1hdGlvbmVuZCc7XG4gICAgICB9XG5cbiAgICAgIHZhciBEVVJBVElPTl9LRVkgPSAnRHVyYXRpb24nO1xuICAgICAgdmFyIFBST1BFUlRZX0tFWSA9ICdQcm9wZXJ0eSc7XG4gICAgICB2YXIgREVMQVlfS0VZID0gJ0RlbGF5JztcbiAgICAgIHZhciBBTklNQVRJT05fSVRFUkFUSU9OX0NPVU5UX0tFWSA9ICdJdGVyYXRpb25Db3VudCc7XG4gICAgICB2YXIgTkdfQU5JTUFURV9QQVJFTlRfS0VZID0gJyQkbmdBbmltYXRlS2V5JztcbiAgICAgIHZhciBOR19BTklNQVRFX0NTU19EQVRBX0tFWSA9ICckJG5nQW5pbWF0ZUNTUzNEYXRhJztcbiAgICAgIHZhciBOR19BTklNQVRFX0JMT0NLX0NMQVNTX05BTUUgPSAnbmctYW5pbWF0ZS1ibG9jay10cmFuc2l0aW9ucyc7XG4gICAgICB2YXIgRUxBUFNFRF9USU1FX01BWF9ERUNJTUFMX1BMQUNFUyA9IDM7XG4gICAgICB2YXIgQ0xPU0lOR19USU1FX0JVRkZFUiA9IDEuNTtcbiAgICAgIHZhciBPTkVfU0VDT05EID0gMTAwMDtcblxuICAgICAgdmFyIGxvb2t1cENhY2hlID0ge307XG4gICAgICB2YXIgcGFyZW50Q291bnRlciA9IDA7XG4gICAgICB2YXIgYW5pbWF0aW9uUmVmbG93UXVldWUgPSBbXTtcbiAgICAgIHZhciBjYW5jZWxBbmltYXRpb25SZWZsb3c7XG4gICAgICBmdW5jdGlvbiBhZnRlclJlZmxvdyhlbGVtZW50LCBjYWxsYmFjaykge1xuICAgICAgICBpZihjYW5jZWxBbmltYXRpb25SZWZsb3cpIHtcbiAgICAgICAgICBjYW5jZWxBbmltYXRpb25SZWZsb3coKTtcbiAgICAgICAgfVxuICAgICAgICBhbmltYXRpb25SZWZsb3dRdWV1ZS5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgY2FuY2VsQW5pbWF0aW9uUmVmbG93ID0gJCRhbmltYXRlUmVmbG93KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGZvckVhY2goYW5pbWF0aW9uUmVmbG93UXVldWUsIGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgICAgICBmbigpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgYW5pbWF0aW9uUmVmbG93UXVldWUgPSBbXTtcbiAgICAgICAgICBjYW5jZWxBbmltYXRpb25SZWZsb3cgPSBudWxsO1xuICAgICAgICAgIGxvb2t1cENhY2hlID0ge307XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB2YXIgY2xvc2luZ1RpbWVyID0gbnVsbDtcbiAgICAgIHZhciBjbG9zaW5nVGltZXN0YW1wID0gMDtcbiAgICAgIHZhciBhbmltYXRpb25FbGVtZW50UXVldWUgPSBbXTtcbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGlvbkNsb3NlSGFuZGxlcihlbGVtZW50LCB0b3RhbFRpbWUpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCk7XG4gICAgICAgIGVsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQobm9kZSk7XG5cbiAgICAgICAgLy90aGlzIGl0ZW0gd2lsbCBiZSBnYXJiYWdlIGNvbGxlY3RlZCBieSB0aGUgY2xvc2luZ1xuICAgICAgICAvL2FuaW1hdGlvbiB0aW1lb3V0XG4gICAgICAgIGFuaW1hdGlvbkVsZW1lbnRRdWV1ZS5wdXNoKGVsZW1lbnQpO1xuXG4gICAgICAgIC8vYnV0IGl0IG1heSBub3QgbmVlZCB0byBjYW5jZWwgb3V0IHRoZSBleGlzdGluZyB0aW1lb3V0XG4gICAgICAgIC8vaWYgdGhlIHRpbWVzdGFtcCBpcyBsZXNzIHRoYW4gdGhlIHByZXZpb3VzIG9uZVxuICAgICAgICB2YXIgZnV0dXJlVGltZXN0YW1wID0gRGF0ZS5ub3coKSArIHRvdGFsVGltZTtcbiAgICAgICAgaWYoZnV0dXJlVGltZXN0YW1wIDw9IGNsb3NpbmdUaW1lc3RhbXApIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAkdGltZW91dC5jYW5jZWwoY2xvc2luZ1RpbWVyKTtcblxuICAgICAgICBjbG9zaW5nVGltZXN0YW1wID0gZnV0dXJlVGltZXN0YW1wO1xuICAgICAgICBjbG9zaW5nVGltZXIgPSAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBjbG9zZUFsbEFuaW1hdGlvbnMoYW5pbWF0aW9uRWxlbWVudFF1ZXVlKTtcbiAgICAgICAgICBhbmltYXRpb25FbGVtZW50UXVldWUgPSBbXTtcbiAgICAgICAgfSwgdG90YWxUaW1lLCBmYWxzZSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGNsb3NlQWxsQW5pbWF0aW9ucyhlbGVtZW50cykge1xuICAgICAgICBmb3JFYWNoKGVsZW1lbnRzLCBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgdmFyIGVsZW1lbnREYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfQ1NTX0RBVEFfS0VZKTtcbiAgICAgICAgICBpZihlbGVtZW50RGF0YSkge1xuICAgICAgICAgICAgKGVsZW1lbnREYXRhLmNsb3NlQW5pbWF0aW9uRm4gfHwgbm9vcCkoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBnZXRFbGVtZW50QW5pbWF0aW9uRGV0YWlscyhlbGVtZW50LCBjYWNoZUtleSkge1xuICAgICAgICB2YXIgZGF0YSA9IGNhY2hlS2V5ID8gbG9va3VwQ2FjaGVbY2FjaGVLZXldIDogbnVsbDtcbiAgICAgICAgaWYoIWRhdGEpIHtcbiAgICAgICAgICB2YXIgdHJhbnNpdGlvbkR1cmF0aW9uID0gMDtcbiAgICAgICAgICB2YXIgdHJhbnNpdGlvbkRlbGF5ID0gMDtcbiAgICAgICAgICB2YXIgYW5pbWF0aW9uRHVyYXRpb24gPSAwO1xuICAgICAgICAgIHZhciBhbmltYXRpb25EZWxheSA9IDA7XG4gICAgICAgICAgdmFyIHRyYW5zaXRpb25EZWxheVN0eWxlO1xuICAgICAgICAgIHZhciBhbmltYXRpb25EZWxheVN0eWxlO1xuICAgICAgICAgIHZhciB0cmFuc2l0aW9uRHVyYXRpb25TdHlsZTtcbiAgICAgICAgICB2YXIgdHJhbnNpdGlvblByb3BlcnR5U3R5bGU7XG5cbiAgICAgICAgICAvL3dlIHdhbnQgYWxsIHRoZSBzdHlsZXMgZGVmaW5lZCBiZWZvcmUgYW5kIGFmdGVyXG4gICAgICAgICAgZm9yRWFjaChlbGVtZW50LCBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgICBpZiAoZWxlbWVudC5ub2RlVHlwZSA9PSBFTEVNRU5UX05PREUpIHtcbiAgICAgICAgICAgICAgdmFyIGVsZW1lbnRTdHlsZXMgPSAkd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCkgfHwge307XG5cbiAgICAgICAgICAgICAgdHJhbnNpdGlvbkR1cmF0aW9uU3R5bGUgPSBlbGVtZW50U3R5bGVzW1RSQU5TSVRJT05fUFJPUCArIERVUkFUSU9OX0tFWV07XG5cbiAgICAgICAgICAgICAgdHJhbnNpdGlvbkR1cmF0aW9uID0gTWF0aC5tYXgocGFyc2VNYXhUaW1lKHRyYW5zaXRpb25EdXJhdGlvblN0eWxlKSwgdHJhbnNpdGlvbkR1cmF0aW9uKTtcblxuICAgICAgICAgICAgICB0cmFuc2l0aW9uUHJvcGVydHlTdHlsZSA9IGVsZW1lbnRTdHlsZXNbVFJBTlNJVElPTl9QUk9QICsgUFJPUEVSVFlfS0VZXTtcblxuICAgICAgICAgICAgICB0cmFuc2l0aW9uRGVsYXlTdHlsZSA9IGVsZW1lbnRTdHlsZXNbVFJBTlNJVElPTl9QUk9QICsgREVMQVlfS0VZXTtcblxuICAgICAgICAgICAgICB0cmFuc2l0aW9uRGVsYXkgID0gTWF0aC5tYXgocGFyc2VNYXhUaW1lKHRyYW5zaXRpb25EZWxheVN0eWxlKSwgdHJhbnNpdGlvbkRlbGF5KTtcblxuICAgICAgICAgICAgICBhbmltYXRpb25EZWxheVN0eWxlID0gZWxlbWVudFN0eWxlc1tBTklNQVRJT05fUFJPUCArIERFTEFZX0tFWV07XG5cbiAgICAgICAgICAgICAgYW5pbWF0aW9uRGVsYXkgICA9IE1hdGgubWF4KHBhcnNlTWF4VGltZShhbmltYXRpb25EZWxheVN0eWxlKSwgYW5pbWF0aW9uRGVsYXkpO1xuXG4gICAgICAgICAgICAgIHZhciBhRHVyYXRpb24gID0gcGFyc2VNYXhUaW1lKGVsZW1lbnRTdHlsZXNbQU5JTUFUSU9OX1BST1AgKyBEVVJBVElPTl9LRVldKTtcblxuICAgICAgICAgICAgICBpZihhRHVyYXRpb24gPiAwKSB7XG4gICAgICAgICAgICAgICAgYUR1cmF0aW9uICo9IHBhcnNlSW50KGVsZW1lbnRTdHlsZXNbQU5JTUFUSU9OX1BST1AgKyBBTklNQVRJT05fSVRFUkFUSU9OX0NPVU5UX0tFWV0sIDEwKSB8fCAxO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgYW5pbWF0aW9uRHVyYXRpb24gPSBNYXRoLm1heChhRHVyYXRpb24sIGFuaW1hdGlvbkR1cmF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBkYXRhID0ge1xuICAgICAgICAgICAgdG90YWwgOiAwLFxuICAgICAgICAgICAgdHJhbnNpdGlvblByb3BlcnR5U3R5bGU6IHRyYW5zaXRpb25Qcm9wZXJ0eVN0eWxlLFxuICAgICAgICAgICAgdHJhbnNpdGlvbkR1cmF0aW9uU3R5bGU6IHRyYW5zaXRpb25EdXJhdGlvblN0eWxlLFxuICAgICAgICAgICAgdHJhbnNpdGlvbkRlbGF5U3R5bGU6IHRyYW5zaXRpb25EZWxheVN0eWxlLFxuICAgICAgICAgICAgdHJhbnNpdGlvbkRlbGF5OiB0cmFuc2l0aW9uRGVsYXksXG4gICAgICAgICAgICB0cmFuc2l0aW9uRHVyYXRpb246IHRyYW5zaXRpb25EdXJhdGlvbixcbiAgICAgICAgICAgIGFuaW1hdGlvbkRlbGF5U3R5bGU6IGFuaW1hdGlvbkRlbGF5U3R5bGUsXG4gICAgICAgICAgICBhbmltYXRpb25EZWxheTogYW5pbWF0aW9uRGVsYXksXG4gICAgICAgICAgICBhbmltYXRpb25EdXJhdGlvbjogYW5pbWF0aW9uRHVyYXRpb25cbiAgICAgICAgICB9O1xuICAgICAgICAgIGlmKGNhY2hlS2V5KSB7XG4gICAgICAgICAgICBsb29rdXBDYWNoZVtjYWNoZUtleV0gPSBkYXRhO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gcGFyc2VNYXhUaW1lKHN0cikge1xuICAgICAgICB2YXIgbWF4VmFsdWUgPSAwO1xuICAgICAgICB2YXIgdmFsdWVzID0gYW5ndWxhci5pc1N0cmluZyhzdHIpID9cbiAgICAgICAgICBzdHIuc3BsaXQoL1xccyosXFxzKi8pIDpcbiAgICAgICAgICBbXTtcbiAgICAgICAgZm9yRWFjaCh2YWx1ZXMsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgbWF4VmFsdWUgPSBNYXRoLm1heChwYXJzZUZsb2F0KHZhbHVlKSB8fCAwLCBtYXhWYWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbWF4VmFsdWU7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGdldENhY2hlS2V5KGVsZW1lbnQpIHtcbiAgICAgICAgdmFyIHBhcmVudEVsZW1lbnQgPSBlbGVtZW50LnBhcmVudCgpO1xuICAgICAgICB2YXIgcGFyZW50SUQgPSBwYXJlbnRFbGVtZW50LmRhdGEoTkdfQU5JTUFURV9QQVJFTlRfS0VZKTtcbiAgICAgICAgaWYoIXBhcmVudElEKSB7XG4gICAgICAgICAgcGFyZW50RWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfUEFSRU5UX0tFWSwgKytwYXJlbnRDb3VudGVyKTtcbiAgICAgICAgICBwYXJlbnRJRCA9IHBhcmVudENvdW50ZXI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcmVudElEICsgJy0nICsgZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpLmdldEF0dHJpYnV0ZSgnY2xhc3MnKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYW5pbWF0ZVNldHVwKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIGNhbGN1bGF0aW9uRGVjb3JhdG9yKSB7XG4gICAgICAgIHZhciBjYWNoZUtleSA9IGdldENhY2hlS2V5KGVsZW1lbnQpO1xuICAgICAgICB2YXIgZXZlbnRDYWNoZUtleSA9IGNhY2hlS2V5ICsgJyAnICsgY2xhc3NOYW1lO1xuICAgICAgICB2YXIgaXRlbUluZGV4ID0gbG9va3VwQ2FjaGVbZXZlbnRDYWNoZUtleV0gPyArK2xvb2t1cENhY2hlW2V2ZW50Q2FjaGVLZXldLnRvdGFsIDogMDtcblxuICAgICAgICB2YXIgc3RhZ2dlciA9IHt9O1xuICAgICAgICBpZihpdGVtSW5kZXggPiAwKSB7XG4gICAgICAgICAgdmFyIHN0YWdnZXJDbGFzc05hbWUgPSBjbGFzc05hbWUgKyAnLXN0YWdnZXInO1xuICAgICAgICAgIHZhciBzdGFnZ2VyQ2FjaGVLZXkgPSBjYWNoZUtleSArICcgJyArIHN0YWdnZXJDbGFzc05hbWU7XG4gICAgICAgICAgdmFyIGFwcGx5Q2xhc3NlcyA9ICFsb29rdXBDYWNoZVtzdGFnZ2VyQ2FjaGVLZXldO1xuXG4gICAgICAgICAgYXBwbHlDbGFzc2VzICYmIGVsZW1lbnQuYWRkQ2xhc3Moc3RhZ2dlckNsYXNzTmFtZSk7XG5cbiAgICAgICAgICBzdGFnZ2VyID0gZ2V0RWxlbWVudEFuaW1hdGlvbkRldGFpbHMoZWxlbWVudCwgc3RhZ2dlckNhY2hlS2V5KTtcblxuICAgICAgICAgIGFwcGx5Q2xhc3NlcyAmJiBlbGVtZW50LnJlbW92ZUNsYXNzKHN0YWdnZXJDbGFzc05hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogdGhlIGFuaW1hdGlvbiBpdHNlbGYgbWF5IG5lZWQgdG8gYWRkL3JlbW92ZSBzcGVjaWFsIENTUyBjbGFzc2VzXG4gICAgICAgICAqIGJlZm9yZSBjYWxjdWxhdGluZyB0aGUgYW5tYXRpb24gc3R5bGVzICovXG4gICAgICAgIGNhbGN1bGF0aW9uRGVjb3JhdG9yID0gY2FsY3VsYXRpb25EZWNvcmF0b3IgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmbikgeyByZXR1cm4gZm4oKTsgfTtcblxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKGNsYXNzTmFtZSk7XG5cbiAgICAgICAgdmFyIGZvcm1lckRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9DU1NfREFUQV9LRVkpIHx8IHt9O1xuXG4gICAgICAgIHZhciB0aW1pbmdzID0gY2FsY3VsYXRpb25EZWNvcmF0b3IoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGdldEVsZW1lbnRBbmltYXRpb25EZXRhaWxzKGVsZW1lbnQsIGV2ZW50Q2FjaGVLZXkpO1xuICAgICAgICB9KTtcblxuICAgICAgICB2YXIgdHJhbnNpdGlvbkR1cmF0aW9uID0gdGltaW5ncy50cmFuc2l0aW9uRHVyYXRpb247XG4gICAgICAgIHZhciBhbmltYXRpb25EdXJhdGlvbiA9IHRpbWluZ3MuYW5pbWF0aW9uRHVyYXRpb247XG4gICAgICAgIGlmKHRyYW5zaXRpb25EdXJhdGlvbiA9PT0gMCAmJiBhbmltYXRpb25EdXJhdGlvbiA9PT0gMCkge1xuICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoY2xhc3NOYW1lKTtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9DU1NfREFUQV9LRVksIHtcbiAgICAgICAgICBydW5uaW5nIDogZm9ybWVyRGF0YS5ydW5uaW5nIHx8IDAsXG4gICAgICAgICAgaXRlbUluZGV4IDogaXRlbUluZGV4LFxuICAgICAgICAgIHN0YWdnZXIgOiBzdGFnZ2VyLFxuICAgICAgICAgIHRpbWluZ3MgOiB0aW1pbmdzLFxuICAgICAgICAgIGNsb3NlQW5pbWF0aW9uRm4gOiBub29wXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vdGVtcG9yYXJpbHkgZGlzYWJsZSB0aGUgdHJhbnNpdGlvbiBzbyB0aGF0IHRoZSBlbnRlciBzdHlsZXNcbiAgICAgICAgLy9kb24ndCBhbmltYXRlIHR3aWNlICh0aGlzIGlzIGhlcmUgdG8gYXZvaWQgYSBidWcgaW4gQ2hyb21lL0ZGKS5cbiAgICAgICAgdmFyIGlzQ3VycmVudGx5QW5pbWF0aW5nID0gZm9ybWVyRGF0YS5ydW5uaW5nID4gMCB8fCBhbmltYXRpb25FdmVudCA9PSAnc2V0Q2xhc3MnO1xuICAgICAgICBpZih0cmFuc2l0aW9uRHVyYXRpb24gPiAwKSB7XG4gICAgICAgICAgYmxvY2tUcmFuc2l0aW9ucyhlbGVtZW50LCBjbGFzc05hbWUsIGlzQ3VycmVudGx5QW5pbWF0aW5nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vc3RhZ2dlcmluZyBrZXlmcmFtZSBhbmltYXRpb25zIHdvcmsgYnkgYWRqdXN0aW5nIHRoZSBgYW5pbWF0aW9uLWRlbGF5YCBDU1MgcHJvcGVydHlcbiAgICAgICAgLy9vbiB0aGUgZ2l2ZW4gZWxlbWVudCwgaG93ZXZlciwgdGhlIGRlbGF5IHZhbHVlIGNhbiBvbmx5IGNhbGN1bGF0ZWQgYWZ0ZXIgdGhlIHJlZmxvd1xuICAgICAgICAvL3NpbmNlIGJ5IHRoYXQgdGltZSAkYW5pbWF0ZSBrbm93cyBob3cgbWFueSBlbGVtZW50cyBhcmUgYmVpbmcgYW5pbWF0ZWQuIFRoZXJlZm9yZSxcbiAgICAgICAgLy91bnRpbCB0aGUgcmVmbG93IG9jY3VycyB0aGUgZWxlbWVudCBuZWVkcyB0byBiZSBibG9ja2VkICh3aGVyZSB0aGUga2V5ZnJhbWUgYW5pbWF0aW9uXG4gICAgICAgIC8vaXMgc2V0IHRvIGBub25lIDBzYCkuIFRoaXMgYmxvY2tpbmcgbWVjaGFuaXNtIHNob3VsZCBvbmx5IGJlIHNldCBmb3Igd2hlbiBhIHN0YWdnZXJcbiAgICAgICAgLy9hbmltYXRpb24gaXMgZGV0ZWN0ZWQgYW5kIHdoZW4gdGhlIGVsZW1lbnQgaXRlbSBpbmRleCBpcyBncmVhdGVyIHRoYW4gMC5cbiAgICAgICAgaWYoYW5pbWF0aW9uRHVyYXRpb24gPiAwICYmIHN0YWdnZXIuYW5pbWF0aW9uRGVsYXkgPiAwICYmIHN0YWdnZXIuYW5pbWF0aW9uRHVyYXRpb24gPT09IDApIHtcbiAgICAgICAgICBibG9ja0tleWZyYW1lQW5pbWF0aW9ucyhlbGVtZW50KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBpc1N0cnVjdHVyYWxBbmltYXRpb24oY2xhc3NOYW1lKSB7XG4gICAgICAgIHJldHVybiBjbGFzc05hbWUgPT0gJ25nLWVudGVyJyB8fCBjbGFzc05hbWUgPT0gJ25nLW1vdmUnIHx8IGNsYXNzTmFtZSA9PSAnbmctbGVhdmUnO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBibG9ja1RyYW5zaXRpb25zKGVsZW1lbnQsIGNsYXNzTmFtZSwgaXNBbmltYXRpbmcpIHtcbiAgICAgICAgaWYoaXNTdHJ1Y3R1cmFsQW5pbWF0aW9uKGNsYXNzTmFtZSkgfHwgIWlzQW5pbWF0aW5nKSB7XG4gICAgICAgICAgZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpLnN0eWxlW1RSQU5TSVRJT05fUFJPUCArIFBST1BFUlRZX0tFWV0gPSAnbm9uZSc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZWxlbWVudC5hZGRDbGFzcyhOR19BTklNQVRFX0JMT0NLX0NMQVNTX05BTUUpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGJsb2NrS2V5ZnJhbWVBbmltYXRpb25zKGVsZW1lbnQpIHtcbiAgICAgICAgZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpLnN0eWxlW0FOSU1BVElPTl9QUk9QXSA9ICdub25lIDBzJztcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gdW5ibG9ja1RyYW5zaXRpb25zKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgICAgICB2YXIgcHJvcCA9IFRSQU5TSVRJT05fUFJPUCArIFBST1BFUlRZX0tFWTtcbiAgICAgICAgdmFyIG5vZGUgPSBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCk7XG4gICAgICAgIGlmKG5vZGUuc3R5bGVbcHJvcF0gJiYgbm9kZS5zdHlsZVtwcm9wXS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgbm9kZS5zdHlsZVtwcm9wXSA9ICcnO1xuICAgICAgICB9XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoTkdfQU5JTUFURV9CTE9DS19DTEFTU19OQU1FKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gdW5ibG9ja0tleWZyYW1lQW5pbWF0aW9ucyhlbGVtZW50KSB7XG4gICAgICAgIHZhciBwcm9wID0gQU5JTUFUSU9OX1BST1A7XG4gICAgICAgIHZhciBub2RlID0gZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpO1xuICAgICAgICBpZihub2RlLnN0eWxlW3Byb3BdICYmIG5vZGUuc3R5bGVbcHJvcF0ubGVuZ3RoID4gMCkge1xuICAgICAgICAgIG5vZGUuc3R5bGVbcHJvcF0gPSAnJztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBhbmltYXRlUnVuKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIGFjdGl2ZUFuaW1hdGlvbkNvbXBsZXRlKSB7XG4gICAgICAgIHZhciBub2RlID0gZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpO1xuICAgICAgICB2YXIgZWxlbWVudERhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9DU1NfREFUQV9LRVkpO1xuICAgICAgICBpZihub2RlLmdldEF0dHJpYnV0ZSgnY2xhc3MnKS5pbmRleE9mKGNsYXNzTmFtZSkgPT0gLTEgfHwgIWVsZW1lbnREYXRhKSB7XG4gICAgICAgICAgYWN0aXZlQW5pbWF0aW9uQ29tcGxldGUoKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgYWN0aXZlQ2xhc3NOYW1lID0gJyc7XG4gICAgICAgIGZvckVhY2goY2xhc3NOYW1lLnNwbGl0KCcgJyksIGZ1bmN0aW9uKGtsYXNzLCBpKSB7XG4gICAgICAgICAgYWN0aXZlQ2xhc3NOYW1lICs9IChpID4gMCA/ICcgJyA6ICcnKSArIGtsYXNzICsgJy1hY3RpdmUnO1xuICAgICAgICB9KTtcblxuICAgICAgICB2YXIgc3RhZ2dlciA9IGVsZW1lbnREYXRhLnN0YWdnZXI7XG4gICAgICAgIHZhciB0aW1pbmdzID0gZWxlbWVudERhdGEudGltaW5ncztcbiAgICAgICAgdmFyIGl0ZW1JbmRleCA9IGVsZW1lbnREYXRhLml0ZW1JbmRleDtcbiAgICAgICAgdmFyIG1heER1cmF0aW9uID0gTWF0aC5tYXgodGltaW5ncy50cmFuc2l0aW9uRHVyYXRpb24sIHRpbWluZ3MuYW5pbWF0aW9uRHVyYXRpb24pO1xuICAgICAgICB2YXIgbWF4RGVsYXkgPSBNYXRoLm1heCh0aW1pbmdzLnRyYW5zaXRpb25EZWxheSwgdGltaW5ncy5hbmltYXRpb25EZWxheSk7XG4gICAgICAgIHZhciBtYXhEZWxheVRpbWUgPSBtYXhEZWxheSAqIE9ORV9TRUNPTkQ7XG5cbiAgICAgICAgdmFyIHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICAgIHZhciBjc3MzQW5pbWF0aW9uRXZlbnRzID0gQU5JTUFUSU9ORU5EX0VWRU5UICsgJyAnICsgVFJBTlNJVElPTkVORF9FVkVOVDtcblxuICAgICAgICB2YXIgc3R5bGUgPSAnJywgYXBwbGllZFN0eWxlcyA9IFtdO1xuICAgICAgICBpZih0aW1pbmdzLnRyYW5zaXRpb25EdXJhdGlvbiA+IDApIHtcbiAgICAgICAgICB2YXIgcHJvcGVydHlTdHlsZSA9IHRpbWluZ3MudHJhbnNpdGlvblByb3BlcnR5U3R5bGU7XG4gICAgICAgICAgaWYocHJvcGVydHlTdHlsZS5pbmRleE9mKCdhbGwnKSA9PSAtMSkge1xuICAgICAgICAgICAgc3R5bGUgKz0gQ1NTX1BSRUZJWCArICd0cmFuc2l0aW9uLXByb3BlcnR5OiAnICsgcHJvcGVydHlTdHlsZSArICc7JztcbiAgICAgICAgICAgIHN0eWxlICs9IENTU19QUkVGSVggKyAndHJhbnNpdGlvbi1kdXJhdGlvbjogJyArIHRpbWluZ3MudHJhbnNpdGlvbkR1cmF0aW9uU3R5bGUgKyAnOyc7XG4gICAgICAgICAgICBhcHBsaWVkU3R5bGVzLnB1c2goQ1NTX1BSRUZJWCArICd0cmFuc2l0aW9uLXByb3BlcnR5Jyk7XG4gICAgICAgICAgICBhcHBsaWVkU3R5bGVzLnB1c2goQ1NTX1BSRUZJWCArICd0cmFuc2l0aW9uLWR1cmF0aW9uJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYoaXRlbUluZGV4ID4gMCkge1xuICAgICAgICAgIGlmKHN0YWdnZXIudHJhbnNpdGlvbkRlbGF5ID4gMCAmJiBzdGFnZ2VyLnRyYW5zaXRpb25EdXJhdGlvbiA9PT0gMCkge1xuICAgICAgICAgICAgdmFyIGRlbGF5U3R5bGUgPSB0aW1pbmdzLnRyYW5zaXRpb25EZWxheVN0eWxlO1xuICAgICAgICAgICAgc3R5bGUgKz0gQ1NTX1BSRUZJWCArICd0cmFuc2l0aW9uLWRlbGF5OiAnICtcbiAgICAgICAgICAgICAgICAgICAgIHByZXBhcmVTdGFnZ2VyRGVsYXkoZGVsYXlTdHlsZSwgc3RhZ2dlci50cmFuc2l0aW9uRGVsYXksIGl0ZW1JbmRleCkgKyAnOyAnO1xuICAgICAgICAgICAgYXBwbGllZFN0eWxlcy5wdXNoKENTU19QUkVGSVggKyAndHJhbnNpdGlvbi1kZWxheScpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmKHN0YWdnZXIuYW5pbWF0aW9uRGVsYXkgPiAwICYmIHN0YWdnZXIuYW5pbWF0aW9uRHVyYXRpb24gPT09IDApIHtcbiAgICAgICAgICAgIHN0eWxlICs9IENTU19QUkVGSVggKyAnYW5pbWF0aW9uLWRlbGF5OiAnICtcbiAgICAgICAgICAgICAgICAgICAgIHByZXBhcmVTdGFnZ2VyRGVsYXkodGltaW5ncy5hbmltYXRpb25EZWxheVN0eWxlLCBzdGFnZ2VyLmFuaW1hdGlvbkRlbGF5LCBpdGVtSW5kZXgpICsgJzsgJztcbiAgICAgICAgICAgIGFwcGxpZWRTdHlsZXMucHVzaChDU1NfUFJFRklYICsgJ2FuaW1hdGlvbi1kZWxheScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmKGFwcGxpZWRTdHlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIC8vdGhlIGVsZW1lbnQgYmVpbmcgYW5pbWF0ZWQgbWF5IHNvbWV0aW1lcyBjb250YWluIGNvbW1lbnQgbm9kZXMgaW5cbiAgICAgICAgICAvL3RoZSBqcUxpdGUgb2JqZWN0LCBzbyB3ZSdyZSBzYWZlIHRvIHVzZSBhIHNpbmdsZSB2YXJpYWJsZSB0byBob3VzZVxuICAgICAgICAgIC8vdGhlIHN0eWxlcyBzaW5jZSB0aGVyZSBpcyBhbHdheXMgb25seSBvbmUgZWxlbWVudCBiZWluZyBhbmltYXRlZFxuICAgICAgICAgIHZhciBvbGRTdHlsZSA9IG5vZGUuZ2V0QXR0cmlidXRlKCdzdHlsZScpIHx8ICcnO1xuICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCdzdHlsZScsIG9sZFN0eWxlICsgJyAnICsgc3R5bGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZWxlbWVudC5vbihjc3MzQW5pbWF0aW9uRXZlbnRzLCBvbkFuaW1hdGlvblByb2dyZXNzKTtcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcyhhY3RpdmVDbGFzc05hbWUpO1xuICAgICAgICBlbGVtZW50RGF0YS5jbG9zZUFuaW1hdGlvbkZuID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgb25FbmQoKTtcbiAgICAgICAgICBhY3RpdmVBbmltYXRpb25Db21wbGV0ZSgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBzdGFnZ2VyVGltZSAgICAgICA9IGl0ZW1JbmRleCAqIChNYXRoLm1heChzdGFnZ2VyLmFuaW1hdGlvbkRlbGF5LCBzdGFnZ2VyLnRyYW5zaXRpb25EZWxheSkgfHwgMCk7XG4gICAgICAgIHZhciBhbmltYXRpb25UaW1lICAgICA9IChtYXhEZWxheSArIG1heER1cmF0aW9uKSAqIENMT1NJTkdfVElNRV9CVUZGRVI7XG4gICAgICAgIHZhciB0b3RhbFRpbWUgICAgICAgICA9IChzdGFnZ2VyVGltZSArIGFuaW1hdGlvblRpbWUpICogT05FX1NFQ09ORDtcblxuICAgICAgICBlbGVtZW50RGF0YS5ydW5uaW5nKys7XG4gICAgICAgIGFuaW1hdGlvbkNsb3NlSGFuZGxlcihlbGVtZW50LCB0b3RhbFRpbWUpO1xuICAgICAgICByZXR1cm4gb25FbmQ7XG5cbiAgICAgICAgLy8gVGhpcyB3aWxsIGF1dG9tYXRpY2FsbHkgYmUgY2FsbGVkIGJ5ICRhbmltYXRlIHNvXG4gICAgICAgIC8vIHRoZXJlIGlzIG5vIG5lZWQgdG8gYXR0YWNoIHRoaXMgaW50ZXJuYWxseSB0byB0aGVcbiAgICAgICAgLy8gdGltZW91dCBkb25lIG1ldGhvZC5cbiAgICAgICAgZnVuY3Rpb24gb25FbmQoY2FuY2VsbGVkKSB7XG4gICAgICAgICAgZWxlbWVudC5vZmYoY3NzM0FuaW1hdGlvbkV2ZW50cywgb25BbmltYXRpb25Qcm9ncmVzcyk7XG4gICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcyhhY3RpdmVDbGFzc05hbWUpO1xuICAgICAgICAgIGFuaW1hdGVDbG9zZShlbGVtZW50LCBjbGFzc05hbWUpO1xuICAgICAgICAgIHZhciBub2RlID0gZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpO1xuICAgICAgICAgIGZvciAodmFyIGkgaW4gYXBwbGllZFN0eWxlcykge1xuICAgICAgICAgICAgbm9kZS5zdHlsZS5yZW1vdmVQcm9wZXJ0eShhcHBsaWVkU3R5bGVzW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBvbkFuaW1hdGlvblByb2dyZXNzKGV2ZW50KSB7XG4gICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgdmFyIGV2ID0gZXZlbnQub3JpZ2luYWxFdmVudCB8fCBldmVudDtcbiAgICAgICAgICB2YXIgdGltZVN0YW1wID0gZXYuJG1hbnVhbFRpbWVTdGFtcCB8fCBldi50aW1lU3RhbXAgfHwgRGF0ZS5ub3coKTtcblxuICAgICAgICAgIC8qIEZpcmVmb3ggKG9yIHBvc3NpYmx5IGp1c3QgR2Vja28pIGxpa2VzIHRvIG5vdCByb3VuZCB2YWx1ZXMgdXBcbiAgICAgICAgICAgKiB3aGVuIGEgbXMgbWVhc3VyZW1lbnQgaXMgdXNlZCBmb3IgdGhlIGFuaW1hdGlvbiAqL1xuICAgICAgICAgIHZhciBlbGFwc2VkVGltZSA9IHBhcnNlRmxvYXQoZXYuZWxhcHNlZFRpbWUudG9GaXhlZChFTEFQU0VEX1RJTUVfTUFYX0RFQ0lNQUxfUExBQ0VTKSk7XG5cbiAgICAgICAgICAvKiAkbWFudWFsVGltZVN0YW1wIGlzIGEgbW9ja2VkIHRpbWVTdGFtcCB2YWx1ZSB3aGljaCBpcyBzZXRcbiAgICAgICAgICAgKiB3aXRoaW4gYnJvd3NlclRyaWdnZXIoKS4gVGhpcyBpcyBvbmx5IGhlcmUgc28gdGhhdCB0ZXN0cyBjYW5cbiAgICAgICAgICAgKiBtb2NrIGFuaW1hdGlvbnMgcHJvcGVybHkuIFJlYWwgZXZlbnRzIGZhbGxiYWNrIHRvIGV2ZW50LnRpbWVTdGFtcCxcbiAgICAgICAgICAgKiBvciwgaWYgdGhleSBkb24ndCwgdGhlbiBhIHRpbWVTdGFtcCBpcyBhdXRvbWF0aWNhbGx5IGNyZWF0ZWQgZm9yIHRoZW0uXG4gICAgICAgICAgICogV2UncmUgY2hlY2tpbmcgdG8gc2VlIGlmIHRoZSB0aW1lU3RhbXAgc3VycGFzc2VzIHRoZSBleHBlY3RlZCBkZWxheSxcbiAgICAgICAgICAgKiBidXQgd2UncmUgdXNpbmcgZWxhcHNlZFRpbWUgaW5zdGVhZCBvZiB0aGUgdGltZVN0YW1wIG9uIHRoZSAybmRcbiAgICAgICAgICAgKiBwcmUtY29uZGl0aW9uIHNpbmNlIGFuaW1hdGlvbnMgc29tZXRpbWVzIGNsb3NlIG9mZiBlYXJseSAqL1xuICAgICAgICAgIGlmKE1hdGgubWF4KHRpbWVTdGFtcCAtIHN0YXJ0VGltZSwgMCkgPj0gbWF4RGVsYXlUaW1lICYmIGVsYXBzZWRUaW1lID49IG1heER1cmF0aW9uKSB7XG4gICAgICAgICAgICBhY3RpdmVBbmltYXRpb25Db21wbGV0ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBwcmVwYXJlU3RhZ2dlckRlbGF5KGRlbGF5U3R5bGUsIHN0YWdnZXJEZWxheSwgaW5kZXgpIHtcbiAgICAgICAgdmFyIHN0eWxlID0gJyc7XG4gICAgICAgIGZvckVhY2goZGVsYXlTdHlsZS5zcGxpdCgnLCcpLCBmdW5jdGlvbih2YWwsIGkpIHtcbiAgICAgICAgICBzdHlsZSArPSAoaSA+IDAgPyAnLCcgOiAnJykgK1xuICAgICAgICAgICAgICAgICAgIChpbmRleCAqIHN0YWdnZXJEZWxheSArIHBhcnNlSW50KHZhbCwgMTApKSArICdzJztcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzdHlsZTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYW5pbWF0ZUJlZm9yZShhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lLCBjYWxjdWxhdGlvbkRlY29yYXRvcikge1xuICAgICAgICBpZihhbmltYXRlU2V0dXAoYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSwgY2FsY3VsYXRpb25EZWNvcmF0b3IpKSB7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNhbmNlbGxlZCkge1xuICAgICAgICAgICAgY2FuY2VsbGVkICYmIGFuaW1hdGVDbG9zZShlbGVtZW50LCBjbGFzc05hbWUpO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYW5pbWF0ZUFmdGVyKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIGFmdGVyQW5pbWF0aW9uQ29tcGxldGUpIHtcbiAgICAgICAgaWYoZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfQ1NTX0RBVEFfS0VZKSkge1xuICAgICAgICAgIHJldHVybiBhbmltYXRlUnVuKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIGFmdGVyQW5pbWF0aW9uQ29tcGxldGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFuaW1hdGVDbG9zZShlbGVtZW50LCBjbGFzc05hbWUpO1xuICAgICAgICAgIGFmdGVyQW5pbWF0aW9uQ29tcGxldGUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBhbmltYXRlKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkNvbXBsZXRlKSB7XG4gICAgICAgIC8vSWYgdGhlIGFuaW1hdGVTZXR1cCBmdW5jdGlvbiBkb2Vzbid0IGJvdGhlciByZXR1cm5pbmcgYVxuICAgICAgICAvL2NhbmNlbGxhdGlvbiBmdW5jdGlvbiB0aGVuIGl0IG1lYW5zIHRoYXQgdGhlcmUgaXMgbm8gYW5pbWF0aW9uXG4gICAgICAgIC8vdG8gcGVyZm9ybSBhdCBhbGxcbiAgICAgICAgdmFyIHByZVJlZmxvd0NhbmNlbGxhdGlvbiA9IGFuaW1hdGVCZWZvcmUoYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgIGlmKCFwcmVSZWZsb3dDYW5jZWxsYXRpb24pIHtcbiAgICAgICAgICBhbmltYXRpb25Db21wbGV0ZSgpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vVGhlcmUgYXJlIHR3byBjYW5jZWxsYXRpb24gZnVuY3Rpb25zOiBvbmUgaXMgYmVmb3JlIHRoZSBmaXJzdFxuICAgICAgICAvL3JlZmxvdyBhbmltYXRpb24gYW5kIHRoZSBzZWNvbmQgaXMgZHVyaW5nIHRoZSBhY3RpdmUgc3RhdGVcbiAgICAgICAgLy9hbmltYXRpb24uIFRoZSBmaXJzdCBmdW5jdGlvbiB3aWxsIHRha2UgY2FyZSBvZiByZW1vdmluZyB0aGVcbiAgICAgICAgLy9kYXRhIGZyb20gdGhlIGVsZW1lbnQgd2hpY2ggd2lsbCBub3QgbWFrZSB0aGUgMm5kIGFuaW1hdGlvblxuICAgICAgICAvL2hhcHBlbiBpbiB0aGUgZmlyc3QgcGxhY2VcbiAgICAgICAgdmFyIGNhbmNlbCA9IHByZVJlZmxvd0NhbmNlbGxhdGlvbjtcbiAgICAgICAgYWZ0ZXJSZWZsb3coZWxlbWVudCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdW5ibG9ja1RyYW5zaXRpb25zKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgdW5ibG9ja0tleWZyYW1lQW5pbWF0aW9ucyhlbGVtZW50KTtcbiAgICAgICAgICAvL29uY2UgdGhlIHJlZmxvdyBpcyBjb21wbGV0ZSB0aGVuIHdlIHBvaW50IGNhbmNlbCB0b1xuICAgICAgICAgIC8vdGhlIG5ldyBjYW5jZWxsYXRpb24gZnVuY3Rpb24gd2hpY2ggd2lsbCByZW1vdmUgYWxsIG9mIHRoZVxuICAgICAgICAgIC8vYW5pbWF0aW9uIHByb3BlcnRpZXMgZnJvbSB0aGUgYWN0aXZlIGFuaW1hdGlvblxuICAgICAgICAgIGNhbmNlbCA9IGFuaW1hdGVBZnRlcihhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lLCBhbmltYXRpb25Db21wbGV0ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihjYW5jZWxsZWQpIHtcbiAgICAgICAgICAoY2FuY2VsIHx8IG5vb3ApKGNhbmNlbGxlZCk7XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGVDbG9zZShlbGVtZW50LCBjbGFzc05hbWUpIHtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcyhjbGFzc05hbWUpO1xuICAgICAgICB2YXIgZGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX0NTU19EQVRBX0tFWSk7XG4gICAgICAgIGlmKGRhdGEpIHtcbiAgICAgICAgICBpZihkYXRhLnJ1bm5pbmcpIHtcbiAgICAgICAgICAgIGRhdGEucnVubmluZy0tO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZighZGF0YS5ydW5uaW5nIHx8IGRhdGEucnVubmluZyA9PT0gMCkge1xuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVEYXRhKE5HX0FOSU1BVEVfQ1NTX0RBVEFfS0VZKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZW50ZXIgOiBmdW5jdGlvbihlbGVtZW50LCBhbmltYXRpb25Db21wbGV0ZWQpIHtcbiAgICAgICAgICByZXR1cm4gYW5pbWF0ZSgnZW50ZXInLCBlbGVtZW50LCAnbmctZW50ZXInLCBhbmltYXRpb25Db21wbGV0ZWQpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGxlYXZlIDogZnVuY3Rpb24oZWxlbWVudCwgYW5pbWF0aW9uQ29tcGxldGVkKSB7XG4gICAgICAgICAgcmV0dXJuIGFuaW1hdGUoJ2xlYXZlJywgZWxlbWVudCwgJ25nLWxlYXZlJywgYW5pbWF0aW9uQ29tcGxldGVkKTtcbiAgICAgICAgfSxcblxuICAgICAgICBtb3ZlIDogZnVuY3Rpb24oZWxlbWVudCwgYW5pbWF0aW9uQ29tcGxldGVkKSB7XG4gICAgICAgICAgcmV0dXJuIGFuaW1hdGUoJ21vdmUnLCBlbGVtZW50LCAnbmctbW92ZScsIGFuaW1hdGlvbkNvbXBsZXRlZCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYmVmb3JlU2V0Q2xhc3MgOiBmdW5jdGlvbihlbGVtZW50LCBhZGQsIHJlbW92ZSwgYW5pbWF0aW9uQ29tcGxldGVkKSB7XG4gICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IHN1ZmZpeENsYXNzZXMocmVtb3ZlLCAnLXJlbW92ZScpICsgJyAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3VmZml4Q2xhc3NlcyhhZGQsICctYWRkJyk7XG4gICAgICAgICAgdmFyIGNhbmNlbGxhdGlvbk1ldGhvZCA9IGFuaW1hdGVCZWZvcmUoJ3NldENsYXNzJywgZWxlbWVudCwgY2xhc3NOYW1lLCBmdW5jdGlvbihmbikge1xuICAgICAgICAgICAgLyogd2hlbiBjbGFzc2VzIGFyZSByZW1vdmVkIGZyb20gYW4gZWxlbWVudCB0aGVuIHRoZSB0cmFuc2l0aW9uIHN0eWxlXG4gICAgICAgICAgICAgKiB0aGF0IGlzIGFwcGxpZWQgaXMgdGhlIHRyYW5zaXRpb24gZGVmaW5lZCBvbiB0aGUgZWxlbWVudCB3aXRob3V0IHRoZVxuICAgICAgICAgICAgICogQ1NTIGNsYXNzIGJlaW5nIHRoZXJlLiBUaGlzIGlzIGhvdyBDU1MzIGZ1bmN0aW9ucyBvdXRzaWRlIG9mIG5nQW5pbWF0ZS5cbiAgICAgICAgICAgICAqIGh0dHA6Ly9wbG5rci5jby9lZGl0L2o4T3pnVE54SFRiNG4zekx5akdXP3A9cHJldmlldyAqL1xuICAgICAgICAgICAgdmFyIGtsYXNzID0gZWxlbWVudC5hdHRyKCdjbGFzcycpO1xuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcyhyZW1vdmUpO1xuICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcyhhZGQpO1xuICAgICAgICAgICAgdmFyIHRpbWluZ3MgPSBmbigpO1xuICAgICAgICAgICAgZWxlbWVudC5hdHRyKCdjbGFzcycsIGtsYXNzKTtcbiAgICAgICAgICAgIHJldHVybiB0aW1pbmdzO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaWYoY2FuY2VsbGF0aW9uTWV0aG9kKSB7XG4gICAgICAgICAgICBhZnRlclJlZmxvdyhlbGVtZW50LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgdW5ibG9ja1RyYW5zaXRpb25zKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgIHVuYmxvY2tLZXlmcmFtZUFuaW1hdGlvbnMoZWxlbWVudCk7XG4gICAgICAgICAgICAgIGFuaW1hdGlvbkNvbXBsZXRlZCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gY2FuY2VsbGF0aW9uTWV0aG9kO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhbmltYXRpb25Db21wbGV0ZWQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBiZWZvcmVBZGRDbGFzcyA6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgYW5pbWF0aW9uQ29tcGxldGVkKSB7XG4gICAgICAgICAgdmFyIGNhbmNlbGxhdGlvbk1ldGhvZCA9IGFuaW1hdGVCZWZvcmUoJ2FkZENsYXNzJywgZWxlbWVudCwgc3VmZml4Q2xhc3NlcyhjbGFzc05hbWUsICctYWRkJyksIGZ1bmN0aW9uKGZuKSB7XG5cbiAgICAgICAgICAgIC8qIHdoZW4gYSBDU1MgY2xhc3MgaXMgYWRkZWQgdG8gYW4gZWxlbWVudCB0aGVuIHRoZSB0cmFuc2l0aW9uIHN0eWxlIHRoYXRcbiAgICAgICAgICAgICAqIGlzIGFwcGxpZWQgaXMgdGhlIHRyYW5zaXRpb24gZGVmaW5lZCBvbiB0aGUgZWxlbWVudCB3aGVuIHRoZSBDU1MgY2xhc3NcbiAgICAgICAgICAgICAqIGlzIGFkZGVkIGF0IHRoZSB0aW1lIG9mIHRoZSBhbmltYXRpb24uIFRoaXMgaXMgaG93IENTUzMgZnVuY3Rpb25zXG4gICAgICAgICAgICAgKiBvdXRzaWRlIG9mIG5nQW5pbWF0ZS4gKi9cbiAgICAgICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgIHZhciB0aW1pbmdzID0gZm4oKTtcbiAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgIHJldHVybiB0aW1pbmdzO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaWYoY2FuY2VsbGF0aW9uTWV0aG9kKSB7XG4gICAgICAgICAgICBhZnRlclJlZmxvdyhlbGVtZW50LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgdW5ibG9ja1RyYW5zaXRpb25zKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgIHVuYmxvY2tLZXlmcmFtZUFuaW1hdGlvbnMoZWxlbWVudCk7XG4gICAgICAgICAgICAgIGFuaW1hdGlvbkNvbXBsZXRlZCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gY2FuY2VsbGF0aW9uTWV0aG9kO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhbmltYXRpb25Db21wbGV0ZWQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXRDbGFzcyA6IGZ1bmN0aW9uKGVsZW1lbnQsIGFkZCwgcmVtb3ZlLCBhbmltYXRpb25Db21wbGV0ZWQpIHtcbiAgICAgICAgICByZW1vdmUgPSBzdWZmaXhDbGFzc2VzKHJlbW92ZSwgJy1yZW1vdmUnKTtcbiAgICAgICAgICBhZGQgPSBzdWZmaXhDbGFzc2VzKGFkZCwgJy1hZGQnKTtcbiAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gcmVtb3ZlICsgJyAnICsgYWRkO1xuICAgICAgICAgIHJldHVybiBhbmltYXRlQWZ0ZXIoJ3NldENsYXNzJywgZWxlbWVudCwgY2xhc3NOYW1lLCBhbmltYXRpb25Db21wbGV0ZWQpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGFkZENsYXNzIDogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBhbmltYXRpb25Db21wbGV0ZWQpIHtcbiAgICAgICAgICByZXR1cm4gYW5pbWF0ZUFmdGVyKCdhZGRDbGFzcycsIGVsZW1lbnQsIHN1ZmZpeENsYXNzZXMoY2xhc3NOYW1lLCAnLWFkZCcpLCBhbmltYXRpb25Db21wbGV0ZWQpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGJlZm9yZVJlbW92ZUNsYXNzIDogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBhbmltYXRpb25Db21wbGV0ZWQpIHtcbiAgICAgICAgICB2YXIgY2FuY2VsbGF0aW9uTWV0aG9kID0gYW5pbWF0ZUJlZm9yZSgncmVtb3ZlQ2xhc3MnLCBlbGVtZW50LCBzdWZmaXhDbGFzc2VzKGNsYXNzTmFtZSwgJy1yZW1vdmUnKSwgZnVuY3Rpb24oZm4pIHtcbiAgICAgICAgICAgIC8qIHdoZW4gY2xhc3NlcyBhcmUgcmVtb3ZlZCBmcm9tIGFuIGVsZW1lbnQgdGhlbiB0aGUgdHJhbnNpdGlvbiBzdHlsZVxuICAgICAgICAgICAgICogdGhhdCBpcyBhcHBsaWVkIGlzIHRoZSB0cmFuc2l0aW9uIGRlZmluZWQgb24gdGhlIGVsZW1lbnQgd2l0aG91dCB0aGVcbiAgICAgICAgICAgICAqIENTUyBjbGFzcyBiZWluZyB0aGVyZS4gVGhpcyBpcyBob3cgQ1NTMyBmdW5jdGlvbnMgb3V0c2lkZSBvZiBuZ0FuaW1hdGUuXG4gICAgICAgICAgICAgKiBodHRwOi8vcGxua3IuY28vZWRpdC9qOE96Z1ROeEhUYjRuM3pMeWpHVz9wPXByZXZpZXcgKi9cbiAgICAgICAgICAgIHZhciBrbGFzcyA9IGVsZW1lbnQuYXR0cignY2xhc3MnKTtcbiAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgIHZhciB0aW1pbmdzID0gZm4oKTtcbiAgICAgICAgICAgIGVsZW1lbnQuYXR0cignY2xhc3MnLCBrbGFzcyk7XG4gICAgICAgICAgICByZXR1cm4gdGltaW5ncztcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGlmKGNhbmNlbGxhdGlvbk1ldGhvZCkge1xuICAgICAgICAgICAgYWZ0ZXJSZWZsb3coZWxlbWVudCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHVuYmxvY2tUcmFuc2l0aW9ucyhlbGVtZW50LCBjbGFzc05hbWUpO1xuICAgICAgICAgICAgICB1bmJsb2NrS2V5ZnJhbWVBbmltYXRpb25zKGVsZW1lbnQpO1xuICAgICAgICAgICAgICBhbmltYXRpb25Db21wbGV0ZWQoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGNhbmNlbGxhdGlvbk1ldGhvZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgYW5pbWF0aW9uQ29tcGxldGVkKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVtb3ZlQ2xhc3MgOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkNvbXBsZXRlZCkge1xuICAgICAgICAgIHJldHVybiBhbmltYXRlQWZ0ZXIoJ3JlbW92ZUNsYXNzJywgZWxlbWVudCwgc3VmZml4Q2xhc3NlcyhjbGFzc05hbWUsICctcmVtb3ZlJyksIGFuaW1hdGlvbkNvbXBsZXRlZCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGZ1bmN0aW9uIHN1ZmZpeENsYXNzZXMoY2xhc3Nlcywgc3VmZml4KSB7XG4gICAgICAgIHZhciBjbGFzc05hbWUgPSAnJztcbiAgICAgICAgY2xhc3NlcyA9IGFuZ3VsYXIuaXNBcnJheShjbGFzc2VzKSA/IGNsYXNzZXMgOiBjbGFzc2VzLnNwbGl0KC9cXHMrLyk7XG4gICAgICAgIGZvckVhY2goY2xhc3NlcywgZnVuY3Rpb24oa2xhc3MsIGkpIHtcbiAgICAgICAgICBpZihrbGFzcyAmJiBrbGFzcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjbGFzc05hbWUgKz0gKGkgPiAwID8gJyAnIDogJycpICsga2xhc3MgKyBzdWZmaXg7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGNsYXNzTmFtZTtcbiAgICAgIH1cbiAgICB9XSk7XG4gIH1dKTtcblxuXG59KSh3aW5kb3csIHdpbmRvdy5hbmd1bGFyKTtcbiJdfQ==
